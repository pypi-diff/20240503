# Comparing `tmp/restdoctor-0.0.8-py3-none-any.whl.zip` & `tmp/restdoctor-0.0.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,9 +1,9 @@
-Zip file size: 51694 bytes, number of entries: 72
--rw-r--r--  2.0 unx       72 b- defN 20-Dec-07 20:07 restdoctor/__init__.py
+Zip file size: 52504 bytes, number of entries: 72
+-rw-r--r--  2.0 unx       72 b- defN 20-Dec-14 17:44 restdoctor/__init__.py
 -rw-r--r--  2.0 unx      566 b- defN 20-Oct-08 14:36 restdoctor/app_settings.py
 -rw-r--r--  2.0 unx      675 b- defN 20-Oct-08 14:32 restdoctor/apps.py
 -rw-r--r--  2.0 unx      122 b- defN 20-Jul-28 10:36 restdoctor/constants.py
 -rw-r--r--  2.0 unx        0 b- defN 20-Sep-30 09:10 restdoctor/django/__init__.py
 -rw-r--r--  2.0 unx      243 b- defN 20-Sep-30 09:15 restdoctor/django/custom_types.py
 -rw-r--r--  2.0 unx      667 b- defN 20-Sep-01 09:46 restdoctor/django/sensitive_data.py
 -rw-r--r--  2.0 unx        0 b- defN 20-Oct-01 12:48 restdoctor/django/middleware/__init__.py
@@ -15,60 +15,60 @@
 -rw-r--r--  2.0 unx     1378 b- defN 20-Sep-16 14:50 restdoctor/rest_framework/fields.py
 -rw-r--r--  2.0 unx     2021 b- defN 20-Aug-21 09:55 restdoctor/rest_framework/generics.py
 -rw-r--r--  2.0 unx     3827 b- defN 20-Aug-28 10:40 restdoctor/rest_framework/mixins.py
 -rw-r--r--  2.0 unx     1279 b- defN 20-Sep-10 15:06 restdoctor/rest_framework/negotiations.py
 -rw-r--r--  2.0 unx    12413 b- defN 20-Sep-14 13:37 restdoctor/rest_framework/pagination.py
 -rw-r--r--  2.0 unx      384 b- defN 20-Sep-30 09:05 restdoctor/rest_framework/parsers.py
 -rw-r--r--  2.0 unx     1292 b- defN 20-Sep-30 08:21 restdoctor/rest_framework/renderers.py
--rw-r--r--  2.0 unx     7859 b- defN 20-Oct-08 14:37 restdoctor/rest_framework/resources.py
+-rw-r--r--  2.0 unx     8046 b- defN 20-Dec-14 17:44 restdoctor/rest_framework/resources.py
 -rw-r--r--  2.0 unx      809 b- defN 20-Jul-17 08:15 restdoctor/rest_framework/response.py
 -rw-r--r--  2.0 unx      941 b- defN 20-Sep-30 09:05 restdoctor/rest_framework/reverse.py
 -rw-r--r--  2.0 unx     4324 b- defN 20-Oct-01 13:30 restdoctor/rest_framework/routers.py
--rw-r--r--  2.0 unx    20878 b- defN 20-Oct-08 16:23 restdoctor/rest_framework/schema.py
+-rw-r--r--  2.0 unx    20943 b- defN 20-Dec-14 17:44 restdoctor/rest_framework/schema.py
 -rw-r--r--  2.0 unx     4366 b- defN 20-Sep-30 09:15 restdoctor/rest_framework/sensitive_data.py
 -rw-r--r--  2.0 unx      253 b- defN 20-Sep-01 09:46 restdoctor/rest_framework/serializers.py
 -rw-r--r--  2.0 unx      124 b- defN 20-Sep-30 08:52 restdoctor/rest_framework/signals.py
--rw-r--r--  2.0 unx     3708 b- defN 20-Dec-07 20:07 restdoctor/rest_framework/test_client.py
+-rw-r--r--  2.0 unx     3702 b- defN 20-Dec-14 17:44 restdoctor/rest_framework/test_client.py
 -rw-r--r--  2.0 unx     6576 b- defN 20-Oct-08 14:34 restdoctor/rest_framework/views.py
 -rw-r--r--  2.0 unx      912 b- defN 20-Aug-28 10:40 restdoctor/rest_framework/viewsets.py
 -rw-r--r--  2.0 unx        0 b- defN 20-Apr-11 11:31 restdoctor/utils/__init__.py
 -rw-r--r--  2.0 unx     1234 b- defN 20-Oct-08 14:42 restdoctor/utils/api_prefix.py
 -rw-r--r--  2.0 unx      164 b- defN 20-Jun-25 15:14 restdoctor/utils/constants.py
 -rw-r--r--  2.0 unx      385 b- defN 20-Sep-29 11:29 restdoctor/utils/custom_types.py
 -rw-r--r--  2.0 unx      153 b- defN 20-May-05 11:31 restdoctor/utils/helpers.py
 -rw-r--r--  2.0 unx     1637 b- defN 20-Oct-01 13:31 restdoctor/utils/jwt_token.py
--rw-r--r--  2.0 unx     1604 b- defN 20-Oct-08 14:40 restdoctor/utils/media_type.py
+-rw-r--r--  2.0 unx     2925 b- defN 20-Dec-14 17:44 restdoctor/utils/media_type.py
 -rw-r--r--  2.0 unx      587 b- defN 20-Aug-14 11:50 restdoctor/utils/permissions.py
 -rw-r--r--  2.0 unx      120 b- defN 20-Sep-29 12:38 restdoctor/utils/sentry.py
 -rw-r--r--  2.0 unx     2395 b- defN 20-Jul-31 12:47 restdoctor/utils/serializers.py
 -rw-r--r--  2.0 unx      124 b- defN 20-Oct-01 13:27 restdoctor/utils/structlog.py
 -rw-r--r--  2.0 unx        0 b- defN 20-Apr-10 13:31 tests/__init__.py
 -rw-r--r--  2.0 unx      239 b- defN 20-Oct-01 13:20 tests/conftest.py
 -rw-r--r--  2.0 unx      170 b- defN 20-Oct-01 09:53 tests/factories.py
 -rw-r--r--  2.0 unx     3927 b- defN 20-Oct-08 16:41 tests/test_settings.py
 -rw-r--r--  2.0 unx        0 b- defN 20-May-06 12:17 tests/test_unit/__init__.py
--rw-r--r--  2.0 unx     2648 b- defN 20-Oct-08 14:07 tests/test_unit/conftest.py
+-rw-r--r--  2.0 unx     2772 b- defN 20-Dec-14 17:44 tests/test_unit/conftest.py
 -rw-r--r--  2.0 unx     4382 b- defN 20-Oct-01 13:16 tests/test_unit/stubs.py
 -rw-r--r--  2.0 unx     1151 b- defN 20-Jul-03 12:38 tests/test_unit/test_api_prefixes.py
--rw-r--r--  2.0 unx     3113 b- defN 20-Oct-01 12:51 tests/test_unit/test_api_version_selector.py
+-rw-r--r--  2.0 unx     3117 b- defN 20-Dec-14 17:44 tests/test_unit/test_api_version_selector.py
 -rw-r--r--  2.0 unx      899 b- defN 20-Jul-17 06:31 tests/test_unit/test_fields.py
 -rw-r--r--  2.0 unx    10262 b- defN 20-Sep-29 14:27 tests/test_unit/test_pagination.py
--rw-r--r--  2.0 unx     2642 b- defN 20-Sep-30 08:19 tests/test_unit/test_parse_accept.py
+-rw-r--r--  2.0 unx     3502 b- defN 20-Dec-14 17:44 tests/test_unit/test_parse_accept.py
 -rw-r--r--  2.0 unx      919 b- defN 20-Oct-01 10:04 tests/test_unit/test_permissions.py
--rw-r--r--  2.0 unx     4670 b- defN 20-Oct-01 10:04 tests/test_unit/test_resources.py
+-rw-r--r--  2.0 unx     6155 b- defN 20-Dec-14 17:44 tests/test_unit/test_resources.py
 -rw-r--r--  2.0 unx      462 b- defN 20-Jul-17 08:23 tests/test_unit/test_response_with_meta.py
 -rw-r--r--  2.0 unx     4267 b- defN 20-Oct-01 10:04 tests/test_unit/test_sensitive_data.py
 -rw-r--r--  2.0 unx     2261 b- defN 20-Oct-01 10:05 tests/test_unit/test_serializers.py
 -rw-r--r--  2.0 unx        0 b- defN 20-Jul-14 12:40 tests/test_unit/test_schema/__init__.py
 -rw-r--r--  2.0 unx      743 b- defN 20-Sep-11 12:37 tests/test_unit/test_schema/conftest.py
 -rw-r--r--  2.0 unx     1236 b- defN 20-Oct-08 16:44 tests/test_unit/test_schema/stubs.py
 -rw-r--r--  2.0 unx      657 b- defN 20-Oct-01 10:04 tests/test_unit/test_schema/test_error_handlers_schema.py
 -rw-r--r--  2.0 unx     1783 b- defN 20-Jul-14 15:08 tests/test_unit/test_schema/test_fields_schema.py
--rw-r--r--  2.0 unx     1000 b- defN 20-Oct-01 10:03 tests/test_unit/test_schema/test_refs_schema_generator.py
+-rw-r--r--  2.0 unx      996 b- defN 20-Dec-14 17:44 tests/test_unit/test_schema/test_refs_schema_generator.py
 -rw-r--r--  2.0 unx     2055 b- defN 20-Oct-08 16:45 tests/test_unit/test_schema/test_resource_schema.py
 -rw-r--r--  2.0 unx     1164 b- defN 20-Oct-08 14:36 tests/test_unit/test_schema/test_schema_tags.py
--rw-r--r--  2.0 unx     1220 b- defN 20-Oct-01 10:03 tests/test_unit/test_schema/test_serializer_class_map.py
--rw-r--r--  2.0 unx      666 b- defN 20-Dec-07 20:07 restdoctor-0.0.8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 20-Dec-07 20:07 restdoctor-0.0.8.dist-info/WHEEL
--rw-r--r--  2.0 unx       17 b- defN 20-Dec-07 20:07 restdoctor-0.0.8.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     6515 b- defN 20-Dec-07 20:07 restdoctor-0.0.8.dist-info/RECORD
-72 files, 149802 bytes uncompressed, 41170 bytes compressed:  72.5%
+-rw-r--r--  2.0 unx     1216 b- defN 20-Dec-14 17:44 tests/test_unit/test_schema/test_serializer_class_map.py
+-rw-r--r--  2.0 unx      666 b- defN 20-Dec-14 17:45 restdoctor-0.0.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 20-Dec-14 17:45 restdoctor-0.0.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx       17 b- defN 20-Dec-14 17:45 restdoctor-0.0.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     6514 b- defN 20-Dec-14 17:45 restdoctor-0.0.9.dist-info/RECORD
+72 files, 153833 bytes uncompressed, 41980 bytes compressed:  72.7%
```

## zipnote {}

```diff
@@ -198,20 +198,20 @@
 
 Filename: tests/test_unit/test_schema/test_schema_tags.py
 Comment: 
 
 Filename: tests/test_unit/test_schema/test_serializer_class_map.py
 Comment: 
 
-Filename: restdoctor-0.0.8.dist-info/METADATA
+Filename: restdoctor-0.0.9.dist-info/METADATA
 Comment: 
 
-Filename: restdoctor-0.0.8.dist-info/WHEEL
+Filename: restdoctor-0.0.9.dist-info/WHEEL
 Comment: 
 
-Filename: restdoctor-0.0.8.dist-info/top_level.txt
+Filename: restdoctor-0.0.9.dist-info/top_level.txt
 Comment: 
 
-Filename: restdoctor-0.0.8.dist-info/RECORD
+Filename: restdoctor-0.0.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## restdoctor/__init__.py

```diff
@@ -1,3 +1,3 @@
-__version__ = '0.0.8'
+__version__ = '0.0.9'
 
 default_app_config = 'restdoctor.apps.AppConfig'
```

## restdoctor/rest_framework/resources.py

```diff
@@ -103,33 +103,37 @@
         for warning in warnings:
             logger.warning(warning)
         if errors:
             raise ImproperlyConfigured(','.join(errors))
         return True
 
     def get_discriminant(self, request: WSGIRequest) -> str:
-        return request.GET.get(
-            self.resource_discriminative_param, self.default_discriminative_value)
+        try:
+            if request.api_params.resource_discriminator:
+                return request.api_params.resource_discriminator
+        except AttributeError:
+            pass
 
-    def dispatch(self, request: WSGIRequest, *args: typing.Any, **kwargs: typing.Any) -> Response:
         if request.method in self.resource_discriminate_methods:
-            discriminant = self.get_discriminant(request)
-
+            discriminant = request.GET.get(self.resource_discriminative_param) or self.default_discriminative_value
             if (
                 settings.API_RESOURCE_SET_PARAM
                 and (
                     discriminant != self.default_discriminative_value
                     or settings.API_RESOURCE_SET_PARAM_FOR_DEFAULT
                 )
             ):
                 request.resource_args = {
                     self.resource_discriminative_param: discriminant,
                 }
-        else:
-            discriminant = self.default_discriminative_value
+            return discriminant
+        return self.default_discriminative_value
+
+    def dispatch(self, request: WSGIRequest, *args: typing.Any, **kwargs: typing.Any) -> Response:
+        discriminant = self.get_discriminant(request)
 
         resource_dispatch = self.resource_handlers_map.get(discriminant)
         if resource_dispatch:
             return resource_dispatch(request, *args, **kwargs)
         raise Http404()
```

## restdoctor/rest_framework/schema.py

```diff
@@ -180,15 +180,16 @@
 
 class RestDoctorSchema(AutoSchema):
     def __init__(self, generator: SchemaGenerator = None, *args: typing.Any, **kwargs: typing.Any) -> None:
         super().__init__(*args, **kwargs)
         self.generator = generator
 
     def map_renderers(self, *args: typing.Any, **kwargs: typing.Any) -> typing.Any:
-        media_types = ['application/vnd.bestdoctor']
+        vendor = getattr(settings, 'API_VENDOR_STRING', 'vendor')
+        media_types = [f'application/vnd.{vendor}']
         return media_types
 
     def get_operation(self, path: str, method: str) -> OpenAPISchema:
         view = self.view
 
         operation = super().get_operation(path, method)
```

## restdoctor/rest_framework/test_client.py

```diff
@@ -37,34 +37,34 @@
 
     def patch(self, *args: Any, **kwargs: Any) -> Response:
         return self._api_call('patch', *args, **kwargs)
 
     def delete_json(self, *args: Any, **kwargs: Any) -> Any:
         expected_status_codes = kwargs.pop(
             'expected_status_codes', [HTTP_200_OK, HTTP_202_ACCEPTED, HTTP_204_NO_CONTENT])
-        return self._json_api_call('delete',  *args, expected_status_codes=expected_status_codes, **kwargs)
+        return self._json_api_call('delete', *args, expected_status_codes=expected_status_codes, **kwargs)
 
     def get_json(self, *args: Any, **kwargs: Any) -> Any:
         expected_status_codes = kwargs.pop('expected_status_codes', [HTTP_200_OK])
-        return self._json_api_call('get',  *args, expected_status_codes=expected_status_codes, **kwargs)
+        return self._json_api_call('get', *args, expected_status_codes=expected_status_codes, **kwargs)
 
     def post_json(self, *args: Any, **kwargs: Any) -> Any:
         expected_status_codes = kwargs.pop('expected_status_codes', [HTTP_200_OK, HTTP_201_CREATED])
-        return self._json_api_call('post',  *args, expected_status_codes=expected_status_codes, **kwargs)
+        return self._json_api_call('post', *args, expected_status_codes=expected_status_codes, **kwargs)
 
     def put_json(self, *args: Any, **kwargs: Any) -> Any:
         expected_status_codes = kwargs.pop('expected_status_codes', [HTTP_200_OK])
-        return self._json_api_call('put',  *args, expected_status_codes=expected_status_codes, **kwargs)
+        return self._json_api_call('put', *args, expected_status_codes=expected_status_codes, **kwargs)
 
     def patch_json(self, *args: Any, **kwargs: Any) -> Any:
         expected_status_codes = kwargs.pop('expected_status_codes', [HTTP_200_OK])
-        return self._json_api_call('patch',  *args, expected_status_codes=expected_status_codes, **kwargs)
+        return self._json_api_call('patch', *args, expected_status_codes=expected_status_codes, **kwargs)
 
     def _api_call(
-        self, method: str, *args: Any, expected_status_codes: List[int] = None,  **kwargs: Any,
+        self, method: str, *args: Any, expected_status_codes: List[int] = None, **kwargs: Any,
     ) -> Response:
         accept = kwargs.get('accept') or kwargs.get('HTTP_ACCEPT') or self.accept
         authorization = kwargs.get('authorization') or kwargs.get('HTTP_AUTHORIZATION') or self.authorization
         content_type = kwargs.get('content_type') or self.content_type
 
         if 'json' in kwargs:
             kwargs['data'] = json.dumps(kwargs.pop('json'))
```

## restdoctor/utils/media_type.py

```diff
@@ -9,47 +9,89 @@
 
 @dataclasses.dataclass
 class APIParams:
     accepted: str
     vendor: str
     prefix: typing.Optional[str] = None
     version: str = settings.API_FALLBACK_VERSION
+    resource_discriminator: typing.Optional[str] = None
     format: str = settings.API_DEFAULT_FORMAT  # noqa: A003, VNE003
 
+    @property
+    def version_with_resource_discriminator(self) -> str:
+        if self.resource_discriminator is None:
+            return self.version
+        else:
+            return f'{self.version}-{self.resource_discriminator}'
+
 
 def parse_accept(header: str = None, vendor: str = None) -> typing.Optional[APIParams]:
     if not header:
         return None
     api_params = APIParams(
         prefix=get_api_prefix(),
         accepted=header,
         vendor=vendor or 'vendor',
     )
     api_options_string = header.split('/', 1)[-1]
-    if settings.API_FALLBACK_FOR_APPLICATION_JSON_ONLY:
+    if getattr(settings, 'API_FALLBACK_FOR_APPLICATION_JSON_ONLY', False):
         if api_options_string == 'json':
             return api_params
-    elif not header.startswith('application/vnd'):
+    elif not header.startswith(f'application/vnd.{api_params.vendor}'):
         return api_params
 
     api_params.version = settings.API_DEFAULT_VERSION
 
     api_options_string = api_options_string.split('+', 1)[0]
 
     parts = api_options_string.split('.')
-    for part in parts:
-        if part in settings.API_VERSIONS.keys():
-            api_params.version = part
-        if part in settings.API_FORMATS:
-            api_params.format = part
+    version = parse_version(parts)
+    resource_discriminator = parse_resource_discriminator(parts)
+    api_format = parse_api_format(parts)
+
+    if version:
+        api_params.version = version
+    if resource_discriminator:
+        api_params.resource_discriminator = resource_discriminator
+    if api_format:
+        api_params.format = api_format
     return api_params
 
 
+def parse_version(api_options_parts: typing.List[str]) -> typing.Optional[str]:
+    try:
+        part = api_options_parts[2]
+    except IndexError:
+        pass
+    else:
+        version, *_ = part.split('-', 1)
+        if version in settings.API_VERSIONS.keys():
+            return version
+
+
+def parse_resource_discriminator(api_options_parts: typing.List[str]) -> typing.Optional[str]:
+    try:
+        part = api_options_parts[2]
+        return part.split('-', 1)[1]
+    except IndexError:
+        pass
+
+
+def parse_api_format(api_options_parts: typing.List[str]) -> typing.Optional[str]:
+    try:
+        api_format = api_options_parts[3]
+    except IndexError:
+        pass
+    else:
+        if api_format in settings.API_FORMATS:
+            return api_format
+
+
 def get_api_header(params: APIParams) -> str:
-    return f'bestdoctor.{params.version}; format={params.format}'
+    return f'{params.vendor}.{params.version_with_resource_discriminator}; format={params.format}'
 
 
 def get_media_type(params: APIParams) -> str:
     if params.accepted.startswith('application/json'):
         return params.accepted
 
-    return f'application/vnd.{params.vendor}.{params.version}.{params.format}+json'
+    return f'application/vnd.{params.vendor}.{params.version_with_resource_discriminator}.{params.format}+json'
```

## tests/test_unit/conftest.py

```diff
@@ -1,15 +1,15 @@
 import pytest
 
 from pytest_factoryboy import register
 from restdoctor.rest_framework.pagination import (
     PageNumberPagination, PageNumberUncountedPagination,
     CursorUUIDPagination, CursorUUIDUncountedPagination,
 )
-from restdoctor.rest_framework.resources import ResourceViewSet, ResourceView
+from restdoctor.rest_framework.resources import ResourceViewSet, ResourceView, ResourceBase
 from restdoctor.utils.api_prefix import get_api_path_prefixes
 from tests.factories import MyModelFactory
 from tests.stubs.models import MyModel
 
 
 register(MyModelFactory)
 
@@ -88,7 +88,12 @@
         view_class = resource_class(resource_discriminator, resource_view, base=ResourceView)
         mocked_dispatch = mocker.patch.object(resource_view, 'dispatch')
         view_func = view_class.as_view()
 
         return view_func, mocked_dispatch
 
     return with_args
+
+
+@pytest.fixture()
+def get_discriminant_spy(mocker):
+    return mocker.spy(ResourceBase, 'get_discriminant')
```

## tests/test_unit/test_api_version_selector.py

```diff
@@ -99,12 +99,12 @@
         'v1': 'tests.stubs.api.v1_urls',
         'v2': 'tests.stubs.api.v2_urls',
     }
     settings.API_VENDOR_STRING = 'RestDoctor'
 
     response = client.post(
         f'/{api_prefix}{endpoint}', data='{}',
-        content_type='application/json', HTTP_ACCEPT='application/vnd.vendor',
+        content_type='application/json', HTTP_ACCEPT='application/vnd.restdoctor',
     )
 
     assert response.status_code == 200
     assert response['Content-Type'] == content_type
```

## tests/test_unit/test_parse_accept.py

```diff
@@ -11,15 +11,15 @@
 
 @pytest.mark.parametrize(
     'header,expected_version',
     (
         ('*/*', 'fallback'),
         ('text/html', 'fallback'),
         ('application/json', 'fallback'),
-        ('application/vnd.bestdoctor', 'default'),
+        ('application/vnd.vendor', 'default'),
     ),
 )
 def test_parse_accept_fallback(settings, header, expected_version):
     settings.API_FALLBACK_VERSION = 'fallback'
     settings.API_DEFAULT_VERSION = 'default'
     settings.API_VERSIONS = {
         'v1': 'v1',
@@ -34,15 +34,15 @@
 
 @pytest.mark.parametrize(
     'header,expected_version',
     (
         ('*/*', 'default'),
         ('text/html', 'default'),
         ('application/json', 'fallback'),
-        ('application/vnd.bestdoctor', 'default'),
+        ('application/vnd.vendor', 'default'),
     ),
 )
 def test_parse_accept_default(settings, header, expected_version):
     settings.API_FALLBACK_VERSION = 'fallback'
     settings.API_DEFAULT_VERSION = 'default'
     settings.API_VERSIONS = {
         'v1': 'v1',
@@ -52,39 +52,50 @@
 
     result = parse_accept(header)
 
     assert expected_version == result.version
 
 
 @pytest.mark.parametrize(
-    'header,expected_version',
-    (
-        ('application/vnd.bestdoctor', 'default'),
-        ('application/vnd.bestdoctor.v1', 'v1'),
-        ('application/vnd.bestdoctor.v1.full', 'v1'),
-        ('application/vnd.bestdoctor.v1.full+json', 'v1'),
-        ('application/vnd.bestdoctor.v2', 'v2'),
-        ('application/vnd.bestdoctor.v2.full', 'v2'),
-        ('application/vnd.bestdoctor.v2.full+json', 'v2'),
-        ('application/vnd.bestdoctor.v3', 'default'),
-        ('application/vnd.bestdoctor.v3.full', 'default'),
-        ('application/vnd.bestdoctor.v3.full+json', 'default'),
-    ),
+    ('header', 'expected_version', 'expected_discriminator'),
+    [
+        ('application/vnd.vendor', 'default', None),
+        ('application/vnd.vendor.v1', 'v1', None),
+        ('application/vnd.vendor.v1.full', 'v1', None),
+        ('application/vnd.vendor.v1.full+json', 'v1', None),
+        ('application/vnd.vendor.v1-extended', 'v1', 'extended'),
+        ('application/vnd.vendor.v1-extended.full', 'v1', 'extended'),
+        ('application/vnd.vendor.v1-extended.full+json', 'v1', 'extended'),
+        ('application/vnd.vendor.v2', 'v2', None),
+        ('application/vnd.vendor.v2.full', 'v2', None),
+        ('application/vnd.vendor.v2.full+json', 'v2', None),
+        ('application/vnd.vendor.v2-extended', 'v2', 'extended'),
+        ('application/vnd.vendor.v2-extended.full', 'v2', 'extended'),
+        ('application/vnd.vendor.v2-extended.full+json', 'v2', 'extended'),
+        ('application/vnd.vendor.v3', 'default', None),
+        ('application/vnd.vendor.v3.full', 'default', None),
+        ('application/vnd.vendor.v3.full+json', 'default', None),
+        ('application/vnd.vendor.v3-extended', 'default', 'extended'),
+        ('application/vnd.vendor.v3-extended.full', 'default', 'extended'),
+        ('application/vnd.vendor.v3-extended.full+json', 'default', 'extended'),
+    ],
 )
-def test_parse_accept_versions(settings, header, expected_version):
+def test_parse_accept_versions_and_resource_discriminator(settings, header, expected_version, expected_discriminator):
     settings.API_FALLBACK_VERSION = 'fallback'
     settings.API_DEFAULT_VERSION = 'default'
+    settings.API_RESOURCE_DEFAULT = 'common'
     settings.API_VERSIONS = {
         'v1': 'v1',
         'v2': 'v2',
     }
 
     result = parse_accept(header)
 
     assert expected_version == result.version
+    assert expected_discriminator == result.resource_discriminator
 
 
 @pytest.mark.parametrize(
     'vendor,expected_vendor',
     (
         (None, 'vendor'),
         ('', 'vendor'),
```

## tests/test_unit/test_resources.py

```diff
@@ -135,7 +135,51 @@
     resource_discriminator = 'one'
     view_func, mocked_dispatch = resource_view_dispatch(resource_discriminator, ModelAView)
     request = RequestFactory().get('/', {'view_type': resource_discriminator})
 
     view_func(request)
 
     assert mocked_dispatch.called_once()
+
+
+@pytest.mark.parametrize(
+    ('accept', 'view_type', 'expected_discriminant'),
+    [
+        ('application/vnd.vendor.v1', '', 'common'),
+        ('application/vnd.vendor.v1', 'extended', 'extended'),
+        ('application/vnd.vendor.v1-extended', '', 'extended'),
+        ('application/vnd.vendor.v1-extended', 'common', 'extended'),
+        ('application/vnd.vendor.v2', '', 'common'),
+    ]
+)
+@pytest.mark.django_db
+def test_get_discriminant_for_get_method(
+    accept, view_type, expected_discriminant,
+    settings, client, api_prefix, get_discriminant_spy,
+):
+    settings.API_VERSIONS = {'v1': 'tests.stubs.api.v1_urls'}
+    settings.API_RESOURCE_DEFAULT = 'common'
+
+    client.get(f'/{api_prefix}mymodel/', HTTP_ACCEPT=accept, data={'view_type': view_type})
+
+    assert get_discriminant_spy.spy_return == expected_discriminant
+
+
+@pytest.mark.parametrize(
+    ('accept', 'expected_discriminant'),
+    [
+        ('application/vnd.vendor.v1', 'common'),
+        ('application/vnd.vendor.v1-common', 'common'),
+        ('application/vnd.vendor.v1-extended', 'extended'),
+    ]
+)
+@pytest.mark.django_db
+def test_get_discriminant_for_post_method(
+    accept, expected_discriminant,
+    settings, client, api_prefix, get_discriminant_spy,
+):
+    settings.API_VERSIONS = {'v1': 'tests.stubs.api.v1_urls'}
+    settings.API_RESOURCE_DEFAULT = 'common'
+
+    client.post(f'/{api_prefix}mymodel/', HTTP_ACCEPT=accept)
+
+    assert get_discriminant_spy.spy_return == expected_discriminant
```

## tests/test_unit/test_schema/test_refs_schema_generator.py

```diff
@@ -15,13 +15,13 @@
     get_create_view_func, generator, expected_schema_keys,
 ):
     create_view = get_create_view_func('test', DefaultViewSet, 'test')
 
     view = create_view('/test/', 'GET')
     view.schema.generator = generator
     operation = view.schema.get_operation('/test/', 'GET')
-    responses_schema = operation['responses']['200']['content']['application/vnd.bestdoctor']['schema']
+    responses_schema = operation['responses']['200']['content']['application/vnd.vendor']['schema']
     responses_properties = responses_schema['properties']['data']
     if 'items' in responses_properties:
         responses_properties = responses_properties['items']
 
     assert list(responses_properties.keys()) == expected_schema_keys
```

## tests/test_unit/test_schema/test_serializer_class_map.py

```diff
@@ -18,14 +18,14 @@
     create_view = get_create_view_func('test', SerializerClassMapViewSet, 'test')
 
     view = create_view(path, method)
     schema = view.schema
     schema.generator = None
     result = view.schema.get_operation(path, method)
     code, _ = view.schema._get_action_code_description(path, method)
-    responses_schema = result['responses'][code]['content']['application/vnd.bestdoctor']['schema']
+    responses_schema = result['responses'][code]['content']['application/vnd.vendor']['schema']
     responses_properties = responses_schema['properties']['data']
     if 'items' in responses_properties:
         responses_properties = responses_properties['items']
 
     assert result['operationId'] == expected_operation_id
     assert responses_properties['required'] == expected_responses_required
```

## Comparing `restdoctor-0.0.8.dist-info/METADATA` & `restdoctor-0.0.9.dist-info/METADATA`

 * *Files 15% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: restdoctor
-Version: 0.0.8
+Version: 0.0.9
 Summary: BestDoctor's batteries for REST services.
 Home-page: UNKNOWN
 Author: BestDoctor
 Author-email: s.butkin@bestdoctor.ru
 License: MIT
 Keywords: statistics
 Platform: UNKNOWN
```

## Comparing `restdoctor-0.0.8.dist-info/RECORD` & `restdoctor-0.0.9.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-restdoctor/__init__.py,sha256=WZcpG_zAZUG9oTdnjR1YjkchV3uvqRsRq0QKSFxEx-w,72
+restdoctor/__init__.py,sha256=pXPyhKriwIJD6LtjWkNN_WNBmg0WMoIct_bBRVI7wuc,72
 restdoctor/app_settings.py,sha256=vAha5zLaon8OtMBD6cM3Ongs6Optz0VQxce0PjePREk,566
 restdoctor/apps.py,sha256=gdySuGRglsIv_m6ZlTnAiPKQh2Hf4B7BQMaS-2j2ViU,675
 restdoctor/constants.py,sha256=T2WwgsYrkxatSqcrTU-UEwRvqc0xibPJFRSXBl6B29w,122
 restdoctor/django/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 restdoctor/django/custom_types.py,sha256=cnhIx8_ECFH2JN5Al_fF1nqhnS_x-yAOjsdvU_Y6s8Q,243
 restdoctor/django/sensitive_data.py,sha256=I_S6n8lMKWHTYMvIEY1Z-Ob1iSt4x7TYyF3aRVSU6u4,667
 restdoctor/django/middleware/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
@@ -14,59 +14,59 @@
 restdoctor/rest_framework/fields.py,sha256=lxiETchfUQMT5AKSJL6aPOO5KdMqWtRa6VlRK-nG5sU,1378
 restdoctor/rest_framework/generics.py,sha256=QDlNnvgpuHkjt-8O-Dsn-tnJC1LpSt7ttmx9m90rUrw,2021
 restdoctor/rest_framework/mixins.py,sha256=i7S2BYAKNgVaCQVkAizCVFudTakEuHNC4hyQWEm-4Uw,3827
 restdoctor/rest_framework/negotiations.py,sha256=LptfOWxUtpesIugTN4h5YqMBUDe8buq0fr392yhZDrA,1279
 restdoctor/rest_framework/pagination.py,sha256=42FbOlXBQSjPWsQ-tGj6ZaBoYp6NgvjpRcsXDR2BIgc,12413
 restdoctor/rest_framework/parsers.py,sha256=WVDjWRgMlY7df_n4vgZI7YVUSZpbNXVH9xn3RLYDjJQ,384
 restdoctor/rest_framework/renderers.py,sha256=lsZ9hcnEnqtF6Giul7WZt-TGvXljYIV2ysoya_GFQDc,1292
-restdoctor/rest_framework/resources.py,sha256=MwtGBm_8Y5D8KRj7kErCslI0bSs1p0EN8rP5GmyFa0w,7859
+restdoctor/rest_framework/resources.py,sha256=ff9v8rfKhmBFlfujvx9REMRrYnRk8uK9Z4CU2fl1S3I,8046
 restdoctor/rest_framework/response.py,sha256=yk2RW8aBcD7jbpojupxNjBsSD0mFpjOmyOxFqJPBMKI,809
 restdoctor/rest_framework/reverse.py,sha256=hScdrNh_sMRQPblIH4KxGlWYB0qJGxKAuh5ncGQfW4o,941
 restdoctor/rest_framework/routers.py,sha256=WU3pfJN9SoD3XKnp__GoI44NpTWwMdgtY1GmslUtLDA,4324
-restdoctor/rest_framework/schema.py,sha256=-0IKspUNPy1aJh7TYVBYxwIg6877g__1IRyW2quuTEY,20878
+restdoctor/rest_framework/schema.py,sha256=gq_BkMdbPJi2dyftKNk_yl2m9ac58CUAdvU7frctpjI,20943
 restdoctor/rest_framework/sensitive_data.py,sha256=lWldlxQXVUjHE4qxmUJeLIvrLAxMg6gFaH_XpY6UKBY,4366
 restdoctor/rest_framework/serializers.py,sha256=SPfQGbCpAhrnBOS5s_Ji5eta0YThAQw93glhS2zpEPY,253
 restdoctor/rest_framework/signals.py,sha256=paw_UcyPAKmtJ844e4p04_aUNXCG-KM081_NFddyQtU,124
-restdoctor/rest_framework/test_client.py,sha256=CON9uiU3jZv_l39vdyFI-UMzc4aUudhYiqw9GVQjcLg,3708
+restdoctor/rest_framework/test_client.py,sha256=B3hn2eoV2mBl2E3uivdrIALJIExlelqZS4tko9g8XOs,3702
 restdoctor/rest_framework/views.py,sha256=y-LfaLi_Txvk9Y5Oha-n0MTUl8VVXFx9fWc30kOCmI8,6576
 restdoctor/rest_framework/viewsets.py,sha256=DUn3-A2odHTA_eTHZO_P28uzreiqmEwtY360ciUlI0w,912
 restdoctor/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 restdoctor/utils/api_prefix.py,sha256=4iyEoi5Eywya3_FyIGLhb8QF8TYRosCKwbHW19h2N7s,1234
 restdoctor/utils/constants.py,sha256=u-WLDpF5dCKc4P0MGyLecqqzRDeOXhMHW9D-aVOVn4g,164
 restdoctor/utils/custom_types.py,sha256=WfI-rzmn32kvdgON2pKImiIVfxEKEFhwMsIbchLUAwQ,385
 restdoctor/utils/helpers.py,sha256=5aeJ1InqFEBxLc31QXtyp7PPwLrl1GiCK6BTy_Tznb8,153
 restdoctor/utils/jwt_token.py,sha256=I3cm0O_BwwhU5M3OT2ALQdUAmRu0GTP69zzap_y7aF8,1637
-restdoctor/utils/media_type.py,sha256=YuQhCf31sEZtbK50bCIfp-sMlO0qnIkeenUpxAZrDnY,1604
+restdoctor/utils/media_type.py,sha256=FE51xcxOLTfO1NFfuVyUE7_aFDdJ-ngYdfG_2nM8zUg,2925
 restdoctor/utils/permissions.py,sha256=aM_DDkxmRd2xX50xPXkP347wECqNMrCSwUWy1u6hhyc,587
 restdoctor/utils/sentry.py,sha256=K6S_3XX9n8ydWuTjMpN723g4jkd2l3KpWu_PDHWKBmk,120
 restdoctor/utils/serializers.py,sha256=M_wWq2l0bOVHeFLXkCCcXAwO8GNxE7kLlL5oKYfiawM,2395
 restdoctor/utils/structlog.py,sha256=HHtL3pWuFDf2iE-_xlZySH_6TEqOobyMbnccnopMnQA,124
 tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/conftest.py,sha256=2E3KsXp9y7I6IGIWDEtGwhz5ZodzhJdKse5mKzpQxjg,239
 tests/factories.py,sha256=JkYWiFqSf_FsMDnnindvagpY3-rNdBDBZI-WfX2qq58,170
 tests/test_settings.py,sha256=gcfUArOhhOPyY-w51_Ytem5e6nop2zGWrDPXjX9o2hg,3927
 tests/test_unit/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-tests/test_unit/conftest.py,sha256=pY7bDoDtw3DnMepHYh6ZsgrCt2l7WejzzVUa0fMpHbY,2648
+tests/test_unit/conftest.py,sha256=xWkhFfO9jdHyn0OPPa7XgYJUFzTvAI3aTXeomObsWwg,2772
 tests/test_unit/stubs.py,sha256=lio7YjLRKM1sEeg631BlYIXG8gR7XxR6pf4TuP2EWUw,4382
 tests/test_unit/test_api_prefixes.py,sha256=go2xr24CxjHn4w9FtCFehzGQwilfvrsoyIgxMuli-OE,1151
-tests/test_unit/test_api_version_selector.py,sha256=aCDS5XJpIx_Qcdc92uYyxlhDJx9HwR2CLdDepeoEFpU,3113
+tests/test_unit/test_api_version_selector.py,sha256=iD2oJozrIhggs3o6kuxbj1vLEy1qKzp2r9oZ5dIHsJ8,3117
 tests/test_unit/test_fields.py,sha256=3ig2BNoMh_uxzveY0uS5ymd12HUGWnlYdNaDrzrtewk,899
 tests/test_unit/test_pagination.py,sha256=xF_yVihid6DqtOXowyCRxBfxXRdA7Vl0CQ_cZOFcDOA,10262
-tests/test_unit/test_parse_accept.py,sha256=Oecc2AAXShV6nRuxZq72js_6gG2tXkzQN_csc2CuSe8,2642
+tests/test_unit/test_parse_accept.py,sha256=0W7M8r7jPn9ViBZOHeRjEGSUmB2PBH_tpKV2E21Z2Kk,3502
 tests/test_unit/test_permissions.py,sha256=2Hdk7VUpSPPUGo1R7UDi3xwtlxOttkxOk9tqBHqASh8,919
-tests/test_unit/test_resources.py,sha256=k9t6eRXY0Q5wCr_ETnOcIFCCXc-jEmuAm5LEU3L1RpE,4670
+tests/test_unit/test_resources.py,sha256=byHgwpNULscRz0AFAPI7RzB-SxWXP6biWwr28V_yHiE,6155
 tests/test_unit/test_response_with_meta.py,sha256=1BN0HJwDphrgVJ1jV7aWA0SFr4gKvG0vSoiRRmJPUi8,462
 tests/test_unit/test_sensitive_data.py,sha256=s1njAzsXCe5fKw55KmiWTJGXV6YwVzj7N4tTaZzB3l0,4267
 tests/test_unit/test_serializers.py,sha256=WbrKfozIMBq8CocnoNsWVeV-Np7c4ThRIge3e_rZ9DM,2261
 tests/test_unit/test_schema/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/test_unit/test_schema/conftest.py,sha256=cdhkaF_ViQE5prWpBoxG6Tub_rvtrcppsWfoSxN3PFc,743
 tests/test_unit/test_schema/stubs.py,sha256=lxl7wds2SskdgPpBhhY-KrQiOzrNh57UpCVZiV0ffOQ,1236
 tests/test_unit/test_schema/test_error_handlers_schema.py,sha256=AwzvAaLZ2wiD-K_Dtqbl_3qySAmPPocucaT3bzBchqQ,657
 tests/test_unit/test_schema/test_fields_schema.py,sha256=mnWAfFzceGywXs1fIcbpDq7JgJBCBrn69bfcss6sQLE,1783
-tests/test_unit/test_schema/test_refs_schema_generator.py,sha256=ji_W2VCHhIOB_70yFIVLvniEHIbbboJ970lM8j8PF8Q,1000
+tests/test_unit/test_schema/test_refs_schema_generator.py,sha256=cCLFnYRKW4kaqdpg40vo-59xlmnHlN9DD2r77CSPOOQ,996
 tests/test_unit/test_schema/test_resource_schema.py,sha256=H8b9s1k2jS4xYcwgTN4L41Oq96ocRBxBMTb-TzQeJoA,2055
 tests/test_unit/test_schema/test_schema_tags.py,sha256=6-m5Lt7qaz1L2qDoqu3LhaFhoVHmGMc1SbKCI05Mpd8,1164
-tests/test_unit/test_schema/test_serializer_class_map.py,sha256=bqiUPUQ0hYGsHnMjUnd197AtznqhDEgMR6LGLwuysEY,1220
-restdoctor-0.0.8.dist-info/METADATA,sha256=DhLeIIBEJZDL0HfecNK2sLV1FVEjplRk159tS13LxvE,666
-restdoctor-0.0.8.dist-info/WHEEL,sha256=EVRjI69F5qVjm_YgqcTXPnTAv3BfSUr0WVAHuSP3Xoo,92
-restdoctor-0.0.8.dist-info/top_level.txt,sha256=kTTjojzyQe8RiLx8RmX3NcJyx-QjACB2PznK_t9AlyQ,17
-restdoctor-0.0.8.dist-info/RECORD,,
+tests/test_unit/test_schema/test_serializer_class_map.py,sha256=4XJ2RvA14mXPElLL4m1YtcpTk8A6in0J1QbDkqUrms4,1216
+restdoctor-0.0.9.dist-info/METADATA,sha256=mFjgrQ9h8cMDjK8tGeIkTS9xFNp3uHCEt8h9a5lXkdg,666
+restdoctor-0.0.9.dist-info/WHEEL,sha256=EVRjI69F5qVjm_YgqcTXPnTAv3BfSUr0WVAHuSP3Xoo,92
+restdoctor-0.0.9.dist-info/top_level.txt,sha256=kTTjojzyQe8RiLx8RmX3NcJyx-QjACB2PznK_t9AlyQ,17
+restdoctor-0.0.9.dist-info/RECORD,,
```

