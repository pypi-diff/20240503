# Comparing `tmp/dask-2024.4.1.tar.gz` & `tmp/dask-2024.4.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-2024.4.1.tar", last modified: Thu Apr  4 16:12:05 2024, max compression
+gzip compressed data, was "dask-2024.4.2.tar", last modified: Fri Apr 19 21:07:59 2024, max compression
```

## Comparing `dask-2024.4.1.tar` & `dask-2024.4.2.tar`

### file list

```diff
@@ -1,500 +1,502 @@
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.323315 dask-2024.4.1/
--rw-r--r--   0 james      (501) staff       (20)     1531 2023-07-17 19:15:27.000000 dask-2024.4.1/LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)      325 2023-07-17 19:15:27.000000 dask-2024.4.1/MANIFEST.in
--rw-r--r--   0 james      (501) staff       (20)     3780 2024-04-04 16:12:05.323058 dask-2024.4.1/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)     1291 2023-07-17 19:15:27.000000 dask-2024.4.1/README.rst
--rw-r--r--   0 james      (501) staff       (20)     1598 2024-01-23 19:42:07.000000 dask-2024.4.1/conftest.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.215269 dask-2024.4.1/dask/
--rw-r--r--   0 james      (501) staff       (20)      485 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      133 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/__main__.py
--rw-r--r--   0 james      (501) staff       (20)      720 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)      500 2024-04-04 16:12:05.323511 dask-2024.4.1/dask/_version.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.221729 dask-2024.4.1/dask/array/
--rw-r--r--   0 james      (501) staff       (20)     1543 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/array/NUMPY_LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)     5413 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12600 2023-12-20 15:38:57.000000 dask-2024.4.1/dask/array/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9983 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/blockwise.py
--rw-r--r--   0 james      (501) staff       (20)    12304 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/chunk.py
--rw-r--r--   0 james      (501) staff       (20)     5066 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/chunk_types.py
--rw-r--r--   0 james      (501) staff       (20)   191264 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/core.py
--rw-r--r--   0 james      (501) staff       (20)    40514 2023-10-25 14:44:16.000000 dask-2024.4.1/dask/array/creation.py
--rw-r--r--   0 james      (501) staff       (20)     2114 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/cupy_entry_point.py
--rw-r--r--   0 james      (501) staff       (20)      526 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     9146 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/einsumfuncs.py
--rw-r--r--   0 james      (501) staff       (20)     7677 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/fft.py
--rw-r--r--   0 james      (501) staff       (20)    32656 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1996 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/image.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.222049 dask-2024.4.1/dask/array/lib/
--rw-r--r--   0 james      (501) staff       (20)       77 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/lib/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      101 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/lib/stride_tricks.py
--rw-r--r--   0 james      (501) staff       (20)    53218 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/array/linalg.py
--rw-r--r--   0 james      (501) staff       (20)     6363 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/ma.py
--rw-r--r--   0 james      (501) staff       (20)     6078 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12838 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28479 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/overlap.py
--rw-r--r--   0 james      (501) staff       (20)    10916 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/percentile.py
--rw-r--r--   0 james      (501) staff       (20)    40605 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/random.py
--rw-r--r--   0 james      (501) staff       (20)    28323 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    58469 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/reductions.py
--rw-r--r--   0 james      (501) staff       (20)    10766 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    81576 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/routines.py
--rw-r--r--   0 james      (501) staff       (20)    72865 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/slicing.py
--rw-r--r--   0 james      (501) staff       (20)    16184 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/array/stats.py
--rw-r--r--   0 james      (501) staff       (20)     8048 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/svg.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.228802 dask-2024.4.1/dask/array/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/array/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)   162686 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/tests/test_array_core.py
--rw-r--r--   0 james      (501) staff       (20)     6689 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_array_function.py
--rw-r--r--   0 james      (501) staff       (20)     3159 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_array_utils.py
--rw-r--r--   0 james      (501) staff       (20)    23222 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_atop.py
--rw-r--r--   0 james      (501) staff       (20)     3304 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_chunk.py
--rw-r--r--   0 james      (501) staff       (20)    31190 2023-10-25 14:44:16.000000 dask-2024.4.1/dask/array/tests/test_creation.py
--rw-r--r--   0 james      (501) staff       (20)    19888 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_core.py
--rw-r--r--   0 james      (501) staff       (20)     6496 2023-10-25 14:44:16.000000 dask-2024.4.1/dask/array/tests/test_cupy_creation.py
--rw-r--r--   0 james      (501) staff       (20)      594 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)    13412 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_linalg.py
--rw-r--r--   0 james      (501) staff       (20)     4303 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     2730 2024-03-13 20:06:30.000000 dask-2024.4.1/dask/array/tests/test_cupy_percentile.py
--rw-r--r--   0 james      (501) staff       (20)     9219 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_random.py
--rw-r--r--   0 james      (501) staff       (20)     2224 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7436 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/tests/test_cupy_routines.py
--rw-r--r--   0 james      (501) staff       (20)     4877 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     2982 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_cupy_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     8866 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/tests/test_dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     8821 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/tests/test_fft.py
--rw-r--r--   0 james      (501) staff       (20)    21013 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1482 2023-09-28 22:08:27.000000 dask-2024.4.1/dask/array/tests/test_image.py
--rw-r--r--   0 james      (501) staff       (20)    37415 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/tests/test_linalg.py
--rw-r--r--   0 james      (501) staff       (20)    15714 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/tests/test_masked.py
--rw-r--r--   0 james      (501) staff       (20)     1087 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    17446 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    26718 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     3443 2023-11-07 18:15:20.000000 dask-2024.4.1/dask/array/tests/test_percentiles.py
--rw-r--r--   0 james      (501) staff       (20)    15352 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)    36262 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/array/tests/test_rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    33283 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/array/tests/test_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7289 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    84472 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/array/tests/test_routines.py
--rw-r--r--   0 james      (501) staff       (20)    32264 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/array/tests/test_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     6592 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     5489 2023-09-28 22:08:27.000000 dask-2024.4.1/dask/array/tests/test_stats.py
--rw-r--r--   0 james      (501) staff       (20)     2740 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_svg.py
--rw-r--r--   0 james      (501) staff       (20)      525 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_testing.py
--rw-r--r--   0 james      (501) staff       (20)    17390 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)     2706 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_wrap.py
--rw-r--r--   0 james      (501) staff       (20)     1317 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tests/test_xarray.py
--rw-r--r--   0 james      (501) staff       (20)     4737 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/tiledb_io.py
--rw-r--r--   0 james      (501) staff       (20)    10030 2024-03-13 20:06:30.000000 dask-2024.4.1/dask/array/ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    19112 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/array/utils.py
--rw-r--r--   0 james      (501) staff       (20)     6906 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/array/wrap.py
--rw-r--r--   0 james      (501) staff       (20)     5122 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/backends.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.229855 dask-2024.4.1/dask/bag/
--rw-r--r--   0 james      (501) staff       (20)      903 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     9111 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/avro.py
--rw-r--r--   0 james      (501) staff       (20)      763 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/chunk.py
--rw-r--r--   0 james      (501) staff       (20)    86002 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/bag/core.py
--rw-r--r--   0 james      (501) staff       (20)     5464 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/random.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.230557 dask-2024.4.1/dask/bag/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/bag/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     3808 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/tests/test_avro.py
--rw-r--r--   0 james      (501) staff       (20)    51280 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/bag/tests/test_bag.py
--rw-r--r--   0 james      (501) staff       (20)     6528 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)     5049 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/tests/test_text.py
--rw-r--r--   0 james      (501) staff       (20)     6765 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/text.py
--rw-r--r--   0 james      (501) staff       (20)      241 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bag/utils.py
--rw-r--r--   0 james      (501) staff       (20)    54892 2024-04-01 19:10:34.000000 dask-2024.4.1/dask/base.py
--rw-r--r--   0 james      (501) staff       (20)    53276 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/blockwise.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.231162 dask-2024.4.1/dask/bytes/
--rw-r--r--   0 james      (501) staff       (20)       75 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bytes/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6933 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bytes/core.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.232021 dask-2024.4.1/dask/bytes/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/bytes/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     5158 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bytes/tests/test_bytes_utils.py
--rw-r--r--   0 james      (501) staff       (20)      530 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bytes/tests/test_compression.py
--rw-r--r--   0 james      (501) staff       (20)     6815 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/bytes/tests/test_http.py
--rw-r--r--   0 james      (501) staff       (20)    11476 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bytes/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)    19556 2024-01-29 17:27:45.000000 dask-2024.4.1/dask/bytes/tests/test_s3.py
--rw-r--r--   0 james      (501) staff       (20)      500 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/bytes/utils.py
--rw-r--r--   0 james      (501) staff       (20)     2001 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/cache.py
--rw-r--r--   0 james      (501) staff       (20)     4067 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     5773 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/cli.py
--rw-r--r--   0 james      (501) staff       (20)      523 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    24786 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/config.py
--rw-r--r--   0 james      (501) staff       (20)      959 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/conftest.py
--rw-r--r--   0 james      (501) staff       (20)     1756 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/context.py
--rw-r--r--   0 james      (501) staff       (20)    15772 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/core.py
--rw-r--r--   0 james      (501) staff       (20)     7854 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dask-schema.yaml
--rw-r--r--   0 james      (501) staff       (20)     1955 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dask.yaml
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.235769 dask-2024.4.1/dask/dataframe/
--rw-r--r--   0 james      (501) staff       (20)     5405 2024-04-01 19:10:34.000000 dask-2024.4.1/dask/dataframe/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7642 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/_compat.py
--rw-r--r--   0 james      (501) staff       (20)     2171 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/dataframe/_dtypes.py
--rw-r--r--   0 james      (501) staff       (20)     3974 2024-02-06 16:03:46.000000 dask-2024.4.1/dask/dataframe/_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     2743 2023-11-10 20:46:15.000000 dask-2024.4.1/dask/dataframe/_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)      393 2024-01-25 18:24:19.000000 dask-2024.4.1/dask/dataframe/_testing.py
--rw-r--r--   0 james      (501) staff       (20)    13386 2024-04-04 16:02:31.000000 dask-2024.4.1/dask/dataframe/accessor.py
--rw-r--r--   0 james      (501) staff       (20)    25843 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9507 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/categorical.py
--rw-r--r--   0 james      (501) staff       (20)   314038 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/core.py
--rw-r--r--   0 james      (501) staff       (20)     4577 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)      552 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/extensions.py
--rw-r--r--   0 james      (501) staff       (20)   117451 2024-04-01 19:10:34.000000 dask-2024.4.1/dask/dataframe/groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2463 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    13412 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/indexing.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.236892 dask-2024.4.1/dask/dataframe/io/
--rw-r--r--   0 james      (501) staff       (20)      706 2023-09-25 17:06:23.000000 dask-2024.4.1/dask/dataframe/io/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    34437 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/csv.py
--rw-r--r--   0 james      (501) staff       (20)    18830 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/demo.py
--rw-r--r--   0 james      (501) staff       (20)    18384 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/io/hdf.py
--rw-r--r--   0 james      (501) staff       (20)    38600 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/io.py
--rw-r--r--   0 james      (501) staff       (20)    11163 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/dataframe/io/json.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.237460 dask-2024.4.1/dask/dataframe/io/orc/
--rw-r--r--   0 james      (501) staff       (20)       92 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/io/orc/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     4487 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/io/orc/arrow.py
--rw-r--r--   0 james      (501) staff       (20)     7183 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/io/orc/core.py
--rw-r--r--   0 james      (501) staff       (20)      510 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/io/orc/utils.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.238242 dask-2024.4.1/dask/dataframe/io/parquet/
--rw-r--r--   0 james      (501) staff       (20)      166 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/io/parquet/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    72803 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/parquet/arrow.py
--rw-r--r--   0 james      (501) staff       (20)    67054 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/parquet/core.py
--rw-r--r--   0 james      (501) staff       (20)    52314 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/parquet/fastparquet.py
--rw-r--r--   0 james      (501) staff       (20)    32900 2023-10-27 21:32:35.000000 dask-2024.4.1/dask/dataframe/io/parquet/utils.py
--rw-r--r--   0 james      (501) staff       (20)    21270 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/sql.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.239608 dask-2024.4.1/dask/dataframe/io/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/dataframe/io/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    61918 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/tests/test_csv.py
--rw-r--r--   0 james      (501) staff       (20)    11436 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/tests/test_demo.py
--rw-r--r--   0 james      (501) staff       (20)    27324 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/io/tests/test_hdf.py
--rw-r--r--   0 james      (501) staff       (20)    35589 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/tests/test_io.py
--rw-r--r--   0 james      (501) staff       (20)     8812 2023-09-21 15:09:09.000000 dask-2024.4.1/dask/dataframe/io/tests/test_json.py
--rw-r--r--   0 james      (501) staff       (20)     5302 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/io/tests/test_orc.py
--rw-r--r--   0 james      (501) staff       (20)   166161 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/io/tests/test_parquet.py
--rw-r--r--   0 james      (501) staff       (20)    17632 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/io/tests/test_sql.py
--rw-r--r--   0 james      (501) staff       (20)     8041 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/dataframe/io/utils.py
--rw-r--r--   0 james      (501) staff       (20)    14713 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/dataframe/methods.py
--rw-r--r--   0 james      (501) staff       (20)    55455 2024-02-09 22:36:17.000000 dask-2024.4.1/dask/dataframe/multi.py
--rw-r--r--   0 james      (501) staff       (20)     1600 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/numeric.py
--rw-r--r--   0 james      (501) staff       (20)     8780 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/optimize.py
--rw-r--r--   0 james      (501) staff       (20)    20819 2023-10-25 14:44:16.000000 dask-2024.4.1/dask/dataframe/partitionquantiles.py
--rw-r--r--   0 james      (501) staff       (20)    11868 2023-10-27 21:32:31.000000 dask-2024.4.1/dask/dataframe/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    22170 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/rolling.py
--rw-r--r--   0 james      (501) staff       (20)    40190 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/shuffle.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.243395 dask-2024.4.1/dask/dataframe/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/dataframe/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    11131 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_accessors.py
--rw-r--r--   0 james      (501) staff       (20)    70713 2024-01-30 19:27:46.000000 dask-2024.4.1/dask/dataframe/tests/test_arithmetics_reduction.py
--rw-r--r--   0 james      (501) staff       (20)      942 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/tests/test_boolean.py
--rw-r--r--   0 james      (501) staff       (20)    17863 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_categorical.py
--rw-r--r--   0 james      (501) staff       (20)   209193 2024-04-04 15:04:44.000000 dask-2024.4.1/dask/dataframe/tests/test_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     1457 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_extensions.py
--rw-r--r--   0 james      (501) staff       (20)    14847 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/tests/test_format.py
--rw-r--r--   0 james      (501) staff       (20)   127454 2024-04-04 15:04:44.000000 dask-2024.4.1/dask/dataframe/tests/test_groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2702 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dataframe/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     2897 2024-01-30 19:27:46.000000 dask-2024.4.1/dask/dataframe/tests/test_hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    23962 2024-02-06 16:03:46.000000 dask-2024.4.1/dask/dataframe/tests/test_indexing.py
--rw-r--r--   0 james      (501) staff       (20)     7990 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/tests/test_merge_column_and_index.py
--rw-r--r--   0 james      (501) staff       (20)      463 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/dataframe/tests/test_methods.py
--rw-r--r--   0 james      (501) staff       (20)    96566 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_multi.py
--rw-r--r--   0 james      (501) staff       (20)     2624 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_numeric.py
--rw-r--r--   0 james      (501) staff       (20)     1188 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/tests/test_optimize_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     6662 2023-09-25 17:06:24.000000 dask-2024.4.1/dask/dataframe/tests/test_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     5059 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    11551 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/dataframe/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    18504 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_rolling.py
--rw-r--r--   0 james      (501) staff       (20)    63506 2024-01-30 19:27:46.000000 dask-2024.4.1/dask/dataframe/tests/test_shuffle.py
--rw-r--r--   0 james      (501) staff       (20)    16922 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/dataframe/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    22240 2024-04-01 19:10:34.000000 dask-2024.4.1/dask/dataframe/tests/test_utils_dataframe.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.243682 dask-2024.4.1/dask/dataframe/tseries/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/dataframe/tseries/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7675 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/dataframe/tseries/resample.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.243961 dask-2024.4.1/dask/dataframe/tseries/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/dataframe/tseries/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7028 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/dataframe/tseries/tests/test_resample.py
--rw-r--r--   0 james      (501) staff       (20)    27538 2023-09-25 17:06:24.000000 dask-2024.4.1/dask/dataframe/utils.py
--rw-r--r--   0 james      (501) staff       (20)     5331 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/datasets.py
--rw-r--r--   0 james      (501) staff       (20)    24814 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/delayed.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.244576 dask-2024.4.1/dask/diagnostics/
--rw-r--r--   0 james      (501) staff       (20)      258 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/diagnostics/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12136 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/diagnostics/profile.py
--rw-r--r--   0 james      (501) staff       (20)    16332 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/diagnostics/profile_visualize.py
--rw-r--r--   0 james      (501) staff       (20)     5001 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/diagnostics/progress.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.244973 dask-2024.4.1/dask/diagnostics/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/diagnostics/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12045 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/diagnostics/tests/test_profiler.py
--rw-r--r--   0 james      (501) staff       (20)     3388 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/diagnostics/tests/test_progress.py
--rw-r--r--   0 james      (501) staff       (20)      715 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/distributed.py
--rw-r--r--   0 james      (501) staff       (20)    16587 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/dot.py
--rw-r--r--   0 james      (501) staff       (20)    19622 2023-10-25 14:44:16.000000 dask-2024.4.1/dask/graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     2492 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/hashing.py
--rw-r--r--   0 james      (501) staff       (20)    35516 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/highlevelgraph.py
--rw-r--r--   0 james      (501) staff       (20)    46004 2023-09-13 17:55:33.000000 dask-2024.4.1/dask/layers.py
--rw-r--r--   0 james      (501) staff       (20)    18896 2023-09-13 17:55:33.000000 dask-2024.4.1/dask/local.py
--rw-r--r--   0 james      (501) staff       (20)      487 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/ml.py
--rw-r--r--   0 james      (501) staff       (20)     8474 2023-09-13 17:55:33.000000 dask-2024.4.1/dask/multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    36224 2024-02-09 15:39:56.000000 dask-2024.4.1/dask/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    32839 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/order.py
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/py.typed
--rw-r--r--   0 james      (501) staff       (20)    12597 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7621 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     2089 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/system.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.250290 dask-2024.4.1/dask/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.1/dask/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      824 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/tests/test_backends.py
--rw-r--r--   0 james      (501) staff       (20)    33013 2024-02-09 15:39:56.000000 dask-2024.4.1/dask/tests/test_base.py
--rw-r--r--   0 james      (501) staff       (20)     1613 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_cache.py
--rw-r--r--   0 james      (501) staff       (20)     2570 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     1224 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_ci.py
--rw-r--r--   0 james      (501) staff       (20)     7488 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_cli.py
--rw-r--r--   0 james      (501) staff       (20)      379 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    20268 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_config.py
--rw-r--r--   0 james      (501) staff       (20)     1137 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_context.py
--rw-r--r--   0 james      (501) staff       (20)     8203 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/tests/test_core.py
--rw-r--r--   0 james      (501) staff       (20)     1112 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_datasets.py
--rw-r--r--   0 james      (501) staff       (20)    22962 2024-02-09 15:39:56.000000 dask-2024.4.1/dask/tests/test_delayed.py
--rw-r--r--   0 james      (501) staff       (20)    33448 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_distributed.py
--rw-r--r--   0 james      (501) staff       (20)      719 2024-03-13 20:06:30.000000 dask-2024.4.1/dask/tests/test_docs.py
--rw-r--r--   0 james      (501) staff       (20)    12271 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_dot.py
--rw-r--r--   0 james      (501) staff       (20)    15338 2024-01-29 17:27:45.000000 dask-2024.4.1/dask/tests/test_graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     1095 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     9231 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_highgraph.py
--rw-r--r--   0 james      (501) staff       (20)     9040 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_layers.py
--rw-r--r--   0 james      (501) staff       (20)     5022 2023-12-13 17:43:46.000000 dask-2024.4.1/dask/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)      419 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_ml.py
--rw-r--r--   0 james      (501) staff       (20)     8457 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    47821 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    69758 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_order.py
--rw-r--r--   0 james      (501) staff       (20)     4684 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7526 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/tests/test_sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     7228 2024-01-23 19:42:03.000000 dask-2024.4.1/dask/tests/test_spark_compat.py
--rw-r--r--   0 james      (501) staff       (20)     2571 2023-08-21 21:39:12.000000 dask-2024.4.1/dask/tests/test_system.py
--rw-r--r--   0 james      (501) staff       (20)     4749 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_threaded.py
--rw-r--r--   0 james      (501) staff       (20)    39981 2024-03-13 20:06:30.000000 dask-2024.4.1/dask/tests/test_tokenize.py
--rw-r--r--   0 james      (501) staff       (20)     4591 2023-09-15 13:43:23.000000 dask-2024.4.1/dask/tests/test_traceback.py
--rw-r--r--   0 james      (501) staff       (20)     5708 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/tests/test_typing.py
--rw-r--r--   0 james      (501) staff       (20)    23636 2024-01-23 19:42:07.000000 dask-2024.4.1/dask/tests/test_utils.py
--rw-r--r--   0 james      (501) staff       (20)     1598 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/test_utils_test.py
--rw-r--r--   0 james      (501) staff       (20)      211 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/tests/warning_aliases.py
--rw-r--r--   0 james      (501) staff       (20)     3001 2023-09-13 17:55:33.000000 dask-2024.4.1/dask/threaded.py
--rw-r--r--   0 james      (501) staff       (20)    15497 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/typing.py
--rw-r--r--   0 james      (501) staff       (20)    63637 2024-03-13 20:06:34.000000 dask-2024.4.1/dask/utils.py
--rw-r--r--   0 james      (501) staff       (20)     4825 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/utils_test.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.250702 dask-2024.4.1/dask/widgets/
--rw-r--r--   0 james      (501) staff       (20)      792 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/__init__.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.251672 dask-2024.4.1/dask/widgets/templates/
--rw-r--r--   0 james      (501) staff       (20)     1295 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/templates/array.html.j2
--rw-r--r--   0 james      (501) staff       (20)      124 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/templates/dataframe.html.j2
--rw-r--r--   0 james      (501) staff       (20)     2579 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/templates/highlevelgraph.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1981 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/templates/highlevelgraph_layer.html.j2
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.251847 dask-2024.4.1/dask/widgets/tests/
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.252403 dask-2024.4.1/dask/widgets/tests/templates/
--rw-r--r--   0 james      (501) staff       (20)       38 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/tests/templates/bytes.html.j2
--rw-r--r--   0 james      (501) staff       (20)       39 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/tests/templates/custom_filter.html.j2
--rw-r--r--   0 james      (501) staff       (20)       30 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/tests/templates/example.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1401 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/tests/test_widgets.py
--rw-r--r--   0 james      (501) staff       (20)     1120 2023-07-17 19:15:27.000000 dask-2024.4.1/dask/widgets/widgets.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.321417 dask-2024.4.1/dask.egg-info/
--rw-r--r--   0 james      (501) staff       (20)     3780 2024-04-04 16:12:05.000000 dask-2024.4.1/dask.egg-info/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)    14325 2024-04-04 16:12:05.000000 dask-2024.4.1/dask.egg-info/SOURCES.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2024-04-04 16:12:05.000000 dask-2024.4.1/dask.egg-info/dependency_links.txt
--rw-r--r--   0 james      (501) staff       (20)      124 2024-04-04 16:12:05.000000 dask-2024.4.1/dask.egg-info/entry_points.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2024-04-04 16:12:04.000000 dask-2024.4.1/dask.egg-info/not-zip-safe
--rw-r--r--   0 james      (501) staff       (20)      532 2024-04-04 16:12:05.000000 dask-2024.4.1/dask.egg-info/requires.txt
--rw-r--r--   0 james      (501) staff       (20)        5 2024-04-04 16:12:05.000000 dask-2024.4.1/dask.egg-info/top_level.txt
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.252737 dask-2024.4.1/docs/
--rw-r--r--   0 james      (501) staff       (20)     5741 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/Makefile
--rw-r--r--   0 james      (501) staff       (20)     5186 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/make.bat
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.277146 dask-2024.4.1/docs/source/
--rw-r--r--   0 james      (501) staff       (20)    17900 2024-01-23 19:42:03.000000 dask-2024.4.1/docs/source/10-minutes-to-dask.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.279781 dask-2024.4.1/docs/source/_static/
--rw-r--r--   0 james      (501) staff       (20)    10187 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/config_converter.js
--rw-r--r--   0 james      (501) staff       (20)    11021 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/_static/dask-simple.png
--rw-r--r--   0 james      (501) staff       (20)     2375 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/main-page.css
--rw-r--r--   0 james      (501) staff       (20)    15598 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/profile.html
--rw-r--r--   0 james      (501) staff       (20)    65304 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/stacked_profile.html
--rw-r--r--   0 james      (501) staff       (20)      523 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/style.css
--rw-r--r--   0 james      (501) staff       (20)      365 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/theme_overrides.css
--rw-r--r--   0 james      (501) staff       (20)   292662 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/transpose_cyto.html
--rw-r--r--   0 james      (501) staff       (20)    49423 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_static/yaml.min.js
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.280480 dask-2024.4.1/docs/source/_templates/
--rw-r--r--   0 james      (501) staff       (20)      180 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/_templates/layout.html
--rw-r--r--   0 james      (501) staff       (20)     4349 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/adaptive.rst
--rw-r--r--   0 james      (501) staff       (20)     3109 2023-08-21 21:39:12.000000 dask-2024.4.1/docs/source/api.rst
--rw-r--r--   0 james      (501) staff       (20)     7189 2023-08-21 21:39:12.000000 dask-2024.4.1/docs/source/array-api.rst
--rw-r--r--   0 james      (501) staff       (20)     2943 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-assignment.rst
--rw-r--r--   0 james      (501) staff       (20)     4740 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)    13262 2023-08-21 21:39:12.000000 dask-2024.4.1/docs/source/array-chunks.rst
--rw-r--r--   0 james      (501) staff       (20)    18437 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     5885 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-design.rst
--rw-r--r--   0 james      (501) staff       (20)     2857 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-gufunc.rst
--rw-r--r--   0 james      (501) staff       (20)    21469 2023-08-21 21:39:12.000000 dask-2024.4.1/docs/source/array-numpy-compatibility.rst
--rw-r--r--   0 james      (501) staff       (20)     6069 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-overlap.rst
--rw-r--r--   0 james      (501) staff       (20)     3924 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-random.rst
--rw-r--r--   0 james      (501) staff       (20)     4137 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-slicing.rst
--rw-r--r--   0 james      (501) staff       (20)     3291 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-sparse.rst
--rw-r--r--   0 james      (501) staff       (20)     2018 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-stack.rst
--rw-r--r--   0 james      (501) staff       (20)     1140 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/array-stats.rst
--rw-r--r--   0 james      (501) staff       (20)     4154 2023-08-21 21:39:12.000000 dask-2024.4.1/docs/source/array.rst
--rw-r--r--   0 james      (501) staff       (20)     1574 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/bag-api.rst
--rw-r--r--   0 james      (501) staff       (20)     4557 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/bag-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     4068 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/bag.rst
--rw-r--r--   0 james      (501) staff       (20)    14042 2024-01-23 19:42:03.000000 dask-2024.4.1/docs/source/best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     5553 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/caching.rst
--rw-r--r--   0 james      (501) staff       (20)   368008 2024-04-04 16:02:59.000000 dask-2024.4.1/docs/source/changelog.rst
--rw-r--r--   0 james      (501) staff       (20)      211 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/cheatsheet.rst
--rw-r--r--   0 james      (501) staff       (20)     4047 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/cli.rst
--rw-r--r--   0 james      (501) staff       (20)    15922 2024-03-13 20:06:34.000000 dask-2024.4.1/docs/source/conf.py
--rw-r--r--   0 james      (501) staff       (20)    16945 2024-03-13 20:06:30.000000 dask-2024.4.1/docs/source/configuration.rst
--rw-r--r--   0 james      (501) staff       (20)    18998 2024-03-13 20:06:30.000000 dask-2024.4.1/docs/source/custom-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     3604 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/custom-graphs.rst
--rw-r--r--   0 james      (501) staff       (20)     4209 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/customize-initialization.rst
--rw-r--r--   0 james      (501) staff       (20)      932 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dashboard-progress-script.py
--rw-r--r--   0 james      (501) staff       (20)    15045 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dashboard.rst
--rw-r--r--   0 james      (501) staff       (20)   203552 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/daskcheatsheet.pdf
--rw-r--r--   0 james      (501) staff       (20)    10542 2024-03-13 20:06:34.000000 dask-2024.4.1/docs/source/dataframe-api.rst
--rw-r--r--   0 james      (501) staff       (20)     9611 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dataframe-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     3951 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dataframe-categoricals.rst
--rw-r--r--   0 james      (501) staff       (20)     5977 2023-12-15 20:02:17.000000 dask-2024.4.1/docs/source/dataframe-create.rst
--rw-r--r--   0 james      (501) staff       (20)     5014 2023-12-15 20:02:17.000000 dask-2024.4.1/docs/source/dataframe-design.rst
--rw-r--r--   0 james      (501) staff       (20)     6224 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dataframe-extend.rst
--rw-r--r--   0 james      (501) staff       (20)      423 2024-03-13 20:06:34.000000 dask-2024.4.1/docs/source/dataframe-extra.rst
--rw-r--r--   0 james      (501) staff       (20)     8032 2023-12-15 20:02:17.000000 dask-2024.4.1/docs/source/dataframe-groupby.rst
--rw-r--r--   0 james      (501) staff       (20)     9351 2024-01-23 19:42:03.000000 dask-2024.4.1/docs/source/dataframe-hive.rst
--rw-r--r--   0 james      (501) staff       (20)     6115 2023-10-25 14:44:16.000000 dask-2024.4.1/docs/source/dataframe-indexing.rst
--rw-r--r--   0 james      (501) staff       (20)     3454 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dataframe-joins.rst
--rw-r--r--   0 james      (501) staff       (20)    13645 2024-03-13 20:06:34.000000 dask-2024.4.1/docs/source/dataframe-legacy-api.rst
--rw-r--r--   0 james      (501) staff       (20)    10545 2024-01-23 19:42:03.000000 dask-2024.4.1/docs/source/dataframe-parquet.rst
--rw-r--r--   0 james      (501) staff       (20)    12661 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/dataframe-sql.rst
--rw-r--r--   0 james      (501) staff       (20)     6608 2024-02-06 16:49:58.000000 dask-2024.4.1/docs/source/dataframe.rst
--rw-r--r--   0 james      (501) staff       (20)      363 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/debugging-performance.rst
--rw-r--r--   0 james      (501) staff       (20)     1696 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/delayed-api.rst
--rw-r--r--   0 james      (501) staff       (20)    17616 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/delayed-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     1497 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/delayed-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     6357 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/delayed.rst
--rw-r--r--   0 james      (501) staff       (20)     3620 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-cli.rst
--rw-r--r--   0 james      (501) staff       (20)     4797 2024-01-26 23:05:40.000000 dask-2024.4.1/docs/source/deploying-cloud.rst
--rw-r--r--   0 james      (501) staff       (20)     2868 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-docker.rst
--rw-r--r--   0 james      (501) staff       (20)      246 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/deploying-extra.rst
--rw-r--r--   0 james      (501) staff       (20)     9939 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-hpc.rst
--rw-r--r--   0 james      (501) staff       (20)     4001 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-kubernetes.rst
--rw-r--r--   0 james      (501) staff       (20)     5823 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-python-advanced.rst
--rw-r--r--   0 james      (501) staff       (20)     2839 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-python.rst
--rw-r--r--   0 james      (501) staff       (20)     1619 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/deploying-ssh.rst
--rw-r--r--   0 james      (501) staff       (20)     8213 2024-02-09 15:39:56.000000 dask-2024.4.1/docs/source/deploying.rst
--rw-r--r--   0 james      (501) staff       (20)    10868 2023-12-14 20:19:54.000000 dask-2024.4.1/docs/source/deployment-considerations.rst
--rw-r--r--   0 james      (501) staff       (20)    13137 2024-03-13 20:06:30.000000 dask-2024.4.1/docs/source/develop.rst
--rw-r--r--   0 james      (501) staff       (20)     4442 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/diagnostics-distributed.rst
--rw-r--r--   0 james      (501) staff       (20)    10407 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/diagnostics-local.rst
--rw-r--r--   0 james      (501) staff       (20)     4548 2024-04-01 19:10:34.000000 dask-2024.4.1/docs/source/ecosystem.rst
--rw-r--r--   0 james      (501) staff       (20)    18500 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/faq.rst
--rw-r--r--   0 james      (501) staff       (20)    25633 2024-02-01 17:01:41.000000 dask-2024.4.1/docs/source/futures.rst
--rw-r--r--   0 james      (501) staff       (20)     5820 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/gpu.rst
--rw-r--r--   0 james      (501) staff       (20)     2541 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/graph_manipulation.rst
--rw-r--r--   0 james      (501) staff       (20)     5433 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/graphs.rst
--rw-r--r--   0 james      (501) staff       (20)     5399 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/graphviz.rst
--rw-r--r--   0 james      (501) staff       (20)     6946 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/high-level-graphs.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.281941 dask-2024.4.1/docs/source/how-to/
--rw-r--r--   0 james      (501) staff       (20)    15531 2024-04-01 19:10:34.000000 dask-2024.4.1/docs/source/how-to/connect-to-remote-data.rst
--rw-r--r--   0 james      (501) staff       (20)    11477 2023-08-21 21:39:12.000000 dask-2024.4.1/docs/source/how-to/debug.rst
--rw-r--r--   0 james      (501) staff       (20)     1722 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/how-to/extend-sizeof.rst
--rw-r--r--   0 james      (501) staff       (20)      433 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/how-to/index.rst
--rw-r--r--   0 james      (501) staff       (20)     6680 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/how-to/selecting-the-collection-backend.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.320403 dask-2024.4.1/docs/source/images/
--rw-r--r--   0 james      (501) staff       (20)    99565 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/10_minutes_array_graph.png
--rw-r--r--   0 james      (501) staff       (20)    22442 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/10_minutes_bag_graph.png
--rw-r--r--   0 james      (501) staff       (20)    56229 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/10_minutes_dataframe_graph.png
--rw-r--r--   0 james      (501) staff       (20)     4059 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/HHMI_Janelia_Color.png
--rw-r--r--   0 james      (501) staff       (20)    18406 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/array.svg
--rw-r--r--   0 james      (501) staff       (20)  1620104 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/async-embarrassing.gif
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.320675 dask-2024.4.1/docs/source/images/changelog/
--rw-r--r--   0 james      (501) staff       (20)    19604 2023-12-01 15:52:50.000000 dask-2024.4.1/docs/source/images/changelog/2023110-rechunking-disk-perf.png
--rw-r--r--   0 james      (501) staff       (20)   540389 2024-01-26 23:05:40.000000 dask-2024.4.1/docs/source/images/cloud-provider-logos.svg
--rw-r--r--   0 james      (501) staff       (20)    10752 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/concurrent-futures-threaded.webp
--rw-r--r--   0 james      (501) staff       (20)   135129 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/crosstalk.svg
--rw-r--r--   0 james      (501) staff       (20)  2367087 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_jupyterlab.png
--rw-r--r--   0 james      (501) staff       (20)    37971 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_link.png
--rw-r--r--   0 james      (501) staff       (20)    68712 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_memory.png
--rw-r--r--   0 james      (501) staff       (20)   281018 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_memory_new.gif
--rw-r--r--   0 james      (501) staff       (20)    25435 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_progress.png
--rw-r--r--   0 james      (501) staff       (20)   276928 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_status.png
--rw-r--r--   0 james      (501) staff       (20)    12009 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_task_processing.png
--rw-r--r--   0 james      (501) staff       (20)    58238 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_task_stream_unhealthy.png
--rw-r--r--   0 james      (501) staff       (20)   103654 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dashboard_taskstream_healthy.png
--rw-r--r--   0 james      (501) staff       (20)   112822 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-adaptive.svg
--rw-r--r--   0 james      (501) staff       (20)    14645 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-array.svg
--rw-r--r--   0 james      (501) staff       (20)   222084 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-cluster-manager.svg
--rw-r--r--   0 james      (501) staff       (20)    18782 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-dataframe.svg
--rw-r--r--   0 james      (501) staff       (20)   381903 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-overview-distributed-callout.svg
--rw-r--r--   0 james      (501) staff       (20)   357643 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-overview-schedulers.svg
--rw-r--r--   0 james      (501) staff       (20)    97471 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask-overview.svg
--rw-r--r--   0 james      (501) staff       (20)     3022 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_horizontal.svg
--rw-r--r--   0 james      (501) staff       (20)     3651 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_horizontal_black.svg
--rw-r--r--   0 james      (501) staff       (20)     3767 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_horizontal_on_blue.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_horizontal_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_horizontal_white.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_icon.svg
--rw-r--r--   0 james      (501) staff       (20)     1571 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_icon_black.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_icon_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     1609 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/dask_icon_white.svg
--rw-r--r--   0 james      (501) staff       (20)    20216 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/delayed-inc-double-add.svg
--rw-r--r--   0 james      (501) staff       (20)   104628 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/distributed-overview.svg
--rw-r--r--   0 james      (501) staff       (20)    18297 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/frame-shuffle.svg
--rw-r--r--   0 james      (501) staff       (20)    22979 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/frame-sort.svg
--rw-r--r--   0 james      (501) staff       (20)    12181 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/frame.svg
--rw-r--r--   0 james      (501) staff       (20)   391443 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/images/futures-graph.png
--rw-r--r--   0 james      (501) staff       (20)    41828 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/gputester-msg.png
--rw-r--r--   0 james      (501) staff       (20)   210392 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/growth_of_languages.png
--rw-r--r--   0 james      (501) staff       (20)   167834 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/growth_of_libraries.png
--rw-r--r--   0 james      (501) staff       (20)     4097 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/inc-add.svg
--rw-r--r--   0 james      (501) staff       (20)   123010 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/map-reduce-task-scheduling.svg
--rw-r--r--   0 james      (501) staff       (20)   482302 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/map_blocks_drop_axis.png
--rw-r--r--   0 james      (501) staff       (20)   113067 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/merge_chunks.png
--rw-r--r--   0 james      (501) staff       (20)    63244 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/merge_chunks_false.png
--rw-r--r--   0 james      (501) staff       (20)    13024 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/optimize_dask1.svg
--rw-r--r--   0 james      (501) staff       (20)     8803 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/optimize_dask2.svg
--rw-r--r--   0 james      (501) staff       (20)     5198 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/optimize_dask3.svg
--rw-r--r--   0 james      (501) staff       (20)     4104 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/optimize_dask4.svg
--rw-r--r--   0 james      (501) staff       (20)     2738 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/optimize_dask5.svg
--rw-r--r--   0 james      (501) staff       (20)   292827 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/order-failure.png
--rw-r--r--   0 james      (501) staff       (20)   239828 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/order-success.png
--rw-r--r--   0 james      (501) staff       (20)    40833 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/overlap.svg
--rw-r--r--   0 james      (501) staff       (20)    18785 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/overlapping-blocks.svg
--rw-r--r--   0 james      (501) staff       (20)     4537 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/overlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)    20533 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/pipeline.svg
--rw-r--r--   0 james      (501) staff       (20)    31576 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/reshape.png
--rw-r--r--   0 james      (501) staff       (20)    31410 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/reshape_problem.png
--rw-r--r--   0 james      (501) staff       (20)    33288 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/reshape_rechunked.png
--rw-r--r--   0 james      (501) staff       (20)    50209 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/scaling-edges.png
--rw-r--r--   0 james      (501) staff       (20)    68476 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/scaling-nodes.png
--rw-r--r--   0 james      (501) staff       (20)    21294 2023-07-17 19:15:13.000000 dask-2024.4.1/docs/source/images/simple-dask.png
--rw-r--r--   0 james      (501) staff       (20)    27572 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/transpose-hlg-hovertooltip.png
--rw-r--r--   0 james      (501) staff       (20)    84492 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/transpose-hlg-html-repr.png
--rw-r--r--   0 james      (501) staff       (20)    39365 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/transpose.svg
--rw-r--r--   0 james      (501) staff       (20)    22446 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/transpose_opt.svg
--rw-r--r--   0 james      (501) staff       (20)   115022 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/trivial.svg
--rw-r--r--   0 james      (501) staff       (20)     2451 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/images/unoverlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)    12486 2024-02-09 15:39:56.000000 dask-2024.4.1/docs/source/index.rst
--rw-r--r--   0 james      (501) staff       (20)    15500 2024-03-13 20:06:34.000000 dask-2024.4.1/docs/source/install.rst
--rw-r--r--   0 james      (501) staff       (20)      341 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/internals.rst
--rw-r--r--   0 james      (501) staff       (20)      868 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/logos.rst
--rw-r--r--   0 james      (501) staff       (20)     3573 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/maintainers.rst
--rw-r--r--   0 james      (501) staff       (20)    12200 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/optimize.rst
--rw-r--r--   0 james      (501) staff       (20)     7119 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/order.rst
--rw-r--r--   0 james      (501) staff       (20)     4810 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/phases-of-computation.rst
--rw-r--r--   0 james      (501) staff       (20)      857 2023-12-07 19:39:17.000000 dask-2024.4.1/docs/source/presentations.rst
--rw-r--r--   0 james      (501) staff       (20)      868 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/prometheus.rst
--rw-r--r--   0 james      (501) staff       (20)     6010 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/scheduler-overview.rst
--rw-r--r--   0 james      (501) staff       (20)     4493 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/scheduling-policy.rst
--rw-r--r--   0 james      (501) staff       (20)    11015 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/scheduling.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-04 16:12:05.321112 dask-2024.4.1/docs/source/scripts/
--rw-r--r--   0 james      (501) staff       (20)     3294 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/scripts/scheduling.py
--rw-r--r--   0 james      (501) staff       (20)     6104 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/shared.rst
--rw-r--r--   0 james      (501) staff       (20)     4562 2023-12-13 17:43:46.000000 dask-2024.4.1/docs/source/software-environments.rst
--rw-r--r--   0 james      (501) staff       (20)     9342 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/spark.rst
--rw-r--r--   0 james      (501) staff       (20)     3967 2023-09-13 17:55:33.000000 dask-2024.4.1/docs/source/spec.rst
--rw-r--r--   0 james      (501) staff       (20)     4754 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/support.rst
--rw-r--r--   0 james      (501) staff       (20)     1831 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/understanding-performance.rst
--rw-r--r--   0 james      (501) staff       (20)    12205 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/user-interfaces.rst
--rw-r--r--   0 james      (501) staff       (20)    11744 2023-07-17 19:15:27.000000 dask-2024.4.1/docs/source/why.rst
--rw-r--r--   0 james      (501) staff       (20)     7059 2024-04-04 16:08:14.000000 dask-2024.4.1/pyproject.toml
--rw-r--r--   0 james      (501) staff       (20)       38 2024-04-04 16:12:05.323369 dask-2024.4.1/setup.cfg
--rwxr-xr-x   0 james      (501) staff       (20)      194 2023-07-17 19:15:27.000000 dask-2024.4.1/setup.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.551249 dask-2024.4.2/
+-rw-r--r--   0 james      (501) staff       (20)     1531 2023-07-17 19:15:27.000000 dask-2024.4.2/LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)      325 2023-07-17 19:15:27.000000 dask-2024.4.2/MANIFEST.in
+-rw-r--r--   0 james      (501) staff       (20)     3780 2024-04-19 21:07:59.550978 dask-2024.4.2/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1291 2023-07-17 19:15:27.000000 dask-2024.4.2/README.rst
+-rw-r--r--   0 james      (501) staff       (20)     1598 2024-01-23 19:42:07.000000 dask-2024.4.2/conftest.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.414796 dask-2024.4.2/dask/
+-rw-r--r--   0 james      (501) staff       (20)      485 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      133 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/__main__.py
+-rw-r--r--   0 james      (501) staff       (20)      720 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2024-04-19 21:07:59.551478 dask-2024.4.2/dask/_version.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.422797 dask-2024.4.2/dask/array/
+-rw-r--r--   0 james      (501) staff       (20)     1543 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/array/NUMPY_LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)     5413 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12600 2023-12-20 15:38:57.000000 dask-2024.4.2/dask/array/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9983 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/blockwise.py
+-rw-r--r--   0 james      (501) staff       (20)    12304 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)     5066 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/chunk_types.py
+-rw-r--r--   0 james      (501) staff       (20)   191296 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/array/core.py
+-rw-r--r--   0 james      (501) staff       (20)    40514 2023-10-25 14:44:16.000000 dask-2024.4.2/dask/array/creation.py
+-rw-r--r--   0 james      (501) staff       (20)     2114 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/cupy_entry_point.py
+-rw-r--r--   0 james      (501) staff       (20)      526 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     9146 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/einsumfuncs.py
+-rw-r--r--   0 james      (501) staff       (20)     7677 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/fft.py
+-rw-r--r--   0 james      (501) staff       (20)    32656 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1996 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/image.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.423252 dask-2024.4.2/dask/array/lib/
+-rw-r--r--   0 james      (501) staff       (20)       77 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/lib/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      101 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/lib/stride_tricks.py
+-rw-r--r--   0 james      (501) staff       (20)    53218 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/array/linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     6363 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/ma.py
+-rw-r--r--   0 james      (501) staff       (20)     6078 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12838 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28479 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/overlap.py
+-rw-r--r--   0 james      (501) staff       (20)    10925 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/array/percentile.py
+-rw-r--r--   0 james      (501) staff       (20)    40605 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/random.py
+-rw-r--r--   0 james      (501) staff       (20)    28323 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    58469 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/reductions.py
+-rw-r--r--   0 james      (501) staff       (20)    10766 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    81576 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/routines.py
+-rw-r--r--   0 james      (501) staff       (20)    72865 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/slicing.py
+-rw-r--r--   0 james      (501) staff       (20)    16184 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/array/stats.py
+-rw-r--r--   0 james      (501) staff       (20)     8048 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/svg.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.431713 dask-2024.4.2/dask/array/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/array/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)   162966 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/array/tests/test_array_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6689 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_array_function.py
+-rw-r--r--   0 james      (501) staff       (20)     3159 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_array_utils.py
+-rw-r--r--   0 james      (501) staff       (20)    23222 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_atop.py
+-rw-r--r--   0 james      (501) staff       (20)     3304 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    31190 2023-10-25 14:44:16.000000 dask-2024.4.2/dask/array/tests/test_creation.py
+-rw-r--r--   0 james      (501) staff       (20)    19888 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6496 2023-10-25 14:44:16.000000 dask-2024.4.2/dask/array/tests/test_cupy_creation.py
+-rw-r--r--   0 james      (501) staff       (20)      594 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    13412 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     4303 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     2730 2024-03-13 20:06:30.000000 dask-2024.4.2/dask/array/tests/test_cupy_percentile.py
+-rw-r--r--   0 james      (501) staff       (20)     9219 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_random.py
+-rw-r--r--   0 james      (501) staff       (20)     2224 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7436 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/tests/test_cupy_routines.py
+-rw-r--r--   0 james      (501) staff       (20)     4877 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     2982 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_cupy_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     8866 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/tests/test_dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     8821 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/tests/test_fft.py
+-rw-r--r--   0 james      (501) staff       (20)    21013 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1482 2023-09-28 22:08:27.000000 dask-2024.4.2/dask/array/tests/test_image.py
+-rw-r--r--   0 james      (501) staff       (20)    37415 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/tests/test_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)    15714 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/tests/test_masked.py
+-rw-r--r--   0 james      (501) staff       (20)     1087 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    17446 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    26718 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     3443 2023-11-07 18:15:20.000000 dask-2024.4.2/dask/array/tests/test_percentiles.py
+-rw-r--r--   0 james      (501) staff       (20)    15352 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)    36262 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/array/tests/test_rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    33283 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/array/tests/test_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7289 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    84472 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/array/tests/test_routines.py
+-rw-r--r--   0 james      (501) staff       (20)    32264 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/array/tests/test_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     6592 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     5489 2023-09-28 22:08:27.000000 dask-2024.4.2/dask/array/tests/test_stats.py
+-rw-r--r--   0 james      (501) staff       (20)     2740 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_svg.py
+-rw-r--r--   0 james      (501) staff       (20)      525 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_testing.py
+-rw-r--r--   0 james      (501) staff       (20)    17390 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     2706 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     1317 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tests/test_xarray.py
+-rw-r--r--   0 james      (501) staff       (20)     4737 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/tiledb_io.py
+-rw-r--r--   0 james      (501) staff       (20)    10030 2024-03-13 20:06:30.000000 dask-2024.4.2/dask/array/ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    19112 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/array/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     6906 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/array/wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     5122 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/backends.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.433023 dask-2024.4.2/dask/bag/
+-rw-r--r--   0 james      (501) staff       (20)      903 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     9111 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/avro.py
+-rw-r--r--   0 james      (501) staff       (20)      763 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    86045 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/bag/core.py
+-rw-r--r--   0 james      (501) staff       (20)     5464 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/random.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.433939 dask-2024.4.2/dask/bag/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/bag/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3808 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/tests/test_avro.py
+-rw-r--r--   0 james      (501) staff       (20)    52682 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/bag/tests/test_bag.py
+-rw-r--r--   0 james      (501) staff       (20)     6528 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)     5049 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/tests/test_text.py
+-rw-r--r--   0 james      (501) staff       (20)     6765 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/text.py
+-rw-r--r--   0 james      (501) staff       (20)      241 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bag/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    54892 2024-04-01 19:10:34.000000 dask-2024.4.2/dask/base.py
+-rw-r--r--   0 james      (501) staff       (20)    53276 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/blockwise.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.434453 dask-2024.4.2/dask/bytes/
+-rw-r--r--   0 james      (501) staff       (20)       75 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bytes/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6933 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bytes/core.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.435651 dask-2024.4.2/dask/bytes/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/bytes/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     5158 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bytes/tests/test_bytes_utils.py
+-rw-r--r--   0 james      (501) staff       (20)      530 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bytes/tests/test_compression.py
+-rw-r--r--   0 james      (501) staff       (20)     6815 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/bytes/tests/test_http.py
+-rw-r--r--   0 james      (501) staff       (20)    11476 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bytes/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)    19556 2024-01-29 17:27:45.000000 dask-2024.4.2/dask/bytes/tests/test_s3.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/bytes/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     2001 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/cache.py
+-rw-r--r--   0 james      (501) staff       (20)     4067 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     5773 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/cli.py
+-rw-r--r--   0 james      (501) staff       (20)      523 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    24786 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/config.py
+-rw-r--r--   0 james      (501) staff       (20)      959 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/conftest.py
+-rw-r--r--   0 james      (501) staff       (20)     1756 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/context.py
+-rw-r--r--   0 james      (501) staff       (20)    15772 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/core.py
+-rw-r--r--   0 james      (501) staff       (20)     8149 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/dask-schema.yaml
+-rw-r--r--   0 james      (501) staff       (20)     1992 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/dask.yaml
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.441084 dask-2024.4.2/dask/dataframe/
+-rw-r--r--   0 james      (501) staff       (20)     5498 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/dataframe/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7642 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     2171 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/dataframe/_dtypes.py
+-rw-r--r--   0 james      (501) staff       (20)     3974 2024-02-06 16:03:46.000000 dask-2024.4.2/dask/dataframe/_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     2743 2023-11-10 20:46:15.000000 dask-2024.4.2/dask/dataframe/_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)      393 2024-01-25 18:24:19.000000 dask-2024.4.2/dask/dataframe/_testing.py
+-rw-r--r--   0 james      (501) staff       (20)    13540 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/dataframe/accessor.py
+-rw-r--r--   0 james      (501) staff       (20)    25943 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/dataframe/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9507 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   314038 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/core.py
+-rw-r--r--   0 james      (501) staff       (20)     4577 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)      552 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/extensions.py
+-rw-r--r--   0 james      (501) staff       (20)   117451 2024-04-01 19:10:34.000000 dask-2024.4.2/dask/dataframe/groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2463 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    13412 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/indexing.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.442853 dask-2024.4.2/dask/dataframe/io/
+-rw-r--r--   0 james      (501) staff       (20)      706 2023-09-25 17:06:23.000000 dask-2024.4.2/dask/dataframe/io/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    34437 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/csv.py
+-rw-r--r--   0 james      (501) staff       (20)    18830 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/demo.py
+-rw-r--r--   0 james      (501) staff       (20)    18384 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/io/hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    38600 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/io.py
+-rw-r--r--   0 james      (501) staff       (20)    11163 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/dataframe/io/json.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.443493 dask-2024.4.2/dask/dataframe/io/orc/
+-rw-r--r--   0 james      (501) staff       (20)       92 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/io/orc/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     4487 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/io/orc/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)     7183 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/io/orc/core.py
+-rw-r--r--   0 james      (501) staff       (20)      510 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/io/orc/utils.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.444587 dask-2024.4.2/dask/dataframe/io/parquet/
+-rw-r--r--   0 james      (501) staff       (20)      166 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/io/parquet/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    72803 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/parquet/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)    67054 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/parquet/core.py
+-rw-r--r--   0 james      (501) staff       (20)    52314 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/parquet/fastparquet.py
+-rw-r--r--   0 james      (501) staff       (20)    32900 2023-10-27 21:32:35.000000 dask-2024.4.2/dask/dataframe/io/parquet/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    21270 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/sql.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.446695 dask-2024.4.2/dask/dataframe/io/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/dataframe/io/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    61918 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/tests/test_csv.py
+-rw-r--r--   0 james      (501) staff       (20)    11436 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/tests/test_demo.py
+-rw-r--r--   0 james      (501) staff       (20)    27324 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/io/tests/test_hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    35589 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/tests/test_io.py
+-rw-r--r--   0 james      (501) staff       (20)     8812 2023-09-21 15:09:09.000000 dask-2024.4.2/dask/dataframe/io/tests/test_json.py
+-rw-r--r--   0 james      (501) staff       (20)     5302 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/io/tests/test_orc.py
+-rw-r--r--   0 james      (501) staff       (20)   166161 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/io/tests/test_parquet.py
+-rw-r--r--   0 james      (501) staff       (20)    17632 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/io/tests/test_sql.py
+-rw-r--r--   0 james      (501) staff       (20)     8041 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/dataframe/io/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    14713 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/dataframe/methods.py
+-rw-r--r--   0 james      (501) staff       (20)    55455 2024-02-09 22:36:17.000000 dask-2024.4.2/dask/dataframe/multi.py
+-rw-r--r--   0 james      (501) staff       (20)     1600 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     8780 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/optimize.py
+-rw-r--r--   0 james      (501) staff       (20)    20819 2023-10-25 14:44:16.000000 dask-2024.4.2/dask/dataframe/partitionquantiles.py
+-rw-r--r--   0 james      (501) staff       (20)    11868 2023-10-27 21:32:31.000000 dask-2024.4.2/dask/dataframe/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    22170 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    40190 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/shuffle.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.451918 dask-2024.4.2/dask/dataframe/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/dataframe/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    11131 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_accessors.py
+-rw-r--r--   0 james      (501) staff       (20)    70713 2024-01-30 19:27:46.000000 dask-2024.4.2/dask/dataframe/tests/test_arithmetics_reduction.py
+-rw-r--r--   0 james      (501) staff       (20)      942 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/tests/test_boolean.py
+-rw-r--r--   0 james      (501) staff       (20)    17863 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   209193 2024-04-04 15:04:44.000000 dask-2024.4.2/dask/dataframe/tests/test_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     1457 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_extensions.py
+-rw-r--r--   0 james      (501) staff       (20)    14847 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/tests/test_format.py
+-rw-r--r--   0 james      (501) staff       (20)   127454 2024-04-04 15:04:44.000000 dask-2024.4.2/dask/dataframe/tests/test_groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2702 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dataframe/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     2897 2024-01-30 19:27:46.000000 dask-2024.4.2/dask/dataframe/tests/test_hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    23962 2024-02-06 16:03:46.000000 dask-2024.4.2/dask/dataframe/tests/test_indexing.py
+-rw-r--r--   0 james      (501) staff       (20)     7990 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/tests/test_merge_column_and_index.py
+-rw-r--r--   0 james      (501) staff       (20)      463 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/dataframe/tests/test_methods.py
+-rw-r--r--   0 james      (501) staff       (20)    96566 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_multi.py
+-rw-r--r--   0 james      (501) staff       (20)     2624 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     1188 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/tests/test_optimize_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     6662 2023-09-25 17:06:24.000000 dask-2024.4.2/dask/dataframe/tests/test_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     5059 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    11551 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/dataframe/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    18504 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    63402 2024-04-19 20:50:02.000000 dask-2024.4.2/dask/dataframe/tests/test_shuffle.py
+-rw-r--r--   0 james      (501) staff       (20)    16922 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/dataframe/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    22240 2024-04-01 19:10:34.000000 dask-2024.4.2/dask/dataframe/tests/test_utils_dataframe.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.452266 dask-2024.4.2/dask/dataframe/tseries/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/dataframe/tseries/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7675 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/dataframe/tseries/resample.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.452595 dask-2024.4.2/dask/dataframe/tseries/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/dataframe/tseries/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7028 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/dataframe/tseries/tests/test_resample.py
+-rw-r--r--   0 james      (501) staff       (20)    27538 2023-09-25 17:06:24.000000 dask-2024.4.2/dask/dataframe/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     5331 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    24814 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/delayed.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.453335 dask-2024.4.2/dask/diagnostics/
+-rw-r--r--   0 james      (501) staff       (20)      258 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/diagnostics/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12136 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/diagnostics/profile.py
+-rw-r--r--   0 james      (501) staff       (20)    16332 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/diagnostics/profile_visualize.py
+-rw-r--r--   0 james      (501) staff       (20)     5001 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/diagnostics/progress.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.453904 dask-2024.4.2/dask/diagnostics/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/diagnostics/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12045 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/diagnostics/tests/test_profiler.py
+-rw-r--r--   0 james      (501) staff       (20)     3388 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/diagnostics/tests/test_progress.py
+-rw-r--r--   0 james      (501) staff       (20)      715 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/distributed.py
+-rw-r--r--   0 james      (501) staff       (20)    16587 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/dot.py
+-rw-r--r--   0 james      (501) staff       (20)    19622 2023-10-25 14:44:16.000000 dask-2024.4.2/dask/graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     2492 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/hashing.py
+-rw-r--r--   0 james      (501) staff       (20)    35516 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/highlevelgraph.py
+-rw-r--r--   0 james      (501) staff       (20)    46004 2023-09-13 17:55:33.000000 dask-2024.4.2/dask/layers.py
+-rw-r--r--   0 james      (501) staff       (20)    18896 2023-09-13 17:55:33.000000 dask-2024.4.2/dask/local.py
+-rw-r--r--   0 james      (501) staff       (20)      487 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8474 2023-09-13 17:55:33.000000 dask-2024.4.2/dask/multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    36224 2024-02-09 15:39:56.000000 dask-2024.4.2/dask/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    32839 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/order.py
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/py.typed
+-rw-r--r--   0 james      (501) staff       (20)    12597 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7621 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     2089 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/system.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.460807 dask-2024.4.2/dask/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-07-17 19:15:13.000000 dask-2024.4.2/dask/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      824 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/tests/test_backends.py
+-rw-r--r--   0 james      (501) staff       (20)    33013 2024-02-09 15:39:56.000000 dask-2024.4.2/dask/tests/test_base.py
+-rw-r--r--   0 james      (501) staff       (20)     1613 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_cache.py
+-rw-r--r--   0 james      (501) staff       (20)     2570 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     1224 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_ci.py
+-rw-r--r--   0 james      (501) staff       (20)     7488 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_cli.py
+-rw-r--r--   0 james      (501) staff       (20)      379 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    20268 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_config.py
+-rw-r--r--   0 james      (501) staff       (20)     1137 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_context.py
+-rw-r--r--   0 james      (501) staff       (20)     8203 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/tests/test_core.py
+-rw-r--r--   0 james      (501) staff       (20)     1112 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    22962 2024-02-09 15:39:56.000000 dask-2024.4.2/dask/tests/test_delayed.py
+-rw-r--r--   0 james      (501) staff       (20)    33448 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_distributed.py
+-rw-r--r--   0 james      (501) staff       (20)      719 2024-03-13 20:06:30.000000 dask-2024.4.2/dask/tests/test_docs.py
+-rw-r--r--   0 james      (501) staff       (20)    12271 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_dot.py
+-rw-r--r--   0 james      (501) staff       (20)    15338 2024-01-29 17:27:45.000000 dask-2024.4.2/dask/tests/test_graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     1095 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     9231 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_highgraph.py
+-rw-r--r--   0 james      (501) staff       (20)     9040 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_layers.py
+-rw-r--r--   0 james      (501) staff       (20)     5022 2023-12-13 17:43:46.000000 dask-2024.4.2/dask/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)      419 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8457 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    47821 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    69758 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_order.py
+-rw-r--r--   0 james      (501) staff       (20)     4684 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7526 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/tests/test_sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     7228 2024-01-23 19:42:03.000000 dask-2024.4.2/dask/tests/test_spark_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     2571 2023-08-21 21:39:12.000000 dask-2024.4.2/dask/tests/test_system.py
+-rw-r--r--   0 james      (501) staff       (20)     4749 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_threaded.py
+-rw-r--r--   0 james      (501) staff       (20)    39981 2024-03-13 20:06:30.000000 dask-2024.4.2/dask/tests/test_tokenize.py
+-rw-r--r--   0 james      (501) staff       (20)     4591 2023-09-15 13:43:23.000000 dask-2024.4.2/dask/tests/test_traceback.py
+-rw-r--r--   0 james      (501) staff       (20)     5708 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/tests/test_typing.py
+-rw-r--r--   0 james      (501) staff       (20)    23636 2024-01-23 19:42:07.000000 dask-2024.4.2/dask/tests/test_utils.py
+-rw-r--r--   0 james      (501) staff       (20)     1598 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/test_utils_test.py
+-rw-r--r--   0 james      (501) staff       (20)      211 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/tests/warning_aliases.py
+-rw-r--r--   0 james      (501) staff       (20)     3001 2023-09-13 17:55:33.000000 dask-2024.4.2/dask/threaded.py
+-rw-r--r--   0 james      (501) staff       (20)    15497 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/typing.py
+-rw-r--r--   0 james      (501) staff       (20)    63637 2024-03-13 20:06:34.000000 dask-2024.4.2/dask/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     4825 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/utils_test.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.461569 dask-2024.4.2/dask/widgets/
+-rw-r--r--   0 james      (501) staff       (20)      792 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/__init__.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.462910 dask-2024.4.2/dask/widgets/templates/
+-rw-r--r--   0 james      (501) staff       (20)     1295 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/templates/array.html.j2
+-rw-r--r--   0 james      (501) staff       (20)      124 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/templates/dataframe.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     2579 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/templates/highlevelgraph.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1981 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/templates/highlevelgraph_layer.html.j2
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.463117 dask-2024.4.2/dask/widgets/tests/
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.463712 dask-2024.4.2/dask/widgets/tests/templates/
+-rw-r--r--   0 james      (501) staff       (20)       38 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/tests/templates/bytes.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       39 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/tests/templates/custom_filter.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       30 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/tests/templates/example.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1401 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/tests/test_widgets.py
+-rw-r--r--   0 james      (501) staff       (20)     1120 2023-07-17 19:15:27.000000 dask-2024.4.2/dask/widgets/widgets.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.549396 dask-2024.4.2/dask.egg-info/
+-rw-r--r--   0 james      (501) staff       (20)     3780 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)    14411 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/SOURCES.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/dependency_links.txt
+-rw-r--r--   0 james      (501) staff       (20)      124 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/entry_points.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/not-zip-safe
+-rw-r--r--   0 james      (501) staff       (20)      532 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/requires.txt
+-rw-r--r--   0 james      (501) staff       (20)        5 2024-04-19 21:07:59.000000 dask-2024.4.2/dask.egg-info/top_level.txt
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.464169 dask-2024.4.2/docs/
+-rw-r--r--   0 james      (501) staff       (20)     5741 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/Makefile
+-rw-r--r--   0 james      (501) staff       (20)     5186 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/make.bat
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.492950 dask-2024.4.2/docs/source/
+-rw-r--r--   0 james      (501) staff       (20)    17900 2024-01-23 19:42:03.000000 dask-2024.4.2/docs/source/10-minutes-to-dask.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.495960 dask-2024.4.2/docs/source/_static/
+-rw-r--r--   0 james      (501) staff       (20)    10187 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/config_converter.js
+-rw-r--r--   0 james      (501) staff       (20)    11021 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/_static/dask-simple.png
+-rw-r--r--   0 james      (501) staff       (20)     2375 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/main-page.css
+-rw-r--r--   0 james      (501) staff       (20)    15598 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/profile.html
+-rw-r--r--   0 james      (501) staff       (20)    65304 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/stacked_profile.html
+-rw-r--r--   0 james      (501) staff       (20)      523 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/style.css
+-rw-r--r--   0 james      (501) staff       (20)      365 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/theme_overrides.css
+-rw-r--r--   0 james      (501) staff       (20)   292662 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/transpose_cyto.html
+-rw-r--r--   0 james      (501) staff       (20)    49423 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_static/yaml.min.js
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.496552 dask-2024.4.2/docs/source/_templates/
+-rw-r--r--   0 james      (501) staff       (20)      180 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/_templates/layout.html
+-rw-r--r--   0 james      (501) staff       (20)     4349 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/adaptive.rst
+-rw-r--r--   0 james      (501) staff       (20)     3109 2023-08-21 21:39:12.000000 dask-2024.4.2/docs/source/api.rst
+-rw-r--r--   0 james      (501) staff       (20)     7189 2023-08-21 21:39:12.000000 dask-2024.4.2/docs/source/array-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     2943 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-assignment.rst
+-rw-r--r--   0 james      (501) staff       (20)     4740 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)    13262 2023-08-21 21:39:12.000000 dask-2024.4.2/docs/source/array-chunks.rst
+-rw-r--r--   0 james      (501) staff       (20)    18437 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5885 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     2857 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-gufunc.rst
+-rw-r--r--   0 james      (501) staff       (20)    21469 2023-08-21 21:39:12.000000 dask-2024.4.2/docs/source/array-numpy-compatibility.rst
+-rw-r--r--   0 james      (501) staff       (20)     6069 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-overlap.rst
+-rw-r--r--   0 james      (501) staff       (20)     3924 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-random.rst
+-rw-r--r--   0 james      (501) staff       (20)     4137 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-slicing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3291 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-sparse.rst
+-rw-r--r--   0 james      (501) staff       (20)     2018 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-stack.rst
+-rw-r--r--   0 james      (501) staff       (20)     1140 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/array-stats.rst
+-rw-r--r--   0 james      (501) staff       (20)     4154 2023-08-21 21:39:12.000000 dask-2024.4.2/docs/source/array.rst
+-rw-r--r--   0 james      (501) staff       (20)     1574 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/bag-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     4557 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/bag-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     4068 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/bag.rst
+-rw-r--r--   0 james      (501) staff       (20)    14042 2024-01-23 19:42:03.000000 dask-2024.4.2/docs/source/best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     5553 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/caching.rst
+-rw-r--r--   0 james      (501) staff       (20)   371700 2024-04-19 21:02:52.000000 dask-2024.4.2/docs/source/changelog.rst
+-rw-r--r--   0 james      (501) staff       (20)      211 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/cheatsheet.rst
+-rw-r--r--   0 james      (501) staff       (20)     4047 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/cli.rst
+-rw-r--r--   0 james      (501) staff       (20)    15922 2024-03-13 20:06:34.000000 dask-2024.4.2/docs/source/conf.py
+-rw-r--r--   0 james      (501) staff       (20)    16945 2024-03-13 20:06:30.000000 dask-2024.4.2/docs/source/configuration.rst
+-rw-r--r--   0 james      (501) staff       (20)    18998 2024-03-13 20:06:30.000000 dask-2024.4.2/docs/source/custom-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     3604 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/custom-graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)     4209 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/customize-initialization.rst
+-rw-r--r--   0 james      (501) staff       (20)      932 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/dashboard-progress-script.py
+-rw-r--r--   0 james      (501) staff       (20)    15045 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/dashboard.rst
+-rw-r--r--   0 james      (501) staff       (20)   203552 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/daskcheatsheet.pdf
+-rw-r--r--   0 james      (501) staff       (20)    11005 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     9530 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     3951 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/dataframe-categoricals.rst
+-rw-r--r--   0 james      (501) staff       (20)     5977 2023-12-15 20:02:17.000000 dask-2024.4.2/docs/source/dataframe-create.rst
+-rw-r--r--   0 james      (501) staff       (20)     5711 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     6239 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-extend.rst
+-rw-r--r--   0 james      (501) staff       (20)      423 2024-03-13 20:06:34.000000 dask-2024.4.2/docs/source/dataframe-extra.rst
+-rw-r--r--   0 james      (501) staff       (20)     8060 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-groupby.rst
+-rw-r--r--   0 james      (501) staff       (20)     9351 2024-01-23 19:42:03.000000 dask-2024.4.2/docs/source/dataframe-hive.rst
+-rw-r--r--   0 james      (501) staff       (20)     6115 2023-10-25 14:44:16.000000 dask-2024.4.2/docs/source/dataframe-indexing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3360 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-joins.rst
+-rw-r--r--   0 james      (501) staff       (20)    13645 2024-03-13 20:06:34.000000 dask-2024.4.2/docs/source/dataframe-legacy-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     3097 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-optimizer.rst
+-rw-r--r--   0 james      (501) staff       (20)    10547 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-parquet.rst
+-rw-r--r--   0 james      (501) staff       (20)    12415 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe-sql.rst
+-rw-r--r--   0 james      (501) staff       (20)     6647 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/dataframe.rst
+-rw-r--r--   0 james      (501) staff       (20)      363 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/debugging-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)     1696 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/delayed-api.rst
+-rw-r--r--   0 james      (501) staff       (20)    17616 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/delayed-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     1497 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/delayed-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     6357 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/delayed.rst
+-rw-r--r--   0 james      (501) staff       (20)     3620 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-cli.rst
+-rw-r--r--   0 james      (501) staff       (20)     4797 2024-01-26 23:05:40.000000 dask-2024.4.2/docs/source/deploying-cloud.rst
+-rw-r--r--   0 james      (501) staff       (20)     2868 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-docker.rst
+-rw-r--r--   0 james      (501) staff       (20)      246 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/deploying-extra.rst
+-rw-r--r--   0 james      (501) staff       (20)     9939 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-hpc.rst
+-rw-r--r--   0 james      (501) staff       (20)     4001 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-kubernetes.rst
+-rw-r--r--   0 james      (501) staff       (20)     5823 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-python-advanced.rst
+-rw-r--r--   0 james      (501) staff       (20)     2839 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-python.rst
+-rw-r--r--   0 james      (501) staff       (20)     1619 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/deploying-ssh.rst
+-rw-r--r--   0 james      (501) staff       (20)     8213 2024-02-09 15:39:56.000000 dask-2024.4.2/docs/source/deploying.rst
+-rw-r--r--   0 james      (501) staff       (20)    10868 2023-12-14 20:19:54.000000 dask-2024.4.2/docs/source/deployment-considerations.rst
+-rw-r--r--   0 james      (501) staff       (20)    13137 2024-03-13 20:06:30.000000 dask-2024.4.2/docs/source/develop.rst
+-rw-r--r--   0 james      (501) staff       (20)     4442 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/diagnostics-distributed.rst
+-rw-r--r--   0 james      (501) staff       (20)    10407 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/diagnostics-local.rst
+-rw-r--r--   0 james      (501) staff       (20)     4548 2024-04-01 19:10:34.000000 dask-2024.4.2/docs/source/ecosystem.rst
+-rw-r--r--   0 james      (501) staff       (20)    18500 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/faq.rst
+-rw-r--r--   0 james      (501) staff       (20)    25633 2024-02-01 17:01:41.000000 dask-2024.4.2/docs/source/futures.rst
+-rw-r--r--   0 james      (501) staff       (20)     5820 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/gpu.rst
+-rw-r--r--   0 james      (501) staff       (20)     2541 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/graph_manipulation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5433 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)     5399 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/graphviz.rst
+-rw-r--r--   0 james      (501) staff       (20)     6946 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/high-level-graphs.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.498100 dask-2024.4.2/docs/source/how-to/
+-rw-r--r--   0 james      (501) staff       (20)    15531 2024-04-01 19:10:34.000000 dask-2024.4.2/docs/source/how-to/connect-to-remote-data.rst
+-rw-r--r--   0 james      (501) staff       (20)    11477 2023-08-21 21:39:12.000000 dask-2024.4.2/docs/source/how-to/debug.rst
+-rw-r--r--   0 james      (501) staff       (20)     1722 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/how-to/extend-sizeof.rst
+-rw-r--r--   0 james      (501) staff       (20)      433 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/how-to/index.rst
+-rw-r--r--   0 james      (501) staff       (20)     6682 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/how-to/selecting-the-collection-backend.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.548537 dask-2024.4.2/docs/source/images/
+-rw-r--r--   0 james      (501) staff       (20)    99565 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/10_minutes_array_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    22442 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/10_minutes_bag_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    56229 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/10_minutes_dataframe_graph.png
+-rw-r--r--   0 james      (501) staff       (20)     4059 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/HHMI_Janelia_Color.png
+-rw-r--r--   0 james      (501) staff       (20)    18406 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/array.svg
+-rw-r--r--   0 james      (501) staff       (20)  1620104 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/async-embarrassing.gif
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.548727 dask-2024.4.2/docs/source/images/changelog/
+-rw-r--r--   0 james      (501) staff       (20)    19604 2023-12-01 15:52:50.000000 dask-2024.4.2/docs/source/images/changelog/2023110-rechunking-disk-perf.png
+-rw-r--r--   0 james      (501) staff       (20)   540389 2024-01-26 23:05:40.000000 dask-2024.4.2/docs/source/images/cloud-provider-logos.svg
+-rw-r--r--   0 james      (501) staff       (20)    10752 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/concurrent-futures-threaded.webp
+-rw-r--r--   0 james      (501) staff       (20)   135129 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/crosstalk.svg
+-rw-r--r--   0 james      (501) staff       (20)  2367087 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_jupyterlab.png
+-rw-r--r--   0 james      (501) staff       (20)    37971 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_link.png
+-rw-r--r--   0 james      (501) staff       (20)    68712 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_memory.png
+-rw-r--r--   0 james      (501) staff       (20)   281018 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_memory_new.gif
+-rw-r--r--   0 james      (501) staff       (20)    25435 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_progress.png
+-rw-r--r--   0 james      (501) staff       (20)   276928 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_status.png
+-rw-r--r--   0 james      (501) staff       (20)    12009 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_task_processing.png
+-rw-r--r--   0 james      (501) staff       (20)    58238 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_task_stream_unhealthy.png
+-rw-r--r--   0 james      (501) staff       (20)   103654 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dashboard_taskstream_healthy.png
+-rw-r--r--   0 james      (501) staff       (20)   112822 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-adaptive.svg
+-rw-r--r--   0 james      (501) staff       (20)    14645 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-array.svg
+-rw-r--r--   0 james      (501) staff       (20)   222084 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-cluster-manager.svg
+-rw-r--r--   0 james      (501) staff       (20)    18782 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-dataframe.svg
+-rw-r--r--   0 james      (501) staff       (20)   381903 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-overview-distributed-callout.svg
+-rw-r--r--   0 james      (501) staff       (20)   357643 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-overview-schedulers.svg
+-rw-r--r--   0 james      (501) staff       (20)    97471 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)     3022 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_horizontal.svg
+-rw-r--r--   0 james      (501) staff       (20)     3651 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_horizontal_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     3767 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_horizontal_on_blue.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_horizontal_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_horizontal_white.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_icon.svg
+-rw-r--r--   0 james      (501) staff       (20)     1571 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_icon_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_icon_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     1609 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/dask_icon_white.svg
+-rw-r--r--   0 james      (501) staff       (20)    13382 2024-04-19 20:50:02.000000 dask-2024.4.2/docs/source/images/dataframe-optimize-explain.png
+-rw-r--r--   0 james      (501) staff       (20)    20216 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/delayed-inc-double-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   104628 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/distributed-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)    18297 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/frame-shuffle.svg
+-rw-r--r--   0 james      (501) staff       (20)    22979 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/frame-sort.svg
+-rw-r--r--   0 james      (501) staff       (20)    12181 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/frame.svg
+-rw-r--r--   0 james      (501) staff       (20)   391443 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/images/futures-graph.png
+-rw-r--r--   0 james      (501) staff       (20)    41828 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/gputester-msg.png
+-rw-r--r--   0 james      (501) staff       (20)   210392 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/growth_of_languages.png
+-rw-r--r--   0 james      (501) staff       (20)   167834 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/growth_of_libraries.png
+-rw-r--r--   0 james      (501) staff       (20)     4097 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/inc-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   123010 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/map-reduce-task-scheduling.svg
+-rw-r--r--   0 james      (501) staff       (20)   482302 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/map_blocks_drop_axis.png
+-rw-r--r--   0 james      (501) staff       (20)   113067 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/merge_chunks.png
+-rw-r--r--   0 james      (501) staff       (20)    63244 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/merge_chunks_false.png
+-rw-r--r--   0 james      (501) staff       (20)    13024 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/optimize_dask1.svg
+-rw-r--r--   0 james      (501) staff       (20)     8803 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/optimize_dask2.svg
+-rw-r--r--   0 james      (501) staff       (20)     5198 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/optimize_dask3.svg
+-rw-r--r--   0 james      (501) staff       (20)     4104 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/optimize_dask4.svg
+-rw-r--r--   0 james      (501) staff       (20)     2738 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/optimize_dask5.svg
+-rw-r--r--   0 james      (501) staff       (20)   292827 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/order-failure.png
+-rw-r--r--   0 james      (501) staff       (20)   239828 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/order-success.png
+-rw-r--r--   0 james      (501) staff       (20)    40833 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/overlap.svg
+-rw-r--r--   0 james      (501) staff       (20)    18785 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/overlapping-blocks.svg
+-rw-r--r--   0 james      (501) staff       (20)     4537 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/overlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)    20533 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/pipeline.svg
+-rw-r--r--   0 james      (501) staff       (20)    31576 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/reshape.png
+-rw-r--r--   0 james      (501) staff       (20)    31410 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/reshape_problem.png
+-rw-r--r--   0 james      (501) staff       (20)    33288 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/reshape_rechunked.png
+-rw-r--r--   0 james      (501) staff       (20)    50209 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/scaling-edges.png
+-rw-r--r--   0 james      (501) staff       (20)    68476 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/scaling-nodes.png
+-rw-r--r--   0 james      (501) staff       (20)    21294 2023-07-17 19:15:13.000000 dask-2024.4.2/docs/source/images/simple-dask.png
+-rw-r--r--   0 james      (501) staff       (20)    27572 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/transpose-hlg-hovertooltip.png
+-rw-r--r--   0 james      (501) staff       (20)    84492 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/transpose-hlg-html-repr.png
+-rw-r--r--   0 james      (501) staff       (20)    39365 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/transpose.svg
+-rw-r--r--   0 james      (501) staff       (20)    22446 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/transpose_opt.svg
+-rw-r--r--   0 james      (501) staff       (20)   115022 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/trivial.svg
+-rw-r--r--   0 james      (501) staff       (20)     2451 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/images/unoverlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)    12486 2024-02-09 15:39:56.000000 dask-2024.4.2/docs/source/index.rst
+-rw-r--r--   0 james      (501) staff       (20)    15500 2024-03-13 20:06:34.000000 dask-2024.4.2/docs/source/install.rst
+-rw-r--r--   0 james      (501) staff       (20)      341 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/internals.rst
+-rw-r--r--   0 james      (501) staff       (20)      868 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/logos.rst
+-rw-r--r--   0 james      (501) staff       (20)     3573 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/maintainers.rst
+-rw-r--r--   0 james      (501) staff       (20)    12200 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/optimize.rst
+-rw-r--r--   0 james      (501) staff       (20)     7119 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/order.rst
+-rw-r--r--   0 james      (501) staff       (20)     4810 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/phases-of-computation.rst
+-rw-r--r--   0 james      (501) staff       (20)      857 2023-12-07 19:39:17.000000 dask-2024.4.2/docs/source/presentations.rst
+-rw-r--r--   0 james      (501) staff       (20)      868 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/prometheus.rst
+-rw-r--r--   0 james      (501) staff       (20)     6010 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/scheduler-overview.rst
+-rw-r--r--   0 james      (501) staff       (20)     4493 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/scheduling-policy.rst
+-rw-r--r--   0 james      (501) staff       (20)    11015 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/scheduling.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-04-19 21:07:59.549114 dask-2024.4.2/docs/source/scripts/
+-rw-r--r--   0 james      (501) staff       (20)     3294 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/scripts/scheduling.py
+-rw-r--r--   0 james      (501) staff       (20)     6104 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/shared.rst
+-rw-r--r--   0 james      (501) staff       (20)     4562 2023-12-13 17:43:46.000000 dask-2024.4.2/docs/source/software-environments.rst
+-rw-r--r--   0 james      (501) staff       (20)     9342 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/spark.rst
+-rw-r--r--   0 james      (501) staff       (20)     3967 2023-09-13 17:55:33.000000 dask-2024.4.2/docs/source/spec.rst
+-rw-r--r--   0 james      (501) staff       (20)     4754 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/support.rst
+-rw-r--r--   0 james      (501) staff       (20)     1831 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/understanding-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)    12205 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/user-interfaces.rst
+-rw-r--r--   0 james      (501) staff       (20)    11744 2023-07-17 19:15:27.000000 dask-2024.4.2/docs/source/why.rst
+-rw-r--r--   0 james      (501) staff       (20)     7059 2024-04-19 21:02:11.000000 dask-2024.4.2/pyproject.toml
+-rw-r--r--   0 james      (501) staff       (20)       38 2024-04-19 21:07:59.551318 dask-2024.4.2/setup.cfg
+-rwxr-xr-x   0 james      (501) staff       (20)      194 2023-07-17 19:15:27.000000 dask-2024.4.2/setup.py
```

### Comparing `dask-2024.4.1/LICENSE.txt` & `dask-2024.4.2/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/PKG-INFO` & `dask-2024.4.2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2024.4.1
+Version: 2024.4.2
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD-3-Clause
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
@@ -36,15 +36,15 @@
 Requires-Dist: numpy>=1.21; extra == "array"
 Provides-Extra: bag
 Provides-Extra: dataframe
 Requires-Dist: dask[array]; extra == "dataframe"
 Requires-Dist: pandas>=1.3; extra == "dataframe"
 Requires-Dist: dask-expr<1.1,>=1.0; extra == "dataframe"
 Provides-Extra: distributed
-Requires-Dist: distributed==2024.4.1; extra == "distributed"
+Requires-Dist: distributed==2024.4.2; extra == "distributed"
 Provides-Extra: diagnostics
 Requires-Dist: bokeh>=2.4.2; extra == "diagnostics"
 Requires-Dist: jinja2>=2.10.3; extra == "diagnostics"
 Provides-Extra: delayed
 Provides-Extra: complete
 Requires-Dist: dask[array,dataframe,diagnostics,distributed]; extra == "complete"
 Requires-Dist: pyarrow>=7.0; extra == "complete"
```

### Comparing `dask-2024.4.1/README.rst` & `dask-2024.4.2/README.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/conftest.py` & `dask-2024.4.2/conftest.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/_compatibility.py` & `dask-2024.4.2/dask/_compatibility.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/NUMPY_LICENSE.txt` & `dask-2024.4.2/dask/array/NUMPY_LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/__init__.py` & `dask-2024.4.2/dask/array/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/backends.py` & `dask-2024.4.2/dask/array/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/blockwise.py` & `dask-2024.4.2/dask/array/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/chunk.py` & `dask-2024.4.2/dask/array/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/chunk_types.py` & `dask-2024.4.2/dask/array/chunk_types.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/core.py` & `dask-2024.4.2/dask/array/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -3960,7995 +3960,7997 @@
 0000f770: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
 0000f780: 6966 2076 616c 7565 2069 7320 6e70 2e6d  if value is np.m
 0000f790: 612e 6d61 736b 6564 3a0a 2020 2020 2020  a.masked:.      
 0000f7a0: 2020 2020 2020 7661 6c75 6520 3d20 6e70        value = np
 0000f7b0: 2e6d 612e 6d61 736b 6564 5f61 6c6c 2828  .ma.masked_all((
 0000f7c0: 292c 2064 7479 7065 3d73 656c 662e 6474  ), dtype=self.dt
 0000f7d0: 7970 6529 0a0a 2020 2020 2020 2020 6966  ype)..        if
-0000f7e0: 206e 6f74 2069 735f 6461 736b 5f63 6f6c   not is_dask_col
-0000f7f0: 6c65 6374 696f 6e28 7661 6c75 6529 2061  lection(value) a
-0000f800: 6e64 206e 702e 6973 6e61 6e28 7661 6c75  nd np.isnan(valu
-0000f810: 6529 2e61 6e79 2829 3a0a 2020 2020 2020  e).any():.      
-0000f820: 2020 2020 2020 6966 2069 7373 7562 636c        if issubcl
-0000f830: 6173 7328 7365 6c66 2e64 7479 7065 2e74  ass(self.dtype.t
-0000f840: 7970 652c 2049 6e74 6567 7261 6c29 3a0a  ype, Integral):.
-0000f850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f860: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000f870: 2822 6361 6e6e 6f74 2063 6f6e 7665 7274  ("cannot convert
-0000f880: 2066 6c6f 6174 204e 614e 2074 6f20 696e   float NaN to in
-0000f890: 7465 6765 7222 290a 0a20 2020 2020 2020  teger")..       
-0000f8a0: 2023 2320 5573 6520 7468 6520 2277 6865   ## Use the "whe
-0000f8b0: 7265 2220 6d65 7468 6f64 2066 6f72 2063  re" method for c
-0000f8c0: 6173 6573 2077 6865 6e20 6b65 7920 6973  ases when key is
-0000f8d0: 2061 6e20 4172 7261 790a 2020 2020 2020   an Array.      
-0000f8e0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000f8f0: 6b65 792c 2041 7272 6179 293a 0a20 2020  key, Array):.   
-0000f900: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
-0000f910: 736b 2e61 7272 6179 2e72 6f75 7469 6e65  sk.array.routine
-0000f920: 7320 696d 706f 7274 2077 6865 7265 0a0a  s import where..
-0000f930: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0000f940: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
-0000f950: 2041 7272 6179 2920 616e 6420 7661 6c75   Array) and valu
-0000f960: 652e 6e64 696d 203e 2031 3a0a 2020 2020  e.ndim > 1:.    
-0000f970: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000f980: 6520 5661 6c75 6545 7272 6f72 2822 626f  e ValueError("bo
-0000f990: 6f6c 6561 6e20 696e 6465 7820 6172 7261  olean index arra
-0000f9a0: 7920 7368 6f75 6c64 2068 6176 6520 3120  y should have 1 
-0000f9b0: 6469 6d65 6e73 696f 6e22 290a 2020 2020  dimension").    
-0000f9c0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0000f9d0: 2020 2020 2020 2020 2020 2020 2079 203d               y =
-0000f9e0: 2077 6865 7265 286b 6579 2c20 7661 6c75   where(key, valu
-0000f9f0: 652c 2073 656c 6629 0a20 2020 2020 2020  e, self).       
-0000fa00: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
-0000fa10: 6545 7272 6f72 2061 7320 653a 0a20 2020  eError as e:.   
-0000fa20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000fa30: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa50: 2020 2022 426f 6f6c 6561 6e20 696e 6465     "Boolean inde
-0000fa60: 7820 6173 7369 676e 6d65 6e74 2069 6e20  x assignment in 
-0000fa70: 4461 736b 2022 0a20 2020 2020 2020 2020  Dask ".         
-0000fa80: 2020 2020 2020 2020 2020 2022 6578 7065             "expe
-0000fa90: 6374 7320 6571 7561 6c6c 7920 7368 6170  cts equally shap
-0000faa0: 6564 2061 7272 6179 732e 5c6e 4578 616d  ed arrays.\nExam
-0000fab0: 706c 653a 2064 6131 5b64 6132 5d20 3d20  ple: da1[da2] = 
-0000fac0: 6461 3320 220a 2020 2020 2020 2020 2020  da3 ".          
-0000fad0: 2020 2020 2020 2020 2020 2277 6865 7265            "where
-0000fae0: 2064 6131 2e73 6861 7065 203d 3d20 2834   da1.shape == (4
-0000faf0: 2c29 2c20 6461 322e 7368 6170 6520 3d3d  ,), da2.shape ==
-0000fb00: 2028 342c 2920 220a 2020 2020 2020 2020   (4,) ".        
-0000fb10: 2020 2020 2020 2020 2020 2020 2261 6e64              "and
-0000fb20: 2064 6133 2e73 6861 7065 203d 3d20 2834   da3.shape == (4
-0000fb30: 2c29 2e5c 6e22 0a20 2020 2020 2020 2020  ,).\n".         
-0000fb40: 2020 2020 2020 2020 2020 2022 416c 7465             "Alte
-0000fb50: 726e 6174 6976 656c 792c 2079 6f75 2063  rnatively, you c
-0000fb60: 616e 2075 7365 2074 6865 2065 7874 656e  an use the exten
-0000fb70: 6465 6420 4150 4920 7468 6174 2073 7570  ded API that sup
-0000fb80: 706f 7274 7322 0a20 2020 2020 2020 2020  ports".         
-0000fb90: 2020 2020 2020 2020 2020 2022 696e 6465             "inde
-0000fba0: 7869 6e67 2077 6974 6820 7475 706c 6573  xing with tuples
-0000fbb0: 2e5c 6e45 7861 6d70 6c65 3a20 6461 315b  .\nExample: da1[
-0000fbc0: 2864 6132 2c29 5d20 3d20 6461 332e 220a  (da2,)] = da3.".
-0000fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbe0: 2920 6672 6f6d 2065 0a20 2020 2020 2020  ) from e.       
-0000fbf0: 2020 2020 2073 656c 662e 5f6d 6574 6120       self._meta 
-0000fc00: 3d20 792e 5f6d 6574 610a 2020 2020 2020  = y._meta.      
-0000fc10: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
-0000fc20: 3d20 792e 6461 736b 0a20 2020 2020 2020  = y.dask.       
-0000fc30: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
-0000fc40: 3d20 792e 6e61 6d65 0a20 2020 2020 2020  = y.name.       
-0000fc50: 2020 2020 2073 656c 662e 5f63 6875 6e6b       self._chunk
-0000fc60: 7320 3d20 792e 6368 756e 6b73 0a20 2020  s = y.chunks.   
-0000fc70: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0000fc80: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
-0000fc90: 736e 616e 2873 656c 662e 7368 6170 6529  snan(self.shape)
-0000fca0: 2e61 6e79 2829 3a0a 2020 2020 2020 2020  .any():.        
-0000fcb0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000fcc0: 7272 6f72 2866 2241 7272 6179 7320 6368  rror(f"Arrays ch
-0000fcd0: 756e 6b20 7369 7a65 7320 6172 6520 756e  unk sizes are un
-0000fce0: 6b6e 6f77 6e2e 207b 756e 6b6e 6f77 6e5f  known. {unknown_
-0000fcf0: 6368 756e 6b5f 6d65 7373 6167 657d 2229  chunk_message}")
-0000fd00: 0a0a 2020 2020 2020 2020 2320 5374 696c  ..        # Stil
-0000fd10: 6c20 6865 7265 3f20 5468 656e 2061 7070  l here? Then app
-0000fd20: 6c79 2074 6865 2061 7373 6967 6e6d 656e  ly the assignmen
-0000fd30: 7420 746f 206f 7468 6572 2074 7970 6520  t to other type 
-0000fd40: 6f66 0a20 2020 2020 2020 2023 2069 6e64  of.        # ind
-0000fd50: 6963 6573 2076 6961 2074 6865 2060 7365  ices via the `se
-0000fd60: 7469 7465 6d5f 6172 7261 7960 2066 756e  titem_array` fun
-0000fd70: 6374 696f 6e2e 0a20 2020 2020 2020 2076  ction..        v
-0000fd80: 616c 7565 203d 2061 7361 6e79 6172 7261  alue = asanyarra
-0000fd90: 7928 7661 6c75 6529 0a0a 2020 2020 2020  y(value)..      
-0000fda0: 2020 6f75 7420 3d20 2273 6574 6974 656d    out = "setitem
-0000fdb0: 2d22 202b 2074 6f6b 656e 697a 6528 7365  -" + tokenize(se
-0000fdc0: 6c66 2c20 6b65 792c 2076 616c 7565 290a  lf, key, value).
-0000fdd0: 2020 2020 2020 2020 6473 6b20 3d20 7365          dsk = se
-0000fde0: 7469 7465 6d5f 6172 7261 7928 6f75 742c  titem_array(out,
-0000fdf0: 2073 656c 662c 206b 6579 2c20 7661 6c75   self, key, valu
-0000fe00: 6529 0a0a 2020 2020 2020 2020 6d65 7461  e)..        meta
-0000fe10: 203d 206d 6574 615f 6672 6f6d 5f61 7272   = meta_from_arr
-0000fe20: 6179 2873 656c 662e 5f6d 6574 6129 0a20  ay(self._meta). 
-0000fe30: 2020 2020 2020 2069 6620 6e70 2e69 7373         if np.iss
-0000fe40: 6361 6c61 7228 6d65 7461 293a 0a20 2020  calar(meta):.   
-0000fe50: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-0000fe60: 6e70 2e61 7272 6179 286d 6574 6129 0a0a  np.array(meta)..
-0000fe70: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0000fe80: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0000fe90: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0000fea0: 6f75 742c 2064 736b 2c20 6465 7065 6e64  out, dsk, depend
-0000feb0: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
-0000fec0: 2020 2020 2020 2079 203d 2041 7272 6179         y = Array
-0000fed0: 2867 7261 7068 2c20 6f75 742c 2063 6875  (graph, out, chu
-0000fee0: 6e6b 733d 7365 6c66 2e63 6875 6e6b 732c  nks=self.chunks,
-0000fef0: 2064 7479 7065 3d73 656c 662e 6474 7970   dtype=self.dtyp
-0000ff00: 652c 206d 6574 613d 6d65 7461 290a 0a20  e, meta=meta).. 
-0000ff10: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
-0000ff20: 6120 3d20 792e 5f6d 6574 610a 2020 2020  a = y._meta.    
-0000ff30: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
-0000ff40: 792e 6461 736b 0a20 2020 2020 2020 2073  y.dask.        s
-0000ff50: 656c 662e 5f6e 616d 6520 3d20 792e 6e61  elf._name = y.na
-0000ff60: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-0000ff70: 5f63 6875 6e6b 7320 3d20 792e 6368 756e  _chunks = y.chun
-0000ff80: 6b73 0a0a 2020 2020 6465 6620 5f5f 6765  ks..    def __ge
-0000ff90: 7469 7465 6d5f 5f28 7365 6c66 2c20 696e  titem__(self, in
-0000ffa0: 6465 7829 3a0a 2020 2020 2020 2020 2320  dex):.        # 
-0000ffb0: 4669 656c 6420 6163 6365 7373 2c20 652e  Field access, e.
-0000ffc0: 672e 2078 5b27 6127 5d20 6f72 2078 5b5b  g. x['a'] or x[[
-0000ffd0: 2761 272c 2027 6227 5d5d 0a20 2020 2020  'a', 'b']].     
-0000ffe0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0000fff0: 2869 6e64 6578 2c20 7374 7229 206f 7220  (index, str) or 
-00010000: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
-00010010: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
-00010020: 6c69 7374 2920 616e 6420 696e 6465 7820  list) and index 
-00010030: 616e 6420 616c 6c28 6973 696e 7374 616e  and all(isinstan
-00010040: 6365 2869 2c20 7374 7229 2066 6f72 2069  ce(i, str) for i
-00010050: 2069 6e20 696e 6465 7829 0a20 2020 2020   in index).     
-00010060: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00010070: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00010080: 696e 6465 782c 2073 7472 293a 0a20 2020  index, str):.   
-00010090: 2020 2020 2020 2020 2020 2020 2064 7420               dt 
-000100a0: 3d20 7365 6c66 2e64 7479 7065 5b69 6e64  = self.dtype[ind
-000100b0: 6578 5d0a 2020 2020 2020 2020 2020 2020  ex].            
-000100c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000100d0: 2020 2020 2020 6474 203d 206e 702e 6474        dt = np.dt
-000100e0: 7970 6528 0a20 2020 2020 2020 2020 2020  ype(.           
-000100f0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00010100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010110: 2020 2022 6e61 6d65 7322 3a20 696e 6465     "names": inde
-00010120: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-00010130: 2020 2020 2020 2020 2020 2022 666f 726d             "form
-00010140: 6174 7322 3a20 5b73 656c 662e 6474 7970  ats": [self.dtyp
-00010150: 652e 6669 656c 6473 5b6e 616d 655d 5b30  e.fields[name][0
-00010160: 5d20 666f 7220 6e61 6d65 2069 6e20 696e  ] for name in in
-00010170: 6465 785d 2c0a 2020 2020 2020 2020 2020  dex],.          
-00010180: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00010190: 6666 7365 7473 223a 205b 7365 6c66 2e64  ffsets": [self.d
-000101a0: 7479 7065 2e66 6965 6c64 735b 6e61 6d65  type.fields[name
-000101b0: 5d5b 315d 2066 6f72 206e 616d 6520 696e  ][1] for name in
-000101c0: 2069 6e64 6578 5d2c 0a20 2020 2020 2020   index],.       
-000101d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000101e0: 2022 6974 656d 7369 7a65 223a 2073 656c   "itemsize": sel
-000101f0: 662e 6474 7970 652e 6974 656d 7369 7a65  f.dtype.itemsize
-00010200: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010210: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00010220: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00010230: 2020 2020 2020 2069 6620 6474 2e73 6861         if dt.sha
-00010240: 7065 3a0a 2020 2020 2020 2020 2020 2020  pe:.            
-00010250: 2020 2020 6e65 775f 6178 6973 203d 206c      new_axis = l
-00010260: 6973 7428 7261 6e67 6528 7365 6c66 2e6e  ist(range(self.n
-00010270: 6469 6d2c 2073 656c 662e 6e64 696d 202b  dim, self.ndim +
-00010280: 206c 656e 2864 742e 7368 6170 6529 2929   len(dt.shape)))
-00010290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000102a0: 2063 6875 6e6b 7320 3d20 7365 6c66 2e63   chunks = self.c
-000102b0: 6875 6e6b 7320 2b20 7475 706c 6528 2869  hunks + tuple((i
-000102c0: 2c29 2066 6f72 2069 2069 6e20 6474 2e73  ,) for i in dt.s
-000102d0: 6861 7065 290a 2020 2020 2020 2020 2020  hape).          
-000102e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000102f0: 662e 6d61 705f 626c 6f63 6b73 280a 2020  f.map_blocks(.  
-00010300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010310: 2020 6765 7469 7465 6d2c 2069 6e64 6578    getitem, index
-00010320: 2c20 6474 7970 653d 6474 2e62 6173 652c  , dtype=dt.base,
-00010330: 2063 6875 6e6b 733d 6368 756e 6b73 2c20   chunks=chunks, 
-00010340: 6e65 775f 6178 6973 3d6e 6577 5f61 7869  new_axis=new_axi
-00010350: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00010360: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00010370: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00010380: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00010390: 662e 6d61 705f 626c 6f63 6b73 2867 6574  f.map_blocks(get
-000103a0: 6974 656d 2c20 696e 6465 782c 2064 7479  item, index, dty
-000103b0: 7065 3d64 7429 0a0a 2020 2020 2020 2020  pe=dt)..        
-000103c0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-000103d0: 6528 696e 6465 782c 2074 7570 6c65 293a  e(index, tuple):
-000103e0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-000103f0: 6578 203d 2028 696e 6465 782c 290a 0a20  ex = (index,).. 
-00010400: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00010410: 2e61 7272 6179 2e73 6c69 6369 6e67 2069  .array.slicing i
-00010420: 6d70 6f72 7420 280a 2020 2020 2020 2020  mport (.        
-00010430: 2020 2020 6e6f 726d 616c 697a 655f 696e      normalize_in
-00010440: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-00010450: 2073 6c69 6365 5f77 6974 685f 626f 6f6c   slice_with_bool
-00010460: 5f64 6173 6b5f 6172 7261 792c 0a20 2020  _dask_array,.   
-00010470: 2020 2020 2020 2020 2073 6c69 6365 5f77           slice_w
-00010480: 6974 685f 696e 745f 6461 736b 5f61 7272  ith_int_dask_arr
-00010490: 6179 2c0a 2020 2020 2020 2020 290a 0a20  ay,.        ).. 
-000104a0: 2020 2020 2020 2069 6e64 6578 3220 3d20         index2 = 
-000104b0: 6e6f 726d 616c 697a 655f 696e 6465 7828  normalize_index(
-000104c0: 696e 6465 782c 2073 656c 662e 7368 6170  index, self.shap
-000104d0: 6529 0a20 2020 2020 2020 2064 6570 656e  e).        depen
-000104e0: 6465 6e63 6965 7320 3d20 7b73 656c 662e  dencies = {self.
-000104f0: 6e61 6d65 7d0a 2020 2020 2020 2020 666f  name}.        fo
-00010500: 7220 6920 696e 2069 6e64 6578 323a 0a20  r i in index2:. 
-00010510: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00010520: 696e 7374 616e 6365 2869 2c20 4172 7261  instance(i, Arra
-00010530: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
-00010540: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
-00010550: 2e61 6464 2869 2e6e 616d 6529 0a0a 2020  .add(i.name)..  
-00010560: 2020 2020 2020 6966 2061 6e79 2869 7369        if any(isi
-00010570: 6e73 7461 6e63 6528 692c 2041 7272 6179  nstance(i, Array
-00010580: 2920 616e 6420 692e 6474 7970 652e 6b69  ) and i.dtype.ki
-00010590: 6e64 2069 6e20 2269 7522 2066 6f72 2069  nd in "iu" for i
-000105a0: 2069 6e20 696e 6465 7832 293a 0a20 2020   in index2):.   
-000105b0: 2020 2020 2020 2020 2073 656c 662c 2069           self, i
-000105c0: 6e64 6578 3220 3d20 736c 6963 655f 7769  ndex2 = slice_wi
-000105d0: 7468 5f69 6e74 5f64 6173 6b5f 6172 7261  th_int_dask_arra
-000105e0: 7928 7365 6c66 2c20 696e 6465 7832 290a  y(self, index2).
-000105f0: 2020 2020 2020 2020 6966 2061 6e79 2869          if any(i
-00010600: 7369 6e73 7461 6e63 6528 692c 2041 7272  sinstance(i, Arr
-00010610: 6179 2920 616e 6420 692e 6474 7970 6520  ay) and i.dtype 
-00010620: 3d3d 2062 6f6f 6c20 666f 7220 6920 696e  == bool for i in
-00010630: 2069 6e64 6578 3229 3a0a 2020 2020 2020   index2):.      
-00010640: 2020 2020 2020 7365 6c66 2c20 696e 6465        self, inde
-00010650: 7832 203d 2073 6c69 6365 5f77 6974 685f  x2 = slice_with_
-00010660: 626f 6f6c 5f64 6173 6b5f 6172 7261 7928  bool_dask_array(
-00010670: 7365 6c66 2c20 696e 6465 7832 290a 0a20  self, index2).. 
-00010680: 2020 2020 2020 2069 6620 616c 6c28 6973         if all(is
-00010690: 696e 7374 616e 6365 2869 2c20 736c 6963  instance(i, slic
-000106a0: 6529 2061 6e64 2069 203d 3d20 736c 6963  e) and i == slic
-000106b0: 6528 4e6f 6e65 2920 666f 7220 6920 696e  e(None) for i in
-000106c0: 2069 6e64 6578 3229 3a0a 2020 2020 2020   index2):.      
-000106d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000106e0: 660a 0a20 2020 2020 2020 206f 7574 203d  f..        out =
-000106f0: 2022 6765 7469 7465 6d2d 2220 2b20 746f   "getitem-" + to
-00010700: 6b65 6e69 7a65 2873 656c 662c 2069 6e64  kenize(self, ind
-00010710: 6578 3229 0a20 2020 2020 2020 2064 736b  ex2).        dsk
-00010720: 2c20 6368 756e 6b73 203d 2073 6c69 6365  , chunks = slice
-00010730: 5f61 7272 6179 286f 7574 2c20 7365 6c66  _array(out, self
-00010740: 2e6e 616d 652c 2073 656c 662e 6368 756e  .name, self.chun
-00010750: 6b73 2c20 696e 6465 7832 2c20 7365 6c66  ks, index2, self
-00010760: 2e69 7465 6d73 697a 6529 0a0a 2020 2020  .itemsize)..    
-00010770: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-00010780: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-00010790: 636f 6c6c 6563 7469 6f6e 7328 6f75 742c  collections(out,
-000107a0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-000107b0: 6573 3d5b 7365 6c66 5d29 0a0a 2020 2020  es=[self])..    
-000107c0: 2020 2020 6d65 7461 203d 206d 6574 615f      meta = meta_
-000107d0: 6672 6f6d 5f61 7272 6179 2873 656c 662e  from_array(self.
-000107e0: 5f6d 6574 612c 206e 6469 6d3d 6c65 6e28  _meta, ndim=len(
-000107f0: 6368 756e 6b73 2929 0a20 2020 2020 2020  chunks)).       
-00010800: 2069 6620 6e70 2e69 7373 6361 6c61 7228   if np.isscalar(
-00010810: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
-00010820: 2020 206d 6574 6120 3d20 6e70 2e61 7272     meta = np.arr
-00010830: 6179 286d 6574 6129 0a0a 2020 2020 2020  ay(meta)..      
-00010840: 2020 7265 7475 726e 2041 7272 6179 2867    return Array(g
-00010850: 7261 7068 2c20 6f75 742c 2063 6875 6e6b  raph, out, chunk
-00010860: 732c 206d 6574 613d 6d65 7461 290a 0a20  s, meta=meta).. 
-00010870: 2020 2064 6566 205f 7669 6e64 6578 2873     def _vindex(s
-00010880: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
-00010890: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-000108a0: 616e 6365 286b 6579 2c20 7475 706c 6529  ance(key, tuple)
-000108b0: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
-000108c0: 7920 3d20 286b 6579 2c29 0a20 2020 2020  y = (key,).     
-000108d0: 2020 2069 6620 616e 7928 6b20 6973 204e     if any(k is N
-000108e0: 6f6e 6520 666f 7220 6b20 696e 206b 6579  one for k in key
-000108f0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00010900: 6169 7365 2049 6e64 6578 4572 726f 7228  aise IndexError(
-00010910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010920: 2022 7669 6e64 6578 2064 6f65 7320 6e6f   "vindex does no
-00010930: 7420 7375 7070 6f72 7420 696e 6465 7869  t support indexi
-00010940: 6e67 2077 6974 6820 4e6f 6e65 2028 6e70  ng with None (np
-00010950: 2e6e 6577 6178 6973 292c 2022 0a20 2020  .newaxis), ".   
-00010960: 2020 2020 2020 2020 2020 2020 2022 676f               "go
-00010970: 7420 7b7d 222e 666f 726d 6174 286b 6579  t {}".format(key
-00010980: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00010990: 2020 2020 2020 2020 6966 2061 6c6c 2869          if all(i
-000109a0: 7369 6e73 7461 6e63 6528 6b2c 2073 6c69  sinstance(k, sli
-000109b0: 6365 2920 666f 7220 6b20 696e 206b 6579  ce) for k in key
-000109c0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-000109d0: 6620 616c 6c28 0a20 2020 2020 2020 2020  f all(.         
-000109e0: 2020 2020 2020 206b 2e69 6e64 6963 6573         k.indices
-000109f0: 2864 2920 3d3d 2073 6c69 6365 2830 2c20  (d) == slice(0, 
-00010a00: 6429 2e69 6e64 6963 6573 2864 2920 666f  d).indices(d) fo
-00010a10: 7220 6b2c 2064 2069 6e20 7a69 7028 6b65  r k, d in zip(ke
-00010a20: 792c 2073 656c 662e 7368 6170 6529 0a20  y, self.shape). 
-00010a30: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-00010a40: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00010a50: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
-00010a60: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
-00010a70: 7845 7272 6f72 280a 2020 2020 2020 2020  xError(.        
-00010a80: 2020 2020 2020 2020 2276 696e 6465 7820          "vindex 
-00010a90: 7265 7175 6972 6573 2061 7420 6c65 6173  requires at leas
-00010aa0: 7420 6f6e 6520 6e6f 6e2d 736c 6963 6520  t one non-slice 
-00010ab0: 746f 2076 6563 746f 7269 7a65 206f 7665  to vectorize ove
-00010ac0: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
-00010ad0: 2020 2020 2277 6865 6e20 7468 6520 736c      "when the sl
-00010ae0: 6963 6573 2061 7265 206e 6f74 206f 7665  ices are not ove
-00010af0: 7220 7468 6520 656e 7469 7265 2061 7272  r the entire arr
-00010b00: 6179 2028 692e 652c 2078 5b3a 5d29 2e20  ay (i.e, x[:]). 
-00010b10: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00010b20: 2020 2255 7365 206e 6f72 6d61 6c20 736c    "Use normal sl
-00010b30: 6963 696e 6720 696e 7374 6561 6420 7768  icing instead wh
-00010b40: 656e 206f 6e6c 7920 7573 696e 6720 736c  en only using sl
-00010b50: 6963 6573 2e20 476f 743a 207b 7d22 2e66  ices. Got: {}".f
-00010b60: 6f72 6d61 7428 6b65 7929 0a20 2020 2020  ormat(key).     
-00010b70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00010b80: 2065 6c69 6620 616e 7928 6973 5f64 6173   elif any(is_das
-00010b90: 6b5f 636f 6c6c 6563 7469 6f6e 286b 2920  k_collection(k) 
-00010ba0: 666f 7220 6b20 696e 206b 6579 293a 0a20  for k in key):. 
-00010bb0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00010bc0: 2049 6e64 6578 4572 726f 7228 0a20 2020   IndexError(.   
-00010bd0: 2020 2020 2020 2020 2020 2020 2022 7669               "vi
-00010be0: 6e64 6578 2064 6f65 7320 6e6f 7420 7375  ndex does not su
-00010bf0: 7070 6f72 7420 696e 6465 7869 6e67 2077  pport indexing w
-00010c00: 6974 6820 6461 736b 206f 626a 6563 7473  ith dask objects
-00010c10: 2e20 4361 6c6c 2063 6f6d 7075 7465 2022  . Call compute "
-00010c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010c30: 2022 6f6e 2074 6865 2069 6e64 6578 6572   "on the indexer
-00010c40: 2066 6972 7374 2074 6f20 6765 7420 616e   first to get an
-00010c50: 2065 7661 6c75 7261 7465 6420 6172 7261   evalurated arra
-00010c60: 792e 2047 6f74 3a20 7b7d 222e 666f 726d  y. Got: {}".form
-00010c70: 6174 286b 6579 290a 2020 2020 2020 2020  at(key).        
-00010c80: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00010c90: 7475 726e 205f 7669 6e64 6578 2873 656c  turn _vindex(sel
-00010ca0: 662c 202a 6b65 7929 0a0a 2020 2020 4070  f, *key)..    @p
-00010cb0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00010cc0: 7669 6e64 6578 2873 656c 6629 3a0a 2020  vindex(self):.  
-00010cd0: 2020 2020 2020 2222 2256 6563 746f 7269        """Vectori
-00010ce0: 7a65 6420 696e 6465 7869 6e67 2077 6974  zed indexing wit
-00010cf0: 6820 6272 6f61 6463 6173 7469 6e67 2e0a  h broadcasting..
-00010d00: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
-00010d10: 2065 7175 6976 616c 656e 7420 746f 206e   equivalent to n
-00010d20: 756d 7079 2773 2061 6476 616e 6365 6420  umpy's advanced 
-00010d30: 696e 6465 7869 6e67 2c20 7573 696e 6720  indexing, using 
-00010d40: 6172 7261 7973 2074 6861 7420 6172 650a  arrays that are.
-00010d50: 2020 2020 2020 2020 6272 6f61 6463 6173          broadcas
-00010d60: 7420 6167 6169 6e73 7420 6561 6368 206f  t against each o
-00010d70: 7468 6572 2e20 5468 6973 2061 6c6c 6f77  ther. This allow
-00010d80: 7320 666f 7220 706f 696e 7477 6973 6520  s for pointwise 
-00010d90: 696e 6465 7869 6e67 3a0a 0a20 2020 2020  indexing:..     
-00010da0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00010db0: 736b 2e61 7272 6179 2061 7320 6461 0a20  sk.array as da. 
-00010dc0: 2020 2020 2020 203e 3e3e 2078 203d 206e         >>> x = n
-00010dd0: 702e 6172 7261 7928 5b5b 312c 2032 2c20  p.array([[1, 2, 
-00010de0: 335d 2c20 5b34 2c20 352c 2036 5d2c 205b  3], [4, 5, 6], [
-00010df0: 372c 2038 2c20 395d 5d29 0a20 2020 2020  7, 8, 9]]).     
-00010e00: 2020 203e 3e3e 2078 203d 2064 612e 6672     >>> x = da.fr
-00010e10: 6f6d 5f61 7272 6179 2878 2c20 6368 756e  om_array(x, chun
-00010e20: 6b73 3d32 290a 2020 2020 2020 2020 3e3e  ks=2).        >>
-00010e30: 3e20 782e 7669 6e64 6578 5b5b 302c 2031  > x.vindex[[0, 1
-00010e40: 2c20 325d 2c20 5b30 2c20 312c 2032 5d5d  , 2], [0, 1, 2]]
-00010e50: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00010e60: 2020 2061 7272 6179 285b 312c 2035 2c20     array([1, 5, 
-00010e70: 395d 290a 0a20 2020 2020 2020 204d 6978  9])..        Mix
-00010e80: 6564 2062 6173 6963 2f61 6476 616e 6365  ed basic/advance
-00010e90: 6420 696e 6465 7869 6e67 2077 6974 6820  d indexing with 
-00010ea0: 736c 6963 6573 2f61 7272 6179 7320 6973  slices/arrays is
-00010eb0: 2061 6c73 6f20 7375 7070 6f72 7465 642e   also supported.
-00010ec0: 2054 6865 0a20 2020 2020 2020 206f 7264   The.        ord
-00010ed0: 6572 206f 6620 6469 6d65 6e73 696f 6e73  er of dimensions
-00010ee0: 2069 6e20 7468 6520 7265 7375 6c74 2066   in the result f
-00010ef0: 6f6c 6c6f 7773 2074 686f 7365 2070 726f  ollows those pro
-00010f00: 706f 7365 6420 666f 720a 2020 2020 2020  posed for.      
-00010f10: 2020 606e 6461 7272 6179 2e76 696e 6465    `ndarray.vinde
-00010f20: 7820 3c68 7474 7073 3a2f 2f67 6974 6875  x <https://githu
-00010f30: 622e 636f 6d2f 6e75 6d70 792f 6e75 6d70  b.com/numpy/nump
-00010f40: 792f 7075 6c6c 2f36 3235 363e 605f 3a0a  y/pull/6256>`_:.
-00010f50: 2020 2020 2020 2020 7468 6520 7375 6273          the subs
-00010f60: 7061 6365 2073 7061 6e6e 6564 2062 7920  pace spanned by 
-00010f70: 6172 7261 7973 2069 7320 666f 6c6c 6f77  arrays is follow
-00010f80: 6564 2062 7920 616c 6c20 736c 6963 6573  ed by all slices
-00010f90: 2e0a 0a20 2020 2020 2020 204e 6f74 653a  ...        Note:
-00010fa0: 2060 6076 696e 6465 7860 6020 7072 6f76   ``vindex`` prov
-00010fb0: 6964 6573 206d 6f72 6520 6765 6e65 7261  ides more genera
-00010fc0: 6c20 6675 6e63 7469 6f6e 616c 6974 7920  l functionality 
-00010fd0: 7468 616e 2073 7461 6e64 6172 640a 2020  than standard.  
-00010fe0: 2020 2020 2020 696e 6465 7869 6e67 2c20        indexing, 
-00010ff0: 6275 7420 6974 2061 6c73 6f20 6861 7320  but it also has 
-00011000: 6665 7765 7220 6f70 7469 6d69 7a61 7469  fewer optimizati
-00011010: 6f6e 7320 616e 6420 6361 6e20 6265 2073  ons and can be s
-00011020: 6967 6e69 6669 6361 6e74 6c79 0a20 2020  ignificantly.   
-00011030: 2020 2020 2073 6c6f 7765 722e 0a20 2020       slower..   
-00011040: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00011050: 2072 6574 7572 6e20 496e 6465 7843 616c   return IndexCal
-00011060: 6c61 626c 6528 7365 6c66 2e5f 7669 6e64  lable(self._vind
-00011070: 6578 290a 0a20 2020 2040 7072 6f70 6572  ex)..    @proper
-00011080: 7479 0a20 2020 2064 6566 2062 6c6f 636b  ty.    def block
-00011090: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-000110a0: 2022 2222 416e 2061 7272 6179 2d6c 696b   """An array-lik
-000110b0: 6520 696e 7465 7266 6163 6520 746f 2074  e interface to t
-000110c0: 6865 2062 6c6f 636b 7320 6f66 2061 6e20  he blocks of an 
-000110d0: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
-000110e0: 5468 6973 2072 6574 7572 6e73 2061 2060  This returns a `
-000110f0: 6042 6c6f 636b 7669 6577 6060 206f 626a  `Blockview`` obj
-00011100: 6563 7420 7468 6174 2070 726f 7669 6465  ect that provide
-00011110: 7320 616e 2061 7272 6179 2d6c 696b 6520  s an array-like 
-00011120: 696e 7465 7266 6163 650a 2020 2020 2020  interface.      
-00011130: 2020 746f 2074 6865 2062 6c6f 636b 7320    to the blocks 
-00011140: 6f66 2061 2064 6173 6b20 6172 7261 792e  of a dask array.
-00011150: 2020 4e75 6d70 792d 7374 796c 6520 696e    Numpy-style in
-00011160: 6465 7869 6e67 206f 6620 6120 6060 426c  dexing of a ``Bl
-00011170: 6f63 6b76 6965 7760 6020 6f62 6a65 6374  ockview`` object
-00011180: 0a20 2020 2020 2020 2072 6574 7572 6e73  .        returns
-00011190: 2061 2073 656c 6563 7469 6f6e 206f 6620   a selection of 
-000111a0: 626c 6f63 6b73 2061 7320 6120 6e65 7720  blocks as a new 
-000111b0: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
-000111c0: 2020 2020 2059 6f75 2063 616e 2069 6e64       You can ind
-000111d0: 6578 2060 6061 7272 6179 2e62 6c6f 636b  ex ``array.block
-000111e0: 7360 6020 6c69 6b65 2061 206e 756d 7079  s`` like a numpy
-000111f0: 2061 7272 6179 206f 6620 7368 6170 650a   array of shape.
-00011200: 2020 2020 2020 2020 6571 7561 6c20 746f          equal to
-00011210: 2074 6865 206e 756d 6265 7220 6f66 2062   the number of b
-00011220: 6c6f 636b 7320 696e 2065 6163 6820 6469  locks in each di
-00011230: 6d65 6e73 696f 6e2c 2028 6176 6169 6c61  mension, (availa
-00011240: 626c 6520 6173 0a20 2020 2020 2020 2061  ble as.        a
-00011250: 7272 6179 2e62 6c6f 636b 732e 7369 7a65  rray.blocks.size
-00011260: 292e 2020 5468 6520 6469 6d65 6e73 696f  ).  The dimensio
-00011270: 6e61 6c69 7479 206f 6620 7468 6520 6f75  nality of the ou
-00011280: 7470 7574 2061 7272 6179 206d 6174 6368  tput array match
-00011290: 6573 0a20 2020 2020 2020 2074 6865 2064  es.        the d
-000112a0: 696d 656e 7369 6f6e 206f 6620 7468 6973  imension of this
-000112b0: 2061 7272 6179 2c20 6576 656e 2069 6620   array, even if 
-000112c0: 696e 7465 6765 7220 696e 6469 6365 7320  integer indices 
-000112d0: 6172 6520 7061 7373 6564 2e0a 2020 2020  are passed..    
-000112e0: 2020 2020 536c 6963 696e 6720 7769 7468      Slicing with
-000112f0: 2060 606e 702e 6e65 7761 7869 7360 6020   ``np.newaxis`` 
-00011300: 6f72 206d 756c 7469 706c 6520 6c69 7374  or multiple list
-00011310: 7320 6973 206e 6f74 2073 7570 706f 7274  s is not support
-00011320: 6564 2e0a 0a20 2020 2020 2020 2045 7861  ed...        Exa
-00011330: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-00011340: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-00011350: 3e3e 2069 6d70 6f72 7420 6461 736b 2e61  >> import dask.a
-00011360: 7272 6179 2061 7320 6461 0a20 2020 2020  rray as da.     
-00011370: 2020 203e 3e3e 2078 203d 2064 612e 6172     >>> x = da.ar
-00011380: 616e 6765 2838 2c20 6368 756e 6b73 3d32  ange(8, chunks=2
-00011390: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
-000113a0: 626c 6f63 6b73 2e73 6861 7065 2023 2061  blocks.shape # a
-000113b0: 6c69 6173 6573 2078 2e6e 756d 626c 6f63  liases x.numbloc
-000113c0: 6b73 0a20 2020 2020 2020 2028 342c 290a  ks.        (4,).
-000113d0: 2020 2020 2020 2020 3e3e 3e20 782e 626c          >>> x.bl
-000113e0: 6f63 6b73 5b30 5d2e 636f 6d70 7574 6528  ocks[0].compute(
-000113f0: 290a 2020 2020 2020 2020 6172 7261 7928  ).        array(
-00011400: 5b30 2c20 315d 290a 2020 2020 2020 2020  [0, 1]).        
-00011410: 3e3e 3e20 782e 626c 6f63 6b73 5b3a 335d  >>> x.blocks[:3]
-00011420: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00011430: 2020 2061 7272 6179 285b 302c 2031 2c20     array([0, 1, 
-00011440: 322c 2033 2c20 342c 2035 5d29 0a20 2020  2, 3, 4, 5]).   
-00011450: 2020 2020 203e 3e3e 2078 2e62 6c6f 636b       >>> x.block
-00011460: 735b 3a3a 325d 2e63 6f6d 7075 7465 2829  s[::2].compute()
-00011470: 0a20 2020 2020 2020 2061 7272 6179 285b  .        array([
-00011480: 302c 2031 2c20 342c 2035 5d29 0a20 2020  0, 1, 4, 5]).   
-00011490: 2020 2020 203e 3e3e 2078 2e62 6c6f 636b       >>> x.block
-000114a0: 735b 5b2d 312c 2030 5d5d 2e63 6f6d 7075  s[[-1, 0]].compu
-000114b0: 7465 2829 0a20 2020 2020 2020 2061 7272  te().        arr
-000114c0: 6179 285b 362c 2037 2c20 302c 2031 5d29  ay([6, 7, 0, 1])
-000114d0: 0a20 2020 2020 2020 203e 3e3e 2078 2e62  .        >>> x.b
-000114e0: 6c6f 636b 732e 7261 7665 6c28 2920 2320  locks.ravel() # 
-000114f0: 646f 6374 6573 743a 202b 4e4f 524d 414c  doctest: +NORMAL
-00011500: 495a 455f 5748 4954 4553 5041 4345 0a20  IZE_WHITESPACE. 
-00011510: 2020 2020 2020 205b 6461 736b 2e61 7272         [dask.arr
-00011520: 6179 3c62 6c6f 636b 732c 2073 6861 7065  ay<blocks, shape
-00011530: 3d28 322c 292c 2064 7479 7065 3d69 6e74  =(2,), dtype=int
-00011540: 3634 2c20 6368 756e 6b73 697a 653d 2832  64, chunksize=(2
-00011550: 2c29 2c20 6368 756e 6b74 7970 653d 6e75  ,), chunktype=nu
-00011560: 6d70 792e 6e64 6172 7261 793e 2c0a 2020  mpy.ndarray>,.  
-00011570: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
-00011580: 793c 626c 6f63 6b73 2c20 7368 6170 653d  y<blocks, shape=
-00011590: 2832 2c29 2c20 6474 7970 653d 696e 7436  (2,), dtype=int6
-000115a0: 342c 2063 6875 6e6b 7369 7a65 3d28 322c  4, chunksize=(2,
-000115b0: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
-000115c0: 7079 2e6e 6461 7272 6179 3e2c 0a20 2020  py.ndarray>,.   
-000115d0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-000115e0: 3c62 6c6f 636b 732c 2073 6861 7065 3d28  <blocks, shape=(
-000115f0: 322c 292c 2064 7479 7065 3d69 6e74 3634  2,), dtype=int64
-00011600: 2c20 6368 756e 6b73 697a 653d 2832 2c29  , chunksize=(2,)
-00011610: 2c20 6368 756e 6b74 7970 653d 6e75 6d70  , chunktype=nump
-00011620: 792e 6e64 6172 7261 793e 2c0a 2020 2020  y.ndarray>,.    
-00011630: 2020 2020 2064 6173 6b2e 6172 7261 793c       dask.array<
-00011640: 626c 6f63 6b73 2c20 7368 6170 653d 2832  blocks, shape=(2
-00011650: 2c29 2c20 6474 7970 653d 696e 7436 342c  ,), dtype=int64,
-00011660: 2063 6875 6e6b 7369 7a65 3d28 322c 292c   chunksize=(2,),
-00011670: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
-00011680: 2e6e 6461 7272 6179 3e5d 0a0a 2020 2020  .ndarray>]..    
-00011690: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-000116a0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000116b0: 2020 2020 416e 2069 6e73 7461 6e63 6520      An instance 
-000116c0: 6f66 2060 6064 6173 6b2e 6172 7261 792e  of ``dask.array.
-000116d0: 426c 6f63 6b76 6965 7760 600a 2020 2020  Blockview``.    
-000116e0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000116f0: 7265 7475 726e 2042 6c6f 636b 5669 6577  return BlockView
-00011700: 2873 656c 6629 0a0a 2020 2020 4070 726f  (self)..    @pro
-00011710: 7065 7274 790a 2020 2020 6465 6620 7061  perty.    def pa
-00011720: 7274 6974 696f 6e73 2873 656c 6629 3a0a  rtitions(self):.
-00011730: 2020 2020 2020 2020 2222 2253 6c69 6365          """Slice
-00011740: 2061 6e20 6172 7261 7920 6279 2070 6172   an array by par
-00011750: 7469 7469 6f6e 732e 2041 6c69 6173 206f  titions. Alias o
-00011760: 6620 6461 736b 2061 7272 6179 202e 626c  f dask array .bl
-00011770: 6f63 6b73 2061 7474 7269 6275 7465 2e0a  ocks attribute..
-00011780: 0a20 2020 2020 2020 2054 6869 7320 616c  .        This al
-00011790: 6961 7320 616c 6c6f 7773 2079 6f75 2074  ias allows you t
-000117a0: 6f20 7772 6974 6520 6167 6e6f 7374 6963  o write agnostic
-000117b0: 2063 6f64 6520 7468 6174 2077 6f72 6b73   code that works
-000117c0: 2077 6974 6820 626f 7468 0a20 2020 2020   with both.     
-000117d0: 2020 2064 6173 6b20 6172 7261 7973 2061     dask arrays a
-000117e0: 6e64 2064 6173 6b20 6461 7461 6672 616d  nd dask datafram
-000117f0: 6573 2e0a 0a20 2020 2020 2020 2054 6869  es...        Thi
-00011800: 7320 7265 7475 726e 7320 6120 6060 426c  s returns a ``Bl
-00011810: 6f63 6b76 6965 7760 6020 6f62 6a65 6374  ockview`` object
-00011820: 2074 6861 7420 7072 6f76 6964 6573 2061   that provides a
-00011830: 6e20 6172 7261 792d 6c69 6b65 2069 6e74  n array-like int
-00011840: 6572 6661 6365 0a20 2020 2020 2020 2074  erface.        t
-00011850: 6f20 7468 6520 626c 6f63 6b73 206f 6620  o the blocks of 
-00011860: 6120 6461 736b 2061 7272 6179 2e20 204e  a dask array.  N
-00011870: 756d 7079 2d73 7479 6c65 2069 6e64 6578  umpy-style index
-00011880: 696e 6720 6f66 2061 2060 6042 6c6f 636b  ing of a ``Block
-00011890: 7669 6577 6060 206f 626a 6563 740a 2020  view`` object.  
-000118a0: 2020 2020 2020 7265 7475 726e 7320 6120        returns a 
-000118b0: 7365 6c65 6374 696f 6e20 6f66 2062 6c6f  selection of blo
-000118c0: 636b 7320 6173 2061 206e 6577 2064 6173  cks as a new das
-000118d0: 6b20 6172 7261 792e 0a0a 2020 2020 2020  k array...      
-000118e0: 2020 596f 7520 6361 6e20 696e 6465 7820    You can index 
-000118f0: 6060 6172 7261 792e 626c 6f63 6b73 6060  ``array.blocks``
-00011900: 206c 696b 6520 6120 6e75 6d70 7920 6172   like a numpy ar
-00011910: 7261 7920 6f66 2073 6861 7065 0a20 2020  ray of shape.   
-00011920: 2020 2020 2065 7175 616c 2074 6f20 7468       equal to th
-00011930: 6520 6e75 6d62 6572 206f 6620 626c 6f63  e number of bloc
-00011940: 6b73 2069 6e20 6561 6368 2064 696d 656e  ks in each dimen
-00011950: 7369 6f6e 2c20 2861 7661 696c 6162 6c65  sion, (available
-00011960: 2061 730a 2020 2020 2020 2020 6172 7261   as.        arra
-00011970: 792e 626c 6f63 6b73 2e73 697a 6529 2e20  y.blocks.size). 
-00011980: 2054 6865 2064 696d 656e 7369 6f6e 616c   The dimensional
-00011990: 6974 7920 6f66 2074 6865 206f 7574 7075  ity of the outpu
-000119a0: 7420 6172 7261 7920 6d61 7463 6865 730a  t array matches.
-000119b0: 2020 2020 2020 2020 7468 6520 6469 6d65          the dime
-000119c0: 6e73 696f 6e20 6f66 2074 6869 7320 6172  nsion of this ar
-000119d0: 7261 792c 2065 7665 6e20 6966 2069 6e74  ray, even if int
-000119e0: 6567 6572 2069 6e64 6963 6573 2061 7265  eger indices are
-000119f0: 2070 6173 7365 642e 0a20 2020 2020 2020   passed..       
-00011a00: 2053 6c69 6369 6e67 2077 6974 6820 6060   Slicing with ``
-00011a10: 6e70 2e6e 6577 6178 6973 6060 206f 7220  np.newaxis`` or 
-00011a20: 6d75 6c74 6970 6c65 206c 6973 7473 2069  multiple lists i
-00011a30: 7320 6e6f 7420 7375 7070 6f72 7465 642e  s not supported.
-00011a40: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00011a50: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00011a60: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-00011a70: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
-00011a80: 7920 6173 2064 610a 2020 2020 2020 2020  y as da.        
-00011a90: 3e3e 3e20 7820 3d20 6461 2e61 7261 6e67  >>> x = da.arang
-00011aa0: 6528 382c 2063 6875 6e6b 733d 3229 0a20  e(8, chunks=2). 
-00011ab0: 2020 2020 2020 203e 3e3e 2078 2e70 6172         >>> x.par
-00011ac0: 7469 7469 6f6e 732e 7368 6170 6520 2320  titions.shape # 
-00011ad0: 616c 6961 7365 7320 782e 6e75 6d62 6c6f  aliases x.numblo
-00011ae0: 636b 730a 2020 2020 2020 2020 2834 2c29  cks.        (4,)
-00011af0: 0a20 2020 2020 2020 203e 3e3e 2078 2e70  .        >>> x.p
-00011b00: 6172 7469 7469 6f6e 735b 305d 2e63 6f6d  artitions[0].com
-00011b10: 7075 7465 2829 0a20 2020 2020 2020 2061  pute().        a
-00011b20: 7272 6179 285b 302c 2031 5d29 0a20 2020  rray([0, 1]).   
-00011b30: 2020 2020 203e 3e3e 2078 2e70 6172 7469       >>> x.parti
-00011b40: 7469 6f6e 735b 3a33 5d2e 636f 6d70 7574  tions[:3].comput
-00011b50: 6528 290a 2020 2020 2020 2020 6172 7261  e().        arra
-00011b60: 7928 5b30 2c20 312c 2032 2c20 332c 2034  y([0, 1, 2, 3, 4
-00011b70: 2c20 355d 290a 2020 2020 2020 2020 3e3e  , 5]).        >>
-00011b80: 3e20 782e 7061 7274 6974 696f 6e73 5b3a  > x.partitions[:
-00011b90: 3a32 5d2e 636f 6d70 7574 6528 290a 2020  :2].compute().  
-00011ba0: 2020 2020 2020 6172 7261 7928 5b30 2c20        array([0, 
-00011bb0: 312c 2034 2c20 355d 290a 2020 2020 2020  1, 4, 5]).      
-00011bc0: 2020 3e3e 3e20 782e 7061 7274 6974 696f    >>> x.partitio
-00011bd0: 6e73 5b5b 2d31 2c20 305d 5d2e 636f 6d70  ns[[-1, 0]].comp
-00011be0: 7574 6528 290a 2020 2020 2020 2020 6172  ute().        ar
-00011bf0: 7261 7928 5b36 2c20 372c 2030 2c20 315d  ray([6, 7, 0, 1]
-00011c00: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
-00011c10: 7061 7274 6974 696f 6e73 2e72 6176 656c  partitions.ravel
-00011c20: 2829 2023 2064 6f63 7465 7374 3a20 2b4e  () # doctest: +N
-00011c30: 4f52 4d41 4c49 5a45 5f57 4849 5445 5350  ORMALIZE_WHITESP
-00011c40: 4143 450a 2020 2020 2020 2020 5b64 6173  ACE.        [das
-00011c50: 6b2e 6172 7261 793c 626c 6f63 6b73 2c20  k.array<blocks, 
-00011c60: 7368 6170 653d 2832 2c29 2c20 6474 7970  shape=(2,), dtyp
-00011c70: 653d 696e 7436 342c 2063 6875 6e6b 7369  e=int64, chunksi
-00011c80: 7a65 3d28 322c 292c 2063 6875 6e6b 7479  ze=(2,), chunkty
-00011c90: 7065 3d6e 756d 7079 2e6e 6461 7272 6179  pe=numpy.ndarray
-00011ca0: 3e2c 0a20 2020 2020 2020 2020 6461 736b  >,.         dask
-00011cb0: 2e61 7272 6179 3c62 6c6f 636b 732c 2073  .array<blocks, s
-00011cc0: 6861 7065 3d28 322c 292c 2064 7479 7065  hape=(2,), dtype
-00011cd0: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
-00011ce0: 653d 2832 2c29 2c20 6368 756e 6b74 7970  e=(2,), chunktyp
-00011cf0: 653d 6e75 6d70 792e 6e64 6172 7261 793e  e=numpy.ndarray>
-00011d00: 2c0a 2020 2020 2020 2020 2064 6173 6b2e  ,.         dask.
-00011d10: 6172 7261 793c 626c 6f63 6b73 2c20 7368  array<blocks, sh
-00011d20: 6170 653d 2832 2c29 2c20 6474 7970 653d  ape=(2,), dtype=
-00011d30: 696e 7436 342c 2063 6875 6e6b 7369 7a65  int64, chunksize
-00011d40: 3d28 322c 292c 2063 6875 6e6b 7479 7065  =(2,), chunktype
-00011d50: 3d6e 756d 7079 2e6e 6461 7272 6179 3e2c  =numpy.ndarray>,
-00011d60: 0a20 2020 2020 2020 2020 6461 736b 2e61  .         dask.a
-00011d70: 7272 6179 3c62 6c6f 636b 732c 2073 6861  rray<blocks, sha
-00011d80: 7065 3d28 322c 292c 2064 7479 7065 3d69  pe=(2,), dtype=i
-00011d90: 6e74 3634 2c20 6368 756e 6b73 697a 653d  nt64, chunksize=
-00011da0: 2832 2c29 2c20 6368 756e 6b74 7970 653d  (2,), chunktype=
-00011db0: 6e75 6d70 792e 6e64 6172 7261 793e 5d0a  numpy.ndarray>].
-00011dc0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00011dd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00011de0: 0a20 2020 2020 2020 2041 6e20 696e 7374  .        An inst
-00011df0: 616e 6365 206f 6620 6060 6461 2e61 7272  ance of ``da.arr
-00011e00: 6179 2e42 6c6f 636b 7669 6577 6060 0a20  ay.Blockview``. 
-00011e10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00011e20: 2020 2072 6574 7572 6e20 7365 6c66 2e62     return self.b
-00011e30: 6c6f 636b 730a 0a20 2020 2064 6566 2064  locks..    def d
-00011e40: 6f74 2873 656c 662c 206f 7468 6572 293a  ot(self, other):
-00011e50: 0a20 2020 2020 2020 2022 2222 446f 7420  .        """Dot 
-00011e60: 7072 6f64 7563 7420 6f66 2073 656c 6620  product of self 
-00011e70: 616e 6420 6f74 6865 722e 0a0a 2020 2020  and other...    
-00011e80: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
-00011e90: 6e63 3a60 6461 736b 2e61 7272 6179 2e74  nc:`dask.array.t
-00011ea0: 656e 736f 7264 6f74 6020 666f 7220 6675  ensordot` for fu
-00011eb0: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
-00011ec0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-00011ed0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00011ee0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-00011ef0: 6b2e 6172 7261 792e 646f 7420 3a20 6571  k.array.dot : eq
-00011f00: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
-00011f10: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-00011f20: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00011f30: 6172 7261 792e 726f 7574 696e 6573 2069  array.routines i
-00011f40: 6d70 6f72 7420 7465 6e73 6f72 646f 740a  mport tensordot.
-00011f50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00011f60: 7465 6e73 6f72 646f 7428 7365 6c66 2c20  tensordot(self, 
-00011f70: 6f74 6865 722c 2061 7865 733d 2828 7365  other, axes=((se
-00011f80: 6c66 2e6e 6469 6d20 2d20 312c 292c 2028  lf.ndim - 1,), (
-00011f90: 6f74 6865 722e 6e64 696d 202d 2032 2c29  other.ndim - 2,)
-00011fa0: 2929 0a0a 2020 2020 4070 726f 7065 7274  ))..    @propert
-00011fb0: 790a 2020 2020 6465 6620 4128 7365 6c66  y.    def A(self
-00011fc0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00011fd0: 6e20 7365 6c66 0a0a 2020 2020 4070 726f  n self..    @pro
-00011fe0: 7065 7274 790a 2020 2020 6465 6620 5428  perty.    def T(
-00011ff0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00012000: 6574 7572 6e20 7365 6c66 2e74 7261 6e73  eturn self.trans
-00012010: 706f 7365 2829 0a0a 2020 2020 6465 6620  pose()..    def 
-00012020: 7472 616e 7370 6f73 6528 7365 6c66 2c20  transpose(self, 
-00012030: 2a61 7865 7329 3a0a 2020 2020 2020 2020  *axes):.        
-00012040: 2222 2252 6576 6572 7365 206f 7220 7065  """Reverse or pe
-00012050: 726d 7574 6520 7468 6520 6178 6573 206f  rmute the axes o
-00012060: 6620 616e 2061 7272 6179 2e20 5265 7475  f an array. Retu
-00012070: 726e 2074 6865 206d 6f64 6966 6965 6420  rn the modified 
-00012080: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
-00012090: 5265 6665 7220 746f 203a 6675 6e63 3a60  Refer to :func:`
-000120a0: 6461 736b 2e61 7272 6179 2e74 7261 6e73  dask.array.trans
-000120b0: 706f 7365 6020 666f 7220 6675 6c6c 2064  pose` for full d
-000120c0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
-000120d0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-000120e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000120f0: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
-00012100: 7261 792e 7472 616e 7370 6f73 6520 3a20  ray.transpose : 
-00012110: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
-00012120: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
-00012130: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00012140: 6b2e 6172 7261 792e 726f 7574 696e 6573  k.array.routines
-00012150: 2069 6d70 6f72 7420 7472 616e 7370 6f73   import transpos
-00012160: 650a 0a20 2020 2020 2020 2069 6620 6e6f  e..        if no
-00012170: 7420 6178 6573 3a0a 2020 2020 2020 2020  t axes:.        
-00012180: 2020 2020 6178 6573 203d 204e 6f6e 650a      axes = None.
-00012190: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
-000121a0: 2861 7865 7329 203d 3d20 3120 616e 6420  (axes) == 1 and 
-000121b0: 6973 696e 7374 616e 6365 2861 7865 735b  isinstance(axes[
-000121c0: 305d 2c20 4974 6572 6162 6c65 293a 0a20  0], Iterable):. 
-000121d0: 2020 2020 2020 2020 2020 2061 7865 7320             axes 
-000121e0: 3d20 6178 6573 5b30 5d0a 2020 2020 2020  = axes[0].      
-000121f0: 2020 6966 2028 6178 6573 203d 3d20 7475    if (axes == tu
-00012200: 706c 6528 7261 6e67 6528 7365 6c66 2e6e  ple(range(self.n
-00012210: 6469 6d29 2929 206f 7220 2861 7865 7320  dim))) or (axes 
-00012220: 3d3d 2074 7570 6c65 2872 616e 6765 282d  == tuple(range(-
-00012230: 7365 6c66 2e6e 6469 6d2c 2030 2929 293a  self.ndim, 0))):
-00012240: 0a20 2020 2020 2020 2020 2020 2023 206e  .            # n
-00012250: 6f20 7472 616e 7370 6f73 6520 6e65 6365  o transpose nece
-00012260: 7373 6172 790a 2020 2020 2020 2020 2020  ssary.          
-00012270: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-00012280: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00012290: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-000122a0: 7261 6e73 706f 7365 2873 656c 662c 2061  ranspose(self, a
-000122b0: 7865 733d 6178 6573 290a 0a20 2020 2064  xes=axes)..    d
-000122c0: 6566 2072 6176 656c 2873 656c 6629 3a0a  ef ravel(self):.
-000122d0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000122e0: 6e20 6120 666c 6174 7465 6e65 6420 6172  n a flattened ar
-000122f0: 7261 792e 0a0a 2020 2020 2020 2020 5265  ray...        Re
-00012300: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
-00012310: 736b 2e61 7272 6179 2e72 6176 656c 6020  sk.array.ravel` 
-00012320: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
-00012330: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00012340: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00012350: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00012360: 2020 2064 6173 6b2e 6172 7261 792e 7261     dask.array.ra
-00012370: 7665 6c20 3a20 6571 7569 7661 6c65 6e74  vel : equivalent
-00012380: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-00012390: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
-000123a0: 6f6d 2064 6173 6b2e 6172 7261 792e 726f  om dask.array.ro
-000123b0: 7574 696e 6573 2069 6d70 6f72 7420 7261  utines import ra
-000123c0: 7665 6c0a 0a20 2020 2020 2020 2072 6574  vel..        ret
-000123d0: 7572 6e20 7261 7665 6c28 7365 6c66 290a  urn ravel(self).
-000123e0: 0a20 2020 2066 6c61 7474 656e 203d 2072  .    flatten = r
-000123f0: 6176 656c 0a0a 2020 2020 6465 6620 6368  avel..    def ch
-00012400: 6f6f 7365 2873 656c 662c 2063 686f 6963  oose(self, choic
-00012410: 6573 293a 0a20 2020 2020 2020 2022 2222  es):.        """
-00012420: 5573 6520 616e 2069 6e64 6578 2061 7272  Use an index arr
-00012430: 6179 2074 6f20 636f 6e73 7472 7563 7420  ay to construct 
-00012440: 6120 6e65 7720 6172 7261 7920 6672 6f6d  a new array from
-00012450: 2061 2073 6574 206f 6620 6368 6f69 6365   a set of choice
-00012460: 732e 0a0a 2020 2020 2020 2020 5265 6665  s...        Refe
-00012470: 7220 746f 203a 6675 6e63 3a60 6461 736b  r to :func:`dask
-00012480: 2e61 7272 6179 2e63 686f 6f73 6560 2066  .array.choose` f
-00012490: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
-000124a0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-000124b0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000124c0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000124d0: 2020 6461 736b 2e61 7272 6179 2e63 686f    dask.array.cho
-000124e0: 6f73 6520 3a20 6571 7569 7661 6c65 6e74  ose : equivalent
-000124f0: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-00012500: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
-00012510: 6f6d 2064 6173 6b2e 6172 7261 792e 726f  om dask.array.ro
-00012520: 7574 696e 6573 2069 6d70 6f72 7420 6368  utines import ch
-00012530: 6f6f 7365 0a0a 2020 2020 2020 2020 7265  oose..        re
-00012540: 7475 726e 2063 686f 6f73 6528 7365 6c66  turn choose(self
-00012550: 2c20 6368 6f69 6365 7329 0a0a 2020 2020  , choices)..    
-00012560: 6465 6620 7265 7368 6170 6528 7365 6c66  def reshape(self
-00012570: 2c20 2a73 6861 7065 2c20 6d65 7267 655f  , *shape, merge_
-00012580: 6368 756e 6b73 3d54 7275 652c 206c 696d  chunks=True, lim
-00012590: 6974 3d4e 6f6e 6529 3a0a 2020 2020 2020  it=None):.      
-000125a0: 2020 2222 2252 6573 6861 7065 2061 7272    """Reshape arr
-000125b0: 6179 2074 6f20 6e65 7720 7368 6170 650a  ay to new shape.
-000125c0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
-000125d0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
-000125e0: 7261 792e 7265 7368 6170 6560 2066 6f72  ray.reshape` for
-000125f0: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
-00012600: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
-00012610: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00012620: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00012630: 6461 736b 2e61 7272 6179 2e72 6573 6861  dask.array.resha
-00012640: 7065 203a 2065 7175 6976 616c 656e 7420  pe : equivalent 
-00012650: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-00012660: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00012670: 6d20 6461 736b 2e61 7272 6179 2e72 6573  m dask.array.res
-00012680: 6861 7065 2069 6d70 6f72 7420 7265 7368  hape import resh
-00012690: 6170 650a 0a20 2020 2020 2020 2069 6620  ape..        if 
-000126a0: 6c65 6e28 7368 6170 6529 203d 3d20 3120  len(shape) == 1 
-000126b0: 616e 6420 6e6f 7420 6973 696e 7374 616e  and not isinstan
-000126c0: 6365 2873 6861 7065 5b30 5d2c 204e 756d  ce(shape[0], Num
-000126d0: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
-000126e0: 2020 7368 6170 6520 3d20 7368 6170 655b    shape = shape[
-000126f0: 305d 0a20 2020 2020 2020 2072 6574 7572  0].        retur
-00012700: 6e20 7265 7368 6170 6528 7365 6c66 2c20  n reshape(self, 
-00012710: 7368 6170 652c 206d 6572 6765 5f63 6875  shape, merge_chu
-00012720: 6e6b 733d 6d65 7267 655f 6368 756e 6b73  nks=merge_chunks
-00012730: 2c20 6c69 6d69 743d 6c69 6d69 7429 0a0a  , limit=limit)..
-00012740: 2020 2020 6465 6620 746f 706b 2873 656c      def topk(sel
-00012750: 662c 206b 2c20 6178 6973 3d2d 312c 2073  f, k, axis=-1, s
-00012760: 706c 6974 5f65 7665 7279 3d4e 6f6e 6529  plit_every=None)
-00012770: 3a0a 2020 2020 2020 2020 2222 2254 6865  :.        """The
-00012780: 2074 6f70 206b 2065 6c65 6d65 6e74 7320   top k elements 
-00012790: 6f66 2061 6e20 6172 7261 792e 0a0a 2020  of an array...  
-000127a0: 2020 2020 2020 5265 6665 7220 746f 203a        Refer to :
-000127b0: 6675 6e63 3a60 6461 736b 2e61 7272 6179  func:`dask.array
-000127c0: 2e74 6f70 6b60 2066 6f72 2066 756c 6c20  .topk` for full 
-000127d0: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
-000127e0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-000127f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00012800: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
-00012810: 7272 6179 2e74 6f70 6b20 3a20 6571 7569  rray.topk : equi
-00012820: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
-00012830: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00012840: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
-00012850: 7261 792e 7265 6475 6374 696f 6e73 2069  ray.reductions i
-00012860: 6d70 6f72 7420 746f 706b 0a0a 2020 2020  mport topk..    
-00012870: 2020 2020 7265 7475 726e 2074 6f70 6b28      return topk(
-00012880: 7365 6c66 2c20 6b2c 2061 7869 733d 6178  self, k, axis=ax
-00012890: 6973 2c20 7370 6c69 745f 6576 6572 793d  is, split_every=
-000128a0: 7370 6c69 745f 6576 6572 7929 0a0a 2020  split_every)..  
-000128b0: 2020 6465 6620 6172 6774 6f70 6b28 7365    def argtopk(se
-000128c0: 6c66 2c20 6b2c 2061 7869 733d 2d31 2c20  lf, k, axis=-1, 
-000128d0: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
-000128e0: 293a 0a20 2020 2020 2020 2022 2222 5468  ):.        """Th
-000128f0: 6520 696e 6469 6365 7320 6f66 2074 6865  e indices of the
-00012900: 2074 6f70 206b 2065 6c65 6d65 6e74 7320   top k elements 
-00012910: 6f66 2061 6e20 6172 7261 792e 0a0a 2020  of an array...  
-00012920: 2020 2020 2020 5265 6665 7220 746f 203a        Refer to :
-00012930: 6675 6e63 3a60 6461 736b 2e61 7272 6179  func:`dask.array
-00012940: 2e61 7267 746f 706b 6020 666f 7220 6675  .argtopk` for fu
-00012950: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
-00012960: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-00012970: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00012980: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-00012990: 6b2e 6172 7261 792e 6172 6774 6f70 6b20  k.array.argtopk 
-000129a0: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
-000129b0: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
-000129c0: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
-000129d0: 6173 6b2e 6172 7261 792e 7265 6475 6374  ask.array.reduct
-000129e0: 696f 6e73 2069 6d70 6f72 7420 6172 6774  ions import argt
-000129f0: 6f70 6b0a 0a20 2020 2020 2020 2072 6574  opk..        ret
-00012a00: 7572 6e20 6172 6774 6f70 6b28 7365 6c66  urn argtopk(self
-00012a10: 2c20 6b2c 2061 7869 733d 6178 6973 2c20  , k, axis=axis, 
-00012a20: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00012a30: 745f 6576 6572 7929 0a0a 2020 2020 6465  t_every)..    de
-00012a40: 6620 6173 7479 7065 2873 656c 662c 2064  f astype(self, d
-00012a50: 7479 7065 2c20 2a2a 6b77 6172 6773 293a  type, **kwargs):
-00012a60: 0a20 2020 2020 2020 2022 2222 436f 7079  .        """Copy
-00012a70: 206f 6620 7468 6520 6172 7261 792c 2063   of the array, c
-00012a80: 6173 7420 746f 2061 2073 7065 6369 6669  ast to a specifi
-00012a90: 6564 2074 7970 652e 0a0a 2020 2020 2020  ed type...      
-00012aa0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00012ab0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00012ac0: 2020 2020 2020 2020 6474 7970 6520 3a20          dtype : 
-00012ad0: 7374 7220 6f72 2064 7479 7065 0a20 2020  str or dtype.   
-00012ae0: 2020 2020 2020 2020 2054 7970 6563 6f64           Typecod
-00012af0: 6520 6f72 2064 6174 612d 7479 7065 2074  e or data-type t
-00012b00: 6f20 7768 6963 6820 7468 6520 6172 7261  o which the arra
-00012b10: 7920 6973 2063 6173 742e 0a20 2020 2020  y is cast..     
-00012b20: 2020 2063 6173 7469 6e67 203a 207b 276e     casting : {'n
-00012b30: 6f27 2c20 2765 7175 6976 272c 2027 7361  o', 'equiv', 'sa
-00012b40: 6665 272c 2027 7361 6d65 5f6b 696e 6427  fe', 'same_kind'
-00012b50: 2c20 2775 6e73 6166 6527 7d2c 206f 7074  , 'unsafe'}, opt
-00012b60: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00012b70: 2020 436f 6e74 726f 6c73 2077 6861 7420    Controls what 
-00012b80: 6b69 6e64 206f 6620 6461 7461 2063 6173  kind of data cas
-00012b90: 7469 6e67 206d 6179 206f 6363 7572 2e20  ting may occur. 
-00012ba0: 4465 6661 756c 7473 2074 6f20 2775 6e73  Defaults to 'uns
-00012bb0: 6166 6527 0a20 2020 2020 2020 2020 2020  afe'.           
-00012bc0: 2066 6f72 2062 6163 6b77 6172 6473 2063   for backwards c
-00012bd0: 6f6d 7061 7469 6269 6c69 7479 2e0a 0a20  ompatibility... 
-00012be0: 2020 2020 2020 2020 2020 202a 2027 6e6f             * 'no
-00012bf0: 2720 6d65 616e 7320 7468 6520 6461 7461  ' means the data
-00012c00: 2074 7970 6573 2073 686f 756c 6420 6e6f   types should no
-00012c10: 7420 6265 2063 6173 7420 6174 2061 6c6c  t be cast at all
-00012c20: 2e0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-00012c30: 2765 7175 6976 2720 6d65 616e 7320 6f6e  'equiv' means on
-00012c40: 6c79 2062 7974 652d 6f72 6465 7220 6368  ly byte-order ch
-00012c50: 616e 6765 7320 6172 6520 616c 6c6f 7765  anges are allowe
-00012c60: 642e 0a20 2020 2020 2020 2020 2020 202a  d..            *
-00012c70: 2027 7361 6665 2720 6d65 616e 7320 6f6e   'safe' means on
-00012c80: 6c79 2063 6173 7473 2077 6869 6368 2063  ly casts which c
-00012c90: 616e 2070 7265 7365 7276 6520 7661 6c75  an preserve valu
-00012ca0: 6573 2061 7265 2061 6c6c 6f77 6564 2e0a  es are allowed..
-00012cb0: 2020 2020 2020 2020 2020 2020 2a20 2773              * 's
-00012cc0: 616d 655f 6b69 6e64 2720 6d65 616e 7320  ame_kind' means 
-00012cd0: 6f6e 6c79 2073 6166 6520 6361 7374 7320  only safe casts 
-00012ce0: 6f72 2063 6173 7473 2077 6974 6869 6e20  or casts within 
-00012cf0: 6120 6b69 6e64 2c0a 2020 2020 2020 2020  a kind,.        
-00012d00: 2020 2020 2020 2020 6c69 6b65 2066 6c6f          like flo
-00012d10: 6174 3634 2074 6f20 666c 6f61 7433 322c  at64 to float32,
-00012d20: 2061 7265 2061 6c6c 6f77 6564 2e0a 2020   are allowed..  
-00012d30: 2020 2020 2020 2020 2020 2a20 2775 6e73            * 'uns
-00012d40: 6166 6527 206d 6561 6e73 2061 6e79 2064  afe' means any d
-00012d50: 6174 6120 636f 6e76 6572 7369 6f6e 7320  ata conversions 
-00012d60: 6d61 7920 6265 2064 6f6e 652e 0a20 2020  may be done..   
-00012d70: 2020 2020 2063 6f70 7920 3a20 626f 6f6c       copy : bool
-00012d80: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00012d90: 2020 2020 2020 2042 7920 6465 6661 756c         By defaul
-00012da0: 742c 2061 7374 7970 6520 616c 7761 7973  t, astype always
-00012db0: 2072 6574 7572 6e73 2061 206e 6577 6c79   returns a newly
-00012dc0: 2061 6c6c 6f63 6174 6564 2061 7272 6179   allocated array
-00012dd0: 2e20 4966 2074 6869 730a 2020 2020 2020  . If this.      
-00012de0: 2020 2020 2020 6973 2073 6574 2074 6f20        is set to 
-00012df0: 4661 6c73 6520 616e 6420 7468 6520 6064  False and the `d
-00012e00: 7479 7065 6020 7265 7175 6972 656d 656e  type` requiremen
-00012e10: 7420 6973 2073 6174 6973 6669 6564 2c20  t is satisfied, 
-00012e20: 7468 6520 696e 7075 740a 2020 2020 2020  the input.      
-00012e30: 2020 2020 2020 6172 7261 7920 6973 2072        array is r
-00012e40: 6574 7572 6e65 6420 696e 7374 6561 6420  eturned instead 
-00012e50: 6f66 2061 2063 6f70 792e 0a0a 2020 2020  of a copy...    
-00012e60: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-00012e70: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00012e80: 2020 2044 6173 6b20 646f 6573 206e 6f74     Dask does not
-00012e90: 2072 6573 7065 6374 2074 6865 2063 6f6e   respect the con
-00012ea0: 7469 6775 6f75 7320 6d65 6d6f 7279 206c  tiguous memory l
-00012eb0: 6179 6f75 7420 6f66 2074 6865 2061 7272  ayout of the arr
-00012ec0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-00012ed0: 2020 2020 616e 6420 7769 6c6c 2069 676e      and will ign
-00012ee0: 6f72 6520 7468 6520 6060 6f72 6465 7260  ore the ``order`
-00012ef0: 6020 6b65 7977 6f72 6420 6172 6775 6d65  ` keyword argume
-00012f00: 6e74 2e0a 2020 2020 2020 2020 2020 2020  nt..            
-00012f10: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
-00012f20: 6f72 6465 7220 6973 2027 4327 2063 6f6e  order is 'C' con
-00012f30: 7469 6775 6f75 732e 0a20 2020 2020 2020  tiguous..       
-00012f40: 2022 2222 0a20 2020 2020 2020 206b 7761   """.        kwa
-00012f50: 7267 732e 706f 7028 226f 7264 6572 222c  rgs.pop("order",
-00012f60: 204e 6f6e 6529 2020 2320 606f 7264 6572   None)  # `order
-00012f70: 6020 6973 206e 6f74 2072 6573 7065 6374  ` is not respect
-00012f80: 6564 2c20 736f 2077 6520 7265 6d6f 7665  ed, so we remove
-00012f90: 2074 6869 7320 6b77 6172 670a 2020 2020   this kwarg.    
-00012fa0: 2020 2020 2320 5363 616c 6172 7320 646f      # Scalars do
-00012fb0: 6e27 7420 7461 6b65 2060 6361 7374 696e  n't take `castin
-00012fc0: 6760 206f 7220 6063 6f70 7960 206b 7761  g` or `copy` kwa
-00012fd0: 7267 7320 2d20 6173 2073 7563 6820 7765  rgs - as such we
-00012fe0: 206f 6e6c 7920 7061 7373 0a20 2020 2020   only pass.     
-00012ff0: 2020 2023 2074 6865 6d20 746f 2060 6d61     # them to `ma
-00013000: 705f 626c 6f63 6b73 6020 6966 2073 7065  p_blocks` if spe
-00013010: 6369 6669 6564 2062 7920 7573 6572 2028  cified by user (
-00013020: 6469 6666 6572 656e 7420 7468 616e 2064  different than d
-00013030: 6566 6175 6c74 7329 2e0a 2020 2020 2020  efaults)..      
-00013040: 2020 6578 7472 6120 3d20 7365 7428 6b77    extra = set(kw
-00013050: 6172 6773 2920 2d20 7b22 6361 7374 696e  args) - {"castin
-00013060: 6722 2c20 2263 6f70 7922 7d0a 2020 2020  g", "copy"}.    
-00013070: 2020 2020 6966 2065 7874 7261 3a0a 2020      if extra:.  
-00013080: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00013090: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-000130a0: 2020 2020 2020 2020 2020 2066 2261 7374             f"ast
-000130b0: 7970 6520 646f 6573 206e 6f74 2074 616b  ype does not tak
-000130c0: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
-000130d0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-000130e0: 733a 207b 6c69 7374 2865 7874 7261 297d  s: {list(extra)}
-000130f0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00013100: 2020 2020 2020 2020 6361 7374 696e 6720          casting 
-00013110: 3d20 6b77 6172 6773 2e67 6574 2822 6361  = kwargs.get("ca
-00013120: 7374 696e 6722 2c20 2275 6e73 6166 6522  sting", "unsafe"
-00013130: 290a 2020 2020 2020 2020 6474 7970 6520  ).        dtype 
-00013140: 3d20 6e70 2e64 7479 7065 2864 7479 7065  = np.dtype(dtype
-00013150: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-00013160: 662e 6474 7970 6520 3d3d 2064 7479 7065  f.dtype == dtype
-00013170: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00013180: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
-00013190: 2020 656c 6966 206e 6f74 206e 702e 6361    elif not np.ca
-000131a0: 6e5f 6361 7374 2873 656c 662e 6474 7970  n_cast(self.dtyp
-000131b0: 652c 2064 7479 7065 2c20 6361 7374 696e  e, dtype, castin
-000131c0: 673d 6361 7374 696e 6729 3a0a 2020 2020  g=casting):.    
-000131d0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-000131e0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-000131f0: 2020 2020 2020 2020 2066 2243 616e 6e6f           f"Canno
-00013200: 7420 6361 7374 2061 7272 6179 2066 726f  t cast array fro
-00013210: 6d20 7b73 656c 662e 6474 7970 6521 727d  m {self.dtype!r}
-00013220: 2074 6f20 7b64 7479 7065 2172 7d20 220a   to {dtype!r} ".
-00013230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013240: 6622 6163 636f 7264 696e 6720 746f 2074  f"according to t
-00013250: 6865 2072 756c 6520 7b63 6173 7469 6e67  he rule {casting
-00013260: 2172 7d22 0a20 2020 2020 2020 2020 2020  !r}".           
-00013270: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00013280: 6e20 7365 6c66 2e6d 6170 5f62 6c6f 636b  n self.map_block
-00013290: 7328 6368 756e 6b2e 6173 7479 7065 2c20  s(chunk.astype, 
-000132a0: 6474 7970 653d 6474 7970 652c 2061 7374  dtype=dtype, ast
-000132b0: 7970 655f 6474 7970 653d 6474 7970 652c  ype_dtype=dtype,
-000132c0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-000132d0: 6465 6620 5f5f 6162 735f 5f28 7365 6c66  def __abs__(self
-000132e0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000132f0: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
-00013300: 746f 722e 6162 732c 2073 656c 6629 0a0a  tor.abs, self)..
-00013310: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
-00013320: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
-00013330: 720a 2020 2020 6465 6620 5f5f 6164 645f  r.    def __add_
-00013340: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-00013350: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00013360: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
-00013370: 2e61 6464 2c20 7365 6c66 2c20 6f74 6865  .add, self, othe
-00013380: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
-00013390: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-000133a0: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-000133b0: 7261 6464 5f5f 2873 656c 662c 206f 7468  radd__(self, oth
-000133c0: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-000133d0: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
-000133e0: 7261 746f 722e 6164 642c 206f 7468 6572  rator.add, other
-000133f0: 2c20 7365 6c66 290a 0a20 2020 2040 6368  , self)..    @ch
-00013400: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
-00013410: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
-00013420: 6566 205f 5f61 6e64 5f5f 2873 656c 662c  ef __and__(self,
-00013430: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00013440: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-00013450: 286f 7065 7261 746f 722e 616e 645f 2c20  (operator.and_, 
-00013460: 7365 6c66 2c20 6f74 6865 7229 0a0a 2020  self, other)..  
-00013470: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
-00013480: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
-00013490: 2020 2020 6465 6620 5f5f 7261 6e64 5f5f      def __rand__
-000134a0: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-000134b0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-000134c0: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
-000134d0: 616e 645f 2c20 6f74 6865 722c 2073 656c  and_, other, sel
-000134e0: 6629 0a0a 2020 2020 4063 6865 636b 5f69  f)..    @check_i
-000134f0: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00013500: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00013510: 6469 765f 5f28 7365 6c66 2c20 6f74 6865  div__(self, othe
-00013520: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-00013530: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
-00013540: 6174 6f72 2e64 6976 2c20 7365 6c66 2c20  ator.div, self, 
-00013550: 6f74 6865 7229 0a0a 2020 2020 4063 6865  other)..    @che
-00013560: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
-00013570: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
-00013580: 6620 5f5f 7264 6976 5f5f 2873 656c 662c  f __rdiv__(self,
-00013590: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-000135a0: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-000135b0: 286f 7065 7261 746f 722e 6469 762c 206f  (operator.div, o
-000135c0: 7468 6572 2c20 7365 6c66 290a 0a20 2020  ther, self)..   
-000135d0: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
-000135e0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
-000135f0: 2020 2064 6566 205f 5f65 715f 5f28 7365     def __eq__(se
-00013600: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
-00013610: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
-00013620: 6973 6528 6f70 6572 6174 6f72 2e65 712c  ise(operator.eq,
-00013630: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
-00013640: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-00013650: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-00013660: 0a20 2020 2064 6566 205f 5f67 745f 5f28  .    def __gt__(
-00013670: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-00013680: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
-00013690: 6d77 6973 6528 6f70 6572 6174 6f72 2e67  mwise(operator.g
-000136a0: 742c 2073 656c 662c 206f 7468 6572 290a  t, self, other).
-000136b0: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
-000136c0: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
-000136d0: 6572 0a20 2020 2064 6566 205f 5f67 655f  er.    def __ge_
-000136e0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-000136f0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00013700: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
-00013710: 2e67 652c 2073 656c 662c 206f 7468 6572  .ge, self, other
-00013720: 290a 0a20 2020 2064 6566 205f 5f69 6e76  )..    def __inv
-00013730: 6572 745f 5f28 7365 6c66 293a 0a20 2020  ert__(self):.   
-00013740: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00013750: 7769 7365 286f 7065 7261 746f 722e 696e  wise(operator.in
-00013760: 7665 7274 2c20 7365 6c66 290a 0a20 2020  vert, self)..   
-00013770: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
-00013780: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
-00013790: 2020 2064 6566 205f 5f6c 7368 6966 745f     def __lshift_
-000137a0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-000137b0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-000137c0: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
-000137d0: 2e6c 7368 6966 742c 2073 656c 662c 206f  .lshift, self, o
-000137e0: 7468 6572 290a 0a20 2020 2040 6368 6563  ther)..    @chec
-000137f0: 6b5f 6966 5f68 616e 646c 6564 5f67 6976  k_if_handled_giv
-00013800: 656e 5f6f 7468 6572 0a20 2020 2064 6566  en_other.    def
-00013810: 205f 5f72 6c73 6869 6674 5f5f 2873 656c   __rlshift__(sel
-00013820: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00013830: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
-00013840: 7365 286f 7065 7261 746f 722e 6c73 6869  se(operator.lshi
-00013850: 6674 2c20 6f74 6865 722c 2073 656c 6629  ft, other, self)
-00013860: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
-00013870: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
-00013880: 6865 720a 2020 2020 6465 6620 5f5f 6c74  her.    def __lt
-00013890: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-000138a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000138b0: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
-000138c0: 722e 6c74 2c20 7365 6c66 2c20 6f74 6865  r.lt, self, othe
-000138d0: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
-000138e0: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-000138f0: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00013900: 6c65 5f5f 2873 656c 662c 206f 7468 6572  le__(self, other
-00013910: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00013920: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
-00013930: 746f 722e 6c65 2c20 7365 6c66 2c20 6f74  tor.le, self, ot
-00013940: 6865 7229 0a0a 2020 2020 4063 6865 636b  her)..    @check
-00013950: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
-00013960: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
-00013970: 5f5f 6d6f 645f 5f28 7365 6c66 2c20 6f74  __mod__(self, ot
-00013980: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
-00013990: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-000139a0: 6572 6174 6f72 2e6d 6f64 2c20 7365 6c66  erator.mod, self
-000139b0: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
-000139c0: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
-000139d0: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
-000139e0: 6465 6620 5f5f 726d 6f64 5f5f 2873 656c  def __rmod__(sel
-000139f0: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00013a00: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
-00013a10: 7365 286f 7065 7261 746f 722e 6d6f 642c  se(operator.mod,
-00013a20: 206f 7468 6572 2c20 7365 6c66 290a 0a20   other, self).. 
-00013a30: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-00013a40: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-00013a50: 0a20 2020 2064 6566 205f 5f6d 756c 5f5f  .    def __mul__
-00013a60: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-00013a70: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-00013a80: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
-00013a90: 6d75 6c2c 2073 656c 662c 206f 7468 6572  mul, self, other
-00013aa0: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
-00013ab0: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
-00013ac0: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
-00013ad0: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
-00013ae0: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-00013af0: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
-00013b00: 6174 6f72 2e6d 756c 2c20 6f74 6865 722c  ator.mul, other,
-00013b10: 2073 656c 6629 0a0a 2020 2020 4063 6865   self)..    @che
-00013b20: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
-00013b30: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
-00013b40: 6620 5f5f 6e65 5f5f 2873 656c 662c 206f  f __ne__(self, o
-00013b50: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
-00013b60: 6574 7572 6e20 656c 656d 7769 7365 286f  eturn elemwise(o
-00013b70: 7065 7261 746f 722e 6e65 2c20 7365 6c66  perator.ne, self
-00013b80: 2c20 6f74 6865 7229 0a0a 2020 2020 6465  , other)..    de
-00013b90: 6620 5f5f 6e65 675f 5f28 7365 6c66 293a  f __neg__(self):
-00013ba0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013bb0: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
-00013bc0: 722e 6e65 672c 2073 656c 6629 0a0a 2020  r.neg, self)..  
-00013bd0: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
-00013be0: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
-00013bf0: 2020 2020 6465 6620 5f5f 6f72 5f5f 2873      def __or__(s
-00013c00: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
-00013c10: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00013c20: 7769 7365 286f 7065 7261 746f 722e 6f72  wise(operator.or
-00013c30: 5f2c 2073 656c 662c 206f 7468 6572 290a  _, self, other).
-00013c40: 0a20 2020 2064 6566 205f 5f70 6f73 5f5f  .    def __pos__
-00013c50: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00013c60: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00013c70: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
-00013c80: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
-00013c90: 2020 2064 6566 205f 5f72 6f72 5f5f 2873     def __ror__(s
-00013ca0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
-00013cb0: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00013cc0: 7769 7365 286f 7065 7261 746f 722e 6f72  wise(operator.or
-00013cd0: 5f2c 206f 7468 6572 2c20 7365 6c66 290a  _, other, self).
-00013ce0: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
-00013cf0: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
-00013d00: 6572 0a20 2020 2064 6566 205f 5f70 6f77  er.    def __pow
-00013d10: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-00013d20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013d30: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
-00013d40: 722e 706f 772c 2073 656c 662c 206f 7468  r.pow, self, oth
-00013d50: 6572 290a 0a20 2020 2040 6368 6563 6b5f  er)..    @check_
-00013d60: 6966 5f68 616e 646c 6564 5f67 6976 656e  if_handled_given
-00013d70: 5f6f 7468 6572 0a20 2020 2064 6566 205f  _other.    def _
-00013d80: 5f72 706f 775f 5f28 7365 6c66 2c20 6f74  _rpow__(self, ot
-00013d90: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
-00013da0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-00013db0: 6572 6174 6f72 2e70 6f77 2c20 6f74 6865  erator.pow, othe
-00013dc0: 722c 2073 656c 6629 0a0a 2020 2020 4063  r, self)..    @c
-00013dd0: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
-00013de0: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
-00013df0: 6465 6620 5f5f 7273 6869 6674 5f5f 2873  def __rshift__(s
-00013e00: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
-00013e10: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00013e20: 7769 7365 286f 7065 7261 746f 722e 7273  wise(operator.rs
-00013e30: 6869 6674 2c20 7365 6c66 2c20 6f74 6865  hift, self, othe
-00013e40: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
-00013e50: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00013e60: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00013e70: 7272 7368 6966 745f 5f28 7365 6c66 2c20  rrshift__(self, 
-00013e80: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00013e90: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-00013ea0: 6f70 6572 6174 6f72 2e72 7368 6966 742c  operator.rshift,
-00013eb0: 206f 7468 6572 2c20 7365 6c66 290a 0a20   other, self).. 
-00013ec0: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-00013ed0: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-00013ee0: 0a20 2020 2064 6566 205f 5f73 7562 5f5f  .    def __sub__
-00013ef0: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-00013f00: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-00013f10: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
-00013f20: 7375 622c 2073 656c 662c 206f 7468 6572  sub, self, other
-00013f30: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
-00013f40: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
-00013f50: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
-00013f60: 7375 625f 5f28 7365 6c66 2c20 6f74 6865  sub__(self, othe
-00013f70: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-00013f80: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
-00013f90: 6174 6f72 2e73 7562 2c20 6f74 6865 722c  ator.sub, other,
-00013fa0: 2073 656c 6629 0a0a 2020 2020 4063 6865   self)..    @che
-00013fb0: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
-00013fc0: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
-00013fd0: 6620 5f5f 7472 7565 6469 765f 5f28 7365  f __truediv__(se
-00013fe0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
-00013ff0: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
-00014000: 6973 6528 6f70 6572 6174 6f72 2e74 7275  ise(operator.tru
-00014010: 6564 6976 2c20 7365 6c66 2c20 6f74 6865  ediv, self, othe
-00014020: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
-00014030: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00014040: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00014050: 7274 7275 6564 6976 5f5f 2873 656c 662c  rtruediv__(self,
-00014060: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00014070: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-00014080: 286f 7065 7261 746f 722e 7472 7565 6469  (operator.truedi
-00014090: 762c 206f 7468 6572 2c20 7365 6c66 290a  v, other, self).
-000140a0: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
-000140b0: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
-000140c0: 6572 0a20 2020 2064 6566 205f 5f66 6c6f  er.    def __flo
-000140d0: 6f72 6469 765f 5f28 7365 6c66 2c20 6f74  ordiv__(self, ot
-000140e0: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
-000140f0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-00014100: 6572 6174 6f72 2e66 6c6f 6f72 6469 762c  erator.floordiv,
-00014110: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
-00014120: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-00014130: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-00014140: 0a20 2020 2064 6566 205f 5f72 666c 6f6f  .    def __rfloo
-00014150: 7264 6976 5f5f 2873 656c 662c 206f 7468  rdiv__(self, oth
-00014160: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-00014170: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
-00014180: 7261 746f 722e 666c 6f6f 7264 6976 2c20  rator.floordiv, 
-00014190: 6f74 6865 722c 2073 656c 6629 0a0a 2020  other, self)..  
-000141a0: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
-000141b0: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
-000141c0: 2020 2020 6465 6620 5f5f 786f 725f 5f28      def __xor__(
-000141d0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-000141e0: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
-000141f0: 6d77 6973 6528 6f70 6572 6174 6f72 2e78  mwise(operator.x
-00014200: 6f72 2c20 7365 6c66 2c20 6f74 6865 7229  or, self, other)
-00014210: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
-00014220: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
-00014230: 6865 720a 2020 2020 6465 6620 5f5f 7278  her.    def __rx
-00014240: 6f72 5f5f 2873 656c 662c 206f 7468 6572  or__(self, other
-00014250: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00014260: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
-00014270: 746f 722e 786f 722c 206f 7468 6572 2c20  tor.xor, other, 
-00014280: 7365 6c66 290a 0a20 2020 2040 6368 6563  self)..    @chec
-00014290: 6b5f 6966 5f68 616e 646c 6564 5f67 6976  k_if_handled_giv
-000142a0: 656e 5f6f 7468 6572 0a20 2020 2064 6566  en_other.    def
-000142b0: 205f 5f6d 6174 6d75 6c5f 5f28 7365 6c66   __matmul__(self
-000142c0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-000142d0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-000142e0: 792e 726f 7574 696e 6573 2069 6d70 6f72  y.routines impor
-000142f0: 7420 6d61 746d 756c 0a0a 2020 2020 2020  t matmul..      
-00014300: 2020 7265 7475 726e 206d 6174 6d75 6c28    return matmul(
-00014310: 7365 6c66 2c20 6f74 6865 7229 0a0a 2020  self, other)..  
-00014320: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
-00014330: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
-00014340: 2020 2020 6465 6620 5f5f 726d 6174 6d75      def __rmatmu
-00014350: 6c5f 5f28 7365 6c66 2c20 6f74 6865 7229  l__(self, other)
-00014360: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
-00014370: 6173 6b2e 6172 7261 792e 726f 7574 696e  ask.array.routin
-00014380: 6573 2069 6d70 6f72 7420 6d61 746d 756c  es import matmul
-00014390: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000143a0: 206d 6174 6d75 6c28 6f74 6865 722c 2073   matmul(other, s
-000143b0: 656c 6629 0a0a 2020 2020 4063 6865 636b  elf)..    @check
-000143c0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
-000143d0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
-000143e0: 5f5f 6469 766d 6f64 5f5f 2873 656c 662c  __divmod__(self,
-000143f0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00014400: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00014410: 2e75 6675 6e63 2069 6d70 6f72 7420 6469  .ufunc import di
-00014420: 766d 6f64 0a0a 2020 2020 2020 2020 7265  vmod..        re
-00014430: 7475 726e 2064 6976 6d6f 6428 7365 6c66  turn divmod(self
-00014440: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
-00014450: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
-00014460: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
-00014470: 6465 6620 5f5f 7264 6976 6d6f 645f 5f28  def __rdivmod__(
-00014480: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-00014490: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-000144a0: 6172 7261 792e 7566 756e 6320 696d 706f  array.ufunc impo
-000144b0: 7274 2064 6976 6d6f 640a 0a20 2020 2020  rt divmod..     
-000144c0: 2020 2072 6574 7572 6e20 6469 766d 6f64     return divmod
-000144d0: 286f 7468 6572 2c20 7365 6c66 290a 0a20  (other, self).. 
-000144e0: 2020 2064 6566 2061 6e79 2873 656c 662c     def any(self,
-000144f0: 2061 7869 733d 4e6f 6e65 2c20 6b65 6570   axis=None, keep
-00014500: 6469 6d73 3d46 616c 7365 2c20 7370 6c69  dims=False, spli
-00014510: 745f 6576 6572 793d 4e6f 6e65 2c20 6f75  t_every=None, ou
-00014520: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00014530: 2022 2222 5265 7475 726e 7320 5472 7565   """Returns True
-00014540: 2069 6620 616e 7920 6f66 2074 6865 2065   if any of the e
-00014550: 6c65 6d65 6e74 7320 6576 616c 7561 7465  lements evaluate
-00014560: 2074 6f20 5472 7565 2e0a 0a20 2020 2020   to True...     
-00014570: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
-00014580: 633a 6064 6173 6b2e 6172 7261 792e 616e  c:`dask.array.an
-00014590: 7960 2066 6f72 2066 756c 6c20 646f 6375  y` for full docu
-000145a0: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
-000145b0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-000145c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-000145d0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-000145e0: 2e61 6e79 203a 2065 7175 6976 616c 656e  .any : equivalen
-000145f0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
-00014600: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00014610: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
-00014620: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
-00014630: 2061 6e79 0a0a 2020 2020 2020 2020 7265   any..        re
-00014640: 7475 726e 2061 6e79 2873 656c 662c 2061  turn any(self, a
-00014650: 7869 733d 6178 6973 2c20 6b65 6570 6469  xis=axis, keepdi
-00014660: 6d73 3d6b 6565 7064 696d 732c 2073 706c  ms=keepdims, spl
-00014670: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00014680: 7665 7279 2c20 6f75 743d 6f75 7429 0a0a  very, out=out)..
-00014690: 2020 2020 6465 6620 616c 6c28 7365 6c66      def all(self
-000146a0: 2c20 6178 6973 3d4e 6f6e 652c 206b 6565  , axis=None, kee
-000146b0: 7064 696d 733d 4661 6c73 652c 2073 706c  pdims=False, spl
-000146c0: 6974 5f65 7665 7279 3d4e 6f6e 652c 206f  it_every=None, o
-000146d0: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
-000146e0: 2020 2222 2252 6574 7572 6e73 2054 7275    """Returns Tru
-000146f0: 6520 6966 2061 6c6c 2065 6c65 6d65 6e74  e if all element
-00014700: 7320 6576 616c 7561 7465 2074 6f20 5472  s evaluate to Tr
-00014710: 7565 2e0a 0a20 2020 2020 2020 2052 6566  ue...        Ref
-00014720: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-00014730: 6b2e 6172 7261 792e 616c 6c60 2066 6f72  k.array.all` for
-00014740: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
-00014750: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
-00014760: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00014770: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00014780: 6461 736b 2e61 7272 6179 2e61 6c6c 203a  dask.array.all :
-00014790: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
-000147a0: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
-000147b0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-000147c0: 736b 2e61 7272 6179 2e72 6564 7563 7469  sk.array.reducti
-000147d0: 6f6e 7320 696d 706f 7274 2061 6c6c 0a0a  ons import all..
-000147e0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-000147f0: 6c6c 2873 656c 662c 2061 7869 733d 6178  ll(self, axis=ax
-00014800: 6973 2c20 6b65 6570 6469 6d73 3d6b 6565  is, keepdims=kee
-00014810: 7064 696d 732c 2073 706c 6974 5f65 7665  pdims, split_eve
-00014820: 7279 3d73 706c 6974 5f65 7665 7279 2c20  ry=split_every, 
-00014830: 6f75 743d 6f75 7429 0a0a 2020 2020 6465  out=out)..    de
-00014840: 6620 6d69 6e28 7365 6c66 2c20 6178 6973  f min(self, axis
-00014850: 3d4e 6f6e 652c 206b 6565 7064 696d 733d  =None, keepdims=
-00014860: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
-00014870: 7279 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  ry=None, out=Non
-00014880: 6529 3a0a 2020 2020 2020 2020 2222 2252  e):.        """R
-00014890: 6574 7572 6e20 7468 6520 6d69 6e69 6d75  eturn the minimu
-000148a0: 6d20 616c 6f6e 6720 6120 6769 7665 6e20  m along a given 
-000148b0: 6178 6973 2e0a 0a20 2020 2020 2020 2052  axis...        R
-000148c0: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
-000148d0: 6173 6b2e 6172 7261 792e 6d69 6e60 2066  ask.array.min` f
-000148e0: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
-000148f0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00014900: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00014910: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00014920: 2020 6461 736b 2e61 7272 6179 2e6d 696e    dask.array.min
-00014930: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
-00014940: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
-00014950: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00014960: 6461 736b 2e61 7272 6179 2e72 6564 7563  dask.array.reduc
-00014970: 7469 6f6e 7320 696d 706f 7274 206d 696e  tions import min
-00014980: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00014990: 206d 696e 2873 656c 662c 2061 7869 733d   min(self, axis=
-000149a0: 6178 6973 2c20 6b65 6570 6469 6d73 3d6b  axis, keepdims=k
-000149b0: 6565 7064 696d 732c 2073 706c 6974 5f65  eepdims, split_e
-000149c0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-000149d0: 2c20 6f75 743d 6f75 7429 0a0a 2020 2020  , out=out)..    
-000149e0: 6465 6620 6d61 7828 7365 6c66 2c20 6178  def max(self, ax
-000149f0: 6973 3d4e 6f6e 652c 206b 6565 7064 696d  is=None, keepdim
-00014a00: 733d 4661 6c73 652c 2073 706c 6974 5f65  s=False, split_e
-00014a10: 7665 7279 3d4e 6f6e 652c 206f 7574 3d4e  very=None, out=N
-00014a20: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-00014a30: 2252 6574 7572 6e20 7468 6520 6d61 7869  "Return the maxi
-00014a40: 6d75 6d20 616c 6f6e 6720 6120 6769 7665  mum along a give
-00014a50: 6e20 6178 6973 2e0a 0a20 2020 2020 2020  n axis...       
-00014a60: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
-00014a70: 6064 6173 6b2e 6172 7261 792e 6d61 7860  `dask.array.max`
-00014a80: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
-00014a90: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
-00014aa0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00014ab0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00014ac0: 2020 2020 6461 736b 2e61 7272 6179 2e6d      dask.array.m
-00014ad0: 6178 203a 2065 7175 6976 616c 656e 7420  ax : equivalent 
-00014ae0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-00014af0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00014b00: 6d20 6461 736b 2e61 7272 6179 2e72 6564  m dask.array.red
-00014b10: 7563 7469 6f6e 7320 696d 706f 7274 206d  uctions import m
-00014b20: 6178 0a0a 2020 2020 2020 2020 7265 7475  ax..        retu
-00014b30: 726e 206d 6178 2873 656c 662c 2061 7869  rn max(self, axi
-00014b40: 733d 6178 6973 2c20 6b65 6570 6469 6d73  s=axis, keepdims
-00014b50: 3d6b 6565 7064 696d 732c 2073 706c 6974  =keepdims, split
-00014b60: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00014b70: 7279 2c20 6f75 743d 6f75 7429 0a0a 2020  ry, out=out)..  
-00014b80: 2020 6465 6620 6172 676d 696e 2873 656c    def argmin(sel
-00014b90: 662c 2061 7869 733d 4e6f 6e65 2c20 2a2c  f, axis=None, *,
-00014ba0: 206b 6565 7064 696d 733d 4661 6c73 652c   keepdims=False,
-00014bb0: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
-00014bc0: 652c 206f 7574 3d4e 6f6e 6529 3a0a 2020  e, out=None):.  
-00014bd0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00014be0: 696e 6469 6365 7320 6f66 2074 6865 206d  indices of the m
-00014bf0: 696e 696d 756d 2076 616c 7565 7320 616c  inimum values al
-00014c00: 6f6e 6720 7468 6520 6769 7665 6e20 6178  ong the given ax
-00014c10: 6973 2e0a 0a20 2020 2020 2020 2052 6566  is...        Ref
-00014c20: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-00014c30: 6b2e 6172 7261 792e 6172 676d 696e 6020  k.array.argmin` 
-00014c40: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
-00014c50: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00014c60: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00014c70: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00014c80: 2020 2064 6173 6b2e 6172 7261 792e 6172     dask.array.ar
-00014c90: 676d 696e 203a 2065 7175 6976 616c 656e  gmin : equivalen
-00014ca0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
-00014cb0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00014cc0: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
-00014cd0: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
-00014ce0: 2061 7267 6d69 6e0a 0a20 2020 2020 2020   argmin..       
-00014cf0: 2072 6574 7572 6e20 6172 676d 696e 280a   return argmin(.
-00014d00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00014d10: 2c20 6178 6973 3d61 7869 732c 206b 6565  , axis=axis, kee
-00014d20: 7064 696d 733d 6b65 6570 6469 6d73 2c20  pdims=keepdims, 
-00014d30: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00014d40: 745f 6576 6572 792c 206f 7574 3d6f 7574  t_every, out=out
-00014d50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00014d60: 6465 6620 6172 676d 6178 2873 656c 662c  def argmax(self,
-00014d70: 2061 7869 733d 4e6f 6e65 2c20 2a2c 206b   axis=None, *, k
-00014d80: 6565 7064 696d 733d 4661 6c73 652c 2073  eepdims=False, s
-00014d90: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
-00014da0: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
-00014db0: 2020 2020 2222 2252 6574 7572 6e20 696e      """Return in
-00014dc0: 6469 6365 7320 6f66 2074 6865 206d 6178  dices of the max
-00014dd0: 696d 756d 2076 616c 7565 7320 616c 6f6e  imum values alon
-00014de0: 6720 7468 6520 6769 7665 6e20 6178 6973  g the given axis
-00014df0: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
-00014e00: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
-00014e10: 6172 7261 792e 6172 676d 6178 6020 666f  array.argmax` fo
-00014e20: 7220 6675 6c6c 2064 6f63 756d 656e 7461  r full documenta
-00014e30: 7469 6f6e 2e0a 0a20 2020 2020 2020 2053  tion...        S
-00014e40: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00014e50: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00014e60: 2064 6173 6b2e 6172 7261 792e 6172 676d   dask.array.argm
-00014e70: 6178 203a 2065 7175 6976 616c 656e 7420  ax : equivalent 
-00014e80: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-00014e90: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00014ea0: 6d20 6461 736b 2e61 7272 6179 2e72 6564  m dask.array.red
-00014eb0: 7563 7469 6f6e 7320 696d 706f 7274 2061  uctions import a
-00014ec0: 7267 6d61 780a 0a20 2020 2020 2020 2072  rgmax..        r
-00014ed0: 6574 7572 6e20 6172 676d 6178 280a 2020  eturn argmax(.  
-00014ee0: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
-00014ef0: 6178 6973 3d61 7869 732c 206b 6565 7064  axis=axis, keepd
-00014f00: 696d 733d 6b65 6570 6469 6d73 2c20 7370  ims=keepdims, sp
-00014f10: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00014f20: 6576 6572 792c 206f 7574 3d6f 7574 0a20  every, out=out. 
-00014f30: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00014f40: 6620 7375 6d28 7365 6c66 2c20 6178 6973  f sum(self, axis
-00014f50: 3d4e 6f6e 652c 2064 7479 7065 3d4e 6f6e  =None, dtype=Non
-00014f60: 652c 206b 6565 7064 696d 733d 4661 6c73  e, keepdims=Fals
-00014f70: 652c 2073 706c 6974 5f65 7665 7279 3d4e  e, split_every=N
-00014f80: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
-00014f90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00014fa0: 2020 2020 5265 7475 726e 2074 6865 2073      Return the s
-00014fb0: 756d 206f 6620 7468 6520 6172 7261 7920  um of the array 
-00014fc0: 656c 656d 656e 7473 206f 7665 7220 7468  elements over th
-00014fd0: 6520 6769 7665 6e20 6178 6973 2e0a 0a20  e given axis... 
-00014fe0: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-00014ff0: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
-00015000: 792e 7375 6d60 2066 6f72 2066 756c 6c20  y.sum` for full 
-00015010: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
-00015020: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00015030: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00015040: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
-00015050: 7272 6179 2e73 756d 203a 2065 7175 6976  rray.sum : equiv
-00015060: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
-00015070: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015080: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00015090: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
-000150a0: 706f 7274 2073 756d 0a0a 2020 2020 2020  port sum..      
-000150b0: 2020 7265 7475 726e 2073 756d 280a 2020    return sum(.  
-000150c0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-000150d0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-000150e0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-000150f0: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
-00015100: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
-00015110: 6469 6d73 3d6b 6565 7064 696d 732c 0a20  dims=keepdims,. 
-00015120: 2020 2020 2020 2020 2020 2073 706c 6974             split
-00015130: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00015140: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-00015150: 6f75 743d 6f75 742c 0a20 2020 2020 2020  out=out,.       
-00015160: 2029 0a0a 2020 2020 6465 6620 7472 6163   )..    def trac
-00015170: 6528 7365 6c66 2c20 6f66 6673 6574 3d30  e(self, offset=0
-00015180: 2c20 6178 6973 313d 302c 2061 7869 7332  , axis1=0, axis2
-00015190: 3d31 2c20 6474 7970 653d 4e6f 6e65 293a  =1, dtype=None):
-000151a0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-000151b0: 726e 2074 6865 2073 756d 2061 6c6f 6e67  rn the sum along
-000151c0: 2064 6961 676f 6e61 6c73 206f 6620 7468   diagonals of th
-000151d0: 6520 6172 7261 792e 0a0a 2020 2020 2020  e array...      
-000151e0: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-000151f0: 3a60 6461 736b 2e61 7272 6179 2e74 7261  :`dask.array.tra
-00015200: 6365 6020 666f 7220 6675 6c6c 2064 6f63  ce` for full doc
-00015210: 756d 656e 7461 7469 6f6e 2e0a 0a20 2020  umentation...   
-00015220: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00015230: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00015240: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
-00015250: 792e 7472 6163 6520 3a20 6571 7569 7661  y.trace : equiva
-00015260: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
-00015270: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00015280: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00015290: 792e 7265 6475 6374 696f 6e73 2069 6d70  y.reductions imp
-000152a0: 6f72 7420 7472 6163 650a 0a20 2020 2020  ort trace..     
-000152b0: 2020 2072 6574 7572 6e20 7472 6163 6528     return trace(
-000152c0: 7365 6c66 2c20 6f66 6673 6574 3d6f 6666  self, offset=off
-000152d0: 7365 742c 2061 7869 7331 3d61 7869 7331  set, axis1=axis1
-000152e0: 2c20 6178 6973 323d 6178 6973 322c 2064  , axis2=axis2, d
-000152f0: 7479 7065 3d64 7479 7065 290a 0a20 2020  type=dtype)..   
-00015300: 2064 6566 2070 726f 6428 7365 6c66 2c20   def prod(self, 
-00015310: 6178 6973 3d4e 6f6e 652c 2064 7479 7065  axis=None, dtype
-00015320: 3d4e 6f6e 652c 206b 6565 7064 696d 733d  =None, keepdims=
-00015330: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
-00015340: 7279 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  ry=None, out=Non
-00015350: 6529 3a0a 2020 2020 2020 2020 2222 2252  e):.        """R
-00015360: 6574 7572 6e20 7468 6520 7072 6f64 7563  eturn the produc
-00015370: 7420 6f66 2074 6865 2061 7272 6179 2065  t of the array e
-00015380: 6c65 6d65 6e74 7320 6f76 6572 2074 6865  lements over the
-00015390: 2067 6976 656e 2061 7869 730a 0a20 2020   given axis..   
-000153a0: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
-000153b0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
-000153c0: 7072 6f64 6020 666f 7220 6675 6c6c 2064  prod` for full d
-000153d0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
-000153e0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-000153f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00015400: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
-00015410: 7261 792e 7072 6f64 203a 2065 7175 6976  ray.prod : equiv
-00015420: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
-00015430: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015440: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00015450: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
-00015460: 706f 7274 2070 726f 640a 0a20 2020 2020  port prod..     
-00015470: 2020 2072 6574 7572 6e20 7072 6f64 280a     return prod(.
-00015480: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015490: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
-000154a0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-000154b0: 2020 2020 2064 7479 7065 3d64 7479 7065       dtype=dtype
-000154c0: 2c0a 2020 2020 2020 2020 2020 2020 6b65  ,.            ke
-000154d0: 6570 6469 6d73 3d6b 6565 7064 696d 732c  epdims=keepdims,
-000154e0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-000154f0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00015500: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-00015510: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
-00015520: 2020 2029 0a0a 2020 2020 6465 6620 6d65     )..    def me
-00015530: 616e 2873 656c 662c 2061 7869 733d 4e6f  an(self, axis=No
-00015540: 6e65 2c20 6474 7970 653d 4e6f 6e65 2c20  ne, dtype=None, 
-00015550: 6b65 6570 6469 6d73 3d46 616c 7365 2c20  keepdims=False, 
-00015560: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
-00015570: 2c20 6f75 743d 4e6f 6e65 293a 0a20 2020  , out=None):.   
-00015580: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
-00015590: 7468 6520 6176 6572 6167 6520 6f66 2074  the average of t
-000155a0: 6865 2061 7272 6179 2065 6c65 6d65 6e74  he array element
-000155b0: 7320 616c 6f6e 6720 6769 7665 6e20 6178  s along given ax
-000155c0: 6973 2e0a 0a20 2020 2020 2020 2052 6566  is...        Ref
-000155d0: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-000155e0: 6b2e 6172 7261 792e 6d65 616e 6020 666f  k.array.mean` fo
-000155f0: 7220 6675 6c6c 2064 6f63 756d 656e 7461  r full documenta
-00015600: 7469 6f6e 2e0a 0a20 2020 2020 2020 2053  tion...        S
-00015610: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00015620: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00015630: 2064 6173 6b2e 6172 7261 792e 6d65 616e   dask.array.mean
-00015640: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
-00015650: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
-00015660: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00015670: 6461 736b 2e61 7272 6179 2e72 6564 7563  dask.array.reduc
-00015680: 7469 6f6e 7320 696d 706f 7274 206d 6561  tions import mea
-00015690: 6e0a 0a20 2020 2020 2020 2072 6574 7572  n..        retur
-000156a0: 6e20 6d65 616e 280a 2020 2020 2020 2020  n mean(.        
-000156b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000156c0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-000156d0: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
-000156e0: 7065 3d64 7479 7065 2c0a 2020 2020 2020  pe=dtype,.      
-000156f0: 2020 2020 2020 6b65 6570 6469 6d73 3d6b        keepdims=k
-00015700: 6565 7064 696d 732c 0a20 2020 2020 2020  eepdims,.       
-00015710: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00015720: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-00015730: 2020 2020 2020 2020 2020 6f75 743d 6f75            out=ou
-00015740: 742c 0a20 2020 2020 2020 2029 0a0a 2020  t,.        )..  
-00015750: 2020 6465 6620 7374 6428 0a20 2020 2020    def std(.     
-00015760: 2020 2073 656c 662c 2061 7869 733d 4e6f     self, axis=No
-00015770: 6e65 2c20 6474 7970 653d 4e6f 6e65 2c20  ne, dtype=None, 
-00015780: 6b65 6570 6469 6d73 3d46 616c 7365 2c20  keepdims=False, 
-00015790: 6464 6f66 3d30 2c20 7370 6c69 745f 6576  ddof=0, split_ev
-000157a0: 6572 793d 4e6f 6e65 2c20 6f75 743d 4e6f  ery=None, out=No
-000157b0: 6e65 0a20 2020 2029 3a0a 2020 2020 2020  ne.    ):.      
-000157c0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-000157d0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-000157e0: 696f 6e20 6f66 2074 6865 2061 7272 6179  ion of the array
-000157f0: 2065 6c65 6d65 6e74 7320 616c 6f6e 6720   elements along 
-00015800: 6769 7665 6e20 6178 6973 2e0a 0a20 2020  given axis...   
-00015810: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
-00015820: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
-00015830: 7374 6460 2066 6f72 2066 756c 6c20 646f  std` for full do
-00015840: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
-00015850: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00015860: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00015870: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
-00015880: 6179 2e73 7464 203a 2065 7175 6976 616c  ay.std : equival
-00015890: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
-000158a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000158b0: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-000158c0: 2e72 6564 7563 7469 6f6e 7320 696d 706f  .reductions impo
-000158d0: 7274 2073 7464 0a0a 2020 2020 2020 2020  rt std..        
-000158e0: 7265 7475 726e 2073 7464 280a 2020 2020  return std(.    
-000158f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00015900: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
-00015910: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
-00015920: 2064 7479 7065 3d64 7479 7065 2c0a 2020   dtype=dtype,.  
-00015930: 2020 2020 2020 2020 2020 6b65 6570 6469            keepdi
-00015940: 6d73 3d6b 6565 7064 696d 732c 0a20 2020  ms=keepdims,.   
-00015950: 2020 2020 2020 2020 2064 646f 663d 6464           ddof=dd
-00015960: 6f66 2c0a 2020 2020 2020 2020 2020 2020  of,.            
-00015970: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00015980: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-00015990: 2020 2020 206f 7574 3d6f 7574 2c0a 2020       out=out,.  
-000159a0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000159b0: 2076 6172 280a 2020 2020 2020 2020 7365   var(.        se
-000159c0: 6c66 2c20 6178 6973 3d4e 6f6e 652c 2064  lf, axis=None, d
-000159d0: 7479 7065 3d4e 6f6e 652c 206b 6565 7064  type=None, keepd
-000159e0: 696d 733d 4661 6c73 652c 2064 646f 663d  ims=False, ddof=
-000159f0: 302c 2073 706c 6974 5f65 7665 7279 3d4e  0, split_every=N
-00015a00: 6f6e 652c 206f 7574 3d4e 6f6e 650a 2020  one, out=None.  
-00015a10: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00015a20: 5265 7475 726e 7320 7468 6520 7661 7269  Returns the vari
-00015a30: 616e 6365 206f 6620 7468 6520 6172 7261  ance of the arra
-00015a40: 7920 656c 656d 656e 7473 2c20 616c 6f6e  y elements, alon
-00015a50: 6720 6769 7665 6e20 6178 6973 2e0a 0a20  g given axis... 
-00015a60: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-00015a70: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
-00015a80: 792e 7661 7260 2066 6f72 2066 756c 6c20  y.var` for full 
-00015a90: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
-00015aa0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00015ab0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00015ac0: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
-00015ad0: 7272 6179 2e76 6172 203a 2065 7175 6976  rray.var : equiv
-00015ae0: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
-00015af0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015b00: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00015b10: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
-00015b20: 706f 7274 2076 6172 0a0a 2020 2020 2020  port var..      
-00015b30: 2020 7265 7475 726e 2076 6172 280a 2020    return var(.  
-00015b40: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00015b50: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00015b60: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-00015b70: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
-00015b80: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
-00015b90: 6469 6d73 3d6b 6565 7064 696d 732c 0a20  dims=keepdims,. 
-00015ba0: 2020 2020 2020 2020 2020 2064 646f 663d             ddof=
-00015bb0: 6464 6f66 2c0a 2020 2020 2020 2020 2020  ddof,.          
-00015bc0: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00015bd0: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00015be0: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
-00015bf0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00015c00: 6566 206d 6f6d 656e 7428 0a20 2020 2020  ef moment(.     
-00015c10: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00015c20: 206f 7264 6572 2c0a 2020 2020 2020 2020   order,.        
-00015c30: 6178 6973 3d4e 6f6e 652c 0a20 2020 2020  axis=None,.     
-00015c40: 2020 2064 7479 7065 3d4e 6f6e 652c 0a20     dtype=None,. 
-00015c50: 2020 2020 2020 206b 6565 7064 696d 733d         keepdims=
-00015c60: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
-00015c70: 646f 663d 302c 0a20 2020 2020 2020 2073  dof=0,.        s
-00015c80: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
-00015c90: 0a20 2020 2020 2020 206f 7574 3d4e 6f6e  .        out=Non
-00015ca0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00015cb0: 2020 2222 2243 616c 6375 6c61 7465 2074    """Calculate t
-00015cc0: 6865 206e 7468 2063 656e 7472 616c 697a  he nth centraliz
-00015cd0: 6564 206d 6f6d 656e 742e 0a0a 2020 2020  ed moment...    
-00015ce0: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
-00015cf0: 6e63 3a60 6461 736b 2e61 7272 6179 2e6d  nc:`dask.array.m
-00015d00: 6f6d 656e 7460 2066 6f72 2074 6865 2066  oment` for the f
-00015d10: 756c 6c20 646f 6375 6d65 6e74 6174 696f  ull documentatio
-00015d20: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
-00015d30: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-00015d40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
-00015d50: 736b 2e61 7272 6179 2e6d 6f6d 656e 7420  sk.array.moment 
-00015d60: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
-00015d70: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
-00015d80: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
-00015d90: 6173 6b2e 6172 7261 792e 7265 6475 6374  ask.array.reduct
-00015da0: 696f 6e73 2069 6d70 6f72 7420 6d6f 6d65  ions import mome
-00015db0: 6e74 0a0a 2020 2020 2020 2020 7265 7475  nt..        retu
-00015dc0: 726e 206d 6f6d 656e 7428 0a20 2020 2020  rn moment(.     
-00015dd0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00015de0: 2020 2020 2020 2020 206f 7264 6572 2c0a           order,.
-00015df0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00015e00: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-00015e10: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
-00015e20: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
-00015e30: 6469 6d73 3d6b 6565 7064 696d 732c 0a20  dims=keepdims,. 
-00015e40: 2020 2020 2020 2020 2020 2064 646f 663d             ddof=
-00015e50: 6464 6f66 2c0a 2020 2020 2020 2020 2020  ddof,.          
-00015e60: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00015e70: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00015e80: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
-00015e90: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00015ea0: 7772 6170 7328 6d61 705f 626c 6f63 6b73  wraps(map_blocks
-00015eb0: 290a 2020 2020 6465 6620 6d61 705f 626c  ).    def map_bl
-00015ec0: 6f63 6b73 2873 656c 662c 2066 756e 632c  ocks(self, func,
-00015ed0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00015ee0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00015ef0: 6e20 6d61 705f 626c 6f63 6b73 2866 756e  n map_blocks(fun
-00015f00: 632c 2073 656c 662c 202a 6172 6773 2c20  c, self, *args, 
-00015f10: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
-00015f20: 6566 206d 6170 5f6f 7665 726c 6170 2873  ef map_overlap(s
-00015f30: 656c 662c 2066 756e 632c 2064 6570 7468  elf, func, depth
-00015f40: 2c20 626f 756e 6461 7279 3d4e 6f6e 652c  , boundary=None,
-00015f50: 2074 7269 6d3d 5472 7565 2c20 2a2a 6b77   trim=True, **kw
-00015f60: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00015f70: 2222 4d61 7020 6120 6675 6e63 7469 6f6e  ""Map a function
-00015f80: 206f 7665 7220 626c 6f63 6b73 206f 6620   over blocks of 
-00015f90: 7468 6520 6172 7261 7920 7769 7468 2073  the array with s
-00015fa0: 6f6d 6520 6f76 6572 6c61 700a 0a20 2020  ome overlap..   
-00015fb0: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
-00015fc0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
-00015fd0: 6d61 705f 6f76 6572 6c61 7060 2066 6f72  map_overlap` for
-00015fe0: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
-00015ff0: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
-00016000: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00016010: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00016020: 6461 736b 2e61 7272 6179 2e6d 6170 5f6f  dask.array.map_o
-00016030: 7665 726c 6170 203a 2065 7175 6976 616c  verlap : equival
-00016040: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
-00016050: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016060: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00016070: 2e6f 7665 726c 6170 2069 6d70 6f72 7420  .overlap import 
-00016080: 6d61 705f 6f76 6572 6c61 700a 0a20 2020  map_overlap..   
-00016090: 2020 2020 2072 6574 7572 6e20 6d61 705f       return map_
-000160a0: 6f76 6572 6c61 7028 0a20 2020 2020 2020  overlap(.       
-000160b0: 2020 2020 2066 756e 632c 2073 656c 662c       func, self,
-000160c0: 2064 6570 7468 3d64 6570 7468 2c20 626f   depth=depth, bo
-000160d0: 756e 6461 7279 3d62 6f75 6e64 6172 792c  undary=boundary,
-000160e0: 2074 7269 6d3d 7472 696d 2c20 2a2a 6b77   trim=trim, **kw
-000160f0: 6172 6773 0a20 2020 2020 2020 2029 0a0a  args.        )..
-00016100: 2020 2020 6465 6620 6375 6d73 756d 2873      def cumsum(s
-00016110: 656c 662c 2061 7869 732c 2064 7479 7065  elf, axis, dtype
-00016120: 3d4e 6f6e 652c 206f 7574 3d4e 6f6e 652c  =None, out=None,
-00016130: 202a 2c20 6d65 7468 6f64 3d22 7365 7175   *, method="sequ
-00016140: 656e 7469 616c 2229 3a0a 2020 2020 2020  ential"):.      
-00016150: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
-00016160: 6375 6d75 6c61 7469 7665 2073 756d 206f  cumulative sum o
-00016170: 6620 7468 6520 656c 656d 656e 7473 2061  f the elements a
-00016180: 6c6f 6e67 2074 6865 2067 6976 656e 2061  long the given a
-00016190: 7869 732e 0a0a 2020 2020 2020 2020 5265  xis...        Re
-000161a0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
-000161b0: 736b 2e61 7272 6179 2e63 756d 7375 6d60  sk.array.cumsum`
-000161c0: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
-000161d0: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
-000161e0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-000161f0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00016200: 2020 2020 6461 736b 2e61 7272 6179 2e63      dask.array.c
-00016210: 756d 7375 6d20 3a20 6571 7569 7661 6c65  umsum : equivale
-00016220: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
-00016230: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00016240: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
-00016250: 7265 6475 6374 696f 6e73 2069 6d70 6f72  reductions impor
-00016260: 7420 6375 6d73 756d 0a0a 2020 2020 2020  t cumsum..      
-00016270: 2020 7265 7475 726e 2063 756d 7375 6d28    return cumsum(
-00016280: 7365 6c66 2c20 6178 6973 2c20 6474 7970  self, axis, dtyp
-00016290: 652c 206f 7574 3d6f 7574 2c20 6d65 7468  e, out=out, meth
-000162a0: 6f64 3d6d 6574 686f 6429 0a0a 2020 2020  od=method)..    
-000162b0: 6465 6620 6375 6d70 726f 6428 7365 6c66  def cumprod(self
-000162c0: 2c20 6178 6973 2c20 6474 7970 653d 4e6f  , axis, dtype=No
-000162d0: 6e65 2c20 6f75 743d 4e6f 6e65 2c20 2a2c  ne, out=None, *,
-000162e0: 206d 6574 686f 643d 2273 6571 7565 6e74   method="sequent
-000162f0: 6961 6c22 293a 0a20 2020 2020 2020 2022  ial"):.        "
-00016300: 2222 5265 7475 726e 2074 6865 2063 756d  ""Return the cum
-00016310: 756c 6174 6976 6520 7072 6f64 7563 7420  ulative product 
-00016320: 6f66 2074 6865 2065 6c65 6d65 6e74 7320  of the elements 
-00016330: 616c 6f6e 6720 7468 6520 6769 7665 6e20  along the given 
-00016340: 6178 6973 2e0a 0a20 2020 2020 2020 2052  axis...        R
-00016350: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
-00016360: 6173 6b2e 6172 7261 792e 6375 6d70 726f  ask.array.cumpro
-00016370: 6460 2066 6f72 2066 756c 6c20 646f 6375  d` for full docu
-00016380: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
-00016390: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-000163a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-000163b0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-000163c0: 2e63 756d 7072 6f64 203a 2065 7175 6976  .cumprod : equiv
-000163d0: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
-000163e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000163f0: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00016400: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
-00016410: 706f 7274 2063 756d 7072 6f64 0a0a 2020  port cumprod..  
-00016420: 2020 2020 2020 7265 7475 726e 2063 756d        return cum
-00016430: 7072 6f64 2873 656c 662c 2061 7869 732c  prod(self, axis,
-00016440: 2064 7479 7065 2c20 6f75 743d 6f75 742c   dtype, out=out,
-00016450: 206d 6574 686f 643d 6d65 7468 6f64 290a   method=method).
-00016460: 0a20 2020 2064 6566 2073 7175 6565 7a65  .    def squeeze
-00016470: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-00016480: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00016490: 6d6f 7665 2061 7865 7320 6f66 206c 656e  move axes of len
-000164a0: 6774 6820 6f6e 6520 6672 6f6d 2061 7272  gth one from arr
-000164b0: 6179 2e0a 0a20 2020 2020 2020 2052 6566  ay...        Ref
-000164c0: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-000164d0: 6b2e 6172 7261 792e 7371 7565 657a 6560  k.array.squeeze`
-000164e0: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
-000164f0: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
-00016500: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00016510: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00016520: 2020 2020 6461 736b 2e61 7272 6179 2e73      dask.array.s
-00016530: 7175 6565 7a65 203a 2065 7175 6976 616c  queeze : equival
-00016540: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
-00016550: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016560: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00016570: 2e72 6f75 7469 6e65 7320 696d 706f 7274  .routines import
-00016580: 2073 7175 6565 7a65 0a0a 2020 2020 2020   squeeze..      
-00016590: 2020 7265 7475 726e 2073 7175 6565 7a65    return squeeze
-000165a0: 2873 656c 662c 2061 7869 7329 0a0a 2020  (self, axis)..  
-000165b0: 2020 6465 6620 7265 6368 756e 6b28 0a20    def rechunk(. 
-000165c0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000165d0: 2020 2020 2063 6875 6e6b 733d 2261 7574       chunks="aut
-000165e0: 6f22 2c0a 2020 2020 2020 2020 7468 7265  o",.        thre
-000165f0: 7368 6f6c 643d 4e6f 6e65 2c0a 2020 2020  shold=None,.    
-00016600: 2020 2020 626c 6f63 6b5f 7369 7a65 5f6c      block_size_l
-00016610: 696d 6974 3d4e 6f6e 652c 0a20 2020 2020  imit=None,.     
-00016620: 2020 2062 616c 616e 6365 3d46 616c 7365     balance=False
-00016630: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
-00016640: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-00016650: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
-00016660: 2062 6c6f 636b 7320 696e 2064 6173 6b20   blocks in dask 
-00016670: 6172 7261 7920 7820 666f 7220 6e65 7720  array x for new 
-00016680: 6368 756e 6b73 2e0a 0a20 2020 2020 2020  chunks...       
-00016690: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
-000166a0: 6064 6173 6b2e 6172 7261 792e 7265 6368  `dask.array.rech
-000166b0: 756e 6b60 2066 6f72 2066 756c 6c20 646f  unk` for full do
-000166c0: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
-000166d0: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-000166e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-000166f0: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
-00016700: 6179 2e72 6563 6875 6e6b 203a 2065 7175  ay.rechunk : equ
-00016710: 6976 616c 656e 7420 6675 6e63 7469 6f6e  ivalent function
-00016720: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00016730: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
-00016740: 7272 6179 2e72 6563 6875 6e6b 2069 6d70  rray.rechunk imp
-00016750: 6f72 7420 7265 6368 756e 6b20 2023 2061  ort rechunk  # a
-00016760: 766f 6964 2063 6972 6375 6c61 7220 696d  void circular im
-00016770: 706f 7274 0a0a 2020 2020 2020 2020 7265  port..        re
-00016780: 7475 726e 2072 6563 6875 6e6b 2873 656c  turn rechunk(sel
-00016790: 662c 2063 6875 6e6b 732c 2074 6872 6573  f, chunks, thres
-000167a0: 686f 6c64 2c20 626c 6f63 6b5f 7369 7a65  hold, block_size
-000167b0: 5f6c 696d 6974 2c20 6261 6c61 6e63 652c  _limit, balance,
-000167c0: 206d 6574 686f 6429 0a0a 2020 2020 4070   method)..    @p
-000167d0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000167e0: 7265 616c 2873 656c 6629 3a0a 2020 2020  real(self):.    
-000167f0: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
-00016800: 7261 792e 7566 756e 6320 696d 706f 7274  ray.ufunc import
-00016810: 2072 6561 6c0a 0a20 2020 2020 2020 2072   real..        r
-00016820: 6574 7572 6e20 7265 616c 2873 656c 6629  eturn real(self)
-00016830: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00016840: 2020 2020 6465 6620 696d 6167 2873 656c      def imag(sel
-00016850: 6629 3a0a 2020 2020 2020 2020 6672 6f6d  f):.        from
-00016860: 2064 6173 6b2e 6172 7261 792e 7566 756e   dask.array.ufun
-00016870: 6320 696d 706f 7274 2069 6d61 670a 0a20  c import imag.. 
-00016880: 2020 2020 2020 2072 6574 7572 6e20 696d         return im
-00016890: 6167 2873 656c 6629 0a0a 2020 2020 6465  ag(self)..    de
-000168a0: 6620 636f 6e6a 2873 656c 6629 3a0a 2020  f conj(self):.  
-000168b0: 2020 2020 2020 2222 2243 6f6d 706c 6578        """Complex
-000168c0: 2d63 6f6e 6a75 6761 7465 2061 6c6c 2065  -conjugate all e
-000168d0: 6c65 6d65 6e74 732e 0a0a 2020 2020 2020  lements...      
-000168e0: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-000168f0: 3a60 6461 736b 2e61 7272 6179 2e63 6f6e  :`dask.array.con
-00016900: 6a60 2066 6f72 2066 756c 6c20 646f 6375  j` for full docu
-00016910: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
-00016920: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00016930: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00016940: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-00016950: 2e63 6f6e 6a20 3a20 6571 7569 7661 6c65  .conj : equivale
-00016960: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
-00016970: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00016980: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
-00016990: 7566 756e 6320 696d 706f 7274 2063 6f6e  ufunc import con
-000169a0: 6a0a 0a20 2020 2020 2020 2072 6574 7572  j..        retur
-000169b0: 6e20 636f 6e6a 2873 656c 6629 0a0a 2020  n conj(self)..  
-000169c0: 2020 6465 6620 636c 6970 2873 656c 662c    def clip(self,
-000169d0: 206d 696e 3d4e 6f6e 652c 206d 6178 3d4e   min=None, max=N
-000169e0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-000169f0: 2252 6574 7572 6e20 616e 2061 7272 6179  "Return an array
-00016a00: 2077 686f 7365 2076 616c 7565 7320 6172   whose values ar
-00016a10: 6520 6c69 6d69 7465 6420 746f 2060 605b  e limited to ``[
-00016a20: 6d69 6e2c 206d 6178 5d60 602e 0a20 2020  min, max]``..   
-00016a30: 2020 2020 204f 6e65 206f 6620 6d61 7820       One of max 
-00016a40: 6f72 206d 696e 206d 7573 7420 6265 2067  or min must be g
-00016a50: 6976 656e 2e0a 0a20 2020 2020 2020 2052  iven...        R
-00016a60: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
-00016a70: 6173 6b2e 6172 7261 792e 636c 6970 6020  ask.array.clip` 
-00016a80: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
-00016a90: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00016aa0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00016ab0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00016ac0: 2020 2064 6173 6b2e 6172 7261 792e 636c     dask.array.cl
-00016ad0: 6970 203a 2065 7175 6976 616c 656e 7420  ip : equivalent 
-00016ae0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-00016af0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00016b00: 6d20 6461 736b 2e61 7272 6179 2e75 6675  m dask.array.ufu
-00016b10: 6e63 2069 6d70 6f72 7420 636c 6970 0a0a  nc import clip..
-00016b20: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-00016b30: 6c69 7028 7365 6c66 2c20 6d69 6e2c 206d  lip(self, min, m
-00016b40: 6178 290a 0a20 2020 2064 6566 2076 6965  ax)..    def vie
-00016b50: 7728 7365 6c66 2c20 6474 7970 653d 4e6f  w(self, dtype=No
-00016b60: 6e65 2c20 6f72 6465 723d 2243 2229 3a0a  ne, order="C"):.
-00016b70: 2020 2020 2020 2020 2222 2247 6574 2061          """Get a
-00016b80: 2076 6965 7720 6f66 2074 6865 2061 7272   view of the arr
-00016b90: 6179 2061 7320 6120 6e65 7720 6461 7461  ay as a new data
-00016ba0: 2074 7970 650a 0a20 2020 2020 2020 2050   type..        P
-00016bb0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00016bc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00016bd0: 2020 2020 2064 7479 7065 3a0a 2020 2020       dtype:.    
-00016be0: 2020 2020 2020 2020 5468 6520 6474 7970          The dtyp
-00016bf0: 6520 6279 2077 6869 6368 2074 6f20 7669  e by which to vi
-00016c00: 6577 2074 6865 2061 7272 6179 2e0a 2020  ew the array..  
-00016c10: 2020 2020 2020 2020 2020 5468 6520 6465            The de
-00016c20: 6661 756c 742c 204e 6f6e 652c 2072 6573  fault, None, res
-00016c30: 756c 7473 2069 6e20 7468 6520 7669 6577  ults in the view
-00016c40: 2068 6176 696e 6720 7468 6520 7361 6d65   having the same
-00016c50: 2064 6174 612d 7479 7065 0a20 2020 2020   data-type.     
-00016c60: 2020 2020 2020 2061 7320 7468 6520 6f72         as the or
-00016c70: 6967 696e 616c 2061 7272 6179 2e0a 2020  iginal array..  
-00016c80: 2020 2020 2020 6f72 6465 723a 2073 7472        order: str
-00016c90: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00016ca0: 2743 2720 6f72 2027 4627 2028 466f 7274  'C' or 'F' (Fort
-00016cb0: 7261 6e29 206f 7264 6572 696e 670a 0a20  ran) ordering.. 
-00016cc0: 2020 2020 2020 2054 6869 7320 7265 696e         This rein
-00016cd0: 7465 7270 7265 7473 2074 6865 2062 7974  terprets the byt
-00016ce0: 6573 206f 6620 7468 6520 6172 7261 7920  es of the array 
-00016cf0: 756e 6465 7220 6120 6e65 7720 6474 7970  under a new dtyp
-00016d00: 652e 2020 4966 2074 6861 740a 2020 2020  e.  If that.    
-00016d10: 2020 2020 6474 7970 6520 646f 6573 206e      dtype does n
-00016d20: 6f74 2068 6176 6520 7468 6520 7361 6d65  ot have the same
-00016d30: 2073 697a 6520 6173 2074 6865 206f 7269   size as the ori
-00016d40: 6769 6e61 6c20 6172 7261 7920 7468 656e  ginal array then
-00016d50: 2074 6865 2073 6861 7065 0a20 2020 2020   the shape.     
-00016d60: 2020 2077 696c 6c20 6368 616e 6765 2e0a     will change..
-00016d70: 0a20 2020 2020 2020 2042 6577 6172 6520  .        Beware 
-00016d80: 7468 6174 2062 6f74 6820 6e75 6d70 7920  that both numpy 
-00016d90: 616e 6420 6461 736b 2e61 7272 6179 2063  and dask.array c
-00016da0: 616e 2062 6568 6176 6520 6f64 646c 7920  an behave oddly 
-00016db0: 7768 656e 2074 616b 696e 670a 2020 2020  when taking.    
-00016dc0: 2020 2020 7368 6170 652d 6368 616e 6769      shape-changi
-00016dd0: 6e67 2076 6965 7773 206f 6620 6172 7261  ng views of arra
-00016de0: 7973 2075 6e64 6572 2046 6f72 7472 616e  ys under Fortran
-00016df0: 206f 7264 6572 696e 672e 2020 556e 6465   ordering.  Unde
-00016e00: 7220 736f 6d65 0a20 2020 2020 2020 2076  r some.        v
-00016e10: 6572 7369 6f6e 7320 6f66 204e 756d 5079  ersions of NumPy
-00016e20: 2074 6869 7320 6675 6e63 7469 6f6e 2077   this function w
-00016e30: 696c 6c20 6661 696c 2077 6865 6e20 7461  ill fail when ta
-00016e40: 6b69 6e67 2073 6861 7065 2d63 6861 6e67  king shape-chang
-00016e50: 696e 670a 2020 2020 2020 2020 7669 6577  ing.        view
-00016e60: 7320 6f66 2046 6f72 7472 616e 206f 7264  s of Fortran ord
-00016e70: 6572 6564 2061 7272 6179 7320 6966 2074  ered arrays if t
-00016e80: 6865 2066 6972 7374 2064 696d 656e 7369  he first dimensi
-00016e90: 6f6e 2068 6173 2063 6875 6e6b 7320 6f66  on has chunks of
-00016ea0: 0a20 2020 2020 2020 2073 697a 6520 6f6e  .        size on
-00016eb0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-00016ec0: 2020 2020 2020 2069 6620 6474 7970 6520         if dtype 
-00016ed0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00016ee0: 2020 2020 2064 7479 7065 203d 2073 656c       dtype = sel
-00016ef0: 662e 6474 7970 650a 2020 2020 2020 2020  f.dtype.        
-00016f00: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00016f10: 2020 6474 7970 6520 3d20 6e70 2e64 7479    dtype = np.dty
-00016f20: 7065 2864 7479 7065 290a 2020 2020 2020  pe(dtype).      
-00016f30: 2020 6d75 6c74 203d 2073 656c 662e 6474    mult = self.dt
-00016f40: 7970 652e 6974 656d 7369 7a65 202f 2064  ype.itemsize / d
-00016f50: 7479 7065 2e69 7465 6d73 697a 650a 0a20  type.itemsize.. 
-00016f60: 2020 2020 2020 2069 6620 6f72 6465 7220         if order 
-00016f70: 3d3d 2022 4322 3a0a 2020 2020 2020 2020  == "C":.        
-00016f80: 2020 2020 6368 756e 6b73 203d 2073 656c      chunks = sel
-00016f90: 662e 6368 756e 6b73 5b3a 2d31 5d20 2b20  f.chunks[:-1] + 
-00016fa0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00016fb0: 2020 7475 706c 6528 656e 7375 7265 5f69    tuple(ensure_i
-00016fc0: 6e74 2863 202a 206d 756c 7429 2066 6f72  nt(c * mult) for
-00016fd0: 2063 2069 6e20 7365 6c66 2e63 6875 6e6b   c in self.chunk
-00016fe0: 735b 2d31 5d29 2c0a 2020 2020 2020 2020  s[-1]),.        
-00016ff0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-00017000: 6966 206f 7264 6572 203d 3d20 2246 223a  if order == "F":
-00017010: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00017020: 6e6b 7320 3d20 280a 2020 2020 2020 2020  nks = (.        
-00017030: 2020 2020 2020 2020 7475 706c 6528 656e          tuple(en
-00017040: 7375 7265 5f69 6e74 2863 202a 206d 756c  sure_int(c * mul
-00017050: 7429 2066 6f72 2063 2069 6e20 7365 6c66  t) for c in self
-00017060: 2e63 6875 6e6b 735b 305d 292c 0a20 2020  .chunks[0]),.   
-00017070: 2020 2020 2020 2020 2029 202b 2073 656c           ) + sel
-00017080: 662e 6368 756e 6b73 5b31 3a5d 0a20 2020  f.chunks[1:].   
-00017090: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000170a0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000170b0: 7565 4572 726f 7228 224f 7264 6572 206d  ueError("Order m
-000170c0: 7573 7420 6265 206f 6e65 206f 6620 2743  ust be one of 'C
-000170d0: 2720 6f72 2027 4627 2229 0a0a 2020 2020  ' or 'F'")..    
-000170e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000170f0: 6d61 705f 626c 6f63 6b73 280a 2020 2020  map_blocks(.    
-00017100: 2020 2020 2020 2020 6368 756e 6b2e 7669          chunk.vi
-00017110: 6577 2c20 6474 7970 652c 206f 7264 6572  ew, dtype, order
-00017120: 3d6f 7264 6572 2c20 6474 7970 653d 6474  =order, dtype=dt
-00017130: 7970 652c 2063 6875 6e6b 733d 6368 756e  ype, chunks=chun
-00017140: 6b73 0a20 2020 2020 2020 2029 0a0a 2020  ks.        )..  
-00017150: 2020 6465 6620 7377 6170 6178 6573 2873    def swapaxes(s
-00017160: 656c 662c 2061 7869 7331 2c20 6178 6973  elf, axis1, axis
-00017170: 3229 3a0a 2020 2020 2020 2020 2222 2252  2):.        """R
-00017180: 6574 7572 6e20 6120 7669 6577 206f 6620  eturn a view of 
-00017190: 7468 6520 6172 7261 7920 7769 7468 2060  the array with `
-000171a0: 6061 7869 7331 6060 2061 6e64 2060 6061  `axis1`` and ``a
-000171b0: 7869 7332 6060 2069 6e74 6572 6368 616e  xis2`` interchan
-000171c0: 6765 642e 0a0a 2020 2020 2020 2020 5265  ged...        Re
-000171d0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
-000171e0: 736b 2e61 7272 6179 2e73 7761 7061 7865  sk.array.swapaxe
-000171f0: 7360 2066 6f72 2066 756c 6c20 646f 6375  s` for full docu
-00017200: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
-00017210: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00017220: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00017230: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-00017240: 2e73 7761 7061 7865 7320 3a20 6571 7569  .swapaxes : equi
-00017250: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
-00017260: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00017270: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
-00017280: 7261 792e 726f 7574 696e 6573 2069 6d70  ray.routines imp
-00017290: 6f72 7420 7377 6170 6178 6573 0a0a 2020  ort swapaxes..  
-000172a0: 2020 2020 2020 7265 7475 726e 2073 7761        return swa
-000172b0: 7061 7865 7328 7365 6c66 2c20 6178 6973  paxes(self, axis
-000172c0: 312c 2061 7869 7332 290a 0a20 2020 2064  1, axis2)..    d
-000172d0: 6566 2072 6f75 6e64 2873 656c 662c 2064  ef round(self, d
-000172e0: 6563 696d 616c 733d 3029 3a0a 2020 2020  ecimals=0):.    
-000172f0: 2020 2020 2222 2252 6574 7572 6e20 6172      """Return ar
-00017300: 7261 7920 7769 7468 2065 6163 6820 656c  ray with each el
-00017310: 656d 656e 7420 726f 756e 6465 6420 746f  ement rounded to
-00017320: 2074 6865 2067 6976 656e 206e 756d 6265   the given numbe
-00017330: 7220 6f66 2064 6563 696d 616c 732e 0a0a  r of decimals...
-00017340: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
-00017350: 203a 6675 6e63 3a60 6461 736b 2e61 7272   :func:`dask.arr
-00017360: 6179 2e72 6f75 6e64 6020 666f 7220 6675  ay.round` for fu
-00017370: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
-00017380: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-00017390: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-000173a0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-000173b0: 6b2e 6172 7261 792e 726f 756e 6420 3a20  k.array.round : 
-000173c0: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
-000173d0: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
-000173e0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-000173f0: 6b2e 6172 7261 792e 726f 7574 696e 6573  k.array.routines
-00017400: 2069 6d70 6f72 7420 726f 756e 640a 0a20   import round.. 
-00017410: 2020 2020 2020 2072 6574 7572 6e20 726f         return ro
-00017420: 756e 6428 7365 6c66 2c20 6465 6369 6d61  und(self, decima
-00017430: 6c73 3d64 6563 696d 616c 7329 0a0a 2020  ls=decimals)..  
-00017440: 2020 6465 6620 636f 7079 2873 656c 6629    def copy(self)
-00017450: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00017460: 2020 2020 2020 436f 7079 2061 7272 6179        Copy array
-00017470: 2e20 2054 6869 7320 6973 2061 206e 6f2d  .  This is a no-
-00017480: 6f70 2066 6f72 2064 6173 6b2e 6172 7261  op for dask.arra
-00017490: 7973 2c20 7768 6963 6820 6172 6520 696d  ys, which are im
-000174a0: 6d75 7461 626c 650a 2020 2020 2020 2020  mutable.        
-000174b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000174c0: 726e 2041 7272 6179 2873 656c 662e 6461  rn Array(self.da
-000174d0: 736b 2c20 7365 6c66 2e6e 616d 652c 2073  sk, self.name, s
-000174e0: 656c 662e 6368 756e 6b73 2c20 6d65 7461  elf.chunks, meta
-000174f0: 3d73 656c 6629 0a0a 2020 2020 6465 6620  =self)..    def 
-00017500: 5f5f 6465 6570 636f 7079 5f5f 2873 656c  __deepcopy__(sel
-00017510: 662c 206d 656d 6f29 3a0a 2020 2020 2020  f, memo):.      
-00017520: 2020 6320 3d20 7365 6c66 2e63 6f70 7928    c = self.copy(
-00017530: 290a 2020 2020 2020 2020 6d65 6d6f 5b69  ).        memo[i
-00017540: 6428 7365 6c66 295d 203d 2063 0a20 2020  d(self)] = c.   
-00017550: 2020 2020 2072 6574 7572 6e20 630a 0a20       return c.. 
-00017560: 2020 2064 6566 2074 6f5f 6465 6c61 7965     def to_delaye
-00017570: 6428 7365 6c66 2c20 6f70 7469 6d69 7a65  d(self, optimize
-00017580: 5f67 7261 7068 3d54 7275 6529 3a0a 2020  _graph=True):.  
-00017590: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
-000175a0: 2069 6e74 6f20 616e 2061 7272 6179 206f   into an array o
-000175b0: 6620 3a63 6c61 7373 3a60 6461 736b 2e64  f :class:`dask.d
-000175c0: 656c 6179 6564 2e44 656c 6179 6564 6020  elayed.Delayed` 
-000175d0: 6f62 6a65 6374 732c 206f 6e65 2070 6572  objects, one per
-000175e0: 2063 6875 6e6b 2e0a 0a20 2020 2020 2020   chunk...       
-000175f0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00017600: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00017610: 2020 2020 2020 206f 7074 696d 697a 655f         optimize_
-00017620: 6772 6170 6820 3a20 626f 6f6c 2c20 6f70  graph : bool, op
-00017630: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00017640: 2020 2049 6620 5472 7565 205b 6465 6661     If True [defa
-00017650: 756c 745d 2c20 7468 6520 6772 6170 6820  ult], the graph 
-00017660: 6973 206f 7074 696d 697a 6564 2062 6566  is optimized bef
-00017670: 6f72 6520 636f 6e76 6572 7469 6e67 2069  ore converting i
-00017680: 6e74 6f0a 2020 2020 2020 2020 2020 2020  nto.            
-00017690: 3a63 6c61 7373 3a60 6461 736b 2e64 656c  :class:`dask.del
-000176a0: 6179 6564 2e44 656c 6179 6564 6020 6f62  ayed.Delayed` ob
-000176b0: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
-000176c0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000176d0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000176e0: 2020 6461 736b 2e61 7272 6179 2e66 726f    dask.array.fro
-000176f0: 6d5f 6465 6c61 7965 640a 2020 2020 2020  m_delayed.      
-00017700: 2020 2222 220a 2020 2020 2020 2020 6b65    """.        ke
-00017710: 7973 203d 2073 656c 662e 5f5f 6461 736b  ys = self.__dask
-00017720: 5f6b 6579 735f 5f28 290a 2020 2020 2020  _keys__().      
-00017730: 2020 6772 6170 6820 3d20 7365 6c66 2e5f    graph = self._
-00017740: 5f64 6173 6b5f 6772 6170 685f 5f28 290a  _dask_graph__().
-00017750: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
-00017760: 7365 6c66 2e5f 5f64 6173 6b5f 6c61 7965  self.__dask_laye
-00017770: 7273 5f5f 2829 5b30 5d0a 2020 2020 2020  rs__()[0].      
-00017780: 2020 6966 206f 7074 696d 697a 655f 6772    if optimize_gr
-00017790: 6170 683a 0a20 2020 2020 2020 2020 2020  aph:.           
-000177a0: 2067 7261 7068 203d 2073 656c 662e 5f5f   graph = self.__
-000177b0: 6461 736b 5f6f 7074 696d 697a 655f 5f28  dask_optimize__(
-000177c0: 6772 6170 682c 206b 6579 7329 2020 2320  graph, keys)  # 
-000177d0: 544f 444f 2c20 646f 6e27 7420 636f 6c6c  TODO, don't coll
-000177e0: 6170 6520 6772 6170 680a 2020 2020 2020  ape graph.      
-000177f0: 2020 2020 2020 6c61 7965 7220 3d20 2264        layer = "d
-00017800: 656c 6179 6564 2d22 202b 2073 656c 662e  elayed-" + self.
-00017810: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-00017820: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-00017830: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00017840: 6c65 6374 696f 6e73 286c 6179 6572 2c20  lections(layer, 
-00017850: 6772 6170 682c 2064 6570 656e 6465 6e63  graph, dependenc
-00017860: 6965 733d 2829 290a 2020 2020 2020 2020  ies=()).        
-00017870: 4c20 3d20 6e64 6565 706d 6170 2873 656c  L = ndeepmap(sel
-00017880: 662e 6e64 696d 2c20 6c61 6d62 6461 206b  f.ndim, lambda k
-00017890: 3a20 4465 6c61 7965 6428 6b2c 2067 7261  : Delayed(k, gra
-000178a0: 7068 2c20 6c61 7965 723d 6c61 7965 7229  ph, layer=layer)
-000178b0: 2c20 6b65 7973 290a 2020 2020 2020 2020  , keys).        
-000178c0: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
-000178d0: 4c2c 2064 7479 7065 3d6f 626a 6563 7429  L, dtype=object)
-000178e0: 0a0a 2020 2020 6465 6620 7265 7065 6174  ..    def repeat
-000178f0: 2873 656c 662c 2072 6570 6561 7473 2c20  (self, repeats, 
-00017900: 6178 6973 3d4e 6f6e 6529 3a0a 2020 2020  axis=None):.    
-00017910: 2020 2020 2222 2252 6570 6561 7420 656c      """Repeat el
-00017920: 656d 656e 7473 206f 6620 616e 2061 7272  ements of an arr
-00017930: 6179 2e0a 0a20 2020 2020 2020 2052 6566  ay...        Ref
-00017940: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-00017950: 6b2e 6172 7261 792e 7265 7065 6174 6020  k.array.repeat` 
-00017960: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
-00017970: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00017980: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00017990: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-000179a0: 2020 2064 6173 6b2e 6172 7261 792e 7265     dask.array.re
-000179b0: 7065 6174 203a 2065 7175 6976 616c 656e  peat : equivalen
-000179c0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
-000179d0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-000179e0: 726f 6d20 6461 736b 2e61 7272 6179 2e63  rom dask.array.c
-000179f0: 7265 6174 696f 6e20 696d 706f 7274 2072  reation import r
-00017a00: 6570 6561 740a 0a20 2020 2020 2020 2072  epeat..        r
-00017a10: 6574 7572 6e20 7265 7065 6174 2873 656c  eturn repeat(sel
-00017a20: 662c 2072 6570 6561 7473 2c20 6178 6973  f, repeats, axis
-00017a30: 3d61 7869 7329 0a0a 2020 2020 6465 6620  =axis)..    def 
-00017a40: 6e6f 6e7a 6572 6f28 7365 6c66 293a 0a20  nonzero(self):. 
-00017a50: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00017a60: 2074 6865 2069 6e64 6963 6573 206f 6620   the indices of 
-00017a70: 7468 6520 656c 656d 656e 7473 2074 6861  the elements tha
-00017a80: 7420 6172 6520 6e6f 6e2d 7a65 726f 2e0a  t are non-zero..
-00017a90: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
-00017aa0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
-00017ab0: 7261 792e 6e6f 6e7a 6572 6f60 2066 6f72  ray.nonzero` for
-00017ac0: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
-00017ad0: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
-00017ae0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00017af0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00017b00: 6461 736b 2e61 7272 6179 2e6e 6f6e 7a65  dask.array.nonze
-00017b10: 726f 203a 2065 7175 6976 616c 656e 7420  ro : equivalent 
-00017b20: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-00017b30: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00017b40: 6d20 6461 736b 2e61 7272 6179 2e72 6f75  m dask.array.rou
-00017b50: 7469 6e65 7320 696d 706f 7274 206e 6f6e  tines import non
-00017b60: 7a65 726f 0a0a 2020 2020 2020 2020 7265  zero..        re
-00017b70: 7475 726e 206e 6f6e 7a65 726f 2873 656c  turn nonzero(sel
-00017b80: 6629 0a0a 2020 2020 6465 6620 746f 5f7a  f)..    def to_z
-00017b90: 6172 7228 7365 6c66 2c20 2a61 7267 732c  arr(self, *args,
-00017ba0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00017bb0: 2020 2020 2222 2253 6176 6520 6172 7261      """Save arra
-00017bc0: 7920 746f 2074 6865 207a 6172 7220 7374  y to the zarr st
-00017bd0: 6f72 6167 6520 666f 726d 6174 0a0a 2020  orage format..  
-00017be0: 2020 2020 2020 5365 6520 6874 7470 733a        See https:
-00017bf0: 2f2f 7a61 7272 2e72 6561 6474 6865 646f  //zarr.readthedo
-00017c00: 6373 2e69 6f20 666f 7220 6465 7461 696c  cs.io for detail
-00017c10: 7320 6162 6f75 7420 7468 6520 666f 726d  s about the form
-00017c20: 6174 2e0a 0a20 2020 2020 2020 2052 6566  at...        Ref
-00017c30: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-00017c40: 6b2e 6172 7261 792e 746f 5f7a 6172 7260  k.array.to_zarr`
-00017c50: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
-00017c60: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
-00017c70: 2020 5365 6520 616c 736f 0a20 2020 2020    See also.     
-00017c80: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00017c90: 2020 2020 6461 736b 2e61 7272 6179 2e74      dask.array.t
-00017ca0: 6f5f 7a61 7272 203a 2065 7175 6976 616c  o_zarr : equival
-00017cb0: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
-00017cc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00017cd0: 2072 6574 7572 6e20 746f 5f7a 6172 7228   return to_zarr(
-00017ce0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00017cf0: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
-00017d00: 746f 5f74 696c 6564 6228 7365 6c66 2c20  to_tiledb(self, 
-00017d10: 7572 692c 202a 6172 6773 2c20 2a2a 6b77  uri, *args, **kw
-00017d20: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00017d30: 2222 5361 7665 2061 7272 6179 2074 6f20  ""Save array to 
-00017d40: 7468 6520 5469 6c65 4442 2073 746f 7261  the TileDB stora
-00017d50: 6765 206d 616e 6167 6572 0a0a 2020 2020  ge manager..    
-00017d60: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
-00017d70: 646f 6373 2e74 696c 6564 622e 696f 2066  docs.tiledb.io f
-00017d80: 6f72 2064 6574 6169 6c73 2061 626f 7574  or details about
-00017d90: 2074 6865 2066 6f72 6d61 7420 616e 6420   the format and 
-00017da0: 656e 6769 6e65 2e0a 0a20 2020 2020 2020  engine...       
-00017db0: 2053 6565 2066 756e 6374 696f 6e20 3a66   See function :f
-00017dc0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
-00017dd0: 746f 5f74 696c 6564 6260 2066 6f72 2061  to_tiledb` for a
-00017de0: 7267 756d 656e 7420 646f 6375 6d65 6e74  rgument document
-00017df0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00017e00: 5365 6520 616c 736f 0a20 2020 2020 2020  See also.       
-00017e10: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00017e20: 2020 6461 736b 2e61 7272 6179 2e74 6f5f    dask.array.to_
-00017e30: 7469 6c65 6462 203a 2065 7175 6976 616c  tiledb : equival
-00017e40: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
-00017e50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00017e60: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00017e70: 2e74 696c 6564 625f 696f 2069 6d70 6f72  .tiledb_io impor
-00017e80: 7420 746f 5f74 696c 6564 620a 0a20 2020  t to_tiledb..   
-00017e90: 2020 2020 2072 6574 7572 6e20 746f 5f74       return to_t
-00017ea0: 696c 6564 6228 7365 6c66 2c20 7572 692c  iledb(self, uri,
-00017eb0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00017ec0: 290a 0a0a 6465 6620 656e 7375 7265 5f69  )...def ensure_i
-00017ed0: 6e74 2866 293a 0a20 2020 2069 203d 2069  nt(f):.    i = i
-00017ee0: 6e74 2866 290a 2020 2020 6966 2069 2021  nt(f).    if i !
-00017ef0: 3d20 663a 0a20 2020 2020 2020 2072 6169  = f:.        rai
-00017f00: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
-00017f10: 6f75 6c64 206e 6f74 2063 6f65 7263 6520  ould not coerce 
-00017f20: 2566 2074 6f20 696e 7465 6765 7222 2025  %f to integer" %
-00017f30: 2066 290a 2020 2020 7265 7475 726e 2069   f).    return i
-00017f40: 0a0a 0a64 6566 206e 6f72 6d61 6c69 7a65  ...def normalize
-00017f50: 5f63 6875 6e6b 7328 6368 756e 6b73 2c20  _chunks(chunks, 
-00017f60: 7368 6170 653d 4e6f 6e65 2c20 6c69 6d69  shape=None, limi
-00017f70: 743d 4e6f 6e65 2c20 6474 7970 653d 4e6f  t=None, dtype=No
-00017f80: 6e65 2c20 7072 6576 696f 7573 5f63 6875  ne, previous_chu
-00017f90: 6e6b 733d 4e6f 6e65 293a 0a20 2020 2022  nks=None):.    "
-00017fa0: 2222 4e6f 726d 616c 697a 6520 6368 756e  ""Normalize chun
-00017fb0: 6b73 2074 6f20 7475 706c 6520 6f66 2074  ks to tuple of t
-00017fc0: 7570 6c65 730a 0a20 2020 2054 6869 7320  uples..    This 
-00017fd0: 7461 6b65 7320 696e 2061 2076 6172 6965  takes in a varie
-00017fe0: 7479 206f 6620 696e 7075 7420 7479 7065  ty of input type
-00017ff0: 7320 616e 6420 696e 666f 726d 6174 696f  s and informatio
-00018000: 6e20 616e 6420 7072 6f64 7563 6573 2061  n and produces a
-00018010: 2066 756c 6c0a 2020 2020 7475 706c 652d   full.    tuple-
-00018020: 6f66 2d74 7570 6c65 7320 7265 7375 6c74  of-tuples result
-00018030: 2066 6f72 2063 6875 6e6b 732c 2073 7569   for chunks, sui
-00018040: 7461 626c 6520 746f 2062 6520 7061 7373  table to be pass
-00018050: 6564 2074 6f20 4172 7261 7920 6f72 0a20  ed to Array or. 
-00018060: 2020 2072 6563 6875 6e6b 206f 7220 616e     rechunk or an
-00018070: 7920 6f74 6865 7220 6f70 6572 6174 696f  y other operatio
-00018080: 6e20 7468 6174 2063 7265 6174 6573 2061  n that creates a
-00018090: 2044 6173 6b20 6172 7261 792e 0a0a 2020   Dask array...  
-000180a0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000180b0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000180c0: 6368 756e 6b73 3a20 7475 706c 652c 2069  chunks: tuple, i
-000180d0: 6e74 2c20 6469 6374 2c20 6f72 2073 7472  nt, dict, or str
-000180e0: 696e 670a 2020 2020 2020 2020 5468 6520  ing.        The 
-000180f0: 6368 756e 6b73 2074 6f20 6265 206e 6f72  chunks to be nor
-00018100: 6d61 6c69 7a65 642e 2020 5365 6520 6578  malized.  See ex
-00018110: 616d 706c 6573 2062 656c 6f77 2066 6f72  amples below for
-00018120: 206d 6f72 6520 6465 7461 696c 730a 2020   more details.  
-00018130: 2020 7368 6170 653a 2054 7570 6c65 5b69    shape: Tuple[i
-00018140: 6e74 5d0a 2020 2020 2020 2020 5468 6520  nt].        The 
-00018150: 7368 6170 6520 6f66 2074 6865 2061 7272  shape of the arr
-00018160: 6179 0a20 2020 206c 696d 6974 3a20 696e  ay.    limit: in
-00018170: 7420 286f 7074 696f 6e61 6c29 0a20 2020  t (optional).   
-00018180: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
-00018190: 2062 6c6f 636b 2073 697a 6520 746f 2074   block size to t
-000181a0: 6172 6765 7420 696e 2062 7974 6573 2c0a  arget in bytes,.
-000181b0: 2020 2020 2020 2020 6966 2066 7265 6564          if freed
-000181c0: 6f6d 2069 7320 6769 7665 6e20 746f 2063  om is given to c
-000181d0: 686f 6f73 650a 2020 2020 6474 7970 653a  hoose.    dtype:
-000181e0: 206e 702e 6474 7970 650a 2020 2020 7072   np.dtype.    pr
-000181f0: 6576 696f 7573 5f63 6875 6e6b 733a 2054  evious_chunks: T
-00018200: 7570 6c65 5b54 7570 6c65 5b69 6e74 5d5d  uple[Tuple[int]]
-00018210: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00018220: 2020 4368 756e 6b73 2066 726f 6d20 6120    Chunks from a 
-00018230: 7072 6576 696f 7573 2061 7272 6179 2074  previous array t
-00018240: 6861 7420 7765 2073 686f 756c 6420 7573  hat we should us
-00018250: 6520 666f 7220 696e 7370 6972 6174 696f  e for inspiratio
-00018260: 6e20 7768 656e 0a20 2020 2020 2020 2072  n when.        r
-00018270: 6563 6875 6e6b 696e 6720 6175 746f 2064  echunking auto d
-00018280: 696d 656e 7369 6f6e 732e 2020 4966 206e  imensions.  If n
-00018290: 6f74 2070 726f 7669 6465 6420 6275 7420  ot provided but 
-000182a0: 6175 746f 2d63 6875 6e6b 696e 6720 6578  auto-chunking ex
-000182b0: 6973 7473 0a20 2020 2020 2020 2074 6865  ists.        the
-000182c0: 6e20 6175 746f 2d64 696d 656e 7369 6f6e  n auto-dimension
-000182d0: 7320 7769 6c6c 2070 7265 6665 7220 7371  s will prefer sq
-000182e0: 7561 7265 2d6c 696b 6520 6368 756e 6b20  uare-like chunk 
-000182f0: 7368 6170 6573 2e0a 0a20 2020 2045 7861  shapes...    Exa
-00018300: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
-00018310: 2d2d 0a20 2020 2053 7065 6369 6679 2075  --.    Specify u
-00018320: 6e69 666f 726d 2063 6875 6e6b 2073 697a  niform chunk siz
-00018330: 6573 0a0a 2020 2020 3e3e 3e20 6672 6f6d  es..    >>> from
-00018340: 2064 6173 6b2e 6172 7261 792e 636f 7265   dask.array.core
-00018350: 2069 6d70 6f72 7420 6e6f 726d 616c 697a   import normaliz
-00018360: 655f 6368 756e 6b73 0a20 2020 203e 3e3e  e_chunks.    >>>
-00018370: 206e 6f72 6d61 6c69 7a65 5f63 6875 6e6b   normalize_chunk
-00018380: 7328 2832 2c20 3229 2c20 7368 6170 653d  s((2, 2), shape=
-00018390: 2835 2c20 3629 290a 2020 2020 2828 322c  (5, 6)).    ((2,
-000183a0: 2032 2c20 3129 2c20 2832 2c20 322c 2032   2, 1), (2, 2, 2
-000183b0: 2929 0a0a 2020 2020 416c 736f 2070 6173  ))..    Also pas
-000183c0: 7365 7320 7468 726f 7567 6820 6675 6c6c  ses through full
-000183d0: 7920 6578 706c 6963 6974 2074 7570 6c65  y explicit tuple
-000183e0: 2d6f 662d 7475 706c 6573 0a0a 2020 2020  -of-tuples..    
-000183f0: 3e3e 3e20 6e6f 726d 616c 697a 655f 6368  >>> normalize_ch
-00018400: 756e 6b73 2828 2832 2c20 322c 2031 292c  unks(((2, 2, 1),
-00018410: 2028 322c 2032 2c20 3229 292c 2073 6861   (2, 2, 2)), sha
-00018420: 7065 3d28 352c 2036 2929 0a20 2020 2028  pe=(5, 6)).    (
-00018430: 2832 2c20 322c 2031 292c 2028 322c 2032  (2, 2, 1), (2, 2
-00018440: 2c20 3229 290a 0a20 2020 2043 6c65 616e  , 2))..    Clean
-00018450: 7320 7570 206c 6973 7473 2074 6f20 7475  s up lists to tu
-00018460: 706c 6573 0a0a 2020 2020 3e3e 3e20 6e6f  ples..    >>> no
-00018470: 726d 616c 697a 655f 6368 756e 6b73 285b  rmalize_chunks([
-00018480: 5b32 2c20 325d 2c20 5b33 2c20 335d 5d29  [2, 2], [3, 3]])
-00018490: 0a20 2020 2028 2832 2c20 3229 2c20 2833  .    ((2, 2), (3
-000184a0: 2c20 3329 290a 0a20 2020 2045 7870 616e  , 3))..    Expan
-000184b0: 6473 2069 6e74 6567 6572 2069 6e70 7574  ds integer input
-000184c0: 7320 3130 202d 3e20 2831 302c 2031 3029  s 10 -> (10, 10)
-000184d0: 0a0a 2020 2020 3e3e 3e20 6e6f 726d 616c  ..    >>> normal
-000184e0: 697a 655f 6368 756e 6b73 2831 302c 2073  ize_chunks(10, s
-000184f0: 6861 7065 3d28 3330 2c20 3529 290a 2020  hape=(30, 5)).  
-00018500: 2020 2828 3130 2c20 3130 2c20 3130 292c    ((10, 10, 10),
-00018510: 2028 352c 2929 0a0a 2020 2020 4578 7061   (5,))..    Expa
-00018520: 6e64 7320 6469 6374 2069 6e70 7574 730a  nds dict inputs.
-00018530: 0a20 2020 203e 3e3e 206e 6f72 6d61 6c69  .    >>> normali
-00018540: 7a65 5f63 6875 6e6b 7328 7b30 3a20 322c  ze_chunks({0: 2,
-00018550: 2031 3a20 337d 2c20 7368 6170 653d 2836   1: 3}, shape=(6
-00018560: 2c20 3629 290a 2020 2020 2828 322c 2032  , 6)).    ((2, 2
-00018570: 2c20 3229 2c20 2833 2c20 3329 290a 0a20  , 2), (3, 3)).. 
-00018580: 2020 2054 6865 2076 616c 7565 7320 2d31     The values -1
-00018590: 2061 6e64 204e 6f6e 6520 6765 7420 6d61   and None get ma
-000185a0: 7070 6564 2074 6f20 6675 6c6c 2073 697a  pped to full siz
-000185b0: 650a 0a20 2020 203e 3e3e 206e 6f72 6d61  e..    >>> norma
-000185c0: 6c69 7a65 5f63 6875 6e6b 7328 2835 2c20  lize_chunks((5, 
-000185d0: 2d31 292c 2073 6861 7065 3d28 3130 2c20  -1), shape=(10, 
-000185e0: 3130 2929 0a20 2020 2028 2835 2c20 3529  10)).    ((5, 5)
-000185f0: 2c20 2831 302c 2929 0a0a 2020 2020 5573  , (10,))..    Us
-00018600: 6520 7468 6520 7661 6c75 6520 2261 7574  e the value "aut
-00018610: 6f22 2074 6f20 6175 746f 6d61 7469 6361  o" to automatica
-00018620: 6c6c 7920 6465 7465 726d 696e 6520 6368  lly determine ch
-00018630: 756e 6b20 7369 7a65 7320 616c 6f6e 6720  unk sizes along 
-00018640: 6365 7274 6169 6e0a 2020 2020 6469 6d65  certain.    dime
-00018650: 6e73 696f 6e73 2e20 2054 6869 7320 7573  nsions.  This us
-00018660: 6573 2074 6865 2060 606c 696d 6974 3d60  es the ``limit=`
-00018670: 6020 616e 6420 6060 6474 7970 653d 6060  ` and ``dtype=``
-00018680: 206b 6579 776f 7264 7320 746f 0a20 2020   keywords to.   
-00018690: 2064 6574 6572 6d69 6e65 2068 6f77 206c   determine how l
-000186a0: 6172 6765 2074 6f20 6d61 6b65 2074 6865  arge to make the
-000186b0: 2063 6875 6e6b 732e 2020 5468 6520 7465   chunks.  The te
-000186c0: 726d 2022 6175 746f 2220 6361 6e20 6265  rm "auto" can be
-000186d0: 2075 7365 640a 2020 2020 616e 7977 6865   used.    anywhe
-000186e0: 7265 2061 6e20 696e 7465 6765 7220 6361  re an integer ca
-000186f0: 6e20 6265 2075 7365 642e 2020 5365 6520  n be used.  See 
-00018700: 6172 7261 7920 6368 756e 6b69 6e67 2064  array chunking d
-00018710: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
-00018720: 206d 6f72 650a 2020 2020 696e 666f 726d   more.    inform
-00018730: 6174 696f 6e2e 0a0a 2020 2020 3e3e 3e20  ation...    >>> 
-00018740: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
-00018750: 2828 2261 7574 6f22 2c29 2c20 7368 6170  (("auto",), shap
-00018760: 653d 2832 302c 292c 206c 696d 6974 3d35  e=(20,), limit=5
-00018770: 2c20 6474 7970 653d 2775 696e 7438 2729  , dtype='uint8')
-00018780: 0a20 2020 2028 2835 2c20 352c 2035 2c20  .    ((5, 5, 5, 
-00018790: 3529 2c29 0a0a 2020 2020 596f 7520 6361  5),)..    You ca
-000187a0: 6e20 616c 736f 2075 7365 2062 7974 6520  n also use byte 
-000187b0: 7369 7a65 7320 2873 6565 203a 6675 6e63  sizes (see :func
-000187c0: 3a60 6461 736b 2e75 7469 6c73 2e70 6172  :`dask.utils.par
-000187d0: 7365 5f62 7974 6573 6029 2069 6e20 706c  se_bytes`) in pl
-000187e0: 6163 6520 6f66 0a20 2020 2022 6175 746f  ace of.    "auto
-000187f0: 2220 746f 2061 736b 2066 6f72 2061 2070  " to ask for a p
-00018800: 6172 7469 6375 6c61 7220 7369 7a65 0a0a  articular size..
-00018810: 2020 2020 3e3e 3e20 6e6f 726d 616c 697a      >>> normaliz
-00018820: 655f 6368 756e 6b73 2822 316b 6942 222c  e_chunks("1kiB",
-00018830: 2073 6861 7065 3d28 3230 3030 2c29 2c20   shape=(2000,), 
-00018840: 6474 7970 653d 2766 6c6f 6174 3332 2729  dtype='float32')
-00018850: 0a20 2020 2028 2832 3536 2c20 3235 362c  .    ((256, 256,
-00018860: 2032 3536 2c20 3235 362c 2032 3536 2c20   256, 256, 256, 
-00018870: 3235 362c 2032 3536 2c20 3230 3829 2c29  256, 256, 208),)
-00018880: 0a0a 2020 2020 5265 7370 6563 7473 206e  ..    Respects n
-00018890: 756c 6c20 6469 6d65 6e73 696f 6e73 0a0a  ull dimensions..
-000188a0: 2020 2020 3e3e 3e20 6e6f 726d 616c 697a      >>> normaliz
-000188b0: 655f 6368 756e 6b73 2828 292c 2073 6861  e_chunks((), sha
-000188c0: 7065 3d28 302c 2030 2929 0a20 2020 2028  pe=(0, 0)).    (
-000188d0: 2830 2c29 2c20 2830 2c29 290a 2020 2020  (0,), (0,)).    
-000188e0: 2222 220a 2020 2020 6966 2064 7479 7065  """.    if dtype
-000188f0: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-00018900: 6e63 6528 6474 7970 652c 206e 702e 6474  nce(dtype, np.dt
-00018910: 7970 6529 3a0a 2020 2020 2020 2020 6474  ype):.        dt
-00018920: 7970 6520 3d20 6e70 2e64 7479 7065 2864  ype = np.dtype(d
-00018930: 7479 7065 290a 2020 2020 6966 2063 6875  type).    if chu
-00018940: 6e6b 7320 6973 204e 6f6e 653a 0a20 2020  nks is None:.   
-00018950: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00018960: 4572 726f 7228 4348 554e 4b53 5f4e 4f4e  Error(CHUNKS_NON
-00018970: 455f 4552 524f 525f 4d45 5353 4147 4529  E_ERROR_MESSAGE)
-00018980: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00018990: 6365 2863 6875 6e6b 732c 206c 6973 7429  ce(chunks, list)
-000189a0: 3a0a 2020 2020 2020 2020 6368 756e 6b73  :.        chunks
-000189b0: 203d 2074 7570 6c65 2863 6875 6e6b 7329   = tuple(chunks)
-000189c0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-000189d0: 6365 2863 6875 6e6b 732c 2028 4e75 6d62  ce(chunks, (Numb
-000189e0: 6572 2c20 7374 7229 293a 0a20 2020 2020  er, str)):.     
-000189f0: 2020 2063 6875 6e6b 7320 3d20 2863 6875     chunks = (chu
-00018a00: 6e6b 732c 2920 2a20 6c65 6e28 7368 6170  nks,) * len(shap
-00018a10: 6529 0a20 2020 2069 6620 6973 696e 7374  e).    if isinst
-00018a20: 616e 6365 2863 6875 6e6b 732c 2064 6963  ance(chunks, dic
-00018a30: 7429 3a0a 2020 2020 2020 2020 6368 756e  t):.        chun
-00018a40: 6b73 203d 2074 7570 6c65 2863 6875 6e6b  ks = tuple(chunk
-00018a50: 732e 6765 7428 692c 204e 6f6e 6529 2066  s.get(i, None) f
-00018a60: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00018a70: 6e28 7368 6170 6529 2929 0a20 2020 2069  n(shape))).    i
-00018a80: 6620 6973 696e 7374 616e 6365 2863 6875  f isinstance(chu
-00018a90: 6e6b 732c 206e 702e 6e64 6172 7261 7929  nks, np.ndarray)
-00018aa0: 3a0a 2020 2020 2020 2020 6368 756e 6b73  :.        chunks
-00018ab0: 203d 2063 6875 6e6b 732e 746f 6c69 7374   = chunks.tolist
-00018ac0: 2829 0a20 2020 2069 6620 6e6f 7420 6368  ().    if not ch
-00018ad0: 756e 6b73 2061 6e64 2073 6861 7065 2061  unks and shape a
-00018ae0: 6e64 2061 6c6c 2873 203d 3d20 3020 666f  nd all(s == 0 fo
-00018af0: 7220 7320 696e 2073 6861 7065 293a 0a20  r s in shape):. 
-00018b00: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
-00018b10: 2828 302c 292c 2920 2a20 6c65 6e28 7368  ((0,),) * len(sh
-00018b20: 6170 6529 0a0a 2020 2020 6966 2028 0a20  ape)..    if (. 
-00018b30: 2020 2020 2020 2073 6861 7065 0a20 2020         shape.   
-00018b40: 2020 2020 2061 6e64 206c 656e 2873 6861       and len(sha
-00018b50: 7065 2920 3d3d 2031 0a20 2020 2020 2020  pe) == 1.       
-00018b60: 2061 6e64 206c 656e 2863 6875 6e6b 7329   and len(chunks)
-00018b70: 203e 2031 0a20 2020 2020 2020 2061 6e64   > 1.        and
-00018b80: 2061 6c6c 2869 7369 6e73 7461 6e63 6528   all(isinstance(
-00018b90: 632c 2028 4e75 6d62 6572 2c20 7374 7229  c, (Number, str)
-00018ba0: 2920 666f 7220 6320 696e 2063 6875 6e6b  ) for c in chunk
-00018bb0: 7329 0a20 2020 2029 3a0a 2020 2020 2020  s).    ):.      
-00018bc0: 2020 6368 756e 6b73 203d 2028 6368 756e    chunks = (chun
-00018bd0: 6b73 2c29 0a0a 2020 2020 6966 2073 6861  ks,)..    if sha
-00018be0: 7065 2061 6e64 206c 656e 2863 6875 6e6b  pe and len(chunk
-00018bf0: 7329 2021 3d20 6c65 6e28 7368 6170 6529  s) != len(shape)
-00018c00: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00018c10: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00018c20: 2020 2020 2020 2020 2243 6875 6e6b 7320          "Chunks 
-00018c30: 616e 6420 7368 6170 6520 6d75 7374 2062  and shape must b
-00018c40: 6520 6f66 2074 6865 2073 616d 6520 6c65  e of the same le
-00018c50: 6e67 7468 2f64 696d 656e 7369 6f6e 2e20  ngth/dimension. 
-00018c60: 220a 2020 2020 2020 2020 2020 2020 2247  ".            "G
-00018c70: 6f74 2063 6875 6e6b 733d 2573 2c20 7368  ot chunks=%s, sh
-00018c80: 6170 653d 2573 2220 2520 2863 6875 6e6b  ape=%s" % (chunk
-00018c90: 732c 2073 6861 7065 290a 2020 2020 2020  s, shape).      
-00018ca0: 2020 290a 2020 2020 6966 202d 3120 696e    ).    if -1 in
-00018cb0: 2063 6875 6e6b 7320 6f72 204e 6f6e 6520   chunks or None 
-00018cc0: 696e 2063 6875 6e6b 733a 0a20 2020 2020  in chunks:.     
-00018cd0: 2020 2063 6875 6e6b 7320 3d20 7475 706c     chunks = tupl
-00018ce0: 6528 7320 6966 2063 203d 3d20 2d31 206f  e(s if c == -1 o
-00018cf0: 7220 6320 6973 204e 6f6e 6520 656c 7365  r c is None else
-00018d00: 2063 2066 6f72 2063 2c20 7320 696e 207a   c for c, s in z
-00018d10: 6970 2863 6875 6e6b 732c 2073 6861 7065  ip(chunks, shape
-00018d20: 2929 0a0a 2020 2020 2320 4966 2073 7065  ))..    # If spe
-00018d30: 6369 6679 696e 6720 6368 756e 6b20 7369  cifying chunk si
-00018d40: 7a65 2069 6e20 6279 7465 732c 2075 7365  ze in bytes, use
-00018d50: 2074 6861 7420 7661 6c75 6520 746f 2073   that value to s
-00018d60: 6574 2074 6865 206c 696d 6974 2e0a 2020  et the limit..  
-00018d70: 2020 2320 5665 7269 6679 2074 6865 7265    # Verify there
-00018d80: 2069 7320 6f6e 6c79 206f 6e65 2063 6f6e   is only one con
-00018d90: 7369 7374 656e 7420 7661 6c75 6520 6f66  sistent value of
-00018da0: 206c 696d 6974 206f 7220 6368 756e 6b2d   limit or chunk-
-00018db0: 6279 7465 7320 7573 6564 2e0a 2020 2020  bytes used..    
-00018dc0: 666f 7220 6320 696e 2063 6875 6e6b 733a  for c in chunks:
-00018dd0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00018de0: 7374 616e 6365 2863 2c20 7374 7229 2061  stance(c, str) a
-00018df0: 6e64 2063 2021 3d20 2261 7574 6f22 3a0a  nd c != "auto":.
-00018e00: 2020 2020 2020 2020 2020 2020 7061 7273              pars
-00018e10: 6564 203d 2070 6172 7365 5f62 7974 6573  ed = parse_bytes
-00018e20: 2863 290a 2020 2020 2020 2020 2020 2020  (c).            
-00018e30: 6966 206c 696d 6974 2069 7320 4e6f 6e65  if limit is None
-00018e40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018e50: 2020 6c69 6d69 7420 3d20 7061 7273 6564    limit = parsed
-00018e60: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00018e70: 6620 7061 7273 6564 2021 3d20 6c69 6d69  f parsed != limi
-00018e80: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00018e90: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00018ea0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00018eb0: 2020 2020 2020 2020 2022 4f6e 6c79 206f           "Only o
-00018ec0: 6e65 2063 6f6e 7369 7374 656e 7420 7661  ne consistent va
-00018ed0: 6c75 6520 6f66 206c 696d 6974 206f 7220  lue of limit or 
-00018ee0: 6368 756e 6b20 6973 2061 6c6c 6f77 6564  chunk is allowed
-00018ef0: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
-00018f00: 2020 2020 2020 2022 5573 6564 2025 7320         "Used %s 
-00018f10: 213d 2025 7322 2025 2028 7061 7273 6564  != %s" % (parsed
-00018f20: 2c20 6c69 6d69 7429 0a20 2020 2020 2020  , limit).       
-00018f30: 2020 2020 2020 2020 2029 0a20 2020 2023           ).    #
-00018f40: 2053 7562 7374 6974 7574 6520 6279 7465   Substitute byte
-00018f50: 206c 696d 6974 7320 7769 7468 2027 6175   limits with 'au
-00018f60: 746f 2720 6e6f 7720 7468 6174 206c 696d  to' now that lim
-00018f70: 6974 2069 7320 7365 742e 0a20 2020 2063  it is set..    c
-00018f80: 6875 6e6b 7320 3d20 7475 706c 6528 2261  hunks = tuple("a
-00018f90: 7574 6f22 2069 6620 6973 696e 7374 616e  uto" if isinstan
-00018fa0: 6365 2863 2c20 7374 7229 2061 6e64 2063  ce(c, str) and c
-00018fb0: 2021 3d20 2261 7574 6f22 2065 6c73 6520   != "auto" else 
-00018fc0: 6320 666f 7220 6320 696e 2063 6875 6e6b  c for c in chunk
-00018fd0: 7329 0a0a 2020 2020 6966 2061 6e79 2863  s)..    if any(c
-00018fe0: 203d 3d20 2261 7574 6f22 2066 6f72 2063   == "auto" for c
-00018ff0: 2069 6e20 6368 756e 6b73 293a 0a20 2020   in chunks):.   
-00019000: 2020 2020 2063 6875 6e6b 7320 3d20 6175       chunks = au
-00019010: 746f 5f63 6875 6e6b 7328 6368 756e 6b73  to_chunks(chunks
-00019020: 2c20 7368 6170 652c 206c 696d 6974 2c20  , shape, limit, 
-00019030: 6474 7970 652c 2070 7265 7669 6f75 735f  dtype, previous_
-00019040: 6368 756e 6b73 290a 0a20 2020 2069 6620  chunks)..    if 
-00019050: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
-00019060: 653a 0a20 2020 2020 2020 2063 6875 6e6b  e:.        chunk
-00019070: 7320 3d20 7475 706c 6528 6320 6966 2063  s = tuple(c if c
-00019080: 206e 6f74 2069 6e20 7b4e 6f6e 652c 202d   not in {None, -
-00019090: 317d 2065 6c73 6520 7320 666f 7220 632c  1} else s for c,
-000190a0: 2073 2069 6e20 7a69 7028 6368 756e 6b73   s in zip(chunks
-000190b0: 2c20 7368 6170 6529 290a 0a20 2020 2061  , shape))..    a
-000190c0: 6c6c 696e 7473 203d 204e 6f6e 650a 2020  llints = None.  
-000190d0: 2020 6966 2063 6875 6e6b 7320 616e 6420    if chunks and 
-000190e0: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
-000190f0: 653a 0a20 2020 2020 2020 2023 2061 6c6c  e:.        # all
-00019100: 696e 7473 3a20 6469 6420 7765 2073 7461  ints: did we sta
-00019110: 7274 2077 6974 6820 6368 756e 6b73 2061  rt with chunks a
-00019120: 7320 6120 7369 6d70 6c65 2074 7570 6c65  s a simple tuple
-00019130: 206f 6620 696e 7473 3f0a 2020 2020 2020   of ints?.      
-00019140: 2020 616c 6c69 6e74 7320 3d20 616c 6c28    allints = all(
-00019150: 6973 696e 7374 616e 6365 2863 2c20 696e  isinstance(c, in
-00019160: 7429 2066 6f72 2063 2069 6e20 6368 756e  t) for c in chun
-00019170: 6b73 290a 2020 2020 2020 2020 6368 756e  ks).        chun
-00019180: 6b73 203d 2073 756d 280a 2020 2020 2020  ks = sum(.      
-00019190: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-000191a0: 2020 2020 2020 2020 626c 6f63 6b64 696d          blockdim
-000191b0: 735f 6672 6f6d 5f62 6c6f 636b 7368 6170  s_from_blockshap
-000191c0: 6528 2873 2c29 2c20 2863 2c29 290a 2020  e((s,), (c,)).  
-000191d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000191e0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000191f0: 632c 2028 7475 706c 652c 206c 6973 7429  c, (tuple, list)
-00019200: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00019210: 2020 656c 7365 2028 632c 290a 2020 2020    else (c,).    
-00019220: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00019230: 732c 2063 2069 6e20 7a69 7028 7368 6170  s, c in zip(shap
-00019240: 652c 2063 6875 6e6b 7329 0a20 2020 2020  e, chunks).     
-00019250: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00019260: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
-00019270: 2020 290a 2020 2020 666f 7220 6320 696e    ).    for c in
-00019280: 2063 6875 6e6b 733a 0a20 2020 2020 2020   chunks:.       
-00019290: 2069 6620 6e6f 7420 633a 0a20 2020 2020   if not c:.     
-000192a0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000192b0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-000192c0: 2020 2020 2020 2020 2022 456d 7074 7920           "Empty 
-000192d0: 7475 706c 6573 2061 7265 206e 6f74 2061  tuples are not a
-000192e0: 6c6c 6f77 6564 2069 6e20 6368 756e 6b73  llowed in chunks
-000192f0: 2e20 4578 7072 6573 7320 220a 2020 2020  . Express ".    
-00019300: 2020 2020 2020 2020 2020 2020 227a 6572              "zer
-00019310: 6f20 6c65 6e67 7468 2064 696d 656e 7369  o length dimensi
-00019320: 6f6e 7320 7769 7468 2030 2873 2920 696e  ons with 0(s) in
-00019330: 2063 6875 6e6b 7322 0a20 2020 2020 2020   chunks".       
-00019340: 2020 2020 2029 0a0a 2020 2020 6966 2073       )..    if s
-00019350: 6861 7065 2069 7320 6e6f 7420 4e6f 6e65  hape is not None
-00019360: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
-00019370: 2863 6875 6e6b 7329 2021 3d20 6c65 6e28  (chunks) != len(
-00019380: 7368 6170 6529 3a0a 2020 2020 2020 2020  shape):.        
-00019390: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000193a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-000193b0: 2020 2020 2020 2249 6e70 7574 2061 7272        "Input arr
-000193c0: 6179 2068 6173 2025 6420 6469 6d65 6e73  ay has %d dimens
-000193d0: 696f 6e73 2062 7574 2074 6865 2073 7570  ions but the sup
-000193e0: 706c 6965 6420 220a 2020 2020 2020 2020  plied ".        
-000193f0: 2020 2020 2020 2020 2263 6875 6e6b 7320          "chunks 
-00019400: 6861 7320 6f6e 6c79 2025 6420 6469 6d65  has only %d dime
-00019410: 6e73 696f 6e73 2220 2520 286c 656e 2873  nsions" % (len(s
-00019420: 6861 7065 292c 206c 656e 2863 6875 6e6b  hape), len(chunk
-00019430: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
-00019440: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
-00019450: 2061 6c6c 280a 2020 2020 2020 2020 2020   all(.          
-00019460: 2020 6320 3d3d 2073 206f 7220 286d 6174    c == s or (mat
-00019470: 682e 6973 6e61 6e28 6329 206f 7220 6d61  h.isnan(c) or ma
-00019480: 7468 2e69 736e 616e 2873 2929 0a20 2020  th.isnan(s)).   
-00019490: 2020 2020 2020 2020 2066 6f72 2063 2c20           for c, 
-000194a0: 7320 696e 207a 6970 286d 6170 2873 756d  s in zip(map(sum
-000194b0: 2c20 6368 756e 6b73 292c 2073 6861 7065  , chunks), shape
-000194c0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-000194d0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000194e0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-000194f0: 2020 2020 2020 2020 2020 2022 4368 756e             "Chun
-00019500: 6b73 2064 6f20 6e6f 7420 6164 6420 7570  ks do not add up
-00019510: 2074 6f20 7368 6170 652e 2022 0a20 2020   to shape. ".   
-00019520: 2020 2020 2020 2020 2020 2020 2022 476f               "Go
-00019530: 7420 6368 756e 6b73 3d25 732c 2073 6861  t chunks=%s, sha
-00019540: 7065 3d25 7322 2025 2028 6368 756e 6b73  pe=%s" % (chunks
-00019550: 2c20 7368 6170 6529 0a20 2020 2020 2020  , shape).       
-00019560: 2020 2020 2029 0a20 2020 2069 6620 616c       ).    if al
-00019570: 6c69 6e74 7320 6f72 2069 7369 6e73 7461  lints or isinsta
-00019580: 6e63 6528 7375 6d28 7375 6d28 5f29 2066  nce(sum(sum(_) f
-00019590: 6f72 205f 2069 6e20 6368 756e 6b73 292c  or _ in chunks),
-000195a0: 2069 6e74 293a 0a20 2020 2020 2020 2023   int):.        #
-000195b0: 2046 6173 7470 6174 6820 666f 7220 7768   Fastpath for wh
-000195c0: 656e 2077 6520 616c 7265 6164 7920 6b6e  en we already kn
-000195d0: 6f77 2063 6875 6e6b 7320 636f 6e74 6169  ow chunks contai
-000195e0: 6e73 206f 6e6c 7920 696e 7465 6765 7273  ns only integers
-000195f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00019600: 7475 706c 6528 7475 706c 6528 6368 2920  tuple(tuple(ch) 
-00019610: 666f 7220 6368 2069 6e20 6368 756e 6b73  for ch in chunks
-00019620: 290a 2020 2020 7265 7475 726e 2074 7570  ).    return tup
-00019630: 6c65 280a 2020 2020 2020 2020 7475 706c  le(.        tupl
-00019640: 6528 696e 7428 7829 2069 6620 6e6f 7420  e(int(x) if not 
-00019650: 6d61 7468 2e69 736e 616e 2878 2920 656c  math.isnan(x) el
-00019660: 7365 206e 702e 6e61 6e20 666f 7220 7820  se np.nan for x 
-00019670: 696e 2063 2920 666f 7220 6320 696e 2063  in c) for c in c
-00019680: 6875 6e6b 730a 2020 2020 290a 0a0a 6465  hunks.    )...de
-00019690: 6620 5f63 6f6d 7075 7465 5f6d 756c 7469  f _compute_multi
-000196a0: 706c 6965 7228 6c69 6d69 743a 2069 6e74  plier(limit: int
-000196b0: 2c20 6474 7970 652c 206c 6172 6765 7374  , dtype, largest
-000196c0: 5f62 6c6f 636b 3a20 696e 742c 2072 6573  _block: int, res
-000196d0: 756c 7429 3a0a 2020 2020 2222 220a 2020  ult):.    """.  
-000196e0: 2020 5574 696c 6974 7920 6675 6e63 7469    Utility functi
-000196f0: 6f6e 2066 6f72 2061 7574 6f5f 6368 756e  on for auto_chun
-00019700: 6b2c 2074 6f20 6669 6e20 686f 7720 6d75  k, to fin how mu
-00019710: 6368 206c 6172 6765 7220 6f72 2073 6d61  ch larger or sma
-00019720: 6c6c 6572 2074 6865 2069 6465 616c 0a20  ller the ideal. 
-00019730: 2020 2063 6875 6e6b 2073 697a 6520 6973     chunk size is
-00019740: 2072 656c 6174 6976 6520 746f 2077 6861   relative to wha
-00019750: 7420 7765 2068 6176 6520 6e6f 772e 0a20  t we have now.. 
-00019760: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
-00019770: 6e20 280a 2020 2020 2020 2020 6c69 6d69  n (.        limi
-00019780: 740a 2020 2020 2020 2020 2f20 6474 7970  t.        / dtyp
-00019790: 652e 6974 656d 7369 7a65 0a20 2020 2020  e.itemsize.     
-000197a0: 2020 202f 206c 6172 6765 7374 5f62 6c6f     / largest_blo
-000197b0: 636b 0a20 2020 2020 2020 202f 206d 6174  ck.        / mat
-000197c0: 682e 7072 6f64 2872 2066 6f72 2072 2069  h.prod(r for r i
-000197d0: 6e20 7265 7375 6c74 2e76 616c 7565 7328  n result.values(
-000197e0: 2920 6966 2072 290a 2020 2020 290a 0a0a  ) if r).    )...
-000197f0: 6465 6620 6175 746f 5f63 6875 6e6b 7328  def auto_chunks(
-00019800: 6368 756e 6b73 2c20 7368 6170 652c 206c  chunks, shape, l
-00019810: 696d 6974 2c20 6474 7970 652c 2070 7265  imit, dtype, pre
-00019820: 7669 6f75 735f 6368 756e 6b73 3d4e 6f6e  vious_chunks=Non
-00019830: 6529 3a0a 2020 2020 2222 2244 6574 6572  e):.    """Deter
-00019840: 6d69 6e65 2061 7574 6f6d 6174 6963 2063  mine automatic c
-00019850: 6875 6e6b 730a 0a20 2020 2054 6869 7320  hunks..    This 
-00019860: 7461 6b65 7320 696e 2061 2063 6875 6e6b  takes in a chunk
-00019870: 7320 7661 6c75 6520 7468 6174 2063 6f6e  s value that con
-00019880: 7461 696e 7320 6060 2261 7574 6f22 6060  tains ``"auto"``
-00019890: 2076 616c 7565 7320 696e 2063 6572 7461   values in certa
-000198a0: 696e 0a20 2020 2064 696d 656e 7369 6f6e  in.    dimension
-000198b0: 7320 616e 6420 7265 706c 6163 6573 2074  s and replaces t
-000198c0: 686f 7365 2076 616c 7565 7320 7769 7468  hose values with
-000198d0: 2063 6f6e 6372 6574 6520 6469 6d65 6e73   concrete dimens
-000198e0: 696f 6e20 7369 7a65 7320 7468 6174 2074  ion sizes that t
-000198f0: 7279 0a20 2020 2074 6f20 6765 7420 6368  ry.    to get ch
-00019900: 756e 6b73 2074 6f20 6265 206f 6620 6120  unks to be of a 
-00019910: 6365 7274 6169 6e20 7369 7a65 2069 6e20  certain size in 
-00019920: 6279 7465 732c 2070 726f 7669 6465 6420  bytes, provided 
-00019930: 6279 2074 6865 2060 606c 696d 6974 3d60  by the ``limit=`
-00019940: 600a 2020 2020 6b65 7977 6f72 642e 2020  `.    keyword.  
-00019950: 4966 206d 756c 7469 706c 6520 6469 6d65  If multiple dime
-00019960: 6e73 696f 6e73 2061 7265 206d 6172 6b65  nsions are marke
-00019970: 6420 6173 2060 6022 6175 746f 2260 6020  d as ``"auto"`` 
-00019980: 7468 656e 2074 6865 7920 7769 6c6c 0a20  then they will. 
-00019990: 2020 2061 6c6c 2072 6573 706f 6e64 2074     all respond t
-000199a0: 6f20 6d65 6574 2074 6865 2064 6573 6972  o meet the desir
-000199b0: 6564 2062 7974 6520 6c69 6d69 742c 2074  ed byte limit, t
-000199c0: 7279 696e 6720 746f 2072 6573 7065 6374  rying to respect
-000199d0: 2074 6865 2061 7370 6563 740a 2020 2020   the aspect.    
-000199e0: 7261 7469 6f20 6f66 2074 6865 6972 2064  ratio of their d
-000199f0: 696d 656e 7369 6f6e 7320 696e 2060 6070  imensions in ``p
-00019a00: 7265 7669 6f75 735f 6368 756e 6b73 3d60  revious_chunks=`
-00019a10: 602c 2069 6620 6769 7665 6e2e 0a0a 2020  `, if given...  
-00019a20: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00019a30: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00019a40: 6368 756e 6b73 3a20 5475 706c 650a 2020  chunks: Tuple.  
-00019a50: 2020 2020 2020 4120 7475 706c 6520 6f66        A tuple of
-00019a60: 2065 6974 6865 7220 6469 6d65 6e73 696f   either dimensio
-00019a70: 6e73 206f 7220 7475 706c 6573 206f 6620  ns or tuples of 
-00019a80: 6578 706c 6963 6974 2063 6875 6e6b 2064  explicit chunk d
-00019a90: 696d 656e 7369 6f6e 730a 2020 2020 2020  imensions.      
-00019aa0: 2020 536f 6d65 2065 6e74 7269 6573 2073    Some entries s
-00019ab0: 686f 756c 6420 6265 2022 6175 746f 220a  hould be "auto".
-00019ac0: 2020 2020 7368 6170 653a 2054 7570 6c65      shape: Tuple
-00019ad0: 5b69 6e74 5d0a 2020 2020 6c69 6d69 743a  [int].    limit:
-00019ae0: 2069 6e74 2c20 7374 720a 2020 2020 2020   int, str.      
-00019af0: 2020 5468 6520 6d61 7869 6d75 6d20 616c    The maximum al
-00019b00: 6c6f 7761 626c 6520 7369 7a65 206f 6620  lowable size of 
-00019b10: 6120 6368 756e 6b20 696e 2062 7974 6573  a chunk in bytes
-00019b20: 0a20 2020 2070 7265 7669 6f75 735f 6368  .    previous_ch
-00019b30: 756e 6b73 3a20 5475 706c 655b 5475 706c  unks: Tuple[Tupl
-00019b40: 655b 696e 745d 5d0a 0a20 2020 2053 6565  e[int]]..    See
-00019b50: 2061 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   also.    ------
-00019b60: 2d2d 0a20 2020 206e 6f72 6d61 6c69 7a65  --.    normalize
-00019b70: 5f63 6875 6e6b 733a 2066 6f72 2066 756c  _chunks: for ful
-00019b80: 6c20 646f 6373 7472 696e 6720 616e 6420  l docstring and 
-00019b90: 7061 7261 6d65 7465 7273 0a20 2020 2022  parameters.    "
-00019ba0: 2222 0a20 2020 2069 6620 7072 6576 696f  "".    if previo
-00019bb0: 7573 5f63 6875 6e6b 7320 6973 206e 6f74  us_chunks is not
-00019bc0: 204e 6f6e 653a 0a20 2020 2020 2020 2070   None:.        p
-00019bd0: 7265 7669 6f75 735f 6368 756e 6b73 203d  revious_chunks =
-00019be0: 2074 7570 6c65 280a 2020 2020 2020 2020   tuple(.        
-00019bf0: 2020 2020 6320 6966 2069 7369 6e73 7461      c if isinsta
-00019c00: 6e63 6528 632c 2074 7570 6c65 2920 656c  nce(c, tuple) el
-00019c10: 7365 2028 632c 2920 666f 7220 6320 696e  se (c,) for c in
-00019c20: 2070 7265 7669 6f75 735f 6368 756e 6b73   previous_chunks
-00019c30: 0a20 2020 2020 2020 2029 0a20 2020 2063  .        ).    c
-00019c40: 6875 6e6b 7320 3d20 6c69 7374 2863 6875  hunks = list(chu
-00019c50: 6e6b 7329 0a0a 2020 2020 6175 746f 7320  nks)..    autos 
-00019c60: 3d20 7b69 2066 6f72 2069 2c20 6320 696e  = {i for i, c in
-00019c70: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
-00019c80: 7329 2069 6620 6320 3d3d 2022 6175 746f  s) if c == "auto
-00019c90: 227d 0a20 2020 2069 6620 6e6f 7420 6175  "}.    if not au
-00019ca0: 746f 733a 0a20 2020 2020 2020 2072 6574  tos:.        ret
-00019cb0: 7572 6e20 7475 706c 6528 6368 756e 6b73  urn tuple(chunks
-00019cc0: 290a 0a20 2020 2069 6620 6c69 6d69 7420  )..    if limit 
-00019cd0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00019ce0: 206c 696d 6974 203d 2063 6f6e 6669 672e   limit = config.
-00019cf0: 6765 7428 2261 7272 6179 2e63 6875 6e6b  get("array.chunk
-00019d00: 2d73 697a 6522 290a 2020 2020 6966 2069  -size").    if i
-00019d10: 7369 6e73 7461 6e63 6528 6c69 6d69 742c  sinstance(limit,
-00019d20: 2073 7472 293a 0a20 2020 2020 2020 206c   str):.        l
-00019d30: 696d 6974 203d 2070 6172 7365 5f62 7974  imit = parse_byt
-00019d40: 6573 286c 696d 6974 290a 0a20 2020 2069  es(limit)..    i
-00019d50: 6620 6474 7970 6520 6973 204e 6f6e 653a  f dtype is None:
-00019d60: 0a20 2020 2020 2020 2072 6169 7365 2054  .        raise T
-00019d70: 7970 6545 7272 6f72 2822 6474 7970 6520  ypeError("dtype 
-00019d80: 6d75 7374 2062 6520 6b6e 6f77 6e20 666f  must be known fo
-00019d90: 7220 6175 746f 2d63 6875 6e6b 696e 6722  r auto-chunking"
-00019da0: 290a 0a20 2020 2069 6620 6474 7970 652e  )..    if dtype.
-00019db0: 6861 736f 626a 6563 743a 0a20 2020 2020  hasobject:.     
-00019dc0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00019dd0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00019de0: 2020 2020 2020 2020 2020 2243 616e 206e            "Can n
-00019df0: 6f74 2075 7365 2061 7574 6f20 7265 6368  ot use auto rech
-00019e00: 756e 6b69 6e67 2077 6974 6820 6f62 6a65  unking with obje
-00019e10: 6374 2064 7479 7065 2e20 220a 2020 2020  ct dtype. ".    
-00019e20: 2020 2020 2020 2020 2257 6520 6172 6520          "We are 
-00019e30: 756e 6162 6c65 2074 6f20 6573 7469 6d61  unable to estima
-00019e40: 7465 2074 6865 2073 697a 6520 696e 2062  te the size in b
-00019e50: 7974 6573 206f 6620 6f62 6a65 6374 2064  ytes of object d
-00019e60: 6174 6122 0a20 2020 2020 2020 2029 0a0a  ata".        )..
-00019e70: 2020 2020 666f 7220 7820 696e 2074 7570      for x in tup
-00019e80: 6c65 2863 6875 6e6b 7329 202b 2074 7570  le(chunks) + tup
-00019e90: 6c65 2873 6861 7065 293a 0a20 2020 2020  le(shape):.     
-00019ea0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-00019eb0: 2020 2020 6973 696e 7374 616e 6365 2878      isinstance(x
-00019ec0: 2c20 4e75 6d62 6572 290a 2020 2020 2020  , Number).      
-00019ed0: 2020 2020 2020 616e 6420 6e70 2e69 736e        and np.isn
-00019ee0: 616e 2878 290a 2020 2020 2020 2020 2020  an(x).          
-00019ef0: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
-00019f00: 782c 2074 7570 6c65 290a 2020 2020 2020  x, tuple).      
-00019f10: 2020 2020 2020 616e 6420 6e70 2e69 736e        and np.isn
-00019f20: 616e 2878 292e 616e 7928 290a 2020 2020  an(x).any().    
-00019f30: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00019f40: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00019f50: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00019f60: 2020 2020 2022 4361 6e20 6e6f 7420 7065       "Can not pe
-00019f70: 7266 6f72 6d20 6175 746f 6d61 7469 6320  rform automatic 
-00019f80: 7265 6368 756e 6b69 6e67 2077 6974 6820  rechunking with 
-00019f90: 756e 6b6e 6f77 6e20 220a 2020 2020 2020  unknown ".      
-00019fa0: 2020 2020 2020 2020 2020 2228 6e61 6e29            "(nan)
-00019fb0: 2063 6875 6e6b 2073 697a 6573 2e25 7322   chunk sizes.%s"
-00019fc0: 2025 2075 6e6b 6e6f 776e 5f63 6875 6e6b   % unknown_chunk
-00019fd0: 5f6d 6573 7361 6765 0a20 2020 2020 2020  _message.       
-00019fe0: 2020 2020 2029 0a0a 2020 2020 6c69 6d69       )..    limi
-00019ff0: 7420 3d20 6d61 7828 312c 206c 696d 6974  t = max(1, limit
-0001a000: 290a 0a20 2020 206c 6172 6765 7374 5f62  )..    largest_b
-0001a010: 6c6f 636b 203d 206d 6174 682e 7072 6f64  lock = math.prod
-0001a020: 280a 2020 2020 2020 2020 6373 2069 6620  (.        cs if 
-0001a030: 6973 696e 7374 616e 6365 2863 732c 204e  isinstance(cs, N
-0001a040: 756d 6265 7229 2065 6c73 6520 6d61 7828  umber) else max(
-0001a050: 6373 2920 666f 7220 6373 2069 6e20 6368  cs) for cs in ch
-0001a060: 756e 6b73 2069 6620 6373 2021 3d20 2261  unks if cs != "a
-0001a070: 7574 6f22 0a20 2020 2029 0a0a 2020 2020  uto".    )..    
-0001a080: 6966 2070 7265 7669 6f75 735f 6368 756e  if previous_chun
-0001a090: 6b73 3a0a 2020 2020 2020 2020 2320 4261  ks:.        # Ba
-0001a0a0: 7365 2069 6465 616c 2072 6174 696f 206f  se ideal ratio o
-0001a0b0: 6e20 7468 6520 6d65 6469 616e 2063 6875  n the median chu
-0001a0c0: 6e6b 2073 697a 6520 6f66 2074 6865 2070  nk size of the p
-0001a0d0: 7265 7669 6f75 7320 6368 756e 6b73 0a20  revious chunks. 
-0001a0e0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0001a0f0: 7b61 3a20 6e70 2e6d 6564 6961 6e28 7072  {a: np.median(pr
-0001a100: 6576 696f 7573 5f63 6875 6e6b 735b 615d  evious_chunks[a]
-0001a110: 2920 666f 7220 6120 696e 2061 7574 6f73  ) for a in autos
-0001a120: 7d0a 0a20 2020 2020 2020 2069 6465 616c  }..        ideal
-0001a130: 5f73 6861 7065 203d 205b 5d0a 2020 2020  _shape = [].    
-0001a140: 2020 2020 666f 7220 692c 2073 2069 6e20      for i, s in 
-0001a150: 656e 756d 6572 6174 6528 7368 6170 6529  enumerate(shape)
-0001a160: 3a0a 2020 2020 2020 2020 2020 2020 6368  :.            ch
-0001a170: 756e 6b5f 6672 6571 7565 6e63 6965 7320  unk_frequencies 
-0001a180: 3d20 6672 6571 7565 6e63 6965 7328 7072  = frequencies(pr
-0001a190: 6576 696f 7573 5f63 6875 6e6b 735b 695d  evious_chunks[i]
-0001a1a0: 290a 2020 2020 2020 2020 2020 2020 6d6f  ).            mo
-0001a1b0: 6465 2c20 636f 756e 7420 3d20 6d61 7828  de, count = max(
-0001a1c0: 6368 756e 6b5f 6672 6571 7565 6e63 6965  chunk_frequencie
-0001a1d0: 732e 6974 656d 7328 292c 206b 6579 3d6c  s.items(), key=l
-0001a1e0: 616d 6264 6120 6b76 3a20 6b76 5b31 5d29  ambda kv: kv[1])
-0001a1f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001a200: 6d6f 6465 203e 2031 2061 6e64 2063 6f75  mode > 1 and cou
-0001a210: 6e74 203e 3d20 6c65 6e28 7072 6576 696f  nt >= len(previo
-0001a220: 7573 5f63 6875 6e6b 735b 695d 2920 2f20  us_chunks[i]) / 
-0001a230: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-0001a240: 2020 2069 6465 616c 5f73 6861 7065 2e61     ideal_shape.a
-0001a250: 7070 656e 6428 6d6f 6465 290a 2020 2020  ppend(mode).    
-0001a260: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001a270: 2020 2020 2020 2020 2020 2020 2020 6964                id
-0001a280: 6561 6c5f 7368 6170 652e 6170 7065 6e64  eal_shape.append
-0001a290: 2873 290a 0a20 2020 2020 2020 2023 2048  (s)..        # H
-0001a2a0: 6f77 206d 7563 6820 6c61 7267 6572 206f  ow much larger o
-0001a2b0: 7220 736d 616c 6c65 7220 7468 6520 6964  r smaller the id
-0001a2c0: 6561 6c20 6368 756e 6b20 7369 7a65 2069  eal chunk size i
-0001a2d0: 7320 7265 6c61 7469 7665 2074 6f20 7768  s relative to wh
-0001a2e0: 6174 2077 6520 6861 7665 206e 6f77 0a20  at we have now. 
-0001a2f0: 2020 2020 2020 206d 756c 7469 706c 6965         multiplie
-0001a300: 7220 3d20 5f63 6f6d 7075 7465 5f6d 756c  r = _compute_mul
-0001a310: 7469 706c 6965 7228 6c69 6d69 742c 2064  tiplier(limit, d
-0001a320: 7479 7065 2c20 6c61 7267 6573 745f 626c  type, largest_bl
-0001a330: 6f63 6b2c 2072 6573 756c 7429 0a0a 2020  ock, result)..  
-0001a340: 2020 2020 2020 6c61 7374 5f6d 756c 7469        last_multi
-0001a350: 706c 6965 7220 3d20 300a 2020 2020 2020  plier = 0.      
-0001a360: 2020 6c61 7374 5f61 7574 6f73 203d 2073    last_autos = s
-0001a370: 6574 2829 0a20 2020 2020 2020 2077 6869  et().        whi
-0001a380: 6c65 2028 0a20 2020 2020 2020 2020 2020  le (.           
-0001a390: 206d 756c 7469 706c 6965 7220 213d 206c   multiplier != l
-0001a3a0: 6173 745f 6d75 6c74 6970 6c69 6572 206f  ast_multiplier o
-0001a3b0: 7220 6175 746f 7320 213d 206c 6173 745f  r autos != last_
-0001a3c0: 6175 746f 730a 2020 2020 2020 2020 293a  autos.        ):
-0001a3d0: 2020 2320 7768 696c 6520 7468 696e 6773    # while things
-0001a3e0: 2063 6861 6e67 650a 2020 2020 2020 2020   change.        
-0001a3f0: 2020 2020 6c61 7374 5f6d 756c 7469 706c      last_multipl
-0001a400: 6965 7220 3d20 6d75 6c74 6970 6c69 6572  ier = multiplier
-0001a410: 2020 2320 7265 636f 7264 2070 7265 7669    # record previ
-0001a420: 6f75 7320 7661 6c75 6573 0a20 2020 2020  ous values.     
-0001a430: 2020 2020 2020 206c 6173 745f 6175 746f         last_auto
-0001a440: 7320 3d20 7365 7428 6175 746f 7329 2020  s = set(autos)  
-0001a450: 2320 7265 636f 7264 2070 7265 7669 6f75  # record previou
-0001a460: 7320 7661 6c75 6573 0a0a 2020 2020 2020  s values..      
-0001a470: 2020 2020 2020 2320 4578 7061 6e64 206f        # Expand o
-0001a480: 7220 636f 6e74 7261 6374 2065 6163 6820  r contract each 
-0001a490: 6f66 2074 6865 2064 696d 656e 7369 6f6e  of the dimension
-0001a4a0: 7320 6170 7072 6f70 7269 6174 656c 790a  s appropriately.
-0001a4b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001a4c0: 6120 696e 2073 6f72 7465 6428 6175 746f  a in sorted(auto
-0001a4d0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0001a4e0: 2020 2020 6966 2069 6465 616c 5f73 6861      if ideal_sha
-0001a4f0: 7065 5b61 5d20 3d3d 2030 3a0a 2020 2020  pe[a] == 0:.    
-0001a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a510: 7265 7375 6c74 5b61 5d20 3d20 300a 2020  result[a] = 0.  
+0000f7e0: 2028 0a20 2020 2020 2020 2020 2020 206e   (.            n
+0000f7f0: 6f74 2069 735f 6461 736b 5f63 6f6c 6c65  ot is_dask_colle
+0000f800: 6374 696f 6e28 7661 6c75 6529 0a20 2020  ction(value).   
+0000f810: 2020 2020 2020 2020 2061 6e64 2069 7373           and iss
+0000f820: 7562 636c 6173 7328 7365 6c66 2e64 7479  ubclass(self.dty
+0000f830: 7065 2e74 7970 652c 2049 6e74 6567 7261  pe.type, Integra
+0000f840: 6c29 0a20 2020 2020 2020 2020 2020 2061  l).            a
+0000f850: 6e64 206e 702e 6973 6e61 6e28 7661 6c75  nd np.isnan(valu
+0000f860: 6529 2e61 6e79 2829 0a20 2020 2020 2020  e).any().       
+0000f870: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0000f880: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000f890: 2822 6361 6e6e 6f74 2063 6f6e 7665 7274  ("cannot convert
+0000f8a0: 2066 6c6f 6174 204e 614e 2074 6f20 696e   float NaN to in
+0000f8b0: 7465 6765 7222 290a 0a20 2020 2020 2020  teger")..       
+0000f8c0: 2023 2320 5573 6520 7468 6520 2277 6865   ## Use the "whe
+0000f8d0: 7265 2220 6d65 7468 6f64 2066 6f72 2063  re" method for c
+0000f8e0: 6173 6573 2077 6865 6e20 6b65 7920 6973  ases when key is
+0000f8f0: 2061 6e20 4172 7261 790a 2020 2020 2020   an Array.      
+0000f900: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000f910: 6b65 792c 2041 7272 6179 293a 0a20 2020  key, Array):.   
+0000f920: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
+0000f930: 736b 2e61 7272 6179 2e72 6f75 7469 6e65  sk.array.routine
+0000f940: 7320 696d 706f 7274 2077 6865 7265 0a0a  s import where..
+0000f950: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000f960: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
+0000f970: 2041 7272 6179 2920 616e 6420 7661 6c75   Array) and valu
+0000f980: 652e 6e64 696d 203e 2031 3a0a 2020 2020  e.ndim > 1:.    
+0000f990: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000f9a0: 6520 5661 6c75 6545 7272 6f72 2822 626f  e ValueError("bo
+0000f9b0: 6f6c 6561 6e20 696e 6465 7820 6172 7261  olean index arra
+0000f9c0: 7920 7368 6f75 6c64 2068 6176 6520 3120  y should have 1 
+0000f9d0: 6469 6d65 6e73 696f 6e22 290a 2020 2020  dimension").    
+0000f9e0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0000f9f0: 2020 2020 2020 2020 2020 2020 2079 203d               y =
+0000fa00: 2077 6865 7265 286b 6579 2c20 7661 6c75   where(key, valu
+0000fa10: 652c 2073 656c 6629 0a20 2020 2020 2020  e, self).       
+0000fa20: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
+0000fa30: 6545 7272 6f72 2061 7320 653a 0a20 2020  eError as e:.   
+0000fa40: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000fa50: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0000fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa70: 2020 2022 426f 6f6c 6561 6e20 696e 6465     "Boolean inde
+0000fa80: 7820 6173 7369 676e 6d65 6e74 2069 6e20  x assignment in 
+0000fa90: 4461 736b 2022 0a20 2020 2020 2020 2020  Dask ".         
+0000faa0: 2020 2020 2020 2020 2020 2022 6578 7065             "expe
+0000fab0: 6374 7320 6571 7561 6c6c 7920 7368 6170  cts equally shap
+0000fac0: 6564 2061 7272 6179 732e 5c6e 4578 616d  ed arrays.\nExam
+0000fad0: 706c 653a 2064 6131 5b64 6132 5d20 3d20  ple: da1[da2] = 
+0000fae0: 6461 3320 220a 2020 2020 2020 2020 2020  da3 ".          
+0000faf0: 2020 2020 2020 2020 2020 2277 6865 7265            "where
+0000fb00: 2064 6131 2e73 6861 7065 203d 3d20 2834   da1.shape == (4
+0000fb10: 2c29 2c20 6461 322e 7368 6170 6520 3d3d  ,), da2.shape ==
+0000fb20: 2028 342c 2920 220a 2020 2020 2020 2020   (4,) ".        
+0000fb30: 2020 2020 2020 2020 2020 2020 2261 6e64              "and
+0000fb40: 2064 6133 2e73 6861 7065 203d 3d20 2834   da3.shape == (4
+0000fb50: 2c29 2e5c 6e22 0a20 2020 2020 2020 2020  ,).\n".         
+0000fb60: 2020 2020 2020 2020 2020 2022 416c 7465             "Alte
+0000fb70: 726e 6174 6976 656c 792c 2079 6f75 2063  rnatively, you c
+0000fb80: 616e 2075 7365 2074 6865 2065 7874 656e  an use the exten
+0000fb90: 6465 6420 4150 4920 7468 6174 2073 7570  ded API that sup
+0000fba0: 706f 7274 7322 0a20 2020 2020 2020 2020  ports".         
+0000fbb0: 2020 2020 2020 2020 2020 2022 696e 6465             "inde
+0000fbc0: 7869 6e67 2077 6974 6820 7475 706c 6573  xing with tuples
+0000fbd0: 2e5c 6e45 7861 6d70 6c65 3a20 6461 315b  .\nExample: da1[
+0000fbe0: 2864 6132 2c29 5d20 3d20 6461 332e 220a  (da2,)] = da3.".
+0000fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc00: 2920 6672 6f6d 2065 0a20 2020 2020 2020  ) from e.       
+0000fc10: 2020 2020 2073 656c 662e 5f6d 6574 6120       self._meta 
+0000fc20: 3d20 792e 5f6d 6574 610a 2020 2020 2020  = y._meta.      
+0000fc30: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
+0000fc40: 3d20 792e 6461 736b 0a20 2020 2020 2020  = y.dask.       
+0000fc50: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
+0000fc60: 3d20 792e 6e61 6d65 0a20 2020 2020 2020  = y.name.       
+0000fc70: 2020 2020 2073 656c 662e 5f63 6875 6e6b       self._chunk
+0000fc80: 7320 3d20 792e 6368 756e 6b73 0a20 2020  s = y.chunks.   
+0000fc90: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0000fca0: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
+0000fcb0: 736e 616e 2873 656c 662e 7368 6170 6529  snan(self.shape)
+0000fcc0: 2e61 6e79 2829 3a0a 2020 2020 2020 2020  .any():.        
+0000fcd0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000fce0: 7272 6f72 2866 2241 7272 6179 7320 6368  rror(f"Arrays ch
+0000fcf0: 756e 6b20 7369 7a65 7320 6172 6520 756e  unk sizes are un
+0000fd00: 6b6e 6f77 6e2e 207b 756e 6b6e 6f77 6e5f  known. {unknown_
+0000fd10: 6368 756e 6b5f 6d65 7373 6167 657d 2229  chunk_message}")
+0000fd20: 0a0a 2020 2020 2020 2020 2320 5374 696c  ..        # Stil
+0000fd30: 6c20 6865 7265 3f20 5468 656e 2061 7070  l here? Then app
+0000fd40: 6c79 2074 6865 2061 7373 6967 6e6d 656e  ly the assignmen
+0000fd50: 7420 746f 206f 7468 6572 2074 7970 6520  t to other type 
+0000fd60: 6f66 0a20 2020 2020 2020 2023 2069 6e64  of.        # ind
+0000fd70: 6963 6573 2076 6961 2074 6865 2060 7365  ices via the `se
+0000fd80: 7469 7465 6d5f 6172 7261 7960 2066 756e  titem_array` fun
+0000fd90: 6374 696f 6e2e 0a20 2020 2020 2020 2076  ction..        v
+0000fda0: 616c 7565 203d 2061 7361 6e79 6172 7261  alue = asanyarra
+0000fdb0: 7928 7661 6c75 6529 0a0a 2020 2020 2020  y(value)..      
+0000fdc0: 2020 6f75 7420 3d20 2273 6574 6974 656d    out = "setitem
+0000fdd0: 2d22 202b 2074 6f6b 656e 697a 6528 7365  -" + tokenize(se
+0000fde0: 6c66 2c20 6b65 792c 2076 616c 7565 290a  lf, key, value).
+0000fdf0: 2020 2020 2020 2020 6473 6b20 3d20 7365          dsk = se
+0000fe00: 7469 7465 6d5f 6172 7261 7928 6f75 742c  titem_array(out,
+0000fe10: 2073 656c 662c 206b 6579 2c20 7661 6c75   self, key, valu
+0000fe20: 6529 0a0a 2020 2020 2020 2020 6d65 7461  e)..        meta
+0000fe30: 203d 206d 6574 615f 6672 6f6d 5f61 7272   = meta_from_arr
+0000fe40: 6179 2873 656c 662e 5f6d 6574 6129 0a20  ay(self._meta). 
+0000fe50: 2020 2020 2020 2069 6620 6e70 2e69 7373         if np.iss
+0000fe60: 6361 6c61 7228 6d65 7461 293a 0a20 2020  calar(meta):.   
+0000fe70: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+0000fe80: 6e70 2e61 7272 6179 286d 6574 6129 0a0a  np.array(meta)..
+0000fe90: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+0000fea0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+0000feb0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+0000fec0: 6f75 742c 2064 736b 2c20 6465 7065 6e64  out, dsk, depend
+0000fed0: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
+0000fee0: 2020 2020 2020 2079 203d 2041 7272 6179         y = Array
+0000fef0: 2867 7261 7068 2c20 6f75 742c 2063 6875  (graph, out, chu
+0000ff00: 6e6b 733d 7365 6c66 2e63 6875 6e6b 732c  nks=self.chunks,
+0000ff10: 2064 7479 7065 3d73 656c 662e 6474 7970   dtype=self.dtyp
+0000ff20: 652c 206d 6574 613d 6d65 7461 290a 0a20  e, meta=meta).. 
+0000ff30: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
+0000ff40: 6120 3d20 792e 5f6d 6574 610a 2020 2020  a = y._meta.    
+0000ff50: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
+0000ff60: 792e 6461 736b 0a20 2020 2020 2020 2073  y.dask.        s
+0000ff70: 656c 662e 5f6e 616d 6520 3d20 792e 6e61  elf._name = y.na
+0000ff80: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
+0000ff90: 5f63 6875 6e6b 7320 3d20 792e 6368 756e  _chunks = y.chun
+0000ffa0: 6b73 0a0a 2020 2020 6465 6620 5f5f 6765  ks..    def __ge
+0000ffb0: 7469 7465 6d5f 5f28 7365 6c66 2c20 696e  titem__(self, in
+0000ffc0: 6465 7829 3a0a 2020 2020 2020 2020 2320  dex):.        # 
+0000ffd0: 4669 656c 6420 6163 6365 7373 2c20 652e  Field access, e.
+0000ffe0: 672e 2078 5b27 6127 5d20 6f72 2078 5b5b  g. x['a'] or x[[
+0000fff0: 2761 272c 2027 6227 5d5d 0a20 2020 2020  'a', 'b']].     
+00010000: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00010010: 2869 6e64 6578 2c20 7374 7229 206f 7220  (index, str) or 
+00010020: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
+00010030: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
+00010040: 6c69 7374 2920 616e 6420 696e 6465 7820  list) and index 
+00010050: 616e 6420 616c 6c28 6973 696e 7374 616e  and all(isinstan
+00010060: 6365 2869 2c20 7374 7229 2066 6f72 2069  ce(i, str) for i
+00010070: 2069 6e20 696e 6465 7829 0a20 2020 2020   in index).     
+00010080: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00010090: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000100a0: 696e 6465 782c 2073 7472 293a 0a20 2020  index, str):.   
+000100b0: 2020 2020 2020 2020 2020 2020 2064 7420               dt 
+000100c0: 3d20 7365 6c66 2e64 7479 7065 5b69 6e64  = self.dtype[ind
+000100d0: 6578 5d0a 2020 2020 2020 2020 2020 2020  ex].            
+000100e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000100f0: 2020 2020 2020 6474 203d 206e 702e 6474        dt = np.dt
+00010100: 7970 6528 0a20 2020 2020 2020 2020 2020  ype(.           
+00010110: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00010120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010130: 2020 2022 6e61 6d65 7322 3a20 696e 6465     "names": inde
+00010140: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
+00010150: 2020 2020 2020 2020 2020 2022 666f 726d             "form
+00010160: 6174 7322 3a20 5b73 656c 662e 6474 7970  ats": [self.dtyp
+00010170: 652e 6669 656c 6473 5b6e 616d 655d 5b30  e.fields[name][0
+00010180: 5d20 666f 7220 6e61 6d65 2069 6e20 696e  ] for name in in
+00010190: 6465 785d 2c0a 2020 2020 2020 2020 2020  dex],.          
+000101a0: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+000101b0: 6666 7365 7473 223a 205b 7365 6c66 2e64  ffsets": [self.d
+000101c0: 7479 7065 2e66 6965 6c64 735b 6e61 6d65  type.fields[name
+000101d0: 5d5b 315d 2066 6f72 206e 616d 6520 696e  ][1] for name in
+000101e0: 2069 6e64 6578 5d2c 0a20 2020 2020 2020   index],.       
+000101f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010200: 2022 6974 656d 7369 7a65 223a 2073 656c   "itemsize": sel
+00010210: 662e 6474 7970 652e 6974 656d 7369 7a65  f.dtype.itemsize
+00010220: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010230: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00010240: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00010250: 2020 2020 2020 2069 6620 6474 2e73 6861         if dt.sha
+00010260: 7065 3a0a 2020 2020 2020 2020 2020 2020  pe:.            
+00010270: 2020 2020 6e65 775f 6178 6973 203d 206c      new_axis = l
+00010280: 6973 7428 7261 6e67 6528 7365 6c66 2e6e  ist(range(self.n
+00010290: 6469 6d2c 2073 656c 662e 6e64 696d 202b  dim, self.ndim +
+000102a0: 206c 656e 2864 742e 7368 6170 6529 2929   len(dt.shape)))
+000102b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000102c0: 2063 6875 6e6b 7320 3d20 7365 6c66 2e63   chunks = self.c
+000102d0: 6875 6e6b 7320 2b20 7475 706c 6528 2869  hunks + tuple((i
+000102e0: 2c29 2066 6f72 2069 2069 6e20 6474 2e73  ,) for i in dt.s
+000102f0: 6861 7065 290a 2020 2020 2020 2020 2020  hape).          
+00010300: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00010310: 662e 6d61 705f 626c 6f63 6b73 280a 2020  f.map_blocks(.  
+00010320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010330: 2020 6765 7469 7465 6d2c 2069 6e64 6578    getitem, index
+00010340: 2c20 6474 7970 653d 6474 2e62 6173 652c  , dtype=dt.base,
+00010350: 2063 6875 6e6b 733d 6368 756e 6b73 2c20   chunks=chunks, 
+00010360: 6e65 775f 6178 6973 3d6e 6577 5f61 7869  new_axis=new_axi
+00010370: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00010380: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00010390: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000103a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000103b0: 662e 6d61 705f 626c 6f63 6b73 2867 6574  f.map_blocks(get
+000103c0: 6974 656d 2c20 696e 6465 782c 2064 7479  item, index, dty
+000103d0: 7065 3d64 7429 0a0a 2020 2020 2020 2020  pe=dt)..        
+000103e0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+000103f0: 6528 696e 6465 782c 2074 7570 6c65 293a  e(index, tuple):
+00010400: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00010410: 6578 203d 2028 696e 6465 782c 290a 0a20  ex = (index,).. 
+00010420: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00010430: 2e61 7272 6179 2e73 6c69 6369 6e67 2069  .array.slicing i
+00010440: 6d70 6f72 7420 280a 2020 2020 2020 2020  mport (.        
+00010450: 2020 2020 6e6f 726d 616c 697a 655f 696e      normalize_in
+00010460: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+00010470: 2073 6c69 6365 5f77 6974 685f 626f 6f6c   slice_with_bool
+00010480: 5f64 6173 6b5f 6172 7261 792c 0a20 2020  _dask_array,.   
+00010490: 2020 2020 2020 2020 2073 6c69 6365 5f77           slice_w
+000104a0: 6974 685f 696e 745f 6461 736b 5f61 7272  ith_int_dask_arr
+000104b0: 6179 2c0a 2020 2020 2020 2020 290a 0a20  ay,.        ).. 
+000104c0: 2020 2020 2020 2069 6e64 6578 3220 3d20         index2 = 
+000104d0: 6e6f 726d 616c 697a 655f 696e 6465 7828  normalize_index(
+000104e0: 696e 6465 782c 2073 656c 662e 7368 6170  index, self.shap
+000104f0: 6529 0a20 2020 2020 2020 2064 6570 656e  e).        depen
+00010500: 6465 6e63 6965 7320 3d20 7b73 656c 662e  dencies = {self.
+00010510: 6e61 6d65 7d0a 2020 2020 2020 2020 666f  name}.        fo
+00010520: 7220 6920 696e 2069 6e64 6578 323a 0a20  r i in index2:. 
+00010530: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00010540: 696e 7374 616e 6365 2869 2c20 4172 7261  instance(i, Arra
+00010550: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
+00010560: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
+00010570: 2e61 6464 2869 2e6e 616d 6529 0a0a 2020  .add(i.name)..  
+00010580: 2020 2020 2020 6966 2061 6e79 2869 7369        if any(isi
+00010590: 6e73 7461 6e63 6528 692c 2041 7272 6179  nstance(i, Array
+000105a0: 2920 616e 6420 692e 6474 7970 652e 6b69  ) and i.dtype.ki
+000105b0: 6e64 2069 6e20 2269 7522 2066 6f72 2069  nd in "iu" for i
+000105c0: 2069 6e20 696e 6465 7832 293a 0a20 2020   in index2):.   
+000105d0: 2020 2020 2020 2020 2073 656c 662c 2069           self, i
+000105e0: 6e64 6578 3220 3d20 736c 6963 655f 7769  ndex2 = slice_wi
+000105f0: 7468 5f69 6e74 5f64 6173 6b5f 6172 7261  th_int_dask_arra
+00010600: 7928 7365 6c66 2c20 696e 6465 7832 290a  y(self, index2).
+00010610: 2020 2020 2020 2020 6966 2061 6e79 2869          if any(i
+00010620: 7369 6e73 7461 6e63 6528 692c 2041 7272  sinstance(i, Arr
+00010630: 6179 2920 616e 6420 692e 6474 7970 6520  ay) and i.dtype 
+00010640: 3d3d 2062 6f6f 6c20 666f 7220 6920 696e  == bool for i in
+00010650: 2069 6e64 6578 3229 3a0a 2020 2020 2020   index2):.      
+00010660: 2020 2020 2020 7365 6c66 2c20 696e 6465        self, inde
+00010670: 7832 203d 2073 6c69 6365 5f77 6974 685f  x2 = slice_with_
+00010680: 626f 6f6c 5f64 6173 6b5f 6172 7261 7928  bool_dask_array(
+00010690: 7365 6c66 2c20 696e 6465 7832 290a 0a20  self, index2).. 
+000106a0: 2020 2020 2020 2069 6620 616c 6c28 6973         if all(is
+000106b0: 696e 7374 616e 6365 2869 2c20 736c 6963  instance(i, slic
+000106c0: 6529 2061 6e64 2069 203d 3d20 736c 6963  e) and i == slic
+000106d0: 6528 4e6f 6e65 2920 666f 7220 6920 696e  e(None) for i in
+000106e0: 2069 6e64 6578 3229 3a0a 2020 2020 2020   index2):.      
+000106f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00010700: 660a 0a20 2020 2020 2020 206f 7574 203d  f..        out =
+00010710: 2022 6765 7469 7465 6d2d 2220 2b20 746f   "getitem-" + to
+00010720: 6b65 6e69 7a65 2873 656c 662c 2069 6e64  kenize(self, ind
+00010730: 6578 3229 0a20 2020 2020 2020 2064 736b  ex2).        dsk
+00010740: 2c20 6368 756e 6b73 203d 2073 6c69 6365  , chunks = slice
+00010750: 5f61 7272 6179 286f 7574 2c20 7365 6c66  _array(out, self
+00010760: 2e6e 616d 652c 2073 656c 662e 6368 756e  .name, self.chun
+00010770: 6b73 2c20 696e 6465 7832 2c20 7365 6c66  ks, index2, self
+00010780: 2e69 7465 6d73 697a 6529 0a0a 2020 2020  .itemsize)..    
+00010790: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+000107a0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+000107b0: 636f 6c6c 6563 7469 6f6e 7328 6f75 742c  collections(out,
+000107c0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+000107d0: 6573 3d5b 7365 6c66 5d29 0a0a 2020 2020  es=[self])..    
+000107e0: 2020 2020 6d65 7461 203d 206d 6574 615f      meta = meta_
+000107f0: 6672 6f6d 5f61 7272 6179 2873 656c 662e  from_array(self.
+00010800: 5f6d 6574 612c 206e 6469 6d3d 6c65 6e28  _meta, ndim=len(
+00010810: 6368 756e 6b73 2929 0a20 2020 2020 2020  chunks)).       
+00010820: 2069 6620 6e70 2e69 7373 6361 6c61 7228   if np.isscalar(
+00010830: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
+00010840: 2020 206d 6574 6120 3d20 6e70 2e61 7272     meta = np.arr
+00010850: 6179 286d 6574 6129 0a0a 2020 2020 2020  ay(meta)..      
+00010860: 2020 7265 7475 726e 2041 7272 6179 2867    return Array(g
+00010870: 7261 7068 2c20 6f75 742c 2063 6875 6e6b  raph, out, chunk
+00010880: 732c 206d 6574 613d 6d65 7461 290a 0a20  s, meta=meta).. 
+00010890: 2020 2064 6566 205f 7669 6e64 6578 2873     def _vindex(s
+000108a0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+000108b0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+000108c0: 616e 6365 286b 6579 2c20 7475 706c 6529  ance(key, tuple)
+000108d0: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
+000108e0: 7920 3d20 286b 6579 2c29 0a20 2020 2020  y = (key,).     
+000108f0: 2020 2069 6620 616e 7928 6b20 6973 204e     if any(k is N
+00010900: 6f6e 6520 666f 7220 6b20 696e 206b 6579  one for k in key
+00010910: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00010920: 6169 7365 2049 6e64 6578 4572 726f 7228  aise IndexError(
+00010930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010940: 2022 7669 6e64 6578 2064 6f65 7320 6e6f   "vindex does no
+00010950: 7420 7375 7070 6f72 7420 696e 6465 7869  t support indexi
+00010960: 6e67 2077 6974 6820 4e6f 6e65 2028 6e70  ng with None (np
+00010970: 2e6e 6577 6178 6973 292c 2022 0a20 2020  .newaxis), ".   
+00010980: 2020 2020 2020 2020 2020 2020 2022 676f               "go
+00010990: 7420 7b7d 222e 666f 726d 6174 286b 6579  t {}".format(key
+000109a0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+000109b0: 2020 2020 2020 2020 6966 2061 6c6c 2869          if all(i
+000109c0: 7369 6e73 7461 6e63 6528 6b2c 2073 6c69  sinstance(k, sli
+000109d0: 6365 2920 666f 7220 6b20 696e 206b 6579  ce) for k in key
+000109e0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+000109f0: 6620 616c 6c28 0a20 2020 2020 2020 2020  f all(.         
+00010a00: 2020 2020 2020 206b 2e69 6e64 6963 6573         k.indices
+00010a10: 2864 2920 3d3d 2073 6c69 6365 2830 2c20  (d) == slice(0, 
+00010a20: 6429 2e69 6e64 6963 6573 2864 2920 666f  d).indices(d) fo
+00010a30: 7220 6b2c 2064 2069 6e20 7a69 7028 6b65  r k, d in zip(ke
+00010a40: 792c 2073 656c 662e 7368 6170 6529 0a20  y, self.shape). 
+00010a50: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00010a60: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00010a70: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+00010a80: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
+00010a90: 7845 7272 6f72 280a 2020 2020 2020 2020  xError(.        
+00010aa0: 2020 2020 2020 2020 2276 696e 6465 7820          "vindex 
+00010ab0: 7265 7175 6972 6573 2061 7420 6c65 6173  requires at leas
+00010ac0: 7420 6f6e 6520 6e6f 6e2d 736c 6963 6520  t one non-slice 
+00010ad0: 746f 2076 6563 746f 7269 7a65 206f 7665  to vectorize ove
+00010ae0: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
+00010af0: 2020 2020 2277 6865 6e20 7468 6520 736c      "when the sl
+00010b00: 6963 6573 2061 7265 206e 6f74 206f 7665  ices are not ove
+00010b10: 7220 7468 6520 656e 7469 7265 2061 7272  r the entire arr
+00010b20: 6179 2028 692e 652c 2078 5b3a 5d29 2e20  ay (i.e, x[:]). 
+00010b30: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00010b40: 2020 2255 7365 206e 6f72 6d61 6c20 736c    "Use normal sl
+00010b50: 6963 696e 6720 696e 7374 6561 6420 7768  icing instead wh
+00010b60: 656e 206f 6e6c 7920 7573 696e 6720 736c  en only using sl
+00010b70: 6963 6573 2e20 476f 743a 207b 7d22 2e66  ices. Got: {}".f
+00010b80: 6f72 6d61 7428 6b65 7929 0a20 2020 2020  ormat(key).     
+00010b90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00010ba0: 2065 6c69 6620 616e 7928 6973 5f64 6173   elif any(is_das
+00010bb0: 6b5f 636f 6c6c 6563 7469 6f6e 286b 2920  k_collection(k) 
+00010bc0: 666f 7220 6b20 696e 206b 6579 293a 0a20  for k in key):. 
+00010bd0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00010be0: 2049 6e64 6578 4572 726f 7228 0a20 2020   IndexError(.   
+00010bf0: 2020 2020 2020 2020 2020 2020 2022 7669               "vi
+00010c00: 6e64 6578 2064 6f65 7320 6e6f 7420 7375  ndex does not su
+00010c10: 7070 6f72 7420 696e 6465 7869 6e67 2077  pport indexing w
+00010c20: 6974 6820 6461 736b 206f 626a 6563 7473  ith dask objects
+00010c30: 2e20 4361 6c6c 2063 6f6d 7075 7465 2022  . Call compute "
+00010c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010c50: 2022 6f6e 2074 6865 2069 6e64 6578 6572   "on the indexer
+00010c60: 2066 6972 7374 2074 6f20 6765 7420 616e   first to get an
+00010c70: 2065 7661 6c75 7261 7465 6420 6172 7261   evalurated arra
+00010c80: 792e 2047 6f74 3a20 7b7d 222e 666f 726d  y. Got: {}".form
+00010c90: 6174 286b 6579 290a 2020 2020 2020 2020  at(key).        
+00010ca0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00010cb0: 7475 726e 205f 7669 6e64 6578 2873 656c  turn _vindex(sel
+00010cc0: 662c 202a 6b65 7929 0a0a 2020 2020 4070  f, *key)..    @p
+00010cd0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00010ce0: 7669 6e64 6578 2873 656c 6629 3a0a 2020  vindex(self):.  
+00010cf0: 2020 2020 2020 2222 2256 6563 746f 7269        """Vectori
+00010d00: 7a65 6420 696e 6465 7869 6e67 2077 6974  zed indexing wit
+00010d10: 6820 6272 6f61 6463 6173 7469 6e67 2e0a  h broadcasting..
+00010d20: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
+00010d30: 2065 7175 6976 616c 656e 7420 746f 206e   equivalent to n
+00010d40: 756d 7079 2773 2061 6476 616e 6365 6420  umpy's advanced 
+00010d50: 696e 6465 7869 6e67 2c20 7573 696e 6720  indexing, using 
+00010d60: 6172 7261 7973 2074 6861 7420 6172 650a  arrays that are.
+00010d70: 2020 2020 2020 2020 6272 6f61 6463 6173          broadcas
+00010d80: 7420 6167 6169 6e73 7420 6561 6368 206f  t against each o
+00010d90: 7468 6572 2e20 5468 6973 2061 6c6c 6f77  ther. This allow
+00010da0: 7320 666f 7220 706f 696e 7477 6973 6520  s for pointwise 
+00010db0: 696e 6465 7869 6e67 3a0a 0a20 2020 2020  indexing:..     
+00010dc0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+00010dd0: 736b 2e61 7272 6179 2061 7320 6461 0a20  sk.array as da. 
+00010de0: 2020 2020 2020 203e 3e3e 2078 203d 206e         >>> x = n
+00010df0: 702e 6172 7261 7928 5b5b 312c 2032 2c20  p.array([[1, 2, 
+00010e00: 335d 2c20 5b34 2c20 352c 2036 5d2c 205b  3], [4, 5, 6], [
+00010e10: 372c 2038 2c20 395d 5d29 0a20 2020 2020  7, 8, 9]]).     
+00010e20: 2020 203e 3e3e 2078 203d 2064 612e 6672     >>> x = da.fr
+00010e30: 6f6d 5f61 7272 6179 2878 2c20 6368 756e  om_array(x, chun
+00010e40: 6b73 3d32 290a 2020 2020 2020 2020 3e3e  ks=2).        >>
+00010e50: 3e20 782e 7669 6e64 6578 5b5b 302c 2031  > x.vindex[[0, 1
+00010e60: 2c20 325d 2c20 5b30 2c20 312c 2032 5d5d  , 2], [0, 1, 2]]
+00010e70: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00010e80: 2020 2061 7272 6179 285b 312c 2035 2c20     array([1, 5, 
+00010e90: 395d 290a 0a20 2020 2020 2020 204d 6978  9])..        Mix
+00010ea0: 6564 2062 6173 6963 2f61 6476 616e 6365  ed basic/advance
+00010eb0: 6420 696e 6465 7869 6e67 2077 6974 6820  d indexing with 
+00010ec0: 736c 6963 6573 2f61 7272 6179 7320 6973  slices/arrays is
+00010ed0: 2061 6c73 6f20 7375 7070 6f72 7465 642e   also supported.
+00010ee0: 2054 6865 0a20 2020 2020 2020 206f 7264   The.        ord
+00010ef0: 6572 206f 6620 6469 6d65 6e73 696f 6e73  er of dimensions
+00010f00: 2069 6e20 7468 6520 7265 7375 6c74 2066   in the result f
+00010f10: 6f6c 6c6f 7773 2074 686f 7365 2070 726f  ollows those pro
+00010f20: 706f 7365 6420 666f 720a 2020 2020 2020  posed for.      
+00010f30: 2020 606e 6461 7272 6179 2e76 696e 6465    `ndarray.vinde
+00010f40: 7820 3c68 7474 7073 3a2f 2f67 6974 6875  x <https://githu
+00010f50: 622e 636f 6d2f 6e75 6d70 792f 6e75 6d70  b.com/numpy/nump
+00010f60: 792f 7075 6c6c 2f36 3235 363e 605f 3a0a  y/pull/6256>`_:.
+00010f70: 2020 2020 2020 2020 7468 6520 7375 6273          the subs
+00010f80: 7061 6365 2073 7061 6e6e 6564 2062 7920  pace spanned by 
+00010f90: 6172 7261 7973 2069 7320 666f 6c6c 6f77  arrays is follow
+00010fa0: 6564 2062 7920 616c 6c20 736c 6963 6573  ed by all slices
+00010fb0: 2e0a 0a20 2020 2020 2020 204e 6f74 653a  ...        Note:
+00010fc0: 2060 6076 696e 6465 7860 6020 7072 6f76   ``vindex`` prov
+00010fd0: 6964 6573 206d 6f72 6520 6765 6e65 7261  ides more genera
+00010fe0: 6c20 6675 6e63 7469 6f6e 616c 6974 7920  l functionality 
+00010ff0: 7468 616e 2073 7461 6e64 6172 640a 2020  than standard.  
+00011000: 2020 2020 2020 696e 6465 7869 6e67 2c20        indexing, 
+00011010: 6275 7420 6974 2061 6c73 6f20 6861 7320  but it also has 
+00011020: 6665 7765 7220 6f70 7469 6d69 7a61 7469  fewer optimizati
+00011030: 6f6e 7320 616e 6420 6361 6e20 6265 2073  ons and can be s
+00011040: 6967 6e69 6669 6361 6e74 6c79 0a20 2020  ignificantly.   
+00011050: 2020 2020 2073 6c6f 7765 722e 0a20 2020       slower..   
+00011060: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00011070: 2072 6574 7572 6e20 496e 6465 7843 616c   return IndexCal
+00011080: 6c61 626c 6528 7365 6c66 2e5f 7669 6e64  lable(self._vind
+00011090: 6578 290a 0a20 2020 2040 7072 6f70 6572  ex)..    @proper
+000110a0: 7479 0a20 2020 2064 6566 2062 6c6f 636b  ty.    def block
+000110b0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+000110c0: 2022 2222 416e 2061 7272 6179 2d6c 696b   """An array-lik
+000110d0: 6520 696e 7465 7266 6163 6520 746f 2074  e interface to t
+000110e0: 6865 2062 6c6f 636b 7320 6f66 2061 6e20  he blocks of an 
+000110f0: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
+00011100: 5468 6973 2072 6574 7572 6e73 2061 2060  This returns a `
+00011110: 6042 6c6f 636b 7669 6577 6060 206f 626a  `Blockview`` obj
+00011120: 6563 7420 7468 6174 2070 726f 7669 6465  ect that provide
+00011130: 7320 616e 2061 7272 6179 2d6c 696b 6520  s an array-like 
+00011140: 696e 7465 7266 6163 650a 2020 2020 2020  interface.      
+00011150: 2020 746f 2074 6865 2062 6c6f 636b 7320    to the blocks 
+00011160: 6f66 2061 2064 6173 6b20 6172 7261 792e  of a dask array.
+00011170: 2020 4e75 6d70 792d 7374 796c 6520 696e    Numpy-style in
+00011180: 6465 7869 6e67 206f 6620 6120 6060 426c  dexing of a ``Bl
+00011190: 6f63 6b76 6965 7760 6020 6f62 6a65 6374  ockview`` object
+000111a0: 0a20 2020 2020 2020 2072 6574 7572 6e73  .        returns
+000111b0: 2061 2073 656c 6563 7469 6f6e 206f 6620   a selection of 
+000111c0: 626c 6f63 6b73 2061 7320 6120 6e65 7720  blocks as a new 
+000111d0: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
+000111e0: 2020 2020 2059 6f75 2063 616e 2069 6e64       You can ind
+000111f0: 6578 2060 6061 7272 6179 2e62 6c6f 636b  ex ``array.block
+00011200: 7360 6020 6c69 6b65 2061 206e 756d 7079  s`` like a numpy
+00011210: 2061 7272 6179 206f 6620 7368 6170 650a   array of shape.
+00011220: 2020 2020 2020 2020 6571 7561 6c20 746f          equal to
+00011230: 2074 6865 206e 756d 6265 7220 6f66 2062   the number of b
+00011240: 6c6f 636b 7320 696e 2065 6163 6820 6469  locks in each di
+00011250: 6d65 6e73 696f 6e2c 2028 6176 6169 6c61  mension, (availa
+00011260: 626c 6520 6173 0a20 2020 2020 2020 2061  ble as.        a
+00011270: 7272 6179 2e62 6c6f 636b 732e 7369 7a65  rray.blocks.size
+00011280: 292e 2020 5468 6520 6469 6d65 6e73 696f  ).  The dimensio
+00011290: 6e61 6c69 7479 206f 6620 7468 6520 6f75  nality of the ou
+000112a0: 7470 7574 2061 7272 6179 206d 6174 6368  tput array match
+000112b0: 6573 0a20 2020 2020 2020 2074 6865 2064  es.        the d
+000112c0: 696d 656e 7369 6f6e 206f 6620 7468 6973  imension of this
+000112d0: 2061 7272 6179 2c20 6576 656e 2069 6620   array, even if 
+000112e0: 696e 7465 6765 7220 696e 6469 6365 7320  integer indices 
+000112f0: 6172 6520 7061 7373 6564 2e0a 2020 2020  are passed..    
+00011300: 2020 2020 536c 6963 696e 6720 7769 7468      Slicing with
+00011310: 2060 606e 702e 6e65 7761 7869 7360 6020   ``np.newaxis`` 
+00011320: 6f72 206d 756c 7469 706c 6520 6c69 7374  or multiple list
+00011330: 7320 6973 206e 6f74 2073 7570 706f 7274  s is not support
+00011340: 6564 2e0a 0a20 2020 2020 2020 2045 7861  ed...        Exa
+00011350: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00011360: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00011370: 3e3e 2069 6d70 6f72 7420 6461 736b 2e61  >> import dask.a
+00011380: 7272 6179 2061 7320 6461 0a20 2020 2020  rray as da.     
+00011390: 2020 203e 3e3e 2078 203d 2064 612e 6172     >>> x = da.ar
+000113a0: 616e 6765 2838 2c20 6368 756e 6b73 3d32  ange(8, chunks=2
+000113b0: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
+000113c0: 626c 6f63 6b73 2e73 6861 7065 2023 2061  blocks.shape # a
+000113d0: 6c69 6173 6573 2078 2e6e 756d 626c 6f63  liases x.numbloc
+000113e0: 6b73 0a20 2020 2020 2020 2028 342c 290a  ks.        (4,).
+000113f0: 2020 2020 2020 2020 3e3e 3e20 782e 626c          >>> x.bl
+00011400: 6f63 6b73 5b30 5d2e 636f 6d70 7574 6528  ocks[0].compute(
+00011410: 290a 2020 2020 2020 2020 6172 7261 7928  ).        array(
+00011420: 5b30 2c20 315d 290a 2020 2020 2020 2020  [0, 1]).        
+00011430: 3e3e 3e20 782e 626c 6f63 6b73 5b3a 335d  >>> x.blocks[:3]
+00011440: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00011450: 2020 2061 7272 6179 285b 302c 2031 2c20     array([0, 1, 
+00011460: 322c 2033 2c20 342c 2035 5d29 0a20 2020  2, 3, 4, 5]).   
+00011470: 2020 2020 203e 3e3e 2078 2e62 6c6f 636b       >>> x.block
+00011480: 735b 3a3a 325d 2e63 6f6d 7075 7465 2829  s[::2].compute()
+00011490: 0a20 2020 2020 2020 2061 7272 6179 285b  .        array([
+000114a0: 302c 2031 2c20 342c 2035 5d29 0a20 2020  0, 1, 4, 5]).   
+000114b0: 2020 2020 203e 3e3e 2078 2e62 6c6f 636b       >>> x.block
+000114c0: 735b 5b2d 312c 2030 5d5d 2e63 6f6d 7075  s[[-1, 0]].compu
+000114d0: 7465 2829 0a20 2020 2020 2020 2061 7272  te().        arr
+000114e0: 6179 285b 362c 2037 2c20 302c 2031 5d29  ay([6, 7, 0, 1])
+000114f0: 0a20 2020 2020 2020 203e 3e3e 2078 2e62  .        >>> x.b
+00011500: 6c6f 636b 732e 7261 7665 6c28 2920 2320  locks.ravel() # 
+00011510: 646f 6374 6573 743a 202b 4e4f 524d 414c  doctest: +NORMAL
+00011520: 495a 455f 5748 4954 4553 5041 4345 0a20  IZE_WHITESPACE. 
+00011530: 2020 2020 2020 205b 6461 736b 2e61 7272         [dask.arr
+00011540: 6179 3c62 6c6f 636b 732c 2073 6861 7065  ay<blocks, shape
+00011550: 3d28 322c 292c 2064 7479 7065 3d69 6e74  =(2,), dtype=int
+00011560: 3634 2c20 6368 756e 6b73 697a 653d 2832  64, chunksize=(2
+00011570: 2c29 2c20 6368 756e 6b74 7970 653d 6e75  ,), chunktype=nu
+00011580: 6d70 792e 6e64 6172 7261 793e 2c0a 2020  mpy.ndarray>,.  
+00011590: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
+000115a0: 793c 626c 6f63 6b73 2c20 7368 6170 653d  y<blocks, shape=
+000115b0: 2832 2c29 2c20 6474 7970 653d 696e 7436  (2,), dtype=int6
+000115c0: 342c 2063 6875 6e6b 7369 7a65 3d28 322c  4, chunksize=(2,
+000115d0: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
+000115e0: 7079 2e6e 6461 7272 6179 3e2c 0a20 2020  py.ndarray>,.   
+000115f0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00011600: 3c62 6c6f 636b 732c 2073 6861 7065 3d28  <blocks, shape=(
+00011610: 322c 292c 2064 7479 7065 3d69 6e74 3634  2,), dtype=int64
+00011620: 2c20 6368 756e 6b73 697a 653d 2832 2c29  , chunksize=(2,)
+00011630: 2c20 6368 756e 6b74 7970 653d 6e75 6d70  , chunktype=nump
+00011640: 792e 6e64 6172 7261 793e 2c0a 2020 2020  y.ndarray>,.    
+00011650: 2020 2020 2064 6173 6b2e 6172 7261 793c       dask.array<
+00011660: 626c 6f63 6b73 2c20 7368 6170 653d 2832  blocks, shape=(2
+00011670: 2c29 2c20 6474 7970 653d 696e 7436 342c  ,), dtype=int64,
+00011680: 2063 6875 6e6b 7369 7a65 3d28 322c 292c   chunksize=(2,),
+00011690: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
+000116a0: 2e6e 6461 7272 6179 3e5d 0a0a 2020 2020  .ndarray>]..    
+000116b0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+000116c0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+000116d0: 2020 2020 416e 2069 6e73 7461 6e63 6520      An instance 
+000116e0: 6f66 2060 6064 6173 6b2e 6172 7261 792e  of ``dask.array.
+000116f0: 426c 6f63 6b76 6965 7760 600a 2020 2020  Blockview``.    
+00011700: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011710: 7265 7475 726e 2042 6c6f 636b 5669 6577  return BlockView
+00011720: 2873 656c 6629 0a0a 2020 2020 4070 726f  (self)..    @pro
+00011730: 7065 7274 790a 2020 2020 6465 6620 7061  perty.    def pa
+00011740: 7274 6974 696f 6e73 2873 656c 6629 3a0a  rtitions(self):.
+00011750: 2020 2020 2020 2020 2222 2253 6c69 6365          """Slice
+00011760: 2061 6e20 6172 7261 7920 6279 2070 6172   an array by par
+00011770: 7469 7469 6f6e 732e 2041 6c69 6173 206f  titions. Alias o
+00011780: 6620 6461 736b 2061 7272 6179 202e 626c  f dask array .bl
+00011790: 6f63 6b73 2061 7474 7269 6275 7465 2e0a  ocks attribute..
+000117a0: 0a20 2020 2020 2020 2054 6869 7320 616c  .        This al
+000117b0: 6961 7320 616c 6c6f 7773 2079 6f75 2074  ias allows you t
+000117c0: 6f20 7772 6974 6520 6167 6e6f 7374 6963  o write agnostic
+000117d0: 2063 6f64 6520 7468 6174 2077 6f72 6b73   code that works
+000117e0: 2077 6974 6820 626f 7468 0a20 2020 2020   with both.     
+000117f0: 2020 2064 6173 6b20 6172 7261 7973 2061     dask arrays a
+00011800: 6e64 2064 6173 6b20 6461 7461 6672 616d  nd dask datafram
+00011810: 6573 2e0a 0a20 2020 2020 2020 2054 6869  es...        Thi
+00011820: 7320 7265 7475 726e 7320 6120 6060 426c  s returns a ``Bl
+00011830: 6f63 6b76 6965 7760 6020 6f62 6a65 6374  ockview`` object
+00011840: 2074 6861 7420 7072 6f76 6964 6573 2061   that provides a
+00011850: 6e20 6172 7261 792d 6c69 6b65 2069 6e74  n array-like int
+00011860: 6572 6661 6365 0a20 2020 2020 2020 2074  erface.        t
+00011870: 6f20 7468 6520 626c 6f63 6b73 206f 6620  o the blocks of 
+00011880: 6120 6461 736b 2061 7272 6179 2e20 204e  a dask array.  N
+00011890: 756d 7079 2d73 7479 6c65 2069 6e64 6578  umpy-style index
+000118a0: 696e 6720 6f66 2061 2060 6042 6c6f 636b  ing of a ``Block
+000118b0: 7669 6577 6060 206f 626a 6563 740a 2020  view`` object.  
+000118c0: 2020 2020 2020 7265 7475 726e 7320 6120        returns a 
+000118d0: 7365 6c65 6374 696f 6e20 6f66 2062 6c6f  selection of blo
+000118e0: 636b 7320 6173 2061 206e 6577 2064 6173  cks as a new das
+000118f0: 6b20 6172 7261 792e 0a0a 2020 2020 2020  k array...      
+00011900: 2020 596f 7520 6361 6e20 696e 6465 7820    You can index 
+00011910: 6060 6172 7261 792e 626c 6f63 6b73 6060  ``array.blocks``
+00011920: 206c 696b 6520 6120 6e75 6d70 7920 6172   like a numpy ar
+00011930: 7261 7920 6f66 2073 6861 7065 0a20 2020  ray of shape.   
+00011940: 2020 2020 2065 7175 616c 2074 6f20 7468       equal to th
+00011950: 6520 6e75 6d62 6572 206f 6620 626c 6f63  e number of bloc
+00011960: 6b73 2069 6e20 6561 6368 2064 696d 656e  ks in each dimen
+00011970: 7369 6f6e 2c20 2861 7661 696c 6162 6c65  sion, (available
+00011980: 2061 730a 2020 2020 2020 2020 6172 7261   as.        arra
+00011990: 792e 626c 6f63 6b73 2e73 697a 6529 2e20  y.blocks.size). 
+000119a0: 2054 6865 2064 696d 656e 7369 6f6e 616c   The dimensional
+000119b0: 6974 7920 6f66 2074 6865 206f 7574 7075  ity of the outpu
+000119c0: 7420 6172 7261 7920 6d61 7463 6865 730a  t array matches.
+000119d0: 2020 2020 2020 2020 7468 6520 6469 6d65          the dime
+000119e0: 6e73 696f 6e20 6f66 2074 6869 7320 6172  nsion of this ar
+000119f0: 7261 792c 2065 7665 6e20 6966 2069 6e74  ray, even if int
+00011a00: 6567 6572 2069 6e64 6963 6573 2061 7265  eger indices are
+00011a10: 2070 6173 7365 642e 0a20 2020 2020 2020   passed..       
+00011a20: 2053 6c69 6369 6e67 2077 6974 6820 6060   Slicing with ``
+00011a30: 6e70 2e6e 6577 6178 6973 6060 206f 7220  np.newaxis`` or 
+00011a40: 6d75 6c74 6970 6c65 206c 6973 7473 2069  multiple lists i
+00011a50: 7320 6e6f 7420 7375 7070 6f72 7465 642e  s not supported.
+00011a60: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00011a70: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+00011a80: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+00011a90: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
+00011aa0: 7920 6173 2064 610a 2020 2020 2020 2020  y as da.        
+00011ab0: 3e3e 3e20 7820 3d20 6461 2e61 7261 6e67  >>> x = da.arang
+00011ac0: 6528 382c 2063 6875 6e6b 733d 3229 0a20  e(8, chunks=2). 
+00011ad0: 2020 2020 2020 203e 3e3e 2078 2e70 6172         >>> x.par
+00011ae0: 7469 7469 6f6e 732e 7368 6170 6520 2320  titions.shape # 
+00011af0: 616c 6961 7365 7320 782e 6e75 6d62 6c6f  aliases x.numblo
+00011b00: 636b 730a 2020 2020 2020 2020 2834 2c29  cks.        (4,)
+00011b10: 0a20 2020 2020 2020 203e 3e3e 2078 2e70  .        >>> x.p
+00011b20: 6172 7469 7469 6f6e 735b 305d 2e63 6f6d  artitions[0].com
+00011b30: 7075 7465 2829 0a20 2020 2020 2020 2061  pute().        a
+00011b40: 7272 6179 285b 302c 2031 5d29 0a20 2020  rray([0, 1]).   
+00011b50: 2020 2020 203e 3e3e 2078 2e70 6172 7469       >>> x.parti
+00011b60: 7469 6f6e 735b 3a33 5d2e 636f 6d70 7574  tions[:3].comput
+00011b70: 6528 290a 2020 2020 2020 2020 6172 7261  e().        arra
+00011b80: 7928 5b30 2c20 312c 2032 2c20 332c 2034  y([0, 1, 2, 3, 4
+00011b90: 2c20 355d 290a 2020 2020 2020 2020 3e3e  , 5]).        >>
+00011ba0: 3e20 782e 7061 7274 6974 696f 6e73 5b3a  > x.partitions[:
+00011bb0: 3a32 5d2e 636f 6d70 7574 6528 290a 2020  :2].compute().  
+00011bc0: 2020 2020 2020 6172 7261 7928 5b30 2c20        array([0, 
+00011bd0: 312c 2034 2c20 355d 290a 2020 2020 2020  1, 4, 5]).      
+00011be0: 2020 3e3e 3e20 782e 7061 7274 6974 696f    >>> x.partitio
+00011bf0: 6e73 5b5b 2d31 2c20 305d 5d2e 636f 6d70  ns[[-1, 0]].comp
+00011c00: 7574 6528 290a 2020 2020 2020 2020 6172  ute().        ar
+00011c10: 7261 7928 5b36 2c20 372c 2030 2c20 315d  ray([6, 7, 0, 1]
+00011c20: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
+00011c30: 7061 7274 6974 696f 6e73 2e72 6176 656c  partitions.ravel
+00011c40: 2829 2023 2064 6f63 7465 7374 3a20 2b4e  () # doctest: +N
+00011c50: 4f52 4d41 4c49 5a45 5f57 4849 5445 5350  ORMALIZE_WHITESP
+00011c60: 4143 450a 2020 2020 2020 2020 5b64 6173  ACE.        [das
+00011c70: 6b2e 6172 7261 793c 626c 6f63 6b73 2c20  k.array<blocks, 
+00011c80: 7368 6170 653d 2832 2c29 2c20 6474 7970  shape=(2,), dtyp
+00011c90: 653d 696e 7436 342c 2063 6875 6e6b 7369  e=int64, chunksi
+00011ca0: 7a65 3d28 322c 292c 2063 6875 6e6b 7479  ze=(2,), chunkty
+00011cb0: 7065 3d6e 756d 7079 2e6e 6461 7272 6179  pe=numpy.ndarray
+00011cc0: 3e2c 0a20 2020 2020 2020 2020 6461 736b  >,.         dask
+00011cd0: 2e61 7272 6179 3c62 6c6f 636b 732c 2073  .array<blocks, s
+00011ce0: 6861 7065 3d28 322c 292c 2064 7479 7065  hape=(2,), dtype
+00011cf0: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
+00011d00: 653d 2832 2c29 2c20 6368 756e 6b74 7970  e=(2,), chunktyp
+00011d10: 653d 6e75 6d70 792e 6e64 6172 7261 793e  e=numpy.ndarray>
+00011d20: 2c0a 2020 2020 2020 2020 2064 6173 6b2e  ,.         dask.
+00011d30: 6172 7261 793c 626c 6f63 6b73 2c20 7368  array<blocks, sh
+00011d40: 6170 653d 2832 2c29 2c20 6474 7970 653d  ape=(2,), dtype=
+00011d50: 696e 7436 342c 2063 6875 6e6b 7369 7a65  int64, chunksize
+00011d60: 3d28 322c 292c 2063 6875 6e6b 7479 7065  =(2,), chunktype
+00011d70: 3d6e 756d 7079 2e6e 6461 7272 6179 3e2c  =numpy.ndarray>,
+00011d80: 0a20 2020 2020 2020 2020 6461 736b 2e61  .         dask.a
+00011d90: 7272 6179 3c62 6c6f 636b 732c 2073 6861  rray<blocks, sha
+00011da0: 7065 3d28 322c 292c 2064 7479 7065 3d69  pe=(2,), dtype=i
+00011db0: 6e74 3634 2c20 6368 756e 6b73 697a 653d  nt64, chunksize=
+00011dc0: 2832 2c29 2c20 6368 756e 6b74 7970 653d  (2,), chunktype=
+00011dd0: 6e75 6d70 792e 6e64 6172 7261 793e 5d0a  numpy.ndarray>].
+00011de0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00011df0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00011e00: 0a20 2020 2020 2020 2041 6e20 696e 7374  .        An inst
+00011e10: 616e 6365 206f 6620 6060 6461 2e61 7272  ance of ``da.arr
+00011e20: 6179 2e42 6c6f 636b 7669 6577 6060 0a20  ay.Blockview``. 
+00011e30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011e40: 2020 2072 6574 7572 6e20 7365 6c66 2e62     return self.b
+00011e50: 6c6f 636b 730a 0a20 2020 2064 6566 2064  locks..    def d
+00011e60: 6f74 2873 656c 662c 206f 7468 6572 293a  ot(self, other):
+00011e70: 0a20 2020 2020 2020 2022 2222 446f 7420  .        """Dot 
+00011e80: 7072 6f64 7563 7420 6f66 2073 656c 6620  product of self 
+00011e90: 616e 6420 6f74 6865 722e 0a0a 2020 2020  and other...    
+00011ea0: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
+00011eb0: 6e63 3a60 6461 736b 2e61 7272 6179 2e74  nc:`dask.array.t
+00011ec0: 656e 736f 7264 6f74 6020 666f 7220 6675  ensordot` for fu
+00011ed0: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
+00011ee0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+00011ef0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00011f00: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+00011f10: 6b2e 6172 7261 792e 646f 7420 3a20 6571  k.array.dot : eq
+00011f20: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
+00011f30: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
+00011f40: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00011f50: 6172 7261 792e 726f 7574 696e 6573 2069  array.routines i
+00011f60: 6d70 6f72 7420 7465 6e73 6f72 646f 740a  mport tensordot.
+00011f70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00011f80: 7465 6e73 6f72 646f 7428 7365 6c66 2c20  tensordot(self, 
+00011f90: 6f74 6865 722c 2061 7865 733d 2828 7365  other, axes=((se
+00011fa0: 6c66 2e6e 6469 6d20 2d20 312c 292c 2028  lf.ndim - 1,), (
+00011fb0: 6f74 6865 722e 6e64 696d 202d 2032 2c29  other.ndim - 2,)
+00011fc0: 2929 0a0a 2020 2020 4070 726f 7065 7274  ))..    @propert
+00011fd0: 790a 2020 2020 6465 6620 4128 7365 6c66  y.    def A(self
+00011fe0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00011ff0: 6e20 7365 6c66 0a0a 2020 2020 4070 726f  n self..    @pro
+00012000: 7065 7274 790a 2020 2020 6465 6620 5428  perty.    def T(
+00012010: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00012020: 6574 7572 6e20 7365 6c66 2e74 7261 6e73  eturn self.trans
+00012030: 706f 7365 2829 0a0a 2020 2020 6465 6620  pose()..    def 
+00012040: 7472 616e 7370 6f73 6528 7365 6c66 2c20  transpose(self, 
+00012050: 2a61 7865 7329 3a0a 2020 2020 2020 2020  *axes):.        
+00012060: 2222 2252 6576 6572 7365 206f 7220 7065  """Reverse or pe
+00012070: 726d 7574 6520 7468 6520 6178 6573 206f  rmute the axes o
+00012080: 6620 616e 2061 7272 6179 2e20 5265 7475  f an array. Retu
+00012090: 726e 2074 6865 206d 6f64 6966 6965 6420  rn the modified 
+000120a0: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
+000120b0: 5265 6665 7220 746f 203a 6675 6e63 3a60  Refer to :func:`
+000120c0: 6461 736b 2e61 7272 6179 2e74 7261 6e73  dask.array.trans
+000120d0: 706f 7365 6020 666f 7220 6675 6c6c 2064  pose` for full d
+000120e0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
+000120f0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00012100: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012110: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
+00012120: 7261 792e 7472 616e 7370 6f73 6520 3a20  ray.transpose : 
+00012130: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
+00012140: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
+00012150: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00012160: 6b2e 6172 7261 792e 726f 7574 696e 6573  k.array.routines
+00012170: 2069 6d70 6f72 7420 7472 616e 7370 6f73   import transpos
+00012180: 650a 0a20 2020 2020 2020 2069 6620 6e6f  e..        if no
+00012190: 7420 6178 6573 3a0a 2020 2020 2020 2020  t axes:.        
+000121a0: 2020 2020 6178 6573 203d 204e 6f6e 650a      axes = None.
+000121b0: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
+000121c0: 2861 7865 7329 203d 3d20 3120 616e 6420  (axes) == 1 and 
+000121d0: 6973 696e 7374 616e 6365 2861 7865 735b  isinstance(axes[
+000121e0: 305d 2c20 4974 6572 6162 6c65 293a 0a20  0], Iterable):. 
+000121f0: 2020 2020 2020 2020 2020 2061 7865 7320             axes 
+00012200: 3d20 6178 6573 5b30 5d0a 2020 2020 2020  = axes[0].      
+00012210: 2020 6966 2028 6178 6573 203d 3d20 7475    if (axes == tu
+00012220: 706c 6528 7261 6e67 6528 7365 6c66 2e6e  ple(range(self.n
+00012230: 6469 6d29 2929 206f 7220 2861 7865 7320  dim))) or (axes 
+00012240: 3d3d 2074 7570 6c65 2872 616e 6765 282d  == tuple(range(-
+00012250: 7365 6c66 2e6e 6469 6d2c 2030 2929 293a  self.ndim, 0))):
+00012260: 0a20 2020 2020 2020 2020 2020 2023 206e  .            # n
+00012270: 6f20 7472 616e 7370 6f73 6520 6e65 6365  o transpose nece
+00012280: 7373 6172 790a 2020 2020 2020 2020 2020  ssary.          
+00012290: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
+000122a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000122b0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+000122c0: 7261 6e73 706f 7365 2873 656c 662c 2061  ranspose(self, a
+000122d0: 7865 733d 6178 6573 290a 0a20 2020 2064  xes=axes)..    d
+000122e0: 6566 2072 6176 656c 2873 656c 6629 3a0a  ef ravel(self):.
+000122f0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00012300: 6e20 6120 666c 6174 7465 6e65 6420 6172  n a flattened ar
+00012310: 7261 792e 0a0a 2020 2020 2020 2020 5265  ray...        Re
+00012320: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
+00012330: 736b 2e61 7272 6179 2e72 6176 656c 6020  sk.array.ravel` 
+00012340: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
+00012350: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+00012360: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00012370: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00012380: 2020 2064 6173 6b2e 6172 7261 792e 7261     dask.array.ra
+00012390: 7665 6c20 3a20 6571 7569 7661 6c65 6e74  vel : equivalent
+000123a0: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
+000123b0: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+000123c0: 6f6d 2064 6173 6b2e 6172 7261 792e 726f  om dask.array.ro
+000123d0: 7574 696e 6573 2069 6d70 6f72 7420 7261  utines import ra
+000123e0: 7665 6c0a 0a20 2020 2020 2020 2072 6574  vel..        ret
+000123f0: 7572 6e20 7261 7665 6c28 7365 6c66 290a  urn ravel(self).
+00012400: 0a20 2020 2066 6c61 7474 656e 203d 2072  .    flatten = r
+00012410: 6176 656c 0a0a 2020 2020 6465 6620 6368  avel..    def ch
+00012420: 6f6f 7365 2873 656c 662c 2063 686f 6963  oose(self, choic
+00012430: 6573 293a 0a20 2020 2020 2020 2022 2222  es):.        """
+00012440: 5573 6520 616e 2069 6e64 6578 2061 7272  Use an index arr
+00012450: 6179 2074 6f20 636f 6e73 7472 7563 7420  ay to construct 
+00012460: 6120 6e65 7720 6172 7261 7920 6672 6f6d  a new array from
+00012470: 2061 2073 6574 206f 6620 6368 6f69 6365   a set of choice
+00012480: 732e 0a0a 2020 2020 2020 2020 5265 6665  s...        Refe
+00012490: 7220 746f 203a 6675 6e63 3a60 6461 736b  r to :func:`dask
+000124a0: 2e61 7272 6179 2e63 686f 6f73 6560 2066  .array.choose` f
+000124b0: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
+000124c0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+000124d0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000124e0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000124f0: 2020 6461 736b 2e61 7272 6179 2e63 686f    dask.array.cho
+00012500: 6f73 6520 3a20 6571 7569 7661 6c65 6e74  ose : equivalent
+00012510: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
+00012520: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+00012530: 6f6d 2064 6173 6b2e 6172 7261 792e 726f  om dask.array.ro
+00012540: 7574 696e 6573 2069 6d70 6f72 7420 6368  utines import ch
+00012550: 6f6f 7365 0a0a 2020 2020 2020 2020 7265  oose..        re
+00012560: 7475 726e 2063 686f 6f73 6528 7365 6c66  turn choose(self
+00012570: 2c20 6368 6f69 6365 7329 0a0a 2020 2020  , choices)..    
+00012580: 6465 6620 7265 7368 6170 6528 7365 6c66  def reshape(self
+00012590: 2c20 2a73 6861 7065 2c20 6d65 7267 655f  , *shape, merge_
+000125a0: 6368 756e 6b73 3d54 7275 652c 206c 696d  chunks=True, lim
+000125b0: 6974 3d4e 6f6e 6529 3a0a 2020 2020 2020  it=None):.      
+000125c0: 2020 2222 2252 6573 6861 7065 2061 7272    """Reshape arr
+000125d0: 6179 2074 6f20 6e65 7720 7368 6170 650a  ay to new shape.
+000125e0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+000125f0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+00012600: 7261 792e 7265 7368 6170 6560 2066 6f72  ray.reshape` for
+00012610: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+00012620: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00012630: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00012640: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00012650: 6461 736b 2e61 7272 6179 2e72 6573 6861  dask.array.resha
+00012660: 7065 203a 2065 7175 6976 616c 656e 7420  pe : equivalent 
+00012670: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00012680: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00012690: 6d20 6461 736b 2e61 7272 6179 2e72 6573  m dask.array.res
+000126a0: 6861 7065 2069 6d70 6f72 7420 7265 7368  hape import resh
+000126b0: 6170 650a 0a20 2020 2020 2020 2069 6620  ape..        if 
+000126c0: 6c65 6e28 7368 6170 6529 203d 3d20 3120  len(shape) == 1 
+000126d0: 616e 6420 6e6f 7420 6973 696e 7374 616e  and not isinstan
+000126e0: 6365 2873 6861 7065 5b30 5d2c 204e 756d  ce(shape[0], Num
+000126f0: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
+00012700: 2020 7368 6170 6520 3d20 7368 6170 655b    shape = shape[
+00012710: 305d 0a20 2020 2020 2020 2072 6574 7572  0].        retur
+00012720: 6e20 7265 7368 6170 6528 7365 6c66 2c20  n reshape(self, 
+00012730: 7368 6170 652c 206d 6572 6765 5f63 6875  shape, merge_chu
+00012740: 6e6b 733d 6d65 7267 655f 6368 756e 6b73  nks=merge_chunks
+00012750: 2c20 6c69 6d69 743d 6c69 6d69 7429 0a0a  , limit=limit)..
+00012760: 2020 2020 6465 6620 746f 706b 2873 656c      def topk(sel
+00012770: 662c 206b 2c20 6178 6973 3d2d 312c 2073  f, k, axis=-1, s
+00012780: 706c 6974 5f65 7665 7279 3d4e 6f6e 6529  plit_every=None)
+00012790: 3a0a 2020 2020 2020 2020 2222 2254 6865  :.        """The
+000127a0: 2074 6f70 206b 2065 6c65 6d65 6e74 7320   top k elements 
+000127b0: 6f66 2061 6e20 6172 7261 792e 0a0a 2020  of an array...  
+000127c0: 2020 2020 2020 5265 6665 7220 746f 203a        Refer to :
+000127d0: 6675 6e63 3a60 6461 736b 2e61 7272 6179  func:`dask.array
+000127e0: 2e74 6f70 6b60 2066 6f72 2066 756c 6c20  .topk` for full 
+000127f0: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
+00012800: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+00012810: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00012820: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
+00012830: 7272 6179 2e74 6f70 6b20 3a20 6571 7569  rray.topk : equi
+00012840: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
+00012850: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00012860: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
+00012870: 7261 792e 7265 6475 6374 696f 6e73 2069  ray.reductions i
+00012880: 6d70 6f72 7420 746f 706b 0a0a 2020 2020  mport topk..    
+00012890: 2020 2020 7265 7475 726e 2074 6f70 6b28      return topk(
+000128a0: 7365 6c66 2c20 6b2c 2061 7869 733d 6178  self, k, axis=ax
+000128b0: 6973 2c20 7370 6c69 745f 6576 6572 793d  is, split_every=
+000128c0: 7370 6c69 745f 6576 6572 7929 0a0a 2020  split_every)..  
+000128d0: 2020 6465 6620 6172 6774 6f70 6b28 7365    def argtopk(se
+000128e0: 6c66 2c20 6b2c 2061 7869 733d 2d31 2c20  lf, k, axis=-1, 
+000128f0: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
+00012900: 293a 0a20 2020 2020 2020 2022 2222 5468  ):.        """Th
+00012910: 6520 696e 6469 6365 7320 6f66 2074 6865  e indices of the
+00012920: 2074 6f70 206b 2065 6c65 6d65 6e74 7320   top k elements 
+00012930: 6f66 2061 6e20 6172 7261 792e 0a0a 2020  of an array...  
+00012940: 2020 2020 2020 5265 6665 7220 746f 203a        Refer to :
+00012950: 6675 6e63 3a60 6461 736b 2e61 7272 6179  func:`dask.array
+00012960: 2e61 7267 746f 706b 6020 666f 7220 6675  .argtopk` for fu
+00012970: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
+00012980: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+00012990: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+000129a0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+000129b0: 6b2e 6172 7261 792e 6172 6774 6f70 6b20  k.array.argtopk 
+000129c0: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
+000129d0: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
+000129e0: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
+000129f0: 6173 6b2e 6172 7261 792e 7265 6475 6374  ask.array.reduct
+00012a00: 696f 6e73 2069 6d70 6f72 7420 6172 6774  ions import argt
+00012a10: 6f70 6b0a 0a20 2020 2020 2020 2072 6574  opk..        ret
+00012a20: 7572 6e20 6172 6774 6f70 6b28 7365 6c66  urn argtopk(self
+00012a30: 2c20 6b2c 2061 7869 733d 6178 6973 2c20  , k, axis=axis, 
+00012a40: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00012a50: 745f 6576 6572 7929 0a0a 2020 2020 6465  t_every)..    de
+00012a60: 6620 6173 7479 7065 2873 656c 662c 2064  f astype(self, d
+00012a70: 7479 7065 2c20 2a2a 6b77 6172 6773 293a  type, **kwargs):
+00012a80: 0a20 2020 2020 2020 2022 2222 436f 7079  .        """Copy
+00012a90: 206f 6620 7468 6520 6172 7261 792c 2063   of the array, c
+00012aa0: 6173 7420 746f 2061 2073 7065 6369 6669  ast to a specifi
+00012ab0: 6564 2074 7970 652e 0a0a 2020 2020 2020  ed type...      
+00012ac0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00012ad0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00012ae0: 2020 2020 2020 2020 6474 7970 6520 3a20          dtype : 
+00012af0: 7374 7220 6f72 2064 7479 7065 0a20 2020  str or dtype.   
+00012b00: 2020 2020 2020 2020 2054 7970 6563 6f64           Typecod
+00012b10: 6520 6f72 2064 6174 612d 7479 7065 2074  e or data-type t
+00012b20: 6f20 7768 6963 6820 7468 6520 6172 7261  o which the arra
+00012b30: 7920 6973 2063 6173 742e 0a20 2020 2020  y is cast..     
+00012b40: 2020 2063 6173 7469 6e67 203a 207b 276e     casting : {'n
+00012b50: 6f27 2c20 2765 7175 6976 272c 2027 7361  o', 'equiv', 'sa
+00012b60: 6665 272c 2027 7361 6d65 5f6b 696e 6427  fe', 'same_kind'
+00012b70: 2c20 2775 6e73 6166 6527 7d2c 206f 7074  , 'unsafe'}, opt
+00012b80: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00012b90: 2020 436f 6e74 726f 6c73 2077 6861 7420    Controls what 
+00012ba0: 6b69 6e64 206f 6620 6461 7461 2063 6173  kind of data cas
+00012bb0: 7469 6e67 206d 6179 206f 6363 7572 2e20  ting may occur. 
+00012bc0: 4465 6661 756c 7473 2074 6f20 2775 6e73  Defaults to 'uns
+00012bd0: 6166 6527 0a20 2020 2020 2020 2020 2020  afe'.           
+00012be0: 2066 6f72 2062 6163 6b77 6172 6473 2063   for backwards c
+00012bf0: 6f6d 7061 7469 6269 6c69 7479 2e0a 0a20  ompatibility... 
+00012c00: 2020 2020 2020 2020 2020 202a 2027 6e6f             * 'no
+00012c10: 2720 6d65 616e 7320 7468 6520 6461 7461  ' means the data
+00012c20: 2074 7970 6573 2073 686f 756c 6420 6e6f   types should no
+00012c30: 7420 6265 2063 6173 7420 6174 2061 6c6c  t be cast at all
+00012c40: 2e0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
+00012c50: 2765 7175 6976 2720 6d65 616e 7320 6f6e  'equiv' means on
+00012c60: 6c79 2062 7974 652d 6f72 6465 7220 6368  ly byte-order ch
+00012c70: 616e 6765 7320 6172 6520 616c 6c6f 7765  anges are allowe
+00012c80: 642e 0a20 2020 2020 2020 2020 2020 202a  d..            *
+00012c90: 2027 7361 6665 2720 6d65 616e 7320 6f6e   'safe' means on
+00012ca0: 6c79 2063 6173 7473 2077 6869 6368 2063  ly casts which c
+00012cb0: 616e 2070 7265 7365 7276 6520 7661 6c75  an preserve valu
+00012cc0: 6573 2061 7265 2061 6c6c 6f77 6564 2e0a  es are allowed..
+00012cd0: 2020 2020 2020 2020 2020 2020 2a20 2773              * 's
+00012ce0: 616d 655f 6b69 6e64 2720 6d65 616e 7320  ame_kind' means 
+00012cf0: 6f6e 6c79 2073 6166 6520 6361 7374 7320  only safe casts 
+00012d00: 6f72 2063 6173 7473 2077 6974 6869 6e20  or casts within 
+00012d10: 6120 6b69 6e64 2c0a 2020 2020 2020 2020  a kind,.        
+00012d20: 2020 2020 2020 2020 6c69 6b65 2066 6c6f          like flo
+00012d30: 6174 3634 2074 6f20 666c 6f61 7433 322c  at64 to float32,
+00012d40: 2061 7265 2061 6c6c 6f77 6564 2e0a 2020   are allowed..  
+00012d50: 2020 2020 2020 2020 2020 2a20 2775 6e73            * 'uns
+00012d60: 6166 6527 206d 6561 6e73 2061 6e79 2064  afe' means any d
+00012d70: 6174 6120 636f 6e76 6572 7369 6f6e 7320  ata conversions 
+00012d80: 6d61 7920 6265 2064 6f6e 652e 0a20 2020  may be done..   
+00012d90: 2020 2020 2063 6f70 7920 3a20 626f 6f6c       copy : bool
+00012da0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00012db0: 2020 2020 2020 2042 7920 6465 6661 756c         By defaul
+00012dc0: 742c 2061 7374 7970 6520 616c 7761 7973  t, astype always
+00012dd0: 2072 6574 7572 6e73 2061 206e 6577 6c79   returns a newly
+00012de0: 2061 6c6c 6f63 6174 6564 2061 7272 6179   allocated array
+00012df0: 2e20 4966 2074 6869 730a 2020 2020 2020  . If this.      
+00012e00: 2020 2020 2020 6973 2073 6574 2074 6f20        is set to 
+00012e10: 4661 6c73 6520 616e 6420 7468 6520 6064  False and the `d
+00012e20: 7479 7065 6020 7265 7175 6972 656d 656e  type` requiremen
+00012e30: 7420 6973 2073 6174 6973 6669 6564 2c20  t is satisfied, 
+00012e40: 7468 6520 696e 7075 740a 2020 2020 2020  the input.      
+00012e50: 2020 2020 2020 6172 7261 7920 6973 2072        array is r
+00012e60: 6574 7572 6e65 6420 696e 7374 6561 6420  eturned instead 
+00012e70: 6f66 2061 2063 6f70 792e 0a0a 2020 2020  of a copy...    
+00012e80: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
+00012e90: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012ea0: 2020 2044 6173 6b20 646f 6573 206e 6f74     Dask does not
+00012eb0: 2072 6573 7065 6374 2074 6865 2063 6f6e   respect the con
+00012ec0: 7469 6775 6f75 7320 6d65 6d6f 7279 206c  tiguous memory l
+00012ed0: 6179 6f75 7420 6f66 2074 6865 2061 7272  ayout of the arr
+00012ee0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
+00012ef0: 2020 2020 616e 6420 7769 6c6c 2069 676e      and will ign
+00012f00: 6f72 6520 7468 6520 6060 6f72 6465 7260  ore the ``order`
+00012f10: 6020 6b65 7977 6f72 6420 6172 6775 6d65  ` keyword argume
+00012f20: 6e74 2e0a 2020 2020 2020 2020 2020 2020  nt..            
+00012f30: 2020 2020 5468 6520 6465 6661 756c 7420      The default 
+00012f40: 6f72 6465 7220 6973 2027 4327 2063 6f6e  order is 'C' con
+00012f50: 7469 6775 6f75 732e 0a20 2020 2020 2020  tiguous..       
+00012f60: 2022 2222 0a20 2020 2020 2020 206b 7761   """.        kwa
+00012f70: 7267 732e 706f 7028 226f 7264 6572 222c  rgs.pop("order",
+00012f80: 204e 6f6e 6529 2020 2320 606f 7264 6572   None)  # `order
+00012f90: 6020 6973 206e 6f74 2072 6573 7065 6374  ` is not respect
+00012fa0: 6564 2c20 736f 2077 6520 7265 6d6f 7665  ed, so we remove
+00012fb0: 2074 6869 7320 6b77 6172 670a 2020 2020   this kwarg.    
+00012fc0: 2020 2020 2320 5363 616c 6172 7320 646f      # Scalars do
+00012fd0: 6e27 7420 7461 6b65 2060 6361 7374 696e  n't take `castin
+00012fe0: 6760 206f 7220 6063 6f70 7960 206b 7761  g` or `copy` kwa
+00012ff0: 7267 7320 2d20 6173 2073 7563 6820 7765  rgs - as such we
+00013000: 206f 6e6c 7920 7061 7373 0a20 2020 2020   only pass.     
+00013010: 2020 2023 2074 6865 6d20 746f 2060 6d61     # them to `ma
+00013020: 705f 626c 6f63 6b73 6020 6966 2073 7065  p_blocks` if spe
+00013030: 6369 6669 6564 2062 7920 7573 6572 2028  cified by user (
+00013040: 6469 6666 6572 656e 7420 7468 616e 2064  different than d
+00013050: 6566 6175 6c74 7329 2e0a 2020 2020 2020  efaults)..      
+00013060: 2020 6578 7472 6120 3d20 7365 7428 6b77    extra = set(kw
+00013070: 6172 6773 2920 2d20 7b22 6361 7374 696e  args) - {"castin
+00013080: 6722 2c20 2263 6f70 7922 7d0a 2020 2020  g", "copy"}.    
+00013090: 2020 2020 6966 2065 7874 7261 3a0a 2020      if extra:.  
+000130a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000130b0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+000130c0: 2020 2020 2020 2020 2020 2066 2261 7374             f"ast
+000130d0: 7970 6520 646f 6573 206e 6f74 2074 616b  ype does not tak
+000130e0: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
+000130f0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00013100: 733a 207b 6c69 7374 2865 7874 7261 297d  s: {list(extra)}
+00013110: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00013120: 2020 2020 2020 2020 6361 7374 696e 6720          casting 
+00013130: 3d20 6b77 6172 6773 2e67 6574 2822 6361  = kwargs.get("ca
+00013140: 7374 696e 6722 2c20 2275 6e73 6166 6522  sting", "unsafe"
+00013150: 290a 2020 2020 2020 2020 6474 7970 6520  ).        dtype 
+00013160: 3d20 6e70 2e64 7479 7065 2864 7479 7065  = np.dtype(dtype
+00013170: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+00013180: 662e 6474 7970 6520 3d3d 2064 7479 7065  f.dtype == dtype
+00013190: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000131a0: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+000131b0: 2020 656c 6966 206e 6f74 206e 702e 6361    elif not np.ca
+000131c0: 6e5f 6361 7374 2873 656c 662e 6474 7970  n_cast(self.dtyp
+000131d0: 652c 2064 7479 7065 2c20 6361 7374 696e  e, dtype, castin
+000131e0: 673d 6361 7374 696e 6729 3a0a 2020 2020  g=casting):.    
+000131f0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00013200: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00013210: 2020 2020 2020 2020 2066 2243 616e 6e6f           f"Canno
+00013220: 7420 6361 7374 2061 7272 6179 2066 726f  t cast array fro
+00013230: 6d20 7b73 656c 662e 6474 7970 6521 727d  m {self.dtype!r}
+00013240: 2074 6f20 7b64 7479 7065 2172 7d20 220a   to {dtype!r} ".
+00013250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013260: 6622 6163 636f 7264 696e 6720 746f 2074  f"according to t
+00013270: 6865 2072 756c 6520 7b63 6173 7469 6e67  he rule {casting
+00013280: 2172 7d22 0a20 2020 2020 2020 2020 2020  !r}".           
+00013290: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+000132a0: 6e20 7365 6c66 2e6d 6170 5f62 6c6f 636b  n self.map_block
+000132b0: 7328 6368 756e 6b2e 6173 7479 7065 2c20  s(chunk.astype, 
+000132c0: 6474 7970 653d 6474 7970 652c 2061 7374  dtype=dtype, ast
+000132d0: 7970 655f 6474 7970 653d 6474 7970 652c  ype_dtype=dtype,
+000132e0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+000132f0: 6465 6620 5f5f 6162 735f 5f28 7365 6c66  def __abs__(self
+00013300: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00013310: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
+00013320: 746f 722e 6162 732c 2073 656c 6629 0a0a  tor.abs, self)..
+00013330: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
+00013340: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
+00013350: 720a 2020 2020 6465 6620 5f5f 6164 645f  r.    def __add_
+00013360: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+00013370: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00013380: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
+00013390: 2e61 6464 2c20 7365 6c66 2c20 6f74 6865  .add, self, othe
+000133a0: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
+000133b0: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+000133c0: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+000133d0: 7261 6464 5f5f 2873 656c 662c 206f 7468  radd__(self, oth
+000133e0: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
+000133f0: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
+00013400: 7261 746f 722e 6164 642c 206f 7468 6572  rator.add, other
+00013410: 2c20 7365 6c66 290a 0a20 2020 2040 6368  , self)..    @ch
+00013420: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
+00013430: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
+00013440: 6566 205f 5f61 6e64 5f5f 2873 656c 662c  ef __and__(self,
+00013450: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00013460: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+00013470: 286f 7065 7261 746f 722e 616e 645f 2c20  (operator.and_, 
+00013480: 7365 6c66 2c20 6f74 6865 7229 0a0a 2020  self, other)..  
+00013490: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
+000134a0: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
+000134b0: 2020 2020 6465 6620 5f5f 7261 6e64 5f5f      def __rand__
+000134c0: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+000134d0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+000134e0: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
+000134f0: 616e 645f 2c20 6f74 6865 722c 2073 656c  and_, other, sel
+00013500: 6629 0a0a 2020 2020 4063 6865 636b 5f69  f)..    @check_i
+00013510: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00013520: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00013530: 6469 765f 5f28 7365 6c66 2c20 6f74 6865  div__(self, othe
+00013540: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
+00013550: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
+00013560: 6174 6f72 2e64 6976 2c20 7365 6c66 2c20  ator.div, self, 
+00013570: 6f74 6865 7229 0a0a 2020 2020 4063 6865  other)..    @che
+00013580: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
+00013590: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
+000135a0: 6620 5f5f 7264 6976 5f5f 2873 656c 662c  f __rdiv__(self,
+000135b0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+000135c0: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+000135d0: 286f 7065 7261 746f 722e 6469 762c 206f  (operator.div, o
+000135e0: 7468 6572 2c20 7365 6c66 290a 0a20 2020  ther, self)..   
+000135f0: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
+00013600: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
+00013610: 2020 2064 6566 205f 5f65 715f 5f28 7365     def __eq__(se
+00013620: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00013630: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+00013640: 6973 6528 6f70 6572 6174 6f72 2e65 712c  ise(operator.eq,
+00013650: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
+00013660: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
+00013670: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
+00013680: 0a20 2020 2064 6566 205f 5f67 745f 5f28  .    def __gt__(
+00013690: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+000136a0: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
+000136b0: 6d77 6973 6528 6f70 6572 6174 6f72 2e67  mwise(operator.g
+000136c0: 742c 2073 656c 662c 206f 7468 6572 290a  t, self, other).
+000136d0: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
+000136e0: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
+000136f0: 6572 0a20 2020 2064 6566 205f 5f67 655f  er.    def __ge_
+00013700: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+00013710: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00013720: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
+00013730: 2e67 652c 2073 656c 662c 206f 7468 6572  .ge, self, other
+00013740: 290a 0a20 2020 2064 6566 205f 5f69 6e76  )..    def __inv
+00013750: 6572 745f 5f28 7365 6c66 293a 0a20 2020  ert__(self):.   
+00013760: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00013770: 7769 7365 286f 7065 7261 746f 722e 696e  wise(operator.in
+00013780: 7665 7274 2c20 7365 6c66 290a 0a20 2020  vert, self)..   
+00013790: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
+000137a0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
+000137b0: 2020 2064 6566 205f 5f6c 7368 6966 745f     def __lshift_
+000137c0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+000137d0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+000137e0: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
+000137f0: 2e6c 7368 6966 742c 2073 656c 662c 206f  .lshift, self, o
+00013800: 7468 6572 290a 0a20 2020 2040 6368 6563  ther)..    @chec
+00013810: 6b5f 6966 5f68 616e 646c 6564 5f67 6976  k_if_handled_giv
+00013820: 656e 5f6f 7468 6572 0a20 2020 2064 6566  en_other.    def
+00013830: 205f 5f72 6c73 6869 6674 5f5f 2873 656c   __rlshift__(sel
+00013840: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00013850: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
+00013860: 7365 286f 7065 7261 746f 722e 6c73 6869  se(operator.lshi
+00013870: 6674 2c20 6f74 6865 722c 2073 656c 6629  ft, other, self)
+00013880: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
+00013890: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
+000138a0: 6865 720a 2020 2020 6465 6620 5f5f 6c74  her.    def __lt
+000138b0: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+000138c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000138d0: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
+000138e0: 722e 6c74 2c20 7365 6c66 2c20 6f74 6865  r.lt, self, othe
+000138f0: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
+00013900: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00013910: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00013920: 6c65 5f5f 2873 656c 662c 206f 7468 6572  le__(self, other
+00013930: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00013940: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
+00013950: 746f 722e 6c65 2c20 7365 6c66 2c20 6f74  tor.le, self, ot
+00013960: 6865 7229 0a0a 2020 2020 4063 6865 636b  her)..    @check
+00013970: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
+00013980: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
+00013990: 5f5f 6d6f 645f 5f28 7365 6c66 2c20 6f74  __mod__(self, ot
+000139a0: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
+000139b0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
+000139c0: 6572 6174 6f72 2e6d 6f64 2c20 7365 6c66  erator.mod, self
+000139d0: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
+000139e0: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+000139f0: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+00013a00: 6465 6620 5f5f 726d 6f64 5f5f 2873 656c  def __rmod__(sel
+00013a10: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00013a20: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
+00013a30: 7365 286f 7065 7261 746f 722e 6d6f 642c  se(operator.mod,
+00013a40: 206f 7468 6572 2c20 7365 6c66 290a 0a20   other, self).. 
+00013a50: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
+00013a60: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
+00013a70: 0a20 2020 2064 6566 205f 5f6d 756c 5f5f  .    def __mul__
+00013a80: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00013a90: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+00013aa0: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
+00013ab0: 6d75 6c2c 2073 656c 662c 206f 7468 6572  mul, self, other
+00013ac0: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
+00013ad0: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
+00013ae0: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
+00013af0: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
+00013b00: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
+00013b10: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
+00013b20: 6174 6f72 2e6d 756c 2c20 6f74 6865 722c  ator.mul, other,
+00013b30: 2073 656c 6629 0a0a 2020 2020 4063 6865   self)..    @che
+00013b40: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
+00013b50: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
+00013b60: 6620 5f5f 6e65 5f5f 2873 656c 662c 206f  f __ne__(self, o
+00013b70: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
+00013b80: 6574 7572 6e20 656c 656d 7769 7365 286f  eturn elemwise(o
+00013b90: 7065 7261 746f 722e 6e65 2c20 7365 6c66  perator.ne, self
+00013ba0: 2c20 6f74 6865 7229 0a0a 2020 2020 6465  , other)..    de
+00013bb0: 6620 5f5f 6e65 675f 5f28 7365 6c66 293a  f __neg__(self):
+00013bc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013bd0: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
+00013be0: 722e 6e65 672c 2073 656c 6629 0a0a 2020  r.neg, self)..  
+00013bf0: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
+00013c00: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
+00013c10: 2020 2020 6465 6620 5f5f 6f72 5f5f 2873      def __or__(s
+00013c20: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00013c30: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00013c40: 7769 7365 286f 7065 7261 746f 722e 6f72  wise(operator.or
+00013c50: 5f2c 2073 656c 662c 206f 7468 6572 290a  _, self, other).
+00013c60: 0a20 2020 2064 6566 205f 5f70 6f73 5f5f  .    def __pos__
+00013c70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00013c80: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
+00013c90: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
+00013ca0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
+00013cb0: 2020 2064 6566 205f 5f72 6f72 5f5f 2873     def __ror__(s
+00013cc0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00013cd0: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00013ce0: 7769 7365 286f 7065 7261 746f 722e 6f72  wise(operator.or
+00013cf0: 5f2c 206f 7468 6572 2c20 7365 6c66 290a  _, other, self).
+00013d00: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
+00013d10: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
+00013d20: 6572 0a20 2020 2064 6566 205f 5f70 6f77  er.    def __pow
+00013d30: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+00013d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013d50: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
+00013d60: 722e 706f 772c 2073 656c 662c 206f 7468  r.pow, self, oth
+00013d70: 6572 290a 0a20 2020 2040 6368 6563 6b5f  er)..    @check_
+00013d80: 6966 5f68 616e 646c 6564 5f67 6976 656e  if_handled_given
+00013d90: 5f6f 7468 6572 0a20 2020 2064 6566 205f  _other.    def _
+00013da0: 5f72 706f 775f 5f28 7365 6c66 2c20 6f74  _rpow__(self, ot
+00013db0: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
+00013dc0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
+00013dd0: 6572 6174 6f72 2e70 6f77 2c20 6f74 6865  erator.pow, othe
+00013de0: 722c 2073 656c 6629 0a0a 2020 2020 4063  r, self)..    @c
+00013df0: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+00013e00: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+00013e10: 6465 6620 5f5f 7273 6869 6674 5f5f 2873  def __rshift__(s
+00013e20: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00013e30: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00013e40: 7769 7365 286f 7065 7261 746f 722e 7273  wise(operator.rs
+00013e50: 6869 6674 2c20 7365 6c66 2c20 6f74 6865  hift, self, othe
+00013e60: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
+00013e70: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00013e80: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00013e90: 7272 7368 6966 745f 5f28 7365 6c66 2c20  rrshift__(self, 
+00013ea0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00013eb0: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
+00013ec0: 6f70 6572 6174 6f72 2e72 7368 6966 742c  operator.rshift,
+00013ed0: 206f 7468 6572 2c20 7365 6c66 290a 0a20   other, self).. 
+00013ee0: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
+00013ef0: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
+00013f00: 0a20 2020 2064 6566 205f 5f73 7562 5f5f  .    def __sub__
+00013f10: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00013f20: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+00013f30: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
+00013f40: 7375 622c 2073 656c 662c 206f 7468 6572  sub, self, other
+00013f50: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
+00013f60: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
+00013f70: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
+00013f80: 7375 625f 5f28 7365 6c66 2c20 6f74 6865  sub__(self, othe
+00013f90: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
+00013fa0: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
+00013fb0: 6174 6f72 2e73 7562 2c20 6f74 6865 722c  ator.sub, other,
+00013fc0: 2073 656c 6629 0a0a 2020 2020 4063 6865   self)..    @che
+00013fd0: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
+00013fe0: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
+00013ff0: 6620 5f5f 7472 7565 6469 765f 5f28 7365  f __truediv__(se
+00014000: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00014010: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+00014020: 6973 6528 6f70 6572 6174 6f72 2e74 7275  ise(operator.tru
+00014030: 6564 6976 2c20 7365 6c66 2c20 6f74 6865  ediv, self, othe
+00014040: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
+00014050: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00014060: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00014070: 7274 7275 6564 6976 5f5f 2873 656c 662c  rtruediv__(self,
+00014080: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00014090: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+000140a0: 286f 7065 7261 746f 722e 7472 7565 6469  (operator.truedi
+000140b0: 762c 206f 7468 6572 2c20 7365 6c66 290a  v, other, self).
+000140c0: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
+000140d0: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
+000140e0: 6572 0a20 2020 2064 6566 205f 5f66 6c6f  er.    def __flo
+000140f0: 6f72 6469 765f 5f28 7365 6c66 2c20 6f74  ordiv__(self, ot
+00014100: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
+00014110: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
+00014120: 6572 6174 6f72 2e66 6c6f 6f72 6469 762c  erator.floordiv,
+00014130: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
+00014140: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
+00014150: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
+00014160: 0a20 2020 2064 6566 205f 5f72 666c 6f6f  .    def __rfloo
+00014170: 7264 6976 5f5f 2873 656c 662c 206f 7468  rdiv__(self, oth
+00014180: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
+00014190: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
+000141a0: 7261 746f 722e 666c 6f6f 7264 6976 2c20  rator.floordiv, 
+000141b0: 6f74 6865 722c 2073 656c 6629 0a0a 2020  other, self)..  
+000141c0: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
+000141d0: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
+000141e0: 2020 2020 6465 6620 5f5f 786f 725f 5f28      def __xor__(
+000141f0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+00014200: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
+00014210: 6d77 6973 6528 6f70 6572 6174 6f72 2e78  mwise(operator.x
+00014220: 6f72 2c20 7365 6c66 2c20 6f74 6865 7229  or, self, other)
+00014230: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
+00014240: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
+00014250: 6865 720a 2020 2020 6465 6620 5f5f 7278  her.    def __rx
+00014260: 6f72 5f5f 2873 656c 662c 206f 7468 6572  or__(self, other
+00014270: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00014280: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
+00014290: 746f 722e 786f 722c 206f 7468 6572 2c20  tor.xor, other, 
+000142a0: 7365 6c66 290a 0a20 2020 2040 6368 6563  self)..    @chec
+000142b0: 6b5f 6966 5f68 616e 646c 6564 5f67 6976  k_if_handled_giv
+000142c0: 656e 5f6f 7468 6572 0a20 2020 2064 6566  en_other.    def
+000142d0: 205f 5f6d 6174 6d75 6c5f 5f28 7365 6c66   __matmul__(self
+000142e0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+000142f0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+00014300: 792e 726f 7574 696e 6573 2069 6d70 6f72  y.routines impor
+00014310: 7420 6d61 746d 756c 0a0a 2020 2020 2020  t matmul..      
+00014320: 2020 7265 7475 726e 206d 6174 6d75 6c28    return matmul(
+00014330: 7365 6c66 2c20 6f74 6865 7229 0a0a 2020  self, other)..  
+00014340: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
+00014350: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
+00014360: 2020 2020 6465 6620 5f5f 726d 6174 6d75      def __rmatmu
+00014370: 6c5f 5f28 7365 6c66 2c20 6f74 6865 7229  l__(self, other)
+00014380: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
+00014390: 6173 6b2e 6172 7261 792e 726f 7574 696e  ask.array.routin
+000143a0: 6573 2069 6d70 6f72 7420 6d61 746d 756c  es import matmul
+000143b0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000143c0: 206d 6174 6d75 6c28 6f74 6865 722c 2073   matmul(other, s
+000143d0: 656c 6629 0a0a 2020 2020 4063 6865 636b  elf)..    @check
+000143e0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
+000143f0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
+00014400: 5f5f 6469 766d 6f64 5f5f 2873 656c 662c  __divmod__(self,
+00014410: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00014420: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00014430: 2e75 6675 6e63 2069 6d70 6f72 7420 6469  .ufunc import di
+00014440: 766d 6f64 0a0a 2020 2020 2020 2020 7265  vmod..        re
+00014450: 7475 726e 2064 6976 6d6f 6428 7365 6c66  turn divmod(self
+00014460: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
+00014470: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+00014480: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+00014490: 6465 6620 5f5f 7264 6976 6d6f 645f 5f28  def __rdivmod__(
+000144a0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+000144b0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+000144c0: 6172 7261 792e 7566 756e 6320 696d 706f  array.ufunc impo
+000144d0: 7274 2064 6976 6d6f 640a 0a20 2020 2020  rt divmod..     
+000144e0: 2020 2072 6574 7572 6e20 6469 766d 6f64     return divmod
+000144f0: 286f 7468 6572 2c20 7365 6c66 290a 0a20  (other, self).. 
+00014500: 2020 2064 6566 2061 6e79 2873 656c 662c     def any(self,
+00014510: 2061 7869 733d 4e6f 6e65 2c20 6b65 6570   axis=None, keep
+00014520: 6469 6d73 3d46 616c 7365 2c20 7370 6c69  dims=False, spli
+00014530: 745f 6576 6572 793d 4e6f 6e65 2c20 6f75  t_every=None, ou
+00014540: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
+00014550: 2022 2222 5265 7475 726e 7320 5472 7565   """Returns True
+00014560: 2069 6620 616e 7920 6f66 2074 6865 2065   if any of the e
+00014570: 6c65 6d65 6e74 7320 6576 616c 7561 7465  lements evaluate
+00014580: 2074 6f20 5472 7565 2e0a 0a20 2020 2020   to True...     
+00014590: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
+000145a0: 633a 6064 6173 6b2e 6172 7261 792e 616e  c:`dask.array.an
+000145b0: 7960 2066 6f72 2066 756c 6c20 646f 6375  y` for full docu
+000145c0: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+000145d0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+000145e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+000145f0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00014600: 2e61 6e79 203a 2065 7175 6976 616c 656e  .any : equivalen
+00014610: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+00014620: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00014630: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
+00014640: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
+00014650: 2061 6e79 0a0a 2020 2020 2020 2020 7265   any..        re
+00014660: 7475 726e 2061 6e79 2873 656c 662c 2061  turn any(self, a
+00014670: 7869 733d 6178 6973 2c20 6b65 6570 6469  xis=axis, keepdi
+00014680: 6d73 3d6b 6565 7064 696d 732c 2073 706c  ms=keepdims, spl
+00014690: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+000146a0: 7665 7279 2c20 6f75 743d 6f75 7429 0a0a  very, out=out)..
+000146b0: 2020 2020 6465 6620 616c 6c28 7365 6c66      def all(self
+000146c0: 2c20 6178 6973 3d4e 6f6e 652c 206b 6565  , axis=None, kee
+000146d0: 7064 696d 733d 4661 6c73 652c 2073 706c  pdims=False, spl
+000146e0: 6974 5f65 7665 7279 3d4e 6f6e 652c 206f  it_every=None, o
+000146f0: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
+00014700: 2020 2222 2252 6574 7572 6e73 2054 7275    """Returns Tru
+00014710: 6520 6966 2061 6c6c 2065 6c65 6d65 6e74  e if all element
+00014720: 7320 6576 616c 7561 7465 2074 6f20 5472  s evaluate to Tr
+00014730: 7565 2e0a 0a20 2020 2020 2020 2052 6566  ue...        Ref
+00014740: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+00014750: 6b2e 6172 7261 792e 616c 6c60 2066 6f72  k.array.all` for
+00014760: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+00014770: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00014780: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00014790: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000147a0: 6461 736b 2e61 7272 6179 2e61 6c6c 203a  dask.array.all :
+000147b0: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
+000147c0: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+000147d0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+000147e0: 736b 2e61 7272 6179 2e72 6564 7563 7469  sk.array.reducti
+000147f0: 6f6e 7320 696d 706f 7274 2061 6c6c 0a0a  ons import all..
+00014800: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00014810: 6c6c 2873 656c 662c 2061 7869 733d 6178  ll(self, axis=ax
+00014820: 6973 2c20 6b65 6570 6469 6d73 3d6b 6565  is, keepdims=kee
+00014830: 7064 696d 732c 2073 706c 6974 5f65 7665  pdims, split_eve
+00014840: 7279 3d73 706c 6974 5f65 7665 7279 2c20  ry=split_every, 
+00014850: 6f75 743d 6f75 7429 0a0a 2020 2020 6465  out=out)..    de
+00014860: 6620 6d69 6e28 7365 6c66 2c20 6178 6973  f min(self, axis
+00014870: 3d4e 6f6e 652c 206b 6565 7064 696d 733d  =None, keepdims=
+00014880: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
+00014890: 7279 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  ry=None, out=Non
+000148a0: 6529 3a0a 2020 2020 2020 2020 2222 2252  e):.        """R
+000148b0: 6574 7572 6e20 7468 6520 6d69 6e69 6d75  eturn the minimu
+000148c0: 6d20 616c 6f6e 6720 6120 6769 7665 6e20  m along a given 
+000148d0: 6178 6973 2e0a 0a20 2020 2020 2020 2052  axis...        R
+000148e0: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
+000148f0: 6173 6b2e 6172 7261 792e 6d69 6e60 2066  ask.array.min` f
+00014900: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
+00014910: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00014920: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+00014930: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00014940: 2020 6461 736b 2e61 7272 6179 2e6d 696e    dask.array.min
+00014950: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
+00014960: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
+00014970: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00014980: 6461 736b 2e61 7272 6179 2e72 6564 7563  dask.array.reduc
+00014990: 7469 6f6e 7320 696d 706f 7274 206d 696e  tions import min
+000149a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000149b0: 206d 696e 2873 656c 662c 2061 7869 733d   min(self, axis=
+000149c0: 6178 6973 2c20 6b65 6570 6469 6d73 3d6b  axis, keepdims=k
+000149d0: 6565 7064 696d 732c 2073 706c 6974 5f65  eepdims, split_e
+000149e0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+000149f0: 2c20 6f75 743d 6f75 7429 0a0a 2020 2020  , out=out)..    
+00014a00: 6465 6620 6d61 7828 7365 6c66 2c20 6178  def max(self, ax
+00014a10: 6973 3d4e 6f6e 652c 206b 6565 7064 696d  is=None, keepdim
+00014a20: 733d 4661 6c73 652c 2073 706c 6974 5f65  s=False, split_e
+00014a30: 7665 7279 3d4e 6f6e 652c 206f 7574 3d4e  very=None, out=N
+00014a40: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+00014a50: 2252 6574 7572 6e20 7468 6520 6d61 7869  "Return the maxi
+00014a60: 6d75 6d20 616c 6f6e 6720 6120 6769 7665  mum along a give
+00014a70: 6e20 6178 6973 2e0a 0a20 2020 2020 2020  n axis...       
+00014a80: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
+00014a90: 6064 6173 6b2e 6172 7261 792e 6d61 7860  `dask.array.max`
+00014aa0: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
+00014ab0: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
+00014ac0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00014ad0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00014ae0: 2020 2020 6461 736b 2e61 7272 6179 2e6d      dask.array.m
+00014af0: 6178 203a 2065 7175 6976 616c 656e 7420  ax : equivalent 
+00014b00: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00014b10: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00014b20: 6d20 6461 736b 2e61 7272 6179 2e72 6564  m dask.array.red
+00014b30: 7563 7469 6f6e 7320 696d 706f 7274 206d  uctions import m
+00014b40: 6178 0a0a 2020 2020 2020 2020 7265 7475  ax..        retu
+00014b50: 726e 206d 6178 2873 656c 662c 2061 7869  rn max(self, axi
+00014b60: 733d 6178 6973 2c20 6b65 6570 6469 6d73  s=axis, keepdims
+00014b70: 3d6b 6565 7064 696d 732c 2073 706c 6974  =keepdims, split
+00014b80: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00014b90: 7279 2c20 6f75 743d 6f75 7429 0a0a 2020  ry, out=out)..  
+00014ba0: 2020 6465 6620 6172 676d 696e 2873 656c    def argmin(sel
+00014bb0: 662c 2061 7869 733d 4e6f 6e65 2c20 2a2c  f, axis=None, *,
+00014bc0: 206b 6565 7064 696d 733d 4661 6c73 652c   keepdims=False,
+00014bd0: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
+00014be0: 652c 206f 7574 3d4e 6f6e 6529 3a0a 2020  e, out=None):.  
+00014bf0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00014c00: 696e 6469 6365 7320 6f66 2074 6865 206d  indices of the m
+00014c10: 696e 696d 756d 2076 616c 7565 7320 616c  inimum values al
+00014c20: 6f6e 6720 7468 6520 6769 7665 6e20 6178  ong the given ax
+00014c30: 6973 2e0a 0a20 2020 2020 2020 2052 6566  is...        Ref
+00014c40: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+00014c50: 6b2e 6172 7261 792e 6172 676d 696e 6020  k.array.argmin` 
+00014c60: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
+00014c70: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+00014c80: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00014c90: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00014ca0: 2020 2064 6173 6b2e 6172 7261 792e 6172     dask.array.ar
+00014cb0: 676d 696e 203a 2065 7175 6976 616c 656e  gmin : equivalen
+00014cc0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+00014cd0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00014ce0: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
+00014cf0: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
+00014d00: 2061 7267 6d69 6e0a 0a20 2020 2020 2020   argmin..       
+00014d10: 2072 6574 7572 6e20 6172 676d 696e 280a   return argmin(.
+00014d20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00014d30: 2c20 6178 6973 3d61 7869 732c 206b 6565  , axis=axis, kee
+00014d40: 7064 696d 733d 6b65 6570 6469 6d73 2c20  pdims=keepdims, 
+00014d50: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00014d60: 745f 6576 6572 792c 206f 7574 3d6f 7574  t_every, out=out
+00014d70: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00014d80: 6465 6620 6172 676d 6178 2873 656c 662c  def argmax(self,
+00014d90: 2061 7869 733d 4e6f 6e65 2c20 2a2c 206b   axis=None, *, k
+00014da0: 6565 7064 696d 733d 4661 6c73 652c 2073  eepdims=False, s
+00014db0: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+00014dc0: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
+00014dd0: 2020 2020 2222 2252 6574 7572 6e20 696e      """Return in
+00014de0: 6469 6365 7320 6f66 2074 6865 206d 6178  dices of the max
+00014df0: 696d 756d 2076 616c 7565 7320 616c 6f6e  imum values alon
+00014e00: 6720 7468 6520 6769 7665 6e20 6178 6973  g the given axis
+00014e10: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
+00014e20: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
+00014e30: 6172 7261 792e 6172 676d 6178 6020 666f  array.argmax` fo
+00014e40: 7220 6675 6c6c 2064 6f63 756d 656e 7461  r full documenta
+00014e50: 7469 6f6e 2e0a 0a20 2020 2020 2020 2053  tion...        S
+00014e60: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+00014e70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00014e80: 2064 6173 6b2e 6172 7261 792e 6172 676d   dask.array.argm
+00014e90: 6178 203a 2065 7175 6976 616c 656e 7420  ax : equivalent 
+00014ea0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00014eb0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00014ec0: 6d20 6461 736b 2e61 7272 6179 2e72 6564  m dask.array.red
+00014ed0: 7563 7469 6f6e 7320 696d 706f 7274 2061  uctions import a
+00014ee0: 7267 6d61 780a 0a20 2020 2020 2020 2072  rgmax..        r
+00014ef0: 6574 7572 6e20 6172 676d 6178 280a 2020  eturn argmax(.  
+00014f00: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00014f10: 6178 6973 3d61 7869 732c 206b 6565 7064  axis=axis, keepd
+00014f20: 696d 733d 6b65 6570 6469 6d73 2c20 7370  ims=keepdims, sp
+00014f30: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00014f40: 6576 6572 792c 206f 7574 3d6f 7574 0a20  every, out=out. 
+00014f50: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00014f60: 6620 7375 6d28 7365 6c66 2c20 6178 6973  f sum(self, axis
+00014f70: 3d4e 6f6e 652c 2064 7479 7065 3d4e 6f6e  =None, dtype=Non
+00014f80: 652c 206b 6565 7064 696d 733d 4661 6c73  e, keepdims=Fals
+00014f90: 652c 2073 706c 6974 5f65 7665 7279 3d4e  e, split_every=N
+00014fa0: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
+00014fb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00014fc0: 2020 2020 5265 7475 726e 2074 6865 2073      Return the s
+00014fd0: 756d 206f 6620 7468 6520 6172 7261 7920  um of the array 
+00014fe0: 656c 656d 656e 7473 206f 7665 7220 7468  elements over th
+00014ff0: 6520 6769 7665 6e20 6178 6973 2e0a 0a20  e given axis... 
+00015000: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
+00015010: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
+00015020: 792e 7375 6d60 2066 6f72 2066 756c 6c20  y.sum` for full 
+00015030: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
+00015040: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+00015050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015060: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
+00015070: 7272 6179 2e73 756d 203a 2065 7175 6976  rray.sum : equiv
+00015080: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
+00015090: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000150a0: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+000150b0: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
+000150c0: 706f 7274 2073 756d 0a0a 2020 2020 2020  port sum..      
+000150d0: 2020 7265 7475 726e 2073 756d 280a 2020    return sum(.  
+000150e0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+000150f0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00015100: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+00015110: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
+00015120: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
+00015130: 6469 6d73 3d6b 6565 7064 696d 732c 0a20  dims=keepdims,. 
+00015140: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00015150: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00015160: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+00015170: 6f75 743d 6f75 742c 0a20 2020 2020 2020  out=out,.       
+00015180: 2029 0a0a 2020 2020 6465 6620 7472 6163   )..    def trac
+00015190: 6528 7365 6c66 2c20 6f66 6673 6574 3d30  e(self, offset=0
+000151a0: 2c20 6178 6973 313d 302c 2061 7869 7332  , axis1=0, axis2
+000151b0: 3d31 2c20 6474 7970 653d 4e6f 6e65 293a  =1, dtype=None):
+000151c0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+000151d0: 726e 2074 6865 2073 756d 2061 6c6f 6e67  rn the sum along
+000151e0: 2064 6961 676f 6e61 6c73 206f 6620 7468   diagonals of th
+000151f0: 6520 6172 7261 792e 0a0a 2020 2020 2020  e array...      
+00015200: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
+00015210: 3a60 6461 736b 2e61 7272 6179 2e74 7261  :`dask.array.tra
+00015220: 6365 6020 666f 7220 6675 6c6c 2064 6f63  ce` for full doc
+00015230: 756d 656e 7461 7469 6f6e 2e0a 0a20 2020  umentation...   
+00015240: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00015250: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00015260: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
+00015270: 792e 7472 6163 6520 3a20 6571 7569 7661  y.trace : equiva
+00015280: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
+00015290: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000152a0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+000152b0: 792e 7265 6475 6374 696f 6e73 2069 6d70  y.reductions imp
+000152c0: 6f72 7420 7472 6163 650a 0a20 2020 2020  ort trace..     
+000152d0: 2020 2072 6574 7572 6e20 7472 6163 6528     return trace(
+000152e0: 7365 6c66 2c20 6f66 6673 6574 3d6f 6666  self, offset=off
+000152f0: 7365 742c 2061 7869 7331 3d61 7869 7331  set, axis1=axis1
+00015300: 2c20 6178 6973 323d 6178 6973 322c 2064  , axis2=axis2, d
+00015310: 7479 7065 3d64 7479 7065 290a 0a20 2020  type=dtype)..   
+00015320: 2064 6566 2070 726f 6428 7365 6c66 2c20   def prod(self, 
+00015330: 6178 6973 3d4e 6f6e 652c 2064 7479 7065  axis=None, dtype
+00015340: 3d4e 6f6e 652c 206b 6565 7064 696d 733d  =None, keepdims=
+00015350: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
+00015360: 7279 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  ry=None, out=Non
+00015370: 6529 3a0a 2020 2020 2020 2020 2222 2252  e):.        """R
+00015380: 6574 7572 6e20 7468 6520 7072 6f64 7563  eturn the produc
+00015390: 7420 6f66 2074 6865 2061 7272 6179 2065  t of the array e
+000153a0: 6c65 6d65 6e74 7320 6f76 6572 2074 6865  lements over the
+000153b0: 2067 6976 656e 2061 7869 730a 0a20 2020   given axis..   
+000153c0: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
+000153d0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+000153e0: 7072 6f64 6020 666f 7220 6675 6c6c 2064  prod` for full d
+000153f0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
+00015400: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00015410: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00015420: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
+00015430: 7261 792e 7072 6f64 203a 2065 7175 6976  ray.prod : equiv
+00015440: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
+00015450: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00015460: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+00015470: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
+00015480: 706f 7274 2070 726f 640a 0a20 2020 2020  port prod..     
+00015490: 2020 2072 6574 7572 6e20 7072 6f64 280a     return prod(.
+000154a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000154b0: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
+000154c0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+000154d0: 2020 2020 2064 7479 7065 3d64 7479 7065       dtype=dtype
+000154e0: 2c0a 2020 2020 2020 2020 2020 2020 6b65  ,.            ke
+000154f0: 6570 6469 6d73 3d6b 6565 7064 696d 732c  epdims=keepdims,
+00015500: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00015510: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00015520: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+00015530: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+00015540: 2020 2029 0a0a 2020 2020 6465 6620 6d65     )..    def me
+00015550: 616e 2873 656c 662c 2061 7869 733d 4e6f  an(self, axis=No
+00015560: 6e65 2c20 6474 7970 653d 4e6f 6e65 2c20  ne, dtype=None, 
+00015570: 6b65 6570 6469 6d73 3d46 616c 7365 2c20  keepdims=False, 
+00015580: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
+00015590: 2c20 6f75 743d 4e6f 6e65 293a 0a20 2020  , out=None):.   
+000155a0: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
+000155b0: 7468 6520 6176 6572 6167 6520 6f66 2074  the average of t
+000155c0: 6865 2061 7272 6179 2065 6c65 6d65 6e74  he array element
+000155d0: 7320 616c 6f6e 6720 6769 7665 6e20 6178  s along given ax
+000155e0: 6973 2e0a 0a20 2020 2020 2020 2052 6566  is...        Ref
+000155f0: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+00015600: 6b2e 6172 7261 792e 6d65 616e 6020 666f  k.array.mean` fo
+00015610: 7220 6675 6c6c 2064 6f63 756d 656e 7461  r full documenta
+00015620: 7469 6f6e 2e0a 0a20 2020 2020 2020 2053  tion...        S
+00015630: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+00015640: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00015650: 2064 6173 6b2e 6172 7261 792e 6d65 616e   dask.array.mean
+00015660: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
+00015670: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
+00015680: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00015690: 6461 736b 2e61 7272 6179 2e72 6564 7563  dask.array.reduc
+000156a0: 7469 6f6e 7320 696d 706f 7274 206d 6561  tions import mea
+000156b0: 6e0a 0a20 2020 2020 2020 2072 6574 7572  n..        retur
+000156c0: 6e20 6d65 616e 280a 2020 2020 2020 2020  n mean(.        
+000156d0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000156e0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+000156f0: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
+00015700: 7065 3d64 7479 7065 2c0a 2020 2020 2020  pe=dtype,.      
+00015710: 2020 2020 2020 6b65 6570 6469 6d73 3d6b        keepdims=k
+00015720: 6565 7064 696d 732c 0a20 2020 2020 2020  eepdims,.       
+00015730: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+00015740: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+00015750: 2020 2020 2020 2020 2020 6f75 743d 6f75            out=ou
+00015760: 742c 0a20 2020 2020 2020 2029 0a0a 2020  t,.        )..  
+00015770: 2020 6465 6620 7374 6428 0a20 2020 2020    def std(.     
+00015780: 2020 2073 656c 662c 2061 7869 733d 4e6f     self, axis=No
+00015790: 6e65 2c20 6474 7970 653d 4e6f 6e65 2c20  ne, dtype=None, 
+000157a0: 6b65 6570 6469 6d73 3d46 616c 7365 2c20  keepdims=False, 
+000157b0: 6464 6f66 3d30 2c20 7370 6c69 745f 6576  ddof=0, split_ev
+000157c0: 6572 793d 4e6f 6e65 2c20 6f75 743d 4e6f  ery=None, out=No
+000157d0: 6e65 0a20 2020 2029 3a0a 2020 2020 2020  ne.    ):.      
+000157e0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+000157f0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+00015800: 696f 6e20 6f66 2074 6865 2061 7272 6179  ion of the array
+00015810: 2065 6c65 6d65 6e74 7320 616c 6f6e 6720   elements along 
+00015820: 6769 7665 6e20 6178 6973 2e0a 0a20 2020  given axis...   
+00015830: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
+00015840: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+00015850: 7374 6460 2066 6f72 2066 756c 6c20 646f  std` for full do
+00015860: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
+00015870: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
+00015880: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00015890: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
+000158a0: 6179 2e73 7464 203a 2065 7175 6976 616c  ay.std : equival
+000158b0: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
+000158c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000158d0: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+000158e0: 2e72 6564 7563 7469 6f6e 7320 696d 706f  .reductions impo
+000158f0: 7274 2073 7464 0a0a 2020 2020 2020 2020  rt std..        
+00015900: 7265 7475 726e 2073 7464 280a 2020 2020  return std(.    
+00015910: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00015920: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+00015930: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+00015940: 2064 7479 7065 3d64 7479 7065 2c0a 2020   dtype=dtype,.  
+00015950: 2020 2020 2020 2020 2020 6b65 6570 6469            keepdi
+00015960: 6d73 3d6b 6565 7064 696d 732c 0a20 2020  ms=keepdims,.   
+00015970: 2020 2020 2020 2020 2064 646f 663d 6464           ddof=dd
+00015980: 6f66 2c0a 2020 2020 2020 2020 2020 2020  of,.            
+00015990: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+000159a0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+000159b0: 2020 2020 206f 7574 3d6f 7574 2c0a 2020       out=out,.  
+000159c0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+000159d0: 2076 6172 280a 2020 2020 2020 2020 7365   var(.        se
+000159e0: 6c66 2c20 6178 6973 3d4e 6f6e 652c 2064  lf, axis=None, d
+000159f0: 7479 7065 3d4e 6f6e 652c 206b 6565 7064  type=None, keepd
+00015a00: 696d 733d 4661 6c73 652c 2064 646f 663d  ims=False, ddof=
+00015a10: 302c 2073 706c 6974 5f65 7665 7279 3d4e  0, split_every=N
+00015a20: 6f6e 652c 206f 7574 3d4e 6f6e 650a 2020  one, out=None.  
+00015a30: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00015a40: 5265 7475 726e 7320 7468 6520 7661 7269  Returns the vari
+00015a50: 616e 6365 206f 6620 7468 6520 6172 7261  ance of the arra
+00015a60: 7920 656c 656d 656e 7473 2c20 616c 6f6e  y elements, alon
+00015a70: 6720 6769 7665 6e20 6178 6973 2e0a 0a20  g given axis... 
+00015a80: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
+00015a90: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
+00015aa0: 792e 7661 7260 2066 6f72 2066 756c 6c20  y.var` for full 
+00015ab0: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
+00015ac0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+00015ad0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015ae0: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
+00015af0: 7272 6179 2e76 6172 203a 2065 7175 6976  rray.var : equiv
+00015b00: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
+00015b10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00015b20: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+00015b30: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
+00015b40: 706f 7274 2076 6172 0a0a 2020 2020 2020  port var..      
+00015b50: 2020 7265 7475 726e 2076 6172 280a 2020    return var(.  
+00015b60: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+00015b70: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00015b80: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+00015b90: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
+00015ba0: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
+00015bb0: 6469 6d73 3d6b 6565 7064 696d 732c 0a20  dims=keepdims,. 
+00015bc0: 2020 2020 2020 2020 2020 2064 646f 663d             ddof=
+00015bd0: 6464 6f66 2c0a 2020 2020 2020 2020 2020  ddof,.          
+00015be0: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00015bf0: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00015c00: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
+00015c10: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00015c20: 6566 206d 6f6d 656e 7428 0a20 2020 2020  ef moment(.     
+00015c30: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00015c40: 206f 7264 6572 2c0a 2020 2020 2020 2020   order,.        
+00015c50: 6178 6973 3d4e 6f6e 652c 0a20 2020 2020  axis=None,.     
+00015c60: 2020 2064 7479 7065 3d4e 6f6e 652c 0a20     dtype=None,. 
+00015c70: 2020 2020 2020 206b 6565 7064 696d 733d         keepdims=
+00015c80: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
+00015c90: 646f 663d 302c 0a20 2020 2020 2020 2073  dof=0,.        s
+00015ca0: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+00015cb0: 0a20 2020 2020 2020 206f 7574 3d4e 6f6e  .        out=Non
+00015cc0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00015cd0: 2020 2222 2243 616c 6375 6c61 7465 2074    """Calculate t
+00015ce0: 6865 206e 7468 2063 656e 7472 616c 697a  he nth centraliz
+00015cf0: 6564 206d 6f6d 656e 742e 0a0a 2020 2020  ed moment...    
+00015d00: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
+00015d10: 6e63 3a60 6461 736b 2e61 7272 6179 2e6d  nc:`dask.array.m
+00015d20: 6f6d 656e 7460 2066 6f72 2074 6865 2066  oment` for the f
+00015d30: 756c 6c20 646f 6375 6d65 6e74 6174 696f  ull documentatio
+00015d40: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
+00015d50: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00015d60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+00015d70: 736b 2e61 7272 6179 2e6d 6f6d 656e 7420  sk.array.moment 
+00015d80: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
+00015d90: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
+00015da0: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
+00015db0: 6173 6b2e 6172 7261 792e 7265 6475 6374  ask.array.reduct
+00015dc0: 696f 6e73 2069 6d70 6f72 7420 6d6f 6d65  ions import mome
+00015dd0: 6e74 0a0a 2020 2020 2020 2020 7265 7475  nt..        retu
+00015de0: 726e 206d 6f6d 656e 7428 0a20 2020 2020  rn moment(.     
+00015df0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00015e00: 2020 2020 2020 2020 206f 7264 6572 2c0a           order,.
+00015e10: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00015e20: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+00015e30: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
+00015e40: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
+00015e50: 6469 6d73 3d6b 6565 7064 696d 732c 0a20  dims=keepdims,. 
+00015e60: 2020 2020 2020 2020 2020 2064 646f 663d             ddof=
+00015e70: 6464 6f66 2c0a 2020 2020 2020 2020 2020  ddof,.          
+00015e80: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00015e90: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00015ea0: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
+00015eb0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00015ec0: 7772 6170 7328 6d61 705f 626c 6f63 6b73  wraps(map_blocks
+00015ed0: 290a 2020 2020 6465 6620 6d61 705f 626c  ).    def map_bl
+00015ee0: 6f63 6b73 2873 656c 662c 2066 756e 632c  ocks(self, func,
+00015ef0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00015f00: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00015f10: 6e20 6d61 705f 626c 6f63 6b73 2866 756e  n map_blocks(fun
+00015f20: 632c 2073 656c 662c 202a 6172 6773 2c20  c, self, *args, 
+00015f30: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
+00015f40: 6566 206d 6170 5f6f 7665 726c 6170 2873  ef map_overlap(s
+00015f50: 656c 662c 2066 756e 632c 2064 6570 7468  elf, func, depth
+00015f60: 2c20 626f 756e 6461 7279 3d4e 6f6e 652c  , boundary=None,
+00015f70: 2074 7269 6d3d 5472 7565 2c20 2a2a 6b77   trim=True, **kw
+00015f80: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+00015f90: 2222 4d61 7020 6120 6675 6e63 7469 6f6e  ""Map a function
+00015fa0: 206f 7665 7220 626c 6f63 6b73 206f 6620   over blocks of 
+00015fb0: 7468 6520 6172 7261 7920 7769 7468 2073  the array with s
+00015fc0: 6f6d 6520 6f76 6572 6c61 700a 0a20 2020  ome overlap..   
+00015fd0: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
+00015fe0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+00015ff0: 6d61 705f 6f76 6572 6c61 7060 2066 6f72  map_overlap` for
+00016000: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+00016010: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00016020: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00016030: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016040: 6461 736b 2e61 7272 6179 2e6d 6170 5f6f  dask.array.map_o
+00016050: 7665 726c 6170 203a 2065 7175 6976 616c  verlap : equival
+00016060: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
+00016070: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016080: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00016090: 2e6f 7665 726c 6170 2069 6d70 6f72 7420  .overlap import 
+000160a0: 6d61 705f 6f76 6572 6c61 700a 0a20 2020  map_overlap..   
+000160b0: 2020 2020 2072 6574 7572 6e20 6d61 705f       return map_
+000160c0: 6f76 6572 6c61 7028 0a20 2020 2020 2020  overlap(.       
+000160d0: 2020 2020 2066 756e 632c 2073 656c 662c       func, self,
+000160e0: 2064 6570 7468 3d64 6570 7468 2c20 626f   depth=depth, bo
+000160f0: 756e 6461 7279 3d62 6f75 6e64 6172 792c  undary=boundary,
+00016100: 2074 7269 6d3d 7472 696d 2c20 2a2a 6b77   trim=trim, **kw
+00016110: 6172 6773 0a20 2020 2020 2020 2029 0a0a  args.        )..
+00016120: 2020 2020 6465 6620 6375 6d73 756d 2873      def cumsum(s
+00016130: 656c 662c 2061 7869 732c 2064 7479 7065  elf, axis, dtype
+00016140: 3d4e 6f6e 652c 206f 7574 3d4e 6f6e 652c  =None, out=None,
+00016150: 202a 2c20 6d65 7468 6f64 3d22 7365 7175   *, method="sequ
+00016160: 656e 7469 616c 2229 3a0a 2020 2020 2020  ential"):.      
+00016170: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+00016180: 6375 6d75 6c61 7469 7665 2073 756d 206f  cumulative sum o
+00016190: 6620 7468 6520 656c 656d 656e 7473 2061  f the elements a
+000161a0: 6c6f 6e67 2074 6865 2067 6976 656e 2061  long the given a
+000161b0: 7869 732e 0a0a 2020 2020 2020 2020 5265  xis...        Re
+000161c0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
+000161d0: 736b 2e61 7272 6179 2e63 756d 7375 6d60  sk.array.cumsum`
+000161e0: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
+000161f0: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
+00016200: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00016210: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00016220: 2020 2020 6461 736b 2e61 7272 6179 2e63      dask.array.c
+00016230: 756d 7375 6d20 3a20 6571 7569 7661 6c65  umsum : equivale
+00016240: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
+00016250: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00016260: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+00016270: 7265 6475 6374 696f 6e73 2069 6d70 6f72  reductions impor
+00016280: 7420 6375 6d73 756d 0a0a 2020 2020 2020  t cumsum..      
+00016290: 2020 7265 7475 726e 2063 756d 7375 6d28    return cumsum(
+000162a0: 7365 6c66 2c20 6178 6973 2c20 6474 7970  self, axis, dtyp
+000162b0: 652c 206f 7574 3d6f 7574 2c20 6d65 7468  e, out=out, meth
+000162c0: 6f64 3d6d 6574 686f 6429 0a0a 2020 2020  od=method)..    
+000162d0: 6465 6620 6375 6d70 726f 6428 7365 6c66  def cumprod(self
+000162e0: 2c20 6178 6973 2c20 6474 7970 653d 4e6f  , axis, dtype=No
+000162f0: 6e65 2c20 6f75 743d 4e6f 6e65 2c20 2a2c  ne, out=None, *,
+00016300: 206d 6574 686f 643d 2273 6571 7565 6e74   method="sequent
+00016310: 6961 6c22 293a 0a20 2020 2020 2020 2022  ial"):.        "
+00016320: 2222 5265 7475 726e 2074 6865 2063 756d  ""Return the cum
+00016330: 756c 6174 6976 6520 7072 6f64 7563 7420  ulative product 
+00016340: 6f66 2074 6865 2065 6c65 6d65 6e74 7320  of the elements 
+00016350: 616c 6f6e 6720 7468 6520 6769 7665 6e20  along the given 
+00016360: 6178 6973 2e0a 0a20 2020 2020 2020 2052  axis...        R
+00016370: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
+00016380: 6173 6b2e 6172 7261 792e 6375 6d70 726f  ask.array.cumpro
+00016390: 6460 2066 6f72 2066 756c 6c20 646f 6375  d` for full docu
+000163a0: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+000163b0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+000163c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+000163d0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+000163e0: 2e63 756d 7072 6f64 203a 2065 7175 6976  .cumprod : equiv
+000163f0: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
+00016400: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00016410: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+00016420: 6179 2e72 6564 7563 7469 6f6e 7320 696d  ay.reductions im
+00016430: 706f 7274 2063 756d 7072 6f64 0a0a 2020  port cumprod..  
+00016440: 2020 2020 2020 7265 7475 726e 2063 756d        return cum
+00016450: 7072 6f64 2873 656c 662c 2061 7869 732c  prod(self, axis,
+00016460: 2064 7479 7065 2c20 6f75 743d 6f75 742c   dtype, out=out,
+00016470: 206d 6574 686f 643d 6d65 7468 6f64 290a   method=method).
+00016480: 0a20 2020 2064 6566 2073 7175 6565 7a65  .    def squeeze
+00016490: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
+000164a0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000164b0: 6d6f 7665 2061 7865 7320 6f66 206c 656e  move axes of len
+000164c0: 6774 6820 6f6e 6520 6672 6f6d 2061 7272  gth one from arr
+000164d0: 6179 2e0a 0a20 2020 2020 2020 2052 6566  ay...        Ref
+000164e0: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+000164f0: 6b2e 6172 7261 792e 7371 7565 657a 6560  k.array.squeeze`
+00016500: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
+00016510: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
+00016520: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00016530: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00016540: 2020 2020 6461 736b 2e61 7272 6179 2e73      dask.array.s
+00016550: 7175 6565 7a65 203a 2065 7175 6976 616c  queeze : equival
+00016560: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
+00016570: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016580: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00016590: 2e72 6f75 7469 6e65 7320 696d 706f 7274  .routines import
+000165a0: 2073 7175 6565 7a65 0a0a 2020 2020 2020   squeeze..      
+000165b0: 2020 7265 7475 726e 2073 7175 6565 7a65    return squeeze
+000165c0: 2873 656c 662c 2061 7869 7329 0a0a 2020  (self, axis)..  
+000165d0: 2020 6465 6620 7265 6368 756e 6b28 0a20    def rechunk(. 
+000165e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+000165f0: 2020 2020 2063 6875 6e6b 733d 2261 7574       chunks="aut
+00016600: 6f22 2c0a 2020 2020 2020 2020 7468 7265  o",.        thre
+00016610: 7368 6f6c 643d 4e6f 6e65 2c0a 2020 2020  shold=None,.    
+00016620: 2020 2020 626c 6f63 6b5f 7369 7a65 5f6c      block_size_l
+00016630: 696d 6974 3d4e 6f6e 652c 0a20 2020 2020  imit=None,.     
+00016640: 2020 2062 616c 616e 6365 3d46 616c 7365     balance=False
+00016650: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
+00016660: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
+00016670: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
+00016680: 2062 6c6f 636b 7320 696e 2064 6173 6b20   blocks in dask 
+00016690: 6172 7261 7920 7820 666f 7220 6e65 7720  array x for new 
+000166a0: 6368 756e 6b73 2e0a 0a20 2020 2020 2020  chunks...       
+000166b0: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
+000166c0: 6064 6173 6b2e 6172 7261 792e 7265 6368  `dask.array.rech
+000166d0: 756e 6b60 2066 6f72 2066 756c 6c20 646f  unk` for full do
+000166e0: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
+000166f0: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
+00016700: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00016710: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
+00016720: 6179 2e72 6563 6875 6e6b 203a 2065 7175  ay.rechunk : equ
+00016730: 6976 616c 656e 7420 6675 6e63 7469 6f6e  ivalent function
+00016740: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00016750: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
+00016760: 7272 6179 2e72 6563 6875 6e6b 2069 6d70  rray.rechunk imp
+00016770: 6f72 7420 7265 6368 756e 6b20 2023 2061  ort rechunk  # a
+00016780: 766f 6964 2063 6972 6375 6c61 7220 696d  void circular im
+00016790: 706f 7274 0a0a 2020 2020 2020 2020 7265  port..        re
+000167a0: 7475 726e 2072 6563 6875 6e6b 2873 656c  turn rechunk(sel
+000167b0: 662c 2063 6875 6e6b 732c 2074 6872 6573  f, chunks, thres
+000167c0: 686f 6c64 2c20 626c 6f63 6b5f 7369 7a65  hold, block_size
+000167d0: 5f6c 696d 6974 2c20 6261 6c61 6e63 652c  _limit, balance,
+000167e0: 206d 6574 686f 6429 0a0a 2020 2020 4070   method)..    @p
+000167f0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00016800: 7265 616c 2873 656c 6629 3a0a 2020 2020  real(self):.    
+00016810: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
+00016820: 7261 792e 7566 756e 6320 696d 706f 7274  ray.ufunc import
+00016830: 2072 6561 6c0a 0a20 2020 2020 2020 2072   real..        r
+00016840: 6574 7572 6e20 7265 616c 2873 656c 6629  eturn real(self)
+00016850: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00016860: 2020 2020 6465 6620 696d 6167 2873 656c      def imag(sel
+00016870: 6629 3a0a 2020 2020 2020 2020 6672 6f6d  f):.        from
+00016880: 2064 6173 6b2e 6172 7261 792e 7566 756e   dask.array.ufun
+00016890: 6320 696d 706f 7274 2069 6d61 670a 0a20  c import imag.. 
+000168a0: 2020 2020 2020 2072 6574 7572 6e20 696d         return im
+000168b0: 6167 2873 656c 6629 0a0a 2020 2020 6465  ag(self)..    de
+000168c0: 6620 636f 6e6a 2873 656c 6629 3a0a 2020  f conj(self):.  
+000168d0: 2020 2020 2020 2222 2243 6f6d 706c 6578        """Complex
+000168e0: 2d63 6f6e 6a75 6761 7465 2061 6c6c 2065  -conjugate all e
+000168f0: 6c65 6d65 6e74 732e 0a0a 2020 2020 2020  lements...      
+00016900: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
+00016910: 3a60 6461 736b 2e61 7272 6179 2e63 6f6e  :`dask.array.con
+00016920: 6a60 2066 6f72 2066 756c 6c20 646f 6375  j` for full docu
+00016930: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+00016940: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00016950: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00016960: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00016970: 2e63 6f6e 6a20 3a20 6571 7569 7661 6c65  .conj : equivale
+00016980: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
+00016990: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000169a0: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+000169b0: 7566 756e 6320 696d 706f 7274 2063 6f6e  ufunc import con
+000169c0: 6a0a 0a20 2020 2020 2020 2072 6574 7572  j..        retur
+000169d0: 6e20 636f 6e6a 2873 656c 6629 0a0a 2020  n conj(self)..  
+000169e0: 2020 6465 6620 636c 6970 2873 656c 662c    def clip(self,
+000169f0: 206d 696e 3d4e 6f6e 652c 206d 6178 3d4e   min=None, max=N
+00016a00: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+00016a10: 2252 6574 7572 6e20 616e 2061 7272 6179  "Return an array
+00016a20: 2077 686f 7365 2076 616c 7565 7320 6172   whose values ar
+00016a30: 6520 6c69 6d69 7465 6420 746f 2060 605b  e limited to ``[
+00016a40: 6d69 6e2c 206d 6178 5d60 602e 0a20 2020  min, max]``..   
+00016a50: 2020 2020 204f 6e65 206f 6620 6d61 7820       One of max 
+00016a60: 6f72 206d 696e 206d 7573 7420 6265 2067  or min must be g
+00016a70: 6976 656e 2e0a 0a20 2020 2020 2020 2052  iven...        R
+00016a80: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
+00016a90: 6173 6b2e 6172 7261 792e 636c 6970 6020  ask.array.clip` 
+00016aa0: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
+00016ab0: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+00016ac0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00016ad0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00016ae0: 2020 2064 6173 6b2e 6172 7261 792e 636c     dask.array.cl
+00016af0: 6970 203a 2065 7175 6976 616c 656e 7420  ip : equivalent 
+00016b00: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00016b10: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00016b20: 6d20 6461 736b 2e61 7272 6179 2e75 6675  m dask.array.ufu
+00016b30: 6e63 2069 6d70 6f72 7420 636c 6970 0a0a  nc import clip..
+00016b40: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00016b50: 6c69 7028 7365 6c66 2c20 6d69 6e2c 206d  lip(self, min, m
+00016b60: 6178 290a 0a20 2020 2064 6566 2076 6965  ax)..    def vie
+00016b70: 7728 7365 6c66 2c20 6474 7970 653d 4e6f  w(self, dtype=No
+00016b80: 6e65 2c20 6f72 6465 723d 2243 2229 3a0a  ne, order="C"):.
+00016b90: 2020 2020 2020 2020 2222 2247 6574 2061          """Get a
+00016ba0: 2076 6965 7720 6f66 2074 6865 2061 7272   view of the arr
+00016bb0: 6179 2061 7320 6120 6e65 7720 6461 7461  ay as a new data
+00016bc0: 2074 7970 650a 0a20 2020 2020 2020 2050   type..        P
+00016bd0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00016be0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00016bf0: 2020 2020 2064 7479 7065 3a0a 2020 2020       dtype:.    
+00016c00: 2020 2020 2020 2020 5468 6520 6474 7970          The dtyp
+00016c10: 6520 6279 2077 6869 6368 2074 6f20 7669  e by which to vi
+00016c20: 6577 2074 6865 2061 7272 6179 2e0a 2020  ew the array..  
+00016c30: 2020 2020 2020 2020 2020 5468 6520 6465            The de
+00016c40: 6661 756c 742c 204e 6f6e 652c 2072 6573  fault, None, res
+00016c50: 756c 7473 2069 6e20 7468 6520 7669 6577  ults in the view
+00016c60: 2068 6176 696e 6720 7468 6520 7361 6d65   having the same
+00016c70: 2064 6174 612d 7479 7065 0a20 2020 2020   data-type.     
+00016c80: 2020 2020 2020 2061 7320 7468 6520 6f72         as the or
+00016c90: 6967 696e 616c 2061 7272 6179 2e0a 2020  iginal array..  
+00016ca0: 2020 2020 2020 6f72 6465 723a 2073 7472        order: str
+00016cb0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00016cc0: 2743 2720 6f72 2027 4627 2028 466f 7274  'C' or 'F' (Fort
+00016cd0: 7261 6e29 206f 7264 6572 696e 670a 0a20  ran) ordering.. 
+00016ce0: 2020 2020 2020 2054 6869 7320 7265 696e         This rein
+00016cf0: 7465 7270 7265 7473 2074 6865 2062 7974  terprets the byt
+00016d00: 6573 206f 6620 7468 6520 6172 7261 7920  es of the array 
+00016d10: 756e 6465 7220 6120 6e65 7720 6474 7970  under a new dtyp
+00016d20: 652e 2020 4966 2074 6861 740a 2020 2020  e.  If that.    
+00016d30: 2020 2020 6474 7970 6520 646f 6573 206e      dtype does n
+00016d40: 6f74 2068 6176 6520 7468 6520 7361 6d65  ot have the same
+00016d50: 2073 697a 6520 6173 2074 6865 206f 7269   size as the ori
+00016d60: 6769 6e61 6c20 6172 7261 7920 7468 656e  ginal array then
+00016d70: 2074 6865 2073 6861 7065 0a20 2020 2020   the shape.     
+00016d80: 2020 2077 696c 6c20 6368 616e 6765 2e0a     will change..
+00016d90: 0a20 2020 2020 2020 2042 6577 6172 6520  .        Beware 
+00016da0: 7468 6174 2062 6f74 6820 6e75 6d70 7920  that both numpy 
+00016db0: 616e 6420 6461 736b 2e61 7272 6179 2063  and dask.array c
+00016dc0: 616e 2062 6568 6176 6520 6f64 646c 7920  an behave oddly 
+00016dd0: 7768 656e 2074 616b 696e 670a 2020 2020  when taking.    
+00016de0: 2020 2020 7368 6170 652d 6368 616e 6769      shape-changi
+00016df0: 6e67 2076 6965 7773 206f 6620 6172 7261  ng views of arra
+00016e00: 7973 2075 6e64 6572 2046 6f72 7472 616e  ys under Fortran
+00016e10: 206f 7264 6572 696e 672e 2020 556e 6465   ordering.  Unde
+00016e20: 7220 736f 6d65 0a20 2020 2020 2020 2076  r some.        v
+00016e30: 6572 7369 6f6e 7320 6f66 204e 756d 5079  ersions of NumPy
+00016e40: 2074 6869 7320 6675 6e63 7469 6f6e 2077   this function w
+00016e50: 696c 6c20 6661 696c 2077 6865 6e20 7461  ill fail when ta
+00016e60: 6b69 6e67 2073 6861 7065 2d63 6861 6e67  king shape-chang
+00016e70: 696e 670a 2020 2020 2020 2020 7669 6577  ing.        view
+00016e80: 7320 6f66 2046 6f72 7472 616e 206f 7264  s of Fortran ord
+00016e90: 6572 6564 2061 7272 6179 7320 6966 2074  ered arrays if t
+00016ea0: 6865 2066 6972 7374 2064 696d 656e 7369  he first dimensi
+00016eb0: 6f6e 2068 6173 2063 6875 6e6b 7320 6f66  on has chunks of
+00016ec0: 0a20 2020 2020 2020 2073 697a 6520 6f6e  .        size on
+00016ed0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00016ee0: 2020 2020 2020 2069 6620 6474 7970 6520         if dtype 
+00016ef0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00016f00: 2020 2020 2064 7479 7065 203d 2073 656c       dtype = sel
+00016f10: 662e 6474 7970 650a 2020 2020 2020 2020  f.dtype.        
+00016f20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00016f30: 2020 6474 7970 6520 3d20 6e70 2e64 7479    dtype = np.dty
+00016f40: 7065 2864 7479 7065 290a 2020 2020 2020  pe(dtype).      
+00016f50: 2020 6d75 6c74 203d 2073 656c 662e 6474    mult = self.dt
+00016f60: 7970 652e 6974 656d 7369 7a65 202f 2064  ype.itemsize / d
+00016f70: 7479 7065 2e69 7465 6d73 697a 650a 0a20  type.itemsize.. 
+00016f80: 2020 2020 2020 2069 6620 6f72 6465 7220         if order 
+00016f90: 3d3d 2022 4322 3a0a 2020 2020 2020 2020  == "C":.        
+00016fa0: 2020 2020 6368 756e 6b73 203d 2073 656c      chunks = sel
+00016fb0: 662e 6368 756e 6b73 5b3a 2d31 5d20 2b20  f.chunks[:-1] + 
+00016fc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016fd0: 2020 7475 706c 6528 656e 7375 7265 5f69    tuple(ensure_i
+00016fe0: 6e74 2863 202a 206d 756c 7429 2066 6f72  nt(c * mult) for
+00016ff0: 2063 2069 6e20 7365 6c66 2e63 6875 6e6b   c in self.chunk
+00017000: 735b 2d31 5d29 2c0a 2020 2020 2020 2020  s[-1]),.        
+00017010: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
+00017020: 6966 206f 7264 6572 203d 3d20 2246 223a  if order == "F":
+00017030: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+00017040: 6e6b 7320 3d20 280a 2020 2020 2020 2020  nks = (.        
+00017050: 2020 2020 2020 2020 7475 706c 6528 656e          tuple(en
+00017060: 7375 7265 5f69 6e74 2863 202a 206d 756c  sure_int(c * mul
+00017070: 7429 2066 6f72 2063 2069 6e20 7365 6c66  t) for c in self
+00017080: 2e63 6875 6e6b 735b 305d 292c 0a20 2020  .chunks[0]),.   
+00017090: 2020 2020 2020 2020 2029 202b 2073 656c           ) + sel
+000170a0: 662e 6368 756e 6b73 5b31 3a5d 0a20 2020  f.chunks[1:].   
+000170b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000170c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000170d0: 7565 4572 726f 7228 224f 7264 6572 206d  ueError("Order m
+000170e0: 7573 7420 6265 206f 6e65 206f 6620 2743  ust be one of 'C
+000170f0: 2720 6f72 2027 4627 2229 0a0a 2020 2020  ' or 'F'")..    
+00017100: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00017110: 6d61 705f 626c 6f63 6b73 280a 2020 2020  map_blocks(.    
+00017120: 2020 2020 2020 2020 6368 756e 6b2e 7669          chunk.vi
+00017130: 6577 2c20 6474 7970 652c 206f 7264 6572  ew, dtype, order
+00017140: 3d6f 7264 6572 2c20 6474 7970 653d 6474  =order, dtype=dt
+00017150: 7970 652c 2063 6875 6e6b 733d 6368 756e  ype, chunks=chun
+00017160: 6b73 0a20 2020 2020 2020 2029 0a0a 2020  ks.        )..  
+00017170: 2020 6465 6620 7377 6170 6178 6573 2873    def swapaxes(s
+00017180: 656c 662c 2061 7869 7331 2c20 6178 6973  elf, axis1, axis
+00017190: 3229 3a0a 2020 2020 2020 2020 2222 2252  2):.        """R
+000171a0: 6574 7572 6e20 6120 7669 6577 206f 6620  eturn a view of 
+000171b0: 7468 6520 6172 7261 7920 7769 7468 2060  the array with `
+000171c0: 6061 7869 7331 6060 2061 6e64 2060 6061  `axis1`` and ``a
+000171d0: 7869 7332 6060 2069 6e74 6572 6368 616e  xis2`` interchan
+000171e0: 6765 642e 0a0a 2020 2020 2020 2020 5265  ged...        Re
+000171f0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
+00017200: 736b 2e61 7272 6179 2e73 7761 7061 7865  sk.array.swapaxe
+00017210: 7360 2066 6f72 2066 756c 6c20 646f 6375  s` for full docu
+00017220: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+00017230: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00017240: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00017250: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00017260: 2e73 7761 7061 7865 7320 3a20 6571 7569  .swapaxes : equi
+00017270: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
+00017280: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00017290: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
+000172a0: 7261 792e 726f 7574 696e 6573 2069 6d70  ray.routines imp
+000172b0: 6f72 7420 7377 6170 6178 6573 0a0a 2020  ort swapaxes..  
+000172c0: 2020 2020 2020 7265 7475 726e 2073 7761        return swa
+000172d0: 7061 7865 7328 7365 6c66 2c20 6178 6973  paxes(self, axis
+000172e0: 312c 2061 7869 7332 290a 0a20 2020 2064  1, axis2)..    d
+000172f0: 6566 2072 6f75 6e64 2873 656c 662c 2064  ef round(self, d
+00017300: 6563 696d 616c 733d 3029 3a0a 2020 2020  ecimals=0):.    
+00017310: 2020 2020 2222 2252 6574 7572 6e20 6172      """Return ar
+00017320: 7261 7920 7769 7468 2065 6163 6820 656c  ray with each el
+00017330: 656d 656e 7420 726f 756e 6465 6420 746f  ement rounded to
+00017340: 2074 6865 2067 6976 656e 206e 756d 6265   the given numbe
+00017350: 7220 6f66 2064 6563 696d 616c 732e 0a0a  r of decimals...
+00017360: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
+00017370: 203a 6675 6e63 3a60 6461 736b 2e61 7272   :func:`dask.arr
+00017380: 6179 2e72 6f75 6e64 6020 666f 7220 6675  ay.round` for fu
+00017390: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
+000173a0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+000173b0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+000173c0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+000173d0: 6b2e 6172 7261 792e 726f 756e 6420 3a20  k.array.round : 
+000173e0: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
+000173f0: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
+00017400: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00017410: 6b2e 6172 7261 792e 726f 7574 696e 6573  k.array.routines
+00017420: 2069 6d70 6f72 7420 726f 756e 640a 0a20   import round.. 
+00017430: 2020 2020 2020 2072 6574 7572 6e20 726f         return ro
+00017440: 756e 6428 7365 6c66 2c20 6465 6369 6d61  und(self, decima
+00017450: 6c73 3d64 6563 696d 616c 7329 0a0a 2020  ls=decimals)..  
+00017460: 2020 6465 6620 636f 7079 2873 656c 6629    def copy(self)
+00017470: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00017480: 2020 2020 2020 436f 7079 2061 7272 6179        Copy array
+00017490: 2e20 2054 6869 7320 6973 2061 206e 6f2d  .  This is a no-
+000174a0: 6f70 2066 6f72 2064 6173 6b2e 6172 7261  op for dask.arra
+000174b0: 7973 2c20 7768 6963 6820 6172 6520 696d  ys, which are im
+000174c0: 6d75 7461 626c 650a 2020 2020 2020 2020  mutable.        
+000174d0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000174e0: 726e 2041 7272 6179 2873 656c 662e 6461  rn Array(self.da
+000174f0: 736b 2c20 7365 6c66 2e6e 616d 652c 2073  sk, self.name, s
+00017500: 656c 662e 6368 756e 6b73 2c20 6d65 7461  elf.chunks, meta
+00017510: 3d73 656c 6629 0a0a 2020 2020 6465 6620  =self)..    def 
+00017520: 5f5f 6465 6570 636f 7079 5f5f 2873 656c  __deepcopy__(sel
+00017530: 662c 206d 656d 6f29 3a0a 2020 2020 2020  f, memo):.      
+00017540: 2020 6320 3d20 7365 6c66 2e63 6f70 7928    c = self.copy(
+00017550: 290a 2020 2020 2020 2020 6d65 6d6f 5b69  ).        memo[i
+00017560: 6428 7365 6c66 295d 203d 2063 0a20 2020  d(self)] = c.   
+00017570: 2020 2020 2072 6574 7572 6e20 630a 0a20       return c.. 
+00017580: 2020 2064 6566 2074 6f5f 6465 6c61 7965     def to_delaye
+00017590: 6428 7365 6c66 2c20 6f70 7469 6d69 7a65  d(self, optimize
+000175a0: 5f67 7261 7068 3d54 7275 6529 3a0a 2020  _graph=True):.  
+000175b0: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
+000175c0: 2069 6e74 6f20 616e 2061 7272 6179 206f   into an array o
+000175d0: 6620 3a63 6c61 7373 3a60 6461 736b 2e64  f :class:`dask.d
+000175e0: 656c 6179 6564 2e44 656c 6179 6564 6020  elayed.Delayed` 
+000175f0: 6f62 6a65 6374 732c 206f 6e65 2070 6572  objects, one per
+00017600: 2063 6875 6e6b 2e0a 0a20 2020 2020 2020   chunk...       
+00017610: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00017620: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00017630: 2020 2020 2020 206f 7074 696d 697a 655f         optimize_
+00017640: 6772 6170 6820 3a20 626f 6f6c 2c20 6f70  graph : bool, op
+00017650: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00017660: 2020 2049 6620 5472 7565 205b 6465 6661     If True [defa
+00017670: 756c 745d 2c20 7468 6520 6772 6170 6820  ult], the graph 
+00017680: 6973 206f 7074 696d 697a 6564 2062 6566  is optimized bef
+00017690: 6f72 6520 636f 6e76 6572 7469 6e67 2069  ore converting i
+000176a0: 6e74 6f0a 2020 2020 2020 2020 2020 2020  nto.            
+000176b0: 3a63 6c61 7373 3a60 6461 736b 2e64 656c  :class:`dask.del
+000176c0: 6179 6564 2e44 656c 6179 6564 6020 6f62  ayed.Delayed` ob
+000176d0: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
+000176e0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000176f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00017700: 2020 6461 736b 2e61 7272 6179 2e66 726f    dask.array.fro
+00017710: 6d5f 6465 6c61 7965 640a 2020 2020 2020  m_delayed.      
+00017720: 2020 2222 220a 2020 2020 2020 2020 6b65    """.        ke
+00017730: 7973 203d 2073 656c 662e 5f5f 6461 736b  ys = self.__dask
+00017740: 5f6b 6579 735f 5f28 290a 2020 2020 2020  _keys__().      
+00017750: 2020 6772 6170 6820 3d20 7365 6c66 2e5f    graph = self._
+00017760: 5f64 6173 6b5f 6772 6170 685f 5f28 290a  _dask_graph__().
+00017770: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
+00017780: 7365 6c66 2e5f 5f64 6173 6b5f 6c61 7965  self.__dask_laye
+00017790: 7273 5f5f 2829 5b30 5d0a 2020 2020 2020  rs__()[0].      
+000177a0: 2020 6966 206f 7074 696d 697a 655f 6772    if optimize_gr
+000177b0: 6170 683a 0a20 2020 2020 2020 2020 2020  aph:.           
+000177c0: 2067 7261 7068 203d 2073 656c 662e 5f5f   graph = self.__
+000177d0: 6461 736b 5f6f 7074 696d 697a 655f 5f28  dask_optimize__(
+000177e0: 6772 6170 682c 206b 6579 7329 2020 2320  graph, keys)  # 
+000177f0: 544f 444f 2c20 646f 6e27 7420 636f 6c6c  TODO, don't coll
+00017800: 6170 6520 6772 6170 680a 2020 2020 2020  ape graph.      
+00017810: 2020 2020 2020 6c61 7965 7220 3d20 2264        layer = "d
+00017820: 656c 6179 6564 2d22 202b 2073 656c 662e  elayed-" + self.
+00017830: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+00017840: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+00017850: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00017860: 6c65 6374 696f 6e73 286c 6179 6572 2c20  lections(layer, 
+00017870: 6772 6170 682c 2064 6570 656e 6465 6e63  graph, dependenc
+00017880: 6965 733d 2829 290a 2020 2020 2020 2020  ies=()).        
+00017890: 4c20 3d20 6e64 6565 706d 6170 2873 656c  L = ndeepmap(sel
+000178a0: 662e 6e64 696d 2c20 6c61 6d62 6461 206b  f.ndim, lambda k
+000178b0: 3a20 4465 6c61 7965 6428 6b2c 2067 7261  : Delayed(k, gra
+000178c0: 7068 2c20 6c61 7965 723d 6c61 7965 7229  ph, layer=layer)
+000178d0: 2c20 6b65 7973 290a 2020 2020 2020 2020  , keys).        
+000178e0: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
+000178f0: 4c2c 2064 7479 7065 3d6f 626a 6563 7429  L, dtype=object)
+00017900: 0a0a 2020 2020 6465 6620 7265 7065 6174  ..    def repeat
+00017910: 2873 656c 662c 2072 6570 6561 7473 2c20  (self, repeats, 
+00017920: 6178 6973 3d4e 6f6e 6529 3a0a 2020 2020  axis=None):.    
+00017930: 2020 2020 2222 2252 6570 6561 7420 656c      """Repeat el
+00017940: 656d 656e 7473 206f 6620 616e 2061 7272  ements of an arr
+00017950: 6179 2e0a 0a20 2020 2020 2020 2052 6566  ay...        Ref
+00017960: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+00017970: 6b2e 6172 7261 792e 7265 7065 6174 6020  k.array.repeat` 
+00017980: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
+00017990: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+000179a0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+000179b0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+000179c0: 2020 2064 6173 6b2e 6172 7261 792e 7265     dask.array.re
+000179d0: 7065 6174 203a 2065 7175 6976 616c 656e  peat : equivalen
+000179e0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+000179f0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00017a00: 726f 6d20 6461 736b 2e61 7272 6179 2e63  rom dask.array.c
+00017a10: 7265 6174 696f 6e20 696d 706f 7274 2072  reation import r
+00017a20: 6570 6561 740a 0a20 2020 2020 2020 2072  epeat..        r
+00017a30: 6574 7572 6e20 7265 7065 6174 2873 656c  eturn repeat(sel
+00017a40: 662c 2072 6570 6561 7473 2c20 6178 6973  f, repeats, axis
+00017a50: 3d61 7869 7329 0a0a 2020 2020 6465 6620  =axis)..    def 
+00017a60: 6e6f 6e7a 6572 6f28 7365 6c66 293a 0a20  nonzero(self):. 
+00017a70: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00017a80: 2074 6865 2069 6e64 6963 6573 206f 6620   the indices of 
+00017a90: 7468 6520 656c 656d 656e 7473 2074 6861  the elements tha
+00017aa0: 7420 6172 6520 6e6f 6e2d 7a65 726f 2e0a  t are non-zero..
+00017ab0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+00017ac0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+00017ad0: 7261 792e 6e6f 6e7a 6572 6f60 2066 6f72  ray.nonzero` for
+00017ae0: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+00017af0: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00017b00: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00017b10: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00017b20: 6461 736b 2e61 7272 6179 2e6e 6f6e 7a65  dask.array.nonze
+00017b30: 726f 203a 2065 7175 6976 616c 656e 7420  ro : equivalent 
+00017b40: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00017b50: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00017b60: 6d20 6461 736b 2e61 7272 6179 2e72 6f75  m dask.array.rou
+00017b70: 7469 6e65 7320 696d 706f 7274 206e 6f6e  tines import non
+00017b80: 7a65 726f 0a0a 2020 2020 2020 2020 7265  zero..        re
+00017b90: 7475 726e 206e 6f6e 7a65 726f 2873 656c  turn nonzero(sel
+00017ba0: 6629 0a0a 2020 2020 6465 6620 746f 5f7a  f)..    def to_z
+00017bb0: 6172 7228 7365 6c66 2c20 2a61 7267 732c  arr(self, *args,
+00017bc0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00017bd0: 2020 2020 2222 2253 6176 6520 6172 7261      """Save arra
+00017be0: 7920 746f 2074 6865 207a 6172 7220 7374  y to the zarr st
+00017bf0: 6f72 6167 6520 666f 726d 6174 0a0a 2020  orage format..  
+00017c00: 2020 2020 2020 5365 6520 6874 7470 733a        See https:
+00017c10: 2f2f 7a61 7272 2e72 6561 6474 6865 646f  //zarr.readthedo
+00017c20: 6373 2e69 6f20 666f 7220 6465 7461 696c  cs.io for detail
+00017c30: 7320 6162 6f75 7420 7468 6520 666f 726d  s about the form
+00017c40: 6174 2e0a 0a20 2020 2020 2020 2052 6566  at...        Ref
+00017c50: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+00017c60: 6b2e 6172 7261 792e 746f 5f7a 6172 7260  k.array.to_zarr`
+00017c70: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
+00017c80: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
+00017c90: 2020 5365 6520 616c 736f 0a20 2020 2020    See also.     
+00017ca0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00017cb0: 2020 2020 6461 736b 2e61 7272 6179 2e74      dask.array.t
+00017cc0: 6f5f 7a61 7272 203a 2065 7175 6976 616c  o_zarr : equival
+00017cd0: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
+00017ce0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00017cf0: 2072 6574 7572 6e20 746f 5f7a 6172 7228   return to_zarr(
+00017d00: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00017d10: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
+00017d20: 746f 5f74 696c 6564 6228 7365 6c66 2c20  to_tiledb(self, 
+00017d30: 7572 692c 202a 6172 6773 2c20 2a2a 6b77  uri, *args, **kw
+00017d40: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+00017d50: 2222 5361 7665 2061 7272 6179 2074 6f20  ""Save array to 
+00017d60: 7468 6520 5469 6c65 4442 2073 746f 7261  the TileDB stora
+00017d70: 6765 206d 616e 6167 6572 0a0a 2020 2020  ge manager..    
+00017d80: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
+00017d90: 646f 6373 2e74 696c 6564 622e 696f 2066  docs.tiledb.io f
+00017da0: 6f72 2064 6574 6169 6c73 2061 626f 7574  or details about
+00017db0: 2074 6865 2066 6f72 6d61 7420 616e 6420   the format and 
+00017dc0: 656e 6769 6e65 2e0a 0a20 2020 2020 2020  engine...       
+00017dd0: 2053 6565 2066 756e 6374 696f 6e20 3a66   See function :f
+00017de0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+00017df0: 746f 5f74 696c 6564 6260 2066 6f72 2061  to_tiledb` for a
+00017e00: 7267 756d 656e 7420 646f 6375 6d65 6e74  rgument document
+00017e10: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00017e20: 5365 6520 616c 736f 0a20 2020 2020 2020  See also.       
+00017e30: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00017e40: 2020 6461 736b 2e61 7272 6179 2e74 6f5f    dask.array.to_
+00017e50: 7469 6c65 6462 203a 2065 7175 6976 616c  tiledb : equival
+00017e60: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
+00017e70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00017e80: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00017e90: 2e74 696c 6564 625f 696f 2069 6d70 6f72  .tiledb_io impor
+00017ea0: 7420 746f 5f74 696c 6564 620a 0a20 2020  t to_tiledb..   
+00017eb0: 2020 2020 2072 6574 7572 6e20 746f 5f74       return to_t
+00017ec0: 696c 6564 6228 7365 6c66 2c20 7572 692c  iledb(self, uri,
+00017ed0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00017ee0: 290a 0a0a 6465 6620 656e 7375 7265 5f69  )...def ensure_i
+00017ef0: 6e74 2866 293a 0a20 2020 2069 203d 2069  nt(f):.    i = i
+00017f00: 6e74 2866 290a 2020 2020 6966 2069 2021  nt(f).    if i !
+00017f10: 3d20 663a 0a20 2020 2020 2020 2072 6169  = f:.        rai
+00017f20: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
+00017f30: 6f75 6c64 206e 6f74 2063 6f65 7263 6520  ould not coerce 
+00017f40: 2566 2074 6f20 696e 7465 6765 7222 2025  %f to integer" %
+00017f50: 2066 290a 2020 2020 7265 7475 726e 2069   f).    return i
+00017f60: 0a0a 0a64 6566 206e 6f72 6d61 6c69 7a65  ...def normalize
+00017f70: 5f63 6875 6e6b 7328 6368 756e 6b73 2c20  _chunks(chunks, 
+00017f80: 7368 6170 653d 4e6f 6e65 2c20 6c69 6d69  shape=None, limi
+00017f90: 743d 4e6f 6e65 2c20 6474 7970 653d 4e6f  t=None, dtype=No
+00017fa0: 6e65 2c20 7072 6576 696f 7573 5f63 6875  ne, previous_chu
+00017fb0: 6e6b 733d 4e6f 6e65 293a 0a20 2020 2022  nks=None):.    "
+00017fc0: 2222 4e6f 726d 616c 697a 6520 6368 756e  ""Normalize chun
+00017fd0: 6b73 2074 6f20 7475 706c 6520 6f66 2074  ks to tuple of t
+00017fe0: 7570 6c65 730a 0a20 2020 2054 6869 7320  uples..    This 
+00017ff0: 7461 6b65 7320 696e 2061 2076 6172 6965  takes in a varie
+00018000: 7479 206f 6620 696e 7075 7420 7479 7065  ty of input type
+00018010: 7320 616e 6420 696e 666f 726d 6174 696f  s and informatio
+00018020: 6e20 616e 6420 7072 6f64 7563 6573 2061  n and produces a
+00018030: 2066 756c 6c0a 2020 2020 7475 706c 652d   full.    tuple-
+00018040: 6f66 2d74 7570 6c65 7320 7265 7375 6c74  of-tuples result
+00018050: 2066 6f72 2063 6875 6e6b 732c 2073 7569   for chunks, sui
+00018060: 7461 626c 6520 746f 2062 6520 7061 7373  table to be pass
+00018070: 6564 2074 6f20 4172 7261 7920 6f72 0a20  ed to Array or. 
+00018080: 2020 2072 6563 6875 6e6b 206f 7220 616e     rechunk or an
+00018090: 7920 6f74 6865 7220 6f70 6572 6174 696f  y other operatio
+000180a0: 6e20 7468 6174 2063 7265 6174 6573 2061  n that creates a
+000180b0: 2044 6173 6b20 6172 7261 792e 0a0a 2020   Dask array...  
+000180c0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+000180d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+000180e0: 6368 756e 6b73 3a20 7475 706c 652c 2069  chunks: tuple, i
+000180f0: 6e74 2c20 6469 6374 2c20 6f72 2073 7472  nt, dict, or str
+00018100: 696e 670a 2020 2020 2020 2020 5468 6520  ing.        The 
+00018110: 6368 756e 6b73 2074 6f20 6265 206e 6f72  chunks to be nor
+00018120: 6d61 6c69 7a65 642e 2020 5365 6520 6578  malized.  See ex
+00018130: 616d 706c 6573 2062 656c 6f77 2066 6f72  amples below for
+00018140: 206d 6f72 6520 6465 7461 696c 730a 2020   more details.  
+00018150: 2020 7368 6170 653a 2054 7570 6c65 5b69    shape: Tuple[i
+00018160: 6e74 5d0a 2020 2020 2020 2020 5468 6520  nt].        The 
+00018170: 7368 6170 6520 6f66 2074 6865 2061 7272  shape of the arr
+00018180: 6179 0a20 2020 206c 696d 6974 3a20 696e  ay.    limit: in
+00018190: 7420 286f 7074 696f 6e61 6c29 0a20 2020  t (optional).   
+000181a0: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
+000181b0: 2062 6c6f 636b 2073 697a 6520 746f 2074   block size to t
+000181c0: 6172 6765 7420 696e 2062 7974 6573 2c0a  arget in bytes,.
+000181d0: 2020 2020 2020 2020 6966 2066 7265 6564          if freed
+000181e0: 6f6d 2069 7320 6769 7665 6e20 746f 2063  om is given to c
+000181f0: 686f 6f73 650a 2020 2020 6474 7970 653a  hoose.    dtype:
+00018200: 206e 702e 6474 7970 650a 2020 2020 7072   np.dtype.    pr
+00018210: 6576 696f 7573 5f63 6875 6e6b 733a 2054  evious_chunks: T
+00018220: 7570 6c65 5b54 7570 6c65 5b69 6e74 5d5d  uple[Tuple[int]]
+00018230: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00018240: 2020 4368 756e 6b73 2066 726f 6d20 6120    Chunks from a 
+00018250: 7072 6576 696f 7573 2061 7272 6179 2074  previous array t
+00018260: 6861 7420 7765 2073 686f 756c 6420 7573  hat we should us
+00018270: 6520 666f 7220 696e 7370 6972 6174 696f  e for inspiratio
+00018280: 6e20 7768 656e 0a20 2020 2020 2020 2072  n when.        r
+00018290: 6563 6875 6e6b 696e 6720 6175 746f 2064  echunking auto d
+000182a0: 696d 656e 7369 6f6e 732e 2020 4966 206e  imensions.  If n
+000182b0: 6f74 2070 726f 7669 6465 6420 6275 7420  ot provided but 
+000182c0: 6175 746f 2d63 6875 6e6b 696e 6720 6578  auto-chunking ex
+000182d0: 6973 7473 0a20 2020 2020 2020 2074 6865  ists.        the
+000182e0: 6e20 6175 746f 2d64 696d 656e 7369 6f6e  n auto-dimension
+000182f0: 7320 7769 6c6c 2070 7265 6665 7220 7371  s will prefer sq
+00018300: 7561 7265 2d6c 696b 6520 6368 756e 6b20  uare-like chunk 
+00018310: 7368 6170 6573 2e0a 0a20 2020 2045 7861  shapes...    Exa
+00018320: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00018330: 2d2d 0a20 2020 2053 7065 6369 6679 2075  --.    Specify u
+00018340: 6e69 666f 726d 2063 6875 6e6b 2073 697a  niform chunk siz
+00018350: 6573 0a0a 2020 2020 3e3e 3e20 6672 6f6d  es..    >>> from
+00018360: 2064 6173 6b2e 6172 7261 792e 636f 7265   dask.array.core
+00018370: 2069 6d70 6f72 7420 6e6f 726d 616c 697a   import normaliz
+00018380: 655f 6368 756e 6b73 0a20 2020 203e 3e3e  e_chunks.    >>>
+00018390: 206e 6f72 6d61 6c69 7a65 5f63 6875 6e6b   normalize_chunk
+000183a0: 7328 2832 2c20 3229 2c20 7368 6170 653d  s((2, 2), shape=
+000183b0: 2835 2c20 3629 290a 2020 2020 2828 322c  (5, 6)).    ((2,
+000183c0: 2032 2c20 3129 2c20 2832 2c20 322c 2032   2, 1), (2, 2, 2
+000183d0: 2929 0a0a 2020 2020 416c 736f 2070 6173  ))..    Also pas
+000183e0: 7365 7320 7468 726f 7567 6820 6675 6c6c  ses through full
+000183f0: 7920 6578 706c 6963 6974 2074 7570 6c65  y explicit tuple
+00018400: 2d6f 662d 7475 706c 6573 0a0a 2020 2020  -of-tuples..    
+00018410: 3e3e 3e20 6e6f 726d 616c 697a 655f 6368  >>> normalize_ch
+00018420: 756e 6b73 2828 2832 2c20 322c 2031 292c  unks(((2, 2, 1),
+00018430: 2028 322c 2032 2c20 3229 292c 2073 6861   (2, 2, 2)), sha
+00018440: 7065 3d28 352c 2036 2929 0a20 2020 2028  pe=(5, 6)).    (
+00018450: 2832 2c20 322c 2031 292c 2028 322c 2032  (2, 2, 1), (2, 2
+00018460: 2c20 3229 290a 0a20 2020 2043 6c65 616e  , 2))..    Clean
+00018470: 7320 7570 206c 6973 7473 2074 6f20 7475  s up lists to tu
+00018480: 706c 6573 0a0a 2020 2020 3e3e 3e20 6e6f  ples..    >>> no
+00018490: 726d 616c 697a 655f 6368 756e 6b73 285b  rmalize_chunks([
+000184a0: 5b32 2c20 325d 2c20 5b33 2c20 335d 5d29  [2, 2], [3, 3]])
+000184b0: 0a20 2020 2028 2832 2c20 3229 2c20 2833  .    ((2, 2), (3
+000184c0: 2c20 3329 290a 0a20 2020 2045 7870 616e  , 3))..    Expan
+000184d0: 6473 2069 6e74 6567 6572 2069 6e70 7574  ds integer input
+000184e0: 7320 3130 202d 3e20 2831 302c 2031 3029  s 10 -> (10, 10)
+000184f0: 0a0a 2020 2020 3e3e 3e20 6e6f 726d 616c  ..    >>> normal
+00018500: 697a 655f 6368 756e 6b73 2831 302c 2073  ize_chunks(10, s
+00018510: 6861 7065 3d28 3330 2c20 3529 290a 2020  hape=(30, 5)).  
+00018520: 2020 2828 3130 2c20 3130 2c20 3130 292c    ((10, 10, 10),
+00018530: 2028 352c 2929 0a0a 2020 2020 4578 7061   (5,))..    Expa
+00018540: 6e64 7320 6469 6374 2069 6e70 7574 730a  nds dict inputs.
+00018550: 0a20 2020 203e 3e3e 206e 6f72 6d61 6c69  .    >>> normali
+00018560: 7a65 5f63 6875 6e6b 7328 7b30 3a20 322c  ze_chunks({0: 2,
+00018570: 2031 3a20 337d 2c20 7368 6170 653d 2836   1: 3}, shape=(6
+00018580: 2c20 3629 290a 2020 2020 2828 322c 2032  , 6)).    ((2, 2
+00018590: 2c20 3229 2c20 2833 2c20 3329 290a 0a20  , 2), (3, 3)).. 
+000185a0: 2020 2054 6865 2076 616c 7565 7320 2d31     The values -1
+000185b0: 2061 6e64 204e 6f6e 6520 6765 7420 6d61   and None get ma
+000185c0: 7070 6564 2074 6f20 6675 6c6c 2073 697a  pped to full siz
+000185d0: 650a 0a20 2020 203e 3e3e 206e 6f72 6d61  e..    >>> norma
+000185e0: 6c69 7a65 5f63 6875 6e6b 7328 2835 2c20  lize_chunks((5, 
+000185f0: 2d31 292c 2073 6861 7065 3d28 3130 2c20  -1), shape=(10, 
+00018600: 3130 2929 0a20 2020 2028 2835 2c20 3529  10)).    ((5, 5)
+00018610: 2c20 2831 302c 2929 0a0a 2020 2020 5573  , (10,))..    Us
+00018620: 6520 7468 6520 7661 6c75 6520 2261 7574  e the value "aut
+00018630: 6f22 2074 6f20 6175 746f 6d61 7469 6361  o" to automatica
+00018640: 6c6c 7920 6465 7465 726d 696e 6520 6368  lly determine ch
+00018650: 756e 6b20 7369 7a65 7320 616c 6f6e 6720  unk sizes along 
+00018660: 6365 7274 6169 6e0a 2020 2020 6469 6d65  certain.    dime
+00018670: 6e73 696f 6e73 2e20 2054 6869 7320 7573  nsions.  This us
+00018680: 6573 2074 6865 2060 606c 696d 6974 3d60  es the ``limit=`
+00018690: 6020 616e 6420 6060 6474 7970 653d 6060  ` and ``dtype=``
+000186a0: 206b 6579 776f 7264 7320 746f 0a20 2020   keywords to.   
+000186b0: 2064 6574 6572 6d69 6e65 2068 6f77 206c   determine how l
+000186c0: 6172 6765 2074 6f20 6d61 6b65 2074 6865  arge to make the
+000186d0: 2063 6875 6e6b 732e 2020 5468 6520 7465   chunks.  The te
+000186e0: 726d 2022 6175 746f 2220 6361 6e20 6265  rm "auto" can be
+000186f0: 2075 7365 640a 2020 2020 616e 7977 6865   used.    anywhe
+00018700: 7265 2061 6e20 696e 7465 6765 7220 6361  re an integer ca
+00018710: 6e20 6265 2075 7365 642e 2020 5365 6520  n be used.  See 
+00018720: 6172 7261 7920 6368 756e 6b69 6e67 2064  array chunking d
+00018730: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+00018740: 206d 6f72 650a 2020 2020 696e 666f 726d   more.    inform
+00018750: 6174 696f 6e2e 0a0a 2020 2020 3e3e 3e20  ation...    >>> 
+00018760: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
+00018770: 2828 2261 7574 6f22 2c29 2c20 7368 6170  (("auto",), shap
+00018780: 653d 2832 302c 292c 206c 696d 6974 3d35  e=(20,), limit=5
+00018790: 2c20 6474 7970 653d 2775 696e 7438 2729  , dtype='uint8')
+000187a0: 0a20 2020 2028 2835 2c20 352c 2035 2c20  .    ((5, 5, 5, 
+000187b0: 3529 2c29 0a0a 2020 2020 596f 7520 6361  5),)..    You ca
+000187c0: 6e20 616c 736f 2075 7365 2062 7974 6520  n also use byte 
+000187d0: 7369 7a65 7320 2873 6565 203a 6675 6e63  sizes (see :func
+000187e0: 3a60 6461 736b 2e75 7469 6c73 2e70 6172  :`dask.utils.par
+000187f0: 7365 5f62 7974 6573 6029 2069 6e20 706c  se_bytes`) in pl
+00018800: 6163 6520 6f66 0a20 2020 2022 6175 746f  ace of.    "auto
+00018810: 2220 746f 2061 736b 2066 6f72 2061 2070  " to ask for a p
+00018820: 6172 7469 6375 6c61 7220 7369 7a65 0a0a  articular size..
+00018830: 2020 2020 3e3e 3e20 6e6f 726d 616c 697a      >>> normaliz
+00018840: 655f 6368 756e 6b73 2822 316b 6942 222c  e_chunks("1kiB",
+00018850: 2073 6861 7065 3d28 3230 3030 2c29 2c20   shape=(2000,), 
+00018860: 6474 7970 653d 2766 6c6f 6174 3332 2729  dtype='float32')
+00018870: 0a20 2020 2028 2832 3536 2c20 3235 362c  .    ((256, 256,
+00018880: 2032 3536 2c20 3235 362c 2032 3536 2c20   256, 256, 256, 
+00018890: 3235 362c 2032 3536 2c20 3230 3829 2c29  256, 256, 208),)
+000188a0: 0a0a 2020 2020 5265 7370 6563 7473 206e  ..    Respects n
+000188b0: 756c 6c20 6469 6d65 6e73 696f 6e73 0a0a  ull dimensions..
+000188c0: 2020 2020 3e3e 3e20 6e6f 726d 616c 697a      >>> normaliz
+000188d0: 655f 6368 756e 6b73 2828 292c 2073 6861  e_chunks((), sha
+000188e0: 7065 3d28 302c 2030 2929 0a20 2020 2028  pe=(0, 0)).    (
+000188f0: 2830 2c29 2c20 2830 2c29 290a 2020 2020  (0,), (0,)).    
+00018900: 2222 220a 2020 2020 6966 2064 7479 7065  """.    if dtype
+00018910: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
+00018920: 6e63 6528 6474 7970 652c 206e 702e 6474  nce(dtype, np.dt
+00018930: 7970 6529 3a0a 2020 2020 2020 2020 6474  ype):.        dt
+00018940: 7970 6520 3d20 6e70 2e64 7479 7065 2864  ype = np.dtype(d
+00018950: 7479 7065 290a 2020 2020 6966 2063 6875  type).    if chu
+00018960: 6e6b 7320 6973 204e 6f6e 653a 0a20 2020  nks is None:.   
+00018970: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00018980: 4572 726f 7228 4348 554e 4b53 5f4e 4f4e  Error(CHUNKS_NON
+00018990: 455f 4552 524f 525f 4d45 5353 4147 4529  E_ERROR_MESSAGE)
+000189a0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+000189b0: 6365 2863 6875 6e6b 732c 206c 6973 7429  ce(chunks, list)
+000189c0: 3a0a 2020 2020 2020 2020 6368 756e 6b73  :.        chunks
+000189d0: 203d 2074 7570 6c65 2863 6875 6e6b 7329   = tuple(chunks)
+000189e0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+000189f0: 6365 2863 6875 6e6b 732c 2028 4e75 6d62  ce(chunks, (Numb
+00018a00: 6572 2c20 7374 7229 293a 0a20 2020 2020  er, str)):.     
+00018a10: 2020 2063 6875 6e6b 7320 3d20 2863 6875     chunks = (chu
+00018a20: 6e6b 732c 2920 2a20 6c65 6e28 7368 6170  nks,) * len(shap
+00018a30: 6529 0a20 2020 2069 6620 6973 696e 7374  e).    if isinst
+00018a40: 616e 6365 2863 6875 6e6b 732c 2064 6963  ance(chunks, dic
+00018a50: 7429 3a0a 2020 2020 2020 2020 6368 756e  t):.        chun
+00018a60: 6b73 203d 2074 7570 6c65 2863 6875 6e6b  ks = tuple(chunk
+00018a70: 732e 6765 7428 692c 204e 6f6e 6529 2066  s.get(i, None) f
+00018a80: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
+00018a90: 6e28 7368 6170 6529 2929 0a20 2020 2069  n(shape))).    i
+00018aa0: 6620 6973 696e 7374 616e 6365 2863 6875  f isinstance(chu
+00018ab0: 6e6b 732c 206e 702e 6e64 6172 7261 7929  nks, np.ndarray)
+00018ac0: 3a0a 2020 2020 2020 2020 6368 756e 6b73  :.        chunks
+00018ad0: 203d 2063 6875 6e6b 732e 746f 6c69 7374   = chunks.tolist
+00018ae0: 2829 0a20 2020 2069 6620 6e6f 7420 6368  ().    if not ch
+00018af0: 756e 6b73 2061 6e64 2073 6861 7065 2061  unks and shape a
+00018b00: 6e64 2061 6c6c 2873 203d 3d20 3020 666f  nd all(s == 0 fo
+00018b10: 7220 7320 696e 2073 6861 7065 293a 0a20  r s in shape):. 
+00018b20: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
+00018b30: 2828 302c 292c 2920 2a20 6c65 6e28 7368  ((0,),) * len(sh
+00018b40: 6170 6529 0a0a 2020 2020 6966 2028 0a20  ape)..    if (. 
+00018b50: 2020 2020 2020 2073 6861 7065 0a20 2020         shape.   
+00018b60: 2020 2020 2061 6e64 206c 656e 2873 6861       and len(sha
+00018b70: 7065 2920 3d3d 2031 0a20 2020 2020 2020  pe) == 1.       
+00018b80: 2061 6e64 206c 656e 2863 6875 6e6b 7329   and len(chunks)
+00018b90: 203e 2031 0a20 2020 2020 2020 2061 6e64   > 1.        and
+00018ba0: 2061 6c6c 2869 7369 6e73 7461 6e63 6528   all(isinstance(
+00018bb0: 632c 2028 4e75 6d62 6572 2c20 7374 7229  c, (Number, str)
+00018bc0: 2920 666f 7220 6320 696e 2063 6875 6e6b  ) for c in chunk
+00018bd0: 7329 0a20 2020 2029 3a0a 2020 2020 2020  s).    ):.      
+00018be0: 2020 6368 756e 6b73 203d 2028 6368 756e    chunks = (chun
+00018bf0: 6b73 2c29 0a0a 2020 2020 6966 2073 6861  ks,)..    if sha
+00018c00: 7065 2061 6e64 206c 656e 2863 6875 6e6b  pe and len(chunk
+00018c10: 7329 2021 3d20 6c65 6e28 7368 6170 6529  s) != len(shape)
+00018c20: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00018c30: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00018c40: 2020 2020 2020 2020 2243 6875 6e6b 7320          "Chunks 
+00018c50: 616e 6420 7368 6170 6520 6d75 7374 2062  and shape must b
+00018c60: 6520 6f66 2074 6865 2073 616d 6520 6c65  e of the same le
+00018c70: 6e67 7468 2f64 696d 656e 7369 6f6e 2e20  ngth/dimension. 
+00018c80: 220a 2020 2020 2020 2020 2020 2020 2247  ".            "G
+00018c90: 6f74 2063 6875 6e6b 733d 2573 2c20 7368  ot chunks=%s, sh
+00018ca0: 6170 653d 2573 2220 2520 2863 6875 6e6b  ape=%s" % (chunk
+00018cb0: 732c 2073 6861 7065 290a 2020 2020 2020  s, shape).      
+00018cc0: 2020 290a 2020 2020 6966 202d 3120 696e    ).    if -1 in
+00018cd0: 2063 6875 6e6b 7320 6f72 204e 6f6e 6520   chunks or None 
+00018ce0: 696e 2063 6875 6e6b 733a 0a20 2020 2020  in chunks:.     
+00018cf0: 2020 2063 6875 6e6b 7320 3d20 7475 706c     chunks = tupl
+00018d00: 6528 7320 6966 2063 203d 3d20 2d31 206f  e(s if c == -1 o
+00018d10: 7220 6320 6973 204e 6f6e 6520 656c 7365  r c is None else
+00018d20: 2063 2066 6f72 2063 2c20 7320 696e 207a   c for c, s in z
+00018d30: 6970 2863 6875 6e6b 732c 2073 6861 7065  ip(chunks, shape
+00018d40: 2929 0a0a 2020 2020 2320 4966 2073 7065  ))..    # If spe
+00018d50: 6369 6679 696e 6720 6368 756e 6b20 7369  cifying chunk si
+00018d60: 7a65 2069 6e20 6279 7465 732c 2075 7365  ze in bytes, use
+00018d70: 2074 6861 7420 7661 6c75 6520 746f 2073   that value to s
+00018d80: 6574 2074 6865 206c 696d 6974 2e0a 2020  et the limit..  
+00018d90: 2020 2320 5665 7269 6679 2074 6865 7265    # Verify there
+00018da0: 2069 7320 6f6e 6c79 206f 6e65 2063 6f6e   is only one con
+00018db0: 7369 7374 656e 7420 7661 6c75 6520 6f66  sistent value of
+00018dc0: 206c 696d 6974 206f 7220 6368 756e 6b2d   limit or chunk-
+00018dd0: 6279 7465 7320 7573 6564 2e0a 2020 2020  bytes used..    
+00018de0: 666f 7220 6320 696e 2063 6875 6e6b 733a  for c in chunks:
+00018df0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00018e00: 7374 616e 6365 2863 2c20 7374 7229 2061  stance(c, str) a
+00018e10: 6e64 2063 2021 3d20 2261 7574 6f22 3a0a  nd c != "auto":.
+00018e20: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+00018e30: 6564 203d 2070 6172 7365 5f62 7974 6573  ed = parse_bytes
+00018e40: 2863 290a 2020 2020 2020 2020 2020 2020  (c).            
+00018e50: 6966 206c 696d 6974 2069 7320 4e6f 6e65  if limit is None
+00018e60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018e70: 2020 6c69 6d69 7420 3d20 7061 7273 6564    limit = parsed
+00018e80: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00018e90: 6620 7061 7273 6564 2021 3d20 6c69 6d69  f parsed != limi
+00018ea0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00018eb0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00018ec0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00018ed0: 2020 2020 2020 2020 2022 4f6e 6c79 206f           "Only o
+00018ee0: 6e65 2063 6f6e 7369 7374 656e 7420 7661  ne consistent va
+00018ef0: 6c75 6520 6f66 206c 696d 6974 206f 7220  lue of limit or 
+00018f00: 6368 756e 6b20 6973 2061 6c6c 6f77 6564  chunk is allowed
+00018f10: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+00018f20: 2020 2020 2020 2022 5573 6564 2025 7320         "Used %s 
+00018f30: 213d 2025 7322 2025 2028 7061 7273 6564  != %s" % (parsed
+00018f40: 2c20 6c69 6d69 7429 0a20 2020 2020 2020  , limit).       
+00018f50: 2020 2020 2020 2020 2029 0a20 2020 2023           ).    #
+00018f60: 2053 7562 7374 6974 7574 6520 6279 7465   Substitute byte
+00018f70: 206c 696d 6974 7320 7769 7468 2027 6175   limits with 'au
+00018f80: 746f 2720 6e6f 7720 7468 6174 206c 696d  to' now that lim
+00018f90: 6974 2069 7320 7365 742e 0a20 2020 2063  it is set..    c
+00018fa0: 6875 6e6b 7320 3d20 7475 706c 6528 2261  hunks = tuple("a
+00018fb0: 7574 6f22 2069 6620 6973 696e 7374 616e  uto" if isinstan
+00018fc0: 6365 2863 2c20 7374 7229 2061 6e64 2063  ce(c, str) and c
+00018fd0: 2021 3d20 2261 7574 6f22 2065 6c73 6520   != "auto" else 
+00018fe0: 6320 666f 7220 6320 696e 2063 6875 6e6b  c for c in chunk
+00018ff0: 7329 0a0a 2020 2020 6966 2061 6e79 2863  s)..    if any(c
+00019000: 203d 3d20 2261 7574 6f22 2066 6f72 2063   == "auto" for c
+00019010: 2069 6e20 6368 756e 6b73 293a 0a20 2020   in chunks):.   
+00019020: 2020 2020 2063 6875 6e6b 7320 3d20 6175       chunks = au
+00019030: 746f 5f63 6875 6e6b 7328 6368 756e 6b73  to_chunks(chunks
+00019040: 2c20 7368 6170 652c 206c 696d 6974 2c20  , shape, limit, 
+00019050: 6474 7970 652c 2070 7265 7669 6f75 735f  dtype, previous_
+00019060: 6368 756e 6b73 290a 0a20 2020 2069 6620  chunks)..    if 
+00019070: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
+00019080: 653a 0a20 2020 2020 2020 2063 6875 6e6b  e:.        chunk
+00019090: 7320 3d20 7475 706c 6528 6320 6966 2063  s = tuple(c if c
+000190a0: 206e 6f74 2069 6e20 7b4e 6f6e 652c 202d   not in {None, -
+000190b0: 317d 2065 6c73 6520 7320 666f 7220 632c  1} else s for c,
+000190c0: 2073 2069 6e20 7a69 7028 6368 756e 6b73   s in zip(chunks
+000190d0: 2c20 7368 6170 6529 290a 0a20 2020 2061  , shape))..    a
+000190e0: 6c6c 696e 7473 203d 204e 6f6e 650a 2020  llints = None.  
+000190f0: 2020 6966 2063 6875 6e6b 7320 616e 6420    if chunks and 
+00019100: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
+00019110: 653a 0a20 2020 2020 2020 2023 2061 6c6c  e:.        # all
+00019120: 696e 7473 3a20 6469 6420 7765 2073 7461  ints: did we sta
+00019130: 7274 2077 6974 6820 6368 756e 6b73 2061  rt with chunks a
+00019140: 7320 6120 7369 6d70 6c65 2074 7570 6c65  s a simple tuple
+00019150: 206f 6620 696e 7473 3f0a 2020 2020 2020   of ints?.      
+00019160: 2020 616c 6c69 6e74 7320 3d20 616c 6c28    allints = all(
+00019170: 6973 696e 7374 616e 6365 2863 2c20 696e  isinstance(c, in
+00019180: 7429 2066 6f72 2063 2069 6e20 6368 756e  t) for c in chun
+00019190: 6b73 290a 2020 2020 2020 2020 6368 756e  ks).        chun
+000191a0: 6b73 203d 2073 756d 280a 2020 2020 2020  ks = sum(.      
+000191b0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+000191c0: 2020 2020 2020 2020 626c 6f63 6b64 696d          blockdim
+000191d0: 735f 6672 6f6d 5f62 6c6f 636b 7368 6170  s_from_blockshap
+000191e0: 6528 2873 2c29 2c20 2863 2c29 290a 2020  e((s,), (c,)).  
+000191f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00019200: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00019210: 632c 2028 7475 706c 652c 206c 6973 7429  c, (tuple, list)
+00019220: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00019230: 2020 656c 7365 2028 632c 290a 2020 2020    else (c,).    
+00019240: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00019250: 732c 2063 2069 6e20 7a69 7028 7368 6170  s, c in zip(shap
+00019260: 652c 2063 6875 6e6b 7329 0a20 2020 2020  e, chunks).     
+00019270: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00019280: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
+00019290: 2020 290a 2020 2020 666f 7220 6320 696e    ).    for c in
+000192a0: 2063 6875 6e6b 733a 0a20 2020 2020 2020   chunks:.       
+000192b0: 2069 6620 6e6f 7420 633a 0a20 2020 2020   if not c:.     
+000192c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000192d0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+000192e0: 2020 2020 2020 2020 2022 456d 7074 7920           "Empty 
+000192f0: 7475 706c 6573 2061 7265 206e 6f74 2061  tuples are not a
+00019300: 6c6c 6f77 6564 2069 6e20 6368 756e 6b73  llowed in chunks
+00019310: 2e20 4578 7072 6573 7320 220a 2020 2020  . Express ".    
+00019320: 2020 2020 2020 2020 2020 2020 227a 6572              "zer
+00019330: 6f20 6c65 6e67 7468 2064 696d 656e 7369  o length dimensi
+00019340: 6f6e 7320 7769 7468 2030 2873 2920 696e  ons with 0(s) in
+00019350: 2063 6875 6e6b 7322 0a20 2020 2020 2020   chunks".       
+00019360: 2020 2020 2029 0a0a 2020 2020 6966 2073       )..    if s
+00019370: 6861 7065 2069 7320 6e6f 7420 4e6f 6e65  hape is not None
+00019380: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
+00019390: 2863 6875 6e6b 7329 2021 3d20 6c65 6e28  (chunks) != len(
+000193a0: 7368 6170 6529 3a0a 2020 2020 2020 2020  shape):.        
+000193b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000193c0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+000193d0: 2020 2020 2020 2249 6e70 7574 2061 7272        "Input arr
+000193e0: 6179 2068 6173 2025 6420 6469 6d65 6e73  ay has %d dimens
+000193f0: 696f 6e73 2062 7574 2074 6865 2073 7570  ions but the sup
+00019400: 706c 6965 6420 220a 2020 2020 2020 2020  plied ".        
+00019410: 2020 2020 2020 2020 2263 6875 6e6b 7320          "chunks 
+00019420: 6861 7320 6f6e 6c79 2025 6420 6469 6d65  has only %d dime
+00019430: 6e73 696f 6e73 2220 2520 286c 656e 2873  nsions" % (len(s
+00019440: 6861 7065 292c 206c 656e 2863 6875 6e6b  hape), len(chunk
+00019450: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+00019460: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
+00019470: 2061 6c6c 280a 2020 2020 2020 2020 2020   all(.          
+00019480: 2020 6320 3d3d 2073 206f 7220 286d 6174    c == s or (mat
+00019490: 682e 6973 6e61 6e28 6329 206f 7220 6d61  h.isnan(c) or ma
+000194a0: 7468 2e69 736e 616e 2873 2929 0a20 2020  th.isnan(s)).   
+000194b0: 2020 2020 2020 2020 2066 6f72 2063 2c20           for c, 
+000194c0: 7320 696e 207a 6970 286d 6170 2873 756d  s in zip(map(sum
+000194d0: 2c20 6368 756e 6b73 292c 2073 6861 7065  , chunks), shape
+000194e0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+000194f0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00019500: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00019510: 2020 2020 2020 2020 2020 2022 4368 756e             "Chun
+00019520: 6b73 2064 6f20 6e6f 7420 6164 6420 7570  ks do not add up
+00019530: 2074 6f20 7368 6170 652e 2022 0a20 2020   to shape. ".   
+00019540: 2020 2020 2020 2020 2020 2020 2022 476f               "Go
+00019550: 7420 6368 756e 6b73 3d25 732c 2073 6861  t chunks=%s, sha
+00019560: 7065 3d25 7322 2025 2028 6368 756e 6b73  pe=%s" % (chunks
+00019570: 2c20 7368 6170 6529 0a20 2020 2020 2020  , shape).       
+00019580: 2020 2020 2029 0a20 2020 2069 6620 616c       ).    if al
+00019590: 6c69 6e74 7320 6f72 2069 7369 6e73 7461  lints or isinsta
+000195a0: 6e63 6528 7375 6d28 7375 6d28 5f29 2066  nce(sum(sum(_) f
+000195b0: 6f72 205f 2069 6e20 6368 756e 6b73 292c  or _ in chunks),
+000195c0: 2069 6e74 293a 0a20 2020 2020 2020 2023   int):.        #
+000195d0: 2046 6173 7470 6174 6820 666f 7220 7768   Fastpath for wh
+000195e0: 656e 2077 6520 616c 7265 6164 7920 6b6e  en we already kn
+000195f0: 6f77 2063 6875 6e6b 7320 636f 6e74 6169  ow chunks contai
+00019600: 6e73 206f 6e6c 7920 696e 7465 6765 7273  ns only integers
+00019610: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00019620: 7475 706c 6528 7475 706c 6528 6368 2920  tuple(tuple(ch) 
+00019630: 666f 7220 6368 2069 6e20 6368 756e 6b73  for ch in chunks
+00019640: 290a 2020 2020 7265 7475 726e 2074 7570  ).    return tup
+00019650: 6c65 280a 2020 2020 2020 2020 7475 706c  le(.        tupl
+00019660: 6528 696e 7428 7829 2069 6620 6e6f 7420  e(int(x) if not 
+00019670: 6d61 7468 2e69 736e 616e 2878 2920 656c  math.isnan(x) el
+00019680: 7365 206e 702e 6e61 6e20 666f 7220 7820  se np.nan for x 
+00019690: 696e 2063 2920 666f 7220 6320 696e 2063  in c) for c in c
+000196a0: 6875 6e6b 730a 2020 2020 290a 0a0a 6465  hunks.    )...de
+000196b0: 6620 5f63 6f6d 7075 7465 5f6d 756c 7469  f _compute_multi
+000196c0: 706c 6965 7228 6c69 6d69 743a 2069 6e74  plier(limit: int
+000196d0: 2c20 6474 7970 652c 206c 6172 6765 7374  , dtype, largest
+000196e0: 5f62 6c6f 636b 3a20 696e 742c 2072 6573  _block: int, res
+000196f0: 756c 7429 3a0a 2020 2020 2222 220a 2020  ult):.    """.  
+00019700: 2020 5574 696c 6974 7920 6675 6e63 7469    Utility functi
+00019710: 6f6e 2066 6f72 2061 7574 6f5f 6368 756e  on for auto_chun
+00019720: 6b2c 2074 6f20 6669 6e20 686f 7720 6d75  k, to fin how mu
+00019730: 6368 206c 6172 6765 7220 6f72 2073 6d61  ch larger or sma
+00019740: 6c6c 6572 2074 6865 2069 6465 616c 0a20  ller the ideal. 
+00019750: 2020 2063 6875 6e6b 2073 697a 6520 6973     chunk size is
+00019760: 2072 656c 6174 6976 6520 746f 2077 6861   relative to wha
+00019770: 7420 7765 2068 6176 6520 6e6f 772e 0a20  t we have now.. 
+00019780: 2020 2022 2222 0a20 2020 2072 6574 7572     """.    retur
+00019790: 6e20 280a 2020 2020 2020 2020 6c69 6d69  n (.        limi
+000197a0: 740a 2020 2020 2020 2020 2f20 6474 7970  t.        / dtyp
+000197b0: 652e 6974 656d 7369 7a65 0a20 2020 2020  e.itemsize.     
+000197c0: 2020 202f 206c 6172 6765 7374 5f62 6c6f     / largest_blo
+000197d0: 636b 0a20 2020 2020 2020 202f 206d 6174  ck.        / mat
+000197e0: 682e 7072 6f64 2872 2066 6f72 2072 2069  h.prod(r for r i
+000197f0: 6e20 7265 7375 6c74 2e76 616c 7565 7328  n result.values(
+00019800: 2920 6966 2072 290a 2020 2020 290a 0a0a  ) if r).    )...
+00019810: 6465 6620 6175 746f 5f63 6875 6e6b 7328  def auto_chunks(
+00019820: 6368 756e 6b73 2c20 7368 6170 652c 206c  chunks, shape, l
+00019830: 696d 6974 2c20 6474 7970 652c 2070 7265  imit, dtype, pre
+00019840: 7669 6f75 735f 6368 756e 6b73 3d4e 6f6e  vious_chunks=Non
+00019850: 6529 3a0a 2020 2020 2222 2244 6574 6572  e):.    """Deter
+00019860: 6d69 6e65 2061 7574 6f6d 6174 6963 2063  mine automatic c
+00019870: 6875 6e6b 730a 0a20 2020 2054 6869 7320  hunks..    This 
+00019880: 7461 6b65 7320 696e 2061 2063 6875 6e6b  takes in a chunk
+00019890: 7320 7661 6c75 6520 7468 6174 2063 6f6e  s value that con
+000198a0: 7461 696e 7320 6060 2261 7574 6f22 6060  tains ``"auto"``
+000198b0: 2076 616c 7565 7320 696e 2063 6572 7461   values in certa
+000198c0: 696e 0a20 2020 2064 696d 656e 7369 6f6e  in.    dimension
+000198d0: 7320 616e 6420 7265 706c 6163 6573 2074  s and replaces t
+000198e0: 686f 7365 2076 616c 7565 7320 7769 7468  hose values with
+000198f0: 2063 6f6e 6372 6574 6520 6469 6d65 6e73   concrete dimens
+00019900: 696f 6e20 7369 7a65 7320 7468 6174 2074  ion sizes that t
+00019910: 7279 0a20 2020 2074 6f20 6765 7420 6368  ry.    to get ch
+00019920: 756e 6b73 2074 6f20 6265 206f 6620 6120  unks to be of a 
+00019930: 6365 7274 6169 6e20 7369 7a65 2069 6e20  certain size in 
+00019940: 6279 7465 732c 2070 726f 7669 6465 6420  bytes, provided 
+00019950: 6279 2074 6865 2060 606c 696d 6974 3d60  by the ``limit=`
+00019960: 600a 2020 2020 6b65 7977 6f72 642e 2020  `.    keyword.  
+00019970: 4966 206d 756c 7469 706c 6520 6469 6d65  If multiple dime
+00019980: 6e73 696f 6e73 2061 7265 206d 6172 6b65  nsions are marke
+00019990: 6420 6173 2060 6022 6175 746f 2260 6020  d as ``"auto"`` 
+000199a0: 7468 656e 2074 6865 7920 7769 6c6c 0a20  then they will. 
+000199b0: 2020 2061 6c6c 2072 6573 706f 6e64 2074     all respond t
+000199c0: 6f20 6d65 6574 2074 6865 2064 6573 6972  o meet the desir
+000199d0: 6564 2062 7974 6520 6c69 6d69 742c 2074  ed byte limit, t
+000199e0: 7279 696e 6720 746f 2072 6573 7065 6374  rying to respect
+000199f0: 2074 6865 2061 7370 6563 740a 2020 2020   the aspect.    
+00019a00: 7261 7469 6f20 6f66 2074 6865 6972 2064  ratio of their d
+00019a10: 696d 656e 7369 6f6e 7320 696e 2060 6070  imensions in ``p
+00019a20: 7265 7669 6f75 735f 6368 756e 6b73 3d60  revious_chunks=`
+00019a30: 602c 2069 6620 6769 7665 6e2e 0a0a 2020  `, if given...  
+00019a40: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00019a50: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00019a60: 6368 756e 6b73 3a20 5475 706c 650a 2020  chunks: Tuple.  
+00019a70: 2020 2020 2020 4120 7475 706c 6520 6f66        A tuple of
+00019a80: 2065 6974 6865 7220 6469 6d65 6e73 696f   either dimensio
+00019a90: 6e73 206f 7220 7475 706c 6573 206f 6620  ns or tuples of 
+00019aa0: 6578 706c 6963 6974 2063 6875 6e6b 2064  explicit chunk d
+00019ab0: 696d 656e 7369 6f6e 730a 2020 2020 2020  imensions.      
+00019ac0: 2020 536f 6d65 2065 6e74 7269 6573 2073    Some entries s
+00019ad0: 686f 756c 6420 6265 2022 6175 746f 220a  hould be "auto".
+00019ae0: 2020 2020 7368 6170 653a 2054 7570 6c65      shape: Tuple
+00019af0: 5b69 6e74 5d0a 2020 2020 6c69 6d69 743a  [int].    limit:
+00019b00: 2069 6e74 2c20 7374 720a 2020 2020 2020   int, str.      
+00019b10: 2020 5468 6520 6d61 7869 6d75 6d20 616c    The maximum al
+00019b20: 6c6f 7761 626c 6520 7369 7a65 206f 6620  lowable size of 
+00019b30: 6120 6368 756e 6b20 696e 2062 7974 6573  a chunk in bytes
+00019b40: 0a20 2020 2070 7265 7669 6f75 735f 6368  .    previous_ch
+00019b50: 756e 6b73 3a20 5475 706c 655b 5475 706c  unks: Tuple[Tupl
+00019b60: 655b 696e 745d 5d0a 0a20 2020 2053 6565  e[int]]..    See
+00019b70: 2061 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   also.    ------
+00019b80: 2d2d 0a20 2020 206e 6f72 6d61 6c69 7a65  --.    normalize
+00019b90: 5f63 6875 6e6b 733a 2066 6f72 2066 756c  _chunks: for ful
+00019ba0: 6c20 646f 6373 7472 696e 6720 616e 6420  l docstring and 
+00019bb0: 7061 7261 6d65 7465 7273 0a20 2020 2022  parameters.    "
+00019bc0: 2222 0a20 2020 2069 6620 7072 6576 696f  "".    if previo
+00019bd0: 7573 5f63 6875 6e6b 7320 6973 206e 6f74  us_chunks is not
+00019be0: 204e 6f6e 653a 0a20 2020 2020 2020 2070   None:.        p
+00019bf0: 7265 7669 6f75 735f 6368 756e 6b73 203d  revious_chunks =
+00019c00: 2074 7570 6c65 280a 2020 2020 2020 2020   tuple(.        
+00019c10: 2020 2020 6320 6966 2069 7369 6e73 7461      c if isinsta
+00019c20: 6e63 6528 632c 2074 7570 6c65 2920 656c  nce(c, tuple) el
+00019c30: 7365 2028 632c 2920 666f 7220 6320 696e  se (c,) for c in
+00019c40: 2070 7265 7669 6f75 735f 6368 756e 6b73   previous_chunks
+00019c50: 0a20 2020 2020 2020 2029 0a20 2020 2063  .        ).    c
+00019c60: 6875 6e6b 7320 3d20 6c69 7374 2863 6875  hunks = list(chu
+00019c70: 6e6b 7329 0a0a 2020 2020 6175 746f 7320  nks)..    autos 
+00019c80: 3d20 7b69 2066 6f72 2069 2c20 6320 696e  = {i for i, c in
+00019c90: 2065 6e75 6d65 7261 7465 2863 6875 6e6b   enumerate(chunk
+00019ca0: 7329 2069 6620 6320 3d3d 2022 6175 746f  s) if c == "auto
+00019cb0: 227d 0a20 2020 2069 6620 6e6f 7420 6175  "}.    if not au
+00019cc0: 746f 733a 0a20 2020 2020 2020 2072 6574  tos:.        ret
+00019cd0: 7572 6e20 7475 706c 6528 6368 756e 6b73  urn tuple(chunks
+00019ce0: 290a 0a20 2020 2069 6620 6c69 6d69 7420  )..    if limit 
+00019cf0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00019d00: 206c 696d 6974 203d 2063 6f6e 6669 672e   limit = config.
+00019d10: 6765 7428 2261 7272 6179 2e63 6875 6e6b  get("array.chunk
+00019d20: 2d73 697a 6522 290a 2020 2020 6966 2069  -size").    if i
+00019d30: 7369 6e73 7461 6e63 6528 6c69 6d69 742c  sinstance(limit,
+00019d40: 2073 7472 293a 0a20 2020 2020 2020 206c   str):.        l
+00019d50: 696d 6974 203d 2070 6172 7365 5f62 7974  imit = parse_byt
+00019d60: 6573 286c 696d 6974 290a 0a20 2020 2069  es(limit)..    i
+00019d70: 6620 6474 7970 6520 6973 204e 6f6e 653a  f dtype is None:
+00019d80: 0a20 2020 2020 2020 2072 6169 7365 2054  .        raise T
+00019d90: 7970 6545 7272 6f72 2822 6474 7970 6520  ypeError("dtype 
+00019da0: 6d75 7374 2062 6520 6b6e 6f77 6e20 666f  must be known fo
+00019db0: 7220 6175 746f 2d63 6875 6e6b 696e 6722  r auto-chunking"
+00019dc0: 290a 0a20 2020 2069 6620 6474 7970 652e  )..    if dtype.
+00019dd0: 6861 736f 626a 6563 743a 0a20 2020 2020  hasobject:.     
+00019de0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00019df0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00019e00: 2020 2020 2020 2020 2020 2243 616e 206e            "Can n
+00019e10: 6f74 2075 7365 2061 7574 6f20 7265 6368  ot use auto rech
+00019e20: 756e 6b69 6e67 2077 6974 6820 6f62 6a65  unking with obje
+00019e30: 6374 2064 7479 7065 2e20 220a 2020 2020  ct dtype. ".    
+00019e40: 2020 2020 2020 2020 2257 6520 6172 6520          "We are 
+00019e50: 756e 6162 6c65 2074 6f20 6573 7469 6d61  unable to estima
+00019e60: 7465 2074 6865 2073 697a 6520 696e 2062  te the size in b
+00019e70: 7974 6573 206f 6620 6f62 6a65 6374 2064  ytes of object d
+00019e80: 6174 6122 0a20 2020 2020 2020 2029 0a0a  ata".        )..
+00019e90: 2020 2020 666f 7220 7820 696e 2074 7570      for x in tup
+00019ea0: 6c65 2863 6875 6e6b 7329 202b 2074 7570  le(chunks) + tup
+00019eb0: 6c65 2873 6861 7065 293a 0a20 2020 2020  le(shape):.     
+00019ec0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00019ed0: 2020 2020 6973 696e 7374 616e 6365 2878      isinstance(x
+00019ee0: 2c20 4e75 6d62 6572 290a 2020 2020 2020  , Number).      
+00019ef0: 2020 2020 2020 616e 6420 6e70 2e69 736e        and np.isn
+00019f00: 616e 2878 290a 2020 2020 2020 2020 2020  an(x).          
+00019f10: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
+00019f20: 782c 2074 7570 6c65 290a 2020 2020 2020  x, tuple).      
+00019f30: 2020 2020 2020 616e 6420 6e70 2e69 736e        and np.isn
+00019f40: 616e 2878 292e 616e 7928 290a 2020 2020  an(x).any().    
+00019f50: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00019f60: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00019f70: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00019f80: 2020 2020 2022 4361 6e20 6e6f 7420 7065       "Can not pe
+00019f90: 7266 6f72 6d20 6175 746f 6d61 7469 6320  rform automatic 
+00019fa0: 7265 6368 756e 6b69 6e67 2077 6974 6820  rechunking with 
+00019fb0: 756e 6b6e 6f77 6e20 220a 2020 2020 2020  unknown ".      
+00019fc0: 2020 2020 2020 2020 2020 2228 6e61 6e29            "(nan)
+00019fd0: 2063 6875 6e6b 2073 697a 6573 2e25 7322   chunk sizes.%s"
+00019fe0: 2025 2075 6e6b 6e6f 776e 5f63 6875 6e6b   % unknown_chunk
+00019ff0: 5f6d 6573 7361 6765 0a20 2020 2020 2020  _message.       
+0001a000: 2020 2020 2029 0a0a 2020 2020 6c69 6d69       )..    limi
+0001a010: 7420 3d20 6d61 7828 312c 206c 696d 6974  t = max(1, limit
+0001a020: 290a 0a20 2020 206c 6172 6765 7374 5f62  )..    largest_b
+0001a030: 6c6f 636b 203d 206d 6174 682e 7072 6f64  lock = math.prod
+0001a040: 280a 2020 2020 2020 2020 6373 2069 6620  (.        cs if 
+0001a050: 6973 696e 7374 616e 6365 2863 732c 204e  isinstance(cs, N
+0001a060: 756d 6265 7229 2065 6c73 6520 6d61 7828  umber) else max(
+0001a070: 6373 2920 666f 7220 6373 2069 6e20 6368  cs) for cs in ch
+0001a080: 756e 6b73 2069 6620 6373 2021 3d20 2261  unks if cs != "a
+0001a090: 7574 6f22 0a20 2020 2029 0a0a 2020 2020  uto".    )..    
+0001a0a0: 6966 2070 7265 7669 6f75 735f 6368 756e  if previous_chun
+0001a0b0: 6b73 3a0a 2020 2020 2020 2020 2320 4261  ks:.        # Ba
+0001a0c0: 7365 2069 6465 616c 2072 6174 696f 206f  se ideal ratio o
+0001a0d0: 6e20 7468 6520 6d65 6469 616e 2063 6875  n the median chu
+0001a0e0: 6e6b 2073 697a 6520 6f66 2074 6865 2070  nk size of the p
+0001a0f0: 7265 7669 6f75 7320 6368 756e 6b73 0a20  revious chunks. 
+0001a100: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0001a110: 7b61 3a20 6e70 2e6d 6564 6961 6e28 7072  {a: np.median(pr
+0001a120: 6576 696f 7573 5f63 6875 6e6b 735b 615d  evious_chunks[a]
+0001a130: 2920 666f 7220 6120 696e 2061 7574 6f73  ) for a in autos
+0001a140: 7d0a 0a20 2020 2020 2020 2069 6465 616c  }..        ideal
+0001a150: 5f73 6861 7065 203d 205b 5d0a 2020 2020  _shape = [].    
+0001a160: 2020 2020 666f 7220 692c 2073 2069 6e20      for i, s in 
+0001a170: 656e 756d 6572 6174 6528 7368 6170 6529  enumerate(shape)
+0001a180: 3a0a 2020 2020 2020 2020 2020 2020 6368  :.            ch
+0001a190: 756e 6b5f 6672 6571 7565 6e63 6965 7320  unk_frequencies 
+0001a1a0: 3d20 6672 6571 7565 6e63 6965 7328 7072  = frequencies(pr
+0001a1b0: 6576 696f 7573 5f63 6875 6e6b 735b 695d  evious_chunks[i]
+0001a1c0: 290a 2020 2020 2020 2020 2020 2020 6d6f  ).            mo
+0001a1d0: 6465 2c20 636f 756e 7420 3d20 6d61 7828  de, count = max(
+0001a1e0: 6368 756e 6b5f 6672 6571 7565 6e63 6965  chunk_frequencie
+0001a1f0: 732e 6974 656d 7328 292c 206b 6579 3d6c  s.items(), key=l
+0001a200: 616d 6264 6120 6b76 3a20 6b76 5b31 5d29  ambda kv: kv[1])
+0001a210: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001a220: 6d6f 6465 203e 2031 2061 6e64 2063 6f75  mode > 1 and cou
+0001a230: 6e74 203e 3d20 6c65 6e28 7072 6576 696f  nt >= len(previo
+0001a240: 7573 5f63 6875 6e6b 735b 695d 2920 2f20  us_chunks[i]) / 
+0001a250: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+0001a260: 2020 2069 6465 616c 5f73 6861 7065 2e61     ideal_shape.a
+0001a270: 7070 656e 6428 6d6f 6465 290a 2020 2020  ppend(mode).    
+0001a280: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001a290: 2020 2020 2020 2020 2020 2020 2020 6964                id
+0001a2a0: 6561 6c5f 7368 6170 652e 6170 7065 6e64  eal_shape.append
+0001a2b0: 2873 290a 0a20 2020 2020 2020 2023 2048  (s)..        # H
+0001a2c0: 6f77 206d 7563 6820 6c61 7267 6572 206f  ow much larger o
+0001a2d0: 7220 736d 616c 6c65 7220 7468 6520 6964  r smaller the id
+0001a2e0: 6561 6c20 6368 756e 6b20 7369 7a65 2069  eal chunk size i
+0001a2f0: 7320 7265 6c61 7469 7665 2074 6f20 7768  s relative to wh
+0001a300: 6174 2077 6520 6861 7665 206e 6f77 0a20  at we have now. 
+0001a310: 2020 2020 2020 206d 756c 7469 706c 6965         multiplie
+0001a320: 7220 3d20 5f63 6f6d 7075 7465 5f6d 756c  r = _compute_mul
+0001a330: 7469 706c 6965 7228 6c69 6d69 742c 2064  tiplier(limit, d
+0001a340: 7479 7065 2c20 6c61 7267 6573 745f 626c  type, largest_bl
+0001a350: 6f63 6b2c 2072 6573 756c 7429 0a0a 2020  ock, result)..  
+0001a360: 2020 2020 2020 6c61 7374 5f6d 756c 7469        last_multi
+0001a370: 706c 6965 7220 3d20 300a 2020 2020 2020  plier = 0.      
+0001a380: 2020 6c61 7374 5f61 7574 6f73 203d 2073    last_autos = s
+0001a390: 6574 2829 0a20 2020 2020 2020 2077 6869  et().        whi
+0001a3a0: 6c65 2028 0a20 2020 2020 2020 2020 2020  le (.           
+0001a3b0: 206d 756c 7469 706c 6965 7220 213d 206c   multiplier != l
+0001a3c0: 6173 745f 6d75 6c74 6970 6c69 6572 206f  ast_multiplier o
+0001a3d0: 7220 6175 746f 7320 213d 206c 6173 745f  r autos != last_
+0001a3e0: 6175 746f 730a 2020 2020 2020 2020 293a  autos.        ):
+0001a3f0: 2020 2320 7768 696c 6520 7468 696e 6773    # while things
+0001a400: 2063 6861 6e67 650a 2020 2020 2020 2020   change.        
+0001a410: 2020 2020 6c61 7374 5f6d 756c 7469 706c      last_multipl
+0001a420: 6965 7220 3d20 6d75 6c74 6970 6c69 6572  ier = multiplier
+0001a430: 2020 2320 7265 636f 7264 2070 7265 7669    # record previ
+0001a440: 6f75 7320 7661 6c75 6573 0a20 2020 2020  ous values.     
+0001a450: 2020 2020 2020 206c 6173 745f 6175 746f         last_auto
+0001a460: 7320 3d20 7365 7428 6175 746f 7329 2020  s = set(autos)  
+0001a470: 2320 7265 636f 7264 2070 7265 7669 6f75  # record previou
+0001a480: 7320 7661 6c75 6573 0a0a 2020 2020 2020  s values..      
+0001a490: 2020 2020 2020 2320 4578 7061 6e64 206f        # Expand o
+0001a4a0: 7220 636f 6e74 7261 6374 2065 6163 6820  r contract each 
+0001a4b0: 6f66 2074 6865 2064 696d 656e 7369 6f6e  of the dimension
+0001a4c0: 7320 6170 7072 6f70 7269 6174 656c 790a  s appropriately.
+0001a4d0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001a4e0: 6120 696e 2073 6f72 7465 6428 6175 746f  a in sorted(auto
+0001a4f0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0001a500: 2020 2020 6966 2069 6465 616c 5f73 6861      if ideal_sha
+0001a510: 7065 5b61 5d20 3d3d 2030 3a0a 2020 2020  pe[a] == 0:.    
 0001a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a530: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
-0001a540: 2020 2020 2020 2020 2020 2070 726f 706f             propo
-0001a550: 7365 6420 3d20 7265 7375 6c74 5b61 5d20  sed = result[a] 
-0001a560: 2a20 6d75 6c74 6970 6c69 6572 202a 2a20  * multiplier ** 
-0001a570: 2831 202f 206c 656e 2861 7574 6f73 2929  (1 / len(autos))
-0001a580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a590: 2069 6620 7072 6f70 6f73 6564 203e 2073   if proposed > s
-0001a5a0: 6861 7065 5b61 5d3a 2020 2320 7765 2776  hape[a]:  # we'v
-0001a5b0: 6520 6869 7420 7468 6520 7368 6170 6520  e hit the shape 
-0001a5c0: 626f 756e 6461 7279 0a20 2020 2020 2020  boundary.       
-0001a5d0: 2020 2020 2020 2020 2020 2020 2061 7574               aut
-0001a5e0: 6f73 2e72 656d 6f76 6528 6129 0a20 2020  os.remove(a).   
-0001a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a600: 206c 6172 6765 7374 5f62 6c6f 636b 202a   largest_block *
-0001a610: 3d20 7368 6170 655b 615d 0a20 2020 2020  = shape[a].     
-0001a620: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001a630: 6875 6e6b 735b 615d 203d 2073 6861 7065  hunks[a] = shape
-0001a640: 5b61 5d0a 2020 2020 2020 2020 2020 2020  [a].            
-0001a650: 2020 2020 2020 2020 6465 6c20 7265 7375          del resu
-0001a660: 6c74 5b61 5d0a 2020 2020 2020 2020 2020  lt[a].          
-0001a670: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a690: 7265 7375 6c74 5b61 5d20 3d20 726f 756e  result[a] = roun
-0001a6a0: 645f 746f 2870 726f 706f 7365 642c 2069  d_to(proposed, i
-0001a6b0: 6465 616c 5f73 6861 7065 5b61 5d29 0a0a  deal_shape[a])..
-0001a6c0: 2020 2020 2020 2020 2020 2020 2320 7265              # re
-0001a6d0: 636f 6d70 7574 6520 686f 7720 6d75 6368  compute how much
-0001a6e0: 206d 756c 7469 706c 6965 7220 7765 2068   multiplier we h
-0001a6f0: 6176 6520 6c65 6674 2c20 7265 7065 6174  ave left, repeat
-0001a700: 0a20 2020 2020 2020 2020 2020 206d 756c  .            mul
-0001a710: 7469 706c 6965 7220 3d20 5f63 6f6d 7075  tiplier = _compu
-0001a720: 7465 5f6d 756c 7469 706c 6965 7228 6c69  te_multiplier(li
-0001a730: 6d69 742c 2064 7479 7065 2c20 6c61 7267  mit, dtype, larg
-0001a740: 6573 745f 626c 6f63 6b2c 2072 6573 756c  est_block, resul
-0001a750: 7429 0a0a 2020 2020 2020 2020 666f 7220  t)..        for 
-0001a760: 6b2c 2076 2069 6e20 7265 7375 6c74 2e69  k, v in result.i
-0001a770: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0001a780: 2020 2020 6368 756e 6b73 5b6b 5d20 3d20      chunks[k] = 
-0001a790: 760a 2020 2020 2020 2020 7265 7475 726e  v.        return
-0001a7a0: 2074 7570 6c65 2863 6875 6e6b 7329 0a0a   tuple(chunks)..
-0001a7b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001a7c0: 2020 2320 4368 6563 6b20 6966 2064 7479    # Check if dty
-0001a7d0: 7065 2e69 7465 6d73 697a 6520 6973 2067  pe.itemsize is g
-0001a7e0: 7265 6174 6572 2074 6861 6e20 300a 2020  reater than 0.  
-0001a7f0: 2020 2020 2020 6966 2064 7479 7065 2e69        if dtype.i
-0001a800: 7465 6d73 697a 6520 3d3d 2030 3a0a 2020  temsize == 0:.  
-0001a810: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001a820: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0001a830: 2020 2020 2020 2020 2020 2020 2261 7574              "aut
-0001a840: 6f2d 6368 756e 6b69 6e67 2077 6974 6820  o-chunking with 
-0001a850: 6474 7970 652e 6974 656d 7369 7a65 203d  dtype.itemsize =
-0001a860: 3d20 3020 6973 206e 6f74 2073 7570 706f  = 0 is not suppo
-0001a870: 7274 6564 2c20 706c 6561 7365 2070 6173  rted, please pas
-0001a880: 7320 696e 2060 6368 756e 6b73 6020 6578  s in `chunks` ex
-0001a890: 706c 6963 6974 6c79 220a 2020 2020 2020  plicitly".      
-0001a8a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001a8b0: 7369 7a65 203d 2028 6c69 6d69 7420 2f20  size = (limit / 
-0001a8c0: 6474 7970 652e 6974 656d 7369 7a65 202f  dtype.itemsize /
-0001a8d0: 206c 6172 6765 7374 5f62 6c6f 636b 2920   largest_block) 
-0001a8e0: 2a2a 2028 3120 2f20 6c65 6e28 6175 746f  ** (1 / len(auto
-0001a8f0: 7329 290a 2020 2020 2020 2020 736d 616c  s)).        smal
-0001a900: 6c20 3d20 5b69 2066 6f72 2069 2069 6e20  l = [i for i in 
-0001a910: 6175 746f 7320 6966 2073 6861 7065 5b69  autos if shape[i
-0001a920: 5d20 3c20 7369 7a65 5d0a 2020 2020 2020  ] < size].      
-0001a930: 2020 6966 2073 6d61 6c6c 3a0a 2020 2020    if small:.    
-0001a940: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0001a950: 2073 6d61 6c6c 3a0a 2020 2020 2020 2020   small:.        
-0001a960: 2020 2020 2020 2020 6368 756e 6b73 5b69          chunks[i
-0001a970: 5d20 3d20 2873 6861 7065 5b69 5d2c 290a  ] = (shape[i],).
-0001a980: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a990: 726e 2061 7574 6f5f 6368 756e 6b73 2863  rn auto_chunks(c
-0001a9a0: 6875 6e6b 732c 2073 6861 7065 2c20 6c69  hunks, shape, li
-0001a9b0: 6d69 742c 2064 7479 7065 290a 0a20 2020  mit, dtype)..   
-0001a9c0: 2020 2020 2066 6f72 2069 2069 6e20 6175       for i in au
-0001a9d0: 746f 733a 0a20 2020 2020 2020 2020 2020  tos:.           
-0001a9e0: 2063 6875 6e6b 735b 695d 203d 2072 6f75   chunks[i] = rou
-0001a9f0: 6e64 5f74 6f28 7369 7a65 2c20 7368 6170  nd_to(size, shap
-0001aa00: 655b 695d 290a 0a20 2020 2020 2020 2072  e[i])..        r
-0001aa10: 6574 7572 6e20 7475 706c 6528 6368 756e  eturn tuple(chun
-0001aa20: 6b73 290a 0a0a 6465 6620 726f 756e 645f  ks)...def round_
-0001aa30: 746f 2863 2c20 7329 3a0a 2020 2020 2222  to(c, s):.    ""
-0001aa40: 2252 6574 7572 6e20 6120 6368 756e 6b20  "Return a chunk 
-0001aa50: 6469 6d65 6e73 696f 6e20 7468 6174 2069  dimension that i
-0001aa60: 7320 636c 6f73 6520 746f 2061 6e20 6576  s close to an ev
-0001aa70: 656e 206d 756c 7469 706c 6520 6f72 2066  en multiple or f
-0001aa80: 6163 746f 720a 0a20 2020 2057 6520 7761  actor..    We wa
-0001aa90: 6e74 2076 616c 7565 7320 666f 7220 6320  nt values for c 
-0001aaa0: 7468 6174 2061 7265 206e 6963 656c 7920  that are nicely 
-0001aab0: 616c 6967 6e65 6420 7769 7468 2073 2e0a  aligned with s..
-0001aac0: 0a20 2020 2049 6620 6320 6973 2073 6d61  .    If c is sma
-0001aad0: 6c6c 6572 2074 6861 6e20 7320 7765 2075  ller than s we u
-0001aae0: 7365 2074 6865 206f 7269 6769 6e61 6c20  se the original 
-0001aaf0: 6368 756e 6b20 7369 7a65 2061 6e64 2061  chunk size and a
-0001ab00: 6363 6570 7420 616e 0a20 2020 2075 6e65  ccept an.    une
-0001ab10: 7665 6e20 6368 756e 6b20 6174 2074 6865  ven chunk at the
-0001ab20: 2065 6e64 2e0a 0a20 2020 2049 6620 6320   end...    If c 
-0001ab30: 6973 206c 6172 6765 7220 7468 616e 2073  is larger than s
-0001ab40: 2074 6865 6e20 7765 2077 616e 7420 7468   then we want th
-0001ab50: 6520 6c61 7267 6573 7420 6d75 6c74 6970  e largest multip
-0001ab60: 6c65 206f 6620 7320 7468 6174 2069 7320  le of s that is 
-0001ab70: 7374 696c 6c0a 2020 2020 736d 616c 6c65  still.    smalle
-0001ab80: 7220 7468 616e 2063 2e0a 2020 2020 2222  r than c..    ""
-0001ab90: 220a 2020 2020 6966 2063 203c 3d20 733a  ".    if c <= s:
-0001aba0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001abb0: 6d61 7828 312c 2069 6e74 2863 2929 0a20  max(1, int(c)). 
-0001abc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001abd0: 2072 6574 7572 6e20 6320 2f2f 2073 202a   return c // s *
-0001abe0: 2073 0a0a 0a64 6566 205f 6765 745f 6368   s...def _get_ch
-0001abf0: 756e 6b5f 7368 6170 6528 6129 3a0a 2020  unk_shape(a):.  
-0001ac00: 2020 7320 3d20 6e70 2e61 7361 7272 6179    s = np.asarray
-0001ac10: 2861 2e73 6861 7065 2c20 6474 7970 653d  (a.shape, dtype=
-0001ac20: 696e 7429 0a20 2020 2072 6574 7572 6e20  int).    return 
-0001ac30: 735b 6c65 6e28 7329 202a 2028 4e6f 6e65  s[len(s) * (None
-0001ac40: 2c29 202b 2028 736c 6963 6528 4e6f 6e65  ,) + (slice(None
-0001ac50: 292c 295d 0a0a 0a64 6566 2066 726f 6d5f  ),)]...def from_
-0001ac60: 6172 7261 7928 0a20 2020 2078 2c0a 2020  array(.    x,.  
-0001ac70: 2020 6368 756e 6b73 3d22 6175 746f 222c    chunks="auto",
-0001ac80: 0a20 2020 206e 616d 653d 4e6f 6e65 2c0a  .    name=None,.
-0001ac90: 2020 2020 6c6f 636b 3d46 616c 7365 2c0a      lock=False,.
-0001aca0: 2020 2020 6173 6172 7261 793d 4e6f 6e65      asarray=None
-0001acb0: 2c0a 2020 2020 6661 6e63 793d 5472 7565  ,.    fancy=True
-0001acc0: 2c0a 2020 2020 6765 7469 7465 6d3d 4e6f  ,.    getitem=No
-0001acd0: 6e65 2c0a 2020 2020 6d65 7461 3d4e 6f6e  ne,.    meta=Non
-0001ace0: 652c 0a20 2020 2069 6e6c 696e 655f 6172  e,.    inline_ar
-0001acf0: 7261 793d 4661 6c73 652c 0a29 3a0a 2020  ray=False,.):.  
-0001ad00: 2020 2222 2243 7265 6174 6520 6461 736b    """Create dask
-0001ad10: 2061 7272 6179 2066 726f 6d20 736f 6d65   array from some
-0001ad20: 7468 696e 6720 7468 6174 206c 6f6f 6b73  thing that looks
-0001ad30: 206c 696b 6520 616e 2061 7272 6179 2e0a   like an array..
-0001ad40: 0a20 2020 2049 6e70 7574 206d 7573 7420  .    Input must 
-0001ad50: 6861 7665 2061 2060 602e 7368 6170 6560  have a ``.shape`
-0001ad60: 602c 2060 602e 6e64 696d 6060 2c20 6060  `, ``.ndim``, ``
-0001ad70: 2e64 7479 7065 6060 2061 6e64 2073 7570  .dtype`` and sup
-0001ad80: 706f 7274 206e 756d 7079 2d73 7479 6c65  port numpy-style
-0001ad90: 2073 6c69 6369 6e67 2e0a 0a20 2020 2050   slicing...    P
-0001ada0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-0001adb0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078 203a  --------.    x :
-0001adc0: 2061 7272 6179 5f6c 696b 650a 2020 2020   array_like.    
-0001add0: 6368 756e 6b73 203a 2069 6e74 2c20 7475  chunks : int, tu
-0001ade0: 706c 650a 2020 2020 2020 2020 486f 7720  ple.        How 
-0001adf0: 746f 2063 6875 6e6b 2074 6865 2061 7272  to chunk the arr
-0001ae00: 6179 2e20 4d75 7374 2062 6520 6f6e 6520  ay. Must be one 
-0001ae10: 6f66 2074 6865 2066 6f6c 6c6f 7769 6e67  of the following
-0001ae20: 2066 6f72 6d73 3a0a 0a20 2020 2020 2020   forms:..       
-0001ae30: 202d 2041 2062 6c6f 636b 7369 7a65 206c   - A blocksize l
-0001ae40: 696b 6520 3130 3030 2e0a 2020 2020 2020  ike 1000..      
-0001ae50: 2020 2d20 4120 626c 6f63 6b73 6861 7065    - A blockshape
-0001ae60: 206c 696b 6520 2831 3030 302c 2031 3030   like (1000, 100
-0001ae70: 3029 2e0a 2020 2020 2020 2020 2d20 4578  0)..        - Ex
-0001ae80: 706c 6963 6974 2073 697a 6573 206f 6620  plicit sizes of 
-0001ae90: 616c 6c20 626c 6f63 6b73 2061 6c6f 6e67  all blocks along
-0001aea0: 2061 6c6c 2064 696d 656e 7369 6f6e 7320   all dimensions 
-0001aeb0: 6c69 6b65 0a20 2020 2020 2020 2020 2028  like.          (
-0001aec0: 2831 3030 302c 2031 3030 302c 2035 3030  (1000, 1000, 500
-0001aed0: 292c 2028 3430 302c 2034 3030 2929 2e0a  ), (400, 400))..
-0001aee0: 2020 2020 2020 2020 2d20 4120 7369 7a65          - A size
-0001aef0: 2069 6e20 6279 7465 732c 206c 696b 6520   in bytes, like 
-0001af00: 2231 3030 204d 6942 2220 7768 6963 6820  "100 MiB" which 
-0001af10: 7769 6c6c 2063 686f 6f73 6520 6120 756e  will choose a un
-0001af20: 6966 6f72 6d0a 2020 2020 2020 2020 2020  iform.          
-0001af30: 626c 6f63 6b2d 6c69 6b65 2073 6861 7065  block-like shape
-0001af40: 0a20 2020 2020 2020 202d 2054 6865 2077  .        - The w
-0001af50: 6f72 6420 2261 7574 6f22 2077 6869 6368  ord "auto" which
-0001af60: 2061 6374 7320 6c69 6b65 2074 6865 2061   acts like the a
-0001af70: 626f 7665 2c20 6275 7420 7573 6573 2061  bove, but uses a
-0001af80: 2063 6f6e 6669 6775 7261 7469 6f6e 0a20   configuration. 
-0001af90: 2020 2020 2020 2020 2076 616c 7565 2060           value `
-0001afa0: 6061 7272 6179 2e63 6875 6e6b 2d73 697a  `array.chunk-siz
-0001afb0: 6560 6020 666f 7220 7468 6520 6368 756e  e`` for the chun
-0001afc0: 6b20 7369 7a65 0a0a 2020 2020 2020 2020  k size..        
-0001afd0: 2d31 206f 7220 4e6f 6e65 2061 7320 6120  -1 or None as a 
-0001afe0: 626c 6f63 6b73 697a 6520 696e 6469 6361  blocksize indica
-0001aff0: 7465 2074 6865 2073 697a 6520 6f66 2074  te the size of t
-0001b000: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
-0001b010: 0a20 2020 2020 2020 2064 696d 656e 7369  .        dimensi
-0001b020: 6f6e 2e0a 2020 2020 6e61 6d65 203a 2073  on..    name : s
-0001b030: 7472 206f 7220 626f 6f6c 2c20 6f70 7469  tr or bool, opti
-0001b040: 6f6e 616c 0a20 2020 2020 2020 2054 6865  onal.        The
-0001b050: 206b 6579 206e 616d 6520 746f 2075 7365   key name to use
-0001b060: 2066 6f72 2074 6865 2061 7272 6179 2e20   for the array. 
-0001b070: 4465 6661 756c 7473 2074 6f20 6120 6861  Defaults to a ha
-0001b080: 7368 206f 6620 6060 7860 602e 0a0a 2020  sh of ``x``...  
-0001b090: 2020 2020 2020 4861 7368 696e 6720 6973        Hashing is
-0001b0a0: 2075 7365 6675 6c20 6966 2074 6865 2073   useful if the s
-0001b0b0: 616d 6520 7661 6c75 6520 6f66 2060 6078  ame value of ``x
-0001b0c0: 6060 2069 7320 7573 6564 2074 6f20 6372  `` is used to cr
-0001b0d0: 6561 7465 206d 756c 7469 706c 650a 2020  eate multiple.  
-0001b0e0: 2020 2020 2020 6172 7261 7973 2c20 6173        arrays, as
-0001b0f0: 2044 6173 6b20 6361 6e20 7468 656e 2072   Dask can then r
-0001b100: 6563 6f67 6e69 7365 2074 6861 7420 7468  ecognise that th
-0001b110: 6579 2772 6520 7468 6520 7361 6d65 2061  ey're the same a
-0001b120: 6e64 0a20 2020 2020 2020 2061 766f 6964  nd.        avoid
-0001b130: 2064 7570 6c69 6361 7465 2063 6f6d 7075   duplicate compu
-0001b140: 7461 7469 6f6e 732e 2048 6f77 6576 6572  tations. However
-0001b150: 2c20 6974 2063 616e 2061 6c73 6f20 6265  , it can also be
-0001b160: 2073 6c6f 772c 2061 6e64 2069 6620 7468   slow, and if th
-0001b170: 650a 2020 2020 2020 2020 6172 7261 7920  e.        array 
-0001b180: 6973 206e 6f74 2063 6f6e 7469 6775 6f75  is not contiguou
-0001b190: 7320 6974 2069 7320 636f 7069 6564 2066  s it is copied f
-0001b1a0: 6f72 2068 6173 6869 6e67 2e20 4966 2074  or hashing. If t
-0001b1b0: 6865 2061 7272 6179 2075 7365 730a 2020  he array uses.  
-0001b1c0: 2020 2020 2020 7374 7269 6465 2074 7269        stride tri
-0001b1d0: 636b 7320 2873 7563 6820 6173 203a 6675  cks (such as :fu
-0001b1e0: 6e63 3a60 6e75 6d70 792e 6272 6f61 6463  nc:`numpy.broadc
-0001b1f0: 6173 745f 746f 6020 6f72 0a20 2020 2020  ast_to` or.     
-0001b200: 2020 203a 6675 6e63 3a60 736b 696d 6167     :func:`skimag
-0001b210: 652e 7574 696c 2e76 6965 775f 6173 5f77  e.util.view_as_w
-0001b220: 696e 646f 7773 6029 2074 6f20 6861 7665  indows`) to have
-0001b230: 2061 206c 6172 6765 7220 6c6f 6769 6361   a larger logica
-0001b240: 6c0a 2020 2020 2020 2020 7468 616e 2070  l.        than p
-0001b250: 6879 7369 6361 6c20 7369 7a65 2c20 7468  hysical size, th
-0001b260: 6973 2063 6f70 7920 6361 6e20 6361 7573  is copy can caus
-0001b270: 6520 6578 6365 7373 6976 6520 6d65 6d6f  e excessive memo
-0001b280: 7279 2075 7361 6765 2e0a 0a20 2020 2020  ry usage...     
-0001b290: 2020 2049 6620 796f 7520 646f 6e27 7420     If you don't 
-0001b2a0: 6e65 6564 2074 6865 2064 6564 7570 6c69  need the dedupli
-0001b2b0: 6361 7469 6f6e 2070 726f 7669 6465 6420  cation provided 
-0001b2c0: 6279 2068 6173 6869 6e67 2c20 7573 650a  by hashing, use.
-0001b2d0: 2020 2020 2020 2020 6060 6e61 6d65 3d46          ``name=F
-0001b2e0: 616c 7365 6060 2074 6f20 6765 6e65 7261  alse`` to genera
-0001b2f0: 7465 2061 2072 616e 646f 6d20 6e61 6d65  te a random name
-0001b300: 2069 6e73 7465 6164 206f 6620 6861 7368   instead of hash
-0001b310: 696e 672c 2077 6869 6368 0a20 2020 2020  ing, which.     
-0001b320: 2020 2061 766f 6964 7320 7468 6520 7069     avoids the pi
-0001b330: 7466 616c 6c73 2064 6573 6372 6962 6564  tfalls described
-0001b340: 2061 626f 7665 2e20 5573 696e 6720 6060   above. Using ``
-0001b350: 6e61 6d65 3d54 7275 6560 6020 6973 0a20  name=True`` is. 
-0001b360: 2020 2020 2020 2065 7175 6976 616c 656e         equivalen
-0001b370: 7420 746f 2074 6865 2064 6566 6175 6c74  t to the default
-0001b380: 2e0a 0a20 2020 2020 2020 2042 7920 6465  ...        By de
-0001b390: 6661 756c 742c 2068 6173 6869 6e67 2075  fault, hashing u
-0001b3a0: 7365 7320 7079 7468 6f6e 2773 2073 7461  ses python's sta
-0001b3b0: 6e64 6172 6420 7368 6131 2e20 5468 6973  ndard sha1. This
-0001b3c0: 2062 6568 6176 696f 7572 2063 616e 2062   behaviour can b
-0001b3d0: 650a 2020 2020 2020 2020 6368 616e 6765  e.        change
-0001b3e0: 6420 6279 2069 6e73 7461 6c6c 696e 6720  d by installing 
-0001b3f0: 6369 7479 6861 7368 2c20 7878 6861 7368  cityhash, xxhash
-0001b400: 206f 7220 6d75 726d 7572 6861 7368 2e20   or murmurhash. 
-0001b410: 4966 2069 6e73 7461 6c6c 6564 2c0a 2020  If installed,.  
-0001b420: 2020 2020 2020 6120 6c61 7267 652d 6661        a large-fa
-0001b430: 6374 6f72 2073 7065 6564 7570 2063 616e  ctor speedup can
-0001b440: 2062 6520 6f62 7461 696e 6564 2069 6e20   be obtained in 
-0001b450: 7468 6520 746f 6b65 6e69 7361 7469 6f6e  the tokenisation
-0001b460: 2073 7465 702e 0a0a 2020 2020 2020 2020   step...        
-0001b470: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
-0001b480: 2020 2020 2020 4265 6361 7573 6520 7468        Because th
-0001b490: 6973 2060 606e 616d 6560 6020 6973 2075  is ``name`` is u
-0001b4a0: 7365 6420 6173 2074 6865 206b 6579 2069  sed as the key i
-0001b4b0: 6e20 7461 736b 2067 7261 7068 732c 2079  n task graphs, y
-0001b4c0: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
-0001b4d0: 2020 2020 2065 6e73 7572 6520 7468 6174       ensure that
-0001b4e0: 2069 7420 756e 6971 7565 6c79 2069 6465   it uniquely ide
-0001b4f0: 6e74 6966 6965 7320 7468 6520 6461 7461  ntifies the data
-0001b500: 2063 6f6e 7461 696e 6564 2077 6974 6869   contained withi
-0001b510: 6e2e 2049 660a 2020 2020 2020 2020 2020  n. If.          
-0001b520: 2079 6f75 2764 206c 696b 6520 746f 2070   you'd like to p
-0001b530: 726f 7669 6465 2061 2064 6573 6372 6970  rovide a descrip
-0001b540: 7469 7665 206e 616d 6520 7468 6174 2069  tive name that i
-0001b550: 7320 7374 696c 6c20 756e 6971 7565 2c20  s still unique, 
-0001b560: 636f 6d62 696e 650a 2020 2020 2020 2020  combine.        
-0001b570: 2020 2074 6865 2064 6573 6372 6970 7469     the descripti
-0001b580: 7665 206e 616d 6520 7769 7468 203a 6675  ve name with :fu
-0001b590: 6e63 3a60 6461 736b 2e62 6173 652e 746f  nc:`dask.base.to
-0001b5a0: 6b65 6e69 7a65 6020 6f66 2074 6865 0a20  kenize` of the. 
-0001b5b0: 2020 2020 2020 2020 2020 6060 6172 7261            ``arra
-0001b5c0: 795f 6c69 6b65 6060 2e20 5365 6520 3a72  y_like``. See :r
-0001b5d0: 6566 3a60 6772 6170 6873 6020 666f 7220  ef:`graphs` for 
-0001b5e0: 6d6f 7265 2e0a 0a20 2020 206c 6f63 6b20  more...    lock 
-0001b5f0: 3a20 626f 6f6c 206f 7220 4c6f 636b 2c20  : bool or Lock, 
-0001b600: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0001b610: 2049 6620 6060 7860 6020 646f 6573 6e27   If ``x`` doesn'
-0001b620: 7420 7375 7070 6f72 7420 636f 6e63 7572  t support concur
-0001b630: 7265 6e74 2072 6561 6473 2074 6865 6e20  rent reads then 
-0001b640: 7072 6f76 6964 6520 6120 6c6f 636b 2068  provide a lock h
-0001b650: 6572 652c 206f 720a 2020 2020 2020 2020  ere, or.        
-0001b660: 7061 7373 2069 6e20 5472 7565 2074 6f20  pass in True to 
-0001b670: 6861 7665 2064 6173 6b2e 6172 7261 7920  have dask.array 
-0001b680: 6372 6561 7465 206f 6e65 2066 6f72 2079  create one for y
-0001b690: 6f75 2e0a 2020 2020 6173 6172 7261 7920  ou..    asarray 
-0001b6a0: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-0001b6b0: 0a20 2020 2020 2020 2049 6620 5472 7565  .        If True
-0001b6c0: 2074 6865 6e20 6361 6c6c 206e 702e 6173   then call np.as
-0001b6d0: 6172 7261 7920 6f6e 2063 6875 6e6b 7320  array on chunks 
-0001b6e0: 746f 2063 6f6e 7665 7274 2074 6865 6d20  to convert them 
-0001b6f0: 746f 206e 756d 7079 2061 7272 6179 732e  to numpy arrays.
-0001b700: 0a20 2020 2020 2020 2049 6620 4661 6c73  .        If Fals
-0001b710: 6520 7468 656e 2063 6875 6e6b 7320 6172  e then chunks ar
-0001b720: 6520 7061 7373 6564 2074 6872 6f75 6768  e passed through
-0001b730: 2075 6e63 6861 6e67 6564 2e0a 2020 2020   unchanged..    
-0001b740: 2020 2020 4966 204e 6f6e 6520 2864 6566      If None (def
-0001b750: 6175 6c74 2920 7468 656e 2077 6520 7573  ault) then we us
-0001b760: 6520 5472 7565 2069 6620 7468 6520 6060  e True if the ``
-0001b770: 5f5f 6172 7261 795f 6675 6e63 7469 6f6e  __array_function
-0001b780: 5f5f 6060 206d 6574 686f 640a 2020 2020  __`` method.    
-0001b790: 2020 2020 6973 2075 6e64 6566 696e 6564      is undefined
-0001b7a0: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-0001b7b0: 7465 3a3a 0a0a 2020 2020 2020 2020 2020  te::..          
-0001b7c0: 2020 4461 736b 2064 6f65 7320 6e6f 7420    Dask does not 
-0001b7d0: 7072 6573 6572 7665 2074 6865 206d 656d  preserve the mem
-0001b7e0: 6f72 7920 6c61 796f 7574 206f 6620 7468  ory layout of th
-0001b7f0: 6520 6f72 6967 696e 616c 2061 7272 6179  e original array
-0001b800: 2077 6865 6e0a 2020 2020 2020 2020 2020   when.          
-0001b810: 2020 7468 6520 6172 7261 7920 6973 2063    the array is c
-0001b820: 7265 6174 6564 2075 7369 6e67 2046 6f72  reated using For
-0001b830: 7472 616e 2072 6174 6865 7220 7468 616e  tran rather than
-0001b840: 2043 206f 7264 6572 696e 672e 0a0a 2020   C ordering...  
-0001b850: 2020 6661 6e63 7920 3a20 626f 6f6c 2c20    fancy : bool, 
-0001b860: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0001b870: 2049 6620 6060 7860 6020 646f 6573 6e27   If ``x`` doesn'
-0001b880: 7420 7375 7070 6f72 7420 6661 6e63 7920  t support fancy 
-0001b890: 696e 6465 7869 6e67 2028 652e 672e 2069  indexing (e.g. i
-0001b8a0: 6e64 6578 696e 6720 7769 7468 206c 6973  ndexing with lis
-0001b8b0: 7473 206f 720a 2020 2020 2020 2020 6172  ts or.        ar
-0001b8c0: 7261 7973 2920 7468 656e 2073 6574 2074  rays) then set t
-0001b8d0: 6f20 4661 6c73 652e 2044 6566 6175 6c74  o False. Default
-0001b8e0: 2069 7320 5472 7565 2e0a 2020 2020 6d65   is True..    me
-0001b8f0: 7461 203a 2041 7272 6179 2d6c 696b 652c  ta : Array-like,
-0001b900: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0001b910: 2020 5468 6520 6d65 7461 6461 7461 2066    The metadata f
-0001b920: 6f72 2074 6865 2072 6573 756c 7469 6e67  or the resulting
-0001b930: 2064 6173 6b20 6172 7261 792e 2020 5468   dask array.  Th
-0001b940: 6973 2069 7320 7468 6520 6b69 6e64 206f  is is the kind o
-0001b950: 6620 6172 7261 790a 2020 2020 2020 2020  f array.        
-0001b960: 7468 6174 2077 696c 6c20 7265 7375 6c74  that will result
-0001b970: 2066 726f 6d20 736c 6963 696e 6720 7468   from slicing th
-0001b980: 6520 696e 7075 7420 6172 7261 792e 0a20  e input array.. 
-0001b990: 2020 2020 2020 2044 6566 6175 6c74 7320         Defaults 
-0001b9a0: 746f 2074 6865 2069 6e70 7574 2061 7272  to the input arr
-0001b9b0: 6179 2e0a 2020 2020 696e 6c69 6e65 5f61  ay..    inline_a
-0001b9c0: 7272 6179 203a 2062 6f6f 6c2c 2064 6566  rray : bool, def
-0001b9d0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-0001b9e0: 2020 2048 6f77 2074 6f20 696e 636c 7564     How to includ
-0001b9f0: 6520 7468 6520 6172 7261 7920 696e 2074  e the array in t
-0001ba00: 6865 2074 6173 6b20 6772 6170 682e 2042  he task graph. B
-0001ba10: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
-0001ba20: 2020 2860 6069 6e6c 696e 655f 6172 7261    (``inline_arra
-0001ba30: 793d 4661 6c73 6560 6029 2074 6865 2061  y=False``) the a
-0001ba40: 7272 6179 2069 7320 696e 636c 7564 6564  rray is included
-0001ba50: 2069 6e20 6120 7461 736b 2062 7920 6974   in a task by it
-0001ba60: 7365 6c66 2c0a 2020 2020 2020 2020 616e  self,.        an
-0001ba70: 6420 6561 6368 2063 6875 6e6b 2072 6566  d each chunk ref
-0001ba80: 6572 7320 746f 2074 6861 7420 7461 736b  ers to that task
-0001ba90: 2062 7920 6974 7320 6b65 792e 0a0a 2020   by its key...  
-0001baa0: 2020 2020 2020 2e2e 2063 6f64 652d 626c        .. code-bl
-0001bab0: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
-0001bac0: 2020 2020 2020 2020 203e 3e3e 2078 203d           >>> x =
-0001bad0: 2068 3570 792e 4669 6c65 2822 6461 7461   h5py.File("data
-0001bae0: 2e68 3522 295b 222f 7822 5d20 2023 2064  .h5")["/x"]  # d
-0001baf0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0001bb00: 2020 2020 2020 2020 203e 3e3e 2061 203d           >>> a =
-0001bb10: 2064 612e 6672 6f6d 5f61 7272 6179 2878   da.from_array(x
-0001bb20: 2c20 6368 756e 6b73 3d35 3030 2920 2023  , chunks=500)  #
-0001bb30: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0001bb40: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
-0001bb50: 6963 7428 612e 6461 736b 2920 2023 2064  ict(a.dask)  # d
-0001bb60: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0001bb70: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-0001bb80: 2020 2020 2020 2020 2027 6172 7261 792d           'array-
-0001bb90: 6f72 6967 696e 616c 2d3c 6e61 6d65 3e27  original-<name>'
-0001bba0: 3a20 3c48 4446 3520 6461 7461 7365 7420  : <HDF5 dataset 
-0001bbb0: 2e2e 2e3e 2c0a 2020 2020 2020 2020 2020  ...>,.          
-0001bbc0: 2020 2020 2827 6172 7261 792d 3c6e 616d      ('array-<nam
-0001bbd0: 653e 272c 2030 293a 2028 6765 7469 7465  e>', 0): (getite
-0001bbe0: 6d2c 2022 6172 7261 792d 6f72 6967 696e  m, "array-origin
-0001bbf0: 616c 2d3c 6e61 6d65 3e22 2c20 2e2e 2e29  al-<name>", ...)
-0001bc00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001bc10: 2827 6172 7261 792d 3c6e 616d 653e 272c  ('array-<name>',
-0001bc20: 2031 293a 2028 6765 7469 7465 6d2c 2022   1): (getitem, "
-0001bc30: 6172 7261 792d 6f72 6967 696e 616c 2d3c  array-original-<
-0001bc40: 6e61 6d65 3e22 2c20 2e2e 2e29 0a20 2020  name>", ...).   
-0001bc50: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
-0001bc60: 2020 2057 6974 6820 6060 696e 6c69 6e65     With ``inline
-0001bc70: 5f61 7272 6179 3d54 7275 6560 602c 2044  _array=True``, D
-0001bc80: 6173 6b20 7769 6c6c 2069 6e73 7465 6164  ask will instead
-0001bc90: 2069 6e6c 696e 6520 7468 6520 6172 7261   inline the arra
-0001bca0: 7920 6469 7265 6374 6c79 0a20 2020 2020  y directly.     
-0001bcb0: 2020 2069 6e20 7468 6520 7661 6c75 6573     in the values
-0001bcc0: 206f 6620 7468 6520 7461 736b 2067 7261   of the task gra
-0001bcd0: 7068 2e0a 0a20 2020 2020 2020 202e 2e20  ph...        .. 
-0001bce0: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
-0001bcf0: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
-0001bd00: 3e3e 3e20 6120 3d20 6461 2e66 726f 6d5f  >>> a = da.from_
-0001bd10: 6172 7261 7928 782c 2063 6875 6e6b 733d  array(x, chunks=
-0001bd20: 3530 302c 2069 6e6c 696e 655f 6172 7261  500, inline_arra
-0001bd30: 793d 5472 7565 2920 2023 2064 6f63 7465  y=True)  # docte
-0001bd40: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-0001bd50: 2020 2020 203e 3e3e 2064 6963 7428 612e       >>> dict(a.
-0001bd60: 6461 736b 2920 2023 2064 6f63 7465 7374  dask)  # doctest
-0001bd70: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
-0001bd80: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-0001bd90: 2020 2028 2761 7272 6179 2d3c 6e61 6d65     ('array-<name
-0001bda0: 3e27 2c20 3029 3a20 2867 6574 6974 656d  >', 0): (getitem
-0001bdb0: 2c20 3c48 4446 3520 6461 7461 7365 7420  , <HDF5 dataset 
-0001bdc0: 2e2e 2e3e 2c20 2e2e 2e29 2c0a 2020 2020  ...>, ...),.    
-0001bdd0: 2020 2020 2020 2020 2020 2827 6172 7261            ('arra
-0001bde0: 792d 3c6e 616d 653e 272c 2031 293a 2028  y-<name>', 1): (
-0001bdf0: 6765 7469 7465 6d2c 203c 4844 4635 2064  getitem, <HDF5 d
-0001be00: 6174 6173 6574 202e 2e2e 3e2c 202e 2e2e  ataset ...>, ...
-0001be10: 290a 2020 2020 2020 2020 2020 207d 0a0a  ).           }..
-0001be20: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
-0001be30: 7420 7468 6572 6527 7320 6e6f 206b 6579  t there's no key
-0001be40: 2069 6e20 7468 6520 7461 736b 2067 7261   in the task gra
-0001be50: 7068 2077 6974 6820 6a75 7374 2074 6865  ph with just the
-0001be60: 2061 7272 6179 2060 7860 0a20 2020 2020   array `x`.     
-0001be70: 2020 2061 6e79 6d6f 7265 2e20 496e 7374     anymore. Inst
-0001be80: 6561 6420 6974 2773 2070 6c61 6365 6420  ead it's placed 
-0001be90: 6469 7265 6374 6c79 2069 6e20 7468 6520  directly in the 
-0001bea0: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
-0001beb0: 2054 6865 2072 6967 6874 2063 686f 6963   The right choic
-0001bec0: 6520 666f 7220 6060 696e 6c69 6e65 5f61  e for ``inline_a
-0001bed0: 7272 6179 6060 2064 6570 656e 6473 206f  rray`` depends o
-0001bee0: 6e20 7365 7665 7261 6c20 6661 6374 6f72  n several factor
-0001bef0: 732c 0a20 2020 2020 2020 2069 6e63 6c75  s,.        inclu
-0001bf00: 6469 6e67 2074 6865 2073 697a 6520 6f66  ding the size of
-0001bf10: 2060 6078 6060 2c20 686f 7720 6578 7065   ``x``, how expe
-0001bf20: 6e73 6976 6520 6974 2069 7320 746f 2063  nsive it is to c
-0001bf30: 7265 6174 652c 2077 6869 6368 0a20 2020  reate, which.   
-0001bf40: 2020 2020 2073 6368 6564 756c 6572 2079       scheduler y
-0001bf50: 6f75 2772 6520 7573 696e 672c 2061 6e64  ou're using, and
-0001bf60: 2074 6865 2070 6174 7465 726e 206f 6620   the pattern of 
-0001bf70: 646f 776e 7374 7265 616d 2063 6f6d 7075  downstream compu
-0001bf80: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
-0001bf90: 2041 7320 6120 6865 7572 6973 7469 632c   As a heuristic,
-0001bfa0: 2060 6069 6e6c 696e 655f 6172 7261 793d   ``inline_array=
-0001bfb0: 5472 7565 6060 206d 6179 2062 6520 7468  True`` may be th
-0001bfc0: 6520 7269 6768 7420 6368 6f69 6365 2077  e right choice w
-0001bfd0: 6865 6e0a 2020 2020 2020 2020 7468 6520  hen.        the 
-0001bfe0: 6172 7261 7920 6060 7860 6020 6973 2063  array ``x`` is c
-0001bff0: 6865 6170 2074 6f20 7365 7269 616c 697a  heap to serializ
-0001c000: 6520 616e 6420 6465 7365 7269 616c 697a  e and deserializ
-0001c010: 6520 2873 696e 6365 2069 7427 730a 2020  e (since it's.  
-0001c020: 2020 2020 2020 696e 636c 7564 6564 2069        included i
-0001c030: 6e20 7468 6520 6772 6170 6820 6d61 6e79  n the graph many
-0001c040: 2074 696d 6573 2920 616e 6420 6966 2079   times) and if y
-0001c050: 6f75 2772 6520 6578 7065 7269 656e 6369  ou're experienci
-0001c060: 6e67 206f 7264 6572 696e 670a 2020 2020  ng ordering.    
-0001c070: 2020 2020 6973 7375 6573 2028 7365 6520      issues (see 
-0001c080: 3a72 6566 3a60 6f72 6465 7260 2066 6f72  :ref:`order` for
-0001c090: 206d 6f72 6529 2e0a 0a20 2020 2020 2020   more)...       
-0001c0a0: 2054 6869 7320 6861 7320 6e6f 2065 6666   This has no eff
-0001c0b0: 6563 7420 7768 656e 2060 6078 6060 2069  ect when ``x`` i
-0001c0c0: 7320 6120 4e75 6d50 7920 6172 7261 792e  s a NumPy array.
-0001c0d0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-0001c0e0: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
-0001c0f0: 203e 3e3e 2078 203d 2068 3570 792e 4669   >>> x = h5py.Fi
-0001c100: 6c65 2827 2e2e 2e27 295b 272f 6461 7461  le('...')['/data
-0001c110: 2f70 6174 6827 5d20 2023 2064 6f63 7465  /path']  # docte
-0001c120: 7374 3a20 2b53 4b49 500a 2020 2020 3e3e  st: +SKIP.    >>
-0001c130: 3e20 6120 3d20 6461 2e66 726f 6d5f 6172  > a = da.from_ar
-0001c140: 7261 7928 782c 2063 6875 6e6b 733d 2831  ray(x, chunks=(1
-0001c150: 3030 302c 2031 3030 3029 2920 2023 2064  000, 1000))  # d
-0001c160: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
-0001c170: 2020 2049 6620 796f 7572 2075 6e64 6572     If your under
-0001c180: 6c79 696e 6720 6461 7461 7374 6f72 6520  lying datastore 
-0001c190: 646f 6573 206e 6f74 2073 7570 706f 7274  does not support
-0001c1a0: 2063 6f6e 6375 7272 656e 7420 7265 6164   concurrent read
-0001c1b0: 7320 7468 656e 2069 6e63 6c75 6465 0a20  s then include. 
-0001c1c0: 2020 2074 6865 2060 606c 6f63 6b3d 5472     the ``lock=Tr
-0001c1d0: 7565 6060 206b 6579 776f 7264 2061 7267  ue`` keyword arg
-0001c1e0: 756d 656e 7420 6f72 2060 606c 6f63 6b3d  ument or ``lock=
-0001c1f0: 6d79 6c6f 636b 6060 2069 6620 796f 7520  mylock`` if you 
-0001c200: 7761 6e74 206d 756c 7469 706c 650a 2020  want multiple.  
-0001c210: 2020 6172 7261 7973 2074 6f20 636f 6f72    arrays to coor
-0001c220: 6469 6e61 7465 2061 726f 756e 6420 7468  dinate around th
-0001c230: 6520 7361 6d65 206c 6f63 6b2e 0a0a 2020  e same lock...  
-0001c240: 2020 3e3e 3e20 6120 3d20 6461 2e66 726f    >>> a = da.fro
-0001c250: 6d5f 6172 7261 7928 782c 2063 6875 6e6b  m_array(x, chunk
-0001c260: 733d 2831 3030 302c 2031 3030 3029 2c20  s=(1000, 1000), 
-0001c270: 6c6f 636b 3d54 7275 6529 2020 2320 646f  lock=True)  # do
-0001c280: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
-0001c290: 2020 4966 2079 6f75 7220 756e 6465 726c    If your underl
-0001c2a0: 7969 6e67 2064 6174 6173 746f 7265 2068  ying datastore h
-0001c2b0: 6173 2061 2060 602e 6368 756e 6b73 6060  as a ``.chunks``
-0001c2c0: 2061 7474 7269 6275 7465 2028 6173 2068   attribute (as h
-0001c2d0: 3570 7920 616e 6420 7a61 7272 0a20 2020  5py and zarr.   
-0001c2e0: 2064 6174 6173 6574 7320 646f 2920 7468   datasets do) th
-0001c2f0: 656e 2061 206d 756c 7469 706c 6520 6f66  en a multiple of
-0001c300: 2074 6861 7420 6368 756e 6b20 7368 6170   that chunk shap
-0001c310: 6520 7769 6c6c 2062 6520 7573 6564 2069  e will be used i
-0001c320: 6620 796f 750a 2020 2020 646f 206e 6f74  f you.    do not
-0001c330: 2070 726f 7669 6465 2061 2063 6875 6e6b   provide a chunk
-0001c340: 2073 6861 7065 2e0a 0a20 2020 203e 3e3e   shape...    >>>
-0001c350: 2061 203d 2064 612e 6672 6f6d 5f61 7272   a = da.from_arr
-0001c360: 6179 2878 2c20 6368 756e 6b73 3d27 6175  ay(x, chunks='au
-0001c370: 746f 2729 2020 2320 646f 6374 6573 743a  to')  # doctest:
-0001c380: 202b 534b 4950 0a20 2020 203e 3e3e 2061   +SKIP.    >>> a
-0001c390: 203d 2064 612e 6672 6f6d 5f61 7272 6179   = da.from_array
-0001c3a0: 2878 2c20 6368 756e 6b73 3d27 3130 3020  (x, chunks='100 
-0001c3b0: 4d69 4227 2920 2023 2064 6f63 7465 7374  MiB')  # doctest
-0001c3c0: 3a20 2b53 4b49 500a 2020 2020 3e3e 3e20  : +SKIP.    >>> 
-0001c3d0: 6120 3d20 6461 2e66 726f 6d5f 6172 7261  a = da.from_arra
-0001c3e0: 7928 7829 2020 2320 646f 6374 6573 743a  y(x)  # doctest:
-0001c3f0: 202b 534b 4950 0a0a 2020 2020 4966 2070   +SKIP..    If p
-0001c400: 726f 7669 6469 6e67 2061 206e 616d 652c  roviding a name,
-0001c410: 2065 6e73 7572 6520 7468 6174 2069 7420   ensure that it 
-0001c420: 6973 2075 6e69 7175 650a 0a20 2020 203e  is unique..    >
-0001c430: 3e3e 2069 6d70 6f72 7420 6461 736b 2e62  >> import dask.b
-0001c440: 6173 650a 2020 2020 3e3e 3e20 746f 6b65  ase.    >>> toke
-0001c450: 6e20 3d20 6461 736b 2e62 6173 652e 746f  n = dask.base.to
-0001c460: 6b65 6e69 7a65 2878 2920 2023 2064 6f63  kenize(x)  # doc
-0001c470: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-0001c480: 3e3e 3e20 6120 3d20 6461 2e66 726f 6d5f  >>> a = da.from_
-0001c490: 6172 7261 7928 276d 7961 7272 6179 2d27  array('myarray-'
-0001c4a0: 202b 2074 6f6b 656e 2920 2023 2064 6f63   + token)  # doc
-0001c4b0: 7465 7374 3a20 2b53 4b49 500a 0a20 2020  test: +SKIP..   
-0001c4c0: 204e 756d 5079 206e 6461 7272 6179 7320   NumPy ndarrays 
-0001c4d0: 6172 6520 6561 6765 726c 7920 736c 6963  are eagerly slic
-0001c4e0: 6564 2061 6e64 2074 6865 6e20 656d 6265  ed and then embe
-0001c4f0: 6464 6564 2069 6e20 7468 6520 6772 6170  dded in the grap
-0001c500: 682e 0a0a 2020 2020 3e3e 3e20 696d 706f  h...    >>> impo
-0001c510: 7274 2064 6173 6b2e 6172 7261 790a 2020  rt dask.array.  
-0001c520: 2020 3e3e 3e20 6120 3d20 6461 736b 2e61    >>> a = dask.a
-0001c530: 7272 6179 2e66 726f 6d5f 6172 7261 7928  rray.from_array(
-0001c540: 6e70 2e61 7272 6179 285b 5b31 2c20 325d  np.array([[1, 2]
-0001c550: 2c20 5b33 2c20 345d 5d29 2c20 6368 756e  , [3, 4]]), chun
-0001c560: 6b73 3d28 312c 3129 290a 2020 2020 3e3e  ks=(1,1)).    >>
-0001c570: 3e20 612e 6461 736b 5b61 2e6e 616d 652c  > a.dask[a.name,
-0001c580: 2030 2c20 305d 5b30 5d0a 2020 2020 6172   0, 0][0].    ar
-0001c590: 7261 7928 5b31 5d29 0a0a 2020 2020 4368  ray([1])..    Ch
-0001c5a0: 756e 6b73 2077 6974 6820 6578 6163 746c  unks with exactl
-0001c5b0: 792d 7370 6563 6966 6965 642c 2064 6966  y-specified, dif
-0001c5c0: 6665 7265 6e74 2073 697a 6573 2063 616e  ferent sizes can
-0001c5d0: 2062 6520 6372 6561 7465 642e 0a0a 2020   be created...  
-0001c5e0: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
-0001c5f0: 7079 2061 7320 6e70 0a20 2020 203e 3e3e  py as np.    >>>
-0001c600: 2069 6d70 6f72 7420 6461 736b 2e61 7272   import dask.arr
-0001c610: 6179 2061 7320 6461 0a20 2020 203e 3e3e  ay as da.    >>>
-0001c620: 2072 6e67 203d 206e 702e 7261 6e64 6f6d   rng = np.random
-0001c630: 2e64 6566 6175 6c74 5f72 6e67 2829 0a20  .default_rng(). 
-0001c640: 2020 203e 3e3e 2078 203d 2072 6e67 2e72     >>> x = rng.r
-0001c650: 616e 646f 6d28 2831 3030 2c20 3629 290a  andom((100, 6)).
-0001c660: 2020 2020 3e3e 3e20 6120 3d20 6461 2e66      >>> a = da.f
-0001c670: 726f 6d5f 6172 7261 7928 782c 2063 6875  rom_array(x, chu
-0001c680: 6e6b 733d 2828 3637 2c20 3333 292c 2028  nks=((67, 33), (
-0001c690: 362c 2929 290a 2020 2020 2222 220a 2020  6,))).    """.  
-0001c6a0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001c6b0: 782c 2041 7272 6179 293a 0a20 2020 2020  x, Array):.     
-0001c6c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0001c6d0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0001c6e0: 2022 4172 7261 7920 6973 2061 6c72 6561   "Array is alrea
-0001c6f0: 6479 2061 2064 6173 6b20 6172 7261 792e  dy a dask array.
-0001c700: 2055 7365 2027 6173 6172 7261 7927 206f   Use 'asarray' o
-0001c710: 7220 2220 2227 7265 6368 756e 6b27 2069  r " "'rechunk' i
-0001c720: 6e73 7465 6164 2e22 0a20 2020 2020 2020  nstead.".       
-0001c730: 2029 0a20 2020 2065 6c69 6620 6973 5f64   ).    elif is_d
-0001c740: 6173 6b5f 636f 6c6c 6563 7469 6f6e 2878  ask_collection(x
-0001c750: 293a 0a20 2020 2020 2020 2077 6172 6e69  ):.        warni
-0001c760: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-0001c770: 2020 2020 2020 2250 6173 7369 6e67 2061        "Passing a
-0001c780: 6e20 6f62 6a65 6374 2074 6f20 6461 736b  n object to dask
-0001c790: 2e61 7272 6179 2e66 726f 6d5f 6172 7261  .array.from_arra
-0001c7a0: 7920 7768 6963 6820 6973 2061 6c72 6561  y which is alrea
-0001c7b0: 6479 2061 2022 0a20 2020 2020 2020 2020  dy a ".         
-0001c7c0: 2020 2022 4461 736b 2063 6f6c 6c65 6374     "Dask collect
-0001c7d0: 696f 6e2e 2054 6869 7320 6361 6e20 6c65  ion. This can le
-0001c7e0: 6164 2074 6f20 756e 6578 7065 6374 6564  ad to unexpected
-0001c7f0: 2062 6568 6176 696f 722e 220a 2020 2020   behavior.".    
-0001c800: 2020 2020 290a 0a20 2020 2069 6620 6973      )..    if is
-0001c810: 696e 7374 616e 6365 2878 2c20 286c 6973  instance(x, (lis
-0001c820: 742c 2074 7570 6c65 2c20 6d65 6d6f 7279  t, tuple, memory
-0001c830: 7669 6577 2920 2b20 6e70 2e53 6361 6c61  view) + np.Scala
-0001c840: 7254 7970 6529 3a0a 2020 2020 2020 2020  rType):.        
-0001c850: 7820 3d20 6e70 2e61 7272 6179 2878 290a  x = np.array(x).
-0001c860: 0a20 2020 2069 6620 6173 6172 7261 7920  .    if asarray 
-0001c870: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0001c880: 2061 7361 7272 6179 203d 206e 6f74 2068   asarray = not h
-0001c890: 6173 6174 7472 2878 2c20 225f 5f61 7272  asattr(x, "__arr
-0001c8a0: 6179 5f66 756e 6374 696f 6e5f 5f22 290a  ay_function__").
-0001c8b0: 0a20 2020 2070 7265 7669 6f75 735f 6368  .    previous_ch
-0001c8c0: 756e 6b73 203d 2067 6574 6174 7472 2878  unks = getattr(x
-0001c8d0: 2c20 2263 6875 6e6b 7322 2c20 4e6f 6e65  , "chunks", None
-0001c8e0: 290a 0a20 2020 2063 6875 6e6b 7320 3d20  )..    chunks = 
-0001c8f0: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
-0001c900: 280a 2020 2020 2020 2020 6368 756e 6b73  (.        chunks
-0001c910: 2c20 782e 7368 6170 652c 2064 7479 7065  , x.shape, dtype
-0001c920: 3d78 2e64 7479 7065 2c20 7072 6576 696f  =x.dtype, previo
-0001c930: 7573 5f63 6875 6e6b 733d 7072 6576 696f  us_chunks=previo
-0001c940: 7573 5f63 6875 6e6b 730a 2020 2020 290a  us_chunks.    ).
-0001c950: 0a20 2020 2069 6620 6e61 6d65 2069 6e20  .    if name in 
-0001c960: 284e 6f6e 652c 2054 7275 6529 3a0a 2020  (None, True):.  
-0001c970: 2020 2020 2020 746f 6b65 6e20 3d20 746f        token = to
-0001c980: 6b65 6e69 7a65 2878 2c20 6368 756e 6b73  kenize(x, chunks
-0001c990: 2c20 6c6f 636b 2c20 6173 6172 7261 792c  , lock, asarray,
-0001c9a0: 2066 616e 6379 2c20 6765 7469 7465 6d2c   fancy, getitem,
-0001c9b0: 2069 6e6c 696e 655f 6172 7261 7929 0a20   inline_array). 
-0001c9c0: 2020 2020 2020 206e 616d 6520 3d20 6e61         name = na
-0001c9d0: 6d65 206f 7220 2261 7272 6179 2d22 202b  me or "array-" +
-0001c9e0: 2074 6f6b 656e 0a20 2020 2065 6c69 6620   token.    elif 
-0001c9f0: 6e61 6d65 2069 7320 4661 6c73 653a 0a20  name is False:. 
-0001ca00: 2020 2020 2020 206e 616d 6520 3d20 2261         name = "a
-0001ca10: 7272 6179 2d22 202b 2073 7472 2875 7569  rray-" + str(uui
-0001ca20: 642e 7575 6964 3128 2929 0a0a 2020 2020  d.uuid1())..    
-0001ca30: 6966 206c 6f63 6b20 6973 2054 7275 653a  if lock is True:
-0001ca40: 0a20 2020 2020 2020 206c 6f63 6b20 3d20  .        lock = 
-0001ca50: 5365 7269 616c 697a 6162 6c65 4c6f 636b  SerializableLock
-0001ca60: 2829 0a0a 2020 2020 6973 5f6e 6461 7272  ()..    is_ndarr
-0001ca70: 6179 203d 2074 7970 6528 7829 2069 6e20  ay = type(x) in 
-0001ca80: 286e 702e 6e64 6172 7261 792c 206e 702e  (np.ndarray, np.
-0001ca90: 6d61 2e63 6f72 652e 4d61 736b 6564 4172  ma.core.MaskedAr
-0001caa0: 7261 7929 0a20 2020 2069 735f 7369 6e67  ray).    is_sing
-0001cab0: 6c65 5f62 6c6f 636b 203d 2061 6c6c 286c  le_block = all(l
-0001cac0: 656e 2863 2920 3d3d 2031 2066 6f72 2063  en(c) == 1 for c
-0001cad0: 2069 6e20 6368 756e 6b73 290a 2020 2020   in chunks).    
-0001cae0: 2320 416c 7761 7973 2075 7365 2074 6865  # Always use the
-0001caf0: 2067 6574 7465 7220 666f 7220 6835 7079   getter for h5py
-0001cb00: 2065 7463 2e20 4e6f 7420 7573 696e 6720   etc. Not using 
-0001cb10: 6973 696e 7374 616e 6365 2878 2c20 6e70  isinstance(x, np
-0001cb20: 2e6e 6461 7272 6179 290a 2020 2020 2320  .ndarray).    # 
-0001cb30: 6265 6361 7573 6520 6e70 2e6d 6174 7269  because np.matri
-0001cb40: 7820 6973 2061 2073 7562 636c 6173 7320  x is a subclass 
-0001cb50: 6f66 206e 702e 6e64 6172 7261 792e 0a20  of np.ndarray.. 
-0001cb60: 2020 2069 6620 6973 5f6e 6461 7272 6179     if is_ndarray
-0001cb70: 2061 6e64 206e 6f74 2069 735f 7369 6e67   and not is_sing
-0001cb80: 6c65 5f62 6c6f 636b 2061 6e64 206e 6f74  le_block and not
-0001cb90: 206c 6f63 6b3a 0a20 2020 2020 2020 2023   lock:.        #
-0001cba0: 2065 6167 6572 6c79 2073 6c69 6365 206e   eagerly slice n
-0001cbb0: 756d 7079 2061 7272 6179 7320 746f 2070  umpy arrays to p
-0001cbc0: 7265 7665 6e74 206d 656d 6f72 7920 626c  revent memory bl
-0001cbd0: 6f77 7570 0a20 2020 2020 2020 2023 2047  owup.        # G
-0001cbe0: 4835 3336 372c 2047 4835 3630 310a 2020  H5367, GH5601.  
-0001cbf0: 2020 2020 2020 736c 6963 6573 203d 2073        slices = s
-0001cc00: 6c69 6365 735f 6672 6f6d 5f63 6875 6e6b  lices_from_chunk
-0001cc10: 7328 6368 756e 6b73 290a 2020 2020 2020  s(chunks).      
-0001cc20: 2020 6b65 7973 203d 2070 726f 6475 6374    keys = product
-0001cc30: 285b 6e61 6d65 5d2c 202a 2872 616e 6765  ([name], *(range
-0001cc40: 286c 656e 2862 6473 2929 2066 6f72 2062  (len(bds)) for b
-0001cc50: 6473 2069 6e20 6368 756e 6b73 2929 0a20  ds in chunks)). 
-0001cc60: 2020 2020 2020 2076 616c 7565 7320 3d20         values = 
-0001cc70: 5b78 5b73 6c63 5d20 666f 7220 736c 6320  [x[slc] for slc 
-0001cc80: 696e 2073 6c69 6365 735d 0a20 2020 2020  in slices].     
-0001cc90: 2020 2064 736b 203d 2064 6963 7428 7a69     dsk = dict(zi
-0001cca0: 7028 6b65 7973 2c20 7661 6c75 6573 2929  p(keys, values))
-0001ccb0: 0a0a 2020 2020 656c 6966 2069 735f 6e64  ..    elif is_nd
-0001ccc0: 6172 7261 7920 616e 6420 6973 5f73 696e  array and is_sin
-0001ccd0: 676c 655f 626c 6f63 6b3a 0a20 2020 2020  gle_block:.     
-0001cce0: 2020 2023 204e 6f20 736c 6963 696e 6720     # No slicing 
-0001ccf0: 6e65 6564 6564 0a20 2020 2020 2020 2064  needed.        d
-0001cd00: 736b 203d 207b 286e 616d 652c 2920 2b20  sk = {(name,) + 
-0001cd10: 2830 2c29 202a 2078 2e6e 6469 6d3a 2078  (0,) * x.ndim: x
-0001cd20: 7d0a 2020 2020 656c 7365 3a0a 2020 2020  }.    else:.    
-0001cd30: 2020 2020 6966 2067 6574 6974 656d 2069      if getitem i
-0001cd40: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0001cd50: 2020 2020 6966 2066 616e 6379 3a0a 2020      if fancy:.  
-0001cd60: 2020 2020 2020 2020 2020 2020 2020 6765                ge
-0001cd70: 7469 7465 6d20 3d20 6765 7474 6572 0a20  titem = getter. 
-0001cd80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001cd90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cda0: 2067 6574 6974 656d 203d 2067 6574 7465   getitem = gette
-0001cdb0: 725f 6e6f 6661 6e63 790a 0a20 2020 2020  r_nofancy..     
-0001cdc0: 2020 2064 736b 203d 2067 7261 7068 5f66     dsk = graph_f
-0001cdd0: 726f 6d5f 6172 7261 796c 696b 6528 0a20  rom_arraylike(. 
-0001cde0: 2020 2020 2020 2020 2020 2078 2c0a 2020             x,.  
-0001cdf0: 2020 2020 2020 2020 2020 6368 756e 6b73            chunks
-0001ce00: 2c0a 2020 2020 2020 2020 2020 2020 782e  ,.            x.
-0001ce10: 7368 6170 652c 0a20 2020 2020 2020 2020  shape,.         
-0001ce20: 2020 206e 616d 652c 0a20 2020 2020 2020     name,.       
-0001ce30: 2020 2020 2067 6574 6974 656d 3d67 6574       getitem=get
-0001ce40: 6974 656d 2c0a 2020 2020 2020 2020 2020  item,.          
-0001ce50: 2020 6c6f 636b 3d6c 6f63 6b2c 0a20 2020    lock=lock,.   
-0001ce60: 2020 2020 2020 2020 2061 7361 7272 6179           asarray
-0001ce70: 3d61 7361 7272 6179 2c0a 2020 2020 2020  =asarray,.      
-0001ce80: 2020 2020 2020 6474 7970 653d 782e 6474        dtype=x.dt
-0001ce90: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0001cea0: 2069 6e6c 696e 655f 6172 7261 793d 696e   inline_array=in
-0001ceb0: 6c69 6e65 5f61 7272 6179 2c0a 2020 2020  line_array,.    
-0001cec0: 2020 2020 290a 0a20 2020 2023 2057 6f72      )..    # Wor
-0001ced0: 6b61 726f 756e 6420 666f 7220 5469 6c65  karound for Tile
-0001cee0: 4442 2c20 6974 7320 696e 6465 7869 6e67  DB, its indexing
-0001cef0: 2069 7320 312d 6261 7365 642c 0a20 2020   is 1-based,.   
-0001cf00: 2023 2061 6e64 2064 6f65 736e 2774 2073   # and doesn't s
-0001cf10: 6565 6d73 2074 6f20 7375 7070 6f72 7420  eems to support 
-0001cf20: 302d 6c65 6e67 7468 2073 6c69 6369 6e67  0-length slicing
-0001cf30: 0a20 2020 2069 6620 782e 5f5f 636c 6173  .    if x.__clas
-0001cf40: 735f 5f2e 5f5f 6d6f 6475 6c65 5f5f 2e73  s__.__module__.s
-0001cf50: 706c 6974 2822 2e22 295b 305d 203d 3d20  plit(".")[0] == 
-0001cf60: 2274 696c 6564 6222 2061 6e64 2068 6173  "tiledb" and has
-0001cf70: 6174 7472 2878 2c20 225f 6374 785f 2229  attr(x, "_ctx_")
-0001cf80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001cf90: 2041 7272 6179 2864 736b 2c20 6e61 6d65   Array(dsk, name
-0001cfa0: 2c20 6368 756e 6b73 2c20 6474 7970 653d  , chunks, dtype=
-0001cfb0: 782e 6474 7970 6529 0a0a 2020 2020 6966  x.dtype)..    if
-0001cfc0: 206d 6574 6120 6973 204e 6f6e 653a 0a20   meta is None:. 
-0001cfd0: 2020 2020 2020 206d 6574 6120 3d20 780a         meta = x.
-0001cfe0: 0a20 2020 2072 6574 7572 6e20 4172 7261  .    return Arra
-0001cff0: 7928 6473 6b2c 206e 616d 652c 2063 6875  y(dsk, name, chu
-0001d000: 6e6b 732c 206d 6574 613d 6d65 7461 2c20  nks, meta=meta, 
-0001d010: 6474 7970 653d 6765 7461 7474 7228 782c  dtype=getattr(x,
-0001d020: 2022 6474 7970 6522 2c20 4e6f 6e65 2929   "dtype", None))
-0001d030: 0a0a 0a64 6566 2066 726f 6d5f 7a61 7272  ...def from_zarr
-0001d040: 280a 2020 2020 7572 6c2c 0a20 2020 2063  (.    url,.    c
-0001d050: 6f6d 706f 6e65 6e74 3d4e 6f6e 652c 0a20  omponent=None,. 
-0001d060: 2020 2073 746f 7261 6765 5f6f 7074 696f     storage_optio
-0001d070: 6e73 3d4e 6f6e 652c 0a20 2020 2063 6875  ns=None,.    chu
-0001d080: 6e6b 733d 4e6f 6e65 2c0a 2020 2020 6e61  nks=None,.    na
-0001d090: 6d65 3d4e 6f6e 652c 0a20 2020 2069 6e6c  me=None,.    inl
-0001d0a0: 696e 655f 6172 7261 793d 4661 6c73 652c  ine_array=False,
-0001d0b0: 0a20 2020 202a 2a6b 7761 7267 732c 0a29  .    **kwargs,.)
-0001d0c0: 3a0a 2020 2020 2222 224c 6f61 6420 6172  :.    """Load ar
-0001d0d0: 7261 7920 6672 6f6d 2074 6865 207a 6172  ray from the zar
-0001d0e0: 7220 7374 6f72 6167 6520 666f 726d 6174  r storage format
-0001d0f0: 0a0a 2020 2020 5365 6520 6874 7470 733a  ..    See https:
-0001d100: 2f2f 7a61 7272 2e72 6561 6474 6865 646f  //zarr.readthedo
-0001d110: 6373 2e69 6f20 666f 7220 6465 7461 696c  cs.io for detail
-0001d120: 7320 6162 6f75 7420 7468 6520 666f 726d  s about the form
-0001d130: 6174 2e0a 0a20 2020 2050 6172 616d 6574  at...    Paramet
-0001d140: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-0001d150: 2d2d 0a20 2020 2075 726c 3a20 5a61 7272  --.    url: Zarr
-0001d160: 2041 7272 6179 206f 7220 7374 7220 6f72   Array or str or
-0001d170: 204d 7574 6162 6c65 4d61 7070 696e 670a   MutableMapping.
-0001d180: 2020 2020 2020 2020 4c6f 6361 7469 6f6e          Location
-0001d190: 206f 6620 7468 6520 6461 7461 2e20 4120   of the data. A 
-0001d1a0: 5552 4c20 6361 6e20 696e 636c 7564 6520  URL can include 
-0001d1b0: 6120 7072 6f74 6f63 6f6c 2073 7065 6369  a protocol speci
-0001d1c0: 6669 6572 206c 696b 6520 7333 3a2f 2f0a  fier like s3://.
-0001d1d0: 2020 2020 2020 2020 666f 7220 7265 6d6f          for remo
-0001d1e0: 7465 2064 6174 612e 2043 616e 2061 6c73  te data. Can als
-0001d1f0: 6f20 6265 2061 6e79 204d 7574 6162 6c65  o be any Mutable
-0001d200: 4d61 7070 696e 6720 696e 7374 616e 6365  Mapping instance
-0001d210: 2c20 7768 6963 6820 7368 6f75 6c64 0a20  , which should. 
-0001d220: 2020 2020 2020 2062 6520 7365 7269 616c         be serial
-0001d230: 697a 6162 6c65 2069 6620 7573 6564 2069  izable if used i
-0001d240: 6e20 6d75 6c74 6970 6c65 2070 726f 6365  n multiple proce
-0001d250: 7373 6573 2e0a 2020 2020 636f 6d70 6f6e  sses..    compon
-0001d260: 656e 743a 2073 7472 206f 7220 4e6f 6e65  ent: str or None
-0001d270: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
-0001d280: 6c6f 6361 7469 6f6e 2069 7320 6120 7a61  location is a za
-0001d290: 7272 2067 726f 7570 2072 6174 6865 7220  rr group rather 
-0001d2a0: 7468 616e 2061 6e20 6172 7261 792c 2074  than an array, t
-0001d2b0: 6869 7320 6973 2074 6865 0a20 2020 2020  his is the.     
-0001d2c0: 2020 2073 7562 636f 6d70 6f6e 656e 7420     subcomponent 
-0001d2d0: 7468 6174 2073 686f 756c 6420 6265 206c  that should be l
-0001d2e0: 6f61 6465 642c 2073 6f6d 6574 6869 6e67  oaded, something
-0001d2f0: 206c 696b 6520 6060 2766 6f6f 2f62 6172   like ``'foo/bar
-0001d300: 2760 602e 0a20 2020 2073 746f 7261 6765  '``..    storage
-0001d310: 5f6f 7074 696f 6e73 3a20 6469 6374 0a20  _options: dict. 
-0001d320: 2020 2020 2020 2041 6e79 2061 6464 6974         Any addit
-0001d330: 696f 6e61 6c20 7061 7261 6d65 7465 7273  ional parameters
-0001d340: 2066 6f72 2074 6865 2073 746f 7261 6765   for the storage
-0001d350: 2062 6163 6b65 6e64 2028 6967 6e6f 7265   backend (ignore
-0001d360: 6420 666f 7220 6c6f 6361 6c0a 2020 2020  d for local.    
-0001d370: 2020 2020 7061 7468 7329 0a20 2020 2063      paths).    c
-0001d380: 6875 6e6b 733a 2074 7570 6c65 206f 6620  hunks: tuple of 
-0001d390: 696e 7473 206f 7220 7475 706c 6573 206f  ints or tuples o
-0001d3a0: 6620 696e 7473 0a20 2020 2020 2020 2050  f ints.        P
-0001d3b0: 6173 7365 6420 746f 203a 6675 6e63 3a60  assed to :func:`
-0001d3c0: 6461 736b 2e61 7272 6179 2e66 726f 6d5f  dask.array.from_
-0001d3d0: 6172 7261 7960 2c20 616c 6c6f 7773 2073  array`, allows s
-0001d3e0: 6574 7469 6e67 2074 6865 2063 6875 6e6b  etting the chunk
-0001d3f0: 7320 6f6e 0a20 2020 2020 2020 2069 6e69  s on.        ini
-0001d400: 7469 616c 6973 6174 696f 6e2c 2069 6620  tialisation, if 
-0001d410: 7468 6520 6368 756e 6b69 6e67 2073 6368  the chunking sch
-0001d420: 656d 6520 696e 2074 6865 206f 6e2d 6469  eme in the on-di
-0001d430: 7363 2064 6174 6173 6574 2069 7320 6e6f  sc dataset is no
-0001d440: 740a 2020 2020 2020 2020 6f70 7469 6d61  t.        optima
-0001d450: 6c20 666f 7220 7468 6520 6361 6c63 756c  l for the calcul
-0001d460: 6174 696f 6e73 2074 6f20 666f 6c6c 6f77  ations to follow
-0001d470: 2e0a 2020 2020 6e61 6d65 203a 2073 7472  ..    name : str
-0001d480: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0001d490: 2020 2020 416e 206f 7074 696f 6e61 6c20      An optional 
-0001d4a0: 6b65 796e 616d 6520 666f 7220 7468 6520  keyname for the 
-0001d4b0: 6172 7261 792e 2020 4465 6661 756c 7473  array.  Defaults
-0001d4c0: 2074 6f20 6861 7368 696e 6720 7468 6520   to hashing the 
-0001d4d0: 696e 7075 740a 2020 2020 6b77 6172 6773  input.    kwargs
-0001d4e0: 3a0a 2020 2020 2020 2020 5061 7373 6564  :.        Passed
-0001d4f0: 2074 6f20 3a63 6c61 7373 3a60 7a61 7272   to :class:`zarr
-0001d500: 2e63 6f72 652e 4172 7261 7960 2e0a 2020  .core.Array`..  
-0001d510: 2020 696e 6c69 6e65 5f61 7272 6179 203a    inline_array :
-0001d520: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
-0001d530: 616c 7365 0a20 2020 2020 2020 2057 6865  alse.        Whe
-0001d540: 7468 6572 2074 6f20 696e 6c69 6e65 2074  ther to inline t
-0001d550: 6865 207a 6172 7220 4172 7261 7920 696e  he zarr Array in
-0001d560: 2074 6865 2076 616c 7565 7320 6f66 2074   the values of t
-0001d570: 6865 2074 6173 6b20 6772 6170 682e 0a20  he task graph.. 
-0001d580: 2020 2020 2020 2053 6565 203a 6d65 7468         See :meth
-0001d590: 3a60 6461 736b 2e61 7272 6179 2e66 726f  :`dask.array.fro
-0001d5a0: 6d5f 6172 7261 7960 2066 6f72 2061 6e20  m_array` for an 
-0001d5b0: 6578 706c 616e 6174 696f 6e2e 0a0a 2020  explanation...  
-0001d5c0: 2020 5365 6520 416c 736f 0a20 2020 202d    See Also.    -
-0001d5d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6672 6f6d  -------.    from
-0001d5e0: 5f61 7272 6179 0a20 2020 2022 2222 0a20  _array.    """. 
-0001d5f0: 2020 2069 6d70 6f72 7420 7a61 7272 0a0a     import zarr..
-0001d600: 2020 2020 7374 6f72 6167 655f 6f70 7469      storage_opti
-0001d610: 6f6e 7320 3d20 7374 6f72 6167 655f 6f70  ons = storage_op
-0001d620: 7469 6f6e 7320 6f72 207b 7d0a 2020 2020  tions or {}.    
-0001d630: 6966 2069 7369 6e73 7461 6e63 6528 7572  if isinstance(ur
-0001d640: 6c2c 207a 6172 722e 4172 7261 7929 3a0a  l, zarr.Array):.
-0001d650: 2020 2020 2020 2020 7a20 3d20 7572 6c0a          z = url.
-0001d660: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0001d670: 6e63 6528 7572 6c2c 2028 7374 722c 206f  nce(url, (str, o
-0001d680: 732e 5061 7468 4c69 6b65 2929 3a0a 2020  s.PathLike)):.  
-0001d690: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001d6a0: 6e63 6528 7572 6c2c 206f 732e 5061 7468  nce(url, os.Path
-0001d6b0: 4c69 6b65 293a 0a20 2020 2020 2020 2020  Like):.         
-0001d6c0: 2020 2075 726c 203d 206f 732e 6673 7061     url = os.fspa
-0001d6d0: 7468 2875 726c 290a 2020 2020 2020 2020  th(url).        
-0001d6e0: 6966 2073 746f 7261 6765 5f6f 7074 696f  if storage_optio
-0001d6f0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-0001d700: 7374 6f72 6520 3d20 7a61 7272 2e73 746f  store = zarr.sto
-0001d710: 7261 6765 2e46 5353 746f 7265 2875 726c  rage.FSStore(url
-0001d720: 2c20 2a2a 7374 6f72 6167 655f 6f70 7469  , **storage_opti
-0001d730: 6f6e 7329 0a20 2020 2020 2020 2065 6c73  ons).        els
-0001d740: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0001d750: 746f 7265 203d 2075 726c 0a20 2020 2020  tore = url.     
-0001d760: 2020 207a 203d 207a 6172 722e 4172 7261     z = zarr.Arra
-0001d770: 7928 7374 6f72 652c 2072 6561 645f 6f6e  y(store, read_on
-0001d780: 6c79 3d54 7275 652c 2070 6174 683d 636f  ly=True, path=co
-0001d790: 6d70 6f6e 656e 742c 202a 2a6b 7761 7267  mponent, **kwarg
-0001d7a0: 7329 0a20 2020 2065 6c73 653a 0a20 2020  s).    else:.   
-0001d7b0: 2020 2020 207a 203d 207a 6172 722e 4172       z = zarr.Ar
-0001d7c0: 7261 7928 7572 6c2c 2072 6561 645f 6f6e  ray(url, read_on
-0001d7d0: 6c79 3d54 7275 652c 2070 6174 683d 636f  ly=True, path=co
-0001d7e0: 6d70 6f6e 656e 742c 202a 2a6b 7761 7267  mponent, **kwarg
-0001d7f0: 7329 0a20 2020 2063 6875 6e6b 7320 3d20  s).    chunks = 
-0001d800: 6368 756e 6b73 2069 6620 6368 756e 6b73  chunks if chunks
-0001d810: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-0001d820: 6520 7a2e 6368 756e 6b73 0a20 2020 2069  e z.chunks.    i
-0001d830: 6620 6e61 6d65 2069 7320 4e6f 6e65 3a0a  f name is None:.
-0001d840: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
-0001d850: 6672 6f6d 2d7a 6172 722d 2220 2b20 746f  from-zarr-" + to
-0001d860: 6b65 6e69 7a65 287a 2c20 636f 6d70 6f6e  kenize(z, compon
-0001d870: 656e 742c 2073 746f 7261 6765 5f6f 7074  ent, storage_opt
-0001d880: 696f 6e73 2c20 6368 756e 6b73 2c20 2a2a  ions, chunks, **
-0001d890: 6b77 6172 6773 290a 2020 2020 7265 7475  kwargs).    retu
-0001d8a0: 726e 2066 726f 6d5f 6172 7261 7928 7a2c  rn from_array(z,
-0001d8b0: 2063 6875 6e6b 732c 206e 616d 653d 6e61   chunks, name=na
-0001d8c0: 6d65 2c20 696e 6c69 6e65 5f61 7272 6179  me, inline_array
-0001d8d0: 3d69 6e6c 696e 655f 6172 7261 7929 0a0a  =inline_array)..
-0001d8e0: 0a64 6566 2074 6f5f 7a61 7272 280a 2020  .def to_zarr(.  
-0001d8f0: 2020 6172 722c 0a20 2020 2075 726c 2c0a    arr,.    url,.
-0001d900: 2020 2020 636f 6d70 6f6e 656e 743d 4e6f      component=No
-0001d910: 6e65 2c0a 2020 2020 7374 6f72 6167 655f  ne,.    storage_
-0001d920: 6f70 7469 6f6e 733d 4e6f 6e65 2c0a 2020  options=None,.  
-0001d930: 2020 6f76 6572 7772 6974 653d 4661 6c73    overwrite=Fals
-0001d940: 652c 0a20 2020 2072 6567 696f 6e3d 4e6f  e,.    region=No
-0001d950: 6e65 2c0a 2020 2020 636f 6d70 7574 653d  ne,.    compute=
-0001d960: 5472 7565 2c0a 2020 2020 7265 7475 726e  True,.    return
-0001d970: 5f73 746f 7265 643d 4661 6c73 652c 0a20  _stored=False,. 
-0001d980: 2020 202a 2a6b 7761 7267 732c 0a29 3a0a     **kwargs,.):.
-0001d990: 2020 2020 2222 2253 6176 6520 6172 7261      """Save arra
-0001d9a0: 7920 746f 2074 6865 207a 6172 7220 7374  y to the zarr st
-0001d9b0: 6f72 6167 6520 666f 726d 6174 0a0a 2020  orage format..  
-0001d9c0: 2020 5365 6520 6874 7470 733a 2f2f 7a61    See https://za
-0001d9d0: 7272 2e72 6561 6474 6865 646f 6373 2e69  rr.readthedocs.i
-0001d9e0: 6f20 666f 7220 6465 7461 696c 7320 6162  o for details ab
-0001d9f0: 6f75 7420 7468 6520 666f 726d 6174 2e0a  out the format..
-0001da00: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-0001da10: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0001da20: 2020 2061 7272 3a20 6461 736b 2e61 7272     arr: dask.arr
-0001da30: 6179 0a20 2020 2020 2020 2044 6174 6120  ay.        Data 
-0001da40: 746f 2073 746f 7265 0a20 2020 2075 726c  to store.    url
-0001da50: 3a20 5a61 7272 2041 7272 6179 206f 7220  : Zarr Array or 
-0001da60: 7374 7220 6f72 204d 7574 6162 6c65 4d61  str or MutableMa
-0001da70: 7070 696e 670a 2020 2020 2020 2020 4c6f  pping.        Lo
-0001da80: 6361 7469 6f6e 206f 6620 7468 6520 6461  cation of the da
-0001da90: 7461 2e20 4120 5552 4c20 6361 6e20 696e  ta. A URL can in
-0001daa0: 636c 7564 6520 6120 7072 6f74 6f63 6f6c  clude a protocol
-0001dab0: 2073 7065 6369 6669 6572 206c 696b 6520   specifier like 
-0001dac0: 7333 3a2f 2f0a 2020 2020 2020 2020 666f  s3://.        fo
-0001dad0: 7220 7265 6d6f 7465 2064 6174 612e 2043  r remote data. C
-0001dae0: 616e 2061 6c73 6f20 6265 2061 6e79 204d  an also be any M
-0001daf0: 7574 6162 6c65 4d61 7070 696e 6720 696e  utableMapping in
-0001db00: 7374 616e 6365 2c20 7768 6963 6820 7368  stance, which sh
-0001db10: 6f75 6c64 0a20 2020 2020 2020 2062 6520  ould.        be 
-0001db20: 7365 7269 616c 697a 6162 6c65 2069 6620  serializable if 
-0001db30: 7573 6564 2069 6e20 6d75 6c74 6970 6c65  used in multiple
-0001db40: 2070 726f 6365 7373 6573 2e0a 2020 2020   processes..    
-0001db50: 636f 6d70 6f6e 656e 743a 2073 7472 206f  component: str o
-0001db60: 7220 4e6f 6e65 0a20 2020 2020 2020 2049  r None.        I
-0001db70: 6620 7468 6520 6c6f 6361 7469 6f6e 2069  f the location i
-0001db80: 7320 6120 7a61 7272 2067 726f 7570 2072  s a zarr group r
-0001db90: 6174 6865 7220 7468 616e 2061 6e20 6172  ather than an ar
-0001dba0: 7261 792c 2074 6869 7320 6973 2074 6865  ray, this is the
-0001dbb0: 0a20 2020 2020 2020 2073 7562 636f 6d70  .        subcomp
-0001dbc0: 6f6e 656e 7420 7468 6174 2073 686f 756c  onent that shoul
-0001dbd0: 6420 6265 2063 7265 6174 6564 2f6f 7665  d be created/ove
-0001dbe0: 722d 7772 6974 7465 6e2e 0a20 2020 2073  r-written..    s
-0001dbf0: 746f 7261 6765 5f6f 7074 696f 6e73 3a20  torage_options: 
-0001dc00: 6469 6374 0a20 2020 2020 2020 2041 6e79  dict.        Any
-0001dc10: 2061 6464 6974 696f 6e61 6c20 7061 7261   additional para
-0001dc20: 6d65 7465 7273 2066 6f72 2074 6865 2073  meters for the s
-0001dc30: 746f 7261 6765 2062 6163 6b65 6e64 2028  torage backend (
-0001dc40: 6967 6e6f 7265 6420 666f 7220 6c6f 6361  ignored for loca
-0001dc50: 6c0a 2020 2020 2020 2020 7061 7468 7329  l.        paths)
-0001dc60: 0a20 2020 206f 7665 7277 7269 7465 3a20  .    overwrite: 
-0001dc70: 626f 6f6c 0a20 2020 2020 2020 2049 6620  bool.        If 
-0001dc80: 6769 7665 6e20 6172 7261 7920 616c 7265  given array alre
-0001dc90: 6164 7920 6578 6973 7473 2c20 6f76 6572  ady exists, over
-0001dca0: 7772 6974 653d 4661 6c73 6520 7769 6c6c  write=False will
-0001dcb0: 2063 6175 7365 2061 6e20 6572 726f 722c   cause an error,
-0001dcc0: 0a20 2020 2020 2020 2077 6865 7265 206f  .        where o
-0001dcd0: 7665 7277 7269 7465 3d54 7275 6520 7769  verwrite=True wi
-0001dce0: 6c6c 2072 6570 6c61 6365 2074 6865 2065  ll replace the e
-0001dcf0: 7869 7374 696e 6720 6461 7461 2e0a 2020  xisting data..  
-0001dd00: 2020 7265 6769 6f6e 3a20 7475 706c 6520    region: tuple 
-0001dd10: 6f66 2073 6c69 6365 7320 6f72 204e 6f6e  of slices or Non
-0001dd20: 650a 2020 2020 2020 2020 5468 6520 7265  e.        The re
-0001dd30: 6769 6f6e 206f 6620 6461 7461 2074 6861  gion of data tha
-0001dd40: 7420 7368 6f75 6c64 2062 6520 7772 6974  t should be writ
-0001dd50: 7465 6e20 6966 2060 6075 726c 6060 2069  ten if ``url`` i
-0001dd60: 7320 6120 7a61 7272 2e41 7272 6179 2e0a  s a zarr.Array..
-0001dd70: 2020 2020 2020 2020 4e6f 7420 746f 2062          Not to b
-0001dd80: 6520 7573 6564 2077 6974 6820 6f74 6865  e used with othe
-0001dd90: 7220 7479 7065 7320 6f66 2060 6075 726c  r types of ``url
-0001dda0: 6060 2e0a 2020 2020 636f 6d70 7574 653a  ``..    compute:
-0001ddb0: 2062 6f6f 6c0a 2020 2020 2020 2020 5365   bool.        Se
-0001ddc0: 6520 3a66 756e 633a 607e 6461 736b 2e61  e :func:`~dask.a
-0001ddd0: 7272 6179 2e73 746f 7265 6020 666f 7220  rray.store` for 
-0001dde0: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
-0001ddf0: 2020 7265 7475 726e 5f73 746f 7265 643a    return_stored:
-0001de00: 2062 6f6f 6c0a 2020 2020 2020 2020 5365   bool.        Se
-0001de10: 6520 3a66 756e 633a 607e 6461 736b 2e61  e :func:`~dask.a
-0001de20: 7272 6179 2e73 746f 7265 6020 666f 7220  rray.store` for 
-0001de30: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
-0001de40: 2020 2a2a 6b77 6172 6773 3a0a 2020 2020    **kwargs:.    
-0001de50: 2020 2020 5061 7373 6564 2074 6f20 7468      Passed to th
-0001de60: 6520 3a66 756e 633a 607a 6172 722e 6372  e :func:`zarr.cr
-0001de70: 6561 7469 6f6e 2e63 7265 6174 6560 2066  eation.create` f
-0001de80: 756e 6374 696f 6e2c 2065 2e67 2e2c 2063  unction, e.g., c
-0001de90: 6f6d 7072 6573 7369 6f6e 206f 7074 696f  ompression optio
-0001dea0: 6e73 2e0a 0a20 2020 2052 6169 7365 730a  ns...    Raises.
-0001deb0: 2020 2020 2d2d 2d2d 2d2d 0a20 2020 2056      ------.    V
-0001dec0: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
-0001ded0: 2020 4966 2060 6061 7272 6060 2068 6173    If ``arr`` has
-0001dee0: 2075 6e6b 6e6f 776e 2063 6875 6e6b 2073   unknown chunk s
-0001def0: 697a 6573 2c20 7768 6963 6820 6973 206e  izes, which is n
-0001df00: 6f74 2073 7570 706f 7274 6564 2062 7920  ot supported by 
-0001df10: 5a61 7272 2e0a 2020 2020 2020 2020 4966  Zarr..        If
-0001df20: 2060 6072 6567 696f 6e60 6020 6973 2073   ``region`` is s
-0001df30: 7065 6369 6669 6564 2061 6e64 2060 6075  pecified and ``u
-0001df40: 726c 6060 2069 7320 6e6f 7420 6120 7a61  rl`` is not a za
-0001df50: 7272 2e41 7272 6179 0a0a 2020 2020 5365  rr.Array..    Se
-0001df60: 6520 416c 736f 0a20 2020 202d 2d2d 2d2d  e Also.    -----
-0001df70: 2d2d 2d0a 2020 2020 6461 736b 2e61 7272  ---.    dask.arr
-0001df80: 6179 2e73 746f 7265 0a20 2020 2064 6173  ay.store.    das
-0001df90: 6b2e 6172 7261 792e 4172 7261 792e 636f  k.array.Array.co
-0001dfa0: 6d70 7574 655f 6368 756e 6b5f 7369 7a65  mpute_chunk_size
-0001dfb0: 730a 0a20 2020 2022 2222 0a20 2020 2069  s..    """.    i
-0001dfc0: 6d70 6f72 7420 7a61 7272 0a0a 2020 2020  mport zarr..    
-0001dfd0: 6966 206e 702e 6973 6e61 6e28 6172 722e  if np.isnan(arr.
-0001dfe0: 7368 6170 6529 2e61 6e79 2829 3a0a 2020  shape).any():.  
-0001dff0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001e000: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0001e010: 2020 2020 2253 6176 696e 6720 6120 6461      "Saving a da
-0001e020: 736b 2061 7272 6179 2077 6974 6820 756e  sk array with un
-0001e030: 6b6e 6f77 6e20 6368 756e 6b20 7369 7a65  known chunk size
-0001e040: 7320 6973 206e 6f74 2022 0a20 2020 2020  s is not ".     
-0001e050: 2020 2020 2020 2022 6375 7272 656e 746c         "currentl
-0001e060: 7920 7375 7070 6f72 7465 6420 6279 205a  y supported by Z
-0001e070: 6172 722e 2573 2220 2520 756e 6b6e 6f77  arr.%s" % unknow
-0001e080: 6e5f 6368 756e 6b5f 6d65 7373 6167 650a  n_chunk_message.
-0001e090: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
-0001e0a0: 6620 6973 696e 7374 616e 6365 2875 726c  f isinstance(url
-0001e0b0: 2c20 7a61 7272 2e41 7272 6179 293a 0a20  , zarr.Array):. 
-0001e0c0: 2020 2020 2020 207a 203d 2075 726c 0a20         z = url. 
-0001e0d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001e0e0: 616e 6365 287a 2e73 746f 7265 2c20 2864  ance(z.store, (d
-0001e0f0: 6963 742c 204d 7574 6162 6c65 4d61 7070  ict, MutableMapp
-0001e100: 696e 6729 293a 0a20 2020 2020 2020 2020  ing)):.         
-0001e110: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0001e120: 2020 2020 2020 2020 6672 6f6d 2064 6973          from dis
-0001e130: 7472 6962 7574 6564 2069 6d70 6f72 7420  tributed import 
-0001e140: 6465 6661 756c 745f 636c 6965 6e74 0a0a  default_client..
-0001e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e160: 6465 6661 756c 745f 636c 6965 6e74 2829  default_client()
-0001e170: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-0001e180: 6570 7420 2849 6d70 6f72 7445 7272 6f72  ept (ImportError
-0001e190: 2c20 5661 6c75 6545 7272 6f72 293a 0a20  , ValueError):. 
-0001e1a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001e1b0: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
-0001e1c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001e1d0: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
-0001e1e0: 696d 6545 7272 6f72 280a 2020 2020 2020  imeError(.      
-0001e1f0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-0001e200: 616e 6e6f 7420 7374 6f72 6520 696e 746f  annot store into
-0001e210: 2069 6e20 6d65 6d6f 7279 205a 6172 7220   in memory Zarr 
-0001e220: 4172 7261 7920 7573 696e 6720 220a 2020  Array using ".  
-0001e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e240: 2020 2274 6865 2064 6973 7472 6962 7574    "the distribut
-0001e250: 6564 2073 6368 6564 756c 6572 2e22 0a20  ed scheduler.". 
-0001e260: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001e270: 0a0a 2020 2020 2020 2020 6966 2072 6567  ..        if reg
-0001e280: 696f 6e20 6973 204e 6f6e 653a 0a20 2020  ion is None:.   
-0001e290: 2020 2020 2020 2020 2061 7272 203d 2061           arr = a
-0001e2a0: 7272 2e72 6563 6875 6e6b 287a 2e63 6875  rr.rechunk(z.chu
-0001e2b0: 6e6b 7329 0a20 2020 2020 2020 2020 2020  nks).           
-0001e2c0: 2072 6567 696f 6e73 203d 204e 6f6e 650a   regions = None.
-0001e2d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001e2e0: 2020 2020 2020 2020 2020 6672 6f6d 2064            from d
-0001e2f0: 6173 6b2e 6172 7261 792e 736c 6963 696e  ask.array.slicin
-0001e300: 6720 696d 706f 7274 206e 6577 5f62 6c6f  g import new_blo
-0001e310: 636b 6469 6d2c 206e 6f72 6d61 6c69 7a65  ckdim, normalize
-0001e320: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
-0001e330: 2020 2020 6f6c 645f 6368 756e 6b73 203d      old_chunks =
-0001e340: 206e 6f72 6d61 6c69 7a65 5f63 6875 6e6b   normalize_chunk
-0001e350: 7328 7a2e 6368 756e 6b73 2c20 7a2e 7368  s(z.chunks, z.sh
-0001e360: 6170 6529 0a20 2020 2020 2020 2020 2020  ape).           
-0001e370: 2069 6e64 6578 203d 206e 6f72 6d61 6c69   index = normali
-0001e380: 7a65 5f69 6e64 6578 2872 6567 696f 6e2c  ze_index(region,
-0001e390: 207a 2e73 6861 7065 290a 2020 2020 2020   z.shape).      
-0001e3a0: 2020 2020 2020 6368 756e 6b73 203d 2074        chunks = t
-0001e3b0: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
-0001e3c0: 2020 2020 2020 7475 706c 6528 6e65 775f        tuple(new_
-0001e3d0: 626c 6f63 6b64 696d 2873 2c20 632c 2072  blockdim(s, c, r
-0001e3e0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001e3f0: 2020 2066 6f72 2073 2c20 632c 2072 2069     for s, c, r i
-0001e400: 6e20 7a69 7028 7a2e 7368 6170 652c 206f  n zip(z.shape, o
-0001e410: 6c64 5f63 6875 6e6b 732c 2069 6e64 6578  ld_chunks, index
-0001e420: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-0001e430: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
-0001e440: 3d20 6172 722e 7265 6368 756e 6b28 6368  = arr.rechunk(ch
-0001e450: 756e 6b73 290a 2020 2020 2020 2020 2020  unks).          
-0001e460: 2020 7265 6769 6f6e 7320 3d20 5b72 6567    regions = [reg
-0001e470: 696f 6e5d 0a20 2020 2020 2020 2072 6574  ion].        ret
-0001e480: 7572 6e20 6172 722e 7374 6f72 6528 0a20  urn arr.store(. 
-0001e490: 2020 2020 2020 2020 2020 207a 2c20 6c6f             z, lo
-0001e4a0: 636b 3d46 616c 7365 2c20 7265 6769 6f6e  ck=False, region
-0001e4b0: 733d 7265 6769 6f6e 732c 2063 6f6d 7075  s=regions, compu
-0001e4c0: 7465 3d63 6f6d 7075 7465 2c20 7265 7475  te=compute, retu
-0001e4d0: 726e 5f73 746f 7265 643d 7265 7475 726e  rn_stored=return
-0001e4e0: 5f73 746f 7265 640a 2020 2020 2020 2020  _stored.        
-0001e4f0: 290a 0a20 2020 2069 6620 7265 6769 6f6e  )..    if region
-0001e500: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0001e510: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001e520: 6545 7272 6f72 2822 4361 6e6e 6f74 2075  eError("Cannot u
-0001e530: 7365 2060 7265 6769 6f6e 6020 6b65 7977  se `region` keyw
-0001e540: 6f72 6420 7768 656e 2075 726c 2069 7320  ord when url is 
-0001e550: 6e6f 7420 6120 607a 6172 722e 4172 7261  not a `zarr.Arra
-0001e560: 7960 2e22 290a 0a20 2020 2069 6620 6e6f  y`.")..    if no
-0001e570: 7420 5f63 6865 636b 5f72 6567 756c 6172  t _check_regular
-0001e580: 5f63 6875 6e6b 7328 6172 722e 6368 756e  _chunks(arr.chun
-0001e590: 6b73 293a 0a20 2020 2020 2020 2072 6169  ks):.        rai
-0001e5a0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0001e5b0: 2020 2020 2020 2020 2020 2022 4174 7465             "Atte
-0001e5c0: 6d70 7420 746f 2073 6176 6520 6172 7261  mpt to save arra
-0001e5d0: 7920 746f 207a 6172 7220 7769 7468 2069  y to zarr with i
-0001e5e0: 7272 6567 756c 6172 2022 0a20 2020 2020  rregular ".     
-0001e5f0: 2020 2020 2020 2022 6368 756e 6b69 6e67         "chunking
-0001e600: 2c20 706c 6561 7365 2063 616c 6c20 6061  , please call `a
-0001e610: 7272 2e72 6563 6875 6e6b 282e 2e2e 2960  rr.rechunk(...)`
-0001e620: 2066 6972 7374 2e22 0a20 2020 2020 2020   first.".       
-0001e630: 2029 0a0a 2020 2020 7374 6f72 6167 655f   )..    storage_
-0001e640: 6f70 7469 6f6e 7320 3d20 7374 6f72 6167  options = storag
-0001e650: 655f 6f70 7469 6f6e 7320 6f72 207b 7d0a  e_options or {}.
-0001e660: 0a20 2020 2069 6620 7374 6f72 6167 655f  .    if storage_
-0001e670: 6f70 7469 6f6e 733a 0a20 2020 2020 2020  options:.       
-0001e680: 2073 746f 7265 203d 207a 6172 722e 7374   store = zarr.st
-0001e690: 6f72 6167 652e 4653 5374 6f72 6528 7572  orage.FSStore(ur
-0001e6a0: 6c2c 202a 2a73 746f 7261 6765 5f6f 7074  l, **storage_opt
-0001e6b0: 696f 6e73 290a 2020 2020 656c 7365 3a0a  ions).    else:.
-0001e6c0: 2020 2020 2020 2020 7374 6f72 6520 3d20          store = 
-0001e6d0: 7572 6c0a 0a20 2020 2063 6875 6e6b 7320  url..    chunks 
-0001e6e0: 3d20 5b63 5b30 5d20 666f 7220 6320 696e  = [c[0] for c in
-0001e6f0: 2061 7272 2e63 6875 6e6b 735d 0a0a 2020   arr.chunks]..  
-0001e700: 2020 7a20 3d20 7a61 7272 2e63 7265 6174    z = zarr.creat
-0001e710: 6528 0a20 2020 2020 2020 2073 6861 7065  e(.        shape
-0001e720: 3d61 7272 2e73 6861 7065 2c0a 2020 2020  =arr.shape,.    
-0001e730: 2020 2020 6368 756e 6b73 3d63 6875 6e6b      chunks=chunk
-0001e740: 732c 0a20 2020 2020 2020 2064 7479 7065  s,.        dtype
-0001e750: 3d61 7272 2e64 7479 7065 2c0a 2020 2020  =arr.dtype,.    
-0001e760: 2020 2020 7374 6f72 653d 7374 6f72 652c      store=store,
-0001e770: 0a20 2020 2020 2020 2070 6174 683d 636f  .        path=co
-0001e780: 6d70 6f6e 656e 742c 0a20 2020 2020 2020  mponent,.       
-0001e790: 206f 7665 7277 7269 7465 3d6f 7665 7277   overwrite=overw
-0001e7a0: 7269 7465 2c0a 2020 2020 2020 2020 2a2a  rite,.        **
-0001e7b0: 6b77 6172 6773 2c0a 2020 2020 290a 2020  kwargs,.    ).  
-0001e7c0: 2020 7265 7475 726e 2061 7272 2e73 746f    return arr.sto
-0001e7d0: 7265 287a 2c20 6c6f 636b 3d46 616c 7365  re(z, lock=False
-0001e7e0: 2c20 636f 6d70 7574 653d 636f 6d70 7574  , compute=comput
-0001e7f0: 652c 2072 6574 7572 6e5f 7374 6f72 6564  e, return_stored
-0001e800: 3d72 6574 7572 6e5f 7374 6f72 6564 290a  =return_stored).
-0001e810: 0a0a 6465 6620 5f63 6865 636b 5f72 6567  ..def _check_reg
-0001e820: 756c 6172 5f63 6875 6e6b 7328 6368 756e  ular_chunks(chun
-0001e830: 6b73 6574 293a 0a20 2020 2022 2222 4368  kset):.    """Ch
-0001e840: 6563 6b20 6966 2074 6865 2063 6875 6e6b  eck if the chunk
-0001e850: 7320 6172 6520 7265 6775 6c61 720a 0a20  s are regular.. 
-0001e860: 2020 2022 5265 6775 6c61 7222 2069 6e20     "Regular" in 
-0001e870: 7468 6973 2063 6f6e 7465 7874 206d 6561  this context mea
-0001e880: 6e73 2074 6861 7420 616c 6f6e 6720 6576  ns that along ev
-0001e890: 6572 7920 6178 6973 2c20 7468 6520 6368  ery axis, the ch
-0001e8a0: 756e 6b73 2061 6c6c 0a20 2020 2068 6176  unks all.    hav
-0001e8b0: 6520 7468 6520 7361 6d65 2073 697a 652c  e the same size,
-0001e8c0: 2065 7863 6570 7420 7468 6520 6c61 7374   except the last
-0001e8d0: 206f 6e65 2c20 7768 6963 6820 6d61 7920   one, which may 
-0001e8e0: 6265 2073 6d61 6c6c 6572 0a0a 2020 2020  be smaller..    
-0001e8f0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0001e900: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6368  ---------.    ch
-0001e910: 756e 6b73 6574 3a20 7475 706c 6520 6f66  unkset: tuple of
-0001e920: 2074 7570 6c65 7320 6f66 2069 6e74 730a   tuples of ints.
-0001e930: 2020 2020 2020 2020 4672 6f6d 2074 6865          From the
-0001e940: 2060 602e 6368 756e 6b73 6060 2061 7474   ``.chunks`` att
-0001e950: 7269 6275 7465 206f 6620 616e 2060 6041  ribute of an ``A
-0001e960: 7272 6179 6060 0a0a 2020 2020 5265 7475  rray``..    Retu
-0001e970: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-0001e980: 2020 2020 5472 7565 2069 6620 6368 756e      True if chun
-0001e990: 6b73 6574 2070 6173 7365 732c 2065 6c73  kset passes, els
-0001e9a0: 6520 4661 6c73 650a 0a20 2020 2045 7861  e False..    Exa
-0001e9b0: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
-0001e9c0: 2d2d 0a20 2020 203e 3e3e 2069 6d70 6f72  --.    >>> impor
-0001e9d0: 7420 6461 736b 2e61 7272 6179 2061 7320  t dask.array as 
-0001e9e0: 6461 0a20 2020 203e 3e3e 2061 7272 203d  da.    >>> arr =
-0001e9f0: 2064 612e 7a65 726f 7328 3130 2c20 6368   da.zeros(10, ch
-0001ea00: 756e 6b73 3d28 352c 2029 290a 2020 2020  unks=(5, )).    
-0001ea10: 3e3e 3e20 5f63 6865 636b 5f72 6567 756c  >>> _check_regul
-0001ea20: 6172 5f63 6875 6e6b 7328 6172 722e 6368  ar_chunks(arr.ch
-0001ea30: 756e 6b73 290a 2020 2020 5472 7565 0a0a  unks).    True..
-0001ea40: 2020 2020 3e3e 3e20 6172 7220 3d20 6461      >>> arr = da
-0001ea50: 2e7a 6572 6f73 2831 302c 2063 6875 6e6b  .zeros(10, chunk
-0001ea60: 733d 2828 332c 2033 2c20 332c 2031 292c  s=((3, 3, 3, 1),
-0001ea70: 2029 290a 2020 2020 3e3e 3e20 5f63 6865   )).    >>> _che
-0001ea80: 636b 5f72 6567 756c 6172 5f63 6875 6e6b  ck_regular_chunk
-0001ea90: 7328 6172 722e 6368 756e 6b73 290a 2020  s(arr.chunks).  
-0001eaa0: 2020 5472 7565 0a0a 2020 2020 3e3e 3e20    True..    >>> 
-0001eab0: 6172 7220 3d20 6461 2e7a 6572 6f73 2831  arr = da.zeros(1
-0001eac0: 302c 2063 6875 6e6b 733d 2828 332c 2031  0, chunks=((3, 1
-0001ead0: 2c20 332c 2033 292c 2029 290a 2020 2020  , 3, 3), )).    
-0001eae0: 3e3e 3e20 5f63 6865 636b 5f72 6567 756c  >>> _check_regul
-0001eaf0: 6172 5f63 6875 6e6b 7328 6172 722e 6368  ar_chunks(arr.ch
-0001eb00: 756e 6b73 290a 2020 2020 4661 6c73 650a  unks).    False.
-0001eb10: 2020 2020 2222 220a 2020 2020 666f 7220      """.    for 
-0001eb20: 6368 756e 6b73 2069 6e20 6368 756e 6b73  chunks in chunks
-0001eb30: 6574 3a0a 2020 2020 2020 2020 6966 206c  et:.        if l
-0001eb40: 656e 2863 6875 6e6b 7329 203d 3d20 313a  en(chunks) == 1:
-0001eb50: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-0001eb60: 7469 6e75 650a 2020 2020 2020 2020 6966  tinue.        if
-0001eb70: 206c 656e 2873 6574 2863 6875 6e6b 735b   len(set(chunks[
-0001eb80: 3a2d 315d 2929 203e 2031 3a0a 2020 2020  :-1])) > 1:.    
-0001eb90: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-0001eba0: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
-0001ebb0: 6368 756e 6b73 5b2d 315d 203e 2063 6875  chunks[-1] > chu
-0001ebc0: 6e6b 735b 305d 3a0a 2020 2020 2020 2020  nks[0]:.        
-0001ebd0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-0001ebe0: 0a20 2020 2072 6574 7572 6e20 5472 7565  .    return True
-0001ebf0: 0a0a 0a64 6566 2066 726f 6d5f 6465 6c61  ...def from_dela
-0001ec00: 7965 6428 7661 6c75 652c 2073 6861 7065  yed(value, shape
-0001ec10: 2c20 6474 7970 653d 4e6f 6e65 2c20 6d65  , dtype=None, me
-0001ec20: 7461 3d4e 6f6e 652c 206e 616d 653d 4e6f  ta=None, name=No
-0001ec30: 6e65 293a 0a20 2020 2022 2222 4372 6561  ne):.    """Crea
-0001ec40: 7465 2061 2064 6173 6b20 6172 7261 7920  te a dask array 
-0001ec50: 6672 6f6d 2061 2064 6173 6b20 6465 6c61  from a dask dela
-0001ec60: 7965 6420 7661 6c75 650a 0a20 2020 2054  yed value..    T
-0001ec70: 6869 7320 726f 7574 696e 6520 6973 2075  his routine is u
-0001ec80: 7365 6675 6c20 666f 7220 636f 6e73 7472  seful for constr
-0001ec90: 7563 7469 6e67 2064 6173 6b20 6172 7261  ucting dask arra
-0001eca0: 7973 2069 6e20 616e 2061 642d 686f 6320  ys in an ad-hoc 
-0001ecb0: 6661 7368 696f 6e0a 2020 2020 7573 696e  fashion.    usin
-0001ecc0: 6720 6461 736b 2064 656c 6179 6564 2c20  g dask delayed, 
-0001ecd0: 7061 7274 6963 756c 6172 6c79 2077 6865  particularly whe
-0001ece0: 6e20 636f 6d62 696e 6564 2077 6974 6820  n combined with 
-0001ecf0: 7374 6163 6b20 616e 6420 636f 6e63 6174  stack and concat
-0001ed00: 656e 6174 652e 0a0a 2020 2020 5468 6520  enate...    The 
-0001ed10: 6461 736b 2061 7272 6179 2077 696c 6c20  dask array will 
-0001ed20: 636f 6e73 6973 7420 6f66 2061 2073 696e  consist of a sin
-0001ed30: 676c 6520 6368 756e 6b2e 0a0a 2020 2020  gle chunk...    
-0001ed40: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
-0001ed50: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 696d  -----.    >>> im
-0001ed60: 706f 7274 2064 6173 6b0a 2020 2020 3e3e  port dask.    >>
-0001ed70: 3e20 696d 706f 7274 2064 6173 6b2e 6172  > import dask.ar
-0001ed80: 7261 7920 6173 2064 610a 2020 2020 3e3e  ray as da.    >>
-0001ed90: 3e20 696d 706f 7274 206e 756d 7079 2061  > import numpy a
-0001eda0: 7320 6e70 0a20 2020 203e 3e3e 2076 616c  s np.    >>> val
-0001edb0: 7565 203d 2064 6173 6b2e 6465 6c61 7965  ue = dask.delaye
-0001edc0: 6428 6e70 2e6f 6e65 7329 2835 290a 2020  d(np.ones)(5).  
-0001edd0: 2020 3e3e 3e20 6172 7261 7920 3d20 6461    >>> array = da
-0001ede0: 2e66 726f 6d5f 6465 6c61 7965 6428 7661  .from_delayed(va
-0001edf0: 6c75 652c 2028 352c 292c 2064 7479 7065  lue, (5,), dtype
-0001ee00: 3d66 6c6f 6174 290a 2020 2020 3e3e 3e20  =float).    >>> 
-0001ee10: 6172 7261 790a 2020 2020 6461 736b 2e61  array.    dask.a
-0001ee20: 7272 6179 3c66 726f 6d2d 7661 6c75 652c  rray<from-value,
-0001ee30: 2073 6861 7065 3d28 352c 292c 2064 7479   shape=(5,), dty
-0001ee40: 7065 3d66 6c6f 6174 3634 2c20 6368 756e  pe=float64, chun
-0001ee50: 6b73 697a 653d 2835 2c29 2c20 6368 756e  ksize=(5,), chun
-0001ee60: 6b74 7970 653d 6e75 6d70 792e 6e64 6172  ktype=numpy.ndar
-0001ee70: 7261 793e 0a20 2020 203e 3e3e 2061 7272  ray>.    >>> arr
-0001ee80: 6179 2e63 6f6d 7075 7465 2829 0a20 2020  ay.compute().   
-0001ee90: 2061 7272 6179 285b 312e 2c20 312e 2c20   array([1., 1., 
-0001eea0: 312e 2c20 312e 2c20 312e 5d29 0a20 2020  1., 1., 1.]).   
-0001eeb0: 2022 2222 0a20 2020 2066 726f 6d20 6461   """.    from da
-0001eec0: 736b 2e64 656c 6179 6564 2069 6d70 6f72  sk.delayed impor
-0001eed0: 7420 4465 6c61 7965 642c 2064 656c 6179  t Delayed, delay
-0001eee0: 6564 0a0a 2020 2020 6966 206e 6f74 2069  ed..    if not i
-0001eef0: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
-0001ef00: 2044 656c 6179 6564 2920 616e 6420 6861   Delayed) and ha
-0001ef10: 7361 7474 7228 7661 6c75 652c 2022 6b65  sattr(value, "ke
-0001ef20: 7922 293a 0a20 2020 2020 2020 2076 616c  y"):.        val
-0001ef30: 7565 203d 2064 656c 6179 6564 2876 616c  ue = delayed(val
-0001ef40: 7565 290a 0a20 2020 206e 616d 6520 3d20  ue)..    name = 
-0001ef50: 6e61 6d65 206f 7220 2266 726f 6d2d 7661  name or "from-va
-0001ef60: 6c75 652d 2220 2b20 746f 6b65 6e69 7a65  lue-" + tokenize
-0001ef70: 2876 616c 7565 2c20 7368 6170 652c 2064  (value, shape, d
-0001ef80: 7479 7065 2c20 6d65 7461 290a 2020 2020  type, meta).    
-0001ef90: 6473 6b20 3d20 7b28 6e61 6d65 2c29 202b  dsk = {(name,) +
-0001efa0: 2028 302c 2920 2a20 6c65 6e28 7368 6170   (0,) * len(shap
-0001efb0: 6529 3a20 7661 6c75 652e 6b65 797d 0a20  e): value.key}. 
-0001efc0: 2020 2063 6875 6e6b 7320 3d20 7475 706c     chunks = tupl
-0001efd0: 6528 2864 2c29 2066 6f72 2064 2069 6e20  e((d,) for d in 
-0001efe0: 7368 6170 6529 0a20 2020 2023 2054 4f44  shape).    # TOD
-0001eff0: 4f3a 2076 616c 7565 2e5f 6b65 7920 6d61  O: value._key ma
-0001f000: 7920 6e6f 7420 6265 2074 6865 206e 616d  y not be the nam
-0001f010: 6520 6f66 2074 6865 206c 6179 6572 2069  e of the layer i
-0001f020: 6e20 7661 6c75 652e 6461 736b 0a20 2020  n value.dask.   
-0001f030: 2023 2054 6869 7320 7368 6f75 6c64 2062   # This should b
-0001f040: 6520 6669 7865 6420 6166 7465 7220 7765  e fixed after we
-0001f050: 2062 7569 6c64 2066 756c 6c20 6578 7072   build full expr
-0001f060: 6573 7369 6f6e 2067 7261 7068 730a 2020  ession graphs.  
-0001f070: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-0001f080: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-0001f090: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-0001f0a0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-0001f0b0: 733d 5b76 616c 7565 5d29 0a20 2020 2072  s=[value]).    r
-0001f0c0: 6574 7572 6e20 4172 7261 7928 6772 6170  eturn Array(grap
-0001f0d0: 682c 206e 616d 652c 2063 6875 6e6b 732c  h, name, chunks,
-0001f0e0: 2064 7479 7065 3d64 7479 7065 2c20 6d65   dtype=dtype, me
-0001f0f0: 7461 3d6d 6574 6129 0a0a 0a64 6566 2066  ta=meta)...def f
-0001f100: 726f 6d5f 6675 6e63 2866 756e 632c 2073  rom_func(func, s
-0001f110: 6861 7065 2c20 6474 7970 653d 4e6f 6e65  hape, dtype=None
-0001f120: 2c20 6e61 6d65 3d4e 6f6e 652c 2061 7267  , name=None, arg
-0001f130: 733d 2829 2c20 6b77 6172 6773 3d4e 6f6e  s=(), kwargs=Non
-0001f140: 6529 3a0a 2020 2020 2222 2243 7265 6174  e):.    """Creat
-0001f150: 6520 6461 736b 2061 7272 6179 2069 6e20  e dask array in 
-0001f160: 6120 7369 6e67 6c65 2062 6c6f 636b 2062  a single block b
-0001f170: 7920 6361 6c6c 696e 6720 6120 6675 6e63  y calling a func
-0001f180: 7469 6f6e 0a0a 2020 2020 4361 6c6c 696e  tion..    Callin
-0001f190: 6720 7468 6520 7072 6f76 6964 6564 2066  g the provided f
-0001f1a0: 756e 6374 696f 6e20 7769 7468 2066 756e  unction with fun
-0001f1b0: 6328 2a61 7267 732c 202a 2a6b 7761 7267  c(*args, **kwarg
-0001f1c0: 7329 2073 686f 756c 6420 7265 7475 726e  s) should return
-0001f1d0: 2061 0a20 2020 204e 756d 5079 2061 7272   a.    NumPy arr
-0001f1e0: 6179 206f 6620 7468 6520 696e 6469 6361  ay of the indica
-0001f1f0: 7465 6420 7368 6170 6520 616e 6420 6474  ted shape and dt
-0001f200: 7970 652e 0a0a 2020 2020 4578 616d 706c  ype...    Exampl
-0001f210: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-0001f220: 0a20 2020 203e 3e3e 2061 203d 2066 726f  .    >>> a = fro
-0001f230: 6d5f 6675 6e63 286e 702e 6172 616e 6765  m_func(np.arange
-0001f240: 2c20 2833 2c29 2c20 6474 7970 653d 2769  , (3,), dtype='i
-0001f250: 3827 2c20 6172 6773 3d28 332c 2929 0a20  8', args=(3,)). 
-0001f260: 2020 203e 3e3e 2061 2e63 6f6d 7075 7465     >>> a.compute
-0001f270: 2829 0a20 2020 2061 7272 6179 285b 302c  ().    array([0,
-0001f280: 2031 2c20 325d 290a 0a20 2020 2054 6869   1, 2])..    Thi
-0001f290: 7320 776f 726b 7320 7061 7274 6963 756c  s works particul
-0001f2a0: 6172 6c79 2077 656c 6c20 7768 656e 2063  arly well when c
-0001f2b0: 6f75 706c 6564 2077 6974 6820 6461 736b  oupled with dask
-0001f2c0: 2e61 7272 6179 2066 756e 6374 696f 6e73  .array functions
-0001f2d0: 206c 696b 650a 2020 2020 636f 6e63 6174   like.    concat
-0001f2e0: 656e 6174 6520 616e 6420 7374 6163 6b3a  enate and stack:
-0001f2f0: 0a0a 2020 2020 3e3e 3e20 6172 7261 7973  ..    >>> arrays
-0001f300: 203d 205b 6672 6f6d 5f66 756e 6328 6e70   = [from_func(np
-0001f310: 2e61 7272 6179 2c20 2829 2c20 6474 7970  .array, (), dtyp
-0001f320: 653d 2769 3827 2c20 6172 6773 3d28 6e2c  e='i8', args=(n,
-0001f330: 2929 2066 6f72 206e 2069 6e20 7261 6e67  )) for n in rang
-0001f340: 6528 3529 5d0a 2020 2020 3e3e 3e20 7374  e(5)].    >>> st
-0001f350: 6163 6b28 6172 7261 7973 292e 636f 6d70  ack(arrays).comp
-0001f360: 7574 6528 290a 2020 2020 6172 7261 7928  ute().    array(
-0001f370: 5b30 2c20 312c 2032 2c20 332c 2034 5d29  [0, 1, 2, 3, 4])
-0001f380: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-0001f390: 6b77 6172 6773 2069 7320 4e6f 6e65 3a0a  kwargs is None:.
-0001f3a0: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
-0001f3b0: 207b 7d0a 0a20 2020 206e 616d 6520 3d20   {}..    name = 
-0001f3c0: 6e61 6d65 206f 7220 2266 726f 6d5f 6675  name or "from_fu
-0001f3d0: 6e63 2d22 202b 2074 6f6b 656e 697a 6528  nc-" + tokenize(
-0001f3e0: 6675 6e63 2c20 7368 6170 652c 2064 7479  func, shape, dty
-0001f3f0: 7065 2c20 6172 6773 2c20 6b77 6172 6773  pe, args, kwargs
-0001f400: 290a 2020 2020 6966 2061 7267 7320 6f72  ).    if args or
-0001f410: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
-0001f420: 2066 756e 6320 3d20 7061 7274 6961 6c28   func = partial(
-0001f430: 6675 6e63 2c20 2a61 7267 732c 202a 2a6b  func, *args, **k
-0001f440: 7761 7267 7329 0a20 2020 2064 736b 203d  wargs).    dsk =
-0001f450: 207b 286e 616d 652c 2920 2b20 2830 2c29   {(name,) + (0,)
-0001f460: 202a 206c 656e 2873 6861 7065 293a 2028   * len(shape): (
-0001f470: 6675 6e63 2c29 7d0a 2020 2020 6368 756e  func,)}.    chun
-0001f480: 6b73 203d 2074 7570 6c65 2828 692c 2920  ks = tuple((i,) 
-0001f490: 666f 7220 6920 696e 2073 6861 7065 290a  for i in shape).
-0001f4a0: 2020 2020 7265 7475 726e 2041 7272 6179      return Array
-0001f4b0: 2864 736b 2c20 6e61 6d65 2c20 6368 756e  (dsk, name, chun
-0001f4c0: 6b73 2c20 6474 7970 6529 0a0a 0a64 6566  ks, dtype)...def
-0001f4d0: 2063 6f6d 6d6f 6e5f 626c 6f63 6b64 696d   common_blockdim
-0001f4e0: 2862 6c6f 636b 6469 6d73 293a 0a20 2020  (blockdims):.   
-0001f4f0: 2022 2222 4669 6e64 2074 6865 2063 6f6d   """Find the com
-0001f500: 6d6f 6e20 626c 6f63 6b20 6469 6d65 6e73  mon block dimens
-0001f510: 696f 6e73 2066 726f 6d20 7468 6520 6c69  ions from the li
-0001f520: 7374 206f 6620 626c 6f63 6b20 6469 6d65  st of block dime
-0001f530: 6e73 696f 6e73 0a0a 2020 2020 4375 7272  nsions..    Curr
-0001f540: 656e 746c 7920 6f6e 6c79 2069 6d70 6c65  ently only imple
-0001f550: 6d65 6e74 7320 7468 6520 7369 6d70 6c65  ments the simple
-0001f560: 7374 2070 6f73 7369 626c 6520 6865 7572  st possible heur
-0001f570: 6973 7469 633a 2074 6865 2063 6f6d 6d6f  istic: the commo
-0001f580: 6e0a 2020 2020 626c 6f63 6b2d 6469 6d65  n.    block-dime
-0001f590: 6e73 696f 6e20 6973 2074 6865 206f 6e6c  nsion is the onl
-0001f5a0: 7920 6f6e 6520 7468 6174 2064 6f65 7320  y one that does 
-0001f5b0: 6e6f 7420 7370 616e 2066 756c 6c79 2073  not span fully s
-0001f5c0: 7061 6e20 6120 6469 6d65 6e73 696f 6e2e  pan a dimension.
-0001f5d0: 0a20 2020 2054 6869 7320 6973 2061 2063  .    This is a c
-0001f5e0: 6f6e 7365 7276 6174 6976 6520 6368 6f69  onservative choi
-0001f5f0: 6365 2074 6861 7420 616c 6c6f 7773 2075  ce that allows u
-0001f600: 7320 746f 2061 766f 6964 2070 6f74 656e  s to avoid poten
-0001f610: 7469 616c 6c79 2076 6572 790a 2020 2020  tially very.    
-0001f620: 6578 7065 6e73 6976 6520 7265 6368 756e  expensive rechun
-0001f630: 6b69 6e67 2e0a 0a20 2020 2041 7373 756d  king...    Assum
-0001f640: 6573 2074 6861 7420 6561 6368 2065 6c65  es that each ele
-0001f650: 6d65 6e74 206f 6620 7468 6520 696e 7075  ment of the inpu
-0001f660: 7420 626c 6f63 6b20 6469 6d65 6e73 696f  t block dimensio
-0001f670: 6e73 2068 6173 2061 6c6c 2074 6865 2073  ns has all the s
-0001f680: 616d 650a 2020 2020 7375 6d20 2869 2e65  ame.    sum (i.e
-0001f690: 2e2c 2074 6861 7420 7468 6579 2063 6f72  ., that they cor
-0001f6a0: 7265 7370 6f6e 6420 746f 2064 696d 656e  respond to dimen
-0001f6b0: 7369 6f6e 7320 6f66 2074 6865 2073 616d  sions of the sam
-0001f6c0: 6520 7369 7a65 292e 0a0a 2020 2020 4578  e size)...    Ex
-0001f6d0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
-0001f6e0: 2d2d 2d0a 2020 2020 3e3e 3e20 636f 6d6d  ---.    >>> comm
-0001f6f0: 6f6e 5f62 6c6f 636b 6469 6d28 5b28 332c  on_blockdim([(3,
-0001f700: 292c 2028 322c 2031 295d 290a 2020 2020  ), (2, 1)]).    
-0001f710: 2832 2c20 3129 0a20 2020 203e 3e3e 2063  (2, 1).    >>> c
-0001f720: 6f6d 6d6f 6e5f 626c 6f63 6b64 696d 285b  ommon_blockdim([
-0001f730: 2831 2c20 3229 2c20 2832 2c20 3129 5d29  (1, 2), (2, 1)])
-0001f740: 0a20 2020 2028 312c 2031 2c20 3129 0a20  .    (1, 1, 1). 
-0001f750: 2020 203e 3e3e 2063 6f6d 6d6f 6e5f 626c     >>> common_bl
-0001f760: 6f63 6b64 696d 285b 2832 2c20 3229 2c20  ockdim([(2, 2), 
-0001f770: 2833 2c20 3129 5d29 2020 2320 646f 6374  (3, 1)])  # doct
-0001f780: 6573 743a 202b 534b 4950 0a20 2020 2054  est: +SKIP.    T
-0001f790: 7261 6365 6261 636b 2028 6d6f 7374 2072  raceback (most r
-0001f7a0: 6563 656e 7420 6361 6c6c 206c 6173 7429  ecent call last)
-0001f7b0: 3a0a 2020 2020 2020 2020 2e2e 2e0a 2020  :.        ....  
-0001f7c0: 2020 5661 6c75 6545 7272 6f72 3a20 4368    ValueError: Ch
-0001f7d0: 756e 6b73 2064 6f20 6e6f 7420 616c 6967  unks do not alig
-0001f7e0: 6e0a 2020 2020 2222 220a 2020 2020 6966  n.    """.    if
-0001f7f0: 206e 6f74 2061 6e79 2862 6c6f 636b 6469   not any(blockdi
-0001f800: 6d73 293a 0a20 2020 2020 2020 2072 6574  ms):.        ret
-0001f810: 7572 6e20 2829 0a20 2020 206e 6f6e 5f74  urn ().    non_t
-0001f820: 7269 7669 616c 5f64 696d 7320 3d20 7b64  rivial_dims = {d
-0001f830: 2066 6f72 2064 2069 6e20 626c 6f63 6b64   for d in blockd
-0001f840: 696d 7320 6966 206c 656e 2864 2920 3e20  ims if len(d) > 
-0001f850: 317d 0a20 2020 2069 6620 6c65 6e28 6e6f  1}.    if len(no
-0001f860: 6e5f 7472 6976 6961 6c5f 6469 6d73 2920  n_trivial_dims) 
-0001f870: 3d3d 2031 3a0a 2020 2020 2020 2020 7265  == 1:.        re
-0001f880: 7475 726e 2066 6972 7374 286e 6f6e 5f74  turn first(non_t
-0001f890: 7269 7669 616c 5f64 696d 7329 0a20 2020  rivial_dims).   
-0001f8a0: 2069 6620 6c65 6e28 6e6f 6e5f 7472 6976   if len(non_triv
-0001f8b0: 6961 6c5f 6469 6d73 2920 3d3d 2030 3a0a  ial_dims) == 0:.
-0001f8c0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0001f8d0: 6178 2862 6c6f 636b 6469 6d73 2c20 6b65  ax(blockdims, ke
-0001f8e0: 793d 6669 7273 7429 0a0a 2020 2020 6966  y=first)..    if
-0001f8f0: 206e 702e 6973 6e61 6e28 7375 6d28 6d61   np.isnan(sum(ma
-0001f900: 7028 7375 6d2c 2062 6c6f 636b 6469 6d73  p(sum, blockdims
-0001f910: 2929 293a 0a20 2020 2020 2020 2072 6169  ))):.        rai
-0001f920: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0001f930: 2020 2020 2020 2020 2020 2022 4172 7261             "Arra
-0001f940: 7973 2720 6368 756e 6b20 7369 7a65 7320  ys' chunk sizes 
-0001f950: 2825 7329 2061 7265 2075 6e6b 6e6f 776e  (%s) are unknown
-0001f960: 2e5c 6e5c 6e22 0a20 2020 2020 2020 2020  .\n\n".         
-0001f970: 2020 2022 4120 706f 7373 6962 6c65 2073     "A possible s
-0001f980: 6f6c 7574 696f 6e3a 5c6e 220a 2020 2020  olution:\n".    
-0001f990: 2020 2020 2020 2020 2220 2078 2e63 6f6d          "  x.com
-0001f9a0: 7075 7465 5f63 6875 6e6b 5f73 697a 6573  pute_chunk_sizes
-0001f9b0: 2829 2220 2520 626c 6f63 6b64 696d 730a  ()" % blockdims.
-0001f9c0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
-0001f9d0: 6620 6c65 6e28 7365 7428 6d61 7028 7375  f len(set(map(su
-0001f9e0: 6d2c 206e 6f6e 5f74 7269 7669 616c 5f64  m, non_trivial_d
-0001f9f0: 696d 7329 2929 203e 2031 3a0a 2020 2020  ims))) > 1:.    
-0001fa00: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001fa10: 7272 6f72 2822 4368 756e 6b73 2064 6f20  rror("Chunks do 
-0001fa20: 6e6f 7420 6164 6420 7570 2074 6f20 7361  not add up to sa
-0001fa30: 6d65 2076 616c 7565 222c 2062 6c6f 636b  me value", block
-0001fa40: 6469 6d73 290a 0a20 2020 2023 2057 6520  dims)..    # We 
-0001fa50: 6861 7665 206d 756c 7469 706c 6520 6e6f  have multiple no
-0001fa60: 6e2d 7472 6976 6961 6c20 6368 756e 6b73  n-trivial chunks
-0001fa70: 206f 6e20 7468 6973 2061 7869 730a 2020   on this axis.  
-0001fa80: 2020 2320 652e 672e 2028 352c 2032 2920    # e.g. (5, 2) 
-0001fa90: 616e 6420 2834 2c20 3329 0a0a 2020 2020  and (4, 3)..    
-0001faa0: 2320 5765 2063 7265 6174 6520 6120 7369  # We create a si
-0001fab0: 6e67 6c65 2063 6875 6e6b 2074 7570 6c65  ngle chunk tuple
-0001fac0: 2077 6974 6820 7468 6520 7361 6d65 2074   with the same t
-0001fad0: 6f74 616c 206c 656e 6774 680a 2020 2020  otal length.    
-0001fae0: 2320 7468 6174 2065 7665 6e6c 7920 6469  # that evenly di
-0001faf0: 7669 6465 7320 626f 7468 2c20 652e 672e  vides both, e.g.
-0001fb00: 2028 342c 2031 2c20 3229 0a0a 2020 2020   (4, 1, 2)..    
-0001fb10: 2320 546f 2061 6363 6f6d 706c 6973 6820  # To accomplish 
-0001fb20: 7468 6973 2077 6520 7761 6c6b 2064 6f77  this we walk dow
-0001fb30: 6e20 616c 6c20 6368 756e 6b20 7475 706c  n all chunk tupl
-0001fb40: 6573 2074 6f67 6574 6865 722c 2066 696e  es together, fin
-0001fb50: 6469 6e67 2074 6865 0a20 2020 2023 2073  ding the.    # s
-0001fb60: 6d61 6c6c 6573 7420 656c 656d 656e 742c  mallest element,
-0001fb70: 2061 6464 696e 6720 6974 2074 6f20 7468   adding it to th
-0001fb80: 6520 6f75 7470 7574 2c20 616e 6420 7375  e output, and su
-0001fb90: 6274 7261 6374 696e 6720 6974 2066 726f  btracting it fro
-0001fba0: 6d20 616c 6c0a 2020 2020 2320 6f74 6865  m all.    # othe
-0001fbb0: 7220 656c 656d 656e 7473 2061 6e64 2072  r elements and r
-0001fbc0: 656d 6f76 6520 7468 6520 656c 656d 656e  emove the elemen
-0001fbd0: 7420 6974 7365 6c66 2e20 2057 6520 7374  t itself.  We st
-0001fbe0: 6f70 206f 6e63 6520 7765 2068 6176 650a  op once we have.
-0001fbf0: 2020 2020 2320 6275 726e 6564 2074 6872      # burned thr
-0001fc00: 6f75 6768 2061 6c6c 206f 6620 7468 6520  ough all of the 
-0001fc10: 6368 756e 6b20 7475 706c 6573 2e0a 2020  chunk tuples..  
-0001fc20: 2020 2320 466f 7220 6566 6669 6369 656e    # For efficien
-0001fc30: 6379 2773 2073 616b 6520 7765 2072 6576  cy's sake we rev
-0001fc40: 6572 7365 2074 6865 206c 6973 7473 2073  erse the lists s
-0001fc50: 6f20 7468 6174 2077 6520 6361 6e20 706f  o that we can po
-0001fc60: 7020 6f66 6620 7468 6520 656e 640a 2020  p off the end.  
-0001fc70: 2020 7263 6875 6e6b 7320 3d20 5b6c 6973    rchunks = [lis
-0001fc80: 7428 6e74 6429 5b3a 3a2d 315d 2066 6f72  t(ntd)[::-1] for
-0001fc90: 206e 7464 2069 6e20 6e6f 6e5f 7472 6976   ntd in non_triv
-0001fca0: 6961 6c5f 6469 6d73 5d0a 2020 2020 746f  ial_dims].    to
-0001fcb0: 7461 6c20 3d20 7375 6d28 6669 7273 7428  tal = sum(first(
-0001fcc0: 6e6f 6e5f 7472 6976 6961 6c5f 6469 6d73  non_trivial_dims
-0001fcd0: 2929 0a20 2020 2069 203d 2030 0a0a 2020  )).    i = 0..  
-0001fce0: 2020 6f75 7420 3d20 5b5d 0a20 2020 2077    out = [].    w
-0001fcf0: 6869 6c65 2069 203c 2074 6f74 616c 3a0a  hile i < total:.
-0001fd00: 2020 2020 2020 2020 6d20 3d20 6d69 6e28          m = min(
-0001fd10: 635b 2d31 5d20 666f 7220 6320 696e 2072  c[-1] for c in r
-0001fd20: 6368 756e 6b73 290a 2020 2020 2020 2020  chunks).        
-0001fd30: 6f75 742e 6170 7065 6e64 286d 290a 2020  out.append(m).  
-0001fd40: 2020 2020 2020 666f 7220 6320 696e 2072        for c in r
-0001fd50: 6368 756e 6b73 3a0a 2020 2020 2020 2020  chunks:.        
-0001fd60: 2020 2020 635b 2d31 5d20 2d3d 206d 0a20      c[-1] -= m. 
-0001fd70: 2020 2020 2020 2020 2020 2069 6620 635b             if c[
-0001fd80: 2d31 5d20 3d3d 2030 3a0a 2020 2020 2020  -1] == 0:.      
-0001fd90: 2020 2020 2020 2020 2020 632e 706f 7028            c.pop(
-0001fda0: 290a 2020 2020 2020 2020 6920 2b3d 206d  ).        i += m
-0001fdb0: 0a0a 2020 2020 7265 7475 726e 2074 7570  ..    return tup
-0001fdc0: 6c65 286f 7574 290a 0a0a 6465 6620 756e  le(out)...def un
-0001fdd0: 6966 795f 6368 756e 6b73 282a 6172 6773  ify_chunks(*args
-0001fde0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0001fdf0: 2022 2222 0a20 2020 2055 6e69 6679 2063   """.    Unify c
-0001fe00: 6875 6e6b 7320 6163 726f 7373 2061 2073  hunks across a s
-0001fe10: 6571 7565 6e63 6520 6f66 2061 7272 6179  equence of array
-0001fe20: 730a 0a20 2020 2054 6869 7320 7574 696c  s..    This util
-0001fe30: 6974 7920 6675 6e63 7469 6f6e 2069 7320  ity function is 
-0001fe40: 7573 6564 2077 6974 6869 6e20 6f74 6865  used within othe
-0001fe50: 7220 636f 6d6d 6f6e 206f 7065 7261 7469  r common operati
-0001fe60: 6f6e 7320 6c69 6b65 0a20 2020 203a 6675  ons like.    :fu
-0001fe70: 6e63 3a60 6461 736b 2e61 7272 6179 2e63  nc:`dask.array.c
-0001fe80: 6f72 652e 6d61 705f 626c 6f63 6b73 6020  ore.map_blocks` 
-0001fe90: 616e 6420 3a66 756e 633a 6064 6173 6b2e  and :func:`dask.
-0001fea0: 6172 7261 792e 636f 7265 2e62 6c6f 636b  array.core.block
-0001feb0: 7769 7365 602e 0a20 2020 2049 7420 6973  wise`..    It is
-0001fec0: 206e 6f74 2063 6f6d 6d6f 6e6c 7920 7573   not commonly us
-0001fed0: 6564 2062 7920 656e 642d 7573 6572 7320  ed by end-users 
-0001fee0: 6469 7265 6374 6c79 2e0a 0a20 2020 2050  directly...    P
-0001fef0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-0001ff00: 2d2d 2d2d 2d2d 2d2d 0a20 2020 202a 6172  --------.    *ar
-0001ff10: 6773 3a20 7365 7175 656e 6365 206f 6620  gs: sequence of 
-0001ff20: 4172 7261 792c 2069 6e64 6578 2070 6169  Array, index pai
-0001ff30: 7273 0a20 2020 2020 2020 2053 6571 7565  rs.        Seque
-0001ff40: 6e63 6520 6c69 6b65 2028 782c 2027 696a  nce like (x, 'ij
-0001ff50: 272c 2079 2c20 276a 6b27 2c20 7a2c 2027  ', y, 'jk', z, '
-0001ff60: 6927 290a 0a20 2020 2045 7861 6d70 6c65  i')..    Example
-0001ff70: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
-0001ff80: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0001ff90: 736b 2e61 7272 6179 2061 7320 6461 0a20  sk.array as da. 
-0001ffa0: 2020 203e 3e3e 2078 203d 2064 612e 6f6e     >>> x = da.on
-0001ffb0: 6573 2831 302c 2063 6875 6e6b 733d 2828  es(10, chunks=((
-0001ffc0: 352c 2032 2c20 3329 2c29 290a 2020 2020  5, 2, 3),)).    
-0001ffd0: 3e3e 3e20 7920 3d20 6461 2e6f 6e65 7328  >>> y = da.ones(
-0001ffe0: 3130 2c20 6368 756e 6b73 3d28 2832 2c20  10, chunks=((2, 
-0001fff0: 332c 2035 292c 2929 0a20 2020 203e 3e3e  3, 5),)).    >>>
-00020000: 2063 6875 6e6b 7373 2c20 6172 7261 7973   chunkss, arrays
-00020010: 203d 2075 6e69 6679 5f63 6875 6e6b 7328   = unify_chunks(
-00020020: 782c 2027 6927 2c20 792c 2027 6927 290a  x, 'i', y, 'i').
-00020030: 2020 2020 3e3e 3e20 6368 756e 6b73 730a      >>> chunkss.
-00020040: 2020 2020 7b27 6927 3a20 2832 2c20 332c      {'i': (2, 3,
-00020050: 2032 2c20 3329 7d0a 0a20 2020 203e 3e3e   2, 3)}..    >>>
-00020060: 2078 203d 2064 612e 6f6e 6573 2828 3130   x = da.ones((10
-00020070: 302c 2031 3029 2c20 6368 756e 6b73 3d28  0, 10), chunks=(
-00020080: 3230 2c20 3529 290a 2020 2020 3e3e 3e20  20, 5)).    >>> 
-00020090: 7920 3d20 6461 2e6f 6e65 7328 2831 302c  y = da.ones((10,
-000200a0: 2031 3030 292c 2063 6875 6e6b 733d 2834   100), chunks=(4
-000200b0: 2c20 3530 2929 0a20 2020 203e 3e3e 2063  , 50)).    >>> c
-000200c0: 6875 6e6b 7373 2c20 6172 7261 7973 203d  hunkss, arrays =
-000200d0: 2075 6e69 6679 5f63 6875 6e6b 7328 782c   unify_chunks(x,
-000200e0: 2027 696a 272c 2079 2c20 276a 6b27 2c20   'ij', y, 'jk', 
-000200f0: 2763 6f6e 7374 616e 7427 2c20 4e6f 6e65  'constant', None
-00020100: 290a 2020 2020 3e3e 3e20 6368 756e 6b73  ).    >>> chunks
-00020110: 7320 2023 2064 6f63 7465 7374 3a20 2b53  s  # doctest: +S
-00020120: 4b49 500a 2020 2020 7b27 6b27 3a20 2835  KIP.    {'k': (5
-00020130: 302c 2035 3029 2c20 2769 273a 2028 3230  0, 50), 'i': (20
-00020140: 2c20 3230 2c20 3230 2c20 3230 2c20 3230  , 20, 20, 20, 20
-00020150: 292c 2027 6a27 3a20 2834 2c20 312c 2033  ), 'j': (4, 1, 3
-00020160: 2c20 3229 7d0a 0a20 2020 203e 3e3e 2075  , 2)}..    >>> u
-00020170: 6e69 6679 5f63 6875 6e6b 7328 302c 204e  nify_chunks(0, N
-00020180: 6f6e 6529 0a20 2020 2028 7b7d 2c20 5b30  one).    ({}, [0
-00020190: 5d29 0a0a 2020 2020 5265 7475 726e 730a  ])..    Returns.
-000201a0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000201b0: 6368 756e 6b73 7320 3a20 6469 6374 0a20  chunkss : dict. 
-000201c0: 2020 2020 2020 204d 6170 206c 696b 6520         Map like 
-000201d0: 7b69 6e64 6578 3a20 6368 756e 6b73 7d2e  {index: chunks}.
-000201e0: 0a20 2020 2061 7272 6179 7320 3a20 6c69  .    arrays : li
-000201f0: 7374 0a20 2020 2020 2020 204c 6973 7420  st.        List 
-00020200: 6f66 2072 6563 6875 6e6b 6564 2061 7272  of rechunked arr
-00020210: 6179 732e 0a0a 2020 2020 5365 6520 416c  ays...    See Al
-00020220: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
-00020230: 2020 2020 636f 6d6d 6f6e 5f62 6c6f 636b      common_block
-00020240: 6469 6d0a 2020 2020 2222 220a 2020 2020  dim.    """.    
-00020250: 6966 206e 6f74 2061 7267 733a 0a20 2020  if not args:.   
-00020260: 2020 2020 2072 6574 7572 6e20 7b7d 2c20       return {}, 
-00020270: 5b5d 0a0a 2020 2020 6172 6769 6e64 7320  []..    arginds 
-00020280: 3d20 5b0a 2020 2020 2020 2020 2861 7361  = [.        (asa
-00020290: 6e79 6172 7261 7928 6129 2069 6620 696e  nyarray(a) if in
-000202a0: 6420 6973 206e 6f74 204e 6f6e 6520 656c  d is not None el
-000202b0: 7365 2061 2c20 696e 6429 2066 6f72 2061  se a, ind) for a
-000202c0: 2c20 696e 6420 696e 2070 6172 7469 7469  , ind in partiti
-000202d0: 6f6e 2832 2c20 6172 6773 290a 2020 2020  on(2, args).    
-000202e0: 5d20 2023 205b 782c 2069 6a2c 2079 2c20  ]  # [x, ij, y, 
-000202f0: 6a6b 5d0a 2020 2020 7761 726e 203d 206b  jk].    warn = k
-00020300: 7761 7267 732e 6765 7428 2277 6172 6e22  wargs.get("warn"
-00020310: 2c20 5472 7565 290a 0a20 2020 2061 7272  , True)..    arr
-00020320: 6179 732c 2069 6e64 7320 3d20 7a69 7028  ays, inds = zip(
-00020330: 2a61 7267 696e 6473 290a 2020 2020 6966  *arginds).    if
-00020340: 2061 6c6c 2869 6e64 2069 7320 4e6f 6e65   all(ind is None
-00020350: 2066 6f72 2069 6e64 2069 6e20 696e 6473   for ind in inds
-00020360: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00020370: 6e20 7b7d 2c20 6c69 7374 2861 7272 6179  n {}, list(array
-00020380: 7329 0a20 2020 2069 6620 616c 6c28 696e  s).    if all(in
-00020390: 6420 3d3d 2069 6e64 735b 305d 2066 6f72  d == inds[0] for
-000203a0: 2069 6e64 2069 6e20 696e 6473 2920 616e   ind in inds) an
-000203b0: 6420 616c 6c28 0a20 2020 2020 2020 2061  d all(.        a
-000203c0: 2e63 6875 6e6b 7320 3d3d 2061 7272 6179  .chunks == array
-000203d0: 735b 305d 2e63 6875 6e6b 7320 666f 7220  s[0].chunks for 
-000203e0: 6120 696e 2061 7272 6179 730a 2020 2020  a in arrays.    
-000203f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00020400: 6e20 6469 6374 287a 6970 2869 6e64 735b  n dict(zip(inds[
-00020410: 305d 2c20 6172 7261 7973 5b30 5d2e 6368  0], arrays[0].ch
-00020420: 756e 6b73 2929 2c20 6172 7261 7973 0a0a  unks)), arrays..
-00020430: 2020 2020 6e61 6d65 696e 6473 203d 205b      nameinds = [
-00020440: 5d0a 2020 2020 626c 6f63 6b64 696d 5f64  ].    blockdim_d
-00020450: 6963 7420 3d20 6469 6374 2829 0a20 2020  ict = dict().   
-00020460: 206d 6178 5f70 6172 7473 203d 2030 0a20   max_parts = 0. 
-00020470: 2020 2066 6f72 2061 2c20 696e 6420 696e     for a, ind in
-00020480: 2061 7267 696e 6473 3a0a 2020 2020 2020   arginds:.      
-00020490: 2020 6966 2069 6e64 2069 7320 6e6f 7420    if ind is not 
-000204a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000204b0: 2020 6e61 6d65 696e 6473 2e61 7070 656e    nameinds.appen
-000204c0: 6428 2861 2e6e 616d 652c 2069 6e64 2929  d((a.name, ind))
-000204d0: 0a20 2020 2020 2020 2020 2020 2062 6c6f  .            blo
-000204e0: 636b 6469 6d5f 6469 6374 5b61 2e6e 616d  ckdim_dict[a.nam
-000204f0: 655d 203d 2061 2e63 6875 6e6b 730a 2020  e] = a.chunks.  
-00020500: 2020 2020 2020 2020 2020 6d61 785f 7061            max_pa
-00020510: 7274 7320 3d20 6d61 7828 6d61 785f 7061  rts = max(max_pa
-00020520: 7274 732c 2061 2e6e 7061 7274 6974 696f  rts, a.npartitio
-00020530: 6e73 290a 2020 2020 2020 2020 656c 7365  ns).        else
-00020540: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
-00020550: 6d65 696e 6473 2e61 7070 656e 6428 2861  meinds.append((a
-00020560: 2c20 696e 6429 290a 0a20 2020 2063 6875  , ind))..    chu
-00020570: 6e6b 7373 203d 2062 726f 6164 6361 7374  nkss = broadcast
-00020580: 5f64 696d 656e 7369 6f6e 7328 6e61 6d65  _dimensions(name
-00020590: 696e 6473 2c20 626c 6f63 6b64 696d 5f64  inds, blockdim_d
-000205a0: 6963 742c 2063 6f6e 736f 6c69 6461 7465  ict, consolidate
-000205b0: 3d63 6f6d 6d6f 6e5f 626c 6f63 6b64 696d  =common_blockdim
-000205c0: 290a 2020 2020 6e70 6172 7473 203d 206d  ).    nparts = m
-000205d0: 6174 682e 7072 6f64 286d 6170 286c 656e  ath.prod(map(len
-000205e0: 2c20 6368 756e 6b73 732e 7661 6c75 6573  , chunkss.values
-000205f0: 2829 2929 0a0a 2020 2020 6966 2077 6172  ()))..    if war
-00020600: 6e20 616e 6420 6e70 6172 7473 2061 6e64  n and nparts and
-00020610: 206e 7061 7274 7320 3e3d 206d 6178 5f70   nparts >= max_p
-00020620: 6172 7473 202a 2031 303a 0a20 2020 2020  arts * 10:.     
-00020630: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00020640: 280a 2020 2020 2020 2020 2020 2020 2249  (.            "I
-00020650: 6e63 7265 6173 696e 6720 6e75 6d62 6572  ncreasing number
-00020660: 206f 6620 6368 756e 6b73 2062 7920 6661   of chunks by fa
-00020670: 6374 6f72 206f 6620 2564 2220 2520 286e  ctor of %d" % (n
-00020680: 7061 7274 7320 2f20 6d61 785f 7061 7274  parts / max_part
-00020690: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
-000206a0: 5065 7266 6f72 6d61 6e63 6557 6172 6e69  PerformanceWarni
-000206b0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-000206c0: 7374 6163 6b6c 6576 656c 3d33 2c0a 2020  stacklevel=3,.  
-000206d0: 2020 2020 2020 290a 0a20 2020 2061 7272        )..    arr
-000206e0: 6179 7320 3d20 5b5d 0a20 2020 2066 6f72  ays = [].    for
-000206f0: 2061 2c20 6920 696e 2061 7267 696e 6473   a, i in arginds
-00020700: 3a0a 2020 2020 2020 2020 6966 2069 2069  :.        if i i
-00020710: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00020720: 2020 2020 6172 7261 7973 2e61 7070 656e      arrays.appen
-00020730: 6428 6129 0a20 2020 2020 2020 2065 6c73  d(a).        els
-00020740: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
-00020750: 6875 6e6b 7320 3d20 7475 706c 6528 0a20  hunks = tuple(. 
-00020760: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00020770: 6875 6e6b 7373 5b6a 5d0a 2020 2020 2020  hunkss[j].      
-00020780: 2020 2020 2020 2020 2020 6966 2061 2e73            if a.s
-00020790: 6861 7065 5b6e 5d20 3e20 310a 2020 2020  hape[n] > 1.    
-000207a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000207b0: 2061 2e73 6861 7065 5b6e 5d0a 2020 2020   a.shape[n].    
-000207c0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000207d0: 6f74 206e 702e 6973 6e61 6e28 7375 6d28  ot np.isnan(sum(
-000207e0: 6368 756e 6b73 735b 6a5d 2929 0a20 2020  chunkss[j])).   
-000207f0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00020800: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
-00020810: 2020 2020 2020 2066 6f72 206e 2c20 6a20         for n, j 
-00020820: 696e 2065 6e75 6d65 7261 7465 2869 290a  in enumerate(i).
-00020830: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00020840: 2020 2020 2020 2020 2020 6966 2063 6875            if chu
-00020850: 6e6b 7320 213d 2061 2e63 6875 6e6b 7320  nks != a.chunks 
-00020860: 616e 6420 616c 6c28 612e 6368 756e 6b73  and all(a.chunks
-00020870: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00020880: 2020 2061 7272 6179 732e 6170 7065 6e64     arrays.append
-00020890: 2861 2e72 6563 6875 6e6b 2863 6875 6e6b  (a.rechunk(chunk
-000208a0: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
-000208b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000208c0: 2020 2020 2020 6172 7261 7973 2e61 7070        arrays.app
-000208d0: 656e 6428 6129 0a20 2020 2072 6574 7572  end(a).    retur
-000208e0: 6e20 6368 756e 6b73 732c 2061 7272 6179  n chunkss, array
-000208f0: 730a 0a0a 6465 6620 756e 7061 636b 5f73  s...def unpack_s
-00020900: 696e 676c 6574 6f6e 2878 293a 0a20 2020  ingleton(x):.   
-00020910: 2022 2222 0a0a 2020 2020 3e3e 3e20 756e   """..    >>> un
-00020920: 7061 636b 5f73 696e 676c 6574 6f6e 285b  pack_singleton([
-00020930: 5b5b 5b31 5d5d 5d5d 290a 2020 2020 310a  [[[1]]]]).    1.
-00020940: 2020 2020 3e3e 3e20 756e 7061 636b 5f73      >>> unpack_s
-00020950: 696e 676c 6574 6f6e 286e 702e 6172 7261  ingleton(np.arra
-00020960: 7928 6e70 2e64 6174 6574 696d 6536 3428  y(np.datetime64(
-00020970: 2732 3030 302d 3031 2d30 3127 2929 290a  '2000-01-01'))).
-00020980: 2020 2020 6172 7261 7928 2732 3030 302d      array('2000-
-00020990: 3031 2d30 3127 2c20 6474 7970 653d 2764  01-01', dtype='d
-000209a0: 6174 6574 696d 6536 345b 445d 2729 0a20  atetime64[D]'). 
-000209b0: 2020 2022 2222 0a20 2020 2077 6869 6c65     """.    while
-000209c0: 2069 7369 6e73 7461 6e63 6528 782c 2028   isinstance(x, (
-000209d0: 6c69 7374 2c20 7475 706c 6529 293a 0a20  list, tuple)):. 
-000209e0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-000209f0: 2020 2020 2020 2020 7820 3d20 785b 305d          x = x[0]
-00020a00: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00020a10: 2849 6e64 6578 4572 726f 722c 2054 7970  (IndexError, Typ
-00020a20: 6545 7272 6f72 2c20 4b65 7945 7272 6f72  eError, KeyError
-00020a30: 293a 0a20 2020 2020 2020 2020 2020 2062  ):.            b
-00020a40: 7265 616b 0a20 2020 2072 6574 7572 6e20  reak.    return 
-00020a50: 780a 0a0a 6465 6620 626c 6f63 6b28 6172  x...def block(ar
-00020a60: 7261 7973 2c20 616c 6c6f 775f 756e 6b6e  rays, allow_unkn
-00020a70: 6f77 6e5f 6368 756e 6b73 697a 6573 3d46  own_chunksizes=F
-00020a80: 616c 7365 293a 0a20 2020 2022 2222 0a20  alse):.    """. 
-00020a90: 2020 2041 7373 656d 626c 6520 616e 206e     Assemble an n
-00020aa0: 642d 6172 7261 7920 6672 6f6d 206e 6573  d-array from nes
-00020ab0: 7465 6420 6c69 7374 7320 6f66 2062 6c6f  ted lists of blo
-00020ac0: 636b 732e 0a0a 2020 2020 426c 6f63 6b73  cks...    Blocks
-00020ad0: 2069 6e20 7468 6520 696e 6e65 726d 6f73   in the innermos
-00020ae0: 7420 6c69 7374 7320 6172 6520 636f 6e63  t lists are conc
-00020af0: 6174 656e 6174 6564 2061 6c6f 6e67 2074  atenated along t
-00020b00: 6865 206c 6173 740a 2020 2020 6469 6d65  he last.    dime
-00020b10: 6e73 696f 6e20 282d 3129 2c20 7468 656e  nsion (-1), then
-00020b20: 2074 6865 7365 2061 7265 2063 6f6e 6361   these are conca
-00020b30: 7465 6e61 7465 6420 616c 6f6e 6720 7468  tenated along th
-00020b40: 6520 7365 636f 6e64 2d6c 6173 740a 2020  e second-last.  
-00020b50: 2020 6469 6d65 6e73 696f 6e20 282d 3229    dimension (-2)
-00020b60: 2c20 616e 6420 736f 206f 6e20 756e 7469  , and so on unti
-00020b70: 6c20 7468 6520 6f75 7465 726d 6f73 7420  l the outermost 
-00020b80: 6c69 7374 2069 7320 7265 6163 6865 640a  list is reached.
-00020b90: 0a20 2020 2042 6c6f 636b 7320 6361 6e20  .    Blocks can 
-00020ba0: 6265 206f 6620 616e 7920 6469 6d65 6e73  be of any dimens
-00020bb0: 696f 6e2c 2062 7574 2077 696c 6c20 6e6f  ion, but will no
-00020bc0: 7420 6265 2062 726f 6164 6361 7374 6564  t be broadcasted
-00020bd0: 2075 7369 6e67 2074 6865 206e 6f72 6d61   using the norma
-00020be0: 6c0a 2020 2020 7275 6c65 732e 2049 6e73  l.    rules. Ins
-00020bf0: 7465 6164 2c20 6c65 6164 696e 6720 6178  tead, leading ax
-00020c00: 6573 206f 6620 7369 7a65 2031 2061 7265  es of size 1 are
-00020c10: 2069 6e73 6572 7465 642c 2074 6f20 6d61   inserted, to ma
-00020c20: 6b65 2060 6062 6c6f 636b 2e6e 6469 6d60  ke ``block.ndim`
-00020c30: 600a 2020 2020 7468 6520 7361 6d65 2066  `.    the same f
-00020c40: 6f72 2061 6c6c 2062 6c6f 636b 732e 2054  or all blocks. T
-00020c50: 6869 7320 6973 2070 7269 6d61 7269 6c79  his is primarily
-00020c60: 2075 7365 6675 6c20 666f 7220 776f 726b   useful for work
-00020c70: 696e 6720 7769 7468 2073 6361 6c61 7273  ing with scalars
-00020c80: 2c0a 2020 2020 616e 6420 6d65 616e 7320  ,.    and means 
-00020c90: 7468 6174 2063 6f64 6520 6c69 6b65 2060  that code like `
-00020ca0: 6062 6c6f 636b 285b 762c 2031 5d29 6060  `block([v, 1])``
-00020cb0: 2069 7320 7661 6c69 642c 2077 6865 7265   is valid, where
-00020cc0: 0a20 2020 2060 6076 2e6e 6469 6d20 3d3d  .    ``v.ndim ==
-00020cd0: 2031 6060 2e0a 0a20 2020 2057 6865 6e20   1``...    When 
-00020ce0: 7468 6520 6e65 7374 6564 206c 6973 7420  the nested list 
-00020cf0: 6973 2074 776f 206c 6576 656c 7320 6465  is two levels de
-00020d00: 6570 2c20 7468 6973 2061 6c6c 6f77 7320  ep, this allows 
-00020d10: 626c 6f63 6b20 6d61 7472 6963 6573 2074  block matrices t
-00020d20: 6f20 6265 0a20 2020 2063 6f6e 7374 7275  o be.    constru
-00020d30: 6374 6564 2066 726f 6d20 7468 6569 7220  cted from their 
-00020d40: 636f 6d70 6f6e 656e 7473 2e0a 0a20 2020  components...   
-00020d50: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00020d60: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2061  ----------.    a
-00020d70: 7272 6179 7320 3a20 6e65 7374 6564 206c  rrays : nested l
-00020d80: 6973 7420 6f66 2061 7272 6179 5f6c 696b  ist of array_lik
-00020d90: 6520 6f72 2073 6361 6c61 7273 2028 6275  e or scalars (bu
-00020da0: 7420 6e6f 7420 7475 706c 6573 290a 2020  t not tuples).  
-00020db0: 2020 2020 2020 4966 2070 6173 7365 6420        If passed 
-00020dc0: 6120 7369 6e67 6c65 206e 6461 7272 6179  a single ndarray
-00020dd0: 206f 7220 7363 616c 6172 2028 6120 6e65   or scalar (a ne
-00020de0: 7374 6564 206c 6973 7420 6f66 2064 6570  sted list of dep
-00020df0: 7468 2030 292c 2074 6869 730a 2020 2020  th 0), this.    
-00020e00: 2020 2020 6973 2072 6574 7572 6e65 6420      is returned 
-00020e10: 756e 6d6f 6469 6669 6564 2028 616e 6420  unmodified (and 
-00020e20: 6e6f 7420 636f 7069 6564 292e 0a0a 2020  not copied)...  
-00020e30: 2020 2020 2020 456c 656d 656e 7473 2073        Elements s
-00020e40: 6861 7065 7320 6d75 7374 206d 6174 6368  hapes must match
-00020e50: 2061 6c6f 6e67 2074 6865 2061 7070 726f   along the appro
-00020e60: 7072 6961 7465 2061 7865 7320 2877 6974  priate axes (wit
-00020e70: 686f 7574 0a20 2020 2020 2020 2062 726f  hout.        bro
-00020e80: 6164 6361 7374 696e 6729 2c20 6275 7420  adcasting), but 
-00020e90: 6c65 6164 696e 6720 3173 2077 696c 6c20  leading 1s will 
-00020ea0: 6265 2070 7265 7065 6e64 6564 2074 6f20  be prepended to 
-00020eb0: 7468 6520 7368 6170 6520 6173 0a20 2020  the shape as.   
-00020ec0: 2020 2020 206e 6563 6573 7361 7279 2074       necessary t
-00020ed0: 6f20 6d61 6b65 2074 6865 2064 696d 656e  o make the dimen
-00020ee0: 7369 6f6e 7320 6d61 7463 682e 0a0a 2020  sions match...  
-00020ef0: 2020 616c 6c6f 775f 756e 6b6e 6f77 6e5f    allow_unknown_
-00020f00: 6368 756e 6b73 697a 6573 3a20 626f 6f6c  chunksizes: bool
-00020f10: 0a20 2020 2020 2020 2041 6c6c 6f77 2075  .        Allow u
-00020f20: 6e6b 6e6f 776e 2063 6875 6e6b 7369 7a65  nknown chunksize
-00020f30: 732c 2073 7563 6820 6173 2063 6f6d 6520  s, such as come 
-00020f40: 6672 6f6d 2063 6f6e 7665 7274 696e 6720  from converting 
-00020f50: 6672 6f6d 2064 6173 6b0a 2020 2020 2020  from dask.      
-00020f60: 2020 6461 7461 6672 616d 6573 2e20 2044    dataframes.  D
-00020f70: 6173 6b2e 6172 7261 7920 6973 2075 6e61  ask.array is una
-00020f80: 626c 6520 746f 2076 6572 6966 7920 7468  ble to verify th
-00020f90: 6174 2063 6875 6e6b 7320 6c69 6e65 2075  at chunks line u
-00020fa0: 702e 2020 4966 0a20 2020 2020 2020 2064  p.  If.        d
-00020fb0: 6174 6120 636f 6d65 7320 6672 6f6d 2064  ata comes from d
-00020fc0: 6966 6665 7265 6e74 6c79 2061 6c69 676e  ifferently align
-00020fd0: 6564 2073 6f75 7263 6573 2074 6865 6e20  ed sources then 
-00020fe0: 7468 6973 2063 616e 2063 6175 7365 0a20  this can cause. 
-00020ff0: 2020 2020 2020 2075 6e65 7870 6563 7465         unexpecte
-00021000: 6420 7265 7375 6c74 732e 0a0a 2020 2020  d results...    
-00021010: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-00021020: 2d2d 2d0a 2020 2020 626c 6f63 6b5f 6172  ---.    block_ar
-00021030: 7261 7920 3a20 6e64 6172 7261 790a 2020  ray : ndarray.  
-00021040: 2020 2020 2020 5468 6520 6172 7261 7920        The array 
-00021050: 6173 7365 6d62 6c65 6420 6672 6f6d 2074  assembled from t
-00021060: 6865 2067 6976 656e 2062 6c6f 636b 732e  he given blocks.
-00021070: 0a0a 2020 2020 2020 2020 5468 6520 6469  ..        The di
-00021080: 6d65 6e73 696f 6e61 6c69 7479 206f 6620  mensionality of 
-00021090: 7468 6520 6f75 7470 7574 2069 7320 6571  the output is eq
-000210a0: 7561 6c20 746f 2074 6865 2067 7265 6174  ual to the great
-000210b0: 6573 7420 6f66 3a0a 2020 2020 2020 2020  est of:.        
-000210c0: 2a20 7468 6520 6469 6d65 6e73 696f 6e61  * the dimensiona
-000210d0: 6c69 7479 206f 6620 616c 6c20 7468 6520  lity of all the 
-000210e0: 696e 7075 7473 0a20 2020 2020 2020 202a  inputs.        *
-000210f0: 2074 6865 2064 6570 7468 2074 6f20 7768   the depth to wh
-00021100: 6963 6820 7468 6520 696e 7075 7420 6c69  ich the input li
-00021110: 7374 2069 7320 6e65 7374 6564 0a0a 2020  st is nested..  
-00021120: 2020 5261 6973 6573 0a20 2020 202d 2d2d    Raises.    ---
-00021130: 2d2d 2d0a 2020 2020 5661 6c75 6545 7272  ---.    ValueErr
-00021140: 6f72 0a20 2020 2020 2020 202a 2049 6620  or.        * If 
-00021150: 6c69 7374 2064 6570 7468 7320 6172 6520  list depths are 
-00021160: 6d69 736d 6174 6368 6564 202d 2066 6f72  mismatched - for
-00021170: 2069 6e73 7461 6e63 652c 2060 605b 5b61   instance, ``[[a
-00021180: 2c20 625d 2c20 635d 6060 2069 730a 2020  , b], c]`` is.  
-00021190: 2020 2020 2020 2020 696c 6c65 6761 6c2c          illegal,
-000211a0: 2061 6e64 2073 686f 756c 6420 6265 2073   and should be s
-000211b0: 7065 6c74 2060 605b 5b61 2c20 625d 2c20  pelt ``[[a, b], 
-000211c0: 5b63 5d5d 6060 0a20 2020 2020 2020 202a  [c]]``.        *
-000211d0: 2049 6620 6c69 7374 7320 6172 6520 656d   If lists are em
-000211e0: 7074 7920 2d20 666f 7220 696e 7374 616e  pty - for instan
-000211f0: 6365 2c20 6060 5b5b 612c 2062 5d2c 205b  ce, ``[[a, b], [
-00021200: 5d5d 6060 0a0a 2020 2020 5365 6520 416c  ]]``..    See Al
-00021210: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
-00021220: 2020 2020 636f 6e63 6174 656e 6174 6520      concatenate 
-00021230: 3a20 4a6f 696e 2061 2073 6571 7565 6e63  : Join a sequenc
-00021240: 6520 6f66 2061 7272 6179 7320 746f 6765  e of arrays toge
-00021250: 7468 6572 2e0a 2020 2020 7374 6163 6b20  ther..    stack 
-00021260: 3a20 5374 6163 6b20 6172 7261 7973 2069  : Stack arrays i
-00021270: 6e20 7365 7175 656e 6365 2061 6c6f 6e67  n sequence along
-00021280: 2061 206e 6577 2064 696d 656e 7369 6f6e   a new dimension
-00021290: 2e0a 2020 2020 6873 7461 636b 203a 2053  ..    hstack : S
-000212a0: 7461 636b 2061 7272 6179 7320 696e 2073  tack arrays in s
-000212b0: 6571 7565 6e63 6520 686f 7269 7a6f 6e74  equence horizont
-000212c0: 616c 6c79 2028 636f 6c75 6d6e 2077 6973  ally (column wis
-000212d0: 6529 2e0a 2020 2020 7673 7461 636b 203a  e)..    vstack :
-000212e0: 2053 7461 636b 2061 7272 6179 7320 696e   Stack arrays in
-000212f0: 2073 6571 7565 6e63 6520 7665 7274 6963   sequence vertic
-00021300: 616c 6c79 2028 726f 7720 7769 7365 292e  ally (row wise).
-00021310: 0a20 2020 2064 7374 6163 6b20 3a20 5374  .    dstack : St
-00021320: 6163 6b20 6172 7261 7973 2069 6e20 7365  ack arrays in se
-00021330: 7175 656e 6365 2064 6570 7468 2077 6973  quence depth wis
-00021340: 6520 2861 6c6f 6e67 2074 6869 7264 2064  e (along third d
-00021350: 696d 656e 7369 6f6e 292e 0a20 2020 2076  imension)..    v
-00021360: 7370 6c69 7420 3a20 5370 6c69 7420 6172  split : Split ar
-00021370: 7261 7920 696e 746f 2061 206c 6973 7420  ray into a list 
-00021380: 6f66 206d 756c 7469 706c 6520 7375 622d  of multiple sub-
-00021390: 6172 7261 7973 2076 6572 7469 6361 6c6c  arrays verticall
-000213a0: 792e 0a0a 2020 2020 4e6f 7465 730a 2020  y...    Notes.  
-000213b0: 2020 2d2d 2d2d 2d0a 0a20 2020 2057 6865    -----..    Whe
-000213c0: 6e20 6361 6c6c 6564 2077 6974 6820 6f6e  n called with on
-000213d0: 6c79 2073 6361 6c61 7273 2c20 6060 626c  ly scalars, ``bl
-000213e0: 6f63 6b60 6020 6973 2065 7175 6976 616c  ock`` is equival
-000213f0: 656e 7420 746f 2061 6e20 6e64 6172 7261  ent to an ndarra
-00021400: 790a 2020 2020 6361 6c6c 2e20 536f 2060  y.    call. So `
-00021410: 6062 6c6f 636b 285b 5b31 2c20 325d 2c20  `block([[1, 2], 
-00021420: 5b33 2c20 345d 5d29 6060 2069 7320 6571  [3, 4]])`` is eq
-00021430: 7569 7661 6c65 6e74 2074 6f0a 2020 2020  uivalent to.    
-00021440: 6060 6172 7261 7928 5b5b 312c 2032 5d2c  ``array([[1, 2],
-00021450: 205b 332c 2034 5d5d 2960 602e 0a0a 2020   [3, 4]])``...  
-00021460: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
-00021470: 646f 6573 206e 6f74 2065 6e66 6f72 6365  does not enforce
-00021480: 2074 6861 7420 7468 6520 626c 6f63 6b73   that the blocks
-00021490: 206c 6965 206f 6e20 6120 6669 7865 6420   lie on a fixed 
-000214a0: 6772 6964 2e0a 2020 2020 6060 626c 6f63  grid..    ``bloc
-000214b0: 6b28 5b5b 612c 2062 5d2c 205b 632c 2064  k([[a, b], [c, d
-000214c0: 5d5d 2960 6020 6973 206e 6f74 2072 6573  ]])`` is not res
-000214d0: 7472 6963 7465 6420 746f 2061 7272 6179  tricted to array
-000214e0: 7320 6f66 2074 6865 2066 6f72 6d3a 3a0a  s of the form::.
-000214f0: 0a20 2020 2020 2020 2041 4141 6262 0a20  .        AAAbb. 
-00021500: 2020 2020 2020 2041 4141 6262 0a20 2020         AAAbb.   
-00021510: 2020 2020 2063 6363 4444 0a0a 2020 2020       cccDD..    
-00021520: 4275 7420 6973 2061 6c73 6f20 616c 6c6f  But is also allo
-00021530: 7765 6420 746f 2070 726f 6475 6365 2c20  wed to produce, 
-00021540: 666f 7220 736f 6d65 2060 6061 2c20 622c  for some ``a, b,
-00021550: 2063 2c20 6460 603a 3a0a 0a20 2020 2020   c, d``::..     
-00021560: 2020 2041 4141 6262 0a20 2020 2020 2020     AAAbb.       
-00021570: 2041 4141 6262 0a20 2020 2020 2020 2063   AAAbb.        c
-00021580: 4444 4444 0a0a 2020 2020 5369 6e63 6520  DDDD..    Since 
-00021590: 636f 6e63 6174 656e 6174 696f 6e20 6861  concatenation ha
-000215a0: 7070 656e 7320 616c 6f6e 6720 7468 6520  ppens along the 
-000215b0: 6c61 7374 2061 7869 7320 6669 7273 742c  last axis first,
-000215c0: 2060 626c 6f63 6b60 2069 7320 5f6e 6f74   `block` is _not
-000215d0: 5f0a 2020 2020 6361 7061 626c 6520 6f66  _.    capable of
-000215e0: 2070 726f 6475 6369 6e67 2074 6865 2066   producing the f
-000215f0: 6f6c 6c6f 7769 6e67 2064 6972 6563 746c  ollowing directl
-00021600: 793a 3a0a 0a20 2020 2020 2020 2041 4141  y::..        AAA
-00021610: 6262 0a20 2020 2020 2020 2063 6363 6262  bb.        cccbb
-00021620: 0a20 2020 2020 2020 2063 6363 4444 0a0a  .        cccDD..
-00021630: 2020 2020 4d61 746c 6162 2773 2022 7371      Matlab's "sq
-00021640: 7561 7265 2062 7261 636b 6574 2073 7461  uare bracket sta
-00021650: 636b 696e 6722 2c20 6060 5b41 2c20 422c  cking", ``[A, B,
-00021660: 202e 2e2e 3b20 702c 2071 2c20 2e2e 2e5d   ...; p, q, ...]
-00021670: 6060 2c20 6973 0a20 2020 2065 7175 6976  ``, is.    equiv
-00021680: 616c 656e 7420 746f 2060 6062 6c6f 636b  alent to ``block
-00021690: 285b 5b41 2c20 422c 202e 2e2e 5d2c 205b  ([[A, B, ...], [
-000216a0: 702c 2071 2c20 2e2e 2e5d 5d29 6060 2e0a  p, q, ...]])``..
-000216b0: 2020 2020 2222 220a 0a20 2020 2023 2054      """..    # T
-000216c0: 6869 7320 7761 7320 636f 7069 6564 2061  his was copied a
-000216d0: 6c6d 6f73 7420 7665 7262 6174 696d 2066  lmost verbatim f
-000216e0: 726f 6d20 6e75 6d70 792e 636f 7265 2e73  rom numpy.core.s
-000216f0: 6861 7065 5f62 6173 652e 626c 6f63 6b0a  hape_base.block.
-00021700: 2020 2020 2320 5365 6520 6e75 6d70 7920      # See numpy 
-00021710: 6c69 6365 6e73 6520 6174 2068 7474 7073  license at https
-00021720: 3a2f 2f67 6974 6875 622e 636f 6d2f 6e75  ://github.com/nu
-00021730: 6d70 792f 6e75 6d70 792f 626c 6f62 2f6d  mpy/numpy/blob/m
-00021740: 6173 7465 722f 4c49 4345 4e53 452e 7478  aster/LICENSE.tx
-00021750: 740a 2020 2020 2320 6f72 204e 554d 5059  t.    # or NUMPY
-00021760: 5f4c 4943 454e 5345 2e74 7874 2077 6974  _LICENSE.txt wit
-00021770: 6869 6e20 7468 6973 2064 6972 6563 746f  hin this directo
-00021780: 7279 0a0a 2020 2020 6465 6620 6174 6c65  ry..    def atle
-00021790: 6173 745f 6e64 2878 2c20 6e64 696d 293a  ast_nd(x, ndim):
-000217a0: 0a20 2020 2020 2020 2078 203d 2061 7361  .        x = asa
-000217b0: 6e79 6172 7261 7928 7829 0a20 2020 2020  nyarray(x).     
-000217c0: 2020 2064 6966 6620 3d20 6d61 7828 6e64     diff = max(nd
-000217d0: 696d 202d 2078 2e6e 6469 6d2c 2030 290a  im - x.ndim, 0).
-000217e0: 2020 2020 2020 2020 6966 2064 6966 6620          if diff 
-000217f0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00021800: 2020 7265 7475 726e 2078 0a20 2020 2020    return x.     
-00021810: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00021820: 2020 2020 2072 6574 7572 6e20 785b 284e       return x[(N
-00021830: 6f6e 652c 2920 2a20 6469 6666 202b 2028  one,) * diff + (
-00021840: 456c 6c69 7073 6973 2c29 5d0a 0a20 2020  Ellipsis,)]..   
-00021850: 2064 6566 2066 6f72 6d61 745f 696e 6465   def format_inde
-00021860: 7828 696e 6465 7829 3a0a 2020 2020 2020  x(index):.      
-00021870: 2020 7265 7475 726e 2022 6172 7261 7973    return "arrays
-00021880: 2220 2b20 2222 2e6a 6f69 6e28 6622 5b7b  " + "".join(f"[{
-00021890: 697d 5d22 2066 6f72 2069 2069 6e20 696e  i}]" for i in in
-000218a0: 6465 7829 0a0a 2020 2020 7265 6320 3d20  dex)..    rec = 
-000218b0: 5f52 6563 7572 7365 7228 7265 6375 7273  _Recurser(recurs
-000218c0: 655f 6966 3d6c 616d 6264 6120 783a 2074  e_if=lambda x: t
-000218d0: 7970 6528 7829 2069 7320 6c69 7374 290a  ype(x) is list).
-000218e0: 0a20 2020 2023 2065 6e73 7572 6520 7468  .    # ensure th
-000218f0: 6174 2074 6865 206c 6973 7473 2061 7265  at the lists are
-00021900: 2061 6c6c 206d 6174 6368 6564 2069 6e20   all matched in 
-00021910: 6465 7074 680a 2020 2020 6c69 7374 5f6e  depth.    list_n
-00021920: 6469 6d20 3d20 4e6f 6e65 0a20 2020 2061  dim = None.    a
-00021930: 6e79 5f65 6d70 7479 203d 2046 616c 7365  ny_empty = False
-00021940: 0a20 2020 2066 6f72 2069 6e64 6578 2c20  .    for index, 
-00021950: 7661 6c75 652c 2065 6e74 6572 696e 6720  value, entering 
-00021960: 696e 2072 6563 2e77 616c 6b28 6172 7261  in rec.walk(arra
-00021970: 7973 293a 0a20 2020 2020 2020 2069 6620  ys):.        if 
-00021980: 7479 7065 2876 616c 7565 2920 6973 2074  type(value) is t
-00021990: 7570 6c65 3a0a 2020 2020 2020 2020 2020  uple:.          
-000219a0: 2020 2320 6e6f 7420 7374 7269 6374 6c79    # not strictly
-000219b0: 206e 6563 6573 7361 7279 2c20 6275 7420   necessary, but 
-000219c0: 7361 7665 7320 7573 2066 726f 6d3a 0a20  saves us from:. 
-000219d0: 2020 2020 2020 2020 2020 2023 2020 2d20             #  - 
-000219e0: 6d6f 7265 2074 6861 6e20 6f6e 6520 7761  more than one wa
-000219f0: 7920 746f 2064 6f20 7468 696e 6773 202d  y to do things -
-00021a00: 206e 6f20 706f 696e 7420 7472 6561 7469   no point treati
-00021a10: 6e67 2074 7570 6c65 7320 6c69 6b65 0a20  ng tuples like. 
-00021a20: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-00021a30: 6c69 7374 730a 2020 2020 2020 2020 2020  lists.          
-00021a40: 2020 2320 202d 2068 6f72 7269 626c 7920    #  - horribly 
-00021a50: 636f 6e66 7573 696e 6720 6265 6861 7669  confusing behavi
-00021a60: 6f75 7220 7468 6174 2072 6573 756c 7473  our that results
-00021a70: 2077 6865 6e20 7475 706c 6573 2061 7265   when tuples are
-00021a80: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-00021a90: 2020 7472 6561 7465 6420 6c69 6b65 206e    treated like n
-00021aa0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-00021ab0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00021ac0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00021ad0: 2020 2020 227b 7d20 6973 2061 2074 7570      "{} is a tup
-00021ae0: 6c65 2e20 220a 2020 2020 2020 2020 2020  le. ".          
-00021af0: 2020 2020 2020 224f 6e6c 7920 6c69 7374        "Only list
-00021b00: 7320 6361 6e20 6265 2075 7365 6420 746f  s can be used to
-00021b10: 2061 7272 616e 6765 2062 6c6f 636b 732c   arrange blocks,
-00021b20: 2061 6e64 206e 702e 626c 6f63 6b20 646f   and np.block do
-00021b30: 6573 2022 0a20 2020 2020 2020 2020 2020  es ".           
-00021b40: 2020 2020 2022 6e6f 7420 616c 6c6f 7720       "not allow 
-00021b50: 696d 706c 6963 6974 2063 6f6e 7665 7273  implicit convers
-00021b60: 696f 6e20 6672 6f6d 2074 7570 6c65 2074  ion from tuple t
-00021b70: 6f20 6e64 6172 7261 792e 222e 666f 726d  o ndarray.".form
-00021b80: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-00021b90: 2020 2020 2020 2020 666f 726d 6174 5f69          format_i
-00021ba0: 6e64 6578 2869 6e64 6578 290a 2020 2020  ndex(index).    
-00021bb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00021bc0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021bd0: 2020 2020 6966 206e 6f74 2065 6e74 6572      if not enter
-00021be0: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
-00021bf0: 2063 7572 725f 6465 7074 6820 3d20 6c65   curr_depth = le
-00021c00: 6e28 696e 6465 7829 0a20 2020 2020 2020  n(index).       
-00021c10: 2065 6c69 6620 6c65 6e28 7661 6c75 6529   elif len(value)
-00021c20: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00021c30: 2020 2063 7572 725f 6465 7074 6820 3d20     curr_depth = 
-00021c40: 6c65 6e28 696e 6465 7829 202b 2031 0a20  len(index) + 1. 
-00021c50: 2020 2020 2020 2020 2020 2061 6e79 5f65             any_e
-00021c60: 6d70 7479 203d 2054 7275 650a 2020 2020  mpty = True.    
-00021c70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00021c80: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
-00021c90: 2020 2020 2020 2020 6966 206c 6973 745f          if list_
-00021ca0: 6e64 696d 2069 7320 6e6f 7420 4e6f 6e65  ndim is not None
-00021cb0: 2061 6e64 206c 6973 745f 6e64 696d 2021   and list_ndim !
-00021cc0: 3d20 6375 7272 5f64 6570 7468 3a0a 2020  = curr_depth:.  
-00021cd0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00021ce0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00021cf0: 2020 2020 2020 2020 2020 2020 224c 6973              "Lis
-00021d00: 7420 6465 7074 6873 2061 7265 206d 6973  t depths are mis
-00021d10: 6d61 7463 6865 642e 2046 6972 7374 2065  matched. First e
-00021d20: 6c65 6d65 6e74 2077 6173 2061 7420 6465  lement was at de
-00021d30: 7074 6820 7b7d 2c20 220a 2020 2020 2020  pth {}, ".      
-00021d40: 2020 2020 2020 2020 2020 2262 7574 2074            "but t
-00021d50: 6865 7265 2069 7320 616e 2065 6c65 6d65  here is an eleme
-00021d60: 6e74 2061 7420 6465 7074 6820 7b7d 2028  nt at depth {} (
-00021d70: 7b7d 2922 2e66 6f72 6d61 7428 0a20 2020  {})".format(.   
-00021d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d90: 206c 6973 745f 6e64 696d 2c20 6375 7272   list_ndim, curr
-00021da0: 5f64 6570 7468 2c20 666f 726d 6174 5f69  _depth, format_i
-00021db0: 6e64 6578 2869 6e64 6578 290a 2020 2020  ndex(index).    
-00021dc0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00021dd0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021de0: 2020 2020 6c69 7374 5f6e 6469 6d20 3d20      list_ndim = 
-00021df0: 6375 7272 5f64 6570 7468 0a0a 2020 2020  curr_depth..    
-00021e00: 2320 646f 2074 6869 7320 6865 7265 2073  # do this here s
-00021e10: 6f20 7765 2063 6174 6368 2064 6570 7468  o we catch depth
-00021e20: 206d 6973 6d61 7463 6865 7320 6669 7273   mismatches firs
-00021e30: 740a 2020 2020 6966 2061 6e79 5f65 6d70  t.    if any_emp
-00021e40: 7479 3a0a 2020 2020 2020 2020 7261 6973  ty:.        rais
-00021e50: 6520 5661 6c75 6545 7272 6f72 2822 4c69  e ValueError("Li
-00021e60: 7374 7320 6361 6e6e 6f74 2062 6520 656d  sts cannot be em
-00021e70: 7074 7922 290a 0a20 2020 2023 2063 6f6e  pty")..    # con
-00021e80: 7665 7274 2061 6c6c 2074 6865 2061 7272  vert all the arr
-00021e90: 6179 7320 746f 206e 6461 7272 6179 730a  ays to ndarrays.
-00021ea0: 2020 2020 6172 7261 7973 203d 2072 6563      arrays = rec
-00021eb0: 2e6d 6170 5f72 6564 7563 6528 6172 7261  .map_reduce(arra
-00021ec0: 7973 2c20 665f 6d61 703d 6173 616e 7961  ys, f_map=asanya
-00021ed0: 7272 6179 2c20 665f 7265 6475 6365 3d6c  rray, f_reduce=l
-00021ee0: 6973 7429 0a0a 2020 2020 2320 6465 7465  ist)..    # dete
-00021ef0: 726d 696e 6520 7468 6520 6d61 7869 6d75  rmine the maximu
-00021f00: 6d20 6469 6d65 6e73 696f 6e20 6f66 2074  m dimension of t
-00021f10: 6865 2065 6c65 6d65 6e74 730a 2020 2020  he elements.    
-00021f20: 656c 656d 5f6e 6469 6d20 3d20 7265 632e  elem_ndim = rec.
-00021f30: 6d61 705f 7265 6475 6365 2861 7272 6179  map_reduce(array
-00021f40: 732c 2066 5f6d 6170 3d6c 616d 6264 6120  s, f_map=lambda 
-00021f50: 7869 3a20 7869 2e6e 6469 6d2c 2066 5f72  xi: xi.ndim, f_r
-00021f60: 6564 7563 653d 6d61 7829 0a20 2020 206e  educe=max).    n
-00021f70: 6469 6d20 3d20 6d61 7828 6c69 7374 5f6e  dim = max(list_n
-00021f80: 6469 6d2c 2065 6c65 6d5f 6e64 696d 290a  dim, elem_ndim).
-00021f90: 0a20 2020 2023 2066 6972 7374 2061 7869  .    # first axi
-00021fa0: 7320 746f 2063 6f6e 6361 7465 6e61 7465  s to concatenate
-00021fb0: 2061 6c6f 6e67 0a20 2020 2066 6972 7374   along.    first
-00021fc0: 5f61 7869 7320 3d20 6e64 696d 202d 206c  _axis = ndim - l
-00021fd0: 6973 745f 6e64 696d 0a0a 2020 2020 2320  ist_ndim..    # 
-00021fe0: 4d61 6b65 2061 6c6c 2074 6865 2065 6c65  Make all the ele
-00021ff0: 6d65 6e74 7320 7468 6520 7361 6d65 2064  ments the same d
-00022000: 696d 656e 7369 6f6e 0a20 2020 2061 7272  imension.    arr
-00022010: 6179 7320 3d20 7265 632e 6d61 705f 7265  ays = rec.map_re
-00022020: 6475 6365 280a 2020 2020 2020 2020 6172  duce(.        ar
-00022030: 7261 7973 2c20 665f 6d61 703d 6c61 6d62  rays, f_map=lamb
-00022040: 6461 2078 693a 2061 746c 6561 7374 5f6e  da xi: atleast_n
-00022050: 6428 7869 2c20 6e64 696d 292c 2066 5f72  d(xi, ndim), f_r
-00022060: 6564 7563 653d 6c69 7374 0a20 2020 2029  educe=list.    )
-00022070: 0a0a 2020 2020 2320 636f 6e63 6174 656e  ..    # concaten
-00022080: 6174 6520 696e 6e65 726d 6f73 7420 6c69  ate innermost li
-00022090: 7374 7320 6f6e 2074 6865 2072 6967 6874  sts on the right
-000220a0: 2c20 6f75 7465 726d 6f73 7420 6f6e 2074  , outermost on t
-000220b0: 6865 206c 6566 740a 2020 2020 7265 7475  he left.    retu
-000220c0: 726e 2072 6563 2e6d 6170 5f72 6564 7563  rn rec.map_reduc
-000220d0: 6528 0a20 2020 2020 2020 2061 7272 6179  e(.        array
-000220e0: 732c 0a20 2020 2020 2020 2066 5f72 6564  s,.        f_red
-000220f0: 7563 653d 6c61 6d62 6461 2078 732c 2061  uce=lambda xs, a
-00022100: 7869 733a 2063 6f6e 6361 7465 6e61 7465  xis: concatenate
-00022110: 280a 2020 2020 2020 2020 2020 2020 6c69  (.            li
-00022120: 7374 2878 7329 2c20 6178 6973 3d61 7869  st(xs), axis=axi
-00022130: 732c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  s, allow_unknown
-00022140: 5f63 6875 6e6b 7369 7a65 733d 616c 6c6f  _chunksizes=allo
-00022150: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
-00022160: 697a 6573 0a20 2020 2020 2020 2029 2c0a  izes.        ),.
-00022170: 2020 2020 2020 2020 665f 6b77 6172 6773          f_kwargs
-00022180: 3d6c 616d 6264 6120 6178 6973 3a20 6469  =lambda axis: di
-00022190: 6374 2861 7869 733d 2861 7869 7320 2b20  ct(axis=(axis + 
-000221a0: 3129 292c 0a20 2020 2020 2020 2061 7869  1)),.        axi
-000221b0: 733d 6669 7273 745f 6178 6973 2c0a 2020  s=first_axis,.  
-000221c0: 2020 290a 0a0a 6465 6620 636f 6e63 6174    )...def concat
-000221d0: 656e 6174 6528 7365 712c 2061 7869 733d  enate(seq, axis=
-000221e0: 302c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  0, allow_unknown
-000221f0: 5f63 6875 6e6b 7369 7a65 733d 4661 6c73  _chunksizes=Fals
-00022200: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
-00022210: 436f 6e63 6174 656e 6174 6520 6172 7261  Concatenate arra
-00022220: 7973 2061 6c6f 6e67 2061 6e20 6578 6973  ys along an exis
-00022230: 7469 6e67 2061 7869 730a 0a20 2020 2047  ting axis..    G
-00022240: 6976 656e 2061 2073 6571 7565 6e63 6520  iven a sequence 
-00022250: 6f66 2064 6173 6b20 4172 7261 7973 2066  of dask Arrays f
-00022260: 6f72 6d20 6120 6e65 7720 6461 736b 2041  orm a new dask A
-00022270: 7272 6179 2062 7920 7374 6163 6b69 6e67  rray by stacking
-00022280: 2074 6865 6d0a 2020 2020 616c 6f6e 6720   them.    along 
-00022290: 616e 2065 7869 7374 696e 6720 6469 6d65  an existing dime
-000222a0: 6e73 696f 6e20 2861 7869 733d 3020 6279  nsion (axis=0 by
-000222b0: 2064 6566 6175 6c74 290a 0a20 2020 2050   default)..    P
-000222c0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000222d0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073 6571  --------.    seq
-000222e0: 3a20 6c69 7374 206f 6620 6461 736b 2e61  : list of dask.a
-000222f0: 7272 6179 730a 2020 2020 6178 6973 3a20  rrays.    axis: 
-00022300: 696e 740a 2020 2020 2020 2020 4469 6d65  int.        Dime
-00022310: 6e73 696f 6e20 616c 6f6e 6720 7768 6963  nsion along whic
-00022320: 6820 746f 2061 6c69 676e 2061 6c6c 206f  h to align all o
-00022330: 6620 7468 6520 6172 7261 7973 2e20 4966  f the arrays. If
-00022340: 2061 7869 7320 6973 204e 6f6e 652c 0a20   axis is None,. 
-00022350: 2020 2020 2020 2061 7272 6179 7320 6172         arrays ar
-00022360: 6520 666c 6174 7465 6e65 6420 6265 666f  e flattened befo
-00022370: 7265 2075 7365 2e0a 2020 2020 616c 6c6f  re use..    allo
-00022380: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
-00022390: 697a 6573 3a20 626f 6f6c 0a20 2020 2020  izes: bool.     
-000223a0: 2020 2041 6c6c 6f77 2075 6e6b 6e6f 776e     Allow unknown
-000223b0: 2063 6875 6e6b 7369 7a65 732c 2073 7563   chunksizes, suc
-000223c0: 6820 6173 2063 6f6d 6520 6672 6f6d 2063  h as come from c
-000223d0: 6f6e 7665 7274 696e 6720 6672 6f6d 2064  onverting from d
-000223e0: 6173 6b0a 2020 2020 2020 2020 6461 7461  ask.        data
-000223f0: 6672 616d 6573 2e20 2044 6173 6b2e 6172  frames.  Dask.ar
-00022400: 7261 7920 6973 2075 6e61 626c 6520 746f  ray is unable to
-00022410: 2076 6572 6966 7920 7468 6174 2063 6875   verify that chu
-00022420: 6e6b 7320 6c69 6e65 2075 702e 2020 4966  nks line up.  If
-00022430: 0a20 2020 2020 2020 2064 6174 6120 636f  .        data co
-00022440: 6d65 7320 6672 6f6d 2064 6966 6665 7265  mes from differe
-00022450: 6e74 6c79 2061 6c69 676e 6564 2073 6f75  ntly aligned sou
-00022460: 7263 6573 2074 6865 6e20 7468 6973 2063  rces then this c
-00022470: 616e 2063 6175 7365 0a20 2020 2020 2020  an cause.       
-00022480: 2075 6e65 7870 6563 7465 6420 7265 7375   unexpected resu
-00022490: 6c74 732e 0a0a 2020 2020 4578 616d 706c  lts...    Exampl
-000224a0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-000224b0: 0a20 2020 2043 7265 6174 6520 736c 6963  .    Create slic
-000224c0: 6573 0a0a 2020 2020 3e3e 3e20 696d 706f  es..    >>> impo
-000224d0: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
-000224e0: 2064 610a 2020 2020 3e3e 3e20 696d 706f   da.    >>> impo
-000224f0: 7274 206e 756d 7079 2061 7320 6e70 0a0a  rt numpy as np..
-00022500: 2020 2020 3e3e 3e20 6461 7461 203d 205b      >>> data = [
-00022510: 6461 2e66 726f 6d5f 6172 7261 7928 6e70  da.from_array(np
-00022520: 2e6f 6e65 7328 2834 2c20 3429 292c 2063  .ones((4, 4)), c
-00022530: 6875 6e6b 733d 2832 2c20 3229 290a 2020  hunks=(2, 2)).  
-00022540: 2020 2e2e 2e20 2020 2020 2020 2020 2066    ...          f
-00022550: 6f72 2069 2069 6e20 7261 6e67 6528 3329  or i in range(3)
-00022560: 5d0a 0a20 2020 203e 3e3e 2078 203d 2064  ]..    >>> x = d
-00022570: 612e 636f 6e63 6174 656e 6174 6528 6461  a.concatenate(da
-00022580: 7461 2c20 6178 6973 3d30 290a 2020 2020  ta, axis=0).    
-00022590: 3e3e 3e20 782e 7368 6170 650a 2020 2020  >>> x.shape.    
-000225a0: 2831 322c 2034 290a 0a20 2020 203e 3e3e  (12, 4)..    >>>
-000225b0: 2064 612e 636f 6e63 6174 656e 6174 6528   da.concatenate(
-000225c0: 6461 7461 2c20 6178 6973 3d31 292e 7368  data, axis=1).sh
-000225d0: 6170 650a 2020 2020 2834 2c20 3132 290a  ape.    (4, 12).
-000225e0: 0a20 2020 2052 6573 756c 7420 6973 2061  .    Result is a
-000225f0: 206e 6577 2064 6173 6b20 4172 7261 790a   new dask Array.
-00022600: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-00022610: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073    --------.    s
-00022620: 7461 636b 0a20 2020 2022 2222 0a20 2020  tack.    """.   
-00022630: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00022640: 2069 6d70 6f72 7420 7772 6170 0a0a 2020   import wrap..  
-00022650: 2020 7365 7120 3d20 5b61 7361 7272 6179    seq = [asarray
-00022660: 2861 2c20 616c 6c6f 775f 756e 6b6e 6f77  (a, allow_unknow
-00022670: 6e5f 6368 756e 6b73 697a 6573 3d61 6c6c  n_chunksizes=all
-00022680: 6f77 5f75 6e6b 6e6f 776e 5f63 6875 6e6b  ow_unknown_chunk
-00022690: 7369 7a65 7329 2066 6f72 2061 2069 6e20  sizes) for a in 
-000226a0: 7365 715d 0a0a 2020 2020 6966 206e 6f74  seq]..    if not
-000226b0: 2073 6571 3a0a 2020 2020 2020 2020 7261   seq:.        ra
-000226c0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-000226d0: 4e65 6564 2061 7272 6179 2873 2920 746f  Need array(s) to
-000226e0: 2063 6f6e 6361 7465 6e61 7465 2229 0a0a   concatenate")..
-000226f0: 2020 2020 6966 2061 7869 7320 6973 204e      if axis is N
-00022700: 6f6e 653a 0a20 2020 2020 2020 2073 6571  one:.        seq
-00022710: 203d 205b 612e 666c 6174 7465 6e28 2920   = [a.flatten() 
-00022720: 666f 7220 6120 696e 2073 6571 5d0a 2020  for a in seq].  
-00022730: 2020 2020 2020 6178 6973 203d 2030 0a0a        axis = 0..
-00022740: 2020 2020 7365 715f 6d65 7461 7320 3d20      seq_metas = 
-00022750: 5b6d 6574 615f 6672 6f6d 5f61 7272 6179  [meta_from_array
-00022760: 2873 2920 666f 7220 7320 696e 2073 6571  (s) for s in seq
-00022770: 5d0a 2020 2020 5f63 6f6e 6361 7465 6e61  ].    _concatena
-00022780: 7465 203d 2063 6f6e 6361 7465 6e61 7465  te = concatenate
-00022790: 5f6c 6f6f 6b75 702e 6469 7370 6174 6368  _lookup.dispatch
-000227a0: 280a 2020 2020 2020 2020 7479 7065 286d  (.        type(m
-000227b0: 6178 2873 6571 5f6d 6574 6173 2c20 6b65  ax(seq_metas, ke
-000227c0: 793d 6c61 6d62 6461 2078 3a20 6765 7461  y=lambda x: geta
-000227d0: 7474 7228 782c 2022 5f5f 6172 7261 795f  ttr(x, "__array_
-000227e0: 7072 696f 7269 7479 5f5f 222c 2030 2929  priority__", 0))
-000227f0: 290a 2020 2020 290a 2020 2020 6d65 7461  ).    ).    meta
-00022800: 203d 205f 636f 6e63 6174 656e 6174 6528   = _concatenate(
-00022810: 7365 715f 6d65 7461 732c 2061 7869 733d  seq_metas, axis=
-00022820: 6178 6973 290a 0a20 2020 2023 2050 726f  axis)..    # Pro
-00022830: 6d6f 7465 2074 7970 6573 2074 6f20 6d61  mote types to ma
-00022840: 7463 6820 6d65 7461 0a20 2020 2073 6571  tch meta.    seq
-00022850: 203d 205b 612e 6173 7479 7065 286d 6574   = [a.astype(met
-00022860: 612e 6474 7970 6529 2066 6f72 2061 2069  a.dtype) for a i
-00022870: 6e20 7365 715d 0a0a 2020 2020 2320 4669  n seq]..    # Fi
-00022880: 6e64 206f 7574 7075 7420 6172 7261 7920  nd output array 
-00022890: 7368 6170 650a 2020 2020 6e64 696d 203d  shape.    ndim =
-000228a0: 206c 656e 2873 6571 5b30 5d2e 7368 6170   len(seq[0].shap
-000228b0: 6529 0a20 2020 2073 6861 7065 203d 2074  e).    shape = t
-000228c0: 7570 6c65 280a 2020 2020 2020 2020 7375  uple(.        su
-000228d0: 6d28 612e 7368 6170 655b 695d 2066 6f72  m(a.shape[i] for
-000228e0: 2061 2069 6e20 7365 7129 2069 6620 6920   a in seq) if i 
-000228f0: 3d3d 2061 7869 7320 656c 7365 2073 6571  == axis else seq
-00022900: 5b30 5d2e 7368 6170 655b 695d 0a20 2020  [0].shape[i].   
-00022910: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-00022920: 6e67 6528 6e64 696d 290a 2020 2020 290a  nge(ndim).    ).
-00022930: 0a20 2020 2023 2044 726f 7020 656d 7074  .    # Drop empt
-00022940: 7920 6172 7261 7973 0a20 2020 2073 6571  y arrays.    seq
-00022950: 3220 3d20 5b61 2066 6f72 2061 2069 6e20  2 = [a for a in 
-00022960: 7365 7120 6966 2061 2e73 697a 655d 0a20  seq if a.size]. 
-00022970: 2020 2069 6620 6e6f 7420 7365 7132 3a0a     if not seq2:.
-00022980: 2020 2020 2020 2020 7365 7132 203d 2073          seq2 = s
-00022990: 6571 0a0a 2020 2020 6966 2061 7869 7320  eq..    if axis 
-000229a0: 3c20 303a 0a20 2020 2020 2020 2061 7869  < 0:.        axi
-000229b0: 7320 3d20 6e64 696d 202b 2061 7869 730a  s = ndim + axis.
-000229c0: 2020 2020 6966 2061 7869 7320 3e3d 206e      if axis >= n
-000229d0: 6469 6d3a 0a20 2020 2020 2020 206d 7367  dim:.        msg
-000229e0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-000229f0: 2022 4178 6973 206d 7573 7420 6265 206c   "Axis must be l
-00022a00: 6573 7320 7468 616e 2074 6861 6e20 6e75  ess than than nu
-00022a10: 6d62 6572 206f 6620 6469 6d65 6e73 696f  mber of dimensio
-00022a20: 6e73 220a 2020 2020 2020 2020 2020 2020  ns".            
-00022a30: 225c 6e44 6174 6120 6861 7320 2564 2064  "\nData has %d d
-00022a40: 696d 656e 7369 6f6e 732c 2062 7574 2067  imensions, but g
-00022a50: 6f74 2061 7869 733d 2564 220a 2020 2020  ot axis=%d".    
-00022a60: 2020 2020 290a 2020 2020 2020 2020 7261      ).        ra
-00022a70: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
-00022a80: 7367 2025 2028 6e64 696d 2c20 6178 6973  sg % (ndim, axis
-00022a90: 2929 0a0a 2020 2020 6e20 3d20 6c65 6e28  ))..    n = len(
-00022aa0: 7365 7132 290a 2020 2020 6966 206e 203d  seq2).    if n =
-00022ab0: 3d20 303a 0a20 2020 2020 2020 2074 7279  = 0:.        try
-00022ac0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00022ad0: 7475 726e 2077 7261 702e 656d 7074 795f  turn wrap.empty_
-00022ae0: 6c69 6b65 286d 6574 612c 2073 6861 7065  like(meta, shape
-00022af0: 3d73 6861 7065 2c20 6368 756e 6b73 3d73  =shape, chunks=s
-00022b00: 6861 7065 2c20 6474 7970 653d 6d65 7461  hape, dtype=meta
-00022b10: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
-00022b20: 6578 6365 7074 2054 7970 6545 7272 6f72  except TypeError
-00022b30: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00022b40: 7475 726e 2077 7261 702e 656d 7074 7928  turn wrap.empty(
-00022b50: 7368 6170 652c 2063 6875 6e6b 733d 7368  shape, chunks=sh
-00022b60: 6170 652c 2064 7479 7065 3d6d 6574 612e  ape, dtype=meta.
-00022b70: 6474 7970 6529 0a20 2020 2065 6c69 6620  dtype).    elif 
-00022b80: 6e20 3d3d 2031 3a0a 2020 2020 2020 2020  n == 1:.        
-00022b90: 7265 7475 726e 2073 6571 325b 305d 0a0a  return seq2[0]..
-00022ba0: 2020 2020 6966 206e 6f74 2061 6c6c 6f77      if not allow
-00022bb0: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
-00022bc0: 7a65 7320 616e 6420 6e6f 7420 616c 6c28  zes and not all(
-00022bd0: 0a20 2020 2020 2020 2069 203d 3d20 6178  .        i == ax
-00022be0: 6973 206f 7220 616c 6c28 782e 7368 6170  is or all(x.shap
-00022bf0: 655b 695d 203d 3d20 7365 7132 5b30 5d2e  e[i] == seq2[0].
-00022c00: 7368 6170 655b 695d 2066 6f72 2078 2069  shape[i] for x i
-00022c10: 6e20 7365 7132 290a 2020 2020 2020 2020  n seq2).        
-00022c20: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
-00022c30: 6469 6d29 0a20 2020 2029 3a0a 2020 2020  dim).    ):.    
-00022c40: 2020 2020 6966 2061 6e79 286d 6170 286e      if any(map(n
-00022c50: 702e 6973 6e61 6e2c 2073 6571 325b 305d  p.isnan, seq2[0]
-00022c60: 2e73 6861 7065 2929 3a0a 2020 2020 2020  .shape)):.      
-00022c70: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00022c80: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00022c90: 2020 2020 2020 2020 2254 7269 6564 2074          "Tried t
-00022ca0: 6f20 636f 6e63 6174 656e 6174 6520 6172  o concatenate ar
-00022cb0: 7261 7973 2077 6974 6820 756e 6b6e 6f77  rays with unknow
-00022cc0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-00022cd0: 2020 2022 2073 6861 7065 2025 732e 5c6e     " shape %s.\n
-00022ce0: 5c6e 5477 6f20 736f 6c75 7469 6f6e 733a  \nTwo solutions:
-00022cf0: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
-00022d00: 2020 2020 2220 2031 2e20 466f 7263 6520      "  1. Force 
-00022d10: 636f 6e63 6174 656e 6174 696f 6e20 7061  concatenation pa
-00022d20: 7373 220a 2020 2020 2020 2020 2020 2020  ss".            
-00022d30: 2020 2020 2220 616c 6c6f 775f 756e 6b6e      " allow_unkn
-00022d40: 6f77 6e5f 6368 756e 6b73 697a 6573 3d54  own_chunksizes=T
-00022d50: 7275 652e 5c6e 220a 2020 2020 2020 2020  rue.\n".        
-00022d60: 2020 2020 2020 2020 2220 2032 2e20 436f          "  2. Co
-00022d70: 6d70 7574 6520 7368 6170 6573 2077 6974  mpute shapes wit
-00022d80: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
-00022d90: 2020 2020 225b 782e 636f 6d70 7574 655f      "[x.compute_
-00022da0: 6368 756e 6b5f 7369 7a65 7328 2920 666f  chunk_sizes() fo
-00022db0: 7220 7820 696e 2073 6571 5d22 2025 2073  r x in seq]" % s
-00022dc0: 7472 2873 6571 325b 305d 2e73 6861 7065  tr(seq2[0].shape
-00022dd0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00022de0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00022df0: 6c75 6545 7272 6f72 2822 5368 6170 6573  lueError("Shapes
-00022e00: 2064 6f20 6e6f 7420 616c 6967 6e3a 2025   do not align: %
-00022e10: 7322 2c20 5b78 2e73 6861 7065 2066 6f72  s", [x.shape for
-00022e20: 2078 2069 6e20 7365 7132 5d29 0a0a 2020   x in seq2])..  
-00022e30: 2020 696e 6473 203d 205b 6c69 7374 2872    inds = [list(r
-00022e40: 616e 6765 286e 6469 6d29 2920 666f 7220  ange(ndim)) for 
-00022e50: 6920 696e 2072 616e 6765 286e 295d 0a20  i in range(n)]. 
-00022e60: 2020 2066 6f72 2069 2c20 696e 6420 696e     for i, ind in
-00022e70: 2065 6e75 6d65 7261 7465 2869 6e64 7329   enumerate(inds)
-00022e80: 3a0a 2020 2020 2020 2020 696e 645b 6178  :.        ind[ax
-00022e90: 6973 5d20 3d20 2d28 6920 2b20 3129 0a0a  is] = -(i + 1)..
-00022ea0: 2020 2020 7563 5f61 7267 7320 3d20 6c69      uc_args = li
-00022eb0: 7374 2863 6f6e 6361 7428 7a69 7028 7365  st(concat(zip(se
-00022ec0: 7132 2c20 696e 6473 2929 290a 2020 2020  q2, inds))).    
-00022ed0: 5f2c 2073 6571 3220 3d20 756e 6966 795f  _, seq2 = unify_
-00022ee0: 6368 756e 6b73 282a 7563 5f61 7267 732c  chunks(*uc_args,
-00022ef0: 2077 6172 6e3d 4661 6c73 6529 0a0a 2020   warn=False)..  
-00022f00: 2020 6264 7320 3d20 5b61 2e63 6875 6e6b    bds = [a.chunk
-00022f10: 7320 666f 7220 6120 696e 2073 6571 325d  s for a in seq2]
-00022f20: 0a0a 2020 2020 6368 756e 6b73 203d 2028  ..    chunks = (
-00022f30: 0a20 2020 2020 2020 2073 6571 325b 305d  .        seq2[0]
-00022f40: 2e63 6875 6e6b 735b 3a61 7869 735d 0a20  .chunks[:axis]. 
-00022f50: 2020 2020 2020 202b 2028 7375 6d28 2862         + (sum((b
-00022f60: 645b 6178 6973 5d20 666f 7220 6264 2069  d[axis] for bd i
-00022f70: 6e20 6264 7329 2c20 2829 292c 290a 2020  n bds), ()),).  
-00022f80: 2020 2020 2020 2b20 7365 7132 5b30 5d2e        + seq2[0].
-00022f90: 6368 756e 6b73 5b61 7869 7320 2b20 3120  chunks[axis + 1 
-00022fa0: 3a5d 0a20 2020 2029 0a0a 2020 2020 6375  :].    )..    cu
-00022fb0: 6d5f 6469 6d73 203d 205b 305d 202b 206c  m_dims = [0] + l
-00022fc0: 6973 7428 6163 6375 6d75 6c61 7465 2861  ist(accumulate(a
-00022fd0: 6464 2c20 5b6c 656e 2861 2e63 6875 6e6b  dd, [len(a.chunk
-00022fe0: 735b 6178 6973 5d29 2066 6f72 2061 2069  s[axis]) for a i
-00022ff0: 6e20 7365 7132 5d29 290a 0a20 2020 206e  n seq2]))..    n
-00023000: 616d 6573 203d 205b 612e 6e61 6d65 2066  ames = [a.name f
-00023010: 6f72 2061 2069 6e20 7365 7132 5d0a 0a20  or a in seq2].. 
-00023020: 2020 206e 616d 6520 3d20 2263 6f6e 6361     name = "conca
-00023030: 7465 6e61 7465 2d22 202b 2074 6f6b 656e  tenate-" + token
-00023040: 697a 6528 6e61 6d65 732c 2061 7869 7329  ize(names, axis)
-00023050: 0a20 2020 206b 6579 7320 3d20 6c69 7374  .    keys = list
-00023060: 2870 726f 6475 6374 285b 6e61 6d65 5d2c  (product([name],
-00023070: 202a 5b72 616e 6765 286c 656e 2862 6429   *[range(len(bd)
-00023080: 2920 666f 7220 6264 2069 6e20 6368 756e  ) for bd in chun
-00023090: 6b73 5d29 290a 0a20 2020 2076 616c 7565  ks]))..    value
-000230a0: 7320 3d20 5b0a 2020 2020 2020 2020 286e  s = [.        (n
-000230b0: 616d 6573 5b62 6973 6563 7428 6375 6d5f  ames[bisect(cum_
-000230c0: 6469 6d73 2c20 6b65 795b 6178 6973 202b  dims, key[axis +
-000230d0: 2031 5d29 202d 2031 5d2c 290a 2020 2020   1]) - 1],).    
-000230e0: 2020 2020 2b20 6b65 795b 3120 3a20 6178      + key[1 : ax
-000230f0: 6973 202b 2031 5d0a 2020 2020 2020 2020  is + 1].        
-00023100: 2b20 286b 6579 5b61 7869 7320 2b20 315d  + (key[axis + 1]
-00023110: 202d 2063 756d 5f64 696d 735b 6269 7365   - cum_dims[bise
-00023120: 6374 2863 756d 5f64 696d 732c 206b 6579  ct(cum_dims, key
-00023130: 5b61 7869 7320 2b20 315d 2920 2d20 315d  [axis + 1]) - 1]
-00023140: 2c29 0a20 2020 2020 2020 202b 206b 6579  ,).        + key
-00023150: 5b61 7869 7320 2b20 3220 3a5d 0a20 2020  [axis + 2 :].   
-00023160: 2020 2020 2066 6f72 206b 6579 2069 6e20       for key in 
-00023170: 6b65 7973 0a20 2020 205d 0a0a 2020 2020  keys.    ]..    
-00023180: 6473 6b20 3d20 6469 6374 287a 6970 286b  dsk = dict(zip(k
-00023190: 6579 732c 2076 616c 7565 7329 290a 2020  eys, values)).  
-000231a0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-000231b0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-000231c0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-000231d0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-000231e0: 733d 7365 7132 290a 0a20 2020 2072 6574  s=seq2)..    ret
-000231f0: 7572 6e20 4172 7261 7928 6772 6170 682c  urn Array(graph,
-00023200: 206e 616d 652c 2063 6875 6e6b 732c 206d   name, chunks, m
-00023210: 6574 613d 6d65 7461 290a 0a0a 6465 6620  eta=meta)...def 
-00023220: 6c6f 6164 5f73 746f 7265 5f63 6875 6e6b  load_store_chunk
-00023230: 280a 2020 2020 783a 2041 6e79 2c0a 2020  (.    x: Any,.  
-00023240: 2020 6f75 743a 2041 6e79 2c0a 2020 2020    out: Any,.    
-00023250: 696e 6465 783a 2073 6c69 6365 2c0a 2020  index: slice,.  
-00023260: 2020 6c6f 636b 3a20 416e 792c 0a20 2020    lock: Any,.   
-00023270: 2072 6574 7572 6e5f 7374 6f72 6564 3a20   return_stored: 
-00023280: 626f 6f6c 2c0a 2020 2020 6c6f 6164 5f73  bool,.    load_s
-00023290: 746f 7265 643a 2062 6f6f 6c2c 0a29 3a0a  tored: bool,.):.
-000232a0: 2020 2020 2222 220a 2020 2020 4120 6675      """.    A fu
-000232b0: 6e63 7469 6f6e 2069 6e73 6572 7465 6420  nction inserted 
-000232c0: 696e 2061 2044 6173 6b20 6772 6170 6820  in a Dask graph 
-000232d0: 666f 7220 7374 6f72 696e 6720 6120 6368  for storing a ch
-000232e0: 756e 6b2e 0a0a 2020 2020 5061 7261 6d65  unk...    Parame
-000232f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-00023300: 2d2d 2d0a 2020 2020 783a 2061 7272 6179  ---.    x: array
-00023310: 2d6c 696b 650a 2020 2020 2020 2020 416e  -like.        An
-00023320: 2061 7272 6179 2028 706f 7465 6e74 6961   array (potentia
-00023330: 6c6c 7920 6120 4e75 6d50 7920 6f6e 6529  lly a NumPy one)
-00023340: 0a20 2020 206f 7574 3a20 6172 7261 792d  .    out: array-
-00023350: 6c69 6b65 0a20 2020 2020 2020 2057 6865  like.        Whe
-00023360: 7265 2074 6f20 7374 6f72 6520 7265 7375  re to store resu
-00023370: 6c74 732e 0a20 2020 2069 6e64 6578 3a20  lts..    index: 
-00023380: 736c 6963 652d 6c69 6b65 0a20 2020 2020  slice-like.     
-00023390: 2020 2057 6865 7265 2074 6f20 7374 6f72     Where to stor
-000233a0: 6520 7265 7375 6c74 2066 726f 6d20 6060  e result from ``
-000233b0: 7860 6020 696e 2060 606f 7574 6060 2e0a  x`` in ``out``..
-000233c0: 2020 2020 6c6f 636b 3a20 4c6f 636b 2d6c      lock: Lock-l
-000233d0: 696b 6520 6f72 2046 616c 7365 0a20 2020  ike or False.   
-000233e0: 2020 2020 204c 6f63 6b20 746f 2075 7365       Lock to use
-000233f0: 2062 6566 6f72 6520 7772 6974 696e 6720   before writing 
-00023400: 746f 2060 606f 7574 6060 2e0a 2020 2020  to ``out``..    
-00023410: 7265 7475 726e 5f73 746f 7265 643a 2062  return_stored: b
-00023420: 6f6f 6c0a 2020 2020 2020 2020 5768 6574  ool.        Whet
-00023430: 6865 7220 746f 2072 6574 7572 6e20 6060  her to return ``
-00023440: 6f75 7460 602e 0a20 2020 206c 6f61 645f  out``..    load_
-00023450: 7374 6f72 6564 3a20 626f 6f6c 0a20 2020  stored: bool.   
-00023460: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-00023470: 7265 7475 726e 2074 6865 2061 7272 6179  return the array
-00023480: 2073 746f 7265 6420 696e 2060 606f 7574   stored in ``out
-00023490: 6060 2e0a 2020 2020 2020 2020 4967 6e6f  ``..        Igno
-000234a0: 7265 6420 6966 2060 6072 6574 7572 6e5f  red if ``return_
-000234b0: 7374 6f72 6564 6060 2069 7320 6e6f 7420  stored`` is not 
-000234c0: 6060 5472 7565 6060 2e0a 0a20 2020 2052  ``True``...    R
-000234d0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-000234e0: 2d2d 0a0a 2020 2020 4966 2072 6574 7572  --..    If retur
-000234f0: 6e5f 7374 6f72 6564 3d54 7275 6520 616e  n_stored=True an
-00023500: 6420 6c6f 6164 5f73 746f 7265 643d 4661  d load_stored=Fa
-00023510: 6c73 650a 2020 2020 2020 2020 6f75 740a  lse.        out.
-00023520: 2020 2020 4966 2072 6574 7572 6e5f 7374      If return_st
-00023530: 6f72 6564 3d54 7275 6520 616e 6420 6c6f  ored=True and lo
-00023540: 6164 5f73 746f 7265 643d 5472 7565 0a20  ad_stored=True. 
-00023550: 2020 2020 2020 206f 7574 5b69 6e64 6578         out[index
-00023560: 5d0a 2020 2020 4966 2072 6574 7572 6e5f  ].    If return_
-00023570: 7374 6f72 6564 3d46 616c 7365 2061 6e64  stored=False and
-00023580: 2063 6f6d 7075 7465 3d46 616c 7365 0a20   compute=False. 
-00023590: 2020 2020 2020 204e 6f6e 650a 0a20 2020         None..   
-000235a0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-000235b0: 2d2d 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20  ------..    >>> 
-000235c0: 6120 3d20 6e70 2e6f 6e65 7328 2835 2c20  a = np.ones((5, 
-000235d0: 3629 290a 2020 2020 3e3e 3e20 6220 3d20  6)).    >>> b = 
-000235e0: 6e70 2e65 6d70 7479 2861 2e73 6861 7065  np.empty(a.shape
-000235f0: 290a 2020 2020 3e3e 3e20 6c6f 6164 5f73  ).    >>> load_s
-00023600: 746f 7265 5f63 6875 6e6b 2861 2c20 622c  tore_chunk(a, b,
-00023610: 2028 736c 6963 6528 4e6f 6e65 292c 2073   (slice(None), s
-00023620: 6c69 6365 284e 6f6e 6529 292c 2046 616c  lice(None)), Fal
-00023630: 7365 2c20 4661 6c73 652c 2046 616c 7365  se, False, False
-00023640: 290a 2020 2020 2222 220a 2020 2020 6966  ).    """.    if
-00023650: 206c 6f63 6b3a 0a20 2020 2020 2020 206c   lock:.        l
-00023660: 6f63 6b2e 6163 7175 6972 6528 290a 2020  ock.acquire().  
-00023670: 2020 7472 793a 0a20 2020 2020 2020 2069    try:.        i
-00023680: 6620 7820 6973 206e 6f74 204e 6f6e 6520  f x is not None 
-00023690: 616e 6420 782e 7369 7a65 2021 3d20 303a  and x.size != 0:
-000236a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000236b0: 6973 5f61 7272 6179 6c69 6b65 2878 293a  is_arraylike(x):
-000236c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000236d0: 206f 7574 5b69 6e64 6578 5d20 3d20 780a   out[index] = x.
-000236e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000236f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023700: 2020 6f75 745b 696e 6465 785d 203d 206e    out[index] = n
-00023710: 702e 6173 616e 7961 7272 6179 2878 290a  p.asanyarray(x).
-00023720: 0a20 2020 2020 2020 2069 6620 7265 7475  .        if retu
-00023730: 726e 5f73 746f 7265 6420 616e 6420 6c6f  rn_stored and lo
-00023740: 6164 5f73 746f 7265 643a 0a20 2020 2020  ad_stored:.     
-00023750: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
-00023760: 745b 696e 6465 785d 0a20 2020 2020 2020  t[index].       
-00023770: 2065 6c69 6620 7265 7475 726e 5f73 746f   elif return_sto
-00023780: 7265 6420 616e 6420 6e6f 7420 6c6f 6164  red and not load
-00023790: 5f73 746f 7265 643a 0a20 2020 2020 2020  _stored:.       
-000237a0: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
-000237b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000237c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000237d0: 204e 6f6e 650a 2020 2020 6669 6e61 6c6c   None.    finall
-000237e0: 793a 0a20 2020 2020 2020 2069 6620 6c6f  y:.        if lo
-000237f0: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
-00023800: 6c6f 636b 2e72 656c 6561 7365 2829 0a0a  lock.release()..
-00023810: 0a64 6566 2073 746f 7265 5f63 6875 6e6b  .def store_chunk
-00023820: 280a 2020 2020 783a 2041 7272 6179 4c69  (.    x: ArrayLi
-00023830: 6b65 2c20 6f75 743a 2041 7272 6179 4c69  ke, out: ArrayLi
-00023840: 6b65 2c20 696e 6465 783a 2073 6c69 6365  ke, index: slice
-00023850: 2c20 6c6f 636b 3a20 416e 792c 2072 6574  , lock: Any, ret
-00023860: 7572 6e5f 7374 6f72 6564 3a20 626f 6f6c  urn_stored: bool
-00023870: 0a29 3a0a 2020 2020 7265 7475 726e 206c  .):.    return l
-00023880: 6f61 645f 7374 6f72 655f 6368 756e 6b28  oad_store_chunk(
-00023890: 782c 206f 7574 2c20 696e 6465 782c 206c  x, out, index, l
-000238a0: 6f63 6b2c 2072 6574 7572 6e5f 7374 6f72  ock, return_stor
-000238b0: 6564 2c20 4661 6c73 6529 0a0a 0a41 203d  ed, False)...A =
-000238c0: 2054 7970 6556 6172 2822 4122 2c20 626f   TypeVar("A", bo
-000238d0: 756e 643d 4172 7261 794c 696b 6529 0a0a  und=ArrayLike)..
-000238e0: 0a64 6566 206c 6f61 645f 6368 756e 6b28  .def load_chunk(
-000238f0: 6f75 743a 2041 2c20 696e 6465 783a 2073  out: A, index: s
-00023900: 6c69 6365 2c20 6c6f 636b 3a20 416e 7929  lice, lock: Any)
-00023910: 202d 3e20 413a 0a20 2020 2072 6574 7572   -> A:.    retur
-00023920: 6e20 6c6f 6164 5f73 746f 7265 5f63 6875  n load_store_chu
-00023930: 6e6b 284e 6f6e 652c 206f 7574 2c20 696e  nk(None, out, in
-00023940: 6465 782c 206c 6f63 6b2c 2054 7275 652c  dex, lock, True,
-00023950: 2054 7275 6529 0a0a 0a64 6566 2069 6e73   True)...def ins
-00023960: 6572 745f 746f 5f6f 6f63 280a 2020 2020  ert_to_ooc(.    
-00023970: 6b65 7973 3a20 6c69 7374 2c0a 2020 2020  keys: list,.    
-00023980: 6368 756e 6b73 3a20 7475 706c 655b 7475  chunks: tuple[tu
-00023990: 706c 655b 696e 742c 202e 2e2e 5d2c 202e  ple[int, ...], .
-000239a0: 2e2e 5d2c 0a20 2020 206f 7574 3a20 4172  ..],.    out: Ar
-000239b0: 7261 794c 696b 652c 0a20 2020 206e 616d  rayLike,.    nam
-000239c0: 653a 2073 7472 2c0a 2020 2020 2a2c 0a20  e: str,.    *,. 
-000239d0: 2020 206c 6f63 6b3a 204c 6f63 6b20 7c20     lock: Lock | 
-000239e0: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-000239f0: 2072 6567 696f 6e3a 2074 7570 6c65 5b73   region: tuple[s
-00023a00: 6c69 6365 2c20 2e2e 2e5d 207c 2073 6c69  lice, ...] | sli
-00023a10: 6365 207c 204e 6f6e 6520 3d20 4e6f 6e65  ce | None = None
-00023a20: 2c0a 2020 2020 7265 7475 726e 5f73 746f  ,.    return_sto
-00023a30: 7265 643a 2062 6f6f 6c20 3d20 4661 6c73  red: bool = Fals
-00023a40: 652c 0a20 2020 206c 6f61 645f 7374 6f72  e,.    load_stor
-00023a50: 6564 3a20 626f 6f6c 203d 2046 616c 7365  ed: bool = False
-00023a60: 2c0a 2920 2d3e 2064 6963 743a 0a20 2020  ,.) -> dict:.   
-00023a70: 2022 2222 0a20 2020 2043 7265 6174 6573   """.    Creates
-00023a80: 2061 2044 6173 6b20 6772 6170 6820 666f   a Dask graph fo
-00023a90: 7220 7374 6f72 696e 6720 6368 756e 6b73  r storing chunks
-00023aa0: 2066 726f 6d20 6060 6172 7260 6020 696e   from ``arr`` in
-00023ab0: 2060 606f 7574 6060 2e0a 0a20 2020 2050   ``out``...    P
-00023ac0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00023ad0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206b 6579  --------.    key
-00023ae0: 733a 206c 6973 740a 2020 2020 2020 2020  s: list.        
-00023af0: 4461 736b 206b 6579 7320 6f66 2074 6865  Dask keys of the
-00023b00: 2069 6e70 7574 2061 7272 6179 0a20 2020   input array.   
-00023b10: 2063 6875 6e6b 733a 2074 7570 6c65 0a20   chunks: tuple. 
-00023b20: 2020 2020 2020 2044 6173 6b20 6368 756e         Dask chun
-00023b30: 6b73 206f 6620 7468 6520 696e 7075 7420  ks of the input 
-00023b40: 6172 7261 790a 2020 2020 6f75 743a 2061  array.    out: a
-00023b50: 7272 6179 2d6c 696b 650a 2020 2020 2020  rray-like.      
-00023b60: 2020 5768 6572 6520 746f 2073 746f 7265    Where to store
-00023b70: 2072 6573 756c 7473 2074 6f0a 2020 2020   results to.    
-00023b80: 6e61 6d65 3a20 7374 720a 2020 2020 2020  name: str.      
-00023b90: 2020 4669 7273 7420 656c 656d 656e 7420    First element 
-00023ba0: 6f66 2064 6173 6b20 6b65 7973 0a20 2020  of dask keys.   
-00023bb0: 206c 6f63 6b3a 204c 6f63 6b2d 6c69 6b65   lock: Lock-like
-00023bc0: 206f 7220 626f 6f6c 2c20 6f70 7469 6f6e   or bool, option
-00023bd0: 616c 0a20 2020 2020 2020 2057 6865 7468  al.        Wheth
-00023be0: 6572 2074 6f20 6c6f 636b 206f 7220 7769  er to lock or wi
-00023bf0: 7468 2077 6861 7420 2864 6566 6175 6c74  th what (default
-00023c00: 2069 7320 6060 5472 7565 6060 2c0a 2020   is ``True``,.  
-00023c10: 2020 2020 2020 7768 6963 6820 6d65 616e        which mean
-00023c20: 7320 6120 3a63 6c61 7373 3a60 7468 7265  s a :class:`thre
-00023c30: 6164 696e 672e 4c6f 636b 6020 696e 7374  ading.Lock` inst
-00023c40: 616e 6365 292e 0a20 2020 2072 6567 696f  ance)..    regio
-00023c50: 6e3a 2073 6c69 6365 2d6c 696b 652c 206f  n: slice-like, o
-00023c60: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00023c70: 5768 6572 6520 696e 2060 606f 7574 6060  Where in ``out``
-00023c80: 2074 6f20 7374 6f72 6520 6060 6172 7260   to store ``arr`
-00023c90: 6027 7320 7265 7375 6c74 730a 2020 2020  `'s results.    
-00023ca0: 2020 2020 2864 6566 6175 6c74 2069 7320      (default is 
-00023cb0: 6060 4e6f 6e65 6060 2c20 6d65 616e 696e  ``None``, meanin
-00023cc0: 6720 616c 6c20 6f66 2060 606f 7574 6060  g all of ``out``
-00023cd0: 292e 0a20 2020 2072 6574 7572 6e5f 7374  )..    return_st
-00023ce0: 6f72 6564 3a20 626f 6f6c 2c20 6f70 7469  ored: bool, opti
-00023cf0: 6f6e 616c 0a20 2020 2020 2020 2057 6865  onal.        Whe
-00023d00: 7468 6572 2074 6f20 7265 7475 726e 2060  ther to return `
-00023d10: 606f 7574 6060 0a20 2020 2020 2020 2028  `out``.        (
-00023d20: 6465 6661 756c 7420 6973 2060 6046 616c  default is ``Fal
-00023d30: 7365 6060 2c20 6d65 616e 696e 6720 6060  se``, meaning ``
-00023d40: 4e6f 6e65 6060 2069 7320 7265 7475 726e  None`` is return
-00023d50: 6564 292e 0a20 2020 206c 6f61 645f 7374  ed)..    load_st
-00023d60: 6f72 6564 3a20 626f 6f6c 2c20 6f70 7469  ored: bool, opti
-00023d70: 6f6e 616c 0a20 2020 2020 2020 2057 6865  onal.        Whe
-00023d80: 7468 6572 2074 6f20 6861 6e64 6c69 6e67  ther to handling
-00023d90: 206c 6f61 6469 6e67 2066 726f 6d20 6060   loading from ``
-00023da0: 6f75 7460 6020 6174 2074 6865 2073 616d  out`` at the sam
-00023db0: 6520 7469 6d65 2e0a 2020 2020 2020 2020  e time..        
-00023dc0: 4967 6e6f 7265 6420 6966 2060 6072 6574  Ignored if ``ret
-00023dd0: 7572 6e5f 7374 6f72 6564 6060 2069 7320  urn_stored`` is 
-00023de0: 6e6f 7420 6060 5472 7565 6060 2e0a 2020  not ``True``..  
-00023df0: 2020 2020 2020 2864 6566 6175 6c74 2069        (default i
-00023e00: 7320 6060 4661 6c73 6560 602c 206d 6561  s ``False``, mea
-00023e10: 6e69 6e67 2064 6566 6572 2074 6f20 6060  ning defer to ``
-00023e20: 7265 7475 726e 5f73 746f 7265 6460 6029  return_stored``)
-00023e30: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
-00023e40: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
-00023e50: 6173 6b20 6772 6170 6820 6f66 2073 746f  ask graph of sto
-00023e60: 7265 206f 7065 7261 7469 6f6e 0a0a 2020  re operation..  
-00023e70: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-00023e80: 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20  -------.    >>> 
-00023e90: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
-00023ea0: 7920 6173 2064 610a 2020 2020 3e3e 3e20  y as da.    >>> 
-00023eb0: 6420 3d20 6461 2e6f 6e65 7328 2835 2c20  d = da.ones((5, 
-00023ec0: 3629 2c20 6368 756e 6b73 3d28 322c 2033  6), chunks=(2, 3
-00023ed0: 2929 0a20 2020 203e 3e3e 2061 203d 206e  )).    >>> a = n
-00023ee0: 702e 656d 7074 7928 642e 7368 6170 6529  p.empty(d.shape)
-00023ef0: 0a20 2020 203e 3e3e 2069 6e73 6572 745f  .    >>> insert_
-00023f00: 746f 5f6f 6f63 2864 2e5f 5f64 6173 6b5f  to_ooc(d.__dask_
-00023f10: 6b65 7973 5f5f 2829 2c20 642e 6368 756e  keys__(), d.chun
-00023f20: 6b73 2c20 612c 2022 7374 6f72 652d 3132  ks, a, "store-12
-00023f30: 3322 2920 2023 2064 6f63 7465 7374 3a20  3")  # doctest: 
-00023f40: 2b53 4b49 500a 2020 2020 2222 220a 0a20  +SKIP.    """.. 
-00023f50: 2020 2069 6620 6c6f 636b 2069 7320 5472     if lock is Tr
-00023f60: 7565 3a0a 2020 2020 2020 2020 6c6f 636b  ue:.        lock
-00023f70: 203d 204c 6f63 6b28 290a 0a20 2020 2073   = Lock()..    s
-00023f80: 6c69 6365 7320 3d20 736c 6963 6573 5f66  lices = slices_f
-00023f90: 726f 6d5f 6368 756e 6b73 2863 6875 6e6b  rom_chunks(chunk
-00023fa0: 7329 0a20 2020 2069 6620 7265 6769 6f6e  s).    if region
-00023fb0: 3a0a 2020 2020 2020 2020 736c 6963 6573  :.        slices
-00023fc0: 203d 205b 6675 7365 5f73 6c69 6365 2872   = [fuse_slice(r
-00023fd0: 6567 696f 6e2c 2073 6c63 2920 666f 7220  egion, slc) for 
-00023fe0: 736c 6320 696e 2073 6c69 6365 735d 0a0a  slc in slices]..
-00023ff0: 2020 2020 6966 2072 6574 7572 6e5f 7374      if return_st
-00024000: 6f72 6564 2061 6e64 206c 6f61 645f 7374  ored and load_st
-00024010: 6f72 6564 3a0a 2020 2020 2020 2020 6675  ored:.        fu
-00024020: 6e63 203d 206c 6f61 645f 7374 6f72 655f  nc = load_store_
-00024030: 6368 756e 6b0a 2020 2020 2020 2020 6172  chunk.        ar
-00024040: 6773 203d 2028 6c6f 6164 5f73 746f 7265  gs = (load_store
-00024050: 642c 290a 2020 2020 656c 7365 3a0a 2020  d,).    else:.  
-00024060: 2020 2020 2020 6675 6e63 203d 2073 746f        func = sto
-00024070: 7265 5f63 6875 6e6b 2020 2320 7479 7065  re_chunk  # type
-00024080: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
-00024090: 2061 7267 7320 3d20 2829 2020 2320 7479   args = ()  # ty
-000240a0: 7065 3a20 6967 6e6f 7265 0a0a 2020 2020  pe: ignore..    
-000240b0: 6473 6b20 3d20 7b0a 2020 2020 2020 2020  dsk = {.        
-000240c0: 286e 616d 652c 2920 2b20 745b 313a 5d3a  (name,) + t[1:]:
-000240d0: 2028 6675 6e63 2c20 742c 206f 7574 2c20   (func, t, out, 
-000240e0: 736c 632c 206c 6f63 6b2c 2072 6574 7572  slc, lock, retur
-000240f0: 6e5f 7374 6f72 6564 2920 2b20 6172 6773  n_stored) + args
-00024100: 0a20 2020 2020 2020 2066 6f72 2074 2c20  .        for t, 
-00024110: 736c 6320 696e 207a 6970 2863 6f72 652e  slc in zip(core.
-00024120: 666c 6174 7465 6e28 6b65 7973 292c 2073  flatten(keys), s
-00024130: 6c69 6365 7329 0a20 2020 207d 0a20 2020  lices).    }.   
-00024140: 2072 6574 7572 6e20 6473 6b0a 0a0a 6465   return dsk...de
-00024150: 6620 7265 7472 6965 7665 5f66 726f 6d5f  f retrieve_from_
-00024160: 6f6f 6328 0a20 2020 206b 6579 733a 2043  ooc(.    keys: C
-00024170: 6f6c 6c65 6374 696f 6e5b 4b65 795d 2c20  ollection[Key], 
-00024180: 6473 6b5f 7072 653a 2047 7261 7068 2c20  dsk_pre: Graph, 
-00024190: 6473 6b5f 706f 7374 3a20 4772 6170 680a  dsk_post: Graph.
-000241a0: 2920 2d3e 2064 6963 745b 7475 706c 652c  ) -> dict[tuple,
-000241b0: 2041 6e79 5d3a 0a20 2020 2022 2222 0a20   Any]:.    """. 
-000241c0: 2020 2043 7265 6174 6573 2061 2044 6173     Creates a Das
-000241d0: 6b20 6772 6170 6820 666f 7220 6c6f 6164  k graph for load
-000241e0: 696e 6720 7374 6f72 6564 2060 606b 6579  ing stored ``key
-000241f0: 7360 6020 6672 6f6d 2060 6064 736b 6060  s`` from ``dsk``
-00024200: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00024210: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00024220: 0a20 2020 206b 6579 733a 2043 6f6c 6c65  .    keys: Colle
-00024230: 6374 696f 6e0a 2020 2020 2020 2020 4120  ction.        A 
-00024240: 7365 7175 656e 6365 2063 6f6e 7461 696e  sequence contain
-00024250: 696e 6720 4461 736b 2067 7261 7068 206b  ing Dask graph k
-00024260: 6579 7320 746f 206c 6f61 640a 2020 2020  eys to load.    
-00024270: 6473 6b5f 7072 653a 204d 6170 7069 6e67  dsk_pre: Mapping
-00024280: 0a20 2020 2020 2020 2041 2044 6173 6b20  .        A Dask 
-00024290: 6772 6170 6820 636f 7272 6573 706f 6e64  graph correspond
-000242a0: 696e 6720 746f 2061 2044 6173 6b20 4172  ing to a Dask Ar
-000242b0: 7261 7920 6265 666f 7265 2063 6f6d 7075  ray before compu
-000242c0: 7461 7469 6f6e 0a20 2020 2064 736b 5f70  tation.    dsk_p
-000242d0: 6f73 743a 204d 6170 7069 6e67 0a20 2020  ost: Mapping.   
-000242e0: 2020 2020 2041 2044 6173 6b20 6772 6170       A Dask grap
-000242f0: 6820 636f 7272 6573 706f 6e64 696e 6720  h corresponding 
-00024300: 746f 2061 2044 6173 6b20 4172 7261 7920  to a Dask Array 
-00024310: 6166 7465 7220 636f 6d70 7574 6174 696f  after computatio
-00024320: 6e0a 0a20 2020 2045 7861 6d70 6c65 730a  n..    Examples.
-00024330: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00024340: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-00024350: 2e61 7272 6179 2061 7320 6461 0a20 2020  .array as da.   
-00024360: 203e 3e3e 2064 203d 2064 612e 6f6e 6573   >>> d = da.ones
-00024370: 2828 352c 2036 292c 2063 6875 6e6b 733d  ((5, 6), chunks=
-00024380: 2832 2c20 3329 290a 2020 2020 3e3e 3e20  (2, 3)).    >>> 
-00024390: 6120 3d20 6e70 2e65 6d70 7479 2864 2e73  a = np.empty(d.s
-000243a0: 6861 7065 290a 2020 2020 3e3e 3e20 6720  hape).    >>> g 
-000243b0: 3d20 696e 7365 7274 5f74 6f5f 6f6f 6328  = insert_to_ooc(
-000243c0: 642e 5f5f 6461 736b 5f6b 6579 735f 5f28  d.__dask_keys__(
-000243d0: 292c 2064 2e63 6875 6e6b 732c 2061 2c20  ), d.chunks, a, 
-000243e0: 2273 746f 7265 2d31 3233 2229 0a20 2020  "store-123").   
-000243f0: 203e 3e3e 2072 6574 7269 6576 655f 6672   >>> retrieve_fr
-00024400: 6f6d 5f6f 6f63 2867 2e6b 6579 7328 292c  om_ooc(g.keys(),
-00024410: 2067 2c20 7b6b 3a20 6b20 666f 7220 6b20   g, {k: k for k 
-00024420: 696e 2067 2e6b 6579 7328 297d 2920 2023  in g.keys()})  #
-00024430: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-00024440: 2020 2020 2222 220a 2020 2020 6c6f 6164      """.    load
-00024450: 5f64 736b 203d 207b 0a20 2020 2020 2020  _dsk = {.       
-00024460: 2028 226c 6f61 642d 2220 2b20 6b5b 305d   ("load-" + k[0]
-00024470: 2c29 202b 206b 5b31 3a5d 3a20 286c 6f61  ,) + k[1:]: (loa
-00024480: 645f 6368 756e 6b2c 2064 736b 5f70 6f73  d_chunk, dsk_pos
-00024490: 745b 6b5d 2920 2b20 6473 6b5f 7072 655b  t[k]) + dsk_pre[
-000244a0: 6b5d 5b33 3a2d 315d 2020 2320 7479 7065  k][3:-1]  # type
-000244b0: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
-000244c0: 2066 6f72 206b 2069 6e20 6b65 7973 0a20   for k in keys. 
-000244d0: 2020 207d 0a0a 2020 2020 7265 7475 726e     }..    return
-000244e0: 206c 6f61 645f 6473 6b0a 0a0a 6465 6620   load_dsk...def 
-000244f0: 6173 6172 7261 7928 0a20 2020 2061 2c20  asarray(.    a, 
-00024500: 616c 6c6f 775f 756e 6b6e 6f77 6e5f 6368  allow_unknown_ch
-00024510: 756e 6b73 697a 6573 3d46 616c 7365 2c20  unksizes=False, 
-00024520: 6474 7970 653d 4e6f 6e65 2c20 6f72 6465  dtype=None, orde
-00024530: 723d 4e6f 6e65 2c20 2a2c 206c 696b 653d  r=None, *, like=
-00024540: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 0a29  None, **kwargs.)
-00024550: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
-00024560: 2074 6865 2069 6e70 7574 2074 6f20 6120   the input to a 
-00024570: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
-00024580: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00024590: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2061  ----------.    a
-000245a0: 203a 2061 7272 6179 2d6c 696b 650a 2020   : array-like.  
-000245b0: 2020 2020 2020 496e 7075 7420 6461 7461        Input data
-000245c0: 2c20 696e 2061 6e79 2066 6f72 6d20 7468  , in any form th
-000245d0: 6174 2063 616e 2062 6520 636f 6e76 6572  at can be conver
-000245e0: 7465 6420 746f 2061 2064 6173 6b20 6172  ted to a dask ar
-000245f0: 7261 792e 2054 6869 730a 2020 2020 2020  ray. This.      
-00024600: 2020 696e 636c 7564 6573 206c 6973 7473    includes lists
-00024610: 2c20 6c69 7374 7320 6f66 2074 7570 6c65  , lists of tuple
-00024620: 732c 2074 7570 6c65 732c 2074 7570 6c65  s, tuples, tuple
-00024630: 7320 6f66 2074 7570 6c65 732c 2074 7570  s of tuples, tup
-00024640: 6c65 7320 6f66 0a20 2020 2020 2020 206c  les of.        l
-00024650: 6973 7473 2061 6e64 206e 6461 7272 6179  ists and ndarray
-00024660: 732e 0a20 2020 2061 6c6c 6f77 5f75 6e6b  s..    allow_unk
-00024670: 6e6f 776e 5f63 6875 6e6b 7369 7a65 733a  nown_chunksizes:
-00024680: 2062 6f6f 6c0a 2020 2020 2020 2020 416c   bool.        Al
-00024690: 6c6f 7720 756e 6b6e 6f77 6e20 6368 756e  low unknown chun
-000246a0: 6b73 697a 6573 2c20 7375 6368 2061 7320  ksizes, such as 
-000246b0: 636f 6d65 2066 726f 6d20 636f 6e76 6572  come from conver
-000246c0: 7469 6e67 2066 726f 6d20 6461 736b 0a20  ting from dask. 
-000246d0: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
-000246e0: 732e 2020 4461 736b 2e61 7272 6179 2069  s.  Dask.array i
-000246f0: 7320 756e 6162 6c65 2074 6f20 7665 7269  s unable to veri
-00024700: 6679 2074 6861 7420 6368 756e 6b73 206c  fy that chunks l
-00024710: 696e 6520 7570 2e20 2049 660a 2020 2020  ine up.  If.    
-00024720: 2020 2020 6461 7461 2063 6f6d 6573 2066      data comes f
-00024730: 726f 6d20 6469 6666 6572 656e 746c 7920  rom differently 
-00024740: 616c 6967 6e65 6420 736f 7572 6365 7320  aligned sources 
-00024750: 7468 656e 2074 6869 7320 6361 6e20 6361  then this can ca
-00024760: 7573 650a 2020 2020 2020 2020 756e 6578  use.        unex
-00024770: 7065 6374 6564 2072 6573 756c 7473 2e0a  pected results..
-00024780: 2020 2020 6474 7970 6520 3a20 6461 7461      dtype : data
-00024790: 2d74 7970 652c 206f 7074 696f 6e61 6c0a  -type, optional.
-000247a0: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
-000247b0: 6c74 2c20 7468 6520 6461 7461 2d74 7970  lt, the data-typ
-000247c0: 6520 6973 2069 6e66 6572 7265 6420 6672  e is inferred fr
-000247d0: 6f6d 2074 6865 2069 6e70 7574 2064 6174  om the input dat
-000247e0: 612e 0a20 2020 206f 7264 6572 203a 207b  a..    order : {
-000247f0: e280 9843 e280 992c 20e2 8098 46e2 8099  ...C..., ...F...
-00024800: 2c20 e280 9841 e280 992c 20e2 8098 4be2  , ...A..., ...K.
-00024810: 8099 7d2c 206f 7074 696f 6e61 6c0a 2020  ..}, optional.  
-00024820: 2020 2020 2020 4d65 6d6f 7279 206c 6179        Memory lay
-00024830: 6f75 742e 20e2 8098 41e2 8099 2061 6e64  out. ...A... and
-00024840: 20e2 8098 4be2 8099 2064 6570 656e 6420   ...K... depend 
-00024850: 6f6e 2074 6865 206f 7264 6572 206f 6620  on the order of 
-00024860: 696e 7075 7420 6172 7261 7920 612e 0a20  input array a.. 
-00024870: 2020 2020 2020 20e2 8098 43e2 8099 2072         ...C... r
-00024880: 6f77 2d6d 616a 6f72 2028 432d 7374 796c  ow-major (C-styl
-00024890: 6529 2c20 e280 9846 e280 9920 636f 6c75  e), ...F... colu
-000248a0: 6d6e 2d6d 616a 6f72 2028 466f 7274 7261  mn-major (Fortra
-000248b0: 6e2d 7374 796c 6529 206d 656d 6f72 790a  n-style) memory.
-000248c0: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-000248d0: 7461 7469 6f6e 2e20 e280 9841 e280 9920  tation. ...A... 
-000248e0: 2861 6e79 2920 6d65 616e 7320 e280 9846  (any) means ...F
-000248f0: e280 9920 6966 2061 2069 7320 466f 7274  ... if a is Fort
-00024900: 7261 6e20 636f 6e74 6967 756f 7573 2c20  ran contiguous, 
-00024910: e280 9843 e280 990a 2020 2020 2020 2020  ...C....        
-00024920: 6f74 6865 7277 6973 6520 e280 984b e280  otherwise ...K..
-00024930: 9920 286b 6565 7029 2070 7265 7365 7276  . (keep) preserv
-00024940: 6520 696e 7075 7420 6f72 6465 722e 2044  e input order. D
-00024950: 6566 6175 6c74 7320 746f 20e2 8098 43e2  efaults to ...C.
-00024960: 8099 2e0a 2020 2020 6c69 6b65 3a20 6172  ....    like: ar
-00024970: 7261 792d 6c69 6b65 0a20 2020 2020 2020  ray-like.       
-00024980: 2052 6566 6572 656e 6365 206f 626a 6563   Reference objec
-00024990: 7420 746f 2061 6c6c 6f77 2074 6865 2063  t to allow the c
-000249a0: 7265 6174 696f 6e20 6f66 2044 6173 6b20  reation of Dask 
-000249b0: 6172 7261 7973 2077 6974 6820 6368 756e  arrays with chun
-000249c0: 6b73 0a20 2020 2020 2020 2074 6861 7420  ks.        that 
-000249d0: 6172 6520 6e6f 7420 4e75 6d50 7920 6172  are not NumPy ar
-000249e0: 7261 7973 2e20 4966 2061 6e20 6172 7261  rays. If an arra
-000249f0: 792d 6c69 6b65 2070 6173 7365 6420 696e  y-like passed in
-00024a00: 2061 7320 6060 6c69 6b65 6060 0a20 2020   as ``like``.   
-00024a10: 2020 2020 2073 7570 706f 7274 7320 7468       supports th
-00024a20: 6520 6060 5f5f 6172 7261 795f 6675 6e63  e ``__array_func
-00024a30: 7469 6f6e 5f5f 6060 2070 726f 746f 636f  tion__`` protoco
-00024a40: 6c2c 2074 6865 2063 6875 6e6b 2074 7970  l, the chunk typ
-00024a50: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
-00024a60: 2072 6573 756c 7469 6e67 2061 7272 6179   resulting array
-00024a70: 2077 696c 6c20 6265 2064 6566 696e 6564   will be defined
-00024a80: 2062 7920 6974 2e20 496e 2074 6869 7320   by it. In this 
-00024a90: 6361 7365 2c20 6974 2065 6e73 7572 6573  case, it ensures
-00024aa0: 2074 6865 0a20 2020 2020 2020 2063 7265   the.        cre
-00024ab0: 6174 696f 6e20 6f66 2061 2044 6173 6b20  ation of a Dask 
-00024ac0: 6172 7261 7920 636f 6d70 6174 6962 6c65  array compatible
-00024ad0: 2077 6974 6820 7468 6174 2070 6173 7365   with that passe
-00024ae0: 6420 696e 2076 6961 2074 6869 730a 2020  d in via this.  
-00024af0: 2020 2020 2020 6172 6775 6d65 6e74 2e20        argument. 
-00024b00: 4966 2060 606c 696b 6560 6020 6973 2061  If ``like`` is a
-00024b10: 2044 6173 6b20 6172 7261 792c 2074 6865   Dask array, the
-00024b20: 2063 6875 6e6b 2074 7970 6520 6f66 2074   chunk type of t
-00024b30: 6865 0a20 2020 2020 2020 2072 6573 756c  he.        resul
-00024b40: 7469 6e67 2061 7272 6179 2077 696c 6c20  ting array will 
-00024b50: 6265 2064 6566 696e 6564 2062 7920 7468  be defined by th
-00024b60: 6520 6368 756e 6b20 7479 7065 206f 6620  e chunk type of 
-00024b70: 6060 6c69 6b65 6060 2e0a 2020 2020 2020  ``like``..      
-00024b80: 2020 5265 7175 6972 6573 204e 756d 5079    Requires NumPy
-00024b90: 2031 2e32 302e 3020 6f72 2068 6967 6865   1.20.0 or highe
-00024ba0: 722e 0a0a 2020 2020 5265 7475 726e 730a  r...    Returns.
-00024bb0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00024bc0: 6f75 7420 3a20 6461 736b 2061 7272 6179  out : dask array
-00024bd0: 0a20 2020 2020 2020 2044 6173 6b20 6172  .        Dask ar
-00024be0: 7261 7920 696e 7465 7270 7265 7461 7469  ray interpretati
-00024bf0: 6f6e 206f 6620 612e 0a0a 2020 2020 4578  on of a...    Ex
-00024c00: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
-00024c10: 2d2d 2d0a 2020 2020 3e3e 3e20 696d 706f  ---.    >>> impo
-00024c20: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
-00024c30: 2064 610a 2020 2020 3e3e 3e20 696d 706f   da.    >>> impo
-00024c40: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-00024c50: 2020 203e 3e3e 2078 203d 206e 702e 6172     >>> x = np.ar
-00024c60: 616e 6765 2833 290a 2020 2020 3e3e 3e20  ange(3).    >>> 
-00024c70: 6461 2e61 7361 7272 6179 2878 290a 2020  da.asarray(x).  
-00024c80: 2020 6461 736b 2e61 7272 6179 3c61 7272    dask.array<arr
-00024c90: 6179 2c20 7368 6170 653d 2833 2c29 2c20  ay, shape=(3,), 
-00024ca0: 6474 7970 653d 696e 7436 342c 2063 6875  dtype=int64, chu
-00024cb0: 6e6b 7369 7a65 3d28 332c 292c 2063 6875  nksize=(3,), chu
-00024cc0: 6e6b 7479 7065 3d6e 756d 7079 2e6e 6461  nktype=numpy.nda
-00024cd0: 7272 6179 3e0a 0a20 2020 203e 3e3e 2079  rray>..    >>> y
-00024ce0: 203d 205b 5b31 2c20 322c 2033 5d2c 205b   = [[1, 2, 3], [
-00024cf0: 342c 2035 2c20 365d 5d0a 2020 2020 3e3e  4, 5, 6]].    >>
-00024d00: 3e20 6461 2e61 7361 7272 6179 2879 290a  > da.asarray(y).
-00024d10: 2020 2020 6461 736b 2e61 7272 6179 3c61      dask.array<a
-00024d20: 7272 6179 2c20 7368 6170 653d 2832 2c20  rray, shape=(2, 
-00024d30: 3329 2c20 6474 7970 653d 696e 7436 342c  3), dtype=int64,
-00024d40: 2063 6875 6e6b 7369 7a65 3d28 322c 2033   chunksize=(2, 3
-00024d50: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
-00024d60: 7079 2e6e 6461 7272 6179 3e0a 2020 2020  py.ndarray>.    
-00024d70: 2222 220a 2020 2020 6966 206c 696b 6520  """.    if like 
-00024d80: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00024d90: 2069 6620 6973 696e 7374 616e 6365 2861   if isinstance(a
-00024da0: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
-00024db0: 2020 2020 2020 7265 7475 726e 2061 0a20        return a. 
-00024dc0: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
-00024dd0: 7474 7228 612c 2022 746f 5f64 6173 6b5f  ttr(a, "to_dask_
-00024de0: 6172 7261 7922 293a 0a20 2020 2020 2020  array"):.       
-00024df0: 2020 2020 2072 6574 7572 6e20 612e 746f       return a.to
-00024e00: 5f64 6173 6b5f 6172 7261 7928 290a 2020  _dask_array().  
-00024e10: 2020 2020 2020 656c 6966 2074 7970 6528        elif type(
-00024e20: 6129 2e5f 5f6d 6f64 756c 655f 5f2e 7370  a).__module__.sp
-00024e30: 6c69 7428 222e 2229 5b30 5d20 3d3d 2022  lit(".")[0] == "
-00024e40: 7861 7272 6179 2220 616e 6420 6861 7361  xarray" and hasa
-00024e50: 7474 7228 612c 2022 6461 7461 2229 3a0a  ttr(a, "data"):.
-00024e60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00024e70: 726e 2061 7361 7272 6179 2861 2e64 6174  rn asarray(a.dat
-00024e80: 6129 0a20 2020 2020 2020 2065 6c69 6620  a).        elif 
-00024e90: 6973 696e 7374 616e 6365 2861 2c20 286c  isinstance(a, (l
-00024ea0: 6973 742c 2074 7570 6c65 2929 2061 6e64  ist, tuple)) and
-00024eb0: 2061 6e79 2869 7369 6e73 7461 6e63 6528   any(isinstance(
-00024ec0: 692c 2041 7272 6179 2920 666f 7220 6920  i, Array) for i 
-00024ed0: 696e 2061 293a 0a20 2020 2020 2020 2020  in a):.         
-00024ee0: 2020 2072 6574 7572 6e20 7374 6163 6b28     return stack(
-00024ef0: 612c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  a, allow_unknown
-00024f00: 5f63 6875 6e6b 7369 7a65 733d 616c 6c6f  _chunksizes=allo
-00024f10: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
-00024f20: 697a 6573 290a 2020 2020 2020 2020 656c  izes).        el
-00024f30: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00024f40: 6528 6765 7461 7474 7228 612c 2022 7368  e(getattr(a, "sh
-00024f50: 6170 6522 2c20 4e6f 6e65 292c 2049 7465  ape", None), Ite
-00024f60: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
-00024f70: 2020 2020 6120 3d20 6e70 2e61 7361 7272      a = np.asarr
-00024f80: 6179 2861 2c20 6474 7970 653d 6474 7970  ay(a, dtype=dtyp
-00024f90: 652c 206f 7264 6572 3d6f 7264 6572 290a  e, order=order).
-00024fa0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00024fb0: 2020 6c69 6b65 5f6d 6574 6120 3d20 6d65    like_meta = me
-00024fc0: 7461 5f66 726f 6d5f 6172 7261 7928 6c69  ta_from_array(li
-00024fd0: 6b65 290a 2020 2020 2020 2020 6966 2069  ke).        if i
-00024fe0: 7369 6e73 7461 6e63 6528 612c 2041 7272  sinstance(a, Arr
-00024ff0: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-00025000: 2072 6574 7572 6e20 612e 6d61 705f 626c   return a.map_bl
-00025010: 6f63 6b73 286e 702e 6173 6172 7261 792c  ocks(np.asarray,
-00025020: 206c 696b 653d 6c69 6b65 5f6d 6574 612c   like=like_meta,
-00025030: 2064 7479 7065 3d64 7479 7065 2c20 6f72   dtype=dtype, or
-00025040: 6465 723d 6f72 6465 7229 0a20 2020 2020  der=order).     
-00025050: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00025060: 2020 2020 2061 203d 206e 702e 6173 6172       a = np.asar
-00025070: 7261 7928 612c 206c 696b 653d 6c69 6b65  ray(a, like=like
-00025080: 5f6d 6574 612c 2064 7479 7065 3d64 7479  _meta, dtype=dty
-00025090: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
-000250a0: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
-000250b0: 5f61 7272 6179 2861 2c20 6765 7469 7465  _array(a, getite
-000250c0: 6d3d 6765 7474 6572 5f69 6e6c 696e 652c  m=getter_inline,
-000250d0: 202a 2a6b 7761 7267 7329 0a0a 0a64 6566   **kwargs)...def
-000250e0: 2061 7361 6e79 6172 7261 7928 612c 2064   asanyarray(a, d
-000250f0: 7479 7065 3d4e 6f6e 652c 206f 7264 6572  type=None, order
-00025100: 3d4e 6f6e 652c 202a 2c20 6c69 6b65 3d4e  =None, *, like=N
-00025110: 6f6e 652c 2069 6e6c 696e 655f 6172 7261  one, inline_arra
-00025120: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
-00025130: 2243 6f6e 7665 7274 2074 6865 2069 6e70  "Convert the inp
-00025140: 7574 2074 6f20 6120 6461 736b 2061 7272  ut to a dask arr
-00025150: 6179 2e0a 0a20 2020 2053 7562 636c 6173  ay...    Subclas
-00025160: 7365 7320 6f66 2060 606e 702e 6e64 6172  ses of ``np.ndar
-00025170: 7261 7960 6020 7769 6c6c 2062 6520 7061  ray`` will be pa
-00025180: 7373 6564 2074 6872 6f75 6768 2061 7320  ssed through as 
-00025190: 6368 756e 6b73 2075 6e63 6861 6e67 6564  chunks unchanged
-000251a0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-000251b0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-000251c0: 0a20 2020 2061 203a 2061 7272 6179 2d6c  .    a : array-l
-000251d0: 696b 650a 2020 2020 2020 2020 496e 7075  ike.        Inpu
-000251e0: 7420 6461 7461 2c20 696e 2061 6e79 2066  t data, in any f
-000251f0: 6f72 6d20 7468 6174 2063 616e 2062 6520  orm that can be 
-00025200: 636f 6e76 6572 7465 6420 746f 2061 2064  converted to a d
-00025210: 6173 6b20 6172 7261 792e 2054 6869 730a  ask array. This.
-00025220: 2020 2020 2020 2020 696e 636c 7564 6573          includes
-00025230: 206c 6973 7473 2c20 6c69 7374 7320 6f66   lists, lists of
-00025240: 2074 7570 6c65 732c 2074 7570 6c65 732c   tuples, tuples,
-00025250: 2074 7570 6c65 7320 6f66 2074 7570 6c65   tuples of tuple
-00025260: 732c 2074 7570 6c65 7320 6f66 0a20 2020  s, tuples of.   
-00025270: 2020 2020 206c 6973 7473 2061 6e64 206e       lists and n
-00025280: 6461 7272 6179 732e 0a20 2020 2064 7479  darrays..    dty
-00025290: 7065 203a 2064 6174 612d 7479 7065 2c20  pe : data-type, 
-000252a0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000252b0: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
-000252c0: 2064 6174 612d 7479 7065 2069 7320 696e   data-type is in
-000252d0: 6665 7272 6564 2066 726f 6d20 7468 6520  ferred from the 
-000252e0: 696e 7075 7420 6461 7461 2e0a 2020 2020  input data..    
-000252f0: 6f72 6465 7220 3a20 7be2 8098 43e2 8099  order : {...C...
-00025300: 2c20 e280 9846 e280 992c 20e2 8098 41e2  , ...F..., ...A.
-00025310: 8099 2c20 e280 984b e280 997d 2c20 6f70  .., ...K...}, op
-00025320: 7469 6f6e 616c 0a20 2020 2020 2020 204d  tional.        M
-00025330: 656d 6f72 7920 6c61 796f 7574 2e20 e280  emory layout. ..
-00025340: 9841 e280 9920 616e 6420 e280 984b e280  .A... and ...K..
-00025350: 9920 6465 7065 6e64 206f 6e20 7468 6520  . depend on the 
-00025360: 6f72 6465 7220 6f66 2069 6e70 7574 2061  order of input a
-00025370: 7272 6179 2061 2e0a 2020 2020 2020 2020  rray a..        
-00025380: e280 9843 e280 9920 726f 772d 6d61 6a6f  ...C... row-majo
-00025390: 7220 2843 2d73 7479 6c65 292c 20e2 8098  r (C-style), ...
-000253a0: 46e2 8099 2063 6f6c 756d 6e2d 6d61 6a6f  F... column-majo
-000253b0: 7220 2846 6f72 7472 616e 2d73 7479 6c65  r (Fortran-style
-000253c0: 2920 6d65 6d6f 7279 0a20 2020 2020 2020  ) memory.       
-000253d0: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
-000253e0: 20e2 8098 41e2 8099 2028 616e 7929 206d   ...A... (any) m
-000253f0: 6561 6e73 20e2 8098 46e2 8099 2069 6620  eans ...F... if 
-00025400: 6120 6973 2046 6f72 7472 616e 2063 6f6e  a is Fortran con
-00025410: 7469 6775 6f75 732c 20e2 8098 43e2 8099  tiguous, ...C...
-00025420: 0a20 2020 2020 2020 206f 7468 6572 7769  .        otherwi
-00025430: 7365 20e2 8098 4be2 8099 2028 6b65 6570  se ...K... (keep
-00025440: 2920 7072 6573 6572 7665 2069 6e70 7574  ) preserve input
-00025450: 206f 7264 6572 2e20 4465 6661 756c 7473   order. Defaults
-00025460: 2074 6f20 e280 9843 e280 992e 0a20 2020   to ...C.....   
-00025470: 206c 696b 653a 2061 7272 6179 2d6c 696b   like: array-lik
-00025480: 650a 2020 2020 2020 2020 5265 6665 7265  e.        Refere
-00025490: 6e63 6520 6f62 6a65 6374 2074 6f20 616c  nce object to al
-000254a0: 6c6f 7720 7468 6520 6372 6561 7469 6f6e  low the creation
-000254b0: 206f 6620 4461 736b 2061 7272 6179 7320   of Dask arrays 
-000254c0: 7769 7468 2063 6875 6e6b 730a 2020 2020  with chunks.    
-000254d0: 2020 2020 7468 6174 2061 7265 206e 6f74      that are not
-000254e0: 204e 756d 5079 2061 7272 6179 732e 2049   NumPy arrays. I
-000254f0: 6620 616e 2061 7272 6179 2d6c 696b 6520  f an array-like 
-00025500: 7061 7373 6564 2069 6e20 6173 2060 606c  passed in as ``l
-00025510: 696b 6560 600a 2020 2020 2020 2020 7375  ike``.        su
-00025520: 7070 6f72 7473 2074 6865 2060 605f 5f61  pports the ``__a
-00025530: 7272 6179 5f66 756e 6374 696f 6e5f 5f60  rray_function__`
-00025540: 6020 7072 6f74 6f63 6f6c 2c20 7468 6520  ` protocol, the 
-00025550: 6368 756e 6b20 7479 7065 206f 6620 7468  chunk type of th
-00025560: 650a 2020 2020 2020 2020 7265 7375 6c74  e.        result
-00025570: 696e 6720 6172 7261 7920 7769 6c6c 2062  ing array will b
-00025580: 6520 6465 6669 6e65 6420 6279 2069 742e  e defined by it.
-00025590: 2049 6e20 7468 6973 2063 6173 652c 2069   In this case, i
-000255a0: 7420 656e 7375 7265 7320 7468 650a 2020  t ensures the.  
-000255b0: 2020 2020 2020 6372 6561 7469 6f6e 206f        creation o
-000255c0: 6620 6120 4461 736b 2061 7272 6179 2063  f a Dask array c
-000255d0: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
-000255e0: 6861 7420 7061 7373 6564 2069 6e20 7669  hat passed in vi
-000255f0: 6120 7468 6973 0a20 2020 2020 2020 2061  a this.        a
-00025600: 7267 756d 656e 742e 2049 6620 6060 6c69  rgument. If ``li
-00025610: 6b65 6060 2069 7320 6120 4461 736b 2061  ke`` is a Dask a
-00025620: 7272 6179 2c20 7468 6520 6368 756e 6b20  rray, the chunk 
-00025630: 7479 7065 206f 6620 7468 650a 2020 2020  type of the.    
-00025640: 2020 2020 7265 7375 6c74 696e 6720 6172      resulting ar
-00025650: 7261 7920 7769 6c6c 2062 6520 6465 6669  ray will be defi
-00025660: 6e65 6420 6279 2074 6865 2063 6875 6e6b  ned by the chunk
-00025670: 2074 7970 6520 6f66 2060 606c 696b 6560   type of ``like`
-00025680: 602e 0a20 2020 2020 2020 2052 6571 7569  `..        Requi
-00025690: 7265 7320 4e75 6d50 7920 312e 3230 2e30  res NumPy 1.20.0
-000256a0: 206f 7220 6869 6768 6572 2e0a 2020 2020   or higher..    
-000256b0: 696e 6c69 6e65 5f61 7272 6179 3a0a 2020  inline_array:.  
-000256c0: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-000256d0: 2069 6e6c 696e 6520 7468 6520 6172 7261   inline the arra
-000256e0: 7920 696e 2074 6865 2072 6573 756c 7469  y in the resulti
-000256f0: 6e67 2064 6173 6b20 6772 6170 682e 2046  ng dask graph. F
-00025700: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
-00025710: 696f 6e2c 0a20 2020 2020 2020 2073 6565  ion,.        see
-00025720: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
-00025730: 6f6e 2066 6f72 2060 6064 6173 6b2e 6172  on for ``dask.ar
-00025740: 7261 792e 6672 6f6d 5f61 7272 6179 2829  ray.from_array()
-00025750: 6060 2e0a 0a20 2020 2052 6574 7572 6e73  ``...    Returns
-00025760: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00025770: 206f 7574 203a 2064 6173 6b20 6172 7261   out : dask arra
-00025780: 790a 2020 2020 2020 2020 4461 736b 2061  y.        Dask a
-00025790: 7272 6179 2069 6e74 6572 7072 6574 6174  rray interpretat
-000257a0: 696f 6e20 6f66 2061 2e0a 0a20 2020 2045  ion of a...    E
-000257b0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-000257c0: 2d2d 2d2d 0a20 2020 203e 3e3e 2069 6d70  ----.    >>> imp
-000257d0: 6f72 7420 6461 736b 2e61 7272 6179 2061  ort dask.array a
-000257e0: 7320 6461 0a20 2020 203e 3e3e 2069 6d70  s da.    >>> imp
-000257f0: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
-00025800: 2020 2020 3e3e 3e20 7820 3d20 6e70 2e61      >>> x = np.a
-00025810: 7261 6e67 6528 3329 0a20 2020 203e 3e3e  range(3).    >>>
-00025820: 2064 612e 6173 616e 7961 7272 6179 2878   da.asanyarray(x
-00025830: 290a 2020 2020 6461 736b 2e61 7272 6179  ).    dask.array
-00025840: 3c61 7272 6179 2c20 7368 6170 653d 2833  <array, shape=(3
-00025850: 2c29 2c20 6474 7970 653d 696e 7436 342c  ,), dtype=int64,
-00025860: 2063 6875 6e6b 7369 7a65 3d28 332c 292c   chunksize=(3,),
-00025870: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
-00025880: 2e6e 6461 7272 6179 3e0a 0a20 2020 203e  .ndarray>..    >
-00025890: 3e3e 2079 203d 205b 5b31 2c20 322c 2033  >> y = [[1, 2, 3
-000258a0: 5d2c 205b 342c 2035 2c20 365d 5d0a 2020  ], [4, 5, 6]].  
-000258b0: 2020 3e3e 3e20 6461 2e61 7361 6e79 6172    >>> da.asanyar
-000258c0: 7261 7928 7929 0a20 2020 2064 6173 6b2e  ray(y).    dask.
-000258d0: 6172 7261 793c 6172 7261 792c 2073 6861  array<array, sha
-000258e0: 7065 3d28 322c 2033 292c 2064 7479 7065  pe=(2, 3), dtype
-000258f0: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
-00025900: 653d 2832 2c20 3329 2c20 6368 756e 6b74  e=(2, 3), chunkt
-00025910: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
-00025920: 793e 0a20 2020 2022 2222 0a20 2020 2069  y>.    """.    i
-00025930: 6620 6c69 6b65 2069 7320 4e6f 6e65 3a0a  f like is None:.
-00025940: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00025950: 7461 6e63 6528 612c 2041 7272 6179 293a  tance(a, Array):
-00025960: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00025970: 7572 6e20 610a 2020 2020 2020 2020 656c  urn a.        el
-00025980: 6966 2068 6173 6174 7472 2861 2c20 2274  if hasattr(a, "t
-00025990: 6f5f 6461 736b 5f61 7272 6179 2229 3a0a  o_dask_array"):.
-000259a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000259b0: 726e 2061 2e74 6f5f 6461 736b 5f61 7272  rn a.to_dask_arr
-000259c0: 6179 2829 0a20 2020 2020 2020 2065 6c69  ay().        eli
-000259d0: 6620 7479 7065 2861 292e 5f5f 6d6f 6475  f type(a).__modu
-000259e0: 6c65 5f5f 2e73 706c 6974 2822 2e22 295b  le__.split(".")[
-000259f0: 305d 203d 3d20 2278 6172 7261 7922 2061  0] == "xarray" a
-00025a00: 6e64 2068 6173 6174 7472 2861 2c20 2264  nd hasattr(a, "d
-00025a10: 6174 6122 293a 0a20 2020 2020 2020 2020  ata"):.         
-00025a20: 2020 2072 6574 7572 6e20 6173 616e 7961     return asanya
-00025a30: 7272 6179 2861 2e64 6174 6129 0a20 2020  rray(a.data).   
-00025a40: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00025a50: 616e 6365 2861 2c20 286c 6973 742c 2074  ance(a, (list, t
-00025a60: 7570 6c65 2929 2061 6e64 2061 6e79 2869  uple)) and any(i
-00025a70: 7369 6e73 7461 6e63 6528 692c 2041 7272  sinstance(i, Arr
-00025a80: 6179 2920 666f 7220 6920 696e 2061 293a  ay) for i in a):
-00025a90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00025aa0: 7572 6e20 7374 6163 6b28 6129 0a20 2020  urn stack(a).   
-00025ab0: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
-00025ac0: 696e 7374 616e 6365 2867 6574 6174 7472  instance(getattr
-00025ad0: 2861 2c20 2273 6861 7065 222c 204e 6f6e  (a, "shape", Non
-00025ae0: 6529 2c20 4974 6572 6162 6c65 293a 0a20  e), Iterable):. 
-00025af0: 2020 2020 2020 2020 2020 2061 203d 206e             a = n
-00025b00: 702e 6173 616e 7961 7272 6179 2861 2c20  p.asanyarray(a, 
-00025b10: 6474 7970 653d 6474 7970 652c 206f 7264  dtype=dtype, ord
-00025b20: 6572 3d6f 7264 6572 290a 2020 2020 656c  er=order).    el
-00025b30: 7365 3a0a 2020 2020 2020 2020 6c69 6b65  se:.        like
-00025b40: 5f6d 6574 6120 3d20 6d65 7461 5f66 726f  _meta = meta_fro
-00025b50: 6d5f 6172 7261 7928 6c69 6b65 290a 2020  m_array(like).  
-00025b60: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00025b70: 6e63 6528 612c 2041 7272 6179 293a 0a20  nce(a, Array):. 
-00025b80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00025b90: 6e20 612e 6d61 705f 626c 6f63 6b73 286e  n a.map_blocks(n
-00025ba0: 702e 6173 616e 7961 7272 6179 2c20 6c69  p.asanyarray, li
-00025bb0: 6b65 3d6c 696b 655f 6d65 7461 2c20 6474  ke=like_meta, dt
-00025bc0: 7970 653d 6474 7970 652c 206f 7264 6572  ype=dtype, order
-00025bd0: 3d6f 7264 6572 290a 2020 2020 2020 2020  =order).        
-00025be0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00025bf0: 2020 6120 3d20 6e70 2e61 7361 6e79 6172    a = np.asanyar
-00025c00: 7261 7928 612c 206c 696b 653d 6c69 6b65  ray(a, like=like
-00025c10: 5f6d 6574 612c 2064 7479 7065 3d64 7479  _meta, dtype=dty
-00025c20: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
-00025c30: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
-00025c40: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-00025c50: 612c 0a20 2020 2020 2020 2063 6875 6e6b  a,.        chunk
-00025c60: 733d 612e 7368 6170 652c 0a20 2020 2020  s=a.shape,.     
-00025c70: 2020 2067 6574 6974 656d 3d67 6574 7465     getitem=gette
-00025c80: 725f 696e 6c69 6e65 2c0a 2020 2020 2020  r_inline,.      
-00025c90: 2020 6173 6172 7261 793d 4661 6c73 652c    asarray=False,
-00025ca0: 0a20 2020 2020 2020 2069 6e6c 696e 655f  .        inline_
-00025cb0: 6172 7261 793d 696e 6c69 6e65 5f61 7272  array=inline_arr
-00025cc0: 6179 2c0a 2020 2020 290a 0a0a 6465 6620  ay,.    )...def 
-00025cd0: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
-00025ce0: 656d 7769 7365 2861 7267 293a 0a20 2020  emwise(arg):.   
-00025cf0: 2022 2222 0a0a 2020 2020 3e3e 3e20 6973   """..    >>> is
-00025d00: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
-00025d10: 7769 7365 2834 3229 0a20 2020 2054 7275  wise(42).    Tru
-00025d20: 650a 2020 2020 3e3e 3e20 6973 5f73 6361  e.    >>> is_sca
-00025d30: 6c61 725f 666f 725f 656c 656d 7769 7365  lar_for_elemwise
-00025d40: 2827 666f 6f27 290a 2020 2020 5472 7565  ('foo').    True
-00025d50: 0a20 2020 203e 3e3e 2069 735f 7363 616c  .    >>> is_scal
-00025d60: 6172 5f66 6f72 5f65 6c65 6d77 6973 6528  ar_for_elemwise(
-00025d70: 5472 7565 290a 2020 2020 5472 7565 0a20  True).    True. 
-00025d80: 2020 203e 3e3e 2069 735f 7363 616c 6172     >>> is_scalar
-00025d90: 5f66 6f72 5f65 6c65 6d77 6973 6528 6e70  _for_elemwise(np
-00025da0: 2e61 7272 6179 2834 3229 290a 2020 2020  .array(42)).    
-00025db0: 5472 7565 0a20 2020 203e 3e3e 2069 735f  True.    >>> is_
-00025dc0: 7363 616c 6172 5f66 6f72 5f65 6c65 6d77  scalar_for_elemw
-00025dd0: 6973 6528 5b31 2c20 322c 2033 5d29 0a20  ise([1, 2, 3]). 
-00025de0: 2020 2054 7275 650a 2020 2020 3e3e 3e20     True.    >>> 
-00025df0: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
-00025e00: 656d 7769 7365 286e 702e 6172 7261 7928  emwise(np.array(
-00025e10: 5b31 2c20 322c 2033 5d29 290a 2020 2020  [1, 2, 3])).    
-00025e20: 4661 6c73 650a 2020 2020 3e3e 3e20 6973  False.    >>> is
-00025e30: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
-00025e40: 7769 7365 2866 726f 6d5f 6172 7261 7928  wise(from_array(
-00025e50: 6e70 2e61 7272 6179 2830 292c 2063 6875  np.array(0), chu
-00025e60: 6e6b 733d 2829 2929 0a20 2020 2046 616c  nks=())).    Fal
-00025e70: 7365 0a20 2020 203e 3e3e 2069 735f 7363  se.    >>> is_sc
-00025e80: 616c 6172 5f66 6f72 5f65 6c65 6d77 6973  alar_for_elemwis
-00025e90: 6528 6e70 2e64 7479 7065 2827 6934 2729  e(np.dtype('i4')
-00025ea0: 290a 2020 2020 5472 7565 0a20 2020 2022  ).    True.    "
-00025eb0: 2222 0a20 2020 2023 2074 6865 2073 6563  "".    # the sec
-00025ec0: 6f6e 6420 6861 6c66 206f 6620 7368 6170  ond half of shap
-00025ed0: 655f 636f 6e64 6974 696f 6e20 6973 2065  e_condition is e
-00025ee0: 7373 656e 7469 616c 6c79 206a 7573 7420  ssentially just 
-00025ef0: 746f 2065 6e73 7572 6520 7468 6174 0a20  to ensure that. 
-00025f00: 2020 2023 2064 6173 6b20 7365 7269 6573     # dask series
-00025f10: 202f 2066 7261 6d65 2061 7265 2074 7265   / frame are tre
-00025f20: 6174 6564 2061 7320 7363 616c 6172 7320  ated as scalars 
-00025f30: 696e 2065 6c65 6d77 6973 652e 0a20 2020  in elemwise..   
-00025f40: 206d 6179 6265 5f73 6861 7065 203d 2067   maybe_shape = g
-00025f50: 6574 6174 7472 2861 7267 2c20 2273 6861  etattr(arg, "sha
-00025f60: 7065 222c 204e 6f6e 6529 0a20 2020 2073  pe", None).    s
-00025f70: 6861 7065 5f63 6f6e 6469 7469 6f6e 203d  hape_condition =
-00025f80: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00025f90: 6d61 7962 655f 7368 6170 652c 2049 7465  maybe_shape, Ite
-00025fa0: 7261 626c 6529 206f 7220 616e 7928 0a20  rable) or any(. 
-00025fb0: 2020 2020 2020 2069 735f 6461 736b 5f63         is_dask_c
-00025fc0: 6f6c 6c65 6374 696f 6e28 7829 2066 6f72  ollection(x) for
-00025fd0: 2078 2069 6e20 6d61 7962 655f 7368 6170   x in maybe_shap
-00025fe0: 650a 2020 2020 290a 0a20 2020 2072 6574  e.    )..    ret
-00025ff0: 7572 6e20 280a 2020 2020 2020 2020 6e70  urn (.        np
-00026000: 2e69 7373 6361 6c61 7228 6172 6729 0a20  .isscalar(arg). 
-00026010: 2020 2020 2020 206f 7220 7368 6170 655f         or shape_
-00026020: 636f 6e64 6974 696f 6e0a 2020 2020 2020  condition.      
-00026030: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
-00026040: 6172 672c 206e 702e 6474 7970 6529 0a20  arg, np.dtype). 
-00026050: 2020 2020 2020 206f 7220 2869 7369 6e73         or (isins
-00026060: 7461 6e63 6528 6172 672c 206e 702e 6e64  tance(arg, np.nd
-00026070: 6172 7261 7929 2061 6e64 2061 7267 2e6e  array) and arg.n
-00026080: 6469 6d20 3d3d 2030 290a 2020 2020 290a  dim == 0).    ).
-00026090: 0a0a 6465 6620 6272 6f61 6463 6173 745f  ..def broadcast_
-000260a0: 7368 6170 6573 282a 7368 6170 6573 293a  shapes(*shapes):
-000260b0: 0a20 2020 2022 2222 0a20 2020 2044 6574  .    """.    Det
-000260c0: 6572 6d69 6e65 7320 6f75 7470 7574 2073  ermines output s
-000260d0: 6861 7065 2066 726f 6d20 6272 6f61 6463  hape from broadc
-000260e0: 6173 7469 6e67 2061 7272 6179 732e 0a0a  asting arrays...
-000260f0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00026100: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00026110: 2020 7368 6170 6573 203a 2074 7570 6c65    shapes : tuple
-00026120: 730a 2020 2020 2020 2020 5468 6520 7368  s.        The sh
-00026130: 6170 6573 206f 6620 7468 6520 6172 6775  apes of the argu
-00026140: 6d65 6e74 732e 0a0a 2020 2020 5265 7475  ments...    Retu
-00026150: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-00026160: 2020 2020 6f75 7470 7574 5f73 6861 7065      output_shape
-00026170: 203a 2074 7570 6c65 0a0a 2020 2020 5261   : tuple..    Ra
-00026180: 6973 6573 0a20 2020 202d 2d2d 2d2d 2d0a  ises.    ------.
-00026190: 2020 2020 5661 6c75 6545 7272 6f72 0a20      ValueError. 
-000261a0: 2020 2020 2020 2049 6620 7468 6520 696e         If the in
-000261b0: 7075 7420 7368 6170 6573 2063 616e 6e6f  put shapes canno
-000261c0: 7420 6265 2073 7563 6365 7373 6675 6c6c  t be successfull
-000261d0: 7920 6272 6f61 6463 6173 7420 746f 6765  y broadcast toge
-000261e0: 7468 6572 2e0a 2020 2020 2222 220a 2020  ther..    """.  
-000261f0: 2020 6966 206c 656e 2873 6861 7065 7329    if len(shapes)
-00026200: 203d 3d20 313a 0a20 2020 2020 2020 2072   == 1:.        r
-00026210: 6574 7572 6e20 7368 6170 6573 5b30 5d0a  eturn shapes[0].
-00026220: 2020 2020 6f75 7420 3d20 5b5d 0a20 2020      out = [].   
-00026230: 2066 6f72 2073 697a 6573 2069 6e20 7a69   for sizes in zi
-00026240: 705f 6c6f 6e67 6573 7428 2a6d 6170 2872  p_longest(*map(r
-00026250: 6576 6572 7365 642c 2073 6861 7065 7329  eversed, shapes)
-00026260: 2c20 6669 6c6c 7661 6c75 653d 2d31 293a  , fillvalue=-1):
-00026270: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
-00026280: 736e 616e 2873 697a 6573 292e 616e 7928  snan(sizes).any(
-00026290: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-000262a0: 696d 203d 206e 702e 6e61 6e0a 2020 2020  im = np.nan.    
-000262b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000262c0: 2020 2020 2020 6469 6d20 3d20 3020 6966        dim = 0 if
-000262d0: 2030 2069 6e20 7369 7a65 7320 656c 7365   0 in sizes else
-000262e0: 206e 702e 6d61 7828 7369 7a65 7329 0a20   np.max(sizes). 
-000262f0: 2020 2020 2020 2069 6620 616e 7928 6920         if any(i 
-00026300: 6e6f 7420 696e 205b 2d31 2c20 302c 2031  not in [-1, 0, 1
-00026310: 2c20 6469 6d5d 2061 6e64 206e 6f74 206e  , dim] and not n
-00026320: 702e 6973 6e61 6e28 6929 2066 6f72 2069  p.isnan(i) for i
-00026330: 2069 6e20 7369 7a65 7329 3a0a 2020 2020   in sizes):.    
-00026340: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00026350: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00026360: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-00026370: 6e64 7320 636f 756c 6420 6e6f 7420 6265  nds could not be
-00026380: 2062 726f 6164 6361 7374 2074 6f67 6574   broadcast toget
-00026390: 6865 7220 7769 7468 2022 0a20 2020 2020  her with ".     
-000263a0: 2020 2020 2020 2020 2020 2022 7368 6170             "shap
-000263b0: 6573 207b 7d22 2e66 6f72 6d61 7428 2220  es {}".format(" 
-000263c0: 222e 6a6f 696e 286d 6170 2873 7472 2c20  ".join(map(str, 
-000263d0: 7368 6170 6573 2929 290a 2020 2020 2020  shapes))).      
-000263e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000263f0: 6f75 742e 6170 7065 6e64 2864 696d 290a  out.append(dim).
-00026400: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
-00026410: 2872 6576 6572 7365 6428 6f75 7429 290a  (reversed(out)).
-00026420: 0a0a 6465 6620 656c 656d 7769 7365 286f  ..def elemwise(o
-00026430: 702c 202a 6172 6773 2c20 6f75 743d 4e6f  p, *args, out=No
-00026440: 6e65 2c20 7768 6572 653d 5472 7565 2c20  ne, where=True, 
-00026450: 6474 7970 653d 4e6f 6e65 2c20 6e61 6d65  dtype=None, name
-00026460: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
-00026470: 3a0a 2020 2020 2222 2241 7070 6c79 2061  :.    """Apply a
-00026480: 6e20 656c 656d 656e 7477 6973 6520 7566  n elementwise uf
-00026490: 756e 632d 6c69 6b65 2066 756e 6374 696f  unc-like functio
-000264a0: 6e20 626c 6f63 6b77 6973 6520 6163 726f  n blockwise acro
-000264b0: 7373 2061 7267 756d 656e 7473 2e0a 0a20  ss arguments... 
-000264c0: 2020 204c 696b 6520 6e75 6d70 7920 7566     Like numpy uf
-000264d0: 756e 6373 2c20 6272 6f61 6463 6173 7469  uncs, broadcasti
-000264e0: 6e67 2072 756c 6573 2061 7265 2072 6573  ng rules are res
-000264f0: 7065 6374 6564 2e0a 0a20 2020 2050 6172  pected...    Par
-00026500: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00026510: 2d2d 2d2d 2d2d 0a20 2020 206f 7020 3a20  ------.    op : 
-00026520: 6361 6c6c 6162 6c65 0a20 2020 2020 2020  callable.       
-00026530: 2054 6865 2066 756e 6374 696f 6e20 746f   The function to
-00026540: 2061 7070 6c79 2e20 5368 6f75 6c64 2062   apply. Should b
-00026550: 6520 6e75 6d70 7920 7566 756e 632d 6c69  e numpy ufunc-li
-00026560: 6b65 2069 6e20 7468 6520 7061 7261 6d65  ke in the parame
-00026570: 7465 7273 0a20 2020 2020 2020 2074 6861  ters.        tha
-00026580: 7420 6974 2061 6363 6570 7473 2e0a 2020  t it accepts..  
-00026590: 2020 2a61 7267 7320 3a20 416e 790a 2020    *args : Any.  
-000265a0: 2020 2020 2020 4172 6775 6d65 6e74 7320        Arguments 
-000265b0: 746f 2070 6173 7320 746f 2060 6f70 602e  to pass to `op`.
-000265c0: 204e 6f6e 2d64 6173 6b20 6172 7261 792d   Non-dask array-
-000265d0: 6c69 6b65 206f 626a 6563 7473 2061 7265  like objects are
-000265e0: 2066 6972 7374 0a20 2020 2020 2020 2063   first.        c
-000265f0: 6f6e 7665 7274 6564 2074 6f20 6461 736b  onverted to dask
-00026600: 2061 7272 6179 732c 2074 6865 6e20 616c   arrays, then al
-00026610: 6c20 6172 7261 7973 2061 7265 2062 726f  l arrays are bro
-00026620: 6164 6361 7374 2074 6f67 6574 6865 7220  adcast together 
-00026630: 6265 666f 7265 0a20 2020 2020 2020 2061  before.        a
-00026640: 7070 6c79 696e 6720 7468 6520 6675 6e63  pplying the func
-00026650: 7469 6f6e 2062 6c6f 636b 7769 7365 2061  tion blockwise a
-00026660: 6372 6f73 7320 616c 6c20 6172 6775 6d65  cross all argume
-00026670: 6e74 732e 2041 6e79 2073 6361 6c61 720a  nts. Any scalar.
-00026680: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00026690: 7320 6172 6520 7061 7373 6564 2061 732d  s are passed as-
-000266a0: 6973 2066 6f6c 6c6f 7769 6e67 206e 6f72  is following nor
-000266b0: 6d61 6c20 6e75 6d70 7920 7566 756e 6320  mal numpy ufunc 
-000266c0: 6265 6861 7669 6f72 2e0a 2020 2020 6f75  behavior..    ou
-000266d0: 7420 3a20 6461 736b 2061 7272 6179 2c20  t : dask array, 
-000266e0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000266f0: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
-00026700: 6b2e 6172 7261 7920 7468 656e 2074 6869  k.array then thi
-00026710: 7320 6f76 6572 7772 6974 6573 2074 6865  s overwrites the
-00026720: 2063 6f6e 7465 6e74 7320 6f66 2074 6861   contents of tha
-00026730: 7420 6172 7261 790a 2020 2020 2020 2020  t array.        
-00026740: 7769 7468 2074 6865 2072 6573 756c 742e  with the result.
-00026750: 0a20 2020 2077 6865 7265 203a 2061 7272  .    where : arr
-00026760: 6179 5f6c 696b 652c 206f 7074 696f 6e61  ay_like, optiona
-00026770: 6c0a 2020 2020 2020 2020 416e 206f 7074  l.        An opt
-00026780: 696f 6e61 6c20 626f 6f6c 6561 6e20 6d61  ional boolean ma
-00026790: 736b 206d 6172 6b69 6e67 206c 6f63 6174  sk marking locat
-000267a0: 696f 6e73 2077 6865 7265 2074 6865 2075  ions where the u
-000267b0: 6675 6e63 2073 686f 756c 6420 6265 0a20  func should be. 
-000267c0: 2020 2020 2020 2061 7070 6c69 6564 2e20         applied. 
-000267d0: 4361 6e20 6265 2061 2073 6361 6c61 722c  Can be a scalar,
-000267e0: 2064 6173 6b20 6172 7261 792c 206f 7220   dask array, or 
-000267f0: 616e 7920 6f74 6865 7220 6172 7261 792d  any other array-
-00026800: 6c69 6b65 206f 626a 6563 742e 0a20 2020  like object..   
-00026810: 2020 2020 204d 6972 726f 7273 2074 6865       Mirrors the
-00026820: 2060 6077 6865 7265 6060 2061 7267 756d   ``where`` argum
-00026830: 656e 7420 746f 206e 756d 7079 2075 6675  ent to numpy ufu
-00026840: 6e63 732c 2073 6565 2065 2e67 2e20 6060  ncs, see e.g. ``
-00026850: 6e75 6d70 792e 6164 6460 600a 2020 2020  numpy.add``.    
-00026860: 2020 2020 666f 7220 6d6f 7265 2069 6e66      for more inf
-00026870: 6f72 6d61 7469 6f6e 2e0a 2020 2020 6474  ormation..    dt
-00026880: 7970 6520 3a20 6474 7970 652c 206f 7074  ype : dtype, opt
-00026890: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
-000268a0: 2070 726f 7669 6465 642c 206f 7665 7272   provided, overr
-000268b0: 6964 6573 2074 6865 206f 7574 7075 7420  ides the output 
-000268c0: 6172 7261 7920 6474 7970 652e 0a20 2020  array dtype..   
-000268d0: 206e 616d 6520 3a20 7374 722c 206f 7074   name : str, opt
-000268e0: 696f 6e61 6c0a 2020 2020 2020 2020 4120  ional.        A 
-000268f0: 756e 6971 7565 206b 6579 206e 616d 6520  unique key name 
-00026900: 746f 2075 7365 2077 6865 6e20 6275 696c  to use when buil
-00026910: 6469 6e67 2074 6865 2062 6163 6b69 6e67  ding the backing
-00026920: 2064 6173 6b20 6772 6170 682e 2049 6620   dask graph. If 
-00026930: 6e6f 740a 2020 2020 2020 2020 7072 6f76  not.        prov
-00026940: 6964 6564 2c20 6f6e 6520 7769 6c6c 2062  ided, one will b
-00026950: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
-00026960: 6765 6e65 7261 7465 6420 6261 7365 6420  generated based 
-00026970: 6f6e 2074 6865 2069 6e70 7574 0a20 2020  on the input.   
-00026980: 2020 2020 2061 7267 756d 656e 7473 2e0a       arguments..
-00026990: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-000269a0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
-000269b0: 3e3e 2065 6c65 6d77 6973 6528 6164 642c  >> elemwise(add,
-000269c0: 2078 2c20 7929 2020 2320 646f 6374 6573   x, y)  # doctes
-000269d0: 743a 202b 534b 4950 0a20 2020 203e 3e3e  t: +SKIP.    >>>
-000269e0: 2065 6c65 6d77 6973 6528 7369 6e2c 2078   elemwise(sin, x
-000269f0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-00026a00: 4b49 500a 2020 2020 3e3e 3e20 656c 656d  KIP.    >>> elem
-00026a10: 7769 7365 2873 696e 2c20 782c 206f 7574  wise(sin, x, out
-00026a20: 3d64 6173 6b5f 6172 7261 7929 2020 2320  =dask_array)  # 
-00026a30: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-00026a40: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00026a50: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 626c   --------.    bl
-00026a60: 6f63 6b77 6973 650a 2020 2020 2222 220a  ockwise.    """.
-00026a70: 2020 2020 6966 206b 7761 7267 733a 0a20      if kwargs:. 
-00026a80: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00026a90: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00026aa0: 2020 2020 6622 7b6f 702e 5f5f 6e61 6d65      f"{op.__name
-00026ab0: 5f5f 7d20 646f 6573 206e 6f74 2074 616b  __} does not tak
-00026ac0: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
-00026ad0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00026ae0: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
-00026af0: 6622 7b73 6f72 7465 6428 6b77 6172 6773  f"{sorted(kwargs
-00026b00: 297d 220a 2020 2020 2020 2020 290a 0a20  )}".        ).. 
-00026b10: 2020 206f 7574 203d 205f 656c 656d 7769     out = _elemwi
-00026b20: 7365 5f6e 6f72 6d61 6c69 7a65 5f6f 7574  se_normalize_out
-00026b30: 286f 7574 290a 2020 2020 7768 6572 6520  (out).    where 
-00026b40: 3d20 5f65 6c65 6d77 6973 655f 6e6f 726d  = _elemwise_norm
-00026b50: 616c 697a 655f 7768 6572 6528 7768 6572  alize_where(wher
-00026b60: 6529 0a20 2020 2061 7267 7320 3d20 5b6e  e).    args = [n
-00026b70: 702e 6173 6172 7261 7928 6129 2069 6620  p.asarray(a) if 
-00026b80: 6973 696e 7374 616e 6365 2861 2c20 286c  isinstance(a, (l
-00026b90: 6973 742c 2074 7570 6c65 2929 2065 6c73  ist, tuple)) els
-00026ba0: 6520 6120 666f 7220 6120 696e 2061 7267  e a for a in arg
-00026bb0: 735d 0a0a 2020 2020 7368 6170 6573 203d  s]..    shapes =
-00026bc0: 205b 5d0a 2020 2020 666f 7220 6172 6720   [].    for arg 
-00026bd0: 696e 2061 7267 733a 0a20 2020 2020 2020  in args:.       
-00026be0: 2073 6861 7065 203d 2067 6574 6174 7472   shape = getattr
-00026bf0: 2861 7267 2c20 2273 6861 7065 222c 2028  (arg, "shape", (
-00026c00: 2929 0a20 2020 2020 2020 2069 6620 616e  )).        if an
-00026c10: 7928 6973 5f64 6173 6b5f 636f 6c6c 6563  y(is_dask_collec
-00026c20: 7469 6f6e 2878 2920 666f 7220 7820 696e  tion(x) for x in
-00026c30: 2073 6861 7065 293a 0a20 2020 2020 2020   shape):.       
-00026c40: 2020 2020 2023 2057 616e 7420 746f 2065       # Want to e
-00026c50: 7863 6c75 6465 2044 656c 6179 6564 2073  xclude Delayed s
-00026c60: 6861 7065 7320 616e 6420 6464 2e53 6361  hapes and dd.Sca
-00026c70: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
-00026c80: 7368 6170 6520 3d20 2829 0a20 2020 2020  shape = ().     
-00026c90: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
-00026ca0: 2873 6861 7065 290a 2020 2020 6966 2069  (shape).    if i
-00026cb0: 7369 6e73 7461 6e63 6528 7768 6572 652c  sinstance(where,
-00026cc0: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
-00026cd0: 2073 6861 7065 732e 6170 7065 6e64 2877   shapes.append(w
-00026ce0: 6865 7265 2e73 6861 7065 290a 2020 2020  here.shape).    
-00026cf0: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
-00026d00: 742c 2041 7272 6179 293a 0a20 2020 2020  t, Array):.     
-00026d10: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
-00026d20: 286f 7574 2e73 6861 7065 290a 0a20 2020  (out.shape)..   
-00026d30: 2073 6861 7065 7320 3d20 5b73 2069 6620   shapes = [s if 
-00026d40: 6973 696e 7374 616e 6365 2873 2c20 4974  isinstance(s, It
-00026d50: 6572 6162 6c65 2920 656c 7365 2028 2920  erable) else () 
-00026d60: 666f 7220 7320 696e 2073 6861 7065 735d  for s in shapes]
-00026d70: 0a20 2020 206f 7574 5f6e 6469 6d20 3d20  .    out_ndim = 
-00026d80: 6c65 6e28 0a20 2020 2020 2020 2062 726f  len(.        bro
-00026d90: 6164 6361 7374 5f73 6861 7065 7328 2a73  adcast_shapes(*s
-00026da0: 6861 7065 7329 0a20 2020 2029 2020 2320  hapes).    )  # 
-00026db0: 5261 6973 6573 2056 616c 7565 4572 726f  Raises ValueErro
-00026dc0: 7220 6966 2064 696d 656e 7369 6f6e 7320  r if dimensions 
-00026dd0: 6d69 736d 6174 6368 0a20 2020 2065 7870  mismatch.    exp
-00026de0: 725f 696e 6473 203d 2074 7570 6c65 2872  r_inds = tuple(r
-00026df0: 616e 6765 286f 7574 5f6e 6469 6d29 295b  ange(out_ndim))[
-00026e00: 3a3a 2d31 5d0a 0a20 2020 2069 6620 6474  ::-1]..    if dt
-00026e10: 7970 6520 6973 206e 6f74 204e 6f6e 653a  ype is not None:
-00026e20: 0a20 2020 2020 2020 206e 6565 645f 656e  .        need_en
-00026e30: 666f 7263 655f 6474 7970 6520 3d20 5472  force_dtype = Tr
-00026e40: 7565 0a20 2020 2065 6c73 653a 0a20 2020  ue.    else:.   
-00026e50: 2020 2020 2023 2057 6520 666f 6c6c 6f77       # We follow
-00026e60: 204e 756d 5079 2773 2072 756c 6573 2066   NumPy's rules f
-00026e70: 6f72 2064 7479 7065 2070 726f 6d6f 7469  or dtype promoti
-00026e80: 6f6e 2c20 7768 6963 6820 7370 6563 6961  on, which specia
-00026e90: 6c20 6361 7365 730a 2020 2020 2020 2020  l cases.        
-00026ea0: 2320 7363 616c 6172 7320 616e 6420 3064  # scalars and 0d
-00026eb0: 206e 6461 7272 6179 7320 2877 6869 6368   ndarrays (which
-00026ec0: 2069 7420 636f 6e73 6964 6572 7320 6571   it considers eq
-00026ed0: 7569 7661 6c65 6e74 2920 6279 2075 7369  uivalent) by usi
-00026ee0: 6e67 0a20 2020 2020 2020 2023 2074 6865  ng.        # the
-00026ef0: 6972 2076 616c 7565 7320 746f 2063 6f6d  ir values to com
-00026f00: 7075 7465 2074 6865 2072 6573 756c 7420  pute the result 
-00026f10: 6474 7970 653a 0a20 2020 2020 2020 2023  dtype:.        #
-00026f20: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00026f30: 636f 6d2f 6e75 6d70 792f 6e75 6d70 792f  com/numpy/numpy/
-00026f40: 6973 7375 6573 2f36 3234 300a 2020 2020  issues/6240.    
-00026f50: 2020 2020 2320 5765 2064 6f6e 2774 2069      # We don't i
-00026f60: 6e73 7065 6374 2074 6865 2076 616c 7565  nspect the value
-00026f70: 7320 6f66 2030 6420 6461 736b 2061 7272  s of 0d dask arr
-00026f80: 6179 732c 2062 6563 6175 7365 2074 6865  ays, because the
-00026f90: 7365 2063 6f75 6c64 0a20 2020 2020 2020  se could.       
-00026fa0: 2023 2068 6f6c 6420 706f 7465 6e74 6961   # hold potentia
-00026fb0: 6c6c 7920 7665 7279 2065 7870 656e 7369  lly very expensi
-00026fc0: 7665 2063 616c 6375 6c61 7469 6f6e 732e  ve calculations.
-00026fd0: 2049 6e73 7465 6164 2c20 7765 2074 7265   Instead, we tre
-00026fe0: 6174 0a20 2020 2020 2020 2023 2074 6865  at.        # the
-00026ff0: 6d20 6a75 7374 206c 696b 6520 6f74 6865  m just like othe
-00027000: 7220 6172 7261 7973 2c20 616e 6420 6966  r arrays, and if
-00027010: 206e 6563 6573 7361 7279 2063 6173 7420   necessary cast 
-00027020: 7468 6520 7265 7375 6c74 206f 6620 6f70  the result of op
-00027030: 0a20 2020 2020 2020 2023 2074 6f20 6d61  .        # to ma
-00027040: 7463 682e 0a20 2020 2020 2020 2076 616c  tch..        val
-00027050: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-00027060: 2020 6e70 2e65 6d70 7479 2828 312c 2920    np.empty((1,) 
-00027070: 2a20 6d61 7828 312c 2061 2e6e 6469 6d29  * max(1, a.ndim)
-00027080: 2c20 6474 7970 653d 612e 6474 7970 6529  , dtype=a.dtype)
-00027090: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000270a0: 6e6f 7420 6973 5f73 6361 6c61 725f 666f  not is_scalar_fo
-000270b0: 725f 656c 656d 7769 7365 2861 290a 2020  r_elemwise(a).  
-000270c0: 2020 2020 2020 2020 2020 656c 7365 2061            else a
-000270d0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000270e0: 2061 2069 6e20 6172 6773 0a20 2020 2020   a in args.     
-000270f0: 2020 205d 0a20 2020 2020 2020 2074 7279     ].        try
-00027100: 3a0a 2020 2020 2020 2020 2020 2020 6474  :.            dt
-00027110: 7970 6520 3d20 6170 706c 795f 696e 6665  ype = apply_infe
-00027120: 725f 6474 7970 6528 6f70 2c20 7661 6c73  r_dtype(op, vals
-00027130: 2c20 7b7d 2c20 2265 6c65 6d77 6973 6522  , {}, "elemwise"
-00027140: 2c20 7375 6767 6573 745f 6474 7970 653d  , suggest_dtype=
-00027150: 4661 6c73 6529 0a20 2020 2020 2020 2065  False).        e
-00027160: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
-00027170: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00027180: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-00027190: 6564 0a20 2020 2020 2020 206e 6565 645f  ed.        need_
-000271a0: 656e 666f 7263 655f 6474 7970 6520 3d20  enforce_dtype = 
-000271b0: 616e 7928 0a20 2020 2020 2020 2020 2020  any(.           
-000271c0: 206e 6f74 2069 735f 7363 616c 6172 5f66   not is_scalar_f
-000271d0: 6f72 5f65 6c65 6d77 6973 6528 6129 2061  or_elemwise(a) a
-000271e0: 6e64 2061 2e6e 6469 6d20 3d3d 2030 2066  nd a.ndim == 0 f
-000271f0: 6f72 2061 2069 6e20 6172 6773 0a20 2020  or a in args.   
-00027200: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
-00027210: 6f74 206e 616d 653a 0a20 2020 2020 2020  ot name:.       
-00027220: 206e 616d 6520 3d20 6622 7b66 756e 636e   name = f"{funcn
-00027230: 616d 6528 6f70 297d 2d7b 746f 6b65 6e69  ame(op)}-{tokeni
-00027240: 7a65 286f 702c 2064 7479 7065 2c20 2a61  ze(op, dtype, *a
-00027250: 7267 732c 2077 6865 7265 297d 220a 0a20  rgs, where)}".. 
-00027260: 2020 2062 6c6f 636b 7769 7365 5f6b 7761     blockwise_kwa
-00027270: 7267 7320 3d20 6469 6374 2864 7479 7065  rgs = dict(dtype
-00027280: 3d64 7479 7065 2c20 6e61 6d65 3d6e 616d  =dtype, name=nam
-00027290: 652c 2074 6f6b 656e 3d66 756e 636e 616d  e, token=funcnam
-000272a0: 6528 6f70 292e 7374 7269 7028 225f 2229  e(op).strip("_")
-000272b0: 290a 0a20 2020 2069 6620 7768 6572 6520  )..    if where 
-000272c0: 6973 206e 6f74 2054 7275 653a 0a20 2020  is not True:.   
-000272d0: 2020 2020 2062 6c6f 636b 7769 7365 5f6b       blockwise_k
-000272e0: 7761 7267 735b 2265 6c65 6d77 6973 655f  wargs["elemwise_
-000272f0: 7768 6572 655f 6675 6e63 7469 6f6e 225d  where_function"]
-00027300: 203d 206f 700a 2020 2020 2020 2020 6f70   = op.        op
-00027310: 203d 205f 656c 656d 7769 7365 5f68 616e   = _elemwise_han
-00027320: 646c 655f 7768 6572 650a 2020 2020 2020  dle_where.      
-00027330: 2020 6172 6773 2e65 7874 656e 6428 5b77    args.extend([w
-00027340: 6865 7265 2c20 6f75 745d 290a 0a20 2020  here, out])..   
-00027350: 2069 6620 6e65 6564 5f65 6e66 6f72 6365   if need_enforce
-00027360: 5f64 7479 7065 3a0a 2020 2020 2020 2020  _dtype:.        
-00027370: 626c 6f63 6b77 6973 655f 6b77 6172 6773  blockwise_kwargs
-00027380: 5b22 656e 666f 7263 655f 6474 7970 6522  ["enforce_dtype"
-00027390: 5d20 3d20 6474 7970 650a 2020 2020 2020  ] = dtype.      
-000273a0: 2020 626c 6f63 6b77 6973 655f 6b77 6172    blockwise_kwar
-000273b0: 6773 5b22 656e 666f 7263 655f 6474 7970  gs["enforce_dtyp
-000273c0: 655f 6675 6e63 7469 6f6e 225d 203d 206f  e_function"] = o
-000273d0: 700a 2020 2020 2020 2020 6f70 203d 205f  p.        op = _
-000273e0: 656e 666f 7263 655f 6474 7970 650a 0a20  enforce_dtype.. 
-000273f0: 2020 2072 6573 756c 7420 3d20 626c 6f63     result = bloc
-00027400: 6b77 6973 6528 0a20 2020 2020 2020 206f  kwise(.        o
-00027410: 702c 0a20 2020 2020 2020 2065 7870 725f  p,.        expr_
-00027420: 696e 6473 2c0a 2020 2020 2020 2020 2a63  inds,.        *c
-00027430: 6f6e 6361 7428 0a20 2020 2020 2020 2020  oncat(.         
-00027440: 2020 2028 612c 2074 7570 6c65 2872 616e     (a, tuple(ran
-00027450: 6765 2861 2e6e 6469 6d29 5b3a 3a2d 315d  ge(a.ndim)[::-1]
-00027460: 2920 6966 206e 6f74 2069 735f 7363 616c  ) if not is_scal
-00027470: 6172 5f66 6f72 5f65 6c65 6d77 6973 6528  ar_for_elemwise(
-00027480: 6129 2065 6c73 6520 4e6f 6e65 290a 2020  a) else None).  
-00027490: 2020 2020 2020 2020 2020 666f 7220 6120            for a 
-000274a0: 696e 2061 7267 730a 2020 2020 2020 2020  in args.        
-000274b0: 292c 0a20 2020 2020 2020 202a 2a62 6c6f  ),.        **blo
-000274c0: 636b 7769 7365 5f6b 7761 7267 732c 0a20  ckwise_kwargs,. 
-000274d0: 2020 2029 0a0a 2020 2020 7265 7475 726e     )..    return
-000274e0: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
-000274f0: 2072 6573 756c 7429 0a0a 0a64 6566 205f   result)...def _
-00027500: 656c 656d 7769 7365 5f6e 6f72 6d61 6c69  elemwise_normali
-00027510: 7a65 5f77 6865 7265 2877 6865 7265 293a  ze_where(where):
-00027520: 0a20 2020 2069 6620 7768 6572 6520 6973  .    if where is
-00027530: 2054 7275 653a 0a20 2020 2020 2020 2072   True:.        r
-00027540: 6574 7572 6e20 5472 7565 0a20 2020 2065  eturn True.    e
-00027550: 6c69 6620 7768 6572 6520 6973 2046 616c  lif where is Fal
-00027560: 7365 206f 7220 7768 6572 6520 6973 204e  se or where is N
-00027570: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
-00027580: 7572 6e20 4661 6c73 650a 2020 2020 7265  urn False.    re
-00027590: 7475 726e 2061 7361 7272 6179 2877 6865  turn asarray(whe
-000275a0: 7265 290a 0a0a 6465 6620 5f65 6c65 6d77  re)...def _elemw
-000275b0: 6973 655f 6861 6e64 6c65 5f77 6865 7265  ise_handle_where
-000275c0: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
-000275d0: 293a 0a20 2020 2066 756e 6374 696f 6e20  ):.    function 
-000275e0: 3d20 6b77 6172 6773 2e70 6f70 2822 656c  = kwargs.pop("el
-000275f0: 656d 7769 7365 5f77 6865 7265 5f66 756e  emwise_where_fun
-00027600: 6374 696f 6e22 290a 2020 2020 2a61 7267  ction").    *arg
-00027610: 732c 2077 6865 7265 2c20 6f75 7420 3d20  s, where, out = 
-00027620: 6172 6773 0a20 2020 2069 6620 6861 7361  args.    if hasa
-00027630: 7474 7228 6f75 742c 2022 636f 7079 2229  ttr(out, "copy")
-00027640: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
-00027650: 6f75 742e 636f 7079 2829 0a20 2020 2072  out.copy().    r
-00027660: 6574 7572 6e20 6675 6e63 7469 6f6e 282a  eturn function(*
-00027670: 6172 6773 2c20 7768 6572 653d 7768 6572  args, where=wher
-00027680: 652c 206f 7574 3d6f 7574 2c20 2a2a 6b77  e, out=out, **kw
-00027690: 6172 6773 290a 0a0a 6465 6620 5f65 6c65  args)...def _ele
-000276a0: 6d77 6973 655f 6e6f 726d 616c 697a 655f  mwise_normalize_
-000276b0: 6f75 7428 6f75 7429 3a0a 2020 2020 6966  out(out):.    if
-000276c0: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
-000276d0: 2074 7570 6c65 293a 0a20 2020 2020 2020   tuple):.       
-000276e0: 2069 6620 6c65 6e28 6f75 7429 203d 3d20   if len(out) == 
-000276f0: 313a 0a20 2020 2020 2020 2020 2020 206f  1:.            o
-00027700: 7574 203d 206f 7574 5b30 5d0a 2020 2020  ut = out[0].    
-00027710: 2020 2020 656c 6966 206c 656e 286f 7574      elif len(out
-00027720: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
-00027730: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00027740: 656d 656e 7465 6445 7272 6f72 2822 5468  ementedError("Th
-00027750: 6520 6f75 7420 7061 7261 6d65 7465 7220  e out parameter 
-00027760: 6973 206e 6f74 2066 756c 6c79 2073 7570  is not fully sup
-00027770: 706f 7274 6564 2229 0a20 2020 2020 2020  ported").       
-00027780: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00027790: 2020 206f 7574 203d 204e 6f6e 650a 2020     out = None.  
-000277a0: 2020 6966 206e 6f74 2028 6f75 7420 6973    if not (out is
-000277b0: 204e 6f6e 6520 6f72 2069 7369 6e73 7461   None or isinsta
-000277c0: 6e63 6528 6f75 742c 2041 7272 6179 2929  nce(out, Array))
-000277d0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-000277e0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-000277f0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00027800: 2066 2254 6865 206f 7574 2070 6172 616d   f"The out param
-00027810: 6574 6572 2069 7320 6e6f 7420 6675 6c6c  eter is not full
-00027820: 7920 7375 7070 6f72 7465 642e 220a 2020  y supported.".  
-00027830: 2020 2020 2020 2020 2020 6622 2052 6563            f" Rec
-00027840: 6569 7665 6420 7479 7065 207b 7479 7065  eived type {type
-00027850: 286f 7574 292e 5f5f 6e61 6d65 5f5f 7d2c  (out).__name__},
-00027860: 2065 7870 6563 7465 6420 4461 736b 2041   expected Dask A
-00027870: 7272 6179 220a 2020 2020 2020 2020 290a  rray".        ).
-00027880: 2020 2020 7265 7475 726e 206f 7574 0a0a      return out..
-00027890: 0a64 6566 2068 616e 646c 655f 6f75 7428  .def handle_out(
-000278a0: 6f75 742c 2072 6573 756c 7429 3a0a 2020  out, result):.  
-000278b0: 2020 2222 2248 616e 646c 6520 6f75 7420    """Handle out 
-000278c0: 7061 7261 6d65 7465 7273 0a0a 2020 2020  parameters..    
-000278d0: 4966 206f 7574 2069 7320 6120 6461 736b  If out is a dask
-000278e0: 2e61 7272 6179 2074 6865 6e20 7468 6973  .array then this
-000278f0: 206f 7665 7277 7269 7465 7320 7468 6520   overwrites the 
-00027900: 636f 6e74 656e 7473 206f 6620 7468 6174  contents of that
-00027910: 2061 7272 6179 2077 6974 680a 2020 2020   array with.    
-00027920: 7468 6520 7265 7375 6c74 0a20 2020 2022  the result.    "
-00027930: 2222 0a20 2020 206f 7574 203d 205f 656c  "".    out = _el
-00027940: 656d 7769 7365 5f6e 6f72 6d61 6c69 7a65  emwise_normalize
-00027950: 5f6f 7574 286f 7574 290a 2020 2020 6966  _out(out).    if
-00027960: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
-00027970: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
-00027980: 2069 6620 6f75 742e 7368 6170 6520 213d   if out.shape !=
-00027990: 2072 6573 756c 742e 7368 6170 653a 0a20   result.shape:. 
-000279a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000279b0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-000279c0: 2020 2020 2020 2020 2020 2020 2022 4d69               "Mi
-000279d0: 736d 6174 6368 6564 2073 6861 7065 7320  smatched shapes 
-000279e0: 6265 7477 6565 6e20 7265 7375 6c74 2061  between result a
-000279f0: 6e64 206f 7574 2070 6172 616d 6574 6572  nd out parameter
-00027a00: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00027a10: 2020 2020 226f 7574 3d25 732c 2072 6573      "out=%s, res
-00027a20: 756c 743d 2573 2220 2520 2873 7472 286f  ult=%s" % (str(o
-00027a30: 7574 2e73 6861 7065 292c 2073 7472 2872  ut.shape), str(r
-00027a40: 6573 756c 742e 7368 6170 6529 290a 2020  esult.shape)).  
-00027a50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00027a60: 2020 2020 6f75 742e 5f63 6875 6e6b 7320      out._chunks 
-00027a70: 3d20 7265 7375 6c74 2e63 6875 6e6b 730a  = result.chunks.
-00027a80: 2020 2020 2020 2020 6f75 742e 6461 736b          out.dask
-00027a90: 203d 2072 6573 756c 742e 6461 736b 0a20   = result.dask. 
-00027aa0: 2020 2020 2020 206f 7574 2e5f 6d65 7461         out._meta
-00027ab0: 203d 2072 6573 756c 742e 5f6d 6574 610a   = result._meta.
-00027ac0: 2020 2020 2020 2020 6f75 742e 5f6e 616d          out._nam
-00027ad0: 6520 3d20 7265 7375 6c74 2e6e 616d 650a  e = result.name.
-00027ae0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
-00027af0: 7574 0a20 2020 2065 6c73 653a 0a20 2020  ut.    else:.   
-00027b00: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-00027b10: 6c74 0a0a 0a64 6566 205f 656e 666f 7263  lt...def _enforc
-00027b20: 655f 6474 7970 6528 2a61 7267 732c 202a  e_dtype(*args, *
-00027b30: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
-00027b40: 2243 616c 6c73 2061 2066 756e 6374 696f  "Calls a functio
-00027b50: 6e20 616e 6420 636f 6e76 6572 7473 2069  n and converts i
-00027b60: 7473 2072 6573 756c 7420 746f 2074 6865  ts result to the
-00027b70: 2067 6976 656e 2064 7479 7065 2e0a 0a20   given dtype... 
-00027b80: 2020 2054 6865 2070 6172 616d 6574 6572     The parameter
-00027b90: 7320 6861 7665 2064 656c 6962 6572 6174  s have deliberat
-00027ba0: 656c 7920 6265 656e 2067 6976 656e 2075  ely been given u
-00027bb0: 6e77 6965 6c64 7920 6e61 6d65 7320 746f  nwieldy names to
-00027bc0: 2061 766f 6964 0a20 2020 2063 6c61 7368   avoid.    clash
-00027bd0: 6573 2077 6974 6820 6b65 7977 6f72 6420  es with keyword 
-00027be0: 6172 6775 6d65 6e74 7320 636f 6e73 756d  arguments consum
-00027bf0: 6564 2062 7920 626c 6f63 6b77 6973 650a  ed by blockwise.
-00027c00: 0a20 2020 2041 2064 7479 7065 206f 6620  .    A dtype of 
-00027c10: 606f 626a 6563 7460 2069 7320 7472 6561  `object` is trea
-00027c20: 7465 6420 6173 2061 2073 7065 6369 616c  ted as a special
-00027c30: 2063 6173 6520 616e 6420 6e6f 7420 656e   case and not en
-00027c40: 666f 7263 6564 2c0a 2020 2020 6265 6361  forced,.    beca
-00027c50: 7573 6520 6974 2069 7320 7573 6564 2061  use it is used a
-00027c60: 7320 6120 6475 6d6d 7920 7661 6c75 6520  s a dummy value 
-00027c70: 696e 2073 6f6d 6520 706c 6163 6573 2077  in some places w
-00027c80: 6865 6e20 7468 6520 7265 7375 6c74 2077  hen the result w
-00027c90: 696c 6c0a 2020 2020 6e6f 7420 6265 2061  ill.    not be a
-00027ca0: 2062 6c6f 636b 2069 6e20 616e 2041 7272   block in an Arr
-00027cb0: 6179 2e0a 0a20 2020 2050 6172 616d 6574  ay...    Paramet
-00027cc0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00027cd0: 2d2d 0a20 2020 2065 6e66 6f72 6365 5f64  --.    enforce_d
-00027ce0: 7479 7065 203a 2064 7479 7065 0a20 2020  type : dtype.   
-00027cf0: 2020 2020 2052 6573 756c 7420 6474 7970       Result dtyp
-00027d00: 650a 2020 2020 656e 666f 7263 655f 6474  e.    enforce_dt
-00027d10: 7970 655f 6675 6e63 7469 6f6e 203a 2063  ype_function : c
-00027d20: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00027d30: 5468 6520 7772 6170 7065 6420 6675 6e63  The wrapped func
-00027d40: 7469 6f6e 2c20 7768 6963 6820 7769 6c6c  tion, which will
-00027d50: 2062 6520 7061 7373 6564 2074 6865 2072   be passed the r
-00027d60: 656d 6169 6e69 6e67 2061 7267 756d 656e  emaining argumen
-00027d70: 7473 0a20 2020 2022 2222 0a20 2020 2064  ts.    """.    d
-00027d80: 7479 7065 203d 206b 7761 7267 732e 706f  type = kwargs.po
-00027d90: 7028 2265 6e66 6f72 6365 5f64 7479 7065  p("enforce_dtype
-00027da0: 2229 0a20 2020 2066 756e 6374 696f 6e20  ").    function 
-00027db0: 3d20 6b77 6172 6773 2e70 6f70 2822 656e  = kwargs.pop("en
-00027dc0: 666f 7263 655f 6474 7970 655f 6675 6e63  force_dtype_func
-00027dd0: 7469 6f6e 2229 0a0a 2020 2020 7265 7375  tion")..    resu
-00027de0: 6c74 203d 2066 756e 6374 696f 6e28 2a61  lt = function(*a
-00027df0: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
-00027e00: 2020 2069 6620 6861 7361 7474 7228 7265     if hasattr(re
-00027e10: 7375 6c74 2c20 2264 7479 7065 2229 2061  sult, "dtype") a
-00027e20: 6e64 2064 7479 7065 2021 3d20 7265 7375  nd dtype != resu
-00027e30: 6c74 2e64 7479 7065 2061 6e64 2064 7479  lt.dtype and dty
-00027e40: 7065 2021 3d20 6f62 6a65 6374 3a0a 2020  pe != object:.  
-00027e50: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-00027e60: 6361 6e5f 6361 7374 2872 6573 756c 742c  can_cast(result,
-00027e70: 2064 7479 7065 2c20 6361 7374 696e 673d   dtype, casting=
-00027e80: 2273 616d 655f 6b69 6e64 2229 3a0a 2020  "same_kind"):.  
-00027e90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00027ea0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00027eb0: 2020 2020 2020 2020 2020 2020 2249 6e66              "Inf
-00027ec0: 6572 7265 6420 6474 7970 6520 6672 6f6d  erred dtype from
-00027ed0: 2066 756e 6374 696f 6e20 2572 2077 6173   function %r was
-00027ee0: 2025 7220 220a 2020 2020 2020 2020 2020   %r ".          
-00027ef0: 2020 2020 2020 2262 7574 2067 6f74 2025        "but got %
-00027f00: 722c 2077 6869 6368 2063 616e 2774 2062  r, which can't b
-00027f10: 6520 6361 7374 2075 7369 6e67 2022 0a20  e cast using ". 
-00027f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00027f30: 6361 7374 696e 673d 2773 616d 655f 6b69  casting='same_ki
-00027f40: 6e64 2722 0a20 2020 2020 2020 2020 2020  nd'".           
-00027f50: 2020 2020 2025 2028 6675 6e63 6e61 6d65       % (funcname
-00027f60: 2866 756e 6374 696f 6e29 2c20 7374 7228  (function), str(
-00027f70: 6474 7970 6529 2c20 7374 7228 7265 7375  dtype), str(resu
-00027f80: 6c74 2e64 7479 7065 2929 0a20 2020 2020  lt.dtype)).     
-00027f90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00027fa0: 2069 6620 6e70 2e69 7373 6361 6c61 7228   if np.isscalar(
-00027fb0: 7265 7375 6c74 293a 0a20 2020 2020 2020  result):.       
-00027fc0: 2020 2020 2023 2073 6361 6c61 7220 6173       # scalar as
-00027fd0: 7479 7065 206d 6574 686f 6420 646f 6573  type method does
-00027fe0: 6e27 7420 7461 6b65 2074 6865 206b 6579  n't take the key
-00027ff0: 776f 7264 2061 7267 756d 656e 7473 2c20  word arguments, 
-00028000: 736f 0a20 2020 2020 2020 2020 2020 2023  so.            #
-00028010: 2068 6176 6520 746f 2063 6f6e 7665 7274   have to convert
-00028020: 2076 6961 2030 2d64 696d 656e 7369 6f6e   via 0-dimension
-00028030: 616c 2061 7272 6179 2061 6e64 2062 6163  al array and bac
-00028040: 6b2e 0a20 2020 2020 2020 2020 2020 2072  k..            r
-00028050: 6573 756c 7420 3d20 7265 7375 6c74 2e61  esult = result.a
-00028060: 7374 7970 6528 6474 7970 6529 0a20 2020  stype(dtype).   
-00028070: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00028080: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00028090: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000280a0: 6c74 203d 2072 6573 756c 742e 6173 7479  lt = result.asty
-000280b0: 7065 2864 7479 7065 2c20 636f 7079 3d46  pe(dtype, copy=F
-000280c0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-000280d0: 2020 6578 6365 7074 2054 7970 6545 7272    except TypeErr
-000280e0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-000280f0: 2020 2020 2320 4d69 7373 696e 6720 636f      # Missing co
-00028100: 7079 206b 7761 7267 0a20 2020 2020 2020  py kwarg.       
-00028110: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00028120: 3d20 7265 7375 6c74 2e61 7374 7970 6528  = result.astype(
-00028130: 6474 7970 6529 0a20 2020 2072 6574 7572  dtype).    retur
-00028140: 6e20 7265 7375 6c74 0a0a 0a64 6566 2062  n result...def b
-00028150: 726f 6164 6361 7374 5f74 6f28 782c 2073  roadcast_to(x, s
-00028160: 6861 7065 2c20 6368 756e 6b73 3d4e 6f6e  hape, chunks=Non
-00028170: 652c 206d 6574 613d 4e6f 6e65 293a 0a20  e, meta=None):. 
-00028180: 2020 2022 2222 4272 6f61 6463 6173 7420     """Broadcast 
-00028190: 616e 2061 7272 6179 2074 6f20 6120 6e65  an array to a ne
-000281a0: 7720 7368 6170 652e 0a0a 2020 2020 5061  w shape...    Pa
-000281b0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-000281c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 7820 3a20  -------.    x : 
-000281d0: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
-000281e0: 2020 2054 6865 2061 7272 6179 2074 6f20     The array to 
-000281f0: 6272 6f61 6463 6173 742e 0a20 2020 2073  broadcast..    s
-00028200: 6861 7065 203a 2074 7570 6c65 0a20 2020  hape : tuple.   
-00028210: 2020 2020 2054 6865 2073 6861 7065 206f       The shape o
-00028220: 6620 7468 6520 6465 7369 7265 6420 6172  f the desired ar
-00028230: 7261 792e 0a20 2020 2063 6875 6e6b 7320  ray..    chunks 
-00028240: 3a20 7475 706c 652c 206f 7074 696f 6e61  : tuple, optiona
-00028250: 6c0a 2020 2020 2020 2020 4966 2070 726f  l.        If pro
-00028260: 7669 6465 642c 2074 6865 6e20 7468 6520  vided, then the 
-00028270: 7265 7375 6c74 2077 696c 6c20 7573 6520  result will use 
-00028280: 7468 6573 6520 6368 756e 6b73 2069 6e73  these chunks ins
-00028290: 7465 6164 206f 6620 7468 6520 7361 6d65  tead of the same
-000282a0: 0a20 2020 2020 2020 2063 6875 6e6b 7320  .        chunks 
-000282b0: 6173 2074 6865 2073 6f75 7263 6520 6172  as the source ar
-000282c0: 7261 792e 2053 6574 7469 6e67 2063 6875  ray. Setting chu
-000282d0: 6e6b 7320 6578 706c 6963 6974 6c79 2061  nks explicitly a
-000282e0: 7320 7061 7274 206f 660a 2020 2020 2020  s part of.      
-000282f0: 2020 6272 6f61 6463 6173 745f 746f 2069    broadcast_to i
-00028300: 7320 6d6f 7265 2065 6666 6963 6965 6e74  s more efficient
-00028310: 2074 6861 6e20 7265 6368 756e 6b69 6e67   than rechunking
-00028320: 2061 6674 6572 7761 7264 732e 2043 6875   afterwards. Chu
-00028330: 6e6b 7320 6172 650a 2020 2020 2020 2020  nks are.        
-00028340: 6f6e 6c79 2061 6c6c 6f77 6564 2074 6f20  only allowed to 
-00028350: 6469 6666 6572 2066 726f 6d20 7468 6520  differ from the 
-00028360: 6f72 6967 696e 616c 2073 6861 7065 2061  original shape a
-00028370: 6c6f 6e67 2064 696d 656e 7369 6f6e 7320  long dimensions 
-00028380: 7468 6174 0a20 2020 2020 2020 2061 7265  that.        are
-00028390: 206e 6577 206f 6e20 7468 6520 7265 7375   new on the resu
-000283a0: 6c74 206f 7220 6861 7665 2073 697a 6520  lt or have size 
-000283b0: 3120 7468 6520 696e 7075 7420 6172 7261  1 the input arra
-000283c0: 792e 0a20 2020 206d 6574 6120 3a20 656d  y..    meta : em
-000283d0: 7074 7920 6e64 6172 7261 790a 2020 2020  pty ndarray.    
-000283e0: 2020 2020 656d 7074 7920 6e64 6172 7261      empty ndarra
-000283f0: 7920 6372 6561 7465 6420 7769 7468 2073  y created with s
-00028400: 616d 6520 4e75 6d50 7920 6261 636b 656e  ame NumPy backen
-00028410: 642c 206e 6469 6d20 616e 6420 6474 7970  d, ndim and dtyp
-00028420: 6520 6173 2074 6865 0a20 2020 2020 2020  e as the.       
-00028430: 2044 6173 6b20 4172 7261 7920 6265 696e   Dask Array bein
-00028440: 6720 6372 6561 7465 6420 286f 7665 7272  g created (overr
-00028450: 6964 6573 2064 7479 7065 290a 0a20 2020  ides dtype)..   
-00028460: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00028470: 2d2d 2d2d 0a20 2020 2062 726f 6164 6361  ----.    broadca
-00028480: 7374 203a 2064 6173 6b20 6172 7261 790a  st : dask array.
-00028490: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-000284a0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203a    --------.    :
-000284b0: 6675 6e63 3a60 6e75 6d70 792e 6272 6f61  func:`numpy.broa
-000284c0: 6463 6173 745f 746f 600a 2020 2020 2222  dcast_to`.    ""
-000284d0: 220a 2020 2020 7820 3d20 6173 6172 7261  ".    x = asarra
-000284e0: 7928 7829 0a20 2020 2073 6861 7065 203d  y(x).    shape =
-000284f0: 2074 7570 6c65 2873 6861 7065 290a 0a20   tuple(shape).. 
-00028500: 2020 2069 6620 6d65 7461 2069 7320 4e6f     if meta is No
-00028510: 6e65 3a0a 2020 2020 2020 2020 6d65 7461  ne:.        meta
-00028520: 203d 206d 6574 615f 6672 6f6d 5f61 7272   = meta_from_arr
-00028530: 6179 2878 290a 0a20 2020 2069 6620 782e  ay(x)..    if x.
-00028540: 7368 6170 6520 3d3d 2073 6861 7065 2061  shape == shape a
-00028550: 6e64 2028 6368 756e 6b73 2069 7320 4e6f  nd (chunks is No
-00028560: 6e65 206f 7220 6368 756e 6b73 203d 3d20  ne or chunks == 
-00028570: 782e 6368 756e 6b73 293a 0a20 2020 2020  x.chunks):.     
-00028580: 2020 2072 6574 7572 6e20 780a 0a20 2020     return x..   
-00028590: 206e 6469 6d5f 6e65 7720 3d20 6c65 6e28   ndim_new = len(
-000285a0: 7368 6170 6529 202d 2078 2e6e 6469 6d0a  shape) - x.ndim.
-000285b0: 2020 2020 6966 206e 6469 6d5f 6e65 7720      if ndim_new 
-000285c0: 3c20 3020 6f72 2061 6e79 280a 2020 2020  < 0 or any(.    
-000285d0: 2020 2020 6e65 7720 213d 206f 6c64 2066      new != old f
-000285e0: 6f72 206e 6577 2c20 6f6c 6420 696e 207a  or new, old in z
-000285f0: 6970 2873 6861 7065 5b6e 6469 6d5f 6e65  ip(shape[ndim_ne
-00028600: 773a 5d2c 2078 2e73 6861 7065 2920 6966  w:], x.shape) if
-00028610: 206f 6c64 2021 3d20 310a 2020 2020 293a   old != 1.    ):
-00028620: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-00028630: 616c 7565 4572 726f 7228 6622 6361 6e6e  alueError(f"cann
-00028640: 6f74 2062 726f 6164 6361 7374 2073 6861  ot broadcast sha
-00028650: 7065 207b 782e 7368 6170 657d 2074 6f20  pe {x.shape} to 
-00028660: 7368 6170 6520 7b73 6861 7065 7d22 290a  shape {shape}").
-00028670: 0a20 2020 2069 6620 6368 756e 6b73 2069  .    if chunks i
-00028680: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00028690: 6368 756e 6b73 203d 2074 7570 6c65 2828  chunks = tuple((
-000286a0: 732c 2920 666f 7220 7320 696e 2073 6861  s,) for s in sha
-000286b0: 7065 5b3a 6e64 696d 5f6e 6577 5d29 202b  pe[:ndim_new]) +
-000286c0: 2074 7570 6c65 280a 2020 2020 2020 2020   tuple(.        
-000286d0: 2020 2020 6264 2069 6620 6f6c 6420 3e20      bd if old > 
-000286e0: 3120 656c 7365 2028 6e65 772c 290a 2020  1 else (new,).  
-000286f0: 2020 2020 2020 2020 2020 666f 7220 6264            for bd
-00028700: 2c20 6f6c 642c 206e 6577 2069 6e20 7a69  , old, new in zi
-00028710: 7028 782e 6368 756e 6b73 2c20 782e 7368  p(x.chunks, x.sh
-00028720: 6170 652c 2073 6861 7065 5b6e 6469 6d5f  ape, shape[ndim_
-00028730: 6e65 773a 5d29 0a20 2020 2020 2020 2029  new:]).        )
-00028740: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00028750: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
-00028760: 616c 697a 655f 6368 756e 6b73 280a 2020  alize_chunks(.  
-00028770: 2020 2020 2020 2020 2020 6368 756e 6b73            chunks
-00028780: 2c20 7368 6170 652c 2064 7479 7065 3d78  , shape, dtype=x
-00028790: 2e64 7479 7065 2c20 7072 6576 696f 7573  .dtype, previous
-000287a0: 5f63 6875 6e6b 733d 782e 6368 756e 6b73  _chunks=x.chunks
-000287b0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000287c0: 2020 2066 6f72 206f 6c64 5f62 642c 206e     for old_bd, n
-000287d0: 6577 5f62 6420 696e 207a 6970 2878 2e63  ew_bd in zip(x.c
-000287e0: 6875 6e6b 732c 2063 6875 6e6b 735b 6e64  hunks, chunks[nd
-000287f0: 696d 5f6e 6577 3a5d 293a 0a20 2020 2020  im_new:]):.     
-00028800: 2020 2020 2020 2069 6620 6f6c 645f 6264         if old_bd
-00028810: 2021 3d20 6e65 775f 6264 2061 6e64 206f   != new_bd and o
-00028820: 6c64 5f62 6420 213d 2028 312c 293a 0a20  ld_bd != (1,):. 
-00028830: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00028840: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00028850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028860: 2020 2020 2022 6361 6e6e 6f74 2062 726f       "cannot bro
-00028870: 6164 6361 7374 2063 6875 6e6b 7320 2573  adcast chunks %s
-00028880: 2074 6f20 6368 756e 6b73 2025 733a 2022   to chunks %s: "
-00028890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000288a0: 2020 2020 2022 6e65 7720 6368 756e 6b73       "new chunks
-000288b0: 206d 7573 7420 6569 7468 6572 2062 6520   must either be 
-000288c0: 616c 6f6e 6720 6120 6e65 7720 220a 2020  along a new ".  
-000288d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288e0: 2020 2264 696d 656e 7369 6f6e 206f 7220    "dimension or 
-000288f0: 6120 6469 6d65 6e73 696f 6e20 6f66 2073  a dimension of s
-00028900: 697a 6520 3122 2025 2028 782e 6368 756e  ize 1" % (x.chun
-00028910: 6b73 2c20 6368 756e 6b73 290a 2020 2020  ks, chunks).    
-00028920: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00028930: 2020 206e 616d 6520 3d20 2262 726f 6164     name = "broad
-00028940: 6361 7374 5f74 6f2d 2220 2b20 746f 6b65  cast_to-" + toke
-00028950: 6e69 7a65 2878 2c20 7368 6170 652c 2063  nize(x, shape, c
-00028960: 6875 6e6b 7329 0a20 2020 2064 736b 203d  hunks).    dsk =
-00028970: 207b 7d0a 0a20 2020 2065 6e75 6d65 7261   {}..    enumera
-00028980: 7465 645f 6368 756e 6b73 203d 2070 726f  ted_chunks = pro
-00028990: 6475 6374 282a 2865 6e75 6d65 7261 7465  duct(*(enumerate
-000289a0: 2862 6473 2920 666f 7220 6264 7320 696e  (bds) for bds in
-000289b0: 2063 6875 6e6b 7329 290a 2020 2020 666f   chunks)).    fo
-000289c0: 7220 6e65 775f 696e 6465 782c 2063 6875  r new_index, chu
-000289d0: 6e6b 5f73 6861 7065 2069 6e20 287a 6970  nk_shape in (zip
-000289e0: 282a 6563 2920 666f 7220 6563 2069 6e20  (*ec) for ec in 
-000289f0: 656e 756d 6572 6174 6564 5f63 6875 6e6b  enumerated_chunk
-00028a00: 7329 3a0a 2020 2020 2020 2020 6f6c 645f  s):.        old_
-00028a10: 696e 6465 7820 3d20 7475 706c 6528 0a20  index = tuple(. 
-00028a20: 2020 2020 2020 2020 2020 2030 2069 6620             0 if 
-00028a30: 6264 203d 3d20 2831 2c29 2065 6c73 6520  bd == (1,) else 
-00028a40: 6920 666f 7220 6264 2c20 6920 696e 207a  i for bd, i in z
-00028a50: 6970 2878 2e63 6875 6e6b 732c 206e 6577  ip(x.chunks, new
-00028a60: 5f69 6e64 6578 5b6e 6469 6d5f 6e65 773a  _index[ndim_new:
-00028a70: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-00028a80: 2020 2020 206f 6c64 5f6b 6579 203d 2028       old_key = (
-00028a90: 782e 6e61 6d65 2c29 202b 206f 6c64 5f69  x.name,) + old_i
-00028aa0: 6e64 6578 0a20 2020 2020 2020 206e 6577  ndex.        new
-00028ab0: 5f6b 6579 203d 2028 6e61 6d65 2c29 202b  _key = (name,) +
-00028ac0: 206e 6577 5f69 6e64 6578 0a20 2020 2020   new_index.     
-00028ad0: 2020 2064 736b 5b6e 6577 5f6b 6579 5d20     dsk[new_key] 
-00028ae0: 3d20 286e 702e 6272 6f61 6463 6173 745f  = (np.broadcast_
-00028af0: 746f 2c20 6f6c 645f 6b65 792c 2071 756f  to, old_key, quo
-00028b00: 7465 2863 6875 6e6b 5f73 6861 7065 2929  te(chunk_shape))
-00028b10: 0a0a 2020 2020 6772 6170 6820 3d20 4869  ..    graph = Hi
-00028b20: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00028b30: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-00028b40: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
-00028b50: 6e63 6965 733d 5b78 5d29 0a20 2020 2072  ncies=[x]).    r
-00028b60: 6574 7572 6e20 4172 7261 7928 6772 6170  eturn Array(grap
-00028b70: 682c 206e 616d 652c 2063 6875 6e6b 732c  h, name, chunks,
-00028b80: 2064 7479 7065 3d78 2e64 7479 7065 2c20   dtype=x.dtype, 
-00028b90: 6d65 7461 3d6d 6574 6129 0a0a 0a40 6465  meta=meta)...@de
-00028ba0: 7269 7665 645f 6672 6f6d 286e 7029 0a64  rived_from(np).d
-00028bb0: 6566 2062 726f 6164 6361 7374 5f61 7272  ef broadcast_arr
-00028bc0: 6179 7328 2a61 7267 732c 2073 7562 6f6b  ays(*args, subok
-00028bd0: 3d46 616c 7365 293a 0a20 2020 2073 7562  =False):.    sub
-00028be0: 6f6b 203d 2062 6f6f 6c28 7375 626f 6b29  ok = bool(subok)
-00028bf0: 0a0a 2020 2020 746f 5f61 7272 6179 203d  ..    to_array =
-00028c00: 2061 7361 6e79 6172 7261 7920 6966 2073   asanyarray if s
-00028c10: 7562 6f6b 2065 6c73 6520 6173 6172 7261  ubok else asarra
-00028c20: 790a 2020 2020 6172 6773 203d 2074 7570  y.    args = tup
-00028c30: 6c65 2874 6f5f 6172 7261 7928 6529 2066  le(to_array(e) f
-00028c40: 6f72 2065 2069 6e20 6172 6773 290a 0a20  or e in args).. 
-00028c50: 2020 2023 2055 6e69 6679 2075 6e65 7665     # Unify uneve
-00028c60: 6e20 6368 756e 6b69 6e67 0a20 2020 2069  n chunking.    i
-00028c70: 6e64 7320 3d20 5b6c 6973 7428 7265 7665  nds = [list(reve
-00028c80: 7273 6564 2872 616e 6765 2878 2e6e 6469  rsed(range(x.ndi
-00028c90: 6d29 2929 2066 6f72 2078 2069 6e20 6172  m))) for x in ar
-00028ca0: 6773 5d0a 2020 2020 7563 5f61 7267 7320  gs].    uc_args 
-00028cb0: 3d20 636f 6e63 6174 287a 6970 2861 7267  = concat(zip(arg
-00028cc0: 732c 2069 6e64 7329 290a 2020 2020 5f2c  s, inds)).    _,
-00028cd0: 2061 7267 7320 3d20 756e 6966 795f 6368   args = unify_ch
-00028ce0: 756e 6b73 282a 7563 5f61 7267 732c 2077  unks(*uc_args, w
-00028cf0: 6172 6e3d 4661 6c73 6529 0a0a 2020 2020  arn=False)..    
-00028d00: 7368 6170 6520 3d20 6272 6f61 6463 6173  shape = broadcas
-00028d10: 745f 7368 6170 6573 282a 2865 2e73 6861  t_shapes(*(e.sha
-00028d20: 7065 2066 6f72 2065 2069 6e20 6172 6773  pe for e in args
-00028d30: 2929 0a20 2020 2063 6875 6e6b 7320 3d20  )).    chunks = 
-00028d40: 6272 6f61 6463 6173 745f 6368 756e 6b73  broadcast_chunks
-00028d50: 282a 2865 2e63 6875 6e6b 7320 666f 7220  (*(e.chunks for 
-00028d60: 6520 696e 2061 7267 7329 290a 0a20 2020  e in args))..   
-00028d70: 2072 6573 756c 7420 3d20 5b62 726f 6164   result = [broad
-00028d80: 6361 7374 5f74 6f28 652c 2073 6861 7065  cast_to(e, shape
-00028d90: 3d73 6861 7065 2c20 6368 756e 6b73 3d63  =shape, chunks=c
-00028da0: 6875 6e6b 7329 2066 6f72 2065 2069 6e20  hunks) for e in 
-00028db0: 6172 6773 5d0a 0a20 2020 2072 6574 7572  args]..    retur
-00028dc0: 6e20 7265 7375 6c74 0a0a 0a64 6566 206f  n result...def o
-00028dd0: 6666 7365 745f 6675 6e63 2866 756e 632c  ffset_func(func,
-00028de0: 206f 6666 7365 742c 202a 6172 6773 293a   offset, *args):
-00028df0: 0a20 2020 2022 2222 4f66 6673 6574 7320  .    """Offsets 
-00028e00: 696e 7075 7473 2062 7920 6f66 6673 6574  inputs by offset
-00028e10: 0a0a 2020 2020 3e3e 3e20 646f 7562 6c65  ..    >>> double
-00028e20: 203d 206c 616d 6264 6120 783a 2078 202a   = lambda x: x *
-00028e30: 2032 0a20 2020 203e 3e3e 2066 203d 206f   2.    >>> f = o
-00028e40: 6666 7365 745f 6675 6e63 2864 6f75 626c  ffset_func(doubl
-00028e50: 652c 2028 3130 2c29 290a 2020 2020 3e3e  e, (10,)).    >>
-00028e60: 3e20 6628 3129 0a20 2020 2032 320a 2020  > f(1).    22.  
-00028e70: 2020 3e3e 3e20 6628 3330 3029 0a20 2020    >>> f(300).   
-00028e80: 2036 3230 0a20 2020 2022 2222 0a0a 2020   620.    """..  
-00028e90: 2020 6465 6620 5f6f 6666 7365 7428 2a61    def _offset(*a
-00028ea0: 7267 7329 3a0a 2020 2020 2020 2020 6172  rgs):.        ar
-00028eb0: 6773 3220 3d20 6c69 7374 286d 6170 2861  gs2 = list(map(a
-00028ec0: 6464 2c20 6172 6773 2c20 6f66 6673 6574  dd, args, offset
-00028ed0: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-00028ee0: 6e20 6675 6e63 282a 6172 6773 3229 0a0a  n func(*args2)..
-00028ef0: 2020 2020 7769 7468 2063 6f6e 7465 7874      with context
-00028f00: 6c69 622e 7375 7070 7265 7373 2845 7863  lib.suppress(Exc
-00028f10: 6570 7469 6f6e 293a 0a20 2020 2020 2020  eption):.       
-00028f20: 205f 6f66 6673 6574 2e5f 5f6e 616d 655f   _offset.__name_
-00028f30: 5f20 3d20 226f 6666 7365 745f 2220 2b20  _ = "offset_" + 
-00028f40: 6675 6e63 2e5f 5f6e 616d 655f 5f0a 0a20  func.__name__.. 
-00028f50: 2020 2072 6574 7572 6e20 5f6f 6666 7365     return _offse
-00028f60: 740a 0a0a 6465 6620 6368 756e 6b73 5f66  t...def chunks_f
-00028f70: 726f 6d5f 6172 7261 7973 2861 7272 6179  rom_arrays(array
-00028f80: 7329 3a0a 2020 2020 2222 2243 6875 6e6b  s):.    """Chunk
-00028f90: 7320 7475 706c 6520 6672 6f6d 206e 6573  s tuple from nes
-00028fa0: 7465 6420 6c69 7374 206f 6620 6172 7261  ted list of arra
-00028fb0: 7973 0a0a 2020 2020 3e3e 3e20 7820 3d20  ys..    >>> x = 
-00028fc0: 6e70 2e61 7272 6179 285b 312c 2032 5d29  np.array([1, 2])
-00028fd0: 0a20 2020 203e 3e3e 2063 6875 6e6b 735f  .    >>> chunks_
-00028fe0: 6672 6f6d 5f61 7272 6179 7328 5b78 2c20  from_arrays([x, 
-00028ff0: 785d 290a 2020 2020 2828 322c 2032 292c  x]).    ((2, 2),
-00029000: 290a 0a20 2020 203e 3e3e 2078 203d 206e  )..    >>> x = n
-00029010: 702e 6172 7261 7928 5b5b 312c 2032 5d5d  p.array([[1, 2]]
-00029020: 290a 2020 2020 3e3e 3e20 6368 756e 6b73  ).    >>> chunks
-00029030: 5f66 726f 6d5f 6172 7261 7973 285b 5b78  _from_arrays([[x
-00029040: 5d2c 205b 785d 5d29 0a20 2020 2028 2831  ], [x]]).    ((1
-00029050: 2c20 3129 2c20 2832 2c29 290a 0a20 2020  , 1), (2,))..   
-00029060: 203e 3e3e 2078 203d 206e 702e 6172 7261   >>> x = np.arra
-00029070: 7928 5b5b 312c 2032 5d5d 290a 2020 2020  y([[1, 2]]).    
-00029080: 3e3e 3e20 6368 756e 6b73 5f66 726f 6d5f  >>> chunks_from_
-00029090: 6172 7261 7973 285b 5b78 2c20 785d 5d29  arrays([[x, x]])
-000290a0: 0a20 2020 2028 2831 2c29 2c20 2832 2c20  .    ((1,), (2, 
-000290b0: 3229 290a 0a20 2020 203e 3e3e 2063 6875  2))..    >>> chu
-000290c0: 6e6b 735f 6672 6f6d 5f61 7272 6179 7328  nks_from_arrays(
-000290d0: 5b31 2c20 315d 290a 2020 2020 2828 312c  [1, 1]).    ((1,
-000290e0: 2031 292c 290a 2020 2020 2222 220a 2020   1),).    """.  
-000290f0: 2020 6966 206e 6f74 2061 7272 6179 733a    if not arrays:
-00029100: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00029110: 2829 0a20 2020 2072 6573 756c 7420 3d20  ().    result = 
-00029120: 5b5d 0a20 2020 2064 696d 203d 2030 0a0a  [].    dim = 0..
-00029130: 2020 2020 6465 6620 7368 6170 6528 7829      def shape(x)
-00029140: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-00029150: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00029160: 6e20 782e 7368 6170 6520 6966 2078 2e73  n x.shape if x.s
-00029170: 6861 7065 2065 6c73 6520 2831 2c29 0a20  hape else (1,). 
-00029180: 2020 2020 2020 2065 7863 6570 7420 4174         except At
-00029190: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
-000291a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000291b0: 2028 312c 290a 0a20 2020 2077 6869 6c65   (1,)..    while
-000291c0: 2069 7369 6e73 7461 6e63 6528 6172 7261   isinstance(arra
-000291d0: 7973 2c20 286c 6973 742c 2074 7570 6c65  ys, (list, tuple
-000291e0: 2929 3a0a 2020 2020 2020 2020 7265 7375  )):.        resu
-000291f0: 6c74 2e61 7070 656e 6428 7475 706c 6528  lt.append(tuple(
-00029200: 7368 6170 6528 6465 6570 6669 7273 7428  shape(deepfirst(
-00029210: 6129 295b 6469 6d5d 2066 6f72 2061 2069  a))[dim] for a i
-00029220: 6e20 6172 7261 7973 2929 0a20 2020 2020  n arrays)).     
-00029230: 2020 2061 7272 6179 7320 3d20 6172 7261     arrays = arra
-00029240: 7973 5b30 5d0a 2020 2020 2020 2020 6469  ys[0].        di
-00029250: 6d20 2b3d 2031 0a20 2020 2072 6574 7572  m += 1.    retur
-00029260: 6e20 7475 706c 6528 7265 7375 6c74 290a  n tuple(result).
-00029270: 0a0a 6465 6620 6465 6570 6669 7273 7428  ..def deepfirst(
-00029280: 7365 7129 3a0a 2020 2020 2222 2246 6972  seq):.    """Fir
-00029290: 7374 2065 6c65 6d65 6e74 2069 6e20 6120  st element in a 
-000292a0: 6e65 7374 6564 206c 6973 740a 0a20 2020  nested list..   
-000292b0: 203e 3e3e 2064 6565 7066 6972 7374 285b   >>> deepfirst([
-000292c0: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
-000292d0: 2c20 5b35 2c20 365d 2c20 5b37 2c20 385d  , [5, 6], [7, 8]
-000292e0: 5d29 0a20 2020 2031 0a20 2020 2022 2222  ]).    1.    """
-000292f0: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
-00029300: 7374 616e 6365 2873 6571 2c20 286c 6973  stance(seq, (lis
-00029310: 742c 2074 7570 6c65 2929 3a0a 2020 2020  t, tuple)):.    
-00029320: 2020 2020 7265 7475 726e 2073 6571 0a20      return seq. 
-00029330: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00029340: 2072 6574 7572 6e20 6465 6570 6669 7273   return deepfirs
-00029350: 7428 7365 715b 305d 290a 0a0a 6465 6620  t(seq[0])...def 
-00029360: 7368 6170 656c 6973 7428 6129 3a0a 2020  shapelist(a):.  
-00029370: 2020 2222 2247 6574 2074 6865 2073 6861    """Get the sha
-00029380: 7065 206f 6620 6e65 7374 6564 206c 6973  pe of nested lis
-00029390: 7422 2222 0a20 2020 2069 6620 7479 7065  t""".    if type
-000293a0: 2861 2920 6973 206c 6973 743a 0a20 2020  (a) is list:.   
-000293b0: 2020 2020 2072 6574 7572 6e20 7475 706c       return tupl
-000293c0: 6528 5b6c 656e 2861 295d 202b 206c 6973  e([len(a)] + lis
-000293d0: 7428 7368 6170 656c 6973 7428 615b 305d  t(shapelist(a[0]
-000293e0: 2929 290a 2020 2020 656c 7365 3a0a 2020  ))).    else:.  
-000293f0: 2020 2020 2020 7265 7475 726e 2028 290a        return ().
-00029400: 0a0a 6465 6620 7472 616e 7370 6f73 656c  ..def transposel
-00029410: 6973 7428 6172 7261 7973 2c20 6178 6573  ist(arrays, axes
-00029420: 2c20 6578 7472 6164 696d 733d 3029 3a0a  , extradims=0):.
-00029430: 2020 2020 2222 2250 6572 6d75 7465 2061      """Permute a
-00029440: 7865 7320 6f66 206e 6573 7465 6420 6c69  xes of nested li
-00029450: 7374 0a0a 2020 2020 3e3e 3e20 7472 616e  st..    >>> tran
-00029460: 7370 6f73 656c 6973 7428 5b5b 312c 312c  sposelist([[1,1,
-00029470: 315d 2c5b 312c 312c 315d 5d2c 205b 322c  1],[1,1,1]], [2,
-00029480: 315d 290a 2020 2020 5b5b 5b31 2c20 315d  1]).    [[[1, 1]
-00029490: 2c20 5b31 2c20 315d 2c20 5b31 2c20 315d  , [1, 1], [1, 1]
-000294a0: 5d5d 0a0a 2020 2020 3e3e 3e20 7472 616e  ]]..    >>> tran
-000294b0: 7370 6f73 656c 6973 7428 5b5b 312c 312c  sposelist([[1,1,
-000294c0: 315d 2c5b 312c 312c 315d 5d2c 205b 322c  1],[1,1,1]], [2,
-000294d0: 315d 2c20 6578 7472 6164 696d 733d 3129  1], extradims=1)
-000294e0: 0a20 2020 205b 5b5b 5b31 5d2c 205b 315d  .    [[[[1], [1]
-000294f0: 5d2c 205b 5b31 5d2c 205b 315d 5d2c 205b  ], [[1], [1]], [
-00029500: 5b31 5d2c 205b 315d 5d5d 5d0a 2020 2020  [1], [1]]]].    
-00029510: 2222 220a 2020 2020 6966 206c 656e 2861  """.    if len(a
-00029520: 7865 7329 2021 3d20 6e64 696d 6c69 7374  xes) != ndimlist
-00029530: 2861 7272 6179 7329 3a0a 2020 2020 2020  (arrays):.      
-00029540: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00029550: 6f72 2822 4c65 6e67 7468 206f 6620 6178  or("Length of ax
-00029560: 6573 2073 686f 756c 6420 6571 7561 6c20  es should equal 
-00029570: 6465 7074 6820 6f66 206e 6573 7465 6420  depth of nested 
-00029580: 6172 7261 7973 2229 0a20 2020 2069 6620  arrays").    if 
-00029590: 6578 7472 6164 696d 7320 3c20 303a 0a20  extradims < 0:. 
-000295a0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000295b0: 7565 4572 726f 7228 2260 6e65 7764 696d  ueError("`newdim
-000295c0: 7360 2073 686f 756c 6420 6265 2070 6f73  s` should be pos
-000295d0: 6974 6976 6522 290a 2020 2020 6966 206c  itive").    if l
-000295e0: 656e 2861 7865 7329 203e 206c 656e 2873  en(axes) > len(s
-000295f0: 6574 2861 7865 7329 293a 0a20 2020 2020  et(axes)):.     
-00029600: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00029610: 726f 7228 2260 6178 6573 6020 7368 6f75  ror("`axes` shou
-00029620: 6c64 2062 6520 756e 6971 7565 2229 0a0a  ld be unique")..
-00029630: 2020 2020 6e64 696d 203d 206d 6178 2861      ndim = max(a
-00029640: 7865 7329 202b 2031 0a20 2020 2073 6861  xes) + 1.    sha
-00029650: 7065 203d 2073 6861 7065 6c69 7374 2861  pe = shapelist(a
-00029660: 7272 6179 7329 0a20 2020 206e 6577 7368  rrays).    newsh
-00029670: 6170 6520 3d20 5b0a 2020 2020 2020 2020  ape = [.        
-00029680: 7368 6170 655b 6178 6573 2e69 6e64 6578  shape[axes.index
-00029690: 2869 295d 2069 6620 6920 696e 2061 7865  (i)] if i in axe
-000296a0: 7320 656c 7365 2031 2066 6f72 2069 2069  s else 1 for i i
-000296b0: 6e20 7261 6e67 6528 6e64 696d 202b 2065  n range(ndim + e
-000296c0: 7874 7261 6469 6d73 290a 2020 2020 5d0a  xtradims).    ].
-000296d0: 0a20 2020 2072 6573 756c 7420 3d20 6c69  .    result = li
-000296e0: 7374 2863 6f72 652e 666c 6174 7465 6e28  st(core.flatten(
-000296f0: 6172 7261 7973 2929 0a20 2020 2072 6574  arrays)).    ret
-00029700: 7572 6e20 7265 7368 6170 656c 6973 7428  urn reshapelist(
-00029710: 6e65 7773 6861 7065 2c20 7265 7375 6c74  newshape, result
-00029720: 290a 0a0a 6465 6620 7374 6163 6b28 7365  )...def stack(se
-00029730: 712c 2061 7869 733d 302c 2061 6c6c 6f77  q, axis=0, allow
-00029740: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
-00029750: 7a65 733d 4661 6c73 6529 3a0a 2020 2020  zes=False):.    
-00029760: 2222 220a 2020 2020 5374 6163 6b20 6172  """.    Stack ar
-00029770: 7261 7973 2061 6c6f 6e67 2061 206e 6577  rays along a new
-00029780: 2061 7869 730a 0a20 2020 2047 6976 656e   axis..    Given
-00029790: 2061 2073 6571 7565 6e63 6520 6f66 2064   a sequence of d
-000297a0: 6173 6b20 6172 7261 7973 2c20 666f 726d  ask arrays, form
-000297b0: 2061 206e 6577 2064 6173 6b20 6172 7261   a new dask arra
-000297c0: 7920 6279 2073 7461 636b 696e 6720 7468  y by stacking th
-000297d0: 656d 0a20 2020 2061 6c6f 6e67 2061 206e  em.    along a n
-000297e0: 6577 2064 696d 656e 7369 6f6e 2028 6178  ew dimension (ax
-000297f0: 6973 3d30 2062 7920 6465 6661 756c 7429  is=0 by default)
-00029800: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00029810: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00029820: 2020 2020 7365 713a 206c 6973 7420 6f66      seq: list of
-00029830: 2064 6173 6b2e 6172 7261 7973 0a20 2020   dask.arrays.   
-00029840: 2061 7869 733a 2069 6e74 0a20 2020 2020   axis: int.     
-00029850: 2020 2044 696d 656e 7369 6f6e 2061 6c6f     Dimension alo
-00029860: 6e67 2077 6869 6368 2074 6f20 616c 6967  ng which to alig
-00029870: 6e20 616c 6c20 6f66 2074 6865 2061 7272  n all of the arr
-00029880: 6179 730a 2020 2020 616c 6c6f 775f 756e  ays.    allow_un
-00029890: 6b6e 6f77 6e5f 6368 756e 6b73 697a 6573  known_chunksizes
-000298a0: 3a20 626f 6f6c 0a20 2020 2020 2020 2041  : bool.        A
-000298b0: 6c6c 6f77 2075 6e6b 6e6f 776e 2063 6875  llow unknown chu
-000298c0: 6e6b 7369 7a65 732c 2073 7563 6820 6173  nksizes, such as
-000298d0: 2063 6f6d 6520 6672 6f6d 2063 6f6e 7665   come from conve
-000298e0: 7274 696e 6720 6672 6f6d 2064 6173 6b0a  rting from dask.
-000298f0: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
-00029900: 6573 2e20 2044 6173 6b2e 6172 7261 7920  es.  Dask.array 
-00029910: 6973 2075 6e61 626c 6520 746f 2076 6572  is unable to ver
-00029920: 6966 7920 7468 6174 2063 6875 6e6b 7320  ify that chunks 
-00029930: 6c69 6e65 2075 702e 2020 4966 0a20 2020  line up.  If.   
-00029940: 2020 2020 2064 6174 6120 636f 6d65 7320       data comes 
-00029950: 6672 6f6d 2064 6966 6665 7265 6e74 6c79  from differently
-00029960: 2061 6c69 676e 6564 2073 6f75 7263 6573   aligned sources
-00029970: 2074 6865 6e20 7468 6973 2063 616e 2063   then this can c
-00029980: 6175 7365 0a20 2020 2020 2020 2075 6e65  ause.        une
-00029990: 7870 6563 7465 6420 7265 7375 6c74 732e  xpected results.
-000299a0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-000299b0: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
-000299c0: 2043 7265 6174 6520 736c 6963 6573 0a0a   Create slices..
-000299d0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-000299e0: 6173 6b2e 6172 7261 7920 6173 2064 610a  ask.array as da.
-000299f0: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
-00029a00: 756d 7079 2061 7320 6e70 0a0a 2020 2020  umpy as np..    
-00029a10: 3e3e 3e20 6461 7461 203d 205b 6461 2e66  >>> data = [da.f
-00029a20: 726f 6d5f 6172 7261 7928 6e70 2e6f 6e65  rom_array(np.one
-00029a30: 7328 2834 2c20 3429 292c 2063 6875 6e6b  s((4, 4)), chunk
-00029a40: 733d 2832 2c20 3229 290a 2020 2020 2e2e  s=(2, 2)).    ..
-00029a50: 2e20 2020 2020 2020 2020 666f 7220 6920  .         for i 
-00029a60: 696e 2072 616e 6765 2833 295d 0a0a 2020  in range(3)]..  
-00029a70: 2020 3e3e 3e20 7820 3d20 6461 2e73 7461    >>> x = da.sta
-00029a80: 636b 2864 6174 612c 2061 7869 733d 3029  ck(data, axis=0)
-00029a90: 0a20 2020 203e 3e3e 2078 2e73 6861 7065  .    >>> x.shape
-00029aa0: 0a20 2020 2028 332c 2034 2c20 3429 0a0a  .    (3, 4, 4)..
-00029ab0: 2020 2020 3e3e 3e20 6461 2e73 7461 636b      >>> da.stack
-00029ac0: 2864 6174 612c 2061 7869 733d 3129 2e73  (data, axis=1).s
-00029ad0: 6861 7065 0a20 2020 2028 342c 2033 2c20  hape.    (4, 3, 
-00029ae0: 3429 0a0a 2020 2020 3e3e 3e20 6461 2e73  4)..    >>> da.s
-00029af0: 7461 636b 2864 6174 612c 2061 7869 733d  tack(data, axis=
-00029b00: 2d31 292e 7368 6170 650a 2020 2020 2834  -1).shape.    (4
-00029b10: 2c20 342c 2033 290a 0a20 2020 2052 6573  , 4, 3)..    Res
-00029b20: 756c 7420 6973 2061 206e 6577 2064 6173  ult is a new das
-00029b30: 6b20 4172 7261 790a 0a20 2020 2053 6565  k Array..    See
-00029b40: 2041 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   Also.    ------
-00029b50: 2d2d 0a20 2020 2063 6f6e 6361 7465 6e61  --.    concatena
-00029b60: 7465 0a20 2020 2022 2222 0a20 2020 2066  te.    """.    f
-00029b70: 726f 6d20 6461 736b 2e61 7272 6179 2069  rom dask.array i
-00029b80: 6d70 6f72 7420 7772 6170 0a0a 2020 2020  mport wrap..    
-00029b90: 7365 7120 3d20 5b61 7361 7272 6179 2861  seq = [asarray(a
-00029ba0: 2c20 616c 6c6f 775f 756e 6b6e 6f77 6e5f  , allow_unknown_
-00029bb0: 6368 756e 6b73 697a 6573 3d61 6c6c 6f77  chunksizes=allow
-00029bc0: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
-00029bd0: 7a65 7329 2066 6f72 2061 2069 6e20 7365  zes) for a in se
-00029be0: 715d 0a0a 2020 2020 6966 206e 6f74 2073  q]..    if not s
-00029bf0: 6571 3a0a 2020 2020 2020 2020 7261 6973  eq:.        rais
-00029c00: 6520 5661 6c75 6545 7272 6f72 2822 4e65  e ValueError("Ne
-00029c10: 6564 2061 7272 6179 2873 2920 746f 2073  ed array(s) to s
-00029c20: 7461 636b 2229 0a20 2020 2069 6620 6e6f  tack").    if no
-00029c30: 7420 616c 6c6f 775f 756e 6b6e 6f77 6e5f  t allow_unknown_
-00029c40: 6368 756e 6b73 697a 6573 2061 6e64 206e  chunksizes and n
-00029c50: 6f74 2061 6c6c 2878 2e73 6861 7065 203d  ot all(x.shape =
-00029c60: 3d20 7365 715b 305d 2e73 6861 7065 2066  = seq[0].shape f
-00029c70: 6f72 2078 2069 6e20 7365 7129 3a0a 2020  or x in seq):.  
-00029c80: 2020 2020 2020 6964 7820 3d20 6669 7273        idx = firs
-00029c90: 7428 6920 666f 7220 6920 696e 2065 6e75  t(i for i in enu
-00029ca0: 6d65 7261 7465 2873 6571 2920 6966 2069  merate(seq) if i
-00029cb0: 5b31 5d2e 7368 6170 6520 213d 2073 6571  [1].shape != seq
-00029cc0: 5b30 5d2e 7368 6170 6529 0a20 2020 2020  [0].shape).     
-00029cd0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00029ce0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00029cf0: 2022 5374 6163 6b65 6420 6172 7261 7973   "Stacked arrays
-00029d00: 206d 7573 7420 6861 7665 2074 6865 2073   must have the s
-00029d10: 616d 6520 7368 6170 652e 2054 6865 2066  ame shape. The f
-00029d20: 6972 7374 2061 7272 6179 2068 6164 2073  irst array had s
-00029d30: 6861 7065 2022 0a20 2020 2020 2020 2020  hape ".         
-00029d40: 2020 2066 227b 7365 715b 305d 2e73 6861     f"{seq[0].sha
-00029d50: 7065 7d2c 2077 6869 6c65 2061 7272 6179  pe}, while array
-00029d60: 207b 6964 785b 305d 202b 2031 7d20 6861   {idx[0] + 1} ha
-00029d70: 7320 7368 6170 6520 7b69 6478 5b31 5d2e  s shape {idx[1].
-00029d80: 7368 6170 657d 2e22 0a20 2020 2020 2020  shape}.".       
-00029d90: 2029 0a0a 2020 2020 6d65 7461 203d 206e   )..    meta = n
-00029da0: 702e 7374 6163 6b28 5b6d 6574 615f 6672  p.stack([meta_fr
-00029db0: 6f6d 5f61 7272 6179 2861 2920 666f 7220  om_array(a) for 
-00029dc0: 6120 696e 2073 6571 5d2c 2061 7869 733d  a in seq], axis=
-00029dd0: 6178 6973 290a 2020 2020 7365 7120 3d20  axis).    seq = 
-00029de0: 5b78 2e61 7374 7970 6528 6d65 7461 2e64  [x.astype(meta.d
-00029df0: 7479 7065 2920 666f 7220 7820 696e 2073  type) for x in s
-00029e00: 6571 5d0a 0a20 2020 206e 6469 6d20 3d20  eq]..    ndim = 
-00029e10: 6d65 7461 2e6e 6469 6d20 2d20 310a 2020  meta.ndim - 1.  
-00029e20: 2020 6966 2061 7869 7320 3c20 303a 0a20    if axis < 0:. 
-00029e30: 2020 2020 2020 2061 7869 7320 3d20 6e64         axis = nd
-00029e40: 696d 202b 2061 7869 7320 2b20 310a 2020  im + axis + 1.  
-00029e50: 2020 7368 6170 6520 3d20 7475 706c 6528    shape = tuple(
-00029e60: 0a20 2020 2020 2020 206c 656e 2873 6571  .        len(seq
-00029e70: 290a 2020 2020 2020 2020 6966 2069 203d  ).        if i =
-00029e80: 3d20 6178 6973 0a20 2020 2020 2020 2065  = axis.        e
-00029e90: 6c73 6520 2873 6571 5b30 5d2e 7368 6170  lse (seq[0].shap
-00029ea0: 655b 695d 2069 6620 6920 3c20 6178 6973  e[i] if i < axis
-00029eb0: 2065 6c73 6520 7365 715b 305d 2e73 6861   else seq[0].sha
-00029ec0: 7065 5b69 202d 2031 5d29 0a20 2020 2020  pe[i - 1]).     
-00029ed0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00029ee0: 6528 6d65 7461 2e6e 6469 6d29 0a20 2020  e(meta.ndim).   
-00029ef0: 2029 0a0a 2020 2020 7365 7132 203d 205b   )..    seq2 = [
-00029f00: 6120 666f 7220 6120 696e 2073 6571 2069  a for a in seq i
-00029f10: 6620 612e 7369 7a65 5d0a 2020 2020 6966  f a.size].    if
-00029f20: 206e 6f74 2073 6571 323a 0a20 2020 2020   not seq2:.     
-00029f30: 2020 2073 6571 3220 3d20 7365 710a 0a20     seq2 = seq.. 
-00029f40: 2020 206e 203d 206c 656e 2873 6571 3229     n = len(seq2)
-00029f50: 0a20 2020 2069 6620 6e20 3d3d 2030 3a0a  .    if n == 0:.
-00029f60: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00029f70: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00029f80: 7772 6170 2e65 6d70 7479 5f6c 696b 6528  wrap.empty_like(
-00029f90: 6d65 7461 2c20 7368 6170 653d 7368 6170  meta, shape=shap
-00029fa0: 652c 2063 6875 6e6b 733d 7368 6170 652c  e, chunks=shape,
-00029fb0: 2064 7479 7065 3d6d 6574 612e 6474 7970   dtype=meta.dtyp
-00029fc0: 6529 0a20 2020 2020 2020 2065 7863 6570  e).        excep
-00029fd0: 7420 5479 7065 4572 726f 723a 0a20 2020  t TypeError:.   
-00029fe0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00029ff0: 7772 6170 2e65 6d70 7479 2873 6861 7065  wrap.empty(shape
-0002a000: 2c20 6368 756e 6b73 3d73 6861 7065 2c20  , chunks=shape, 
-0002a010: 6474 7970 653d 6d65 7461 2e64 7479 7065  dtype=meta.dtype
-0002a020: 290a 0a20 2020 2069 6e64 203d 206c 6973  )..    ind = lis
-0002a030: 7428 7261 6e67 6528 6e64 696d 2929 0a20  t(range(ndim)). 
-0002a040: 2020 2075 635f 6172 6773 203d 206c 6973     uc_args = lis
-0002a050: 7428 636f 6e63 6174 2828 782c 2069 6e64  t(concat((x, ind
-0002a060: 2920 666f 7220 7820 696e 2073 6571 3229  ) for x in seq2)
-0002a070: 290a 2020 2020 5f2c 2073 6571 3220 3d20  ).    _, seq2 = 
-0002a080: 756e 6966 795f 6368 756e 6b73 282a 7563  unify_chunks(*uc
-0002a090: 5f61 7267 7329 0a0a 2020 2020 6173 7365  _args)..    asse
-0002a0a0: 7274 206c 656e 287b 612e 6368 756e 6b73  rt len({a.chunks
-0002a0b0: 2066 6f72 2061 2069 6e20 7365 7132 7d29   for a in seq2})
-0002a0c0: 203d 3d20 3120 2023 2073 616d 6520 6368   == 1  # same ch
-0002a0d0: 756e 6b73 0a20 2020 2063 6875 6e6b 7320  unks.    chunks 
-0002a0e0: 3d20 7365 7132 5b30 5d2e 6368 756e 6b73  = seq2[0].chunks
-0002a0f0: 5b3a 6178 6973 5d20 2b20 2828 312c 2920  [:axis] + ((1,) 
-0002a100: 2a20 6e2c 2920 2b20 7365 7132 5b30 5d2e  * n,) + seq2[0].
-0002a110: 6368 756e 6b73 5b61 7869 733a 5d0a 0a20  chunks[axis:].. 
-0002a120: 2020 206e 616d 6573 203d 205b 612e 6e61     names = [a.na
-0002a130: 6d65 2066 6f72 2061 2069 6e20 7365 7132  me for a in seq2
-0002a140: 5d0a 2020 2020 6e61 6d65 203d 2022 7374  ].    name = "st
-0002a150: 6163 6b2d 2220 2b20 746f 6b65 6e69 7a65  ack-" + tokenize
-0002a160: 286e 616d 6573 2c20 6178 6973 290a 2020  (names, axis).  
-0002a170: 2020 6b65 7973 203d 206c 6973 7428 7072    keys = list(pr
-0002a180: 6f64 7563 7428 5b6e 616d 655d 2c20 2a5b  oduct([name], *[
-0002a190: 7261 6e67 6528 6c65 6e28 6264 2929 2066  range(len(bd)) f
-0002a1a0: 6f72 2062 6420 696e 2063 6875 6e6b 735d  or bd in chunks]
-0002a1b0: 2929 0a0a 2020 2020 696e 7075 7473 203d  ))..    inputs =
-0002a1c0: 205b 0a20 2020 2020 2020 2028 6e61 6d65   [.        (name
-0002a1d0: 735b 6b65 795b 6178 6973 202b 2031 5d5d  s[key[axis + 1]]
-0002a1e0: 2c29 202b 206b 6579 5b31 203a 2061 7869  ,) + key[1 : axi
-0002a1f0: 7320 2b20 315d 202b 206b 6579 5b61 7869  s + 1] + key[axi
-0002a200: 7320 2b20 3220 3a5d 2066 6f72 206b 6579  s + 2 :] for key
-0002a210: 2069 6e20 6b65 7973 0a20 2020 205d 0a20   in keys.    ]. 
-0002a220: 2020 2076 616c 7565 7320 3d20 5b0a 2020     values = [.  
-0002a230: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0002a240: 2020 2020 6765 7469 7465 6d2c 0a20 2020      getitem,.   
-0002a250: 2020 2020 2020 2020 2069 6e70 2c0a 2020           inp,.  
-0002a260: 2020 2020 2020 2020 2020 2873 6c69 6365            (slice
-0002a270: 284e 6f6e 652c 204e 6f6e 652c 204e 6f6e  (None, None, Non
-0002a280: 6529 2c29 202a 2061 7869 730a 2020 2020  e),) * axis.    
-0002a290: 2020 2020 2020 2020 2b20 284e 6f6e 652c          + (None,
-0002a2a0: 290a 2020 2020 2020 2020 2020 2020 2b20  ).            + 
-0002a2b0: 2873 6c69 6365 284e 6f6e 652c 204e 6f6e  (slice(None, Non
-0002a2c0: 652c 204e 6f6e 6529 2c29 202a 2028 6e64  e, None),) * (nd
-0002a2d0: 696d 202d 2061 7869 7329 2c0a 2020 2020  im - axis),.    
-0002a2e0: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
-0002a2f0: 7220 696e 7020 696e 2069 6e70 7574 730a  r inp in inputs.
-0002a300: 2020 2020 5d0a 0a20 2020 206c 6179 6572      ]..    layer
-0002a310: 203d 2064 6963 7428 7a69 7028 6b65 7973   = dict(zip(keys
-0002a320: 2c20 7661 6c75 6573 2929 0a20 2020 2067  , values)).    g
-0002a330: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0002a340: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0002a350: 6374 696f 6e73 286e 616d 652c 206c 6179  ctions(name, lay
-0002a360: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
-0002a370: 3d73 6571 3229 0a0a 2020 2020 7265 7475  =seq2)..    retu
-0002a380: 726e 2041 7272 6179 2867 7261 7068 2c20  rn Array(graph, 
-0002a390: 6e61 6d65 2c20 6368 756e 6b73 2c20 6d65  name, chunks, me
-0002a3a0: 7461 3d6d 6574 6129 0a0a 0a64 6566 2063  ta=meta)...def c
-0002a3b0: 6f6e 6361 7465 6e61 7465 3328 6172 7261  oncatenate3(arra
-0002a3c0: 7973 293a 0a20 2020 2022 2222 5265 6375  ys):.    """Recu
-0002a3d0: 7273 6976 6520 6e70 2e63 6f6e 6361 7465  rsive np.concate
-0002a3e0: 6e61 7465 0a0a 2020 2020 496e 7075 7420  nate..    Input 
-0002a3f0: 7368 6f75 6c64 2062 6520 6120 6e65 7374  should be a nest
-0002a400: 6564 206c 6973 7420 6f66 206e 756d 7079  ed list of numpy
-0002a410: 2061 7272 6179 7320 6172 7261 6e67 6564   arrays arranged
-0002a420: 2069 6e20 7468 6520 6f72 6465 7220 7468   in the order th
-0002a430: 6579 0a20 2020 2073 686f 756c 6420 6170  ey.    should ap
-0002a440: 7065 6172 2069 6e20 7468 6520 6172 7261  pear in the arra
-0002a450: 7920 6974 7365 6c66 2e20 2045 6163 6820  y itself.  Each 
-0002a460: 6172 7261 7920 7368 6f75 6c64 2068 6176  array should hav
-0002a470: 6520 7468 6520 7361 6d65 206e 756d 6265  e the same numbe
-0002a480: 720a 2020 2020 6f66 2064 696d 656e 7369  r.    of dimensi
-0002a490: 6f6e 7320 6173 2074 6865 2064 6573 6972  ons as the desir
-0002a4a0: 6564 206f 7574 7075 7420 616e 6420 7468  ed output and th
-0002a4b0: 6520 6e65 7374 696e 6720 6f66 2074 6865  e nesting of the
-0002a4c0: 206c 6973 7473 2e0a 0a20 2020 203e 3e3e   lists...    >>>
-0002a4d0: 2078 203d 206e 702e 6172 7261 7928 5b5b   x = np.array([[
-0002a4e0: 312c 2032 5d5d 290a 2020 2020 3e3e 3e20  1, 2]]).    >>> 
-0002a4f0: 636f 6e63 6174 656e 6174 6533 285b 5b78  concatenate3([[x
-0002a500: 2c20 782c 2078 5d2c 205b 782c 2078 2c20  , x, x], [x, x, 
-0002a510: 785d 5d29 0a20 2020 2061 7272 6179 285b  x]]).    array([
-0002a520: 5b31 2c20 322c 2031 2c20 322c 2031 2c20  [1, 2, 1, 2, 1, 
-0002a530: 325d 2c0a 2020 2020 2020 2020 2020 205b  2],.           [
-0002a540: 312c 2032 2c20 312c 2032 2c20 312c 2032  1, 2, 1, 2, 1, 2
-0002a550: 5d5d 290a 0a20 2020 203e 3e3e 2063 6f6e  ]])..    >>> con
-0002a560: 6361 7465 6e61 7465 3328 5b5b 782c 2078  catenate3([[x, x
-0002a570: 5d2c 205b 782c 2078 5d2c 205b 782c 2078  ], [x, x], [x, x
-0002a580: 5d5d 290a 2020 2020 6172 7261 7928 5b5b  ]]).    array([[
-0002a590: 312c 2032 2c20 312c 2032 5d2c 0a20 2020  1, 2, 1, 2],.   
-0002a5a0: 2020 2020 2020 2020 5b31 2c20 322c 2031          [1, 2, 1
-0002a5b0: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
-0002a5c0: 205b 312c 2032 2c20 312c 2032 5d5d 290a   [1, 2, 1, 2]]).
-0002a5d0: 2020 2020 2222 220a 2020 2020 2320 5765      """.    # We
-0002a5e0: 206e 6565 6420 7468 6973 2061 7320 5f5f   need this as __
-0002a5f0: 6172 7261 795f 6675 6e63 7469 6f6e 5f5f  array_function__
-0002a600: 206d 6179 206e 6f74 2065 7869 7374 206f   may not exist o
-0002a610: 6e20 6f6c 6465 7220 4e75 6d50 7920 7665  n older NumPy ve
-0002a620: 7273 696f 6e73 2e0a 2020 2020 2320 416e  rsions..    # An
-0002a630: 6420 746f 2072 6564 7563 6520 7665 7262  d to reduce verb
-0002a640: 6f73 6974 792e 0a20 2020 204e 4441 5252  osity..    NDARR
-0002a650: 4159 5f41 5252 4159 5f46 554e 4354 494f  AY_ARRAY_FUNCTIO
-0002a660: 4e20 3d20 6765 7461 7474 7228 6e70 2e6e  N = getattr(np.n
-0002a670: 6461 7272 6179 2c20 225f 5f61 7272 6179  darray, "__array
-0002a680: 5f66 756e 6374 696f 6e5f 5f22 2c20 4e6f  _function__", No
-0002a690: 6e65 290a 0a20 2020 2061 7272 6179 7320  ne)..    arrays 
-0002a6a0: 3d20 636f 6e63 7265 7465 2861 7272 6179  = concrete(array
-0002a6b0: 7329 0a20 2020 2069 6620 6e6f 7420 6172  s).    if not ar
-0002a6c0: 7261 7973 3a0a 2020 2020 2020 2020 7265  rays:.        re
-0002a6d0: 7475 726e 206e 702e 656d 7074 7928 3029  turn np.empty(0)
-0002a6e0: 0a0a 2020 2020 6164 7661 6e63 6564 203d  ..    advanced =
-0002a6f0: 206d 6178 280a 2020 2020 2020 2020 636f   max(.        co
-0002a700: 7265 2e66 6c61 7474 656e 2861 7272 6179  re.flatten(array
-0002a710: 732c 2063 6f6e 7461 696e 6572 3d28 6c69  s, container=(li
-0002a720: 7374 2c20 7475 706c 6529 292c 0a20 2020  st, tuple)),.   
-0002a730: 2020 2020 206b 6579 3d6c 616d 6264 6120       key=lambda 
-0002a740: 783a 2067 6574 6174 7472 2878 2c20 225f  x: getattr(x, "_
-0002a750: 5f61 7272 6179 5f70 7269 6f72 6974 795f  _array_priority_
-0002a760: 5f22 2c20 3029 2c0a 2020 2020 290a 0a20  _", 0),.    ).. 
-0002a770: 2020 2069 6620 6e6f 7420 616c 6c28 0a20     if not all(. 
-0002a780: 2020 2020 2020 204e 4441 5252 4159 5f41         NDARRAY_A
-0002a790: 5252 4159 5f46 554e 4354 494f 4e0a 2020  RRAY_FUNCTION.  
-0002a7a0: 2020 2020 2020 6973 2067 6574 6174 7472        is getattr
-0002a7b0: 2874 7970 6528 6172 7229 2c20 225f 5f61  (type(arr), "__a
-0002a7c0: 7272 6179 5f66 756e 6374 696f 6e5f 5f22  rray_function__"
-0002a7d0: 2c20 4e44 4152 5241 595f 4152 5241 595f  , NDARRAY_ARRAY_
-0002a7e0: 4655 4e43 5449 4f4e 290a 2020 2020 2020  FUNCTION).      
-0002a7f0: 2020 666f 7220 6172 7220 696e 2063 6f72    for arr in cor
-0002a800: 652e 666c 6174 7465 6e28 6172 7261 7973  e.flatten(arrays
-0002a810: 2c20 636f 6e74 6169 6e65 723d 286c 6973  , container=(lis
-0002a820: 742c 2074 7570 6c65 2929 0a20 2020 2029  t, tuple)).    )
-0002a830: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-0002a840: 2020 2020 2020 2020 2020 2078 203d 2075             x = u
-0002a850: 6e70 6163 6b5f 7369 6e67 6c65 746f 6e28  npack_singleton(
-0002a860: 6172 7261 7973 290a 2020 2020 2020 2020  arrays).        
-0002a870: 2020 2020 7265 7475 726e 205f 636f 6e63      return _conc
-0002a880: 6174 656e 6174 6532 2861 7272 6179 732c  atenate2(arrays,
-0002a890: 2061 7865 733d 7475 706c 6528 7261 6e67   axes=tuple(rang
-0002a8a0: 6528 782e 6e64 696d 2929 290a 2020 2020  e(x.ndim))).    
-0002a8b0: 2020 2020 6578 6365 7074 2054 7970 6545      except TypeE
-0002a8c0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-0002a8d0: 2020 7061 7373 0a0a 2020 2020 6966 2063    pass..    if c
-0002a8e0: 6f6e 6361 7465 6e61 7465 5f6c 6f6f 6b75  oncatenate_looku
-0002a8f0: 702e 6469 7370 6174 6368 2874 7970 6528  p.dispatch(type(
-0002a900: 6164 7661 6e63 6564 2929 2069 7320 6e6f  advanced)) is no
-0002a910: 7420 6e70 2e63 6f6e 6361 7465 6e61 7465  t np.concatenate
-0002a920: 3a0a 2020 2020 2020 2020 7820 3d20 756e  :.        x = un
-0002a930: 7061 636b 5f73 696e 676c 6574 6f6e 2861  pack_singleton(a
-0002a940: 7272 6179 7329 0a20 2020 2020 2020 2072  rrays).        r
-0002a950: 6574 7572 6e20 5f63 6f6e 6361 7465 6e61  eturn _concatena
-0002a960: 7465 3228 6172 7261 7973 2c20 6178 6573  te2(arrays, axes
-0002a970: 3d6c 6973 7428 7261 6e67 6528 782e 6e64  =list(range(x.nd
-0002a980: 696d 2929 290a 0a20 2020 206e 6469 6d20  im)))..    ndim 
-0002a990: 3d20 6e64 696d 6c69 7374 2861 7272 6179  = ndimlist(array
-0002a9a0: 7329 0a20 2020 2069 6620 6e6f 7420 6e64  s).    if not nd
-0002a9b0: 696d 3a0a 2020 2020 2020 2020 7265 7475  im:.        retu
-0002a9c0: 726e 2061 7272 6179 730a 2020 2020 6368  rn arrays.    ch
-0002a9d0: 756e 6b73 203d 2063 6875 6e6b 735f 6672  unks = chunks_fr
-0002a9e0: 6f6d 5f61 7272 6179 7328 6172 7261 7973  om_arrays(arrays
-0002a9f0: 290a 2020 2020 7368 6170 6520 3d20 7475  ).    shape = tu
-0002aa00: 706c 6528 6d61 7028 7375 6d2c 2063 6875  ple(map(sum, chu
-0002aa10: 6e6b 7329 290a 0a20 2020 2064 6566 2064  nks))..    def d
-0002aa20: 7479 7065 2878 293a 0a20 2020 2020 2020  type(x):.       
-0002aa30: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0002aa40: 2020 7265 7475 726e 2078 2e64 7479 7065    return x.dtype
-0002aa50: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0002aa60: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-0002aa70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002aa80: 726e 2074 7970 6528 7829 0a0a 2020 2020  rn type(x)..    
-0002aa90: 7265 7375 6c74 203d 206e 702e 656d 7074  result = np.empt
-0002aaa0: 7928 7368 6170 653d 7368 6170 652c 2064  y(shape=shape, d
-0002aab0: 7479 7065 3d64 7479 7065 2864 6565 7066  type=dtype(deepf
-0002aac0: 6972 7374 2861 7272 6179 7329 2929 0a0a  irst(arrays)))..
-0002aad0: 2020 2020 666f 7220 6964 782c 2061 7272      for idx, arr
-0002aae0: 2069 6e20 7a69 7028 0a20 2020 2020 2020   in zip(.       
-0002aaf0: 2073 6c69 6365 735f 6672 6f6d 5f63 6875   slices_from_chu
-0002ab00: 6e6b 7328 6368 756e 6b73 292c 2063 6f72  nks(chunks), cor
-0002ab10: 652e 666c 6174 7465 6e28 6172 7261 7973  e.flatten(arrays
-0002ab20: 2c20 636f 6e74 6169 6e65 723d 286c 6973  , container=(lis
-0002ab30: 742c 2074 7570 6c65 2929 0a20 2020 2029  t, tuple)).    )
-0002ab40: 3a0a 2020 2020 2020 2020 6966 2068 6173  :.        if has
-0002ab50: 6174 7472 2861 7272 2c20 226e 6469 6d22  attr(arr, "ndim"
-0002ab60: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-0002ab70: 6869 6c65 2061 7272 2e6e 6469 6d20 3c20  hile arr.ndim < 
-0002ab80: 6e64 696d 3a0a 2020 2020 2020 2020 2020  ndim:.          
-0002ab90: 2020 2020 2020 6172 7220 3d20 6172 725b        arr = arr[
-0002aba0: 4e6f 6e65 2c20 2e2e 2e5d 0a20 2020 2020  None, ...].     
-0002abb0: 2020 2072 6573 756c 745b 6964 785d 203d     result[idx] =
-0002abc0: 2061 7272 0a0a 2020 2020 7265 7475 726e   arr..    return
-0002abd0: 2072 6573 756c 740a 0a0a 6465 6620 636f   result...def co
-0002abe0: 6e63 6174 656e 6174 655f 6178 6573 2861  ncatenate_axes(a
-0002abf0: 7272 6179 732c 2061 7865 7329 3a0a 2020  rrays, axes):.  
-0002ac00: 2020 2222 2252 6563 7572 7369 7665 6c79    """Recursively
-0002ac10: 2063 616c 6c20 6e70 2e63 6f6e 6361 7465   call np.concate
-0002ac20: 6e61 7465 2061 6c6f 6e67 2061 7865 7322  nate along axes"
-0002ac30: 2222 0a20 2020 2069 6620 6c65 6e28 6178  "".    if len(ax
-0002ac40: 6573 2920 213d 206e 6469 6d6c 6973 7428  es) != ndimlist(
-0002ac50: 6172 7261 7973 293a 0a20 2020 2020 2020  arrays):.       
-0002ac60: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002ac70: 7228 224c 656e 6774 6820 6f66 2061 7865  r("Length of axe
-0002ac80: 7320 7368 6f75 6c64 2065 7175 616c 2064  s should equal d
-0002ac90: 6570 7468 206f 6620 6e65 7374 6564 2061  epth of nested a
-0002aca0: 7272 6179 7322 290a 0a20 2020 2065 7874  rrays")..    ext
-0002acb0: 7261 6469 6d73 203d 206d 6178 2830 2c20  radims = max(0, 
-0002acc0: 6465 6570 6669 7273 7428 6172 7261 7973  deepfirst(arrays
-0002acd0: 292e 6e64 696d 202d 2028 6d61 7828 6178  ).ndim - (max(ax
-0002ace0: 6573 2920 2b20 3129 290a 2020 2020 7265  es) + 1)).    re
-0002acf0: 7475 726e 2063 6f6e 6361 7465 6e61 7465  turn concatenate
-0002ad00: 3328 7472 616e 7370 6f73 656c 6973 7428  3(transposelist(
-0002ad10: 6172 7261 7973 2c20 6178 6573 2c20 6578  arrays, axes, ex
-0002ad20: 7472 6164 696d 733d 6578 7472 6164 696d  tradims=extradim
-0002ad30: 7329 290a 0a0a 6465 6620 746f 5f68 6466  s))...def to_hdf
-0002ad40: 3528 6669 6c65 6e61 6d65 2c20 2a61 7267  5(filename, *arg
-0002ad50: 732c 2063 6875 6e6b 733d 5472 7565 2c20  s, chunks=True, 
-0002ad60: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
-0002ad70: 2222 5374 6f72 6520 6172 7261 7973 2069  ""Store arrays i
-0002ad80: 6e20 4844 4635 2066 696c 650a 0a20 2020  n HDF5 file..   
-0002ad90: 2054 6869 7320 7361 7665 7320 7365 7665   This saves seve
-0002ada0: 7261 6c20 6461 736b 2061 7272 6179 7320  ral dask arrays 
-0002adb0: 696e 746f 2073 6576 6572 616c 2064 6174  into several dat
-0002adc0: 6170 6174 6873 2069 6e20 616e 2048 4446  apaths in an HDF
-0002add0: 3520 6669 6c65 2e0a 2020 2020 4974 2063  5 file..    It c
-0002ade0: 7265 6174 6573 2074 6865 206e 6563 6573  reates the neces
-0002adf0: 7361 7279 2064 6174 6173 6574 7320 616e  sary datasets an
-0002ae00: 6420 6861 6e64 6c65 7320 636c 6561 6e20  d handles clean 
-0002ae10: 6669 6c65 206f 7065 6e69 6e67 2f63 6c6f  file opening/clo
-0002ae20: 7369 6e67 2e0a 0a20 2020 2050 6172 616d  sing...    Param
-0002ae30: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-0002ae40: 2d2d 2d2d 0a20 2020 2063 6875 6e6b 733a  ----.    chunks:
-0002ae50: 2074 7570 6c65 206f 7220 6060 5472 7565   tuple or ``True
-0002ae60: 6060 0a20 2020 2020 2020 2043 6875 6e6b  ``.        Chunk
-0002ae70: 2073 6861 7065 2c20 6f72 2060 6054 7275   shape, or ``Tru
-0002ae80: 6560 6020 746f 2070 6173 7320 7468 6520  e`` to pass the 
-0002ae90: 6368 756e 6b73 2066 726f 6d20 7468 6520  chunks from the 
-0002aea0: 6461 736b 2061 7272 6179 2e0a 2020 2020  dask array..    
-0002aeb0: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
-0002aec0: 6060 5472 7565 6060 2e0a 0a20 2020 2045  ``True``...    E
-0002aed0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-0002aee0: 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20 6461  ----..    >>> da
-0002aef0: 2e74 6f5f 6864 6635 2827 6d79 6669 6c65  .to_hdf5('myfile
-0002af00: 2e68 6466 3527 2c20 272f 7827 2c20 7829  .hdf5', '/x', x)
-0002af10: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002af20: 4950 0a0a 2020 2020 6f72 0a0a 2020 2020  IP..    or..    
-0002af30: 3e3e 3e20 6461 2e74 6f5f 6864 6635 2827  >>> da.to_hdf5('
-0002af40: 6d79 6669 6c65 2e68 6466 3527 2c20 7b27  myfile.hdf5', {'
-0002af50: 2f78 273a 2078 2c20 272f 7927 3a20 797d  /x': x, '/y': y}
-0002af60: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0002af70: 4b49 500a 0a20 2020 204f 7074 696f 6e61  KIP..    Optiona
-0002af80: 6c6c 7920 7072 6f76 6964 6520 6172 6775  lly provide argu
-0002af90: 6d65 6e74 7320 6173 2074 686f 7567 6820  ments as though 
-0002afa0: 746f 2060 6068 3570 792e 4669 6c65 2e63  to ``h5py.File.c
-0002afb0: 7265 6174 655f 6461 7461 7365 7460 600a  reate_dataset``.
-0002afc0: 0a20 2020 203e 3e3e 2064 612e 746f 5f68  .    >>> da.to_h
-0002afd0: 6466 3528 276d 7966 696c 652e 6864 6635  df5('myfile.hdf5
-0002afe0: 272c 2027 2f78 272c 2078 2c20 636f 6d70  ', '/x', x, comp
-0002aff0: 7265 7373 696f 6e3d 276c 7a66 272c 2073  ression='lzf', s
-0002b000: 6875 6666 6c65 3d54 7275 6529 2020 2320  huffle=True)  # 
-0002b010: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-0002b020: 2020 2020 3e3e 3e20 6461 2e74 6f5f 6864      >>> da.to_hd
-0002b030: 6635 2827 6d79 6669 6c65 2e68 6466 3527  f5('myfile.hdf5'
-0002b040: 2c20 272f 7827 2c20 782c 2063 6875 6e6b  , '/x', x, chunk
-0002b050: 733d 2831 302c 3230 2c33 3029 2920 2023  s=(10,20,30))  #
-0002b060: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0002b070: 0a20 2020 2054 6869 7320 6361 6e20 616c  .    This can al
-0002b080: 736f 2062 6520 7573 6564 2061 7320 6120  so be used as a 
-0002b090: 6d65 7468 6f64 206f 6e20 6120 7369 6e67  method on a sing
-0002b0a0: 6c65 2041 7272 6179 0a0a 2020 2020 3e3e  le Array..    >>
-0002b0b0: 3e20 782e 746f 5f68 6466 3528 276d 7966  > x.to_hdf5('myf
-0002b0c0: 696c 652e 6864 6635 272c 2027 2f78 2729  ile.hdf5', '/x')
-0002b0d0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002b0e0: 4950 0a0a 2020 2020 5365 6520 416c 736f  IP..    See Also
-0002b0f0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-0002b100: 2020 6461 2e73 746f 7265 0a20 2020 2068    da.store.    h
-0002b110: 3570 792e 4669 6c65 2e63 7265 6174 655f  5py.File.create_
-0002b120: 6461 7461 7365 740a 2020 2020 2222 220a  dataset.    """.
-0002b130: 2020 2020 6966 206c 656e 2861 7267 7329      if len(args)
-0002b140: 203d 3d20 3120 616e 6420 6973 696e 7374   == 1 and isinst
-0002b150: 616e 6365 2861 7267 735b 305d 2c20 6469  ance(args[0], di
-0002b160: 6374 293a 0a20 2020 2020 2020 2064 6174  ct):.        dat
-0002b170: 6120 3d20 6172 6773 5b30 5d0a 2020 2020  a = args[0].    
-0002b180: 656c 6966 206c 656e 2861 7267 7329 203d  elif len(args) =
-0002b190: 3d20 3220 616e 6420 6973 696e 7374 616e  = 2 and isinstan
-0002b1a0: 6365 2861 7267 735b 305d 2c20 7374 7229  ce(args[0], str)
-0002b1b0: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-0002b1c0: 6172 6773 5b31 5d2c 2041 7272 6179 293a  args[1], Array):
-0002b1d0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-0002b1e0: 7b61 7267 735b 305d 3a20 6172 6773 5b31  {args[0]: args[1
-0002b1f0: 5d7d 0a20 2020 2065 6c73 653a 0a20 2020  ]}.    else:.   
-0002b200: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002b210: 4572 726f 7228 2250 6c65 6173 6520 7072  Error("Please pr
-0002b220: 6f76 6964 6520 7b27 2f64 6174 612f 7061  ovide {'/data/pa
-0002b230: 7468 273a 2061 7272 6179 7d20 6469 6374  th': array} dict
-0002b240: 696f 6e61 7279 2229 0a0a 2020 2020 696d  ionary")..    im
-0002b250: 706f 7274 2068 3570 790a 0a20 2020 2077  port h5py..    w
-0002b260: 6974 6820 6835 7079 2e46 696c 6528 6669  ith h5py.File(fi
-0002b270: 6c65 6e61 6d65 2c20 6d6f 6465 3d22 6122  lename, mode="a"
-0002b280: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-0002b290: 6473 6574 7320 3d20 5b0a 2020 2020 2020  dsets = [.      
-0002b2a0: 2020 2020 2020 662e 7265 7175 6972 655f        f.require_
-0002b2b0: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
-0002b2c0: 2020 2020 2020 2020 2064 702c 0a20 2020           dp,.   
-0002b2d0: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-0002b2e0: 7065 3d78 2e73 6861 7065 2c0a 2020 2020  pe=x.shape,.    
-0002b2f0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-0002b300: 653d 782e 6474 7970 652c 0a20 2020 2020  e=x.dtype,.     
-0002b310: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-0002b320: 733d 7475 706c 6528 635b 305d 2066 6f72  s=tuple(c[0] for
-0002b330: 2063 2069 6e20 782e 6368 756e 6b73 2920   c in x.chunks) 
-0002b340: 6966 2063 6875 6e6b 7320 6973 2054 7275  if chunks is Tru
-0002b350: 6520 656c 7365 2063 6875 6e6b 732c 0a20  e else chunks,. 
-0002b360: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0002b370: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-0002b380: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0002b390: 2020 2066 6f72 2064 702c 2078 2069 6e20     for dp, x in 
-0002b3a0: 6461 7461 2e69 7465 6d73 2829 0a20 2020  data.items().   
-0002b3b0: 2020 2020 205d 0a20 2020 2020 2020 2073       ].        s
-0002b3c0: 746f 7265 286c 6973 7428 6461 7461 2e76  tore(list(data.v
-0002b3d0: 616c 7565 7328 2929 2c20 6473 6574 7329  alues()), dsets)
-0002b3e0: 0a0a 0a64 6566 2069 6e74 6572 6c65 6176  ...def interleav
-0002b3f0: 655f 6e6f 6e65 2861 2c20 6229 3a0a 2020  e_none(a, b):.  
-0002b400: 2020 2222 220a 0a20 2020 203e 3e3e 2069    """..    >>> i
-0002b410: 6e74 6572 6c65 6176 655f 6e6f 6e65 285b  nterleave_none([
-0002b420: 302c 204e 6f6e 652c 2032 2c20 4e6f 6e65  0, None, 2, None
-0002b430: 5d2c 205b 312c 2033 5d29 0a20 2020 2028  ], [1, 3]).    (
-0002b440: 302c 2031 2c20 322c 2033 290a 2020 2020  0, 1, 2, 3).    
-0002b450: 2222 220a 2020 2020 7265 7375 6c74 203d  """.    result =
-0002b460: 205b 5d0a 2020 2020 6920 3d20 6a20 3d20   [].    i = j = 
-0002b470: 300a 2020 2020 6e20 3d20 6c65 6e28 6129  0.    n = len(a)
-0002b480: 202b 206c 656e 2862 290a 2020 2020 7768   + len(b).    wh
-0002b490: 696c 6520 6920 2b20 6a20 3c20 6e3a 0a20  ile i + j < n:. 
-0002b4a0: 2020 2020 2020 2069 6620 615b 695d 2069         if a[i] i
-0002b4b0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002b4c0: 2020 2020 2020 2020 7265 7375 6c74 2e61          result.a
-0002b4d0: 7070 656e 6428 615b 695d 290a 2020 2020  ppend(a[i]).    
-0002b4e0: 2020 2020 2020 2020 6920 2b3d 2031 0a20          i += 1. 
-0002b4f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002b500: 2020 2020 2020 2020 2072 6573 756c 742e           result.
-0002b510: 6170 7065 6e64 2862 5b6a 5d29 0a20 2020  append(b[j]).   
-0002b520: 2020 2020 2020 2020 2069 202b 3d20 310a           i += 1.
-0002b530: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
-0002b540: 2031 0a20 2020 2072 6574 7572 6e20 7475   1.    return tu
-0002b550: 706c 6528 7265 7375 6c74 290a 0a0a 6465  ple(result)...de
-0002b560: 6620 6b65 796e 616d 6528 6e61 6d65 2c20  f keyname(name, 
-0002b570: 692c 206f 6b65 7929 3a0a 2020 2020 2222  i, okey):.    ""
-0002b580: 220a 0a20 2020 203e 3e3e 206b 6579 6e61  "..    >>> keyna
-0002b590: 6d65 2827 7827 2c20 332c 205b 4e6f 6e65  me('x', 3, [None
-0002b5a0: 2c20 4e6f 6e65 2c20 302c 2032 5d29 0a20  , None, 0, 2]). 
-0002b5b0: 2020 2028 2778 272c 2033 2c20 302c 2032     ('x', 3, 0, 2
-0002b5c0: 290a 2020 2020 2222 220a 2020 2020 7265  ).    """.    re
-0002b5d0: 7475 726e 2028 6e61 6d65 2c20 6929 202b  turn (name, i) +
-0002b5e0: 2074 7570 6c65 286b 2066 6f72 206b 2069   tuple(k for k i
-0002b5f0: 6e20 6f6b 6579 2069 6620 6b20 6973 206e  n okey if k is n
-0002b600: 6f74 204e 6f6e 6529 0a0a 0a64 6566 205f  ot None)...def _
-0002b610: 7669 6e64 6578 2878 2c20 2a69 6e64 6578  vindex(x, *index
-0002b620: 6573 293a 0a20 2020 2022 2222 506f 696e  es):.    """Poin
-0002b630: 7420 7769 7365 2069 6e64 6578 696e 6720  t wise indexing 
-0002b640: 7769 7468 2062 726f 6164 6361 7374 696e  with broadcastin
-0002b650: 672e 0a0a 2020 2020 3e3e 3e20 7820 3d20  g...    >>> x = 
-0002b660: 6e70 2e61 7261 6e67 6528 3536 292e 7265  np.arange(56).re
-0002b670: 7368 6170 6528 2837 2c20 3829 290a 2020  shape((7, 8)).  
-0002b680: 2020 3e3e 3e20 780a 2020 2020 6172 7261    >>> x.    arra
-0002b690: 7928 5b5b 2030 2c20 2031 2c20 2032 2c20  y([[ 0,  1,  2, 
-0002b6a0: 2033 2c20 2034 2c20 2035 2c20 2036 2c20   3,  4,  5,  6, 
-0002b6b0: 2037 5d2c 0a20 2020 2020 2020 2020 2020   7],.           
-0002b6c0: 5b20 382c 2020 392c 2031 302c 2031 312c  [ 8,  9, 10, 11,
-0002b6d0: 2031 322c 2031 332c 2031 342c 2031 355d   12, 13, 14, 15]
-0002b6e0: 2c0a 2020 2020 2020 2020 2020 205b 3136  ,.           [16
-0002b6f0: 2c20 3137 2c20 3138 2c20 3139 2c20 3230  , 17, 18, 19, 20
-0002b700: 2c20 3231 2c20 3232 2c20 3233 5d2c 0a20  , 21, 22, 23],. 
-0002b710: 2020 2020 2020 2020 2020 5b32 342c 2032            [24, 2
-0002b720: 352c 2032 362c 2032 372c 2032 382c 2032  5, 26, 27, 28, 2
-0002b730: 392c 2033 302c 2033 315d 2c0a 2020 2020  9, 30, 31],.    
-0002b740: 2020 2020 2020 205b 3332 2c20 3333 2c20         [32, 33, 
-0002b750: 3334 2c20 3335 2c20 3336 2c20 3337 2c20  34, 35, 36, 37, 
-0002b760: 3338 2c20 3339 5d2c 0a20 2020 2020 2020  38, 39],.       
-0002b770: 2020 2020 5b34 302c 2034 312c 2034 322c      [40, 41, 42,
-0002b780: 2034 332c 2034 342c 2034 352c 2034 362c   43, 44, 45, 46,
-0002b790: 2034 375d 2c0a 2020 2020 2020 2020 2020   47],.          
-0002b7a0: 205b 3438 2c20 3439 2c20 3530 2c20 3531   [48, 49, 50, 51
-0002b7b0: 2c20 3532 2c20 3533 2c20 3534 2c20 3535  , 52, 53, 54, 55
-0002b7c0: 5d5d 290a 0a20 2020 203e 3e3e 2064 203d  ]])..    >>> d =
-0002b7d0: 2066 726f 6d5f 6172 7261 7928 782c 2063   from_array(x, c
-0002b7e0: 6875 6e6b 733d 2833 2c20 3429 290a 2020  hunks=(3, 4)).  
-0002b7f0: 2020 3e3e 3e20 7265 7375 6c74 203d 205f    >>> result = _
-0002b800: 7669 6e64 6578 2864 2c20 5b30 2c20 312c  vindex(d, [0, 1,
-0002b810: 2036 2c20 305d 2c20 5b30 2c20 312c 2030   6, 0], [0, 1, 0
-0002b820: 2c20 375d 290a 2020 2020 3e3e 3e20 7265  , 7]).    >>> re
-0002b830: 7375 6c74 2e63 6f6d 7075 7465 2829 0a20  sult.compute(). 
-0002b840: 2020 2061 7272 6179 285b 2030 2c20 2039     array([ 0,  9
-0002b850: 2c20 3438 2c20 2037 5d29 0a20 2020 2022  , 48,  7]).    "
-0002b860: 2222 0a20 2020 2069 6e64 6578 6573 203d  "".    indexes =
-0002b870: 2072 6570 6c61 6365 5f65 6c6c 6970 7369   replace_ellipsi
-0002b880: 7328 782e 6e64 696d 2c20 696e 6465 7865  s(x.ndim, indexe
-0002b890: 7329 0a0a 2020 2020 6e6f 6e66 616e 6379  s)..    nonfancy
-0002b8a0: 5f69 6e64 6578 6573 203d 205b 5d0a 2020  _indexes = [].  
-0002b8b0: 2020 7265 6475 6365 645f 696e 6465 7865    reduced_indexe
-0002b8c0: 7320 3d20 5b5d 0a20 2020 2066 6f72 2069  s = [].    for i
-0002b8d0: 6e64 2069 6e20 696e 6465 7865 733a 0a20  nd in indexes:. 
-0002b8e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002b8f0: 616e 6365 2869 6e64 2c20 4e75 6d62 6572  ance(ind, Number
-0002b900: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
-0002b910: 6f6e 6661 6e63 795f 696e 6465 7865 732e  onfancy_indexes.
-0002b920: 6170 7065 6e64 2869 6e64 290a 2020 2020  append(ind).    
-0002b930: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0002b940: 6e63 6528 696e 642c 2073 6c69 6365 293a  nce(ind, slice):
-0002b950: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
-0002b960: 6661 6e63 795f 696e 6465 7865 732e 6170  fancy_indexes.ap
-0002b970: 7065 6e64 2869 6e64 290a 2020 2020 2020  pend(ind).      
-0002b980: 2020 2020 2020 7265 6475 6365 645f 696e        reduced_in
-0002b990: 6465 7865 732e 6170 7065 6e64 2873 6c69  dexes.append(sli
-0002b9a0: 6365 284e 6f6e 6529 290a 2020 2020 2020  ce(None)).      
-0002b9b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002b9c0: 2020 2020 6e6f 6e66 616e 6379 5f69 6e64      nonfancy_ind
-0002b9d0: 6578 6573 2e61 7070 656e 6428 736c 6963  exes.append(slic
-0002b9e0: 6528 4e6f 6e65 2929 0a20 2020 2020 2020  e(None)).       
-0002b9f0: 2020 2020 2072 6564 7563 6564 5f69 6e64       reduced_ind
-0002ba00: 6578 6573 2e61 7070 656e 6428 696e 6429  exes.append(ind)
-0002ba10: 0a0a 2020 2020 6e6f 6e66 616e 6379 5f69  ..    nonfancy_i
-0002ba20: 6e64 6578 6573 203d 2074 7570 6c65 286e  ndexes = tuple(n
-0002ba30: 6f6e 6661 6e63 795f 696e 6465 7865 7329  onfancy_indexes)
-0002ba40: 0a20 2020 2072 6564 7563 6564 5f69 6e64  .    reduced_ind
-0002ba50: 6578 6573 203d 2074 7570 6c65 2872 6564  exes = tuple(red
-0002ba60: 7563 6564 5f69 6e64 6578 6573 290a 0a20  uced_indexes).. 
-0002ba70: 2020 2078 203d 2078 5b6e 6f6e 6661 6e63     x = x[nonfanc
-0002ba80: 795f 696e 6465 7865 735d 0a0a 2020 2020  y_indexes]..    
-0002ba90: 6172 7261 795f 696e 6465 7865 7320 3d20  array_indexes = 
-0002baa0: 7b7d 0a20 2020 2066 6f72 2069 2c20 2869  {}.    for i, (i
-0002bab0: 6e64 2c20 7369 7a65 2920 696e 2065 6e75  nd, size) in enu
-0002bac0: 6d65 7261 7465 287a 6970 2872 6564 7563  merate(zip(reduc
-0002bad0: 6564 5f69 6e64 6578 6573 2c20 782e 7368  ed_indexes, x.sh
-0002bae0: 6170 6529 293a 0a20 2020 2020 2020 2069  ape)):.        i
-0002baf0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0002bb00: 2869 6e64 2c20 736c 6963 6529 3a0a 2020  (ind, slice):.  
-0002bb10: 2020 2020 2020 2020 2020 696e 6420 3d20            ind = 
-0002bb20: 6e70 2e61 7272 6179 2869 6e64 2c20 636f  np.array(ind, co
-0002bb30: 7079 3d54 7275 6529 0a20 2020 2020 2020  py=True).       
-0002bb40: 2020 2020 2069 6620 696e 642e 6474 7970       if ind.dtyp
-0002bb50: 652e 6b69 6e64 203d 3d20 2262 223a 0a20  e.kind == "b":. 
-0002bb60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002bb70: 6169 7365 2049 6e64 6578 4572 726f 7228  aise IndexError(
-0002bb80: 2276 696e 6465 7820 646f 6573 206e 6f74  "vindex does not
-0002bb90: 2073 7570 706f 7274 2069 6e64 6578 696e   support indexin
-0002bba0: 6720 7769 7468 2062 6f6f 6c65 616e 2061  g with boolean a
-0002bbb0: 7272 6179 7322 290a 2020 2020 2020 2020  rrays").        
-0002bbc0: 2020 2020 6966 2028 2869 6e64 203e 3d20      if ((ind >= 
-0002bbd0: 7369 7a65 2920 7c20 2869 6e64 203c 202d  size) | (ind < -
-0002bbe0: 7369 7a65 2929 2e61 6e79 2829 3a0a 2020  size)).any():.  
-0002bbf0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002bc00: 6973 6520 496e 6465 7845 7272 6f72 280a  ise IndexError(.
-0002bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc20: 2020 2020 2276 696e 6465 7820 6b65 7920      "vindex key 
-0002bc30: 6861 7320 656e 7472 6965 7320 6f75 7420  has entries out 
-0002bc40: 6f66 2062 6f75 6e64 7320 666f 7220 220a  of bounds for ".
-0002bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc60: 2020 2020 2269 6e64 6578 696e 6720 616c      "indexing al
-0002bc70: 6f6e 6720 6178 6973 2025 7320 6f66 2073  ong axis %s of s
-0002bc80: 697a 6520 2573 3a20 2572 2220 2520 2869  ize %s: %r" % (i
-0002bc90: 2c20 7369 7a65 2c20 696e 6429 0a20 2020  , size, ind).   
-0002bca0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0002bcb0: 2020 2020 2020 2020 2020 2069 6e64 2025             ind %
-0002bcc0: 3d20 7369 7a65 0a20 2020 2020 2020 2020  = size.         
-0002bcd0: 2020 2061 7272 6179 5f69 6e64 6578 6573     array_indexes
-0002bce0: 5b69 5d20 3d20 696e 640a 0a20 2020 2069  [i] = ind..    i
-0002bcf0: 6620 6172 7261 795f 696e 6465 7865 733a  f array_indexes:
-0002bd00: 0a20 2020 2020 2020 2078 203d 205f 7669  .        x = _vi
-0002bd10: 6e64 6578 5f61 7272 6179 2878 2c20 6172  ndex_array(x, ar
-0002bd20: 7261 795f 696e 6465 7865 7329 0a0a 2020  ray_indexes)..  
-0002bd30: 2020 7265 7475 726e 2078 0a0a 0a64 6566    return x...def
-0002bd40: 205f 7669 6e64 6578 5f61 7272 6179 2878   _vindex_array(x
-0002bd50: 2c20 6469 6374 5f69 6e64 6578 6573 293a  , dict_indexes):
-0002bd60: 0a20 2020 2022 2222 506f 696e 7420 7769  .    """Point wi
-0002bd70: 7365 2069 6e64 6578 696e 6720 7769 7468  se indexing with
-0002bd80: 206f 6e6c 7920 4e75 6d50 7920 4172 7261   only NumPy Arra
-0002bd90: 7973 2e22 2222 0a0a 2020 2020 7472 793a  ys."""..    try:
-0002bda0: 0a20 2020 2020 2020 2062 726f 6164 6361  .        broadca
-0002bdb0: 7374 5f69 6e64 6578 6573 203d 206e 702e  st_indexes = np.
-0002bdc0: 6272 6f61 6463 6173 745f 6172 7261 7973  broadcast_arrays
-0002bdd0: 282a 6469 6374 5f69 6e64 6578 6573 2e76  (*dict_indexes.v
-0002bde0: 616c 7565 7328 2929 0a20 2020 2065 7863  alues()).    exc
-0002bdf0: 6570 7420 5661 6c75 6545 7272 6f72 2061  ept ValueError a
-0002be00: 7320 653a 0a20 2020 2020 2020 2023 206e  s e:.        # n
-0002be10: 6f74 653a 2065 7272 6f72 206d 6573 7361  ote: error messa
-0002be20: 6765 2065 7861 6374 6c79 206d 6174 6368  ge exactly match
-0002be30: 6573 206e 756d 7079 0a20 2020 2020 2020  es numpy.       
-0002be40: 2073 6861 7065 735f 7374 7220 3d20 2220   shapes_str = " 
-0002be50: 222e 6a6f 696e 2873 7472 2861 2e73 6861  ".join(str(a.sha
-0002be60: 7065 2920 666f 7220 6120 696e 2064 6963  pe) for a in dic
-0002be70: 745f 696e 6465 7865 732e 7661 6c75 6573  t_indexes.values
-0002be80: 2829 290a 2020 2020 2020 2020 7261 6973  ()).        rais
-0002be90: 6520 496e 6465 7845 7272 6f72 280a 2020  e IndexError(.  
-0002bea0: 2020 2020 2020 2020 2020 2273 6861 7065            "shape
-0002beb0: 206d 6973 6d61 7463 683a 2069 6e64 6578   mismatch: index
-0002bec0: 696e 6720 6172 7261 7973 2063 6f75 6c64  ing arrays could
-0002bed0: 206e 6f74 2062 6520 220a 2020 2020 2020   not be ".      
-0002bee0: 2020 2020 2020 2262 726f 6164 6361 7374        "broadcast
-0002bef0: 2074 6f67 6574 6865 7220 7769 7468 2073   together with s
-0002bf00: 6861 7065 7320 2220 2b20 7368 6170 6573  hapes " + shapes
-0002bf10: 5f73 7472 0a20 2020 2020 2020 2029 2066  _str.        ) f
-0002bf20: 726f 6d20 650a 2020 2020 6272 6f61 6463  rom e.    broadc
-0002bf30: 6173 745f 7368 6170 6520 3d20 6272 6f61  ast_shape = broa
-0002bf40: 6463 6173 745f 696e 6465 7865 735b 305d  dcast_indexes[0]
-0002bf50: 2e73 6861 7065 0a0a 2020 2020 6c6f 6f6b  .shape..    look
-0002bf60: 7570 203d 2064 6963 7428 7a69 7028 6469  up = dict(zip(di
-0002bf70: 6374 5f69 6e64 6578 6573 2c20 6272 6f61  ct_indexes, broa
-0002bf80: 6463 6173 745f 696e 6465 7865 7329 290a  dcast_indexes)).
-0002bf90: 2020 2020 666c 6174 5f69 6e64 6578 6573      flat_indexes
-0002bfa0: 203d 205b 0a20 2020 2020 2020 206c 6f6f   = [.        loo
-0002bfb0: 6b75 705b 695d 2e72 6176 656c 2829 2e74  kup[i].ravel().t
-0002bfc0: 6f6c 6973 7428 2920 6966 2069 2069 6e20  olist() if i in 
-0002bfd0: 6c6f 6f6b 7570 2065 6c73 6520 4e6f 6e65  lookup else None
-0002bfe0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0002bff0: 782e 6e64 696d 290a 2020 2020 5d0a 2020  x.ndim).    ].  
-0002c000: 2020 666c 6174 5f69 6e64 6578 6573 2e65    flat_indexes.e
-0002c010: 7874 656e 6428 5b4e 6f6e 655d 202a 2028  xtend([None] * (
-0002c020: 782e 6e64 696d 202d 206c 656e 2866 6c61  x.ndim - len(fla
-0002c030: 745f 696e 6465 7865 7329 2929 0a0a 2020  t_indexes)))..  
-0002c040: 2020 666c 6174 5f69 6e64 6578 6573 203d    flat_indexes =
-0002c050: 205b 0a20 2020 2020 2020 206c 6973 7428   [.        list(
-0002c060: 696e 6465 7829 2069 6620 696e 6465 7820  index) if index 
-0002c070: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
-0002c080: 2069 6e64 6578 2066 6f72 2069 6e64 6578   index for index
-0002c090: 2069 6e20 666c 6174 5f69 6e64 6578 6573   in flat_indexes
-0002c0a0: 0a20 2020 205d 0a20 2020 2062 6f75 6e64  .    ].    bound
-0002c0b0: 7320 3d20 5b6c 6973 7428 6163 6375 6d75  s = [list(accumu
-0002c0c0: 6c61 7465 2861 6464 2c20 2830 2c29 202b  late(add, (0,) +
-0002c0d0: 2063 2929 2066 6f72 2063 2069 6e20 782e   c)) for c in x.
-0002c0e0: 6368 756e 6b73 5d0a 2020 2020 626f 756e  chunks].    boun
-0002c0f0: 6473 3220 3d20 5b62 2066 6f72 2069 2c20  ds2 = [b for i, 
-0002c100: 6220 696e 207a 6970 2866 6c61 745f 696e  b in zip(flat_in
-0002c110: 6465 7865 732c 2062 6f75 6e64 7329 2069  dexes, bounds) i
-0002c120: 6620 6920 6973 206e 6f74 204e 6f6e 655d  f i is not None]
-0002c130: 0a20 2020 2061 7869 7320 3d20 5f67 6574  .    axis = _get
-0002c140: 5f61 7869 7328 666c 6174 5f69 6e64 6578  _axis(flat_index
-0002c150: 6573 290a 2020 2020 746f 6b65 6e20 3d20  es).    token = 
-0002c160: 746f 6b65 6e69 7a65 2878 2c20 666c 6174  tokenize(x, flat
-0002c170: 5f69 6e64 6578 6573 290a 2020 2020 6f75  _indexes).    ou
-0002c180: 745f 6e61 6d65 203d 2022 7669 6e64 6578  t_name = "vindex
-0002c190: 2d6d 6572 6765 2d22 202b 2074 6f6b 656e  -merge-" + token
-0002c1a0: 0a0a 2020 2020 706f 696e 7473 203d 206c  ..    points = l
-0002c1b0: 6973 7428 290a 2020 2020 666f 7220 692c  ist().    for i,
-0002c1c0: 2069 6478 2069 6e20 656e 756d 6572 6174   idx in enumerat
-0002c1d0: 6528 7a69 7028 2a5b 6920 666f 7220 6920  e(zip(*[i for i 
-0002c1e0: 696e 2066 6c61 745f 696e 6465 7865 7320  in flat_indexes 
-0002c1f0: 6966 2069 2069 7320 6e6f 7420 4e6f 6e65  if i is not None
-0002c200: 5d29 293a 0a20 2020 2020 2020 2062 6c6f  ])):.        blo
-0002c210: 636b 5f69 6478 203d 205b 6269 7365 6374  ck_idx = [bisect
-0002c220: 2862 2c20 696e 6429 202d 2031 2066 6f72  (b, ind) - 1 for
-0002c230: 2062 2c20 696e 6420 696e 207a 6970 2862   b, ind in zip(b
-0002c240: 6f75 6e64 7332 2c20 6964 7829 5d0a 2020  ounds2, idx)].  
-0002c250: 2020 2020 2020 696e 626c 6f63 6b5f 6964        inblock_id
-0002c260: 7820 3d20 5b0a 2020 2020 2020 2020 2020  x = [.          
-0002c270: 2020 696e 6420 2d20 626f 756e 6473 325b    ind - bounds2[
-0002c280: 6b5d 5b6a 5d20 666f 7220 6b2c 2028 696e  k][j] for k, (in
-0002c290: 642c 206a 2920 696e 2065 6e75 6d65 7261  d, j) in enumera
-0002c2a0: 7465 287a 6970 2869 6478 2c20 626c 6f63  te(zip(idx, bloc
-0002c2b0: 6b5f 6964 7829 290a 2020 2020 2020 2020  k_idx)).        
-0002c2c0: 5d0a 2020 2020 2020 2020 706f 696e 7473  ].        points
-0002c2d0: 2e61 7070 656e 6428 2869 2c20 7475 706c  .append((i, tupl
-0002c2e0: 6528 626c 6f63 6b5f 6964 7829 2c20 7475  e(block_idx), tu
-0002c2f0: 706c 6528 696e 626c 6f63 6b5f 6964 7829  ple(inblock_idx)
-0002c300: 2929 0a0a 2020 2020 6368 756e 6b73 203d  ))..    chunks =
-0002c310: 205b 6320 666f 7220 692c 2063 2069 6e20   [c for i, c in 
-0002c320: 7a69 7028 666c 6174 5f69 6e64 6578 6573  zip(flat_indexes
-0002c330: 2c20 782e 6368 756e 6b73 2920 6966 2069  , x.chunks) if i
-0002c340: 2069 7320 4e6f 6e65 5d0a 2020 2020 6368   is None].    ch
-0002c350: 756e 6b73 2e69 6e73 6572 7428 302c 2028  unks.insert(0, (
-0002c360: 6c65 6e28 706f 696e 7473 292c 2920 6966  len(points),) if
-0002c370: 2070 6f69 6e74 7320 656c 7365 2028 302c   points else (0,
-0002c380: 2929 0a20 2020 2063 6875 6e6b 7320 3d20  )).    chunks = 
-0002c390: 7475 706c 6528 6368 756e 6b73 290a 0a20  tuple(chunks).. 
-0002c3a0: 2020 2069 6620 706f 696e 7473 3a0a 2020     if points:.  
-0002c3b0: 2020 2020 2020 7065 725f 626c 6f63 6b20        per_block 
-0002c3c0: 3d20 6772 6f75 7062 7928 312c 2070 6f69  = groupby(1, poi
-0002c3d0: 6e74 7329 0a20 2020 2020 2020 2070 6572  nts).        per
-0002c3e0: 5f62 6c6f 636b 203d 207b 6b3a 2076 2066  _block = {k: v f
-0002c3f0: 6f72 206b 2c20 7620 696e 2070 6572 5f62  or k, v in per_b
-0002c400: 6c6f 636b 2e69 7465 6d73 2829 2069 6620  lock.items() if 
-0002c410: 767d 0a0a 2020 2020 2020 2020 6f74 6865  v}..        othe
-0002c420: 725f 626c 6f63 6b73 203d 206c 6973 7428  r_blocks = list(
-0002c430: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-0002c440: 6475 6374 280a 2020 2020 2020 2020 2020  duct(.          
-0002c450: 2020 2020 2020 2a5b 0a20 2020 2020 2020        *[.       
-0002c460: 2020 2020 2020 2020 2020 2020 206c 6973               lis
-0002c470: 7428 7261 6e67 6528 6c65 6e28 6329 2929  t(range(len(c)))
-0002c480: 2069 6620 6920 6973 204e 6f6e 6520 656c   if i is None el
-0002c490: 7365 205b 4e6f 6e65 5d0a 2020 2020 2020  se [None].      
-0002c4a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0002c4b0: 7220 692c 2063 2069 6e20 7a69 7028 666c  r i, c in zip(fl
-0002c4c0: 6174 5f69 6e64 6578 6573 2c20 782e 6368  at_indexes, x.ch
-0002c4d0: 756e 6b73 290a 2020 2020 2020 2020 2020  unks).          
-0002c4e0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002c4f0: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
-0002c500: 0a20 2020 2020 2020 2066 756c 6c5f 736c  .        full_sl
-0002c510: 6963 6573 203d 205b 736c 6963 6528 4e6f  ices = [slice(No
-0002c520: 6e65 2c20 4e6f 6e65 2920 6966 2069 2069  ne, None) if i i
-0002c530: 7320 4e6f 6e65 2065 6c73 6520 4e6f 6e65  s None else None
-0002c540: 2066 6f72 2069 2069 6e20 666c 6174 5f69   for i in flat_i
-0002c550: 6e64 6578 6573 5d0a 0a20 2020 2020 2020  ndexes]..       
-0002c560: 206e 616d 6520 3d20 2276 696e 6465 782d   name = "vindex-
-0002c570: 736c 6963 652d 2220 2b20 746f 6b65 6e0a  slice-" + token.
-0002c580: 2020 2020 2020 2020 7669 6e64 6578 5f6d          vindex_m
-0002c590: 6572 6765 5f6e 616d 6520 3d20 2276 696e  erge_name = "vin
-0002c5a0: 6465 782d 6d65 7267 652d 2220 2b20 746f  dex-merge-" + to
-0002c5b0: 6b65 6e0a 2020 2020 2020 2020 6473 6b20  ken.        dsk 
-0002c5c0: 3d20 7b7d 0a20 2020 2020 2020 2066 6f72  = {}.        for
-0002c5d0: 206f 6b65 7920 696e 206f 7468 6572 5f62   okey in other_b
-0002c5e0: 6c6f 636b 733a 0a20 2020 2020 2020 2020  locks:.         
-0002c5f0: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
-0002c600: 2065 6e75 6d65 7261 7465 2870 6572 5f62   enumerate(per_b
-0002c610: 6c6f 636b 293a 0a20 2020 2020 2020 2020  lock):.         
-0002c620: 2020 2020 2020 2064 736b 5b6b 6579 6e61         dsk[keyna
-0002c630: 6d65 286e 616d 652c 2069 2c20 6f6b 6579  me(name, i, okey
-0002c640: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
-0002c650: 2020 2020 2020 2020 2020 205f 7669 6e64             _vind
-0002c660: 6578 5f74 7261 6e73 706f 7365 2c0a 2020  ex_transpose,.  
-0002c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c680: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0002c690: 2020 2020 2020 2020 2020 2020 5f76 696e              _vin
-0002c6a0: 6465 785f 736c 6963 652c 0a20 2020 2020  dex_slice,.     
-0002c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c6c0: 2020 2028 782e 6e61 6d65 2c29 202b 2069     (x.name,) + i
-0002c6d0: 6e74 6572 6c65 6176 655f 6e6f 6e65 286f  nterleave_none(o
-0002c6e0: 6b65 792c 206b 6579 292c 0a20 2020 2020  key, key),.     
-0002c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c700: 2020 2069 6e74 6572 6c65 6176 655f 6e6f     interleave_no
-0002c710: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
-0002c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c730: 6675 6c6c 5f73 6c69 6365 732c 206c 6973  full_slices, lis
-0002c740: 7428 7a69 7028 2a70 6c75 636b 2832 2c20  t(zip(*pluck(2, 
-0002c750: 7065 725f 626c 6f63 6b5b 6b65 795d 2929  per_block[key]))
-0002c760: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002c770: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0002c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c790: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0002c7a0: 2020 2020 2020 2020 6178 6973 2c0a 2020          axis,.  
-0002c7b0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002c7c0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-0002c7d0: 6b65 796e 616d 6528 7669 6e64 6578 5f6d  keyname(vindex_m
-0002c7e0: 6572 6765 5f6e 616d 652c 2030 2c20 6f6b  erge_name, 0, ok
-0002c7f0: 6579 295d 203d 2028 0a20 2020 2020 2020  ey)] = (.       
-0002c800: 2020 2020 2020 2020 205f 7669 6e64 6578           _vindex
-0002c810: 5f6d 6572 6765 2c0a 2020 2020 2020 2020  _merge,.        
-0002c820: 2020 2020 2020 2020 5b6c 6973 7428 706c          [list(pl
-0002c830: 7563 6b28 302c 2070 6572 5f62 6c6f 636b  uck(0, per_block
-0002c840: 5b6b 6579 5d29 2920 666f 7220 6b65 7920  [key])) for key 
-0002c850: 696e 2070 6572 5f62 6c6f 636b 5d2c 0a20  in per_block],. 
-0002c860: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002c870: 6b65 796e 616d 6528 6e61 6d65 2c20 692c  keyname(name, i,
-0002c880: 206f 6b65 7929 2066 6f72 2069 2069 6e20   okey) for i in 
-0002c890: 7261 6e67 6528 6c65 6e28 7065 725f 626c  range(len(per_bl
-0002c8a0: 6f63 6b29 295d 2c0a 2020 2020 2020 2020  ock))],.        
-0002c8b0: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-0002c8c0: 6573 756c 745f 3164 203d 2041 7272 6179  esult_1d = Array
-0002c8d0: 280a 2020 2020 2020 2020 2020 2020 4869  (.            Hi
-0002c8e0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-0002c8f0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6f75  m_collections(ou
-0002c900: 745f 6e61 6d65 2c20 6473 6b2c 2064 6570  t_name, dsk, dep
-0002c910: 656e 6465 6e63 6965 733d 5b78 5d29 2c0a  endencies=[x]),.
-0002c920: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0002c930: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0002c940: 2020 6368 756e 6b73 2c0a 2020 2020 2020    chunks,.      
-0002c950: 2020 2020 2020 782e 6474 7970 652c 0a20        x.dtype,. 
-0002c960: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-0002c970: 782e 5f6d 6574 612c 0a20 2020 2020 2020  x._meta,.       
-0002c980: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-0002c990: 6e20 7265 7375 6c74 5f31 642e 7265 7368  n result_1d.resh
-0002c9a0: 6170 6528 6272 6f61 6463 6173 745f 7368  ape(broadcast_sh
-0002c9b0: 6170 6520 2b20 7265 7375 6c74 5f31 642e  ape + result_1d.
-0002c9c0: 7368 6170 655b 313a 5d29 0a0a 2020 2020  shape[1:])..    
-0002c9d0: 2320 6f75 7470 7574 2068 6173 2061 207a  # output has a z
-0002c9e0: 6572 6f20 6469 6d65 6e73 696f 6e2c 206a  ero dimension, j
-0002c9f0: 7573 7420 6372 6561 7465 2061 206e 6577  ust create a new
-0002ca00: 207a 6572 6f2d 7368 6170 6520 6172 7261   zero-shape arra
-0002ca10: 7920 7769 7468 2074 6865 0a20 2020 2023  y with the.    #
-0002ca20: 2073 616d 6520 6474 7970 650a 2020 2020   same dtype.    
-0002ca30: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
-0002ca40: 7772 6170 2069 6d70 6f72 7420 656d 7074  wrap import empt
-0002ca50: 790a 0a20 2020 2072 6573 756c 745f 3164  y..    result_1d
-0002ca60: 203d 2065 6d70 7479 280a 2020 2020 2020   = empty(.      
-0002ca70: 2020 7475 706c 6528 6d61 7028 7375 6d2c    tuple(map(sum,
-0002ca80: 2063 6875 6e6b 7329 292c 2063 6875 6e6b   chunks)), chunk
-0002ca90: 733d 6368 756e 6b73 2c20 6474 7970 653d  s=chunks, dtype=
-0002caa0: 782e 6474 7970 652c 206e 616d 653d 6f75  x.dtype, name=ou
-0002cab0: 745f 6e61 6d65 0a20 2020 2029 0a20 2020  t_name.    ).   
-0002cac0: 2072 6574 7572 6e20 7265 7375 6c74 5f31   return result_1
-0002cad0: 642e 7265 7368 6170 6528 6272 6f61 6463  d.reshape(broadc
-0002cae0: 6173 745f 7368 6170 6520 2b20 7265 7375  ast_shape + resu
-0002caf0: 6c74 5f31 642e 7368 6170 655b 313a 5d29  lt_1d.shape[1:])
-0002cb00: 0a0a 0a64 6566 205f 6765 745f 6178 6973  ...def _get_axis
-0002cb10: 2869 6e64 6578 6573 293a 0a20 2020 2022  (indexes):.    "
-0002cb20: 2222 4765 7420 6178 6973 2061 6c6f 6e67  ""Get axis along
-0002cb30: 2077 6869 6368 2070 6f69 6e74 2d77 6973   which point-wis
-0002cb40: 6520 736c 6963 696e 6720 7265 7375 6c74  e slicing result
-0002cb50: 7320 6c69 650a 0a20 2020 2054 6869 7320  s lie..    This 
-0002cb60: 6973 206d 6f73 746c 7920 6120 6861 636b  is mostly a hack
-0002cb70: 2062 6563 6175 7365 2049 2063 616e 2774   because I can't
-0002cb80: 2066 6967 7572 6520 6f75 7420 4e75 6d50   figure out NumP
-0002cb90: 7927 7320 7275 6c65 206f 6e20 7468 6973  y's rule on this
-0002cba0: 2061 6e64 0a20 2020 2063 616e 2774 2062   and.    can't b
-0002cbb0: 6520 626f 7468 6572 6564 2074 6f20 676f  e bothered to go
-0002cbc0: 2072 6561 6469 6e67 2e0a 0a20 2020 203e   reading...    >
-0002cbd0: 3e3e 205f 6765 745f 6178 6973 285b 5b31  >> _get_axis([[1
-0002cbe0: 2c20 325d 2c20 4e6f 6e65 2c20 5b31 2c20  , 2], None, [1, 
-0002cbf0: 325d 2c20 4e6f 6e65 5d29 0a20 2020 2030  2], None]).    0
-0002cc00: 0a20 2020 203e 3e3e 205f 6765 745f 6178  .    >>> _get_ax
-0002cc10: 6973 285b 4e6f 6e65 2c20 5b31 2c20 325d  is([None, [1, 2]
-0002cc20: 2c20 5b31 2c20 325d 2c20 4e6f 6e65 5d29  , [1, 2], None])
-0002cc30: 0a20 2020 2031 0a20 2020 203e 3e3e 205f  .    1.    >>> _
-0002cc40: 6765 745f 6178 6973 285b 4e6f 6e65 2c20  get_axis([None, 
-0002cc50: 4e6f 6e65 2c20 5b31 2c20 325d 2c20 5b31  None, [1, 2], [1
-0002cc60: 2c20 325d 5d29 0a20 2020 2032 0a20 2020  , 2]]).    2.   
-0002cc70: 2022 2222 0a20 2020 206e 6469 6d20 3d20   """.    ndim = 
-0002cc80: 6c65 6e28 696e 6465 7865 7329 0a20 2020  len(indexes).   
-0002cc90: 2069 6e64 6578 6573 203d 205b 736c 6963   indexes = [slic
-0002cca0: 6528 4e6f 6e65 2c20 4e6f 6e65 2920 6966  e(None, None) if
-0002ccb0: 2069 2069 7320 4e6f 6e65 2065 6c73 6520   i is None else 
-0002ccc0: 5b30 5d20 666f 7220 6920 696e 2069 6e64  [0] for i in ind
-0002ccd0: 6578 6573 5d0a 2020 2020 7820 3d20 6e70  exes].    x = np
-0002cce0: 2e65 6d70 7479 2828 322c 2920 2a20 6e64  .empty((2,) * nd
-0002ccf0: 696d 290a 2020 2020 7832 203d 2078 5b74  im).    x2 = x[t
-0002cd00: 7570 6c65 2869 6e64 6578 6573 295d 0a20  uple(indexes)]. 
-0002cd10: 2020 2072 6574 7572 6e20 7832 2e73 6861     return x2.sha
-0002cd20: 7065 2e69 6e64 6578 2831 290a 0a0a 6465  pe.index(1)...de
-0002cd30: 6620 5f76 696e 6465 785f 736c 6963 6528  f _vindex_slice(
-0002cd40: 626c 6f63 6b2c 2070 6f69 6e74 7329 3a0a  block, points):.
-0002cd50: 2020 2020 2222 2250 756c 6c20 6f75 7420      """Pull out 
-0002cd60: 706f 696e 742d 7769 7365 2073 6c69 6365  point-wise slice
-0002cd70: 7320 6672 6f6d 2062 6c6f 636b 2222 220a  s from block""".
-0002cd80: 2020 2020 706f 696e 7473 203d 205b 7020      points = [p 
-0002cd90: 6966 2069 7369 6e73 7461 6e63 6528 702c  if isinstance(p,
-0002cda0: 2073 6c69 6365 2920 656c 7365 206c 6973   slice) else lis
-0002cdb0: 7428 7029 2066 6f72 2070 2069 6e20 706f  t(p) for p in po
-0002cdc0: 696e 7473 5d0a 2020 2020 7265 7475 726e  ints].    return
-0002cdd0: 2062 6c6f 636b 5b74 7570 6c65 2870 6f69   block[tuple(poi
-0002cde0: 6e74 7329 5d0a 0a0a 6465 6620 5f76 696e  nts)]...def _vin
-0002cdf0: 6465 785f 7472 616e 7370 6f73 6528 626c  dex_transpose(bl
-0002ce00: 6f63 6b2c 2061 7869 7329 3a0a 2020 2020  ock, axis):.    
-0002ce10: 2222 2252 6f74 6174 6520 626c 6f63 6b20  """Rotate block 
-0002ce20: 736f 2074 6861 7420 706f 696e 7473 2061  so that points a
-0002ce30: 7265 206f 6e20 7468 6520 6669 7273 7420  re on the first 
-0002ce40: 6469 6d65 6e73 696f 6e22 2222 0a20 2020  dimension""".   
-0002ce50: 2061 7865 7320 3d20 5b61 7869 735d 202b   axes = [axis] +
-0002ce60: 206c 6973 7428 7261 6e67 6528 6178 6973   list(range(axis
-0002ce70: 2929 202b 206c 6973 7428 7261 6e67 6528  )) + list(range(
-0002ce80: 6178 6973 202b 2031 2c20 626c 6f63 6b2e  axis + 1, block.
-0002ce90: 6e64 696d 2929 0a20 2020 2072 6574 7572  ndim)).    retur
-0002cea0: 6e20 626c 6f63 6b2e 7472 616e 7370 6f73  n block.transpos
-0002ceb0: 6528 6178 6573 290a 0a0a 6465 6620 5f76  e(axes)...def _v
-0002cec0: 696e 6465 785f 6d65 7267 6528 6c6f 6361  index_merge(loca
-0002ced0: 7469 6f6e 732c 2076 616c 7565 7329 3a0a  tions, values):.
-0002cee0: 2020 2020 2222 220a 0a20 2020 203e 3e3e      """..    >>>
-0002cef0: 206c 6f63 6174 696f 6e73 203d 205b 305d   locations = [0]
-0002cf00: 2c20 5b32 2c20 315d 0a20 2020 203e 3e3e  , [2, 1].    >>>
-0002cf10: 2076 616c 7565 7320 3d20 5b6e 702e 6172   values = [np.ar
-0002cf20: 7261 7928 5b5b 312c 2032 2c20 335d 5d29  ray([[1, 2, 3]])
-0002cf30: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
-0002cf40: 2020 2020 6e70 2e61 7272 6179 285b 5b31      np.array([[1
-0002cf50: 302c 2032 302c 2033 305d 2c20 5b34 302c  0, 20, 30], [40,
-0002cf60: 2035 302c 2036 305d 5d29 5d0a 0a20 2020   50, 60]])]..   
-0002cf70: 203e 3e3e 205f 7669 6e64 6578 5f6d 6572   >>> _vindex_mer
-0002cf80: 6765 286c 6f63 6174 696f 6e73 2c20 7661  ge(locations, va
-0002cf90: 6c75 6573 290a 2020 2020 6172 7261 7928  lues).    array(
-0002cfa0: 5b5b 2031 2c20 2032 2c20 2033 5d2c 0a20  [[ 1,  2,  3],. 
-0002cfb0: 2020 2020 2020 2020 2020 5b34 302c 2035            [40, 5
-0002cfc0: 302c 2036 305d 2c0a 2020 2020 2020 2020  0, 60],.        
-0002cfd0: 2020 205b 3130 2c20 3230 2c20 3330 5d5d     [10, 20, 30]]
-0002cfe0: 290a 2020 2020 2222 220a 2020 2020 6c6f  ).    """.    lo
-0002cff0: 6361 7469 6f6e 7320 3d20 6c69 7374 286d  cations = list(m
-0002d000: 6170 286c 6973 742c 206c 6f63 6174 696f  ap(list, locatio
-0002d010: 6e73 2929 0a20 2020 2076 616c 7565 7320  ns)).    values 
-0002d020: 3d20 6c69 7374 2876 616c 7565 7329 0a0a  = list(values)..
-0002d030: 2020 2020 6e20 3d20 7375 6d28 6d61 7028      n = sum(map(
-0002d040: 6c65 6e2c 206c 6f63 6174 696f 6e73 2929  len, locations))
-0002d050: 0a0a 2020 2020 7368 6170 6520 3d20 6c69  ..    shape = li
-0002d060: 7374 2876 616c 7565 735b 305d 2e73 6861  st(values[0].sha
-0002d070: 7065 290a 2020 2020 7368 6170 655b 305d  pe).    shape[0]
-0002d080: 203d 206e 0a20 2020 2073 6861 7065 203d   = n.    shape =
-0002d090: 2074 7570 6c65 2873 6861 7065 290a 0a20   tuple(shape).. 
-0002d0a0: 2020 2064 7479 7065 203d 2076 616c 7565     dtype = value
-0002d0b0: 735b 305d 2e64 7479 7065 0a0a 2020 2020  s[0].dtype..    
-0002d0c0: 7820 3d20 6e70 2e65 6d70 7479 5f6c 696b  x = np.empty_lik
-0002d0d0: 6528 7661 6c75 6573 5b30 5d2c 2064 7479  e(values[0], dty
-0002d0e0: 7065 3d64 7479 7065 2c20 7368 6170 653d  pe=dtype, shape=
-0002d0f0: 7368 6170 6529 0a0a 2020 2020 696e 6420  shape)..    ind 
-0002d100: 3d20 5b73 6c69 6365 284e 6f6e 652c 204e  = [slice(None, N
-0002d110: 6f6e 6529 2066 6f72 2069 2069 6e20 7261  one) for i in ra
-0002d120: 6e67 6528 782e 6e64 696d 295d 0a20 2020  nge(x.ndim)].   
-0002d130: 2066 6f72 206c 6f63 2c20 7661 6c20 696e   for loc, val in
-0002d140: 207a 6970 286c 6f63 6174 696f 6e73 2c20   zip(locations, 
-0002d150: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
-0002d160: 2069 6e64 5b30 5d20 3d20 6c6f 630a 2020   ind[0] = loc.  
-0002d170: 2020 2020 2020 785b 7475 706c 6528 696e        x[tuple(in
-0002d180: 6429 5d20 3d20 7661 6c0a 0a20 2020 2072  d)] = val..    r
-0002d190: 6574 7572 6e20 780a 0a0a 6465 6620 746f  eturn x...def to
-0002d1a0: 5f6e 7079 5f73 7461 636b 2864 6972 6e61  _npy_stack(dirna
-0002d1b0: 6d65 2c20 782c 2061 7869 733d 3029 3a0a  me, x, axis=0):.
-0002d1c0: 2020 2020 2222 2257 7269 7465 2064 6173      """Write das
-0002d1d0: 6b20 6172 7261 7920 746f 2061 2073 7461  k array to a sta
-0002d1e0: 636b 206f 6620 2e6e 7079 2066 696c 6573  ck of .npy files
-0002d1f0: 0a0a 2020 2020 5468 6973 2070 6172 7469  ..    This parti
-0002d200: 7469 6f6e 7320 7468 6520 6461 736b 2e61  tions the dask.a
-0002d210: 7272 6179 2061 6c6f 6e67 206f 6e65 2061  rray along one a
-0002d220: 7869 7320 616e 6420 7374 6f72 6573 2065  xis and stores e
-0002d230: 6163 6820 626c 6f63 6b20 616c 6f6e 670a  ach block along.
-0002d240: 2020 2020 7468 6174 2061 7869 7320 6173      that axis as
-0002d250: 2061 2073 696e 676c 6520 2e6e 7079 2066   a single .npy f
-0002d260: 696c 6520 696e 2074 6865 2073 7065 6369  ile in the speci
-0002d270: 6669 6564 2064 6972 6563 746f 7279 0a0a  fied directory..
-0002d280: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002d290: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
-0002d2a0: 3e20 7820 3d20 6461 2e6f 6e65 7328 2835  > x = da.ones((5
-0002d2b0: 2c20 3130 2c20 3130 292c 2063 6875 6e6b  , 10, 10), chunk
-0002d2c0: 733d 2832 2c20 342c 2034 2929 2020 2320  s=(2, 4, 4))  # 
-0002d2d0: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0002d2e0: 2020 203e 3e3e 2064 612e 746f 5f6e 7079     >>> da.to_npy
-0002d2f0: 5f73 7461 636b 2827 6461 7461 2f27 2c20  _stack('data/', 
-0002d300: 782c 2061 7869 733d 3029 2020 2320 646f  x, axis=0)  # do
-0002d310: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
-0002d320: 2020 5468 6520 6060 2e6e 7079 6060 2066    The ``.npy`` f
-0002d330: 696c 6573 2073 746f 7265 206e 756d 7079  iles store numpy
-0002d340: 2061 7272 6179 7320 666f 7220 6060 785b   arrays for ``x[
-0002d350: 303a 325d 2c20 785b 323a 345d 2c20 616e  0:2], x[2:4], an
-0002d360: 6420 785b 343a 355d 6060 0a20 2020 2072  d x[4:5]``.    r
-0002d370: 6573 7065 6374 6976 656c 792c 2061 7320  espectively, as 
-0002d380: 6973 2073 7065 6369 6669 6564 2062 7920  is specified by 
-0002d390: 7468 6520 6368 756e 6b20 7369 7a65 2061  the chunk size a
-0002d3a0: 6c6f 6e67 2074 6865 207a 6572 6f74 6820  long the zeroth 
-0002d3b0: 6178 6973 3a3a 0a0a 2020 2020 2020 2020  axis::..        
-0002d3c0: 2420 7472 6565 2064 6174 612f 0a20 2020  $ tree data/.   
-0002d3d0: 2020 2020 2064 6174 612f 0a20 2020 2020       data/.     
-0002d3e0: 2020 207c 2d2d 2030 2e6e 7079 0a20 2020     |-- 0.npy.   
-0002d3f0: 2020 2020 207c 2d2d 2031 2e6e 7079 0a20       |-- 1.npy. 
-0002d400: 2020 2020 2020 207c 2d2d 2032 2e6e 7079         |-- 2.npy
-0002d410: 0a20 2020 2020 2020 207c 2d2d 2069 6e66  .        |-- inf
-0002d420: 6f0a 0a20 2020 2054 6865 2060 6069 6e66  o..    The ``inf
-0002d430: 6f60 6020 6669 6c65 2073 746f 7265 7320  o`` file stores 
-0002d440: 7468 6520 6474 7970 652c 2063 6875 6e6b  the dtype, chunk
-0002d450: 732c 2061 6e64 2061 7869 7320 696e 666f  s, and axis info
-0002d460: 726d 6174 696f 6e20 6f66 2074 6865 2061  rmation of the a
-0002d470: 7272 6179 2e0a 2020 2020 596f 7520 6361  rray..    You ca
-0002d480: 6e20 6c6f 6164 2074 6865 7365 2073 7461  n load these sta
-0002d490: 636b 7320 7769 7468 2074 6865 203a 6675  cks with the :fu
-0002d4a0: 6e63 3a60 6461 736b 2e61 7272 6179 2e66  nc:`dask.array.f
-0002d4b0: 726f 6d5f 6e70 795f 7374 6163 6b60 2066  rom_npy_stack` f
-0002d4c0: 756e 6374 696f 6e2e 0a0a 2020 2020 3e3e  unction...    >>
-0002d4d0: 3e20 7920 3d20 6461 2e66 726f 6d5f 6e70  > y = da.from_np
-0002d4e0: 795f 7374 6163 6b28 2764 6174 612f 2729  y_stack('data/')
-0002d4f0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002d500: 4950 0a0a 2020 2020 5365 6520 416c 736f  IP..    See Also
-0002d510: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-0002d520: 2020 6672 6f6d 5f6e 7079 5f73 7461 636b    from_npy_stack
-0002d530: 0a20 2020 2022 2222 0a0a 2020 2020 6368  .    """..    ch
-0002d540: 756e 6b73 203d 2074 7570 6c65 2828 6320  unks = tuple((c 
-0002d550: 6966 2069 203d 3d20 6178 6973 2065 6c73  if i == axis els
-0002d560: 6520 2873 756d 2863 292c 2929 2066 6f72  e (sum(c),)) for
-0002d570: 2069 2c20 6320 696e 2065 6e75 6d65 7261   i, c in enumera
-0002d580: 7465 2878 2e63 6875 6e6b 7329 290a 2020  te(x.chunks)).  
-0002d590: 2020 7878 203d 2078 2e72 6563 6875 6e6b    xx = x.rechunk
-0002d5a0: 2863 6875 6e6b 7329 0a0a 2020 2020 6966  (chunks)..    if
-0002d5b0: 206e 6f74 206f 732e 7061 7468 2e65 7869   not os.path.exi
-0002d5c0: 7374 7328 6469 726e 616d 6529 3a0a 2020  sts(dirname):.  
-0002d5d0: 2020 2020 2020 6f73 2e6d 6b64 6972 2864        os.mkdir(d
-0002d5e0: 6972 6e61 6d65 290a 0a20 2020 206d 6574  irname)..    met
-0002d5f0: 6120 3d20 7b22 6368 756e 6b73 223a 2063  a = {"chunks": c
-0002d600: 6875 6e6b 732c 2022 6474 7970 6522 3a20  hunks, "dtype": 
-0002d610: 782e 6474 7970 652c 2022 6178 6973 223a  x.dtype, "axis":
-0002d620: 2061 7869 737d 0a0a 2020 2020 7769 7468   axis}..    with
-0002d630: 206f 7065 6e28 6f73 2e70 6174 682e 6a6f   open(os.path.jo
-0002d640: 696e 2864 6972 6e61 6d65 2c20 2269 6e66  in(dirname, "inf
-0002d650: 6f22 292c 2022 7762 2229 2061 7320 663a  o"), "wb") as f:
-0002d660: 0a20 2020 2020 2020 2070 6963 6b6c 652e  .        pickle.
-0002d670: 6475 6d70 286d 6574 612c 2066 290a 0a20  dump(meta, f).. 
-0002d680: 2020 206e 616d 6520 3d20 2274 6f2d 6e70     name = "to-np
-0002d690: 792d 7374 6163 6b2d 2220 2b20 7374 7228  y-stack-" + str(
-0002d6a0: 7575 6964 2e75 7569 6431 2829 290a 2020  uuid.uuid1()).  
-0002d6b0: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
-0002d6c0: 2020 286e 616d 652c 2069 293a 2028 6e70    (name, i): (np
-0002d6d0: 2e73 6176 652c 206f 732e 7061 7468 2e6a  .save, os.path.j
-0002d6e0: 6f69 6e28 6469 726e 616d 652c 2022 2564  oin(dirname, "%d
-0002d6f0: 2e6e 7079 2220 2520 6929 2c20 6b65 7929  .npy" % i), key)
-0002d700: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
-0002d710: 6b65 7920 696e 2065 6e75 6d65 7261 7465  key in enumerate
-0002d720: 2863 6f72 652e 666c 6174 7465 6e28 7878  (core.flatten(xx
-0002d730: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
-0002d740: 2929 0a20 2020 207d 0a0a 2020 2020 6772  )).    }..    gr
-0002d750: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-0002d760: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-0002d770: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
-0002d780: 2064 6570 656e 6465 6e63 6965 733d 5b78   dependencies=[x
-0002d790: 785d 290a 2020 2020 636f 6d70 7574 655f  x]).    compute_
-0002d7a0: 6173 5f69 665f 636f 6c6c 6563 7469 6f6e  as_if_collection
-0002d7b0: 2841 7272 6179 2c20 6772 6170 682c 206c  (Array, graph, l
-0002d7c0: 6973 7428 6473 6b29 290a 0a0a 6465 6620  ist(dsk))...def 
-0002d7d0: 6672 6f6d 5f6e 7079 5f73 7461 636b 2864  from_npy_stack(d
-0002d7e0: 6972 6e61 6d65 2c20 6d6d 6170 5f6d 6f64  irname, mmap_mod
-0002d7f0: 653d 2272 2229 3a0a 2020 2020 2222 224c  e="r"):.    """L
-0002d800: 6f61 6420 6461 736b 2061 7272 6179 2066  oad dask array f
-0002d810: 726f 6d20 7374 6163 6b20 6f66 206e 7079  rom stack of npy
-0002d820: 2066 696c 6573 0a0a 2020 2020 5061 7261   files..    Para
-0002d830: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-0002d840: 2d2d 2d2d 2d0a 2020 2020 6469 726e 616d  -----.    dirnam
-0002d850: 653a 2073 7472 696e 670a 2020 2020 2020  e: string.      
-0002d860: 2020 4469 7265 6374 6f72 7920 6f66 202e    Directory of .
-0002d870: 6e70 7920 6669 6c65 730a 2020 2020 6d6d  npy files.    mm
-0002d880: 6170 5f6d 6f64 653a 2028 4e6f 6e65 206f  ap_mode: (None o
-0002d890: 7220 2772 2729 0a20 2020 2020 2020 2052  r 'r').        R
-0002d8a0: 6561 6420 6461 7461 2069 6e20 6d65 6d6f  ead data in memo
-0002d8b0: 7279 206d 6170 206d 6f64 650a 0a20 2020  ry map mode..   
-0002d8c0: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
-0002d8d0: 2d2d 2d2d 2d2d 0a20 2020 2074 6f5f 6e70  ------.    to_np
-0002d8e0: 795f 7374 6163 6b0a 2020 2020 2222 220a  y_stack.    """.
-0002d8f0: 2020 2020 7769 7468 206f 7065 6e28 6f73      with open(os
-0002d900: 2e70 6174 682e 6a6f 696e 2864 6972 6e61  .path.join(dirna
-0002d910: 6d65 2c20 2269 6e66 6f22 292c 2022 7262  me, "info"), "rb
-0002d920: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
-0002d930: 2069 6e66 6f20 3d20 7069 636b 6c65 2e6c   info = pickle.l
-0002d940: 6f61 6428 6629 0a0a 2020 2020 6474 7970  oad(f)..    dtyp
-0002d950: 6520 3d20 696e 666f 5b22 6474 7970 6522  e = info["dtype"
-0002d960: 5d0a 2020 2020 6368 756e 6b73 203d 2069  ].    chunks = i
-0002d970: 6e66 6f5b 2263 6875 6e6b 7322 5d0a 2020  nfo["chunks"].  
-0002d980: 2020 6178 6973 203d 2069 6e66 6f5b 2261    axis = info["a
-0002d990: 7869 7322 5d0a 0a20 2020 206e 616d 6520  xis"]..    name 
-0002d9a0: 3d20 2266 726f 6d2d 6e70 792d 7374 6163  = "from-npy-stac
-0002d9b0: 6b2d 2573 2220 2520 6469 726e 616d 650a  k-%s" % dirname.
-0002d9c0: 2020 2020 6b65 7973 203d 206c 6973 7428      keys = list(
-0002d9d0: 7072 6f64 7563 7428 5b6e 616d 655d 2c20  product([name], 
-0002d9e0: 2a5b 7261 6e67 6528 6c65 6e28 6329 2920  *[range(len(c)) 
-0002d9f0: 666f 7220 6320 696e 2063 6875 6e6b 735d  for c in chunks]
-0002da00: 2929 0a20 2020 2076 616c 7565 7320 3d20  )).    values = 
-0002da10: 5b0a 2020 2020 2020 2020 286e 702e 6c6f  [.        (np.lo
-0002da20: 6164 2c20 6f73 2e70 6174 682e 6a6f 696e  ad, os.path.join
-0002da30: 2864 6972 6e61 6d65 2c20 2225 642e 6e70  (dirname, "%d.np
-0002da40: 7922 2025 2069 292c 206d 6d61 705f 6d6f  y" % i), mmap_mo
-0002da50: 6465 290a 2020 2020 2020 2020 666f 7220  de).        for 
-0002da60: 6920 696e 2072 616e 6765 286c 656e 2863  i in range(len(c
-0002da70: 6875 6e6b 735b 6178 6973 5d29 290a 2020  hunks[axis])).  
-0002da80: 2020 5d0a 2020 2020 6473 6b20 3d20 6469    ].    dsk = di
-0002da90: 6374 287a 6970 286b 6579 732c 2076 616c  ct(zip(keys, val
-0002daa0: 7565 7329 290a 0a20 2020 2072 6574 7572  ues))..    retur
-0002dab0: 6e20 4172 7261 7928 6473 6b2c 206e 616d  n Array(dsk, nam
-0002dac0: 652c 2063 6875 6e6b 732c 2064 7479 7065  e, chunks, dtype
-0002dad0: 290a 0a0a 6465 6620 6e65 775f 6461 5f6f  )...def new_da_o
-0002dae0: 626a 6563 7428 6473 6b2c 206e 616d 652c  bject(dsk, name,
-0002daf0: 2063 6875 6e6b 732c 206d 6574 613d 4e6f   chunks, meta=No
-0002db00: 6e65 2c20 6474 7970 653d 4e6f 6e65 293a  ne, dtype=None):
-0002db10: 0a20 2020 2022 2222 4765 6e65 7269 6320  .    """Generic 
-0002db20: 636f 6e73 7472 7563 746f 7220 666f 7220  constructor for 
-0002db30: 6461 736b 2e61 7272 6179 206f 7220 6461  dask.array or da
-0002db40: 736b 2e64 6174 6166 7261 6d65 206f 626a  sk.dataframe obj
-0002db50: 6563 7473 2e0a 0a20 2020 2044 6563 6964  ects...    Decid
-0002db60: 6573 2074 6865 2061 7070 726f 7072 6961  es the appropria
-0002db70: 7465 206f 7574 7075 7420 636c 6173 7320  te output class 
-0002db80: 6261 7365 6420 6f6e 2074 6865 2074 7970  based on the typ
-0002db90: 6520 6f66 2060 6d65 7461 6020 7072 6f76  e of `meta` prov
-0002dba0: 6964 6564 2e0a 2020 2020 2222 220a 2020  ided..    """.  
-0002dbb0: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-0002dbc0: 655f 6c69 6b65 286d 6574 6129 206f 7220  e_like(meta) or 
-0002dbd0: 6973 5f73 6572 6965 735f 6c69 6b65 286d  is_series_like(m
-0002dbe0: 6574 6129 206f 7220 6973 5f69 6e64 6578  eta) or is_index
-0002dbf0: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
-0002dc00: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-0002dc10: 6174 6166 7261 6d65 2e63 6f72 6520 696d  ataframe.core im
-0002dc20: 706f 7274 206e 6577 5f64 645f 6f62 6a65  port new_dd_obje
-0002dc30: 6374 0a0a 2020 2020 2020 2020 6173 7365  ct..        asse
-0002dc40: 7274 2061 6c6c 286c 656e 2863 2920 3d3d  rt all(len(c) ==
-0002dc50: 2031 2066 6f72 2063 2069 6e20 6368 756e   1 for c in chun
-0002dc60: 6b73 5b31 3a5d 290a 2020 2020 2020 2020  ks[1:]).        
-0002dc70: 6469 7669 7369 6f6e 7320 3d20 5b4e 6f6e  divisions = [Non
-0002dc80: 655d 202a 2028 6c65 6e28 6368 756e 6b73  e] * (len(chunks
-0002dc90: 5b30 5d29 202b 2031 290a 2020 2020 2020  [0]) + 1).      
-0002dca0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-0002dcb0: 6f62 6a65 6374 2864 736b 2c20 6e61 6d65  object(dsk, name
-0002dcc0: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-0002dcd0: 7329 0a20 2020 2065 6c73 653a 0a20 2020  s).    else:.   
-0002dce0: 2020 2020 2072 6574 7572 6e20 4172 7261       return Arra
-0002dcf0: 7928 6473 6b2c 206e 616d 653d 6e61 6d65  y(dsk, name=name
-0002dd00: 2c20 6368 756e 6b73 3d63 6875 6e6b 732c  , chunks=chunks,
-0002dd10: 206d 6574 613d 6d65 7461 2c20 6474 7970   meta=meta, dtyp
-0002dd20: 653d 6474 7970 6529 0a0a 0a63 6c61 7373  e=dtype)...class
-0002dd30: 2042 6c6f 636b 5669 6577 3a0a 2020 2020   BlockView:.    
-0002dd40: 2222 2241 6e20 6172 7261 792d 6c69 6b65  """An array-like
-0002dd50: 2069 6e74 6572 6661 6365 2074 6f20 7468   interface to th
-0002dd60: 6520 626c 6f63 6b73 206f 6620 616e 2061  e blocks of an a
-0002dd70: 7272 6179 2e0a 0a20 2020 2060 6042 6c6f  rray...    ``Blo
-0002dd80: 636b 5669 6577 6060 2070 726f 7669 6465  ckView`` provide
-0002dd90: 7320 616e 2061 7272 6179 2d6c 696b 6520  s an array-like 
-0002dda0: 696e 7465 7266 6163 650a 2020 2020 746f  interface.    to
-0002ddb0: 2074 6865 2062 6c6f 636b 7320 6f66 2061   the blocks of a
-0002ddc0: 2064 6173 6b20 6172 7261 792e 2020 4e75   dask array.  Nu
-0002ddd0: 6d70 792d 7374 796c 6520 696e 6465 7869  mpy-style indexi
-0002dde0: 6e67 206f 6620 610a 2020 2020 2060 6042  ng of a.     ``B
-0002ddf0: 6c6f 636b 5669 6577 6060 2072 6574 7572  lockView`` retur
-0002de00: 6e73 2061 2073 656c 6563 7469 6f6e 206f  ns a selection o
-0002de10: 6620 626c 6f63 6b73 2061 7320 6120 6e65  f blocks as a ne
-0002de20: 7720 6461 736b 2061 7272 6179 2e0a 0a20  w dask array... 
-0002de30: 2020 2059 6f75 2063 616e 2069 6e64 6578     You can index
-0002de40: 2060 6042 6c6f 636b 5669 6577 6060 206c   ``BlockView`` l
-0002de50: 696b 6520 6120 6e75 6d70 7920 6172 7261  ike a numpy arra
-0002de60: 7920 6f66 2073 6861 7065 0a20 2020 2065  y of shape.    e
-0002de70: 7175 616c 2074 6f20 7468 6520 6e75 6d62  qual to the numb
-0002de80: 6572 206f 6620 626c 6f63 6b73 2069 6e20  er of blocks in 
-0002de90: 6561 6368 2064 696d 656e 7369 6f6e 2c20  each dimension, 
-0002dea0: 2861 7661 696c 6162 6c65 2061 730a 2020  (available as.  
-0002deb0: 2020 6172 7261 792e 626c 6f63 6b73 2e73    array.blocks.s
-0002dec0: 697a 6529 2e20 2054 6865 2064 696d 656e  ize).  The dimen
-0002ded0: 7369 6f6e 616c 6974 7920 6f66 2074 6865  sionality of the
-0002dee0: 206f 7574 7075 7420 6172 7261 7920 6d61   output array ma
-0002def0: 7463 6865 730a 2020 2020 7468 6520 6469  tches.    the di
-0002df00: 6d65 6e73 696f 6e20 6f66 2074 6869 7320  mension of this 
-0002df10: 6172 7261 792c 2065 7665 6e20 6966 2069  array, even if i
-0002df20: 6e74 6567 6572 2069 6e64 6963 6573 2061  nteger indices a
-0002df30: 7265 2070 6173 7365 642e 0a20 2020 2053  re passed..    S
-0002df40: 6c69 6369 6e67 2077 6974 6820 6060 6e70  licing with ``np
-0002df50: 2e6e 6577 6178 6973 6060 206f 7220 6d75  .newaxis`` or mu
-0002df60: 6c74 6970 6c65 206c 6973 7473 2069 7320  ltiple lists is 
-0002df70: 6e6f 7420 7375 7070 6f72 7465 642e 0a0a  not supported...
-0002df80: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002df90: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
-0002dfa0: 3e20 696d 706f 7274 2064 6173 6b2e 6172  > import dask.ar
-0002dfb0: 7261 7920 6173 2064 610a 2020 2020 3e3e  ray as da.    >>
-0002dfc0: 3e20 6672 6f6d 2064 6173 6b2e 6172 7261  > from dask.arra
-0002dfd0: 792e 636f 7265 2069 6d70 6f72 7420 426c  y.core import Bl
-0002dfe0: 6f63 6b56 6965 770a 2020 2020 3e3e 3e20  ockView.    >>> 
-0002dff0: 7820 3d20 6461 2e61 7261 6e67 6528 382c  x = da.arange(8,
-0002e000: 2063 6875 6e6b 733d 3229 0a20 2020 203e   chunks=2).    >
-0002e010: 3e3e 2062 7620 3d20 426c 6f63 6b56 6965  >> bv = BlockVie
-0002e020: 7728 7829 0a20 2020 203e 3e3e 2062 762e  w(x).    >>> bv.
-0002e030: 7368 6170 6520 2320 616c 6961 7365 7320  shape # aliases 
-0002e040: 782e 6e75 6d62 6c6f 636b 730a 2020 2020  x.numblocks.    
-0002e050: 2834 2c29 0a20 2020 203e 3e3e 2062 762e  (4,).    >>> bv.
-0002e060: 7369 7a65 0a20 2020 2034 0a20 2020 203e  size.    4.    >
-0002e070: 3e3e 2062 765b 305d 2e63 6f6d 7075 7465  >> bv[0].compute
-0002e080: 2829 0a20 2020 2061 7272 6179 285b 302c  ().    array([0,
-0002e090: 2031 5d29 0a20 2020 203e 3e3e 2062 765b   1]).    >>> bv[
-0002e0a0: 3a33 5d2e 636f 6d70 7574 6528 290a 2020  :3].compute().  
-0002e0b0: 2020 6172 7261 7928 5b30 2c20 312c 2032    array([0, 1, 2
-0002e0c0: 2c20 332c 2034 2c20 355d 290a 2020 2020  , 3, 4, 5]).    
-0002e0d0: 3e3e 3e20 6276 5b3a 3a32 5d2e 636f 6d70  >>> bv[::2].comp
-0002e0e0: 7574 6528 290a 2020 2020 6172 7261 7928  ute().    array(
-0002e0f0: 5b30 2c20 312c 2034 2c20 355d 290a 2020  [0, 1, 4, 5]).  
-0002e100: 2020 3e3e 3e20 6276 5b5b 2d31 2c20 305d    >>> bv[[-1, 0]
-0002e110: 5d2e 636f 6d70 7574 6528 290a 2020 2020  ].compute().    
-0002e120: 6172 7261 7928 5b36 2c20 372c 2030 2c20  array([6, 7, 0, 
-0002e130: 315d 290a 2020 2020 3e3e 3e20 6276 2e72  1]).    >>> bv.r
-0002e140: 6176 656c 2829 2020 2320 646f 6374 6573  avel()  # doctes
-0002e150: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
-0002e160: 4954 4553 5041 4345 0a20 2020 205b 6461  ITESPACE.    [da
-0002e170: 736b 2e61 7272 6179 3c62 6c6f 636b 732c  sk.array<blocks,
-0002e180: 2073 6861 7065 3d28 322c 292c 2064 7479   shape=(2,), dty
-0002e190: 7065 3d69 6e74 3634 2c20 6368 756e 6b73  pe=int64, chunks
-0002e1a0: 697a 653d 2832 2c29 2c20 6368 756e 6b74  ize=(2,), chunkt
-0002e1b0: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
-0002e1c0: 793e 2c0a 2020 2020 2064 6173 6b2e 6172  y>,.     dask.ar
-0002e1d0: 7261 793c 626c 6f63 6b73 2c20 7368 6170  ray<blocks, shap
-0002e1e0: 653d 2832 2c29 2c20 6474 7970 653d 696e  e=(2,), dtype=in
-0002e1f0: 7436 342c 2063 6875 6e6b 7369 7a65 3d28  t64, chunksize=(
-0002e200: 322c 292c 2063 6875 6e6b 7479 7065 3d6e  2,), chunktype=n
-0002e210: 756d 7079 2e6e 6461 7272 6179 3e2c 0a20  umpy.ndarray>,. 
-0002e220: 2020 2020 6461 736b 2e61 7272 6179 3c62      dask.array<b
-0002e230: 6c6f 636b 732c 2073 6861 7065 3d28 322c  locks, shape=(2,
-0002e240: 292c 2064 7479 7065 3d69 6e74 3634 2c20  ), dtype=int64, 
-0002e250: 6368 756e 6b73 697a 653d 2832 2c29 2c20  chunksize=(2,), 
-0002e260: 6368 756e 6b74 7970 653d 6e75 6d70 792e  chunktype=numpy.
-0002e270: 6e64 6172 7261 793e 2c0a 2020 2020 2064  ndarray>,.     d
-0002e280: 6173 6b2e 6172 7261 793c 626c 6f63 6b73  ask.array<blocks
-0002e290: 2c20 7368 6170 653d 2832 2c29 2c20 6474  , shape=(2,), dt
-0002e2a0: 7970 653d 696e 7436 342c 2063 6875 6e6b  ype=int64, chunk
-0002e2b0: 7369 7a65 3d28 322c 292c 2063 6875 6e6b  size=(2,), chunk
-0002e2c0: 7479 7065 3d6e 756d 7079 2e6e 6461 7272  type=numpy.ndarr
-0002e2d0: 6179 3e5d 0a0a 2020 2020 5265 7475 726e  ay>]..    Return
-0002e2e0: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-0002e2f0: 2020 416e 2069 6e73 7461 6e63 6520 6f66    An instance of
-0002e300: 2060 6064 612e 6172 7261 792e 426c 6f63   ``da.array.Bloc
-0002e310: 6b76 6965 7760 600a 2020 2020 2222 220a  kview``.    """.
-0002e320: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-0002e330: 5f28 7365 6c66 2c20 6172 7261 793a 2041  _(self, array: A
-0002e340: 7272 6179 293a 0a20 2020 2020 2020 2073  rray):.        s
-0002e350: 656c 662e 5f61 7272 6179 203d 2061 7272  elf._array = arr
-0002e360: 6179 0a0a 2020 2020 6465 6620 5f5f 6765  ay..    def __ge
-0002e370: 7469 7465 6d5f 5f28 7365 6c66 2c20 696e  titem__(self, in
-0002e380: 6465 783a 2041 6e79 2920 2d3e 2041 7272  dex: Any) -> Arr
-0002e390: 6179 3a0a 2020 2020 2020 2020 6672 6f6d  ay:.        from
-0002e3a0: 2064 6173 6b2e 6172 7261 792e 736c 6963   dask.array.slic
-0002e3b0: 696e 6720 696d 706f 7274 206e 6f72 6d61  ing import norma
-0002e3c0: 6c69 7a65 5f69 6e64 6578 0a0a 2020 2020  lize_index..    
-0002e3d0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0002e3e0: 7461 6e63 6528 696e 6465 782c 2074 7570  tance(index, tup
-0002e3f0: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
-0002e400: 2069 6e64 6578 203d 2028 696e 6465 782c   index = (index,
-0002e410: 290a 2020 2020 2020 2020 6966 2073 756d  ).        if sum
-0002e420: 2869 7369 6e73 7461 6e63 6528 696e 642c  (isinstance(ind,
-0002e430: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
-0002e440: 7374 2929 2066 6f72 2069 6e64 2069 6e20  st)) for ind in 
-0002e450: 696e 6465 7829 203e 2031 3a0a 2020 2020  index) > 1:.    
-0002e460: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002e470: 6c75 6545 7272 6f72 2822 4361 6e20 6f6e  lueError("Can on
-0002e480: 6c79 2073 6c69 6365 2077 6974 6820 6120  ly slice with a 
-0002e490: 7369 6e67 6c65 206c 6973 7422 290a 2020  single list").  
-0002e4a0: 2020 2020 2020 6966 2061 6e79 2869 6e64        if any(ind
-0002e4b0: 2069 7320 4e6f 6e65 2066 6f72 2069 6e64   is None for ind
-0002e4c0: 2069 6e20 696e 6465 7829 3a0a 2020 2020   in index):.    
-0002e4d0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002e4e0: 6c75 6545 7272 6f72 2822 536c 6963 696e  lueError("Slicin
-0002e4f0: 6720 7769 7468 206e 702e 6e65 7761 7869  g with np.newaxi
-0002e500: 7320 6f72 204e 6f6e 6520 6973 206e 6f74  s or None is not
-0002e510: 2073 7570 706f 7274 6564 2229 0a20 2020   supported").   
-0002e520: 2020 2020 2069 6e64 6578 203d 206e 6f72       index = nor
-0002e530: 6d61 6c69 7a65 5f69 6e64 6578 2869 6e64  malize_index(ind
-0002e540: 6578 2c20 7365 6c66 2e5f 6172 7261 792e  ex, self._array.
-0002e550: 6e75 6d62 6c6f 636b 7329 0a20 2020 2020  numblocks).     
-0002e560: 2020 2069 6e64 6578 203d 2074 7570 6c65     index = tuple
-0002e570: 280a 2020 2020 2020 2020 2020 2020 736c  (.            sl
-0002e580: 6963 6528 6b2c 206b 202b 2031 2920 6966  ice(k, k + 1) if
-0002e590: 2069 7369 6e73 7461 6e63 6528 6b2c 204e   isinstance(k, N
-0002e5a0: 756d 6265 7229 2065 6c73 6520 6b20 2023  umber) else k  #
-0002e5b0: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-0002e5c0: 2020 2020 2020 2020 2020 666f 7220 6b20            for k 
-0002e5d0: 696e 2069 6e64 6578 0a20 2020 2020 2020  in index.       
-0002e5e0: 2029 0a0a 2020 2020 2020 2020 6e61 6d65   )..        name
-0002e5f0: 203d 2022 626c 6f63 6b73 2d22 202b 2074   = "blocks-" + t
-0002e600: 6f6b 656e 697a 6528 7365 6c66 2e5f 6172  okenize(self._ar
-0002e610: 7261 792c 2069 6e64 6578 290a 0a20 2020  ray, index)..   
-0002e620: 2020 2020 206e 6577 5f6b 6579 7320 3d20       new_keys = 
-0002e630: 7365 6c66 2e5f 6172 7261 792e 5f6b 6579  self._array._key
-0002e640: 5f61 7272 6179 5b69 6e64 6578 5d0a 0a20  _array[index].. 
-0002e650: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
-0002e660: 7475 706c 6528 0a20 2020 2020 2020 2020  tuple(.         
-0002e670: 2020 2074 7570 6c65 286e 702e 6172 7261     tuple(np.arra
-0002e680: 7928 6329 5b69 5d2e 746f 6c69 7374 2829  y(c)[i].tolist()
-0002e690: 2920 666f 7220 632c 2069 2069 6e20 7a69  ) for c, i in zi
-0002e6a0: 7028 7365 6c66 2e5f 6172 7261 792e 6368  p(self._array.ch
-0002e6b0: 756e 6b73 2c20 696e 6465 7829 0a20 2020  unks, index).   
-0002e6c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0002e6d0: 6b65 7973 203d 2070 726f 6475 6374 282a  keys = product(*
-0002e6e0: 2872 616e 6765 286c 656e 2863 2929 2066  (range(len(c)) f
-0002e6f0: 6f72 2063 2069 6e20 6368 756e 6b73 2929  or c in chunks))
-0002e700: 0a0a 2020 2020 2020 2020 6772 6170 683a  ..        graph:
-0002e710: 2047 7261 7068 203d 207b 286e 616d 652c   Graph = {(name,
-0002e720: 2920 2b20 6b65 793a 2074 7570 6c65 286e  ) + key: tuple(n
-0002e730: 6577 5f6b 6579 735b 6b65 795d 2e74 6f6c  ew_keys[key].tol
-0002e740: 6973 7428 2929 2066 6f72 206b 6579 2069  ist()) for key i
-0002e750: 6e20 6b65 7973 7d0a 0a20 2020 2020 2020  n keys}..       
-0002e760: 2068 6c67 203d 2048 6967 684c 6576 656c   hlg = HighLevel
-0002e770: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0002e780: 6374 696f 6e73 286e 616d 652c 2067 7261  ctions(name, gra
-0002e790: 7068 2c20 6465 7065 6e64 656e 6369 6573  ph, dependencies
-0002e7a0: 3d5b 7365 6c66 2e5f 6172 7261 795d 290a  =[self._array]).
-0002e7b0: 2020 2020 2020 2020 7265 7475 726e 2041          return A
-0002e7c0: 7272 6179 2868 6c67 2c20 6e61 6d65 2c20  rray(hlg, name, 
-0002e7d0: 6368 756e 6b73 2c20 6d65 7461 3d73 656c  chunks, meta=sel
-0002e7e0: 662e 5f61 7272 6179 290a 0a20 2020 2064  f._array)..    d
-0002e7f0: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
-0002e800: 6f74 6865 723a 2041 6e79 2920 2d3e 2062  other: Any) -> b
-0002e810: 6f6f 6c3a 0a20 2020 2020 2020 2069 6620  ool:.        if 
-0002e820: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-0002e830: 2c20 426c 6f63 6b56 6965 7729 3a0a 2020  , BlockView):.  
-0002e840: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002e850: 2073 656c 662e 5f61 7272 6179 2069 7320   self._array is 
-0002e860: 6f74 6865 722e 5f61 7272 6179 0a20 2020  other._array.   
-0002e870: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002e880: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-0002e890: 7449 6d70 6c65 6d65 6e74 6564 0a0a 2020  tImplemented..  
-0002e8a0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0002e8b0: 6465 6620 7369 7a65 2873 656c 6629 202d  def size(self) -
-0002e8c0: 3e20 696e 743a 0a20 2020 2020 2020 2022  > int:.        "
-0002e8d0: 2222 0a20 2020 2020 2020 2054 6865 2074  "".        The t
-0002e8e0: 6f74 616c 206e 756d 6265 7220 6f66 2062  otal number of b
-0002e8f0: 6c6f 636b 7320 696e 2074 6865 2061 7272  locks in the arr
-0002e900: 6179 2e0a 2020 2020 2020 2020 2222 220a  ay..        """.
-0002e910: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0002e920: 6174 682e 7072 6f64 2873 656c 662e 7368  ath.prod(self.sh
-0002e930: 6170 6529 0a0a 2020 2020 4070 726f 7065  ape)..    @prope
-0002e940: 7274 790a 2020 2020 6465 6620 7368 6170  rty.    def shap
-0002e950: 6528 7365 6c66 2920 2d3e 2074 7570 6c65  e(self) -> tuple
-0002e960: 5b69 6e74 2c20 2e2e 2e5d 3a0a 2020 2020  [int, ...]:.    
-0002e970: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002e980: 5468 6520 6e75 6d62 6572 206f 6620 626c  The number of bl
-0002e990: 6f63 6b73 2070 6572 2061 7869 732e 2041  ocks per axis. A
-0002e9a0: 6c69 6173 206f 6620 6060 6461 736b 2e61  lias of ``dask.a
-0002e9b0: 7272 6179 2e6e 756d 626c 6f63 6b73 6060  rray.numblocks``
-0002e9c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0002e9d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002e9e0: 662e 5f61 7272 6179 2e6e 756d 626c 6f63  f._array.numbloc
-0002e9f0: 6b73 0a0a 2020 2020 6465 6620 7261 7665  ks..    def rave
-0002ea00: 6c28 7365 6c66 2920 2d3e 206c 6973 745b  l(self) -> list[
-0002ea10: 4172 7261 795d 3a0a 2020 2020 2020 2020  Array]:.        
-0002ea20: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
-0002ea30: 726e 2061 2066 6c61 7474 656e 6564 206c  rn a flattened l
-0002ea40: 6973 7420 6f66 2061 6c6c 2074 6865 2062  ist of all the b
-0002ea50: 6c6f 636b 7320 696e 2074 6865 2061 7272  locks in the arr
-0002ea60: 6179 2069 6e20 4320 6f72 6465 722e 0a20  ay in C order.. 
-0002ea70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002ea80: 2020 2072 6574 7572 6e20 5b73 656c 665b     return [self[
-0002ea90: 6964 785d 2066 6f72 2069 6478 2069 6e20  idx] for idx in 
-0002eaa0: 6e70 2e6e 6469 6e64 6578 2873 656c 662e  np.ndindex(self.
-0002eab0: 7368 6170 6529 5d0a 0a0a 6672 6f6d 2064  shape)]...from d
-0002eac0: 6173 6b2e 6172 7261 792e 626c 6f63 6b77  ask.array.blockw
-0002ead0: 6973 6520 696d 706f 7274 2062 6c6f 636b  ise import block
-0002eae0: 7769 7365 0a66 726f 6d20 6461 736b 2e61  wise.from dask.a
-0002eaf0: 7272 6179 2e75 7469 6c73 2069 6d70 6f72  rray.utils impor
-0002eb00: 7420 636f 6d70 7574 655f 6d65 7461 2c20  t compute_meta, 
-0002eb10: 6d65 7461 5f66 726f 6d5f 6172 7261 790a  meta_from_array.
+0001a530: 7265 7375 6c74 5b61 5d20 3d20 300a 2020  result[a] = 0.  
+0001a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a550: 2020 636f 6e74 696e 7565 0a20 2020 2020    continue.     
+0001a560: 2020 2020 2020 2020 2020 2070 726f 706f             propo
+0001a570: 7365 6420 3d20 7265 7375 6c74 5b61 5d20  sed = result[a] 
+0001a580: 2a20 6d75 6c74 6970 6c69 6572 202a 2a20  * multiplier ** 
+0001a590: 2831 202f 206c 656e 2861 7574 6f73 2929  (1 / len(autos))
+0001a5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a5b0: 2069 6620 7072 6f70 6f73 6564 203e 2073   if proposed > s
+0001a5c0: 6861 7065 5b61 5d3a 2020 2320 7765 2776  hape[a]:  # we'v
+0001a5d0: 6520 6869 7420 7468 6520 7368 6170 6520  e hit the shape 
+0001a5e0: 626f 756e 6461 7279 0a20 2020 2020 2020  boundary.       
+0001a5f0: 2020 2020 2020 2020 2020 2020 2061 7574               aut
+0001a600: 6f73 2e72 656d 6f76 6528 6129 0a20 2020  os.remove(a).   
+0001a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a620: 206c 6172 6765 7374 5f62 6c6f 636b 202a   largest_block *
+0001a630: 3d20 7368 6170 655b 615d 0a20 2020 2020  = shape[a].     
+0001a640: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001a650: 6875 6e6b 735b 615d 203d 2073 6861 7065  hunks[a] = shape
+0001a660: 5b61 5d0a 2020 2020 2020 2020 2020 2020  [a].            
+0001a670: 2020 2020 2020 2020 6465 6c20 7265 7375          del resu
+0001a680: 6c74 5b61 5d0a 2020 2020 2020 2020 2020  lt[a].          
+0001a690: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a6b0: 7265 7375 6c74 5b61 5d20 3d20 726f 756e  result[a] = roun
+0001a6c0: 645f 746f 2870 726f 706f 7365 642c 2069  d_to(proposed, i
+0001a6d0: 6465 616c 5f73 6861 7065 5b61 5d29 0a0a  deal_shape[a])..
+0001a6e0: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+0001a6f0: 636f 6d70 7574 6520 686f 7720 6d75 6368  compute how much
+0001a700: 206d 756c 7469 706c 6965 7220 7765 2068   multiplier we h
+0001a710: 6176 6520 6c65 6674 2c20 7265 7065 6174  ave left, repeat
+0001a720: 0a20 2020 2020 2020 2020 2020 206d 756c  .            mul
+0001a730: 7469 706c 6965 7220 3d20 5f63 6f6d 7075  tiplier = _compu
+0001a740: 7465 5f6d 756c 7469 706c 6965 7228 6c69  te_multiplier(li
+0001a750: 6d69 742c 2064 7479 7065 2c20 6c61 7267  mit, dtype, larg
+0001a760: 6573 745f 626c 6f63 6b2c 2072 6573 756c  est_block, resul
+0001a770: 7429 0a0a 2020 2020 2020 2020 666f 7220  t)..        for 
+0001a780: 6b2c 2076 2069 6e20 7265 7375 6c74 2e69  k, v in result.i
+0001a790: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0001a7a0: 2020 2020 6368 756e 6b73 5b6b 5d20 3d20      chunks[k] = 
+0001a7b0: 760a 2020 2020 2020 2020 7265 7475 726e  v.        return
+0001a7c0: 2074 7570 6c65 2863 6875 6e6b 7329 0a0a   tuple(chunks)..
+0001a7d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001a7e0: 2020 2320 4368 6563 6b20 6966 2064 7479    # Check if dty
+0001a7f0: 7065 2e69 7465 6d73 697a 6520 6973 2067  pe.itemsize is g
+0001a800: 7265 6174 6572 2074 6861 6e20 300a 2020  reater than 0.  
+0001a810: 2020 2020 2020 6966 2064 7479 7065 2e69        if dtype.i
+0001a820: 7465 6d73 697a 6520 3d3d 2030 3a0a 2020  temsize == 0:.  
+0001a830: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a840: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0001a850: 2020 2020 2020 2020 2020 2020 2261 7574              "aut
+0001a860: 6f2d 6368 756e 6b69 6e67 2077 6974 6820  o-chunking with 
+0001a870: 6474 7970 652e 6974 656d 7369 7a65 203d  dtype.itemsize =
+0001a880: 3d20 3020 6973 206e 6f74 2073 7570 706f  = 0 is not suppo
+0001a890: 7274 6564 2c20 706c 6561 7365 2070 6173  rted, please pas
+0001a8a0: 7320 696e 2060 6368 756e 6b73 6020 6578  s in `chunks` ex
+0001a8b0: 706c 6963 6974 6c79 220a 2020 2020 2020  plicitly".      
+0001a8c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001a8d0: 7369 7a65 203d 2028 6c69 6d69 7420 2f20  size = (limit / 
+0001a8e0: 6474 7970 652e 6974 656d 7369 7a65 202f  dtype.itemsize /
+0001a8f0: 206c 6172 6765 7374 5f62 6c6f 636b 2920   largest_block) 
+0001a900: 2a2a 2028 3120 2f20 6c65 6e28 6175 746f  ** (1 / len(auto
+0001a910: 7329 290a 2020 2020 2020 2020 736d 616c  s)).        smal
+0001a920: 6c20 3d20 5b69 2066 6f72 2069 2069 6e20  l = [i for i in 
+0001a930: 6175 746f 7320 6966 2073 6861 7065 5b69  autos if shape[i
+0001a940: 5d20 3c20 7369 7a65 5d0a 2020 2020 2020  ] < size].      
+0001a950: 2020 6966 2073 6d61 6c6c 3a0a 2020 2020    if small:.    
+0001a960: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0001a970: 2073 6d61 6c6c 3a0a 2020 2020 2020 2020   small:.        
+0001a980: 2020 2020 2020 2020 6368 756e 6b73 5b69          chunks[i
+0001a990: 5d20 3d20 2873 6861 7065 5b69 5d2c 290a  ] = (shape[i],).
+0001a9a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001a9b0: 726e 2061 7574 6f5f 6368 756e 6b73 2863  rn auto_chunks(c
+0001a9c0: 6875 6e6b 732c 2073 6861 7065 2c20 6c69  hunks, shape, li
+0001a9d0: 6d69 742c 2064 7479 7065 290a 0a20 2020  mit, dtype)..   
+0001a9e0: 2020 2020 2066 6f72 2069 2069 6e20 6175       for i in au
+0001a9f0: 746f 733a 0a20 2020 2020 2020 2020 2020  tos:.           
+0001aa00: 2063 6875 6e6b 735b 695d 203d 2072 6f75   chunks[i] = rou
+0001aa10: 6e64 5f74 6f28 7369 7a65 2c20 7368 6170  nd_to(size, shap
+0001aa20: 655b 695d 290a 0a20 2020 2020 2020 2072  e[i])..        r
+0001aa30: 6574 7572 6e20 7475 706c 6528 6368 756e  eturn tuple(chun
+0001aa40: 6b73 290a 0a0a 6465 6620 726f 756e 645f  ks)...def round_
+0001aa50: 746f 2863 2c20 7329 3a0a 2020 2020 2222  to(c, s):.    ""
+0001aa60: 2252 6574 7572 6e20 6120 6368 756e 6b20  "Return a chunk 
+0001aa70: 6469 6d65 6e73 696f 6e20 7468 6174 2069  dimension that i
+0001aa80: 7320 636c 6f73 6520 746f 2061 6e20 6576  s close to an ev
+0001aa90: 656e 206d 756c 7469 706c 6520 6f72 2066  en multiple or f
+0001aaa0: 6163 746f 720a 0a20 2020 2057 6520 7761  actor..    We wa
+0001aab0: 6e74 2076 616c 7565 7320 666f 7220 6320  nt values for c 
+0001aac0: 7468 6174 2061 7265 206e 6963 656c 7920  that are nicely 
+0001aad0: 616c 6967 6e65 6420 7769 7468 2073 2e0a  aligned with s..
+0001aae0: 0a20 2020 2049 6620 6320 6973 2073 6d61  .    If c is sma
+0001aaf0: 6c6c 6572 2074 6861 6e20 7320 7765 2075  ller than s we u
+0001ab00: 7365 2074 6865 206f 7269 6769 6e61 6c20  se the original 
+0001ab10: 6368 756e 6b20 7369 7a65 2061 6e64 2061  chunk size and a
+0001ab20: 6363 6570 7420 616e 0a20 2020 2075 6e65  ccept an.    une
+0001ab30: 7665 6e20 6368 756e 6b20 6174 2074 6865  ven chunk at the
+0001ab40: 2065 6e64 2e0a 0a20 2020 2049 6620 6320   end...    If c 
+0001ab50: 6973 206c 6172 6765 7220 7468 616e 2073  is larger than s
+0001ab60: 2074 6865 6e20 7765 2077 616e 7420 7468   then we want th
+0001ab70: 6520 6c61 7267 6573 7420 6d75 6c74 6970  e largest multip
+0001ab80: 6c65 206f 6620 7320 7468 6174 2069 7320  le of s that is 
+0001ab90: 7374 696c 6c0a 2020 2020 736d 616c 6c65  still.    smalle
+0001aba0: 7220 7468 616e 2063 2e0a 2020 2020 2222  r than c..    ""
+0001abb0: 220a 2020 2020 6966 2063 203c 3d20 733a  ".    if c <= s:
+0001abc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001abd0: 6d61 7828 312c 2069 6e74 2863 2929 0a20  max(1, int(c)). 
+0001abe0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001abf0: 2072 6574 7572 6e20 6320 2f2f 2073 202a   return c // s *
+0001ac00: 2073 0a0a 0a64 6566 205f 6765 745f 6368   s...def _get_ch
+0001ac10: 756e 6b5f 7368 6170 6528 6129 3a0a 2020  unk_shape(a):.  
+0001ac20: 2020 7320 3d20 6e70 2e61 7361 7272 6179    s = np.asarray
+0001ac30: 2861 2e73 6861 7065 2c20 6474 7970 653d  (a.shape, dtype=
+0001ac40: 696e 7429 0a20 2020 2072 6574 7572 6e20  int).    return 
+0001ac50: 735b 6c65 6e28 7329 202a 2028 4e6f 6e65  s[len(s) * (None
+0001ac60: 2c29 202b 2028 736c 6963 6528 4e6f 6e65  ,) + (slice(None
+0001ac70: 292c 295d 0a0a 0a64 6566 2066 726f 6d5f  ),)]...def from_
+0001ac80: 6172 7261 7928 0a20 2020 2078 2c0a 2020  array(.    x,.  
+0001ac90: 2020 6368 756e 6b73 3d22 6175 746f 222c    chunks="auto",
+0001aca0: 0a20 2020 206e 616d 653d 4e6f 6e65 2c0a  .    name=None,.
+0001acb0: 2020 2020 6c6f 636b 3d46 616c 7365 2c0a      lock=False,.
+0001acc0: 2020 2020 6173 6172 7261 793d 4e6f 6e65      asarray=None
+0001acd0: 2c0a 2020 2020 6661 6e63 793d 5472 7565  ,.    fancy=True
+0001ace0: 2c0a 2020 2020 6765 7469 7465 6d3d 4e6f  ,.    getitem=No
+0001acf0: 6e65 2c0a 2020 2020 6d65 7461 3d4e 6f6e  ne,.    meta=Non
+0001ad00: 652c 0a20 2020 2069 6e6c 696e 655f 6172  e,.    inline_ar
+0001ad10: 7261 793d 4661 6c73 652c 0a29 3a0a 2020  ray=False,.):.  
+0001ad20: 2020 2222 2243 7265 6174 6520 6461 736b    """Create dask
+0001ad30: 2061 7272 6179 2066 726f 6d20 736f 6d65   array from some
+0001ad40: 7468 696e 6720 7468 6174 206c 6f6f 6b73  thing that looks
+0001ad50: 206c 696b 6520 616e 2061 7272 6179 2e0a   like an array..
+0001ad60: 0a20 2020 2049 6e70 7574 206d 7573 7420  .    Input must 
+0001ad70: 6861 7665 2061 2060 602e 7368 6170 6560  have a ``.shape`
+0001ad80: 602c 2060 602e 6e64 696d 6060 2c20 6060  `, ``.ndim``, ``
+0001ad90: 2e64 7479 7065 6060 2061 6e64 2073 7570  .dtype`` and sup
+0001ada0: 706f 7274 206e 756d 7079 2d73 7479 6c65  port numpy-style
+0001adb0: 2073 6c69 6369 6e67 2e0a 0a20 2020 2050   slicing...    P
+0001adc0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+0001add0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078 203a  --------.    x :
+0001ade0: 2061 7272 6179 5f6c 696b 650a 2020 2020   array_like.    
+0001adf0: 6368 756e 6b73 203a 2069 6e74 2c20 7475  chunks : int, tu
+0001ae00: 706c 650a 2020 2020 2020 2020 486f 7720  ple.        How 
+0001ae10: 746f 2063 6875 6e6b 2074 6865 2061 7272  to chunk the arr
+0001ae20: 6179 2e20 4d75 7374 2062 6520 6f6e 6520  ay. Must be one 
+0001ae30: 6f66 2074 6865 2066 6f6c 6c6f 7769 6e67  of the following
+0001ae40: 2066 6f72 6d73 3a0a 0a20 2020 2020 2020   forms:..       
+0001ae50: 202d 2041 2062 6c6f 636b 7369 7a65 206c   - A blocksize l
+0001ae60: 696b 6520 3130 3030 2e0a 2020 2020 2020  ike 1000..      
+0001ae70: 2020 2d20 4120 626c 6f63 6b73 6861 7065    - A blockshape
+0001ae80: 206c 696b 6520 2831 3030 302c 2031 3030   like (1000, 100
+0001ae90: 3029 2e0a 2020 2020 2020 2020 2d20 4578  0)..        - Ex
+0001aea0: 706c 6963 6974 2073 697a 6573 206f 6620  plicit sizes of 
+0001aeb0: 616c 6c20 626c 6f63 6b73 2061 6c6f 6e67  all blocks along
+0001aec0: 2061 6c6c 2064 696d 656e 7369 6f6e 7320   all dimensions 
+0001aed0: 6c69 6b65 0a20 2020 2020 2020 2020 2028  like.          (
+0001aee0: 2831 3030 302c 2031 3030 302c 2035 3030  (1000, 1000, 500
+0001aef0: 292c 2028 3430 302c 2034 3030 2929 2e0a  ), (400, 400))..
+0001af00: 2020 2020 2020 2020 2d20 4120 7369 7a65          - A size
+0001af10: 2069 6e20 6279 7465 732c 206c 696b 6520   in bytes, like 
+0001af20: 2231 3030 204d 6942 2220 7768 6963 6820  "100 MiB" which 
+0001af30: 7769 6c6c 2063 686f 6f73 6520 6120 756e  will choose a un
+0001af40: 6966 6f72 6d0a 2020 2020 2020 2020 2020  iform.          
+0001af50: 626c 6f63 6b2d 6c69 6b65 2073 6861 7065  block-like shape
+0001af60: 0a20 2020 2020 2020 202d 2054 6865 2077  .        - The w
+0001af70: 6f72 6420 2261 7574 6f22 2077 6869 6368  ord "auto" which
+0001af80: 2061 6374 7320 6c69 6b65 2074 6865 2061   acts like the a
+0001af90: 626f 7665 2c20 6275 7420 7573 6573 2061  bove, but uses a
+0001afa0: 2063 6f6e 6669 6775 7261 7469 6f6e 0a20   configuration. 
+0001afb0: 2020 2020 2020 2020 2076 616c 7565 2060           value `
+0001afc0: 6061 7272 6179 2e63 6875 6e6b 2d73 697a  `array.chunk-siz
+0001afd0: 6560 6020 666f 7220 7468 6520 6368 756e  e`` for the chun
+0001afe0: 6b20 7369 7a65 0a0a 2020 2020 2020 2020  k size..        
+0001aff0: 2d31 206f 7220 4e6f 6e65 2061 7320 6120  -1 or None as a 
+0001b000: 626c 6f63 6b73 697a 6520 696e 6469 6361  blocksize indica
+0001b010: 7465 2074 6865 2073 697a 6520 6f66 2074  te the size of t
+0001b020: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+0001b030: 0a20 2020 2020 2020 2064 696d 656e 7369  .        dimensi
+0001b040: 6f6e 2e0a 2020 2020 6e61 6d65 203a 2073  on..    name : s
+0001b050: 7472 206f 7220 626f 6f6c 2c20 6f70 7469  tr or bool, opti
+0001b060: 6f6e 616c 0a20 2020 2020 2020 2054 6865  onal.        The
+0001b070: 206b 6579 206e 616d 6520 746f 2075 7365   key name to use
+0001b080: 2066 6f72 2074 6865 2061 7272 6179 2e20   for the array. 
+0001b090: 4465 6661 756c 7473 2074 6f20 6120 6861  Defaults to a ha
+0001b0a0: 7368 206f 6620 6060 7860 602e 0a0a 2020  sh of ``x``...  
+0001b0b0: 2020 2020 2020 4861 7368 696e 6720 6973        Hashing is
+0001b0c0: 2075 7365 6675 6c20 6966 2074 6865 2073   useful if the s
+0001b0d0: 616d 6520 7661 6c75 6520 6f66 2060 6078  ame value of ``x
+0001b0e0: 6060 2069 7320 7573 6564 2074 6f20 6372  `` is used to cr
+0001b0f0: 6561 7465 206d 756c 7469 706c 650a 2020  eate multiple.  
+0001b100: 2020 2020 2020 6172 7261 7973 2c20 6173        arrays, as
+0001b110: 2044 6173 6b20 6361 6e20 7468 656e 2072   Dask can then r
+0001b120: 6563 6f67 6e69 7365 2074 6861 7420 7468  ecognise that th
+0001b130: 6579 2772 6520 7468 6520 7361 6d65 2061  ey're the same a
+0001b140: 6e64 0a20 2020 2020 2020 2061 766f 6964  nd.        avoid
+0001b150: 2064 7570 6c69 6361 7465 2063 6f6d 7075   duplicate compu
+0001b160: 7461 7469 6f6e 732e 2048 6f77 6576 6572  tations. However
+0001b170: 2c20 6974 2063 616e 2061 6c73 6f20 6265  , it can also be
+0001b180: 2073 6c6f 772c 2061 6e64 2069 6620 7468   slow, and if th
+0001b190: 650a 2020 2020 2020 2020 6172 7261 7920  e.        array 
+0001b1a0: 6973 206e 6f74 2063 6f6e 7469 6775 6f75  is not contiguou
+0001b1b0: 7320 6974 2069 7320 636f 7069 6564 2066  s it is copied f
+0001b1c0: 6f72 2068 6173 6869 6e67 2e20 4966 2074  or hashing. If t
+0001b1d0: 6865 2061 7272 6179 2075 7365 730a 2020  he array uses.  
+0001b1e0: 2020 2020 2020 7374 7269 6465 2074 7269        stride tri
+0001b1f0: 636b 7320 2873 7563 6820 6173 203a 6675  cks (such as :fu
+0001b200: 6e63 3a60 6e75 6d70 792e 6272 6f61 6463  nc:`numpy.broadc
+0001b210: 6173 745f 746f 6020 6f72 0a20 2020 2020  ast_to` or.     
+0001b220: 2020 203a 6675 6e63 3a60 736b 696d 6167     :func:`skimag
+0001b230: 652e 7574 696c 2e76 6965 775f 6173 5f77  e.util.view_as_w
+0001b240: 696e 646f 7773 6029 2074 6f20 6861 7665  indows`) to have
+0001b250: 2061 206c 6172 6765 7220 6c6f 6769 6361   a larger logica
+0001b260: 6c0a 2020 2020 2020 2020 7468 616e 2070  l.        than p
+0001b270: 6879 7369 6361 6c20 7369 7a65 2c20 7468  hysical size, th
+0001b280: 6973 2063 6f70 7920 6361 6e20 6361 7573  is copy can caus
+0001b290: 6520 6578 6365 7373 6976 6520 6d65 6d6f  e excessive memo
+0001b2a0: 7279 2075 7361 6765 2e0a 0a20 2020 2020  ry usage...     
+0001b2b0: 2020 2049 6620 796f 7520 646f 6e27 7420     If you don't 
+0001b2c0: 6e65 6564 2074 6865 2064 6564 7570 6c69  need the dedupli
+0001b2d0: 6361 7469 6f6e 2070 726f 7669 6465 6420  cation provided 
+0001b2e0: 6279 2068 6173 6869 6e67 2c20 7573 650a  by hashing, use.
+0001b2f0: 2020 2020 2020 2020 6060 6e61 6d65 3d46          ``name=F
+0001b300: 616c 7365 6060 2074 6f20 6765 6e65 7261  alse`` to genera
+0001b310: 7465 2061 2072 616e 646f 6d20 6e61 6d65  te a random name
+0001b320: 2069 6e73 7465 6164 206f 6620 6861 7368   instead of hash
+0001b330: 696e 672c 2077 6869 6368 0a20 2020 2020  ing, which.     
+0001b340: 2020 2061 766f 6964 7320 7468 6520 7069     avoids the pi
+0001b350: 7466 616c 6c73 2064 6573 6372 6962 6564  tfalls described
+0001b360: 2061 626f 7665 2e20 5573 696e 6720 6060   above. Using ``
+0001b370: 6e61 6d65 3d54 7275 6560 6020 6973 0a20  name=True`` is. 
+0001b380: 2020 2020 2020 2065 7175 6976 616c 656e         equivalen
+0001b390: 7420 746f 2074 6865 2064 6566 6175 6c74  t to the default
+0001b3a0: 2e0a 0a20 2020 2020 2020 2042 7920 6465  ...        By de
+0001b3b0: 6661 756c 742c 2068 6173 6869 6e67 2075  fault, hashing u
+0001b3c0: 7365 7320 7079 7468 6f6e 2773 2073 7461  ses python's sta
+0001b3d0: 6e64 6172 6420 7368 6131 2e20 5468 6973  ndard sha1. This
+0001b3e0: 2062 6568 6176 696f 7572 2063 616e 2062   behaviour can b
+0001b3f0: 650a 2020 2020 2020 2020 6368 616e 6765  e.        change
+0001b400: 6420 6279 2069 6e73 7461 6c6c 696e 6720  d by installing 
+0001b410: 6369 7479 6861 7368 2c20 7878 6861 7368  cityhash, xxhash
+0001b420: 206f 7220 6d75 726d 7572 6861 7368 2e20   or murmurhash. 
+0001b430: 4966 2069 6e73 7461 6c6c 6564 2c0a 2020  If installed,.  
+0001b440: 2020 2020 2020 6120 6c61 7267 652d 6661        a large-fa
+0001b450: 6374 6f72 2073 7065 6564 7570 2063 616e  ctor speedup can
+0001b460: 2062 6520 6f62 7461 696e 6564 2069 6e20   be obtained in 
+0001b470: 7468 6520 746f 6b65 6e69 7361 7469 6f6e  the tokenisation
+0001b480: 2073 7465 702e 0a0a 2020 2020 2020 2020   step...        
+0001b490: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
+0001b4a0: 2020 2020 2020 4265 6361 7573 6520 7468        Because th
+0001b4b0: 6973 2060 606e 616d 6560 6020 6973 2075  is ``name`` is u
+0001b4c0: 7365 6420 6173 2074 6865 206b 6579 2069  sed as the key i
+0001b4d0: 6e20 7461 736b 2067 7261 7068 732c 2079  n task graphs, y
+0001b4e0: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
+0001b4f0: 2020 2020 2065 6e73 7572 6520 7468 6174       ensure that
+0001b500: 2069 7420 756e 6971 7565 6c79 2069 6465   it uniquely ide
+0001b510: 6e74 6966 6965 7320 7468 6520 6461 7461  ntifies the data
+0001b520: 2063 6f6e 7461 696e 6564 2077 6974 6869   contained withi
+0001b530: 6e2e 2049 660a 2020 2020 2020 2020 2020  n. If.          
+0001b540: 2079 6f75 2764 206c 696b 6520 746f 2070   you'd like to p
+0001b550: 726f 7669 6465 2061 2064 6573 6372 6970  rovide a descrip
+0001b560: 7469 7665 206e 616d 6520 7468 6174 2069  tive name that i
+0001b570: 7320 7374 696c 6c20 756e 6971 7565 2c20  s still unique, 
+0001b580: 636f 6d62 696e 650a 2020 2020 2020 2020  combine.        
+0001b590: 2020 2074 6865 2064 6573 6372 6970 7469     the descripti
+0001b5a0: 7665 206e 616d 6520 7769 7468 203a 6675  ve name with :fu
+0001b5b0: 6e63 3a60 6461 736b 2e62 6173 652e 746f  nc:`dask.base.to
+0001b5c0: 6b65 6e69 7a65 6020 6f66 2074 6865 0a20  kenize` of the. 
+0001b5d0: 2020 2020 2020 2020 2020 6060 6172 7261            ``arra
+0001b5e0: 795f 6c69 6b65 6060 2e20 5365 6520 3a72  y_like``. See :r
+0001b5f0: 6566 3a60 6772 6170 6873 6020 666f 7220  ef:`graphs` for 
+0001b600: 6d6f 7265 2e0a 0a20 2020 206c 6f63 6b20  more...    lock 
+0001b610: 3a20 626f 6f6c 206f 7220 4c6f 636b 2c20  : bool or Lock, 
+0001b620: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0001b630: 2049 6620 6060 7860 6020 646f 6573 6e27   If ``x`` doesn'
+0001b640: 7420 7375 7070 6f72 7420 636f 6e63 7572  t support concur
+0001b650: 7265 6e74 2072 6561 6473 2074 6865 6e20  rent reads then 
+0001b660: 7072 6f76 6964 6520 6120 6c6f 636b 2068  provide a lock h
+0001b670: 6572 652c 206f 720a 2020 2020 2020 2020  ere, or.        
+0001b680: 7061 7373 2069 6e20 5472 7565 2074 6f20  pass in True to 
+0001b690: 6861 7665 2064 6173 6b2e 6172 7261 7920  have dask.array 
+0001b6a0: 6372 6561 7465 206f 6e65 2066 6f72 2079  create one for y
+0001b6b0: 6f75 2e0a 2020 2020 6173 6172 7261 7920  ou..    asarray 
+0001b6c0: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+0001b6d0: 0a20 2020 2020 2020 2049 6620 5472 7565  .        If True
+0001b6e0: 2074 6865 6e20 6361 6c6c 206e 702e 6173   then call np.as
+0001b6f0: 6172 7261 7920 6f6e 2063 6875 6e6b 7320  array on chunks 
+0001b700: 746f 2063 6f6e 7665 7274 2074 6865 6d20  to convert them 
+0001b710: 746f 206e 756d 7079 2061 7272 6179 732e  to numpy arrays.
+0001b720: 0a20 2020 2020 2020 2049 6620 4661 6c73  .        If Fals
+0001b730: 6520 7468 656e 2063 6875 6e6b 7320 6172  e then chunks ar
+0001b740: 6520 7061 7373 6564 2074 6872 6f75 6768  e passed through
+0001b750: 2075 6e63 6861 6e67 6564 2e0a 2020 2020   unchanged..    
+0001b760: 2020 2020 4966 204e 6f6e 6520 2864 6566      If None (def
+0001b770: 6175 6c74 2920 7468 656e 2077 6520 7573  ault) then we us
+0001b780: 6520 5472 7565 2069 6620 7468 6520 6060  e True if the ``
+0001b790: 5f5f 6172 7261 795f 6675 6e63 7469 6f6e  __array_function
+0001b7a0: 5f5f 6060 206d 6574 686f 640a 2020 2020  __`` method.    
+0001b7b0: 2020 2020 6973 2075 6e64 6566 696e 6564      is undefined
+0001b7c0: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
+0001b7d0: 7465 3a3a 0a0a 2020 2020 2020 2020 2020  te::..          
+0001b7e0: 2020 4461 736b 2064 6f65 7320 6e6f 7420    Dask does not 
+0001b7f0: 7072 6573 6572 7665 2074 6865 206d 656d  preserve the mem
+0001b800: 6f72 7920 6c61 796f 7574 206f 6620 7468  ory layout of th
+0001b810: 6520 6f72 6967 696e 616c 2061 7272 6179  e original array
+0001b820: 2077 6865 6e0a 2020 2020 2020 2020 2020   when.          
+0001b830: 2020 7468 6520 6172 7261 7920 6973 2063    the array is c
+0001b840: 7265 6174 6564 2075 7369 6e67 2046 6f72  reated using For
+0001b850: 7472 616e 2072 6174 6865 7220 7468 616e  tran rather than
+0001b860: 2043 206f 7264 6572 696e 672e 0a0a 2020   C ordering...  
+0001b870: 2020 6661 6e63 7920 3a20 626f 6f6c 2c20    fancy : bool, 
+0001b880: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0001b890: 2049 6620 6060 7860 6020 646f 6573 6e27   If ``x`` doesn'
+0001b8a0: 7420 7375 7070 6f72 7420 6661 6e63 7920  t support fancy 
+0001b8b0: 696e 6465 7869 6e67 2028 652e 672e 2069  indexing (e.g. i
+0001b8c0: 6e64 6578 696e 6720 7769 7468 206c 6973  ndexing with lis
+0001b8d0: 7473 206f 720a 2020 2020 2020 2020 6172  ts or.        ar
+0001b8e0: 7261 7973 2920 7468 656e 2073 6574 2074  rays) then set t
+0001b8f0: 6f20 4661 6c73 652e 2044 6566 6175 6c74  o False. Default
+0001b900: 2069 7320 5472 7565 2e0a 2020 2020 6d65   is True..    me
+0001b910: 7461 203a 2041 7272 6179 2d6c 696b 652c  ta : Array-like,
+0001b920: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001b930: 2020 5468 6520 6d65 7461 6461 7461 2066    The metadata f
+0001b940: 6f72 2074 6865 2072 6573 756c 7469 6e67  or the resulting
+0001b950: 2064 6173 6b20 6172 7261 792e 2020 5468   dask array.  Th
+0001b960: 6973 2069 7320 7468 6520 6b69 6e64 206f  is is the kind o
+0001b970: 6620 6172 7261 790a 2020 2020 2020 2020  f array.        
+0001b980: 7468 6174 2077 696c 6c20 7265 7375 6c74  that will result
+0001b990: 2066 726f 6d20 736c 6963 696e 6720 7468   from slicing th
+0001b9a0: 6520 696e 7075 7420 6172 7261 792e 0a20  e input array.. 
+0001b9b0: 2020 2020 2020 2044 6566 6175 6c74 7320         Defaults 
+0001b9c0: 746f 2074 6865 2069 6e70 7574 2061 7272  to the input arr
+0001b9d0: 6179 2e0a 2020 2020 696e 6c69 6e65 5f61  ay..    inline_a
+0001b9e0: 7272 6179 203a 2062 6f6f 6c2c 2064 6566  rray : bool, def
+0001b9f0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+0001ba00: 2020 2048 6f77 2074 6f20 696e 636c 7564     How to includ
+0001ba10: 6520 7468 6520 6172 7261 7920 696e 2074  e the array in t
+0001ba20: 6865 2074 6173 6b20 6772 6170 682e 2042  he task graph. B
+0001ba30: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
+0001ba40: 2020 2860 6069 6e6c 696e 655f 6172 7261    (``inline_arra
+0001ba50: 793d 4661 6c73 6560 6029 2074 6865 2061  y=False``) the a
+0001ba60: 7272 6179 2069 7320 696e 636c 7564 6564  rray is included
+0001ba70: 2069 6e20 6120 7461 736b 2062 7920 6974   in a task by it
+0001ba80: 7365 6c66 2c0a 2020 2020 2020 2020 616e  self,.        an
+0001ba90: 6420 6561 6368 2063 6875 6e6b 2072 6566  d each chunk ref
+0001baa0: 6572 7320 746f 2074 6861 7420 7461 736b  ers to that task
+0001bab0: 2062 7920 6974 7320 6b65 792e 0a0a 2020   by its key...  
+0001bac0: 2020 2020 2020 2e2e 2063 6f64 652d 626c        .. code-bl
+0001bad0: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
+0001bae0: 2020 2020 2020 2020 203e 3e3e 2078 203d           >>> x =
+0001baf0: 2068 3570 792e 4669 6c65 2822 6461 7461   h5py.File("data
+0001bb00: 2e68 3522 295b 222f 7822 5d20 2023 2064  .h5")["/x"]  # d
+0001bb10: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+0001bb20: 2020 2020 2020 2020 203e 3e3e 2061 203d           >>> a =
+0001bb30: 2064 612e 6672 6f6d 5f61 7272 6179 2878   da.from_array(x
+0001bb40: 2c20 6368 756e 6b73 3d35 3030 2920 2023  , chunks=500)  #
+0001bb50: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+0001bb60: 2020 2020 2020 2020 2020 203e 3e3e 2064             >>> d
+0001bb70: 6963 7428 612e 6461 736b 2920 2023 2064  ict(a.dask)  # d
+0001bb80: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+0001bb90: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+0001bba0: 2020 2020 2020 2020 2027 6172 7261 792d           'array-
+0001bbb0: 6f72 6967 696e 616c 2d3c 6e61 6d65 3e27  original-<name>'
+0001bbc0: 3a20 3c48 4446 3520 6461 7461 7365 7420  : <HDF5 dataset 
+0001bbd0: 2e2e 2e3e 2c0a 2020 2020 2020 2020 2020  ...>,.          
+0001bbe0: 2020 2020 2827 6172 7261 792d 3c6e 616d      ('array-<nam
+0001bbf0: 653e 272c 2030 293a 2028 6765 7469 7465  e>', 0): (getite
+0001bc00: 6d2c 2022 6172 7261 792d 6f72 6967 696e  m, "array-origin
+0001bc10: 616c 2d3c 6e61 6d65 3e22 2c20 2e2e 2e29  al-<name>", ...)
+0001bc20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bc30: 2827 6172 7261 792d 3c6e 616d 653e 272c  ('array-<name>',
+0001bc40: 2031 293a 2028 6765 7469 7465 6d2c 2022   1): (getitem, "
+0001bc50: 6172 7261 792d 6f72 6967 696e 616c 2d3c  array-original-<
+0001bc60: 6e61 6d65 3e22 2c20 2e2e 2e29 0a20 2020  name>", ...).   
+0001bc70: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+0001bc80: 2020 2057 6974 6820 6060 696e 6c69 6e65     With ``inline
+0001bc90: 5f61 7272 6179 3d54 7275 6560 602c 2044  _array=True``, D
+0001bca0: 6173 6b20 7769 6c6c 2069 6e73 7465 6164  ask will instead
+0001bcb0: 2069 6e6c 696e 6520 7468 6520 6172 7261   inline the arra
+0001bcc0: 7920 6469 7265 6374 6c79 0a20 2020 2020  y directly.     
+0001bcd0: 2020 2069 6e20 7468 6520 7661 6c75 6573     in the values
+0001bce0: 206f 6620 7468 6520 7461 736b 2067 7261   of the task gra
+0001bcf0: 7068 2e0a 0a20 2020 2020 2020 202e 2e20  ph...        .. 
+0001bd00: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
+0001bd10: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
+0001bd20: 3e3e 3e20 6120 3d20 6461 2e66 726f 6d5f  >>> a = da.from_
+0001bd30: 6172 7261 7928 782c 2063 6875 6e6b 733d  array(x, chunks=
+0001bd40: 3530 302c 2069 6e6c 696e 655f 6172 7261  500, inline_arra
+0001bd50: 793d 5472 7565 2920 2023 2064 6f63 7465  y=True)  # docte
+0001bd60: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+0001bd70: 2020 2020 203e 3e3e 2064 6963 7428 612e       >>> dict(a.
+0001bd80: 6461 736b 2920 2023 2064 6f63 7465 7374  dask)  # doctest
+0001bd90: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+0001bda0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+0001bdb0: 2020 2028 2761 7272 6179 2d3c 6e61 6d65     ('array-<name
+0001bdc0: 3e27 2c20 3029 3a20 2867 6574 6974 656d  >', 0): (getitem
+0001bdd0: 2c20 3c48 4446 3520 6461 7461 7365 7420  , <HDF5 dataset 
+0001bde0: 2e2e 2e3e 2c20 2e2e 2e29 2c0a 2020 2020  ...>, ...),.    
+0001bdf0: 2020 2020 2020 2020 2020 2827 6172 7261            ('arra
+0001be00: 792d 3c6e 616d 653e 272c 2031 293a 2028  y-<name>', 1): (
+0001be10: 6765 7469 7465 6d2c 203c 4844 4635 2064  getitem, <HDF5 d
+0001be20: 6174 6173 6574 202e 2e2e 3e2c 202e 2e2e  ataset ...>, ...
+0001be30: 290a 2020 2020 2020 2020 2020 207d 0a0a  ).           }..
+0001be40: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
+0001be50: 7420 7468 6572 6527 7320 6e6f 206b 6579  t there's no key
+0001be60: 2069 6e20 7468 6520 7461 736b 2067 7261   in the task gra
+0001be70: 7068 2077 6974 6820 6a75 7374 2074 6865  ph with just the
+0001be80: 2061 7272 6179 2060 7860 0a20 2020 2020   array `x`.     
+0001be90: 2020 2061 6e79 6d6f 7265 2e20 496e 7374     anymore. Inst
+0001bea0: 6561 6420 6974 2773 2070 6c61 6365 6420  ead it's placed 
+0001beb0: 6469 7265 6374 6c79 2069 6e20 7468 6520  directly in the 
+0001bec0: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
+0001bed0: 2054 6865 2072 6967 6874 2063 686f 6963   The right choic
+0001bee0: 6520 666f 7220 6060 696e 6c69 6e65 5f61  e for ``inline_a
+0001bef0: 7272 6179 6060 2064 6570 656e 6473 206f  rray`` depends o
+0001bf00: 6e20 7365 7665 7261 6c20 6661 6374 6f72  n several factor
+0001bf10: 732c 0a20 2020 2020 2020 2069 6e63 6c75  s,.        inclu
+0001bf20: 6469 6e67 2074 6865 2073 697a 6520 6f66  ding the size of
+0001bf30: 2060 6078 6060 2c20 686f 7720 6578 7065   ``x``, how expe
+0001bf40: 6e73 6976 6520 6974 2069 7320 746f 2063  nsive it is to c
+0001bf50: 7265 6174 652c 2077 6869 6368 0a20 2020  reate, which.   
+0001bf60: 2020 2020 2073 6368 6564 756c 6572 2079       scheduler y
+0001bf70: 6f75 2772 6520 7573 696e 672c 2061 6e64  ou're using, and
+0001bf80: 2074 6865 2070 6174 7465 726e 206f 6620   the pattern of 
+0001bf90: 646f 776e 7374 7265 616d 2063 6f6d 7075  downstream compu
+0001bfa0: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
+0001bfb0: 2041 7320 6120 6865 7572 6973 7469 632c   As a heuristic,
+0001bfc0: 2060 6069 6e6c 696e 655f 6172 7261 793d   ``inline_array=
+0001bfd0: 5472 7565 6060 206d 6179 2062 6520 7468  True`` may be th
+0001bfe0: 6520 7269 6768 7420 6368 6f69 6365 2077  e right choice w
+0001bff0: 6865 6e0a 2020 2020 2020 2020 7468 6520  hen.        the 
+0001c000: 6172 7261 7920 6060 7860 6020 6973 2063  array ``x`` is c
+0001c010: 6865 6170 2074 6f20 7365 7269 616c 697a  heap to serializ
+0001c020: 6520 616e 6420 6465 7365 7269 616c 697a  e and deserializ
+0001c030: 6520 2873 696e 6365 2069 7427 730a 2020  e (since it's.  
+0001c040: 2020 2020 2020 696e 636c 7564 6564 2069        included i
+0001c050: 6e20 7468 6520 6772 6170 6820 6d61 6e79  n the graph many
+0001c060: 2074 696d 6573 2920 616e 6420 6966 2079   times) and if y
+0001c070: 6f75 2772 6520 6578 7065 7269 656e 6369  ou're experienci
+0001c080: 6e67 206f 7264 6572 696e 670a 2020 2020  ng ordering.    
+0001c090: 2020 2020 6973 7375 6573 2028 7365 6520      issues (see 
+0001c0a0: 3a72 6566 3a60 6f72 6465 7260 2066 6f72  :ref:`order` for
+0001c0b0: 206d 6f72 6529 2e0a 0a20 2020 2020 2020   more)...       
+0001c0c0: 2054 6869 7320 6861 7320 6e6f 2065 6666   This has no eff
+0001c0d0: 6563 7420 7768 656e 2060 6078 6060 2069  ect when ``x`` i
+0001c0e0: 7320 6120 4e75 6d50 7920 6172 7261 792e  s a NumPy array.
+0001c0f0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+0001c100: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
+0001c110: 203e 3e3e 2078 203d 2068 3570 792e 4669   >>> x = h5py.Fi
+0001c120: 6c65 2827 2e2e 2e27 295b 272f 6461 7461  le('...')['/data
+0001c130: 2f70 6174 6827 5d20 2023 2064 6f63 7465  /path']  # docte
+0001c140: 7374 3a20 2b53 4b49 500a 2020 2020 3e3e  st: +SKIP.    >>
+0001c150: 3e20 6120 3d20 6461 2e66 726f 6d5f 6172  > a = da.from_ar
+0001c160: 7261 7928 782c 2063 6875 6e6b 733d 2831  ray(x, chunks=(1
+0001c170: 3030 302c 2031 3030 3029 2920 2023 2064  000, 1000))  # d
+0001c180: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
+0001c190: 2020 2049 6620 796f 7572 2075 6e64 6572     If your under
+0001c1a0: 6c79 696e 6720 6461 7461 7374 6f72 6520  lying datastore 
+0001c1b0: 646f 6573 206e 6f74 2073 7570 706f 7274  does not support
+0001c1c0: 2063 6f6e 6375 7272 656e 7420 7265 6164   concurrent read
+0001c1d0: 7320 7468 656e 2069 6e63 6c75 6465 0a20  s then include. 
+0001c1e0: 2020 2074 6865 2060 606c 6f63 6b3d 5472     the ``lock=Tr
+0001c1f0: 7565 6060 206b 6579 776f 7264 2061 7267  ue`` keyword arg
+0001c200: 756d 656e 7420 6f72 2060 606c 6f63 6b3d  ument or ``lock=
+0001c210: 6d79 6c6f 636b 6060 2069 6620 796f 7520  mylock`` if you 
+0001c220: 7761 6e74 206d 756c 7469 706c 650a 2020  want multiple.  
+0001c230: 2020 6172 7261 7973 2074 6f20 636f 6f72    arrays to coor
+0001c240: 6469 6e61 7465 2061 726f 756e 6420 7468  dinate around th
+0001c250: 6520 7361 6d65 206c 6f63 6b2e 0a0a 2020  e same lock...  
+0001c260: 2020 3e3e 3e20 6120 3d20 6461 2e66 726f    >>> a = da.fro
+0001c270: 6d5f 6172 7261 7928 782c 2063 6875 6e6b  m_array(x, chunk
+0001c280: 733d 2831 3030 302c 2031 3030 3029 2c20  s=(1000, 1000), 
+0001c290: 6c6f 636b 3d54 7275 6529 2020 2320 646f  lock=True)  # do
+0001c2a0: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
+0001c2b0: 2020 4966 2079 6f75 7220 756e 6465 726c    If your underl
+0001c2c0: 7969 6e67 2064 6174 6173 746f 7265 2068  ying datastore h
+0001c2d0: 6173 2061 2060 602e 6368 756e 6b73 6060  as a ``.chunks``
+0001c2e0: 2061 7474 7269 6275 7465 2028 6173 2068   attribute (as h
+0001c2f0: 3570 7920 616e 6420 7a61 7272 0a20 2020  5py and zarr.   
+0001c300: 2064 6174 6173 6574 7320 646f 2920 7468   datasets do) th
+0001c310: 656e 2061 206d 756c 7469 706c 6520 6f66  en a multiple of
+0001c320: 2074 6861 7420 6368 756e 6b20 7368 6170   that chunk shap
+0001c330: 6520 7769 6c6c 2062 6520 7573 6564 2069  e will be used i
+0001c340: 6620 796f 750a 2020 2020 646f 206e 6f74  f you.    do not
+0001c350: 2070 726f 7669 6465 2061 2063 6875 6e6b   provide a chunk
+0001c360: 2073 6861 7065 2e0a 0a20 2020 203e 3e3e   shape...    >>>
+0001c370: 2061 203d 2064 612e 6672 6f6d 5f61 7272   a = da.from_arr
+0001c380: 6179 2878 2c20 6368 756e 6b73 3d27 6175  ay(x, chunks='au
+0001c390: 746f 2729 2020 2320 646f 6374 6573 743a  to')  # doctest:
+0001c3a0: 202b 534b 4950 0a20 2020 203e 3e3e 2061   +SKIP.    >>> a
+0001c3b0: 203d 2064 612e 6672 6f6d 5f61 7272 6179   = da.from_array
+0001c3c0: 2878 2c20 6368 756e 6b73 3d27 3130 3020  (x, chunks='100 
+0001c3d0: 4d69 4227 2920 2023 2064 6f63 7465 7374  MiB')  # doctest
+0001c3e0: 3a20 2b53 4b49 500a 2020 2020 3e3e 3e20  : +SKIP.    >>> 
+0001c3f0: 6120 3d20 6461 2e66 726f 6d5f 6172 7261  a = da.from_arra
+0001c400: 7928 7829 2020 2320 646f 6374 6573 743a  y(x)  # doctest:
+0001c410: 202b 534b 4950 0a0a 2020 2020 4966 2070   +SKIP..    If p
+0001c420: 726f 7669 6469 6e67 2061 206e 616d 652c  roviding a name,
+0001c430: 2065 6e73 7572 6520 7468 6174 2069 7420   ensure that it 
+0001c440: 6973 2075 6e69 7175 650a 0a20 2020 203e  is unique..    >
+0001c450: 3e3e 2069 6d70 6f72 7420 6461 736b 2e62  >> import dask.b
+0001c460: 6173 650a 2020 2020 3e3e 3e20 746f 6b65  ase.    >>> toke
+0001c470: 6e20 3d20 6461 736b 2e62 6173 652e 746f  n = dask.base.to
+0001c480: 6b65 6e69 7a65 2878 2920 2023 2064 6f63  kenize(x)  # doc
+0001c490: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0001c4a0: 3e3e 3e20 6120 3d20 6461 2e66 726f 6d5f  >>> a = da.from_
+0001c4b0: 6172 7261 7928 276d 7961 7272 6179 2d27  array('myarray-'
+0001c4c0: 202b 2074 6f6b 656e 2920 2023 2064 6f63   + token)  # doc
+0001c4d0: 7465 7374 3a20 2b53 4b49 500a 0a20 2020  test: +SKIP..   
+0001c4e0: 204e 756d 5079 206e 6461 7272 6179 7320   NumPy ndarrays 
+0001c4f0: 6172 6520 6561 6765 726c 7920 736c 6963  are eagerly slic
+0001c500: 6564 2061 6e64 2074 6865 6e20 656d 6265  ed and then embe
+0001c510: 6464 6564 2069 6e20 7468 6520 6772 6170  dded in the grap
+0001c520: 682e 0a0a 2020 2020 3e3e 3e20 696d 706f  h...    >>> impo
+0001c530: 7274 2064 6173 6b2e 6172 7261 790a 2020  rt dask.array.  
+0001c540: 2020 3e3e 3e20 6120 3d20 6461 736b 2e61    >>> a = dask.a
+0001c550: 7272 6179 2e66 726f 6d5f 6172 7261 7928  rray.from_array(
+0001c560: 6e70 2e61 7272 6179 285b 5b31 2c20 325d  np.array([[1, 2]
+0001c570: 2c20 5b33 2c20 345d 5d29 2c20 6368 756e  , [3, 4]]), chun
+0001c580: 6b73 3d28 312c 3129 290a 2020 2020 3e3e  ks=(1,1)).    >>
+0001c590: 3e20 612e 6461 736b 5b61 2e6e 616d 652c  > a.dask[a.name,
+0001c5a0: 2030 2c20 305d 5b30 5d0a 2020 2020 6172   0, 0][0].    ar
+0001c5b0: 7261 7928 5b31 5d29 0a0a 2020 2020 4368  ray([1])..    Ch
+0001c5c0: 756e 6b73 2077 6974 6820 6578 6163 746c  unks with exactl
+0001c5d0: 792d 7370 6563 6966 6965 642c 2064 6966  y-specified, dif
+0001c5e0: 6665 7265 6e74 2073 697a 6573 2063 616e  ferent sizes can
+0001c5f0: 2062 6520 6372 6561 7465 642e 0a0a 2020   be created...  
+0001c600: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
+0001c610: 7079 2061 7320 6e70 0a20 2020 203e 3e3e  py as np.    >>>
+0001c620: 2069 6d70 6f72 7420 6461 736b 2e61 7272   import dask.arr
+0001c630: 6179 2061 7320 6461 0a20 2020 203e 3e3e  ay as da.    >>>
+0001c640: 2072 6e67 203d 206e 702e 7261 6e64 6f6d   rng = np.random
+0001c650: 2e64 6566 6175 6c74 5f72 6e67 2829 0a20  .default_rng(). 
+0001c660: 2020 203e 3e3e 2078 203d 2072 6e67 2e72     >>> x = rng.r
+0001c670: 616e 646f 6d28 2831 3030 2c20 3629 290a  andom((100, 6)).
+0001c680: 2020 2020 3e3e 3e20 6120 3d20 6461 2e66      >>> a = da.f
+0001c690: 726f 6d5f 6172 7261 7928 782c 2063 6875  rom_array(x, chu
+0001c6a0: 6e6b 733d 2828 3637 2c20 3333 292c 2028  nks=((67, 33), (
+0001c6b0: 362c 2929 290a 2020 2020 2222 220a 2020  6,))).    """.  
+0001c6c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001c6d0: 782c 2041 7272 6179 293a 0a20 2020 2020  x, Array):.     
+0001c6e0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001c6f0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0001c700: 2022 4172 7261 7920 6973 2061 6c72 6561   "Array is alrea
+0001c710: 6479 2061 2064 6173 6b20 6172 7261 792e  dy a dask array.
+0001c720: 2055 7365 2027 6173 6172 7261 7927 206f   Use 'asarray' o
+0001c730: 7220 2220 2227 7265 6368 756e 6b27 2069  r " "'rechunk' i
+0001c740: 6e73 7465 6164 2e22 0a20 2020 2020 2020  nstead.".       
+0001c750: 2029 0a20 2020 2065 6c69 6620 6973 5f64   ).    elif is_d
+0001c760: 6173 6b5f 636f 6c6c 6563 7469 6f6e 2878  ask_collection(x
+0001c770: 293a 0a20 2020 2020 2020 2077 6172 6e69  ):.        warni
+0001c780: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+0001c790: 2020 2020 2020 2250 6173 7369 6e67 2061        "Passing a
+0001c7a0: 6e20 6f62 6a65 6374 2074 6f20 6461 736b  n object to dask
+0001c7b0: 2e61 7272 6179 2e66 726f 6d5f 6172 7261  .array.from_arra
+0001c7c0: 7920 7768 6963 6820 6973 2061 6c72 6561  y which is alrea
+0001c7d0: 6479 2061 2022 0a20 2020 2020 2020 2020  dy a ".         
+0001c7e0: 2020 2022 4461 736b 2063 6f6c 6c65 6374     "Dask collect
+0001c7f0: 696f 6e2e 2054 6869 7320 6361 6e20 6c65  ion. This can le
+0001c800: 6164 2074 6f20 756e 6578 7065 6374 6564  ad to unexpected
+0001c810: 2062 6568 6176 696f 722e 220a 2020 2020   behavior.".    
+0001c820: 2020 2020 290a 0a20 2020 2069 6620 6973      )..    if is
+0001c830: 696e 7374 616e 6365 2878 2c20 286c 6973  instance(x, (lis
+0001c840: 742c 2074 7570 6c65 2c20 6d65 6d6f 7279  t, tuple, memory
+0001c850: 7669 6577 2920 2b20 6e70 2e53 6361 6c61  view) + np.Scala
+0001c860: 7254 7970 6529 3a0a 2020 2020 2020 2020  rType):.        
+0001c870: 7820 3d20 6e70 2e61 7272 6179 2878 290a  x = np.array(x).
+0001c880: 0a20 2020 2069 6620 6173 6172 7261 7920  .    if asarray 
+0001c890: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0001c8a0: 2061 7361 7272 6179 203d 206e 6f74 2068   asarray = not h
+0001c8b0: 6173 6174 7472 2878 2c20 225f 5f61 7272  asattr(x, "__arr
+0001c8c0: 6179 5f66 756e 6374 696f 6e5f 5f22 290a  ay_function__").
+0001c8d0: 0a20 2020 2070 7265 7669 6f75 735f 6368  .    previous_ch
+0001c8e0: 756e 6b73 203d 2067 6574 6174 7472 2878  unks = getattr(x
+0001c8f0: 2c20 2263 6875 6e6b 7322 2c20 4e6f 6e65  , "chunks", None
+0001c900: 290a 0a20 2020 2063 6875 6e6b 7320 3d20  )..    chunks = 
+0001c910: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
+0001c920: 280a 2020 2020 2020 2020 6368 756e 6b73  (.        chunks
+0001c930: 2c20 782e 7368 6170 652c 2064 7479 7065  , x.shape, dtype
+0001c940: 3d78 2e64 7479 7065 2c20 7072 6576 696f  =x.dtype, previo
+0001c950: 7573 5f63 6875 6e6b 733d 7072 6576 696f  us_chunks=previo
+0001c960: 7573 5f63 6875 6e6b 730a 2020 2020 290a  us_chunks.    ).
+0001c970: 0a20 2020 2069 6620 6e61 6d65 2069 6e20  .    if name in 
+0001c980: 284e 6f6e 652c 2054 7275 6529 3a0a 2020  (None, True):.  
+0001c990: 2020 2020 2020 746f 6b65 6e20 3d20 746f        token = to
+0001c9a0: 6b65 6e69 7a65 2878 2c20 6368 756e 6b73  kenize(x, chunks
+0001c9b0: 2c20 6c6f 636b 2c20 6173 6172 7261 792c  , lock, asarray,
+0001c9c0: 2066 616e 6379 2c20 6765 7469 7465 6d2c   fancy, getitem,
+0001c9d0: 2069 6e6c 696e 655f 6172 7261 7929 0a20   inline_array). 
+0001c9e0: 2020 2020 2020 206e 616d 6520 3d20 6e61         name = na
+0001c9f0: 6d65 206f 7220 2261 7272 6179 2d22 202b  me or "array-" +
+0001ca00: 2074 6f6b 656e 0a20 2020 2065 6c69 6620   token.    elif 
+0001ca10: 6e61 6d65 2069 7320 4661 6c73 653a 0a20  name is False:. 
+0001ca20: 2020 2020 2020 206e 616d 6520 3d20 2261         name = "a
+0001ca30: 7272 6179 2d22 202b 2073 7472 2875 7569  rray-" + str(uui
+0001ca40: 642e 7575 6964 3128 2929 0a0a 2020 2020  d.uuid1())..    
+0001ca50: 6966 206c 6f63 6b20 6973 2054 7275 653a  if lock is True:
+0001ca60: 0a20 2020 2020 2020 206c 6f63 6b20 3d20  .        lock = 
+0001ca70: 5365 7269 616c 697a 6162 6c65 4c6f 636b  SerializableLock
+0001ca80: 2829 0a0a 2020 2020 6973 5f6e 6461 7272  ()..    is_ndarr
+0001ca90: 6179 203d 2074 7970 6528 7829 2069 6e20  ay = type(x) in 
+0001caa0: 286e 702e 6e64 6172 7261 792c 206e 702e  (np.ndarray, np.
+0001cab0: 6d61 2e63 6f72 652e 4d61 736b 6564 4172  ma.core.MaskedAr
+0001cac0: 7261 7929 0a20 2020 2069 735f 7369 6e67  ray).    is_sing
+0001cad0: 6c65 5f62 6c6f 636b 203d 2061 6c6c 286c  le_block = all(l
+0001cae0: 656e 2863 2920 3d3d 2031 2066 6f72 2063  en(c) == 1 for c
+0001caf0: 2069 6e20 6368 756e 6b73 290a 2020 2020   in chunks).    
+0001cb00: 2320 416c 7761 7973 2075 7365 2074 6865  # Always use the
+0001cb10: 2067 6574 7465 7220 666f 7220 6835 7079   getter for h5py
+0001cb20: 2065 7463 2e20 4e6f 7420 7573 696e 6720   etc. Not using 
+0001cb30: 6973 696e 7374 616e 6365 2878 2c20 6e70  isinstance(x, np
+0001cb40: 2e6e 6461 7272 6179 290a 2020 2020 2320  .ndarray).    # 
+0001cb50: 6265 6361 7573 6520 6e70 2e6d 6174 7269  because np.matri
+0001cb60: 7820 6973 2061 2073 7562 636c 6173 7320  x is a subclass 
+0001cb70: 6f66 206e 702e 6e64 6172 7261 792e 0a20  of np.ndarray.. 
+0001cb80: 2020 2069 6620 6973 5f6e 6461 7272 6179     if is_ndarray
+0001cb90: 2061 6e64 206e 6f74 2069 735f 7369 6e67   and not is_sing
+0001cba0: 6c65 5f62 6c6f 636b 2061 6e64 206e 6f74  le_block and not
+0001cbb0: 206c 6f63 6b3a 0a20 2020 2020 2020 2023   lock:.        #
+0001cbc0: 2065 6167 6572 6c79 2073 6c69 6365 206e   eagerly slice n
+0001cbd0: 756d 7079 2061 7272 6179 7320 746f 2070  umpy arrays to p
+0001cbe0: 7265 7665 6e74 206d 656d 6f72 7920 626c  revent memory bl
+0001cbf0: 6f77 7570 0a20 2020 2020 2020 2023 2047  owup.        # G
+0001cc00: 4835 3336 372c 2047 4835 3630 310a 2020  H5367, GH5601.  
+0001cc10: 2020 2020 2020 736c 6963 6573 203d 2073        slices = s
+0001cc20: 6c69 6365 735f 6672 6f6d 5f63 6875 6e6b  lices_from_chunk
+0001cc30: 7328 6368 756e 6b73 290a 2020 2020 2020  s(chunks).      
+0001cc40: 2020 6b65 7973 203d 2070 726f 6475 6374    keys = product
+0001cc50: 285b 6e61 6d65 5d2c 202a 2872 616e 6765  ([name], *(range
+0001cc60: 286c 656e 2862 6473 2929 2066 6f72 2062  (len(bds)) for b
+0001cc70: 6473 2069 6e20 6368 756e 6b73 2929 0a20  ds in chunks)). 
+0001cc80: 2020 2020 2020 2076 616c 7565 7320 3d20         values = 
+0001cc90: 5b78 5b73 6c63 5d20 666f 7220 736c 6320  [x[slc] for slc 
+0001cca0: 696e 2073 6c69 6365 735d 0a20 2020 2020  in slices].     
+0001ccb0: 2020 2064 736b 203d 2064 6963 7428 7a69     dsk = dict(zi
+0001ccc0: 7028 6b65 7973 2c20 7661 6c75 6573 2929  p(keys, values))
+0001ccd0: 0a0a 2020 2020 656c 6966 2069 735f 6e64  ..    elif is_nd
+0001cce0: 6172 7261 7920 616e 6420 6973 5f73 696e  array and is_sin
+0001ccf0: 676c 655f 626c 6f63 6b3a 0a20 2020 2020  gle_block:.     
+0001cd00: 2020 2023 204e 6f20 736c 6963 696e 6720     # No slicing 
+0001cd10: 6e65 6564 6564 0a20 2020 2020 2020 2064  needed.        d
+0001cd20: 736b 203d 207b 286e 616d 652c 2920 2b20  sk = {(name,) + 
+0001cd30: 2830 2c29 202a 2078 2e6e 6469 6d3a 2078  (0,) * x.ndim: x
+0001cd40: 7d0a 2020 2020 656c 7365 3a0a 2020 2020  }.    else:.    
+0001cd50: 2020 2020 6966 2067 6574 6974 656d 2069      if getitem i
+0001cd60: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001cd70: 2020 2020 6966 2066 616e 6379 3a0a 2020      if fancy:.  
+0001cd80: 2020 2020 2020 2020 2020 2020 2020 6765                ge
+0001cd90: 7469 7465 6d20 3d20 6765 7474 6572 0a20  titem = getter. 
+0001cda0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001cdb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cdc0: 2067 6574 6974 656d 203d 2067 6574 7465   getitem = gette
+0001cdd0: 725f 6e6f 6661 6e63 790a 0a20 2020 2020  r_nofancy..     
+0001cde0: 2020 2064 736b 203d 2067 7261 7068 5f66     dsk = graph_f
+0001cdf0: 726f 6d5f 6172 7261 796c 696b 6528 0a20  rom_arraylike(. 
+0001ce00: 2020 2020 2020 2020 2020 2078 2c0a 2020             x,.  
+0001ce10: 2020 2020 2020 2020 2020 6368 756e 6b73            chunks
+0001ce20: 2c0a 2020 2020 2020 2020 2020 2020 782e  ,.            x.
+0001ce30: 7368 6170 652c 0a20 2020 2020 2020 2020  shape,.         
+0001ce40: 2020 206e 616d 652c 0a20 2020 2020 2020     name,.       
+0001ce50: 2020 2020 2067 6574 6974 656d 3d67 6574       getitem=get
+0001ce60: 6974 656d 2c0a 2020 2020 2020 2020 2020  item,.          
+0001ce70: 2020 6c6f 636b 3d6c 6f63 6b2c 0a20 2020    lock=lock,.   
+0001ce80: 2020 2020 2020 2020 2061 7361 7272 6179           asarray
+0001ce90: 3d61 7361 7272 6179 2c0a 2020 2020 2020  =asarray,.      
+0001cea0: 2020 2020 2020 6474 7970 653d 782e 6474        dtype=x.dt
+0001ceb0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0001cec0: 2069 6e6c 696e 655f 6172 7261 793d 696e   inline_array=in
+0001ced0: 6c69 6e65 5f61 7272 6179 2c0a 2020 2020  line_array,.    
+0001cee0: 2020 2020 290a 0a20 2020 2023 2057 6f72      )..    # Wor
+0001cef0: 6b61 726f 756e 6420 666f 7220 5469 6c65  karound for Tile
+0001cf00: 4442 2c20 6974 7320 696e 6465 7869 6e67  DB, its indexing
+0001cf10: 2069 7320 312d 6261 7365 642c 0a20 2020   is 1-based,.   
+0001cf20: 2023 2061 6e64 2064 6f65 736e 2774 2073   # and doesn't s
+0001cf30: 6565 6d73 2074 6f20 7375 7070 6f72 7420  eems to support 
+0001cf40: 302d 6c65 6e67 7468 2073 6c69 6369 6e67  0-length slicing
+0001cf50: 0a20 2020 2069 6620 782e 5f5f 636c 6173  .    if x.__clas
+0001cf60: 735f 5f2e 5f5f 6d6f 6475 6c65 5f5f 2e73  s__.__module__.s
+0001cf70: 706c 6974 2822 2e22 295b 305d 203d 3d20  plit(".")[0] == 
+0001cf80: 2274 696c 6564 6222 2061 6e64 2068 6173  "tiledb" and has
+0001cf90: 6174 7472 2878 2c20 225f 6374 785f 2229  attr(x, "_ctx_")
+0001cfa0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001cfb0: 2041 7272 6179 2864 736b 2c20 6e61 6d65   Array(dsk, name
+0001cfc0: 2c20 6368 756e 6b73 2c20 6474 7970 653d  , chunks, dtype=
+0001cfd0: 782e 6474 7970 6529 0a0a 2020 2020 6966  x.dtype)..    if
+0001cfe0: 206d 6574 6120 6973 204e 6f6e 653a 0a20   meta is None:. 
+0001cff0: 2020 2020 2020 206d 6574 6120 3d20 780a         meta = x.
+0001d000: 0a20 2020 2072 6574 7572 6e20 4172 7261  .    return Arra
+0001d010: 7928 6473 6b2c 206e 616d 652c 2063 6875  y(dsk, name, chu
+0001d020: 6e6b 732c 206d 6574 613d 6d65 7461 2c20  nks, meta=meta, 
+0001d030: 6474 7970 653d 6765 7461 7474 7228 782c  dtype=getattr(x,
+0001d040: 2022 6474 7970 6522 2c20 4e6f 6e65 2929   "dtype", None))
+0001d050: 0a0a 0a64 6566 2066 726f 6d5f 7a61 7272  ...def from_zarr
+0001d060: 280a 2020 2020 7572 6c2c 0a20 2020 2063  (.    url,.    c
+0001d070: 6f6d 706f 6e65 6e74 3d4e 6f6e 652c 0a20  omponent=None,. 
+0001d080: 2020 2073 746f 7261 6765 5f6f 7074 696f     storage_optio
+0001d090: 6e73 3d4e 6f6e 652c 0a20 2020 2063 6875  ns=None,.    chu
+0001d0a0: 6e6b 733d 4e6f 6e65 2c0a 2020 2020 6e61  nks=None,.    na
+0001d0b0: 6d65 3d4e 6f6e 652c 0a20 2020 2069 6e6c  me=None,.    inl
+0001d0c0: 696e 655f 6172 7261 793d 4661 6c73 652c  ine_array=False,
+0001d0d0: 0a20 2020 202a 2a6b 7761 7267 732c 0a29  .    **kwargs,.)
+0001d0e0: 3a0a 2020 2020 2222 224c 6f61 6420 6172  :.    """Load ar
+0001d0f0: 7261 7920 6672 6f6d 2074 6865 207a 6172  ray from the zar
+0001d100: 7220 7374 6f72 6167 6520 666f 726d 6174  r storage format
+0001d110: 0a0a 2020 2020 5365 6520 6874 7470 733a  ..    See https:
+0001d120: 2f2f 7a61 7272 2e72 6561 6474 6865 646f  //zarr.readthedo
+0001d130: 6373 2e69 6f20 666f 7220 6465 7461 696c  cs.io for detail
+0001d140: 7320 6162 6f75 7420 7468 6520 666f 726d  s about the form
+0001d150: 6174 2e0a 0a20 2020 2050 6172 616d 6574  at...    Paramet
+0001d160: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+0001d170: 2d2d 0a20 2020 2075 726c 3a20 5a61 7272  --.    url: Zarr
+0001d180: 2041 7272 6179 206f 7220 7374 7220 6f72   Array or str or
+0001d190: 204d 7574 6162 6c65 4d61 7070 696e 670a   MutableMapping.
+0001d1a0: 2020 2020 2020 2020 4c6f 6361 7469 6f6e          Location
+0001d1b0: 206f 6620 7468 6520 6461 7461 2e20 4120   of the data. A 
+0001d1c0: 5552 4c20 6361 6e20 696e 636c 7564 6520  URL can include 
+0001d1d0: 6120 7072 6f74 6f63 6f6c 2073 7065 6369  a protocol speci
+0001d1e0: 6669 6572 206c 696b 6520 7333 3a2f 2f0a  fier like s3://.
+0001d1f0: 2020 2020 2020 2020 666f 7220 7265 6d6f          for remo
+0001d200: 7465 2064 6174 612e 2043 616e 2061 6c73  te data. Can als
+0001d210: 6f20 6265 2061 6e79 204d 7574 6162 6c65  o be any Mutable
+0001d220: 4d61 7070 696e 6720 696e 7374 616e 6365  Mapping instance
+0001d230: 2c20 7768 6963 6820 7368 6f75 6c64 0a20  , which should. 
+0001d240: 2020 2020 2020 2062 6520 7365 7269 616c         be serial
+0001d250: 697a 6162 6c65 2069 6620 7573 6564 2069  izable if used i
+0001d260: 6e20 6d75 6c74 6970 6c65 2070 726f 6365  n multiple proce
+0001d270: 7373 6573 2e0a 2020 2020 636f 6d70 6f6e  sses..    compon
+0001d280: 656e 743a 2073 7472 206f 7220 4e6f 6e65  ent: str or None
+0001d290: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
+0001d2a0: 6c6f 6361 7469 6f6e 2069 7320 6120 7a61  location is a za
+0001d2b0: 7272 2067 726f 7570 2072 6174 6865 7220  rr group rather 
+0001d2c0: 7468 616e 2061 6e20 6172 7261 792c 2074  than an array, t
+0001d2d0: 6869 7320 6973 2074 6865 0a20 2020 2020  his is the.     
+0001d2e0: 2020 2073 7562 636f 6d70 6f6e 656e 7420     subcomponent 
+0001d2f0: 7468 6174 2073 686f 756c 6420 6265 206c  that should be l
+0001d300: 6f61 6465 642c 2073 6f6d 6574 6869 6e67  oaded, something
+0001d310: 206c 696b 6520 6060 2766 6f6f 2f62 6172   like ``'foo/bar
+0001d320: 2760 602e 0a20 2020 2073 746f 7261 6765  '``..    storage
+0001d330: 5f6f 7074 696f 6e73 3a20 6469 6374 0a20  _options: dict. 
+0001d340: 2020 2020 2020 2041 6e79 2061 6464 6974         Any addit
+0001d350: 696f 6e61 6c20 7061 7261 6d65 7465 7273  ional parameters
+0001d360: 2066 6f72 2074 6865 2073 746f 7261 6765   for the storage
+0001d370: 2062 6163 6b65 6e64 2028 6967 6e6f 7265   backend (ignore
+0001d380: 6420 666f 7220 6c6f 6361 6c0a 2020 2020  d for local.    
+0001d390: 2020 2020 7061 7468 7329 0a20 2020 2063      paths).    c
+0001d3a0: 6875 6e6b 733a 2074 7570 6c65 206f 6620  hunks: tuple of 
+0001d3b0: 696e 7473 206f 7220 7475 706c 6573 206f  ints or tuples o
+0001d3c0: 6620 696e 7473 0a20 2020 2020 2020 2050  f ints.        P
+0001d3d0: 6173 7365 6420 746f 203a 6675 6e63 3a60  assed to :func:`
+0001d3e0: 6461 736b 2e61 7272 6179 2e66 726f 6d5f  dask.array.from_
+0001d3f0: 6172 7261 7960 2c20 616c 6c6f 7773 2073  array`, allows s
+0001d400: 6574 7469 6e67 2074 6865 2063 6875 6e6b  etting the chunk
+0001d410: 7320 6f6e 0a20 2020 2020 2020 2069 6e69  s on.        ini
+0001d420: 7469 616c 6973 6174 696f 6e2c 2069 6620  tialisation, if 
+0001d430: 7468 6520 6368 756e 6b69 6e67 2073 6368  the chunking sch
+0001d440: 656d 6520 696e 2074 6865 206f 6e2d 6469  eme in the on-di
+0001d450: 7363 2064 6174 6173 6574 2069 7320 6e6f  sc dataset is no
+0001d460: 740a 2020 2020 2020 2020 6f70 7469 6d61  t.        optima
+0001d470: 6c20 666f 7220 7468 6520 6361 6c63 756c  l for the calcul
+0001d480: 6174 696f 6e73 2074 6f20 666f 6c6c 6f77  ations to follow
+0001d490: 2e0a 2020 2020 6e61 6d65 203a 2073 7472  ..    name : str
+0001d4a0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001d4b0: 2020 2020 416e 206f 7074 696f 6e61 6c20      An optional 
+0001d4c0: 6b65 796e 616d 6520 666f 7220 7468 6520  keyname for the 
+0001d4d0: 6172 7261 792e 2020 4465 6661 756c 7473  array.  Defaults
+0001d4e0: 2074 6f20 6861 7368 696e 6720 7468 6520   to hashing the 
+0001d4f0: 696e 7075 740a 2020 2020 6b77 6172 6773  input.    kwargs
+0001d500: 3a0a 2020 2020 2020 2020 5061 7373 6564  :.        Passed
+0001d510: 2074 6f20 3a63 6c61 7373 3a60 7a61 7272   to :class:`zarr
+0001d520: 2e63 6f72 652e 4172 7261 7960 2e0a 2020  .core.Array`..  
+0001d530: 2020 696e 6c69 6e65 5f61 7272 6179 203a    inline_array :
+0001d540: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
+0001d550: 616c 7365 0a20 2020 2020 2020 2057 6865  alse.        Whe
+0001d560: 7468 6572 2074 6f20 696e 6c69 6e65 2074  ther to inline t
+0001d570: 6865 207a 6172 7220 4172 7261 7920 696e  he zarr Array in
+0001d580: 2074 6865 2076 616c 7565 7320 6f66 2074   the values of t
+0001d590: 6865 2074 6173 6b20 6772 6170 682e 0a20  he task graph.. 
+0001d5a0: 2020 2020 2020 2053 6565 203a 6d65 7468         See :meth
+0001d5b0: 3a60 6461 736b 2e61 7272 6179 2e66 726f  :`dask.array.fro
+0001d5c0: 6d5f 6172 7261 7960 2066 6f72 2061 6e20  m_array` for an 
+0001d5d0: 6578 706c 616e 6174 696f 6e2e 0a0a 2020  explanation...  
+0001d5e0: 2020 5365 6520 416c 736f 0a20 2020 202d    See Also.    -
+0001d5f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6672 6f6d  -------.    from
+0001d600: 5f61 7272 6179 0a20 2020 2022 2222 0a20  _array.    """. 
+0001d610: 2020 2069 6d70 6f72 7420 7a61 7272 0a0a     import zarr..
+0001d620: 2020 2020 7374 6f72 6167 655f 6f70 7469      storage_opti
+0001d630: 6f6e 7320 3d20 7374 6f72 6167 655f 6f70  ons = storage_op
+0001d640: 7469 6f6e 7320 6f72 207b 7d0a 2020 2020  tions or {}.    
+0001d650: 6966 2069 7369 6e73 7461 6e63 6528 7572  if isinstance(ur
+0001d660: 6c2c 207a 6172 722e 4172 7261 7929 3a0a  l, zarr.Array):.
+0001d670: 2020 2020 2020 2020 7a20 3d20 7572 6c0a          z = url.
+0001d680: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+0001d690: 6e63 6528 7572 6c2c 2028 7374 722c 206f  nce(url, (str, o
+0001d6a0: 732e 5061 7468 4c69 6b65 2929 3a0a 2020  s.PathLike)):.  
+0001d6b0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0001d6c0: 6e63 6528 7572 6c2c 206f 732e 5061 7468  nce(url, os.Path
+0001d6d0: 4c69 6b65 293a 0a20 2020 2020 2020 2020  Like):.         
+0001d6e0: 2020 2075 726c 203d 206f 732e 6673 7061     url = os.fspa
+0001d6f0: 7468 2875 726c 290a 2020 2020 2020 2020  th(url).        
+0001d700: 6966 2073 746f 7261 6765 5f6f 7074 696f  if storage_optio
+0001d710: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0001d720: 7374 6f72 6520 3d20 7a61 7272 2e73 746f  store = zarr.sto
+0001d730: 7261 6765 2e46 5353 746f 7265 2875 726c  rage.FSStore(url
+0001d740: 2c20 2a2a 7374 6f72 6167 655f 6f70 7469  , **storage_opti
+0001d750: 6f6e 7329 0a20 2020 2020 2020 2065 6c73  ons).        els
+0001d760: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0001d770: 746f 7265 203d 2075 726c 0a20 2020 2020  tore = url.     
+0001d780: 2020 207a 203d 207a 6172 722e 4172 7261     z = zarr.Arra
+0001d790: 7928 7374 6f72 652c 2072 6561 645f 6f6e  y(store, read_on
+0001d7a0: 6c79 3d54 7275 652c 2070 6174 683d 636f  ly=True, path=co
+0001d7b0: 6d70 6f6e 656e 742c 202a 2a6b 7761 7267  mponent, **kwarg
+0001d7c0: 7329 0a20 2020 2065 6c73 653a 0a20 2020  s).    else:.   
+0001d7d0: 2020 2020 207a 203d 207a 6172 722e 4172       z = zarr.Ar
+0001d7e0: 7261 7928 7572 6c2c 2072 6561 645f 6f6e  ray(url, read_on
+0001d7f0: 6c79 3d54 7275 652c 2070 6174 683d 636f  ly=True, path=co
+0001d800: 6d70 6f6e 656e 742c 202a 2a6b 7761 7267  mponent, **kwarg
+0001d810: 7329 0a20 2020 2063 6875 6e6b 7320 3d20  s).    chunks = 
+0001d820: 6368 756e 6b73 2069 6620 6368 756e 6b73  chunks if chunks
+0001d830: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+0001d840: 6520 7a2e 6368 756e 6b73 0a20 2020 2069  e z.chunks.    i
+0001d850: 6620 6e61 6d65 2069 7320 4e6f 6e65 3a0a  f name is None:.
+0001d860: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
+0001d870: 6672 6f6d 2d7a 6172 722d 2220 2b20 746f  from-zarr-" + to
+0001d880: 6b65 6e69 7a65 287a 2c20 636f 6d70 6f6e  kenize(z, compon
+0001d890: 656e 742c 2073 746f 7261 6765 5f6f 7074  ent, storage_opt
+0001d8a0: 696f 6e73 2c20 6368 756e 6b73 2c20 2a2a  ions, chunks, **
+0001d8b0: 6b77 6172 6773 290a 2020 2020 7265 7475  kwargs).    retu
+0001d8c0: 726e 2066 726f 6d5f 6172 7261 7928 7a2c  rn from_array(z,
+0001d8d0: 2063 6875 6e6b 732c 206e 616d 653d 6e61   chunks, name=na
+0001d8e0: 6d65 2c20 696e 6c69 6e65 5f61 7272 6179  me, inline_array
+0001d8f0: 3d69 6e6c 696e 655f 6172 7261 7929 0a0a  =inline_array)..
+0001d900: 0a64 6566 2074 6f5f 7a61 7272 280a 2020  .def to_zarr(.  
+0001d910: 2020 6172 722c 0a20 2020 2075 726c 2c0a    arr,.    url,.
+0001d920: 2020 2020 636f 6d70 6f6e 656e 743d 4e6f      component=No
+0001d930: 6e65 2c0a 2020 2020 7374 6f72 6167 655f  ne,.    storage_
+0001d940: 6f70 7469 6f6e 733d 4e6f 6e65 2c0a 2020  options=None,.  
+0001d950: 2020 6f76 6572 7772 6974 653d 4661 6c73    overwrite=Fals
+0001d960: 652c 0a20 2020 2072 6567 696f 6e3d 4e6f  e,.    region=No
+0001d970: 6e65 2c0a 2020 2020 636f 6d70 7574 653d  ne,.    compute=
+0001d980: 5472 7565 2c0a 2020 2020 7265 7475 726e  True,.    return
+0001d990: 5f73 746f 7265 643d 4661 6c73 652c 0a20  _stored=False,. 
+0001d9a0: 2020 202a 2a6b 7761 7267 732c 0a29 3a0a     **kwargs,.):.
+0001d9b0: 2020 2020 2222 2253 6176 6520 6172 7261      """Save arra
+0001d9c0: 7920 746f 2074 6865 207a 6172 7220 7374  y to the zarr st
+0001d9d0: 6f72 6167 6520 666f 726d 6174 0a0a 2020  orage format..  
+0001d9e0: 2020 5365 6520 6874 7470 733a 2f2f 7a61    See https://za
+0001d9f0: 7272 2e72 6561 6474 6865 646f 6373 2e69  rr.readthedocs.i
+0001da00: 6f20 666f 7220 6465 7461 696c 7320 6162  o for details ab
+0001da10: 6f75 7420 7468 6520 666f 726d 6174 2e0a  out the format..
+0001da20: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0001da30: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0001da40: 2020 2061 7272 3a20 6461 736b 2e61 7272     arr: dask.arr
+0001da50: 6179 0a20 2020 2020 2020 2044 6174 6120  ay.        Data 
+0001da60: 746f 2073 746f 7265 0a20 2020 2075 726c  to store.    url
+0001da70: 3a20 5a61 7272 2041 7272 6179 206f 7220  : Zarr Array or 
+0001da80: 7374 7220 6f72 204d 7574 6162 6c65 4d61  str or MutableMa
+0001da90: 7070 696e 670a 2020 2020 2020 2020 4c6f  pping.        Lo
+0001daa0: 6361 7469 6f6e 206f 6620 7468 6520 6461  cation of the da
+0001dab0: 7461 2e20 4120 5552 4c20 6361 6e20 696e  ta. A URL can in
+0001dac0: 636c 7564 6520 6120 7072 6f74 6f63 6f6c  clude a protocol
+0001dad0: 2073 7065 6369 6669 6572 206c 696b 6520   specifier like 
+0001dae0: 7333 3a2f 2f0a 2020 2020 2020 2020 666f  s3://.        fo
+0001daf0: 7220 7265 6d6f 7465 2064 6174 612e 2043  r remote data. C
+0001db00: 616e 2061 6c73 6f20 6265 2061 6e79 204d  an also be any M
+0001db10: 7574 6162 6c65 4d61 7070 696e 6720 696e  utableMapping in
+0001db20: 7374 616e 6365 2c20 7768 6963 6820 7368  stance, which sh
+0001db30: 6f75 6c64 0a20 2020 2020 2020 2062 6520  ould.        be 
+0001db40: 7365 7269 616c 697a 6162 6c65 2069 6620  serializable if 
+0001db50: 7573 6564 2069 6e20 6d75 6c74 6970 6c65  used in multiple
+0001db60: 2070 726f 6365 7373 6573 2e0a 2020 2020   processes..    
+0001db70: 636f 6d70 6f6e 656e 743a 2073 7472 206f  component: str o
+0001db80: 7220 4e6f 6e65 0a20 2020 2020 2020 2049  r None.        I
+0001db90: 6620 7468 6520 6c6f 6361 7469 6f6e 2069  f the location i
+0001dba0: 7320 6120 7a61 7272 2067 726f 7570 2072  s a zarr group r
+0001dbb0: 6174 6865 7220 7468 616e 2061 6e20 6172  ather than an ar
+0001dbc0: 7261 792c 2074 6869 7320 6973 2074 6865  ray, this is the
+0001dbd0: 0a20 2020 2020 2020 2073 7562 636f 6d70  .        subcomp
+0001dbe0: 6f6e 656e 7420 7468 6174 2073 686f 756c  onent that shoul
+0001dbf0: 6420 6265 2063 7265 6174 6564 2f6f 7665  d be created/ove
+0001dc00: 722d 7772 6974 7465 6e2e 0a20 2020 2073  r-written..    s
+0001dc10: 746f 7261 6765 5f6f 7074 696f 6e73 3a20  torage_options: 
+0001dc20: 6469 6374 0a20 2020 2020 2020 2041 6e79  dict.        Any
+0001dc30: 2061 6464 6974 696f 6e61 6c20 7061 7261   additional para
+0001dc40: 6d65 7465 7273 2066 6f72 2074 6865 2073  meters for the s
+0001dc50: 746f 7261 6765 2062 6163 6b65 6e64 2028  torage backend (
+0001dc60: 6967 6e6f 7265 6420 666f 7220 6c6f 6361  ignored for loca
+0001dc70: 6c0a 2020 2020 2020 2020 7061 7468 7329  l.        paths)
+0001dc80: 0a20 2020 206f 7665 7277 7269 7465 3a20  .    overwrite: 
+0001dc90: 626f 6f6c 0a20 2020 2020 2020 2049 6620  bool.        If 
+0001dca0: 6769 7665 6e20 6172 7261 7920 616c 7265  given array alre
+0001dcb0: 6164 7920 6578 6973 7473 2c20 6f76 6572  ady exists, over
+0001dcc0: 7772 6974 653d 4661 6c73 6520 7769 6c6c  write=False will
+0001dcd0: 2063 6175 7365 2061 6e20 6572 726f 722c   cause an error,
+0001dce0: 0a20 2020 2020 2020 2077 6865 7265 206f  .        where o
+0001dcf0: 7665 7277 7269 7465 3d54 7275 6520 7769  verwrite=True wi
+0001dd00: 6c6c 2072 6570 6c61 6365 2074 6865 2065  ll replace the e
+0001dd10: 7869 7374 696e 6720 6461 7461 2e0a 2020  xisting data..  
+0001dd20: 2020 7265 6769 6f6e 3a20 7475 706c 6520    region: tuple 
+0001dd30: 6f66 2073 6c69 6365 7320 6f72 204e 6f6e  of slices or Non
+0001dd40: 650a 2020 2020 2020 2020 5468 6520 7265  e.        The re
+0001dd50: 6769 6f6e 206f 6620 6461 7461 2074 6861  gion of data tha
+0001dd60: 7420 7368 6f75 6c64 2062 6520 7772 6974  t should be writ
+0001dd70: 7465 6e20 6966 2060 6075 726c 6060 2069  ten if ``url`` i
+0001dd80: 7320 6120 7a61 7272 2e41 7272 6179 2e0a  s a zarr.Array..
+0001dd90: 2020 2020 2020 2020 4e6f 7420 746f 2062          Not to b
+0001dda0: 6520 7573 6564 2077 6974 6820 6f74 6865  e used with othe
+0001ddb0: 7220 7479 7065 7320 6f66 2060 6075 726c  r types of ``url
+0001ddc0: 6060 2e0a 2020 2020 636f 6d70 7574 653a  ``..    compute:
+0001ddd0: 2062 6f6f 6c0a 2020 2020 2020 2020 5365   bool.        Se
+0001dde0: 6520 3a66 756e 633a 607e 6461 736b 2e61  e :func:`~dask.a
+0001ddf0: 7272 6179 2e73 746f 7265 6020 666f 7220  rray.store` for 
+0001de00: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
+0001de10: 2020 7265 7475 726e 5f73 746f 7265 643a    return_stored:
+0001de20: 2062 6f6f 6c0a 2020 2020 2020 2020 5365   bool.        Se
+0001de30: 6520 3a66 756e 633a 607e 6461 736b 2e61  e :func:`~dask.a
+0001de40: 7272 6179 2e73 746f 7265 6020 666f 7220  rray.store` for 
+0001de50: 6d6f 7265 2064 6574 6169 6c73 2e0a 2020  more details..  
+0001de60: 2020 2a2a 6b77 6172 6773 3a0a 2020 2020    **kwargs:.    
+0001de70: 2020 2020 5061 7373 6564 2074 6f20 7468      Passed to th
+0001de80: 6520 3a66 756e 633a 607a 6172 722e 6372  e :func:`zarr.cr
+0001de90: 6561 7469 6f6e 2e63 7265 6174 6560 2066  eation.create` f
+0001dea0: 756e 6374 696f 6e2c 2065 2e67 2e2c 2063  unction, e.g., c
+0001deb0: 6f6d 7072 6573 7369 6f6e 206f 7074 696f  ompression optio
+0001dec0: 6e73 2e0a 0a20 2020 2052 6169 7365 730a  ns...    Raises.
+0001ded0: 2020 2020 2d2d 2d2d 2d2d 0a20 2020 2056      ------.    V
+0001dee0: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
+0001def0: 2020 4966 2060 6061 7272 6060 2068 6173    If ``arr`` has
+0001df00: 2075 6e6b 6e6f 776e 2063 6875 6e6b 2073   unknown chunk s
+0001df10: 697a 6573 2c20 7768 6963 6820 6973 206e  izes, which is n
+0001df20: 6f74 2073 7570 706f 7274 6564 2062 7920  ot supported by 
+0001df30: 5a61 7272 2e0a 2020 2020 2020 2020 4966  Zarr..        If
+0001df40: 2060 6072 6567 696f 6e60 6020 6973 2073   ``region`` is s
+0001df50: 7065 6369 6669 6564 2061 6e64 2060 6075  pecified and ``u
+0001df60: 726c 6060 2069 7320 6e6f 7420 6120 7a61  rl`` is not a za
+0001df70: 7272 2e41 7272 6179 0a0a 2020 2020 5365  rr.Array..    Se
+0001df80: 6520 416c 736f 0a20 2020 202d 2d2d 2d2d  e Also.    -----
+0001df90: 2d2d 2d0a 2020 2020 6461 736b 2e61 7272  ---.    dask.arr
+0001dfa0: 6179 2e73 746f 7265 0a20 2020 2064 6173  ay.store.    das
+0001dfb0: 6b2e 6172 7261 792e 4172 7261 792e 636f  k.array.Array.co
+0001dfc0: 6d70 7574 655f 6368 756e 6b5f 7369 7a65  mpute_chunk_size
+0001dfd0: 730a 0a20 2020 2022 2222 0a20 2020 2069  s..    """.    i
+0001dfe0: 6d70 6f72 7420 7a61 7272 0a0a 2020 2020  mport zarr..    
+0001dff0: 6966 206e 702e 6973 6e61 6e28 6172 722e  if np.isnan(arr.
+0001e000: 7368 6170 6529 2e61 6e79 2829 3a0a 2020  shape).any():.  
+0001e010: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001e020: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001e030: 2020 2020 2253 6176 696e 6720 6120 6461      "Saving a da
+0001e040: 736b 2061 7272 6179 2077 6974 6820 756e  sk array with un
+0001e050: 6b6e 6f77 6e20 6368 756e 6b20 7369 7a65  known chunk size
+0001e060: 7320 6973 206e 6f74 2022 0a20 2020 2020  s is not ".     
+0001e070: 2020 2020 2020 2022 6375 7272 656e 746c         "currentl
+0001e080: 7920 7375 7070 6f72 7465 6420 6279 205a  y supported by Z
+0001e090: 6172 722e 2573 2220 2520 756e 6b6e 6f77  arr.%s" % unknow
+0001e0a0: 6e5f 6368 756e 6b5f 6d65 7373 6167 650a  n_chunk_message.
+0001e0b0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
+0001e0c0: 6620 6973 696e 7374 616e 6365 2875 726c  f isinstance(url
+0001e0d0: 2c20 7a61 7272 2e41 7272 6179 293a 0a20  , zarr.Array):. 
+0001e0e0: 2020 2020 2020 207a 203d 2075 726c 0a20         z = url. 
+0001e0f0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001e100: 616e 6365 287a 2e73 746f 7265 2c20 2864  ance(z.store, (d
+0001e110: 6963 742c 204d 7574 6162 6c65 4d61 7070  ict, MutableMapp
+0001e120: 696e 6729 293a 0a20 2020 2020 2020 2020  ing)):.         
+0001e130: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0001e140: 2020 2020 2020 2020 6672 6f6d 2064 6973          from dis
+0001e150: 7472 6962 7574 6564 2069 6d70 6f72 7420  tributed import 
+0001e160: 6465 6661 756c 745f 636c 6965 6e74 0a0a  default_client..
+0001e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e180: 6465 6661 756c 745f 636c 6965 6e74 2829  default_client()
+0001e190: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+0001e1a0: 6570 7420 2849 6d70 6f72 7445 7272 6f72  ept (ImportError
+0001e1b0: 2c20 5661 6c75 6545 7272 6f72 293a 0a20  , ValueError):. 
+0001e1c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001e1d0: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
+0001e1e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001e1f0: 2020 2020 2020 7261 6973 6520 5275 6e74        raise Runt
+0001e200: 696d 6545 7272 6f72 280a 2020 2020 2020  imeError(.      
+0001e210: 2020 2020 2020 2020 2020 2020 2020 2243                "C
+0001e220: 616e 6e6f 7420 7374 6f72 6520 696e 746f  annot store into
+0001e230: 2069 6e20 6d65 6d6f 7279 205a 6172 7220   in memory Zarr 
+0001e240: 4172 7261 7920 7573 696e 6720 220a 2020  Array using ".  
+0001e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e260: 2020 2274 6865 2064 6973 7472 6962 7574    "the distribut
+0001e270: 6564 2073 6368 6564 756c 6572 2e22 0a20  ed scheduler.". 
+0001e280: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001e290: 0a0a 2020 2020 2020 2020 6966 2072 6567  ..        if reg
+0001e2a0: 696f 6e20 6973 204e 6f6e 653a 0a20 2020  ion is None:.   
+0001e2b0: 2020 2020 2020 2020 2061 7272 203d 2061           arr = a
+0001e2c0: 7272 2e72 6563 6875 6e6b 287a 2e63 6875  rr.rechunk(z.chu
+0001e2d0: 6e6b 7329 0a20 2020 2020 2020 2020 2020  nks).           
+0001e2e0: 2072 6567 696f 6e73 203d 204e 6f6e 650a   regions = None.
+0001e2f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001e300: 2020 2020 2020 2020 2020 6672 6f6d 2064            from d
+0001e310: 6173 6b2e 6172 7261 792e 736c 6963 696e  ask.array.slicin
+0001e320: 6720 696d 706f 7274 206e 6577 5f62 6c6f  g import new_blo
+0001e330: 636b 6469 6d2c 206e 6f72 6d61 6c69 7a65  ckdim, normalize
+0001e340: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
+0001e350: 2020 2020 6f6c 645f 6368 756e 6b73 203d      old_chunks =
+0001e360: 206e 6f72 6d61 6c69 7a65 5f63 6875 6e6b   normalize_chunk
+0001e370: 7328 7a2e 6368 756e 6b73 2c20 7a2e 7368  s(z.chunks, z.sh
+0001e380: 6170 6529 0a20 2020 2020 2020 2020 2020  ape).           
+0001e390: 2069 6e64 6578 203d 206e 6f72 6d61 6c69   index = normali
+0001e3a0: 7a65 5f69 6e64 6578 2872 6567 696f 6e2c  ze_index(region,
+0001e3b0: 207a 2e73 6861 7065 290a 2020 2020 2020   z.shape).      
+0001e3c0: 2020 2020 2020 6368 756e 6b73 203d 2074        chunks = t
+0001e3d0: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
+0001e3e0: 2020 2020 2020 7475 706c 6528 6e65 775f        tuple(new_
+0001e3f0: 626c 6f63 6b64 696d 2873 2c20 632c 2072  blockdim(s, c, r
+0001e400: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0001e410: 2020 2066 6f72 2073 2c20 632c 2072 2069     for s, c, r i
+0001e420: 6e20 7a69 7028 7a2e 7368 6170 652c 206f  n zip(z.shape, o
+0001e430: 6c64 5f63 6875 6e6b 732c 2069 6e64 6578  ld_chunks, index
+0001e440: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+0001e450: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+0001e460: 3d20 6172 722e 7265 6368 756e 6b28 6368  = arr.rechunk(ch
+0001e470: 756e 6b73 290a 2020 2020 2020 2020 2020  unks).          
+0001e480: 2020 7265 6769 6f6e 7320 3d20 5b72 6567    regions = [reg
+0001e490: 696f 6e5d 0a20 2020 2020 2020 2072 6574  ion].        ret
+0001e4a0: 7572 6e20 6172 722e 7374 6f72 6528 0a20  urn arr.store(. 
+0001e4b0: 2020 2020 2020 2020 2020 207a 2c20 6c6f             z, lo
+0001e4c0: 636b 3d46 616c 7365 2c20 7265 6769 6f6e  ck=False, region
+0001e4d0: 733d 7265 6769 6f6e 732c 2063 6f6d 7075  s=regions, compu
+0001e4e0: 7465 3d63 6f6d 7075 7465 2c20 7265 7475  te=compute, retu
+0001e4f0: 726e 5f73 746f 7265 643d 7265 7475 726e  rn_stored=return
+0001e500: 5f73 746f 7265 640a 2020 2020 2020 2020  _stored.        
+0001e510: 290a 0a20 2020 2069 6620 7265 6769 6f6e  )..    if region
+0001e520: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0001e530: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001e540: 6545 7272 6f72 2822 4361 6e6e 6f74 2075  eError("Cannot u
+0001e550: 7365 2060 7265 6769 6f6e 6020 6b65 7977  se `region` keyw
+0001e560: 6f72 6420 7768 656e 2075 726c 2069 7320  ord when url is 
+0001e570: 6e6f 7420 6120 607a 6172 722e 4172 7261  not a `zarr.Arra
+0001e580: 7960 2e22 290a 0a20 2020 2069 6620 6e6f  y`.")..    if no
+0001e590: 7420 5f63 6865 636b 5f72 6567 756c 6172  t _check_regular
+0001e5a0: 5f63 6875 6e6b 7328 6172 722e 6368 756e  _chunks(arr.chun
+0001e5b0: 6b73 293a 0a20 2020 2020 2020 2072 6169  ks):.        rai
+0001e5c0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0001e5d0: 2020 2020 2020 2020 2020 2022 4174 7465             "Atte
+0001e5e0: 6d70 7420 746f 2073 6176 6520 6172 7261  mpt to save arra
+0001e5f0: 7920 746f 207a 6172 7220 7769 7468 2069  y to zarr with i
+0001e600: 7272 6567 756c 6172 2022 0a20 2020 2020  rregular ".     
+0001e610: 2020 2020 2020 2022 6368 756e 6b69 6e67         "chunking
+0001e620: 2c20 706c 6561 7365 2063 616c 6c20 6061  , please call `a
+0001e630: 7272 2e72 6563 6875 6e6b 282e 2e2e 2960  rr.rechunk(...)`
+0001e640: 2066 6972 7374 2e22 0a20 2020 2020 2020   first.".       
+0001e650: 2029 0a0a 2020 2020 7374 6f72 6167 655f   )..    storage_
+0001e660: 6f70 7469 6f6e 7320 3d20 7374 6f72 6167  options = storag
+0001e670: 655f 6f70 7469 6f6e 7320 6f72 207b 7d0a  e_options or {}.
+0001e680: 0a20 2020 2069 6620 7374 6f72 6167 655f  .    if storage_
+0001e690: 6f70 7469 6f6e 733a 0a20 2020 2020 2020  options:.       
+0001e6a0: 2073 746f 7265 203d 207a 6172 722e 7374   store = zarr.st
+0001e6b0: 6f72 6167 652e 4653 5374 6f72 6528 7572  orage.FSStore(ur
+0001e6c0: 6c2c 202a 2a73 746f 7261 6765 5f6f 7074  l, **storage_opt
+0001e6d0: 696f 6e73 290a 2020 2020 656c 7365 3a0a  ions).    else:.
+0001e6e0: 2020 2020 2020 2020 7374 6f72 6520 3d20          store = 
+0001e6f0: 7572 6c0a 0a20 2020 2063 6875 6e6b 7320  url..    chunks 
+0001e700: 3d20 5b63 5b30 5d20 666f 7220 6320 696e  = [c[0] for c in
+0001e710: 2061 7272 2e63 6875 6e6b 735d 0a0a 2020   arr.chunks]..  
+0001e720: 2020 7a20 3d20 7a61 7272 2e63 7265 6174    z = zarr.creat
+0001e730: 6528 0a20 2020 2020 2020 2073 6861 7065  e(.        shape
+0001e740: 3d61 7272 2e73 6861 7065 2c0a 2020 2020  =arr.shape,.    
+0001e750: 2020 2020 6368 756e 6b73 3d63 6875 6e6b      chunks=chunk
+0001e760: 732c 0a20 2020 2020 2020 2064 7479 7065  s,.        dtype
+0001e770: 3d61 7272 2e64 7479 7065 2c0a 2020 2020  =arr.dtype,.    
+0001e780: 2020 2020 7374 6f72 653d 7374 6f72 652c      store=store,
+0001e790: 0a20 2020 2020 2020 2070 6174 683d 636f  .        path=co
+0001e7a0: 6d70 6f6e 656e 742c 0a20 2020 2020 2020  mponent,.       
+0001e7b0: 206f 7665 7277 7269 7465 3d6f 7665 7277   overwrite=overw
+0001e7c0: 7269 7465 2c0a 2020 2020 2020 2020 2a2a  rite,.        **
+0001e7d0: 6b77 6172 6773 2c0a 2020 2020 290a 2020  kwargs,.    ).  
+0001e7e0: 2020 7265 7475 726e 2061 7272 2e73 746f    return arr.sto
+0001e7f0: 7265 287a 2c20 6c6f 636b 3d46 616c 7365  re(z, lock=False
+0001e800: 2c20 636f 6d70 7574 653d 636f 6d70 7574  , compute=comput
+0001e810: 652c 2072 6574 7572 6e5f 7374 6f72 6564  e, return_stored
+0001e820: 3d72 6574 7572 6e5f 7374 6f72 6564 290a  =return_stored).
+0001e830: 0a0a 6465 6620 5f63 6865 636b 5f72 6567  ..def _check_reg
+0001e840: 756c 6172 5f63 6875 6e6b 7328 6368 756e  ular_chunks(chun
+0001e850: 6b73 6574 293a 0a20 2020 2022 2222 4368  kset):.    """Ch
+0001e860: 6563 6b20 6966 2074 6865 2063 6875 6e6b  eck if the chunk
+0001e870: 7320 6172 6520 7265 6775 6c61 720a 0a20  s are regular.. 
+0001e880: 2020 2022 5265 6775 6c61 7222 2069 6e20     "Regular" in 
+0001e890: 7468 6973 2063 6f6e 7465 7874 206d 6561  this context mea
+0001e8a0: 6e73 2074 6861 7420 616c 6f6e 6720 6576  ns that along ev
+0001e8b0: 6572 7920 6178 6973 2c20 7468 6520 6368  ery axis, the ch
+0001e8c0: 756e 6b73 2061 6c6c 0a20 2020 2068 6176  unks all.    hav
+0001e8d0: 6520 7468 6520 7361 6d65 2073 697a 652c  e the same size,
+0001e8e0: 2065 7863 6570 7420 7468 6520 6c61 7374   except the last
+0001e8f0: 206f 6e65 2c20 7768 6963 6820 6d61 7920   one, which may 
+0001e900: 6265 2073 6d61 6c6c 6572 0a0a 2020 2020  be smaller..    
+0001e910: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+0001e920: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6368  ---------.    ch
+0001e930: 756e 6b73 6574 3a20 7475 706c 6520 6f66  unkset: tuple of
+0001e940: 2074 7570 6c65 7320 6f66 2069 6e74 730a   tuples of ints.
+0001e950: 2020 2020 2020 2020 4672 6f6d 2074 6865          From the
+0001e960: 2060 602e 6368 756e 6b73 6060 2061 7474   ``.chunks`` att
+0001e970: 7269 6275 7465 206f 6620 616e 2060 6041  ribute of an ``A
+0001e980: 7272 6179 6060 0a0a 2020 2020 5265 7475  rray``..    Retu
+0001e990: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+0001e9a0: 2020 2020 5472 7565 2069 6620 6368 756e      True if chun
+0001e9b0: 6b73 6574 2070 6173 7365 732c 2065 6c73  kset passes, els
+0001e9c0: 6520 4661 6c73 650a 0a20 2020 2045 7861  e False..    Exa
+0001e9d0: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+0001e9e0: 2d2d 0a20 2020 203e 3e3e 2069 6d70 6f72  --.    >>> impor
+0001e9f0: 7420 6461 736b 2e61 7272 6179 2061 7320  t dask.array as 
+0001ea00: 6461 0a20 2020 203e 3e3e 2061 7272 203d  da.    >>> arr =
+0001ea10: 2064 612e 7a65 726f 7328 3130 2c20 6368   da.zeros(10, ch
+0001ea20: 756e 6b73 3d28 352c 2029 290a 2020 2020  unks=(5, )).    
+0001ea30: 3e3e 3e20 5f63 6865 636b 5f72 6567 756c  >>> _check_regul
+0001ea40: 6172 5f63 6875 6e6b 7328 6172 722e 6368  ar_chunks(arr.ch
+0001ea50: 756e 6b73 290a 2020 2020 5472 7565 0a0a  unks).    True..
+0001ea60: 2020 2020 3e3e 3e20 6172 7220 3d20 6461      >>> arr = da
+0001ea70: 2e7a 6572 6f73 2831 302c 2063 6875 6e6b  .zeros(10, chunk
+0001ea80: 733d 2828 332c 2033 2c20 332c 2031 292c  s=((3, 3, 3, 1),
+0001ea90: 2029 290a 2020 2020 3e3e 3e20 5f63 6865   )).    >>> _che
+0001eaa0: 636b 5f72 6567 756c 6172 5f63 6875 6e6b  ck_regular_chunk
+0001eab0: 7328 6172 722e 6368 756e 6b73 290a 2020  s(arr.chunks).  
+0001eac0: 2020 5472 7565 0a0a 2020 2020 3e3e 3e20    True..    >>> 
+0001ead0: 6172 7220 3d20 6461 2e7a 6572 6f73 2831  arr = da.zeros(1
+0001eae0: 302c 2063 6875 6e6b 733d 2828 332c 2031  0, chunks=((3, 1
+0001eaf0: 2c20 332c 2033 292c 2029 290a 2020 2020  , 3, 3), )).    
+0001eb00: 3e3e 3e20 5f63 6865 636b 5f72 6567 756c  >>> _check_regul
+0001eb10: 6172 5f63 6875 6e6b 7328 6172 722e 6368  ar_chunks(arr.ch
+0001eb20: 756e 6b73 290a 2020 2020 4661 6c73 650a  unks).    False.
+0001eb30: 2020 2020 2222 220a 2020 2020 666f 7220      """.    for 
+0001eb40: 6368 756e 6b73 2069 6e20 6368 756e 6b73  chunks in chunks
+0001eb50: 6574 3a0a 2020 2020 2020 2020 6966 206c  et:.        if l
+0001eb60: 656e 2863 6875 6e6b 7329 203d 3d20 313a  en(chunks) == 1:
+0001eb70: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0001eb80: 7469 6e75 650a 2020 2020 2020 2020 6966  tinue.        if
+0001eb90: 206c 656e 2873 6574 2863 6875 6e6b 735b   len(set(chunks[
+0001eba0: 3a2d 315d 2929 203e 2031 3a0a 2020 2020  :-1])) > 1:.    
+0001ebb0: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0001ebc0: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
+0001ebd0: 6368 756e 6b73 5b2d 315d 203e 2063 6875  chunks[-1] > chu
+0001ebe0: 6e6b 735b 305d 3a0a 2020 2020 2020 2020  nks[0]:.        
+0001ebf0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0001ec00: 0a20 2020 2072 6574 7572 6e20 5472 7565  .    return True
+0001ec10: 0a0a 0a64 6566 2066 726f 6d5f 6465 6c61  ...def from_dela
+0001ec20: 7965 6428 7661 6c75 652c 2073 6861 7065  yed(value, shape
+0001ec30: 2c20 6474 7970 653d 4e6f 6e65 2c20 6d65  , dtype=None, me
+0001ec40: 7461 3d4e 6f6e 652c 206e 616d 653d 4e6f  ta=None, name=No
+0001ec50: 6e65 293a 0a20 2020 2022 2222 4372 6561  ne):.    """Crea
+0001ec60: 7465 2061 2064 6173 6b20 6172 7261 7920  te a dask array 
+0001ec70: 6672 6f6d 2061 2064 6173 6b20 6465 6c61  from a dask dela
+0001ec80: 7965 6420 7661 6c75 650a 0a20 2020 2054  yed value..    T
+0001ec90: 6869 7320 726f 7574 696e 6520 6973 2075  his routine is u
+0001eca0: 7365 6675 6c20 666f 7220 636f 6e73 7472  seful for constr
+0001ecb0: 7563 7469 6e67 2064 6173 6b20 6172 7261  ucting dask arra
+0001ecc0: 7973 2069 6e20 616e 2061 642d 686f 6320  ys in an ad-hoc 
+0001ecd0: 6661 7368 696f 6e0a 2020 2020 7573 696e  fashion.    usin
+0001ece0: 6720 6461 736b 2064 656c 6179 6564 2c20  g dask delayed, 
+0001ecf0: 7061 7274 6963 756c 6172 6c79 2077 6865  particularly whe
+0001ed00: 6e20 636f 6d62 696e 6564 2077 6974 6820  n combined with 
+0001ed10: 7374 6163 6b20 616e 6420 636f 6e63 6174  stack and concat
+0001ed20: 656e 6174 652e 0a0a 2020 2020 5468 6520  enate...    The 
+0001ed30: 6461 736b 2061 7272 6179 2077 696c 6c20  dask array will 
+0001ed40: 636f 6e73 6973 7420 6f66 2061 2073 696e  consist of a sin
+0001ed50: 676c 6520 6368 756e 6b2e 0a0a 2020 2020  gle chunk...    
+0001ed60: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
+0001ed70: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 696d  -----.    >>> im
+0001ed80: 706f 7274 2064 6173 6b0a 2020 2020 3e3e  port dask.    >>
+0001ed90: 3e20 696d 706f 7274 2064 6173 6b2e 6172  > import dask.ar
+0001eda0: 7261 7920 6173 2064 610a 2020 2020 3e3e  ray as da.    >>
+0001edb0: 3e20 696d 706f 7274 206e 756d 7079 2061  > import numpy a
+0001edc0: 7320 6e70 0a20 2020 203e 3e3e 2076 616c  s np.    >>> val
+0001edd0: 7565 203d 2064 6173 6b2e 6465 6c61 7965  ue = dask.delaye
+0001ede0: 6428 6e70 2e6f 6e65 7329 2835 290a 2020  d(np.ones)(5).  
+0001edf0: 2020 3e3e 3e20 6172 7261 7920 3d20 6461    >>> array = da
+0001ee00: 2e66 726f 6d5f 6465 6c61 7965 6428 7661  .from_delayed(va
+0001ee10: 6c75 652c 2028 352c 292c 2064 7479 7065  lue, (5,), dtype
+0001ee20: 3d66 6c6f 6174 290a 2020 2020 3e3e 3e20  =float).    >>> 
+0001ee30: 6172 7261 790a 2020 2020 6461 736b 2e61  array.    dask.a
+0001ee40: 7272 6179 3c66 726f 6d2d 7661 6c75 652c  rray<from-value,
+0001ee50: 2073 6861 7065 3d28 352c 292c 2064 7479   shape=(5,), dty
+0001ee60: 7065 3d66 6c6f 6174 3634 2c20 6368 756e  pe=float64, chun
+0001ee70: 6b73 697a 653d 2835 2c29 2c20 6368 756e  ksize=(5,), chun
+0001ee80: 6b74 7970 653d 6e75 6d70 792e 6e64 6172  ktype=numpy.ndar
+0001ee90: 7261 793e 0a20 2020 203e 3e3e 2061 7272  ray>.    >>> arr
+0001eea0: 6179 2e63 6f6d 7075 7465 2829 0a20 2020  ay.compute().   
+0001eeb0: 2061 7272 6179 285b 312e 2c20 312e 2c20   array([1., 1., 
+0001eec0: 312e 2c20 312e 2c20 312e 5d29 0a20 2020  1., 1., 1.]).   
+0001eed0: 2022 2222 0a20 2020 2066 726f 6d20 6461   """.    from da
+0001eee0: 736b 2e64 656c 6179 6564 2069 6d70 6f72  sk.delayed impor
+0001eef0: 7420 4465 6c61 7965 642c 2064 656c 6179  t Delayed, delay
+0001ef00: 6564 0a0a 2020 2020 6966 206e 6f74 2069  ed..    if not i
+0001ef10: 7369 6e73 7461 6e63 6528 7661 6c75 652c  sinstance(value,
+0001ef20: 2044 656c 6179 6564 2920 616e 6420 6861   Delayed) and ha
+0001ef30: 7361 7474 7228 7661 6c75 652c 2022 6b65  sattr(value, "ke
+0001ef40: 7922 293a 0a20 2020 2020 2020 2076 616c  y"):.        val
+0001ef50: 7565 203d 2064 656c 6179 6564 2876 616c  ue = delayed(val
+0001ef60: 7565 290a 0a20 2020 206e 616d 6520 3d20  ue)..    name = 
+0001ef70: 6e61 6d65 206f 7220 2266 726f 6d2d 7661  name or "from-va
+0001ef80: 6c75 652d 2220 2b20 746f 6b65 6e69 7a65  lue-" + tokenize
+0001ef90: 2876 616c 7565 2c20 7368 6170 652c 2064  (value, shape, d
+0001efa0: 7479 7065 2c20 6d65 7461 290a 2020 2020  type, meta).    
+0001efb0: 6473 6b20 3d20 7b28 6e61 6d65 2c29 202b  dsk = {(name,) +
+0001efc0: 2028 302c 2920 2a20 6c65 6e28 7368 6170   (0,) * len(shap
+0001efd0: 6529 3a20 7661 6c75 652e 6b65 797d 0a20  e): value.key}. 
+0001efe0: 2020 2063 6875 6e6b 7320 3d20 7475 706c     chunks = tupl
+0001eff0: 6528 2864 2c29 2066 6f72 2064 2069 6e20  e((d,) for d in 
+0001f000: 7368 6170 6529 0a20 2020 2023 2054 4f44  shape).    # TOD
+0001f010: 4f3a 2076 616c 7565 2e5f 6b65 7920 6d61  O: value._key ma
+0001f020: 7920 6e6f 7420 6265 2074 6865 206e 616d  y not be the nam
+0001f030: 6520 6f66 2074 6865 206c 6179 6572 2069  e of the layer i
+0001f040: 6e20 7661 6c75 652e 6461 736b 0a20 2020  n value.dask.   
+0001f050: 2023 2054 6869 7320 7368 6f75 6c64 2062   # This should b
+0001f060: 6520 6669 7865 6420 6166 7465 7220 7765  e fixed after we
+0001f070: 2062 7569 6c64 2066 756c 6c20 6578 7072   build full expr
+0001f080: 6573 7369 6f6e 2067 7261 7068 730a 2020  ession graphs.  
+0001f090: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0001f0a0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0001f0b0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+0001f0c0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+0001f0d0: 733d 5b76 616c 7565 5d29 0a20 2020 2072  s=[value]).    r
+0001f0e0: 6574 7572 6e20 4172 7261 7928 6772 6170  eturn Array(grap
+0001f0f0: 682c 206e 616d 652c 2063 6875 6e6b 732c  h, name, chunks,
+0001f100: 2064 7479 7065 3d64 7479 7065 2c20 6d65   dtype=dtype, me
+0001f110: 7461 3d6d 6574 6129 0a0a 0a64 6566 2066  ta=meta)...def f
+0001f120: 726f 6d5f 6675 6e63 2866 756e 632c 2073  rom_func(func, s
+0001f130: 6861 7065 2c20 6474 7970 653d 4e6f 6e65  hape, dtype=None
+0001f140: 2c20 6e61 6d65 3d4e 6f6e 652c 2061 7267  , name=None, arg
+0001f150: 733d 2829 2c20 6b77 6172 6773 3d4e 6f6e  s=(), kwargs=Non
+0001f160: 6529 3a0a 2020 2020 2222 2243 7265 6174  e):.    """Creat
+0001f170: 6520 6461 736b 2061 7272 6179 2069 6e20  e dask array in 
+0001f180: 6120 7369 6e67 6c65 2062 6c6f 636b 2062  a single block b
+0001f190: 7920 6361 6c6c 696e 6720 6120 6675 6e63  y calling a func
+0001f1a0: 7469 6f6e 0a0a 2020 2020 4361 6c6c 696e  tion..    Callin
+0001f1b0: 6720 7468 6520 7072 6f76 6964 6564 2066  g the provided f
+0001f1c0: 756e 6374 696f 6e20 7769 7468 2066 756e  unction with fun
+0001f1d0: 6328 2a61 7267 732c 202a 2a6b 7761 7267  c(*args, **kwarg
+0001f1e0: 7329 2073 686f 756c 6420 7265 7475 726e  s) should return
+0001f1f0: 2061 0a20 2020 204e 756d 5079 2061 7272   a.    NumPy arr
+0001f200: 6179 206f 6620 7468 6520 696e 6469 6361  ay of the indica
+0001f210: 7465 6420 7368 6170 6520 616e 6420 6474  ted shape and dt
+0001f220: 7970 652e 0a0a 2020 2020 4578 616d 706c  ype...    Exampl
+0001f230: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+0001f240: 0a20 2020 203e 3e3e 2061 203d 2066 726f  .    >>> a = fro
+0001f250: 6d5f 6675 6e63 286e 702e 6172 616e 6765  m_func(np.arange
+0001f260: 2c20 2833 2c29 2c20 6474 7970 653d 2769  , (3,), dtype='i
+0001f270: 3827 2c20 6172 6773 3d28 332c 2929 0a20  8', args=(3,)). 
+0001f280: 2020 203e 3e3e 2061 2e63 6f6d 7075 7465     >>> a.compute
+0001f290: 2829 0a20 2020 2061 7272 6179 285b 302c  ().    array([0,
+0001f2a0: 2031 2c20 325d 290a 0a20 2020 2054 6869   1, 2])..    Thi
+0001f2b0: 7320 776f 726b 7320 7061 7274 6963 756c  s works particul
+0001f2c0: 6172 6c79 2077 656c 6c20 7768 656e 2063  arly well when c
+0001f2d0: 6f75 706c 6564 2077 6974 6820 6461 736b  oupled with dask
+0001f2e0: 2e61 7272 6179 2066 756e 6374 696f 6e73  .array functions
+0001f2f0: 206c 696b 650a 2020 2020 636f 6e63 6174   like.    concat
+0001f300: 656e 6174 6520 616e 6420 7374 6163 6b3a  enate and stack:
+0001f310: 0a0a 2020 2020 3e3e 3e20 6172 7261 7973  ..    >>> arrays
+0001f320: 203d 205b 6672 6f6d 5f66 756e 6328 6e70   = [from_func(np
+0001f330: 2e61 7272 6179 2c20 2829 2c20 6474 7970  .array, (), dtyp
+0001f340: 653d 2769 3827 2c20 6172 6773 3d28 6e2c  e='i8', args=(n,
+0001f350: 2929 2066 6f72 206e 2069 6e20 7261 6e67  )) for n in rang
+0001f360: 6528 3529 5d0a 2020 2020 3e3e 3e20 7374  e(5)].    >>> st
+0001f370: 6163 6b28 6172 7261 7973 292e 636f 6d70  ack(arrays).comp
+0001f380: 7574 6528 290a 2020 2020 6172 7261 7928  ute().    array(
+0001f390: 5b30 2c20 312c 2032 2c20 332c 2034 5d29  [0, 1, 2, 3, 4])
+0001f3a0: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+0001f3b0: 6b77 6172 6773 2069 7320 4e6f 6e65 3a0a  kwargs is None:.
+0001f3c0: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
+0001f3d0: 207b 7d0a 0a20 2020 206e 616d 6520 3d20   {}..    name = 
+0001f3e0: 6e61 6d65 206f 7220 2266 726f 6d5f 6675  name or "from_fu
+0001f3f0: 6e63 2d22 202b 2074 6f6b 656e 697a 6528  nc-" + tokenize(
+0001f400: 6675 6e63 2c20 7368 6170 652c 2064 7479  func, shape, dty
+0001f410: 7065 2c20 6172 6773 2c20 6b77 6172 6773  pe, args, kwargs
+0001f420: 290a 2020 2020 6966 2061 7267 7320 6f72  ).    if args or
+0001f430: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
+0001f440: 2066 756e 6320 3d20 7061 7274 6961 6c28   func = partial(
+0001f450: 6675 6e63 2c20 2a61 7267 732c 202a 2a6b  func, *args, **k
+0001f460: 7761 7267 7329 0a20 2020 2064 736b 203d  wargs).    dsk =
+0001f470: 207b 286e 616d 652c 2920 2b20 2830 2c29   {(name,) + (0,)
+0001f480: 202a 206c 656e 2873 6861 7065 293a 2028   * len(shape): (
+0001f490: 6675 6e63 2c29 7d0a 2020 2020 6368 756e  func,)}.    chun
+0001f4a0: 6b73 203d 2074 7570 6c65 2828 692c 2920  ks = tuple((i,) 
+0001f4b0: 666f 7220 6920 696e 2073 6861 7065 290a  for i in shape).
+0001f4c0: 2020 2020 7265 7475 726e 2041 7272 6179      return Array
+0001f4d0: 2864 736b 2c20 6e61 6d65 2c20 6368 756e  (dsk, name, chun
+0001f4e0: 6b73 2c20 6474 7970 6529 0a0a 0a64 6566  ks, dtype)...def
+0001f4f0: 2063 6f6d 6d6f 6e5f 626c 6f63 6b64 696d   common_blockdim
+0001f500: 2862 6c6f 636b 6469 6d73 293a 0a20 2020  (blockdims):.   
+0001f510: 2022 2222 4669 6e64 2074 6865 2063 6f6d   """Find the com
+0001f520: 6d6f 6e20 626c 6f63 6b20 6469 6d65 6e73  mon block dimens
+0001f530: 696f 6e73 2066 726f 6d20 7468 6520 6c69  ions from the li
+0001f540: 7374 206f 6620 626c 6f63 6b20 6469 6d65  st of block dime
+0001f550: 6e73 696f 6e73 0a0a 2020 2020 4375 7272  nsions..    Curr
+0001f560: 656e 746c 7920 6f6e 6c79 2069 6d70 6c65  ently only imple
+0001f570: 6d65 6e74 7320 7468 6520 7369 6d70 6c65  ments the simple
+0001f580: 7374 2070 6f73 7369 626c 6520 6865 7572  st possible heur
+0001f590: 6973 7469 633a 2074 6865 2063 6f6d 6d6f  istic: the commo
+0001f5a0: 6e0a 2020 2020 626c 6f63 6b2d 6469 6d65  n.    block-dime
+0001f5b0: 6e73 696f 6e20 6973 2074 6865 206f 6e6c  nsion is the onl
+0001f5c0: 7920 6f6e 6520 7468 6174 2064 6f65 7320  y one that does 
+0001f5d0: 6e6f 7420 7370 616e 2066 756c 6c79 2073  not span fully s
+0001f5e0: 7061 6e20 6120 6469 6d65 6e73 696f 6e2e  pan a dimension.
+0001f5f0: 0a20 2020 2054 6869 7320 6973 2061 2063  .    This is a c
+0001f600: 6f6e 7365 7276 6174 6976 6520 6368 6f69  onservative choi
+0001f610: 6365 2074 6861 7420 616c 6c6f 7773 2075  ce that allows u
+0001f620: 7320 746f 2061 766f 6964 2070 6f74 656e  s to avoid poten
+0001f630: 7469 616c 6c79 2076 6572 790a 2020 2020  tially very.    
+0001f640: 6578 7065 6e73 6976 6520 7265 6368 756e  expensive rechun
+0001f650: 6b69 6e67 2e0a 0a20 2020 2041 7373 756d  king...    Assum
+0001f660: 6573 2074 6861 7420 6561 6368 2065 6c65  es that each ele
+0001f670: 6d65 6e74 206f 6620 7468 6520 696e 7075  ment of the inpu
+0001f680: 7420 626c 6f63 6b20 6469 6d65 6e73 696f  t block dimensio
+0001f690: 6e73 2068 6173 2061 6c6c 2074 6865 2073  ns has all the s
+0001f6a0: 616d 650a 2020 2020 7375 6d20 2869 2e65  ame.    sum (i.e
+0001f6b0: 2e2c 2074 6861 7420 7468 6579 2063 6f72  ., that they cor
+0001f6c0: 7265 7370 6f6e 6420 746f 2064 696d 656e  respond to dimen
+0001f6d0: 7369 6f6e 7320 6f66 2074 6865 2073 616d  sions of the sam
+0001f6e0: 6520 7369 7a65 292e 0a0a 2020 2020 4578  e size)...    Ex
+0001f6f0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+0001f700: 2d2d 2d0a 2020 2020 3e3e 3e20 636f 6d6d  ---.    >>> comm
+0001f710: 6f6e 5f62 6c6f 636b 6469 6d28 5b28 332c  on_blockdim([(3,
+0001f720: 292c 2028 322c 2031 295d 290a 2020 2020  ), (2, 1)]).    
+0001f730: 2832 2c20 3129 0a20 2020 203e 3e3e 2063  (2, 1).    >>> c
+0001f740: 6f6d 6d6f 6e5f 626c 6f63 6b64 696d 285b  ommon_blockdim([
+0001f750: 2831 2c20 3229 2c20 2832 2c20 3129 5d29  (1, 2), (2, 1)])
+0001f760: 0a20 2020 2028 312c 2031 2c20 3129 0a20  .    (1, 1, 1). 
+0001f770: 2020 203e 3e3e 2063 6f6d 6d6f 6e5f 626c     >>> common_bl
+0001f780: 6f63 6b64 696d 285b 2832 2c20 3229 2c20  ockdim([(2, 2), 
+0001f790: 2833 2c20 3129 5d29 2020 2320 646f 6374  (3, 1)])  # doct
+0001f7a0: 6573 743a 202b 534b 4950 0a20 2020 2054  est: +SKIP.    T
+0001f7b0: 7261 6365 6261 636b 2028 6d6f 7374 2072  raceback (most r
+0001f7c0: 6563 656e 7420 6361 6c6c 206c 6173 7429  ecent call last)
+0001f7d0: 3a0a 2020 2020 2020 2020 2e2e 2e0a 2020  :.        ....  
+0001f7e0: 2020 5661 6c75 6545 7272 6f72 3a20 4368    ValueError: Ch
+0001f7f0: 756e 6b73 2064 6f20 6e6f 7420 616c 6967  unks do not alig
+0001f800: 6e0a 2020 2020 2222 220a 2020 2020 6966  n.    """.    if
+0001f810: 206e 6f74 2061 6e79 2862 6c6f 636b 6469   not any(blockdi
+0001f820: 6d73 293a 0a20 2020 2020 2020 2072 6574  ms):.        ret
+0001f830: 7572 6e20 2829 0a20 2020 206e 6f6e 5f74  urn ().    non_t
+0001f840: 7269 7669 616c 5f64 696d 7320 3d20 7b64  rivial_dims = {d
+0001f850: 2066 6f72 2064 2069 6e20 626c 6f63 6b64   for d in blockd
+0001f860: 696d 7320 6966 206c 656e 2864 2920 3e20  ims if len(d) > 
+0001f870: 317d 0a20 2020 2069 6620 6c65 6e28 6e6f  1}.    if len(no
+0001f880: 6e5f 7472 6976 6961 6c5f 6469 6d73 2920  n_trivial_dims) 
+0001f890: 3d3d 2031 3a0a 2020 2020 2020 2020 7265  == 1:.        re
+0001f8a0: 7475 726e 2066 6972 7374 286e 6f6e 5f74  turn first(non_t
+0001f8b0: 7269 7669 616c 5f64 696d 7329 0a20 2020  rivial_dims).   
+0001f8c0: 2069 6620 6c65 6e28 6e6f 6e5f 7472 6976   if len(non_triv
+0001f8d0: 6961 6c5f 6469 6d73 2920 3d3d 2030 3a0a  ial_dims) == 0:.
+0001f8e0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0001f8f0: 6178 2862 6c6f 636b 6469 6d73 2c20 6b65  ax(blockdims, ke
+0001f900: 793d 6669 7273 7429 0a0a 2020 2020 6966  y=first)..    if
+0001f910: 206e 702e 6973 6e61 6e28 7375 6d28 6d61   np.isnan(sum(ma
+0001f920: 7028 7375 6d2c 2062 6c6f 636b 6469 6d73  p(sum, blockdims
+0001f930: 2929 293a 0a20 2020 2020 2020 2072 6169  ))):.        rai
+0001f940: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0001f950: 2020 2020 2020 2020 2020 2022 4172 7261             "Arra
+0001f960: 7973 2720 6368 756e 6b20 7369 7a65 7320  ys' chunk sizes 
+0001f970: 2825 7329 2061 7265 2075 6e6b 6e6f 776e  (%s) are unknown
+0001f980: 2e5c 6e5c 6e22 0a20 2020 2020 2020 2020  .\n\n".         
+0001f990: 2020 2022 4120 706f 7373 6962 6c65 2073     "A possible s
+0001f9a0: 6f6c 7574 696f 6e3a 5c6e 220a 2020 2020  olution:\n".    
+0001f9b0: 2020 2020 2020 2020 2220 2078 2e63 6f6d          "  x.com
+0001f9c0: 7075 7465 5f63 6875 6e6b 5f73 697a 6573  pute_chunk_sizes
+0001f9d0: 2829 2220 2520 626c 6f63 6b64 696d 730a  ()" % blockdims.
+0001f9e0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
+0001f9f0: 6620 6c65 6e28 7365 7428 6d61 7028 7375  f len(set(map(su
+0001fa00: 6d2c 206e 6f6e 5f74 7269 7669 616c 5f64  m, non_trivial_d
+0001fa10: 696d 7329 2929 203e 2031 3a0a 2020 2020  ims))) > 1:.    
+0001fa20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001fa30: 7272 6f72 2822 4368 756e 6b73 2064 6f20  rror("Chunks do 
+0001fa40: 6e6f 7420 6164 6420 7570 2074 6f20 7361  not add up to sa
+0001fa50: 6d65 2076 616c 7565 222c 2062 6c6f 636b  me value", block
+0001fa60: 6469 6d73 290a 0a20 2020 2023 2057 6520  dims)..    # We 
+0001fa70: 6861 7665 206d 756c 7469 706c 6520 6e6f  have multiple no
+0001fa80: 6e2d 7472 6976 6961 6c20 6368 756e 6b73  n-trivial chunks
+0001fa90: 206f 6e20 7468 6973 2061 7869 730a 2020   on this axis.  
+0001faa0: 2020 2320 652e 672e 2028 352c 2032 2920    # e.g. (5, 2) 
+0001fab0: 616e 6420 2834 2c20 3329 0a0a 2020 2020  and (4, 3)..    
+0001fac0: 2320 5765 2063 7265 6174 6520 6120 7369  # We create a si
+0001fad0: 6e67 6c65 2063 6875 6e6b 2074 7570 6c65  ngle chunk tuple
+0001fae0: 2077 6974 6820 7468 6520 7361 6d65 2074   with the same t
+0001faf0: 6f74 616c 206c 656e 6774 680a 2020 2020  otal length.    
+0001fb00: 2320 7468 6174 2065 7665 6e6c 7920 6469  # that evenly di
+0001fb10: 7669 6465 7320 626f 7468 2c20 652e 672e  vides both, e.g.
+0001fb20: 2028 342c 2031 2c20 3229 0a0a 2020 2020   (4, 1, 2)..    
+0001fb30: 2320 546f 2061 6363 6f6d 706c 6973 6820  # To accomplish 
+0001fb40: 7468 6973 2077 6520 7761 6c6b 2064 6f77  this we walk dow
+0001fb50: 6e20 616c 6c20 6368 756e 6b20 7475 706c  n all chunk tupl
+0001fb60: 6573 2074 6f67 6574 6865 722c 2066 696e  es together, fin
+0001fb70: 6469 6e67 2074 6865 0a20 2020 2023 2073  ding the.    # s
+0001fb80: 6d61 6c6c 6573 7420 656c 656d 656e 742c  mallest element,
+0001fb90: 2061 6464 696e 6720 6974 2074 6f20 7468   adding it to th
+0001fba0: 6520 6f75 7470 7574 2c20 616e 6420 7375  e output, and su
+0001fbb0: 6274 7261 6374 696e 6720 6974 2066 726f  btracting it fro
+0001fbc0: 6d20 616c 6c0a 2020 2020 2320 6f74 6865  m all.    # othe
+0001fbd0: 7220 656c 656d 656e 7473 2061 6e64 2072  r elements and r
+0001fbe0: 656d 6f76 6520 7468 6520 656c 656d 656e  emove the elemen
+0001fbf0: 7420 6974 7365 6c66 2e20 2057 6520 7374  t itself.  We st
+0001fc00: 6f70 206f 6e63 6520 7765 2068 6176 650a  op once we have.
+0001fc10: 2020 2020 2320 6275 726e 6564 2074 6872      # burned thr
+0001fc20: 6f75 6768 2061 6c6c 206f 6620 7468 6520  ough all of the 
+0001fc30: 6368 756e 6b20 7475 706c 6573 2e0a 2020  chunk tuples..  
+0001fc40: 2020 2320 466f 7220 6566 6669 6369 656e    # For efficien
+0001fc50: 6379 2773 2073 616b 6520 7765 2072 6576  cy's sake we rev
+0001fc60: 6572 7365 2074 6865 206c 6973 7473 2073  erse the lists s
+0001fc70: 6f20 7468 6174 2077 6520 6361 6e20 706f  o that we can po
+0001fc80: 7020 6f66 6620 7468 6520 656e 640a 2020  p off the end.  
+0001fc90: 2020 7263 6875 6e6b 7320 3d20 5b6c 6973    rchunks = [lis
+0001fca0: 7428 6e74 6429 5b3a 3a2d 315d 2066 6f72  t(ntd)[::-1] for
+0001fcb0: 206e 7464 2069 6e20 6e6f 6e5f 7472 6976   ntd in non_triv
+0001fcc0: 6961 6c5f 6469 6d73 5d0a 2020 2020 746f  ial_dims].    to
+0001fcd0: 7461 6c20 3d20 7375 6d28 6669 7273 7428  tal = sum(first(
+0001fce0: 6e6f 6e5f 7472 6976 6961 6c5f 6469 6d73  non_trivial_dims
+0001fcf0: 2929 0a20 2020 2069 203d 2030 0a0a 2020  )).    i = 0..  
+0001fd00: 2020 6f75 7420 3d20 5b5d 0a20 2020 2077    out = [].    w
+0001fd10: 6869 6c65 2069 203c 2074 6f74 616c 3a0a  hile i < total:.
+0001fd20: 2020 2020 2020 2020 6d20 3d20 6d69 6e28          m = min(
+0001fd30: 635b 2d31 5d20 666f 7220 6320 696e 2072  c[-1] for c in r
+0001fd40: 6368 756e 6b73 290a 2020 2020 2020 2020  chunks).        
+0001fd50: 6f75 742e 6170 7065 6e64 286d 290a 2020  out.append(m).  
+0001fd60: 2020 2020 2020 666f 7220 6320 696e 2072        for c in r
+0001fd70: 6368 756e 6b73 3a0a 2020 2020 2020 2020  chunks:.        
+0001fd80: 2020 2020 635b 2d31 5d20 2d3d 206d 0a20      c[-1] -= m. 
+0001fd90: 2020 2020 2020 2020 2020 2069 6620 635b             if c[
+0001fda0: 2d31 5d20 3d3d 2030 3a0a 2020 2020 2020  -1] == 0:.      
+0001fdb0: 2020 2020 2020 2020 2020 632e 706f 7028            c.pop(
+0001fdc0: 290a 2020 2020 2020 2020 6920 2b3d 206d  ).        i += m
+0001fdd0: 0a0a 2020 2020 7265 7475 726e 2074 7570  ..    return tup
+0001fde0: 6c65 286f 7574 290a 0a0a 6465 6620 756e  le(out)...def un
+0001fdf0: 6966 795f 6368 756e 6b73 282a 6172 6773  ify_chunks(*args
+0001fe00: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+0001fe10: 2022 2222 0a20 2020 2055 6e69 6679 2063   """.    Unify c
+0001fe20: 6875 6e6b 7320 6163 726f 7373 2061 2073  hunks across a s
+0001fe30: 6571 7565 6e63 6520 6f66 2061 7272 6179  equence of array
+0001fe40: 730a 0a20 2020 2054 6869 7320 7574 696c  s..    This util
+0001fe50: 6974 7920 6675 6e63 7469 6f6e 2069 7320  ity function is 
+0001fe60: 7573 6564 2077 6974 6869 6e20 6f74 6865  used within othe
+0001fe70: 7220 636f 6d6d 6f6e 206f 7065 7261 7469  r common operati
+0001fe80: 6f6e 7320 6c69 6b65 0a20 2020 203a 6675  ons like.    :fu
+0001fe90: 6e63 3a60 6461 736b 2e61 7272 6179 2e63  nc:`dask.array.c
+0001fea0: 6f72 652e 6d61 705f 626c 6f63 6b73 6020  ore.map_blocks` 
+0001feb0: 616e 6420 3a66 756e 633a 6064 6173 6b2e  and :func:`dask.
+0001fec0: 6172 7261 792e 636f 7265 2e62 6c6f 636b  array.core.block
+0001fed0: 7769 7365 602e 0a20 2020 2049 7420 6973  wise`..    It is
+0001fee0: 206e 6f74 2063 6f6d 6d6f 6e6c 7920 7573   not commonly us
+0001fef0: 6564 2062 7920 656e 642d 7573 6572 7320  ed by end-users 
+0001ff00: 6469 7265 6374 6c79 2e0a 0a20 2020 2050  directly...    P
+0001ff10: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+0001ff20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 202a 6172  --------.    *ar
+0001ff30: 6773 3a20 7365 7175 656e 6365 206f 6620  gs: sequence of 
+0001ff40: 4172 7261 792c 2069 6e64 6578 2070 6169  Array, index pai
+0001ff50: 7273 0a20 2020 2020 2020 2053 6571 7565  rs.        Seque
+0001ff60: 6e63 6520 6c69 6b65 2028 782c 2027 696a  nce like (x, 'ij
+0001ff70: 272c 2079 2c20 276a 6b27 2c20 7a2c 2027  ', y, 'jk', z, '
+0001ff80: 6927 290a 0a20 2020 2045 7861 6d70 6c65  i')..    Example
+0001ff90: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+0001ffa0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0001ffb0: 736b 2e61 7272 6179 2061 7320 6461 0a20  sk.array as da. 
+0001ffc0: 2020 203e 3e3e 2078 203d 2064 612e 6f6e     >>> x = da.on
+0001ffd0: 6573 2831 302c 2063 6875 6e6b 733d 2828  es(10, chunks=((
+0001ffe0: 352c 2032 2c20 3329 2c29 290a 2020 2020  5, 2, 3),)).    
+0001fff0: 3e3e 3e20 7920 3d20 6461 2e6f 6e65 7328  >>> y = da.ones(
+00020000: 3130 2c20 6368 756e 6b73 3d28 2832 2c20  10, chunks=((2, 
+00020010: 332c 2035 292c 2929 0a20 2020 203e 3e3e  3, 5),)).    >>>
+00020020: 2063 6875 6e6b 7373 2c20 6172 7261 7973   chunkss, arrays
+00020030: 203d 2075 6e69 6679 5f63 6875 6e6b 7328   = unify_chunks(
+00020040: 782c 2027 6927 2c20 792c 2027 6927 290a  x, 'i', y, 'i').
+00020050: 2020 2020 3e3e 3e20 6368 756e 6b73 730a      >>> chunkss.
+00020060: 2020 2020 7b27 6927 3a20 2832 2c20 332c      {'i': (2, 3,
+00020070: 2032 2c20 3329 7d0a 0a20 2020 203e 3e3e   2, 3)}..    >>>
+00020080: 2078 203d 2064 612e 6f6e 6573 2828 3130   x = da.ones((10
+00020090: 302c 2031 3029 2c20 6368 756e 6b73 3d28  0, 10), chunks=(
+000200a0: 3230 2c20 3529 290a 2020 2020 3e3e 3e20  20, 5)).    >>> 
+000200b0: 7920 3d20 6461 2e6f 6e65 7328 2831 302c  y = da.ones((10,
+000200c0: 2031 3030 292c 2063 6875 6e6b 733d 2834   100), chunks=(4
+000200d0: 2c20 3530 2929 0a20 2020 203e 3e3e 2063  , 50)).    >>> c
+000200e0: 6875 6e6b 7373 2c20 6172 7261 7973 203d  hunkss, arrays =
+000200f0: 2075 6e69 6679 5f63 6875 6e6b 7328 782c   unify_chunks(x,
+00020100: 2027 696a 272c 2079 2c20 276a 6b27 2c20   'ij', y, 'jk', 
+00020110: 2763 6f6e 7374 616e 7427 2c20 4e6f 6e65  'constant', None
+00020120: 290a 2020 2020 3e3e 3e20 6368 756e 6b73  ).    >>> chunks
+00020130: 7320 2023 2064 6f63 7465 7374 3a20 2b53  s  # doctest: +S
+00020140: 4b49 500a 2020 2020 7b27 6b27 3a20 2835  KIP.    {'k': (5
+00020150: 302c 2035 3029 2c20 2769 273a 2028 3230  0, 50), 'i': (20
+00020160: 2c20 3230 2c20 3230 2c20 3230 2c20 3230  , 20, 20, 20, 20
+00020170: 292c 2027 6a27 3a20 2834 2c20 312c 2033  ), 'j': (4, 1, 3
+00020180: 2c20 3229 7d0a 0a20 2020 203e 3e3e 2075  , 2)}..    >>> u
+00020190: 6e69 6679 5f63 6875 6e6b 7328 302c 204e  nify_chunks(0, N
+000201a0: 6f6e 6529 0a20 2020 2028 7b7d 2c20 5b30  one).    ({}, [0
+000201b0: 5d29 0a0a 2020 2020 5265 7475 726e 730a  ])..    Returns.
+000201c0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+000201d0: 6368 756e 6b73 7320 3a20 6469 6374 0a20  chunkss : dict. 
+000201e0: 2020 2020 2020 204d 6170 206c 696b 6520         Map like 
+000201f0: 7b69 6e64 6578 3a20 6368 756e 6b73 7d2e  {index: chunks}.
+00020200: 0a20 2020 2061 7272 6179 7320 3a20 6c69  .    arrays : li
+00020210: 7374 0a20 2020 2020 2020 204c 6973 7420  st.        List 
+00020220: 6f66 2072 6563 6875 6e6b 6564 2061 7272  of rechunked arr
+00020230: 6179 732e 0a0a 2020 2020 5365 6520 416c  ays...    See Al
+00020240: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
+00020250: 2020 2020 636f 6d6d 6f6e 5f62 6c6f 636b      common_block
+00020260: 6469 6d0a 2020 2020 2222 220a 2020 2020  dim.    """.    
+00020270: 6966 206e 6f74 2061 7267 733a 0a20 2020  if not args:.   
+00020280: 2020 2020 2072 6574 7572 6e20 7b7d 2c20       return {}, 
+00020290: 5b5d 0a0a 2020 2020 6172 6769 6e64 7320  []..    arginds 
+000202a0: 3d20 5b0a 2020 2020 2020 2020 2861 7361  = [.        (asa
+000202b0: 6e79 6172 7261 7928 6129 2069 6620 696e  nyarray(a) if in
+000202c0: 6420 6973 206e 6f74 204e 6f6e 6520 656c  d is not None el
+000202d0: 7365 2061 2c20 696e 6429 2066 6f72 2061  se a, ind) for a
+000202e0: 2c20 696e 6420 696e 2070 6172 7469 7469  , ind in partiti
+000202f0: 6f6e 2832 2c20 6172 6773 290a 2020 2020  on(2, args).    
+00020300: 5d20 2023 205b 782c 2069 6a2c 2079 2c20  ]  # [x, ij, y, 
+00020310: 6a6b 5d0a 2020 2020 7761 726e 203d 206b  jk].    warn = k
+00020320: 7761 7267 732e 6765 7428 2277 6172 6e22  wargs.get("warn"
+00020330: 2c20 5472 7565 290a 0a20 2020 2061 7272  , True)..    arr
+00020340: 6179 732c 2069 6e64 7320 3d20 7a69 7028  ays, inds = zip(
+00020350: 2a61 7267 696e 6473 290a 2020 2020 6966  *arginds).    if
+00020360: 2061 6c6c 2869 6e64 2069 7320 4e6f 6e65   all(ind is None
+00020370: 2066 6f72 2069 6e64 2069 6e20 696e 6473   for ind in inds
+00020380: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00020390: 6e20 7b7d 2c20 6c69 7374 2861 7272 6179  n {}, list(array
+000203a0: 7329 0a20 2020 2069 6620 616c 6c28 696e  s).    if all(in
+000203b0: 6420 3d3d 2069 6e64 735b 305d 2066 6f72  d == inds[0] for
+000203c0: 2069 6e64 2069 6e20 696e 6473 2920 616e   ind in inds) an
+000203d0: 6420 616c 6c28 0a20 2020 2020 2020 2061  d all(.        a
+000203e0: 2e63 6875 6e6b 7320 3d3d 2061 7272 6179  .chunks == array
+000203f0: 735b 305d 2e63 6875 6e6b 7320 666f 7220  s[0].chunks for 
+00020400: 6120 696e 2061 7272 6179 730a 2020 2020  a in arrays.    
+00020410: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00020420: 6e20 6469 6374 287a 6970 2869 6e64 735b  n dict(zip(inds[
+00020430: 305d 2c20 6172 7261 7973 5b30 5d2e 6368  0], arrays[0].ch
+00020440: 756e 6b73 2929 2c20 6172 7261 7973 0a0a  unks)), arrays..
+00020450: 2020 2020 6e61 6d65 696e 6473 203d 205b      nameinds = [
+00020460: 5d0a 2020 2020 626c 6f63 6b64 696d 5f64  ].    blockdim_d
+00020470: 6963 7420 3d20 6469 6374 2829 0a20 2020  ict = dict().   
+00020480: 206d 6178 5f70 6172 7473 203d 2030 0a20   max_parts = 0. 
+00020490: 2020 2066 6f72 2061 2c20 696e 6420 696e     for a, ind in
+000204a0: 2061 7267 696e 6473 3a0a 2020 2020 2020   arginds:.      
+000204b0: 2020 6966 2069 6e64 2069 7320 6e6f 7420    if ind is not 
+000204c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000204d0: 2020 6e61 6d65 696e 6473 2e61 7070 656e    nameinds.appen
+000204e0: 6428 2861 2e6e 616d 652c 2069 6e64 2929  d((a.name, ind))
+000204f0: 0a20 2020 2020 2020 2020 2020 2062 6c6f  .            blo
+00020500: 636b 6469 6d5f 6469 6374 5b61 2e6e 616d  ckdim_dict[a.nam
+00020510: 655d 203d 2061 2e63 6875 6e6b 730a 2020  e] = a.chunks.  
+00020520: 2020 2020 2020 2020 2020 6d61 785f 7061            max_pa
+00020530: 7274 7320 3d20 6d61 7828 6d61 785f 7061  rts = max(max_pa
+00020540: 7274 732c 2061 2e6e 7061 7274 6974 696f  rts, a.npartitio
+00020550: 6e73 290a 2020 2020 2020 2020 656c 7365  ns).        else
+00020560: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
+00020570: 6d65 696e 6473 2e61 7070 656e 6428 2861  meinds.append((a
+00020580: 2c20 696e 6429 290a 0a20 2020 2063 6875  , ind))..    chu
+00020590: 6e6b 7373 203d 2062 726f 6164 6361 7374  nkss = broadcast
+000205a0: 5f64 696d 656e 7369 6f6e 7328 6e61 6d65  _dimensions(name
+000205b0: 696e 6473 2c20 626c 6f63 6b64 696d 5f64  inds, blockdim_d
+000205c0: 6963 742c 2063 6f6e 736f 6c69 6461 7465  ict, consolidate
+000205d0: 3d63 6f6d 6d6f 6e5f 626c 6f63 6b64 696d  =common_blockdim
+000205e0: 290a 2020 2020 6e70 6172 7473 203d 206d  ).    nparts = m
+000205f0: 6174 682e 7072 6f64 286d 6170 286c 656e  ath.prod(map(len
+00020600: 2c20 6368 756e 6b73 732e 7661 6c75 6573  , chunkss.values
+00020610: 2829 2929 0a0a 2020 2020 6966 2077 6172  ()))..    if war
+00020620: 6e20 616e 6420 6e70 6172 7473 2061 6e64  n and nparts and
+00020630: 206e 7061 7274 7320 3e3d 206d 6178 5f70   nparts >= max_p
+00020640: 6172 7473 202a 2031 303a 0a20 2020 2020  arts * 10:.     
+00020650: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00020660: 280a 2020 2020 2020 2020 2020 2020 2249  (.            "I
+00020670: 6e63 7265 6173 696e 6720 6e75 6d62 6572  ncreasing number
+00020680: 206f 6620 6368 756e 6b73 2062 7920 6661   of chunks by fa
+00020690: 6374 6f72 206f 6620 2564 2220 2520 286e  ctor of %d" % (n
+000206a0: 7061 7274 7320 2f20 6d61 785f 7061 7274  parts / max_part
+000206b0: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+000206c0: 5065 7266 6f72 6d61 6e63 6557 6172 6e69  PerformanceWarni
+000206d0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+000206e0: 7374 6163 6b6c 6576 656c 3d33 2c0a 2020  stacklevel=3,.  
+000206f0: 2020 2020 2020 290a 0a20 2020 2061 7272        )..    arr
+00020700: 6179 7320 3d20 5b5d 0a20 2020 2066 6f72  ays = [].    for
+00020710: 2061 2c20 6920 696e 2061 7267 696e 6473   a, i in arginds
+00020720: 3a0a 2020 2020 2020 2020 6966 2069 2069  :.        if i i
+00020730: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00020740: 2020 2020 6172 7261 7973 2e61 7070 656e      arrays.appen
+00020750: 6428 6129 0a20 2020 2020 2020 2065 6c73  d(a).        els
+00020760: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+00020770: 6875 6e6b 7320 3d20 7475 706c 6528 0a20  hunks = tuple(. 
+00020780: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00020790: 6875 6e6b 7373 5b6a 5d0a 2020 2020 2020  hunkss[j].      
+000207a0: 2020 2020 2020 2020 2020 6966 2061 2e73            if a.s
+000207b0: 6861 7065 5b6e 5d20 3e20 310a 2020 2020  hape[n] > 1.    
+000207c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000207d0: 2061 2e73 6861 7065 5b6e 5d0a 2020 2020   a.shape[n].    
+000207e0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000207f0: 6f74 206e 702e 6973 6e61 6e28 7375 6d28  ot np.isnan(sum(
+00020800: 6368 756e 6b73 735b 6a5d 2929 0a20 2020  chunkss[j])).   
+00020810: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00020820: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
+00020830: 2020 2020 2020 2066 6f72 206e 2c20 6a20         for n, j 
+00020840: 696e 2065 6e75 6d65 7261 7465 2869 290a  in enumerate(i).
+00020850: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00020860: 2020 2020 2020 2020 2020 6966 2063 6875            if chu
+00020870: 6e6b 7320 213d 2061 2e63 6875 6e6b 7320  nks != a.chunks 
+00020880: 616e 6420 616c 6c28 612e 6368 756e 6b73  and all(a.chunks
+00020890: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000208a0: 2020 2061 7272 6179 732e 6170 7065 6e64     arrays.append
+000208b0: 2861 2e72 6563 6875 6e6b 2863 6875 6e6b  (a.rechunk(chunk
+000208c0: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+000208d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000208e0: 2020 2020 2020 6172 7261 7973 2e61 7070        arrays.app
+000208f0: 656e 6428 6129 0a20 2020 2072 6574 7572  end(a).    retur
+00020900: 6e20 6368 756e 6b73 732c 2061 7272 6179  n chunkss, array
+00020910: 730a 0a0a 6465 6620 756e 7061 636b 5f73  s...def unpack_s
+00020920: 696e 676c 6574 6f6e 2878 293a 0a20 2020  ingleton(x):.   
+00020930: 2022 2222 0a0a 2020 2020 3e3e 3e20 756e   """..    >>> un
+00020940: 7061 636b 5f73 696e 676c 6574 6f6e 285b  pack_singleton([
+00020950: 5b5b 5b31 5d5d 5d5d 290a 2020 2020 310a  [[[1]]]]).    1.
+00020960: 2020 2020 3e3e 3e20 756e 7061 636b 5f73      >>> unpack_s
+00020970: 696e 676c 6574 6f6e 286e 702e 6172 7261  ingleton(np.arra
+00020980: 7928 6e70 2e64 6174 6574 696d 6536 3428  y(np.datetime64(
+00020990: 2732 3030 302d 3031 2d30 3127 2929 290a  '2000-01-01'))).
+000209a0: 2020 2020 6172 7261 7928 2732 3030 302d      array('2000-
+000209b0: 3031 2d30 3127 2c20 6474 7970 653d 2764  01-01', dtype='d
+000209c0: 6174 6574 696d 6536 345b 445d 2729 0a20  atetime64[D]'). 
+000209d0: 2020 2022 2222 0a20 2020 2077 6869 6c65     """.    while
+000209e0: 2069 7369 6e73 7461 6e63 6528 782c 2028   isinstance(x, (
+000209f0: 6c69 7374 2c20 7475 706c 6529 293a 0a20  list, tuple)):. 
+00020a00: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00020a10: 2020 2020 2020 2020 7820 3d20 785b 305d          x = x[0]
+00020a20: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00020a30: 2849 6e64 6578 4572 726f 722c 2054 7970  (IndexError, Typ
+00020a40: 6545 7272 6f72 2c20 4b65 7945 7272 6f72  eError, KeyError
+00020a50: 293a 0a20 2020 2020 2020 2020 2020 2062  ):.            b
+00020a60: 7265 616b 0a20 2020 2072 6574 7572 6e20  reak.    return 
+00020a70: 780a 0a0a 6465 6620 626c 6f63 6b28 6172  x...def block(ar
+00020a80: 7261 7973 2c20 616c 6c6f 775f 756e 6b6e  rays, allow_unkn
+00020a90: 6f77 6e5f 6368 756e 6b73 697a 6573 3d46  own_chunksizes=F
+00020aa0: 616c 7365 293a 0a20 2020 2022 2222 0a20  alse):.    """. 
+00020ab0: 2020 2041 7373 656d 626c 6520 616e 206e     Assemble an n
+00020ac0: 642d 6172 7261 7920 6672 6f6d 206e 6573  d-array from nes
+00020ad0: 7465 6420 6c69 7374 7320 6f66 2062 6c6f  ted lists of blo
+00020ae0: 636b 732e 0a0a 2020 2020 426c 6f63 6b73  cks...    Blocks
+00020af0: 2069 6e20 7468 6520 696e 6e65 726d 6f73   in the innermos
+00020b00: 7420 6c69 7374 7320 6172 6520 636f 6e63  t lists are conc
+00020b10: 6174 656e 6174 6564 2061 6c6f 6e67 2074  atenated along t
+00020b20: 6865 206c 6173 740a 2020 2020 6469 6d65  he last.    dime
+00020b30: 6e73 696f 6e20 282d 3129 2c20 7468 656e  nsion (-1), then
+00020b40: 2074 6865 7365 2061 7265 2063 6f6e 6361   these are conca
+00020b50: 7465 6e61 7465 6420 616c 6f6e 6720 7468  tenated along th
+00020b60: 6520 7365 636f 6e64 2d6c 6173 740a 2020  e second-last.  
+00020b70: 2020 6469 6d65 6e73 696f 6e20 282d 3229    dimension (-2)
+00020b80: 2c20 616e 6420 736f 206f 6e20 756e 7469  , and so on unti
+00020b90: 6c20 7468 6520 6f75 7465 726d 6f73 7420  l the outermost 
+00020ba0: 6c69 7374 2069 7320 7265 6163 6865 640a  list is reached.
+00020bb0: 0a20 2020 2042 6c6f 636b 7320 6361 6e20  .    Blocks can 
+00020bc0: 6265 206f 6620 616e 7920 6469 6d65 6e73  be of any dimens
+00020bd0: 696f 6e2c 2062 7574 2077 696c 6c20 6e6f  ion, but will no
+00020be0: 7420 6265 2062 726f 6164 6361 7374 6564  t be broadcasted
+00020bf0: 2075 7369 6e67 2074 6865 206e 6f72 6d61   using the norma
+00020c00: 6c0a 2020 2020 7275 6c65 732e 2049 6e73  l.    rules. Ins
+00020c10: 7465 6164 2c20 6c65 6164 696e 6720 6178  tead, leading ax
+00020c20: 6573 206f 6620 7369 7a65 2031 2061 7265  es of size 1 are
+00020c30: 2069 6e73 6572 7465 642c 2074 6f20 6d61   inserted, to ma
+00020c40: 6b65 2060 6062 6c6f 636b 2e6e 6469 6d60  ke ``block.ndim`
+00020c50: 600a 2020 2020 7468 6520 7361 6d65 2066  `.    the same f
+00020c60: 6f72 2061 6c6c 2062 6c6f 636b 732e 2054  or all blocks. T
+00020c70: 6869 7320 6973 2070 7269 6d61 7269 6c79  his is primarily
+00020c80: 2075 7365 6675 6c20 666f 7220 776f 726b   useful for work
+00020c90: 696e 6720 7769 7468 2073 6361 6c61 7273  ing with scalars
+00020ca0: 2c0a 2020 2020 616e 6420 6d65 616e 7320  ,.    and means 
+00020cb0: 7468 6174 2063 6f64 6520 6c69 6b65 2060  that code like `
+00020cc0: 6062 6c6f 636b 285b 762c 2031 5d29 6060  `block([v, 1])``
+00020cd0: 2069 7320 7661 6c69 642c 2077 6865 7265   is valid, where
+00020ce0: 0a20 2020 2060 6076 2e6e 6469 6d20 3d3d  .    ``v.ndim ==
+00020cf0: 2031 6060 2e0a 0a20 2020 2057 6865 6e20   1``...    When 
+00020d00: 7468 6520 6e65 7374 6564 206c 6973 7420  the nested list 
+00020d10: 6973 2074 776f 206c 6576 656c 7320 6465  is two levels de
+00020d20: 6570 2c20 7468 6973 2061 6c6c 6f77 7320  ep, this allows 
+00020d30: 626c 6f63 6b20 6d61 7472 6963 6573 2074  block matrices t
+00020d40: 6f20 6265 0a20 2020 2063 6f6e 7374 7275  o be.    constru
+00020d50: 6374 6564 2066 726f 6d20 7468 6569 7220  cted from their 
+00020d60: 636f 6d70 6f6e 656e 7473 2e0a 0a20 2020  components...   
+00020d70: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00020d80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2061  ----------.    a
+00020d90: 7272 6179 7320 3a20 6e65 7374 6564 206c  rrays : nested l
+00020da0: 6973 7420 6f66 2061 7272 6179 5f6c 696b  ist of array_lik
+00020db0: 6520 6f72 2073 6361 6c61 7273 2028 6275  e or scalars (bu
+00020dc0: 7420 6e6f 7420 7475 706c 6573 290a 2020  t not tuples).  
+00020dd0: 2020 2020 2020 4966 2070 6173 7365 6420        If passed 
+00020de0: 6120 7369 6e67 6c65 206e 6461 7272 6179  a single ndarray
+00020df0: 206f 7220 7363 616c 6172 2028 6120 6e65   or scalar (a ne
+00020e00: 7374 6564 206c 6973 7420 6f66 2064 6570  sted list of dep
+00020e10: 7468 2030 292c 2074 6869 730a 2020 2020  th 0), this.    
+00020e20: 2020 2020 6973 2072 6574 7572 6e65 6420      is returned 
+00020e30: 756e 6d6f 6469 6669 6564 2028 616e 6420  unmodified (and 
+00020e40: 6e6f 7420 636f 7069 6564 292e 0a0a 2020  not copied)...  
+00020e50: 2020 2020 2020 456c 656d 656e 7473 2073        Elements s
+00020e60: 6861 7065 7320 6d75 7374 206d 6174 6368  hapes must match
+00020e70: 2061 6c6f 6e67 2074 6865 2061 7070 726f   along the appro
+00020e80: 7072 6961 7465 2061 7865 7320 2877 6974  priate axes (wit
+00020e90: 686f 7574 0a20 2020 2020 2020 2062 726f  hout.        bro
+00020ea0: 6164 6361 7374 696e 6729 2c20 6275 7420  adcasting), but 
+00020eb0: 6c65 6164 696e 6720 3173 2077 696c 6c20  leading 1s will 
+00020ec0: 6265 2070 7265 7065 6e64 6564 2074 6f20  be prepended to 
+00020ed0: 7468 6520 7368 6170 6520 6173 0a20 2020  the shape as.   
+00020ee0: 2020 2020 206e 6563 6573 7361 7279 2074       necessary t
+00020ef0: 6f20 6d61 6b65 2074 6865 2064 696d 656e  o make the dimen
+00020f00: 7369 6f6e 7320 6d61 7463 682e 0a0a 2020  sions match...  
+00020f10: 2020 616c 6c6f 775f 756e 6b6e 6f77 6e5f    allow_unknown_
+00020f20: 6368 756e 6b73 697a 6573 3a20 626f 6f6c  chunksizes: bool
+00020f30: 0a20 2020 2020 2020 2041 6c6c 6f77 2075  .        Allow u
+00020f40: 6e6b 6e6f 776e 2063 6875 6e6b 7369 7a65  nknown chunksize
+00020f50: 732c 2073 7563 6820 6173 2063 6f6d 6520  s, such as come 
+00020f60: 6672 6f6d 2063 6f6e 7665 7274 696e 6720  from converting 
+00020f70: 6672 6f6d 2064 6173 6b0a 2020 2020 2020  from dask.      
+00020f80: 2020 6461 7461 6672 616d 6573 2e20 2044    dataframes.  D
+00020f90: 6173 6b2e 6172 7261 7920 6973 2075 6e61  ask.array is una
+00020fa0: 626c 6520 746f 2076 6572 6966 7920 7468  ble to verify th
+00020fb0: 6174 2063 6875 6e6b 7320 6c69 6e65 2075  at chunks line u
+00020fc0: 702e 2020 4966 0a20 2020 2020 2020 2064  p.  If.        d
+00020fd0: 6174 6120 636f 6d65 7320 6672 6f6d 2064  ata comes from d
+00020fe0: 6966 6665 7265 6e74 6c79 2061 6c69 676e  ifferently align
+00020ff0: 6564 2073 6f75 7263 6573 2074 6865 6e20  ed sources then 
+00021000: 7468 6973 2063 616e 2063 6175 7365 0a20  this can cause. 
+00021010: 2020 2020 2020 2075 6e65 7870 6563 7465         unexpecte
+00021020: 6420 7265 7375 6c74 732e 0a0a 2020 2020  d results...    
+00021030: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00021040: 2d2d 2d0a 2020 2020 626c 6f63 6b5f 6172  ---.    block_ar
+00021050: 7261 7920 3a20 6e64 6172 7261 790a 2020  ray : ndarray.  
+00021060: 2020 2020 2020 5468 6520 6172 7261 7920        The array 
+00021070: 6173 7365 6d62 6c65 6420 6672 6f6d 2074  assembled from t
+00021080: 6865 2067 6976 656e 2062 6c6f 636b 732e  he given blocks.
+00021090: 0a0a 2020 2020 2020 2020 5468 6520 6469  ..        The di
+000210a0: 6d65 6e73 696f 6e61 6c69 7479 206f 6620  mensionality of 
+000210b0: 7468 6520 6f75 7470 7574 2069 7320 6571  the output is eq
+000210c0: 7561 6c20 746f 2074 6865 2067 7265 6174  ual to the great
+000210d0: 6573 7420 6f66 3a0a 2020 2020 2020 2020  est of:.        
+000210e0: 2a20 7468 6520 6469 6d65 6e73 696f 6e61  * the dimensiona
+000210f0: 6c69 7479 206f 6620 616c 6c20 7468 6520  lity of all the 
+00021100: 696e 7075 7473 0a20 2020 2020 2020 202a  inputs.        *
+00021110: 2074 6865 2064 6570 7468 2074 6f20 7768   the depth to wh
+00021120: 6963 6820 7468 6520 696e 7075 7420 6c69  ich the input li
+00021130: 7374 2069 7320 6e65 7374 6564 0a0a 2020  st is nested..  
+00021140: 2020 5261 6973 6573 0a20 2020 202d 2d2d    Raises.    ---
+00021150: 2d2d 2d0a 2020 2020 5661 6c75 6545 7272  ---.    ValueErr
+00021160: 6f72 0a20 2020 2020 2020 202a 2049 6620  or.        * If 
+00021170: 6c69 7374 2064 6570 7468 7320 6172 6520  list depths are 
+00021180: 6d69 736d 6174 6368 6564 202d 2066 6f72  mismatched - for
+00021190: 2069 6e73 7461 6e63 652c 2060 605b 5b61   instance, ``[[a
+000211a0: 2c20 625d 2c20 635d 6060 2069 730a 2020  , b], c]`` is.  
+000211b0: 2020 2020 2020 2020 696c 6c65 6761 6c2c          illegal,
+000211c0: 2061 6e64 2073 686f 756c 6420 6265 2073   and should be s
+000211d0: 7065 6c74 2060 605b 5b61 2c20 625d 2c20  pelt ``[[a, b], 
+000211e0: 5b63 5d5d 6060 0a20 2020 2020 2020 202a  [c]]``.        *
+000211f0: 2049 6620 6c69 7374 7320 6172 6520 656d   If lists are em
+00021200: 7074 7920 2d20 666f 7220 696e 7374 616e  pty - for instan
+00021210: 6365 2c20 6060 5b5b 612c 2062 5d2c 205b  ce, ``[[a, b], [
+00021220: 5d5d 6060 0a0a 2020 2020 5365 6520 416c  ]]``..    See Al
+00021230: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
+00021240: 2020 2020 636f 6e63 6174 656e 6174 6520      concatenate 
+00021250: 3a20 4a6f 696e 2061 2073 6571 7565 6e63  : Join a sequenc
+00021260: 6520 6f66 2061 7272 6179 7320 746f 6765  e of arrays toge
+00021270: 7468 6572 2e0a 2020 2020 7374 6163 6b20  ther..    stack 
+00021280: 3a20 5374 6163 6b20 6172 7261 7973 2069  : Stack arrays i
+00021290: 6e20 7365 7175 656e 6365 2061 6c6f 6e67  n sequence along
+000212a0: 2061 206e 6577 2064 696d 656e 7369 6f6e   a new dimension
+000212b0: 2e0a 2020 2020 6873 7461 636b 203a 2053  ..    hstack : S
+000212c0: 7461 636b 2061 7272 6179 7320 696e 2073  tack arrays in s
+000212d0: 6571 7565 6e63 6520 686f 7269 7a6f 6e74  equence horizont
+000212e0: 616c 6c79 2028 636f 6c75 6d6e 2077 6973  ally (column wis
+000212f0: 6529 2e0a 2020 2020 7673 7461 636b 203a  e)..    vstack :
+00021300: 2053 7461 636b 2061 7272 6179 7320 696e   Stack arrays in
+00021310: 2073 6571 7565 6e63 6520 7665 7274 6963   sequence vertic
+00021320: 616c 6c79 2028 726f 7720 7769 7365 292e  ally (row wise).
+00021330: 0a20 2020 2064 7374 6163 6b20 3a20 5374  .    dstack : St
+00021340: 6163 6b20 6172 7261 7973 2069 6e20 7365  ack arrays in se
+00021350: 7175 656e 6365 2064 6570 7468 2077 6973  quence depth wis
+00021360: 6520 2861 6c6f 6e67 2074 6869 7264 2064  e (along third d
+00021370: 696d 656e 7369 6f6e 292e 0a20 2020 2076  imension)..    v
+00021380: 7370 6c69 7420 3a20 5370 6c69 7420 6172  split : Split ar
+00021390: 7261 7920 696e 746f 2061 206c 6973 7420  ray into a list 
+000213a0: 6f66 206d 756c 7469 706c 6520 7375 622d  of multiple sub-
+000213b0: 6172 7261 7973 2076 6572 7469 6361 6c6c  arrays verticall
+000213c0: 792e 0a0a 2020 2020 4e6f 7465 730a 2020  y...    Notes.  
+000213d0: 2020 2d2d 2d2d 2d0a 0a20 2020 2057 6865    -----..    Whe
+000213e0: 6e20 6361 6c6c 6564 2077 6974 6820 6f6e  n called with on
+000213f0: 6c79 2073 6361 6c61 7273 2c20 6060 626c  ly scalars, ``bl
+00021400: 6f63 6b60 6020 6973 2065 7175 6976 616c  ock`` is equival
+00021410: 656e 7420 746f 2061 6e20 6e64 6172 7261  ent to an ndarra
+00021420: 790a 2020 2020 6361 6c6c 2e20 536f 2060  y.    call. So `
+00021430: 6062 6c6f 636b 285b 5b31 2c20 325d 2c20  `block([[1, 2], 
+00021440: 5b33 2c20 345d 5d29 6060 2069 7320 6571  [3, 4]])`` is eq
+00021450: 7569 7661 6c65 6e74 2074 6f0a 2020 2020  uivalent to.    
+00021460: 6060 6172 7261 7928 5b5b 312c 2032 5d2c  ``array([[1, 2],
+00021470: 205b 332c 2034 5d5d 2960 602e 0a0a 2020   [3, 4]])``...  
+00021480: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+00021490: 646f 6573 206e 6f74 2065 6e66 6f72 6365  does not enforce
+000214a0: 2074 6861 7420 7468 6520 626c 6f63 6b73   that the blocks
+000214b0: 206c 6965 206f 6e20 6120 6669 7865 6420   lie on a fixed 
+000214c0: 6772 6964 2e0a 2020 2020 6060 626c 6f63  grid..    ``bloc
+000214d0: 6b28 5b5b 612c 2062 5d2c 205b 632c 2064  k([[a, b], [c, d
+000214e0: 5d5d 2960 6020 6973 206e 6f74 2072 6573  ]])`` is not res
+000214f0: 7472 6963 7465 6420 746f 2061 7272 6179  tricted to array
+00021500: 7320 6f66 2074 6865 2066 6f72 6d3a 3a0a  s of the form::.
+00021510: 0a20 2020 2020 2020 2041 4141 6262 0a20  .        AAAbb. 
+00021520: 2020 2020 2020 2041 4141 6262 0a20 2020         AAAbb.   
+00021530: 2020 2020 2063 6363 4444 0a0a 2020 2020       cccDD..    
+00021540: 4275 7420 6973 2061 6c73 6f20 616c 6c6f  But is also allo
+00021550: 7765 6420 746f 2070 726f 6475 6365 2c20  wed to produce, 
+00021560: 666f 7220 736f 6d65 2060 6061 2c20 622c  for some ``a, b,
+00021570: 2063 2c20 6460 603a 3a0a 0a20 2020 2020   c, d``::..     
+00021580: 2020 2041 4141 6262 0a20 2020 2020 2020     AAAbb.       
+00021590: 2041 4141 6262 0a20 2020 2020 2020 2063   AAAbb.        c
+000215a0: 4444 4444 0a0a 2020 2020 5369 6e63 6520  DDDD..    Since 
+000215b0: 636f 6e63 6174 656e 6174 696f 6e20 6861  concatenation ha
+000215c0: 7070 656e 7320 616c 6f6e 6720 7468 6520  ppens along the 
+000215d0: 6c61 7374 2061 7869 7320 6669 7273 742c  last axis first,
+000215e0: 2060 626c 6f63 6b60 2069 7320 5f6e 6f74   `block` is _not
+000215f0: 5f0a 2020 2020 6361 7061 626c 6520 6f66  _.    capable of
+00021600: 2070 726f 6475 6369 6e67 2074 6865 2066   producing the f
+00021610: 6f6c 6c6f 7769 6e67 2064 6972 6563 746c  ollowing directl
+00021620: 793a 3a0a 0a20 2020 2020 2020 2041 4141  y::..        AAA
+00021630: 6262 0a20 2020 2020 2020 2063 6363 6262  bb.        cccbb
+00021640: 0a20 2020 2020 2020 2063 6363 4444 0a0a  .        cccDD..
+00021650: 2020 2020 4d61 746c 6162 2773 2022 7371      Matlab's "sq
+00021660: 7561 7265 2062 7261 636b 6574 2073 7461  uare bracket sta
+00021670: 636b 696e 6722 2c20 6060 5b41 2c20 422c  cking", ``[A, B,
+00021680: 202e 2e2e 3b20 702c 2071 2c20 2e2e 2e5d   ...; p, q, ...]
+00021690: 6060 2c20 6973 0a20 2020 2065 7175 6976  ``, is.    equiv
+000216a0: 616c 656e 7420 746f 2060 6062 6c6f 636b  alent to ``block
+000216b0: 285b 5b41 2c20 422c 202e 2e2e 5d2c 205b  ([[A, B, ...], [
+000216c0: 702c 2071 2c20 2e2e 2e5d 5d29 6060 2e0a  p, q, ...]])``..
+000216d0: 2020 2020 2222 220a 0a20 2020 2023 2054      """..    # T
+000216e0: 6869 7320 7761 7320 636f 7069 6564 2061  his was copied a
+000216f0: 6c6d 6f73 7420 7665 7262 6174 696d 2066  lmost verbatim f
+00021700: 726f 6d20 6e75 6d70 792e 636f 7265 2e73  rom numpy.core.s
+00021710: 6861 7065 5f62 6173 652e 626c 6f63 6b0a  hape_base.block.
+00021720: 2020 2020 2320 5365 6520 6e75 6d70 7920      # See numpy 
+00021730: 6c69 6365 6e73 6520 6174 2068 7474 7073  license at https
+00021740: 3a2f 2f67 6974 6875 622e 636f 6d2f 6e75  ://github.com/nu
+00021750: 6d70 792f 6e75 6d70 792f 626c 6f62 2f6d  mpy/numpy/blob/m
+00021760: 6173 7465 722f 4c49 4345 4e53 452e 7478  aster/LICENSE.tx
+00021770: 740a 2020 2020 2320 6f72 204e 554d 5059  t.    # or NUMPY
+00021780: 5f4c 4943 454e 5345 2e74 7874 2077 6974  _LICENSE.txt wit
+00021790: 6869 6e20 7468 6973 2064 6972 6563 746f  hin this directo
+000217a0: 7279 0a0a 2020 2020 6465 6620 6174 6c65  ry..    def atle
+000217b0: 6173 745f 6e64 2878 2c20 6e64 696d 293a  ast_nd(x, ndim):
+000217c0: 0a20 2020 2020 2020 2078 203d 2061 7361  .        x = asa
+000217d0: 6e79 6172 7261 7928 7829 0a20 2020 2020  nyarray(x).     
+000217e0: 2020 2064 6966 6620 3d20 6d61 7828 6e64     diff = max(nd
+000217f0: 696d 202d 2078 2e6e 6469 6d2c 2030 290a  im - x.ndim, 0).
+00021800: 2020 2020 2020 2020 6966 2064 6966 6620          if diff 
+00021810: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+00021820: 2020 7265 7475 726e 2078 0a20 2020 2020    return x.     
+00021830: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00021840: 2020 2020 2072 6574 7572 6e20 785b 284e       return x[(N
+00021850: 6f6e 652c 2920 2a20 6469 6666 202b 2028  one,) * diff + (
+00021860: 456c 6c69 7073 6973 2c29 5d0a 0a20 2020  Ellipsis,)]..   
+00021870: 2064 6566 2066 6f72 6d61 745f 696e 6465   def format_inde
+00021880: 7828 696e 6465 7829 3a0a 2020 2020 2020  x(index):.      
+00021890: 2020 7265 7475 726e 2022 6172 7261 7973    return "arrays
+000218a0: 2220 2b20 2222 2e6a 6f69 6e28 6622 5b7b  " + "".join(f"[{
+000218b0: 697d 5d22 2066 6f72 2069 2069 6e20 696e  i}]" for i in in
+000218c0: 6465 7829 0a0a 2020 2020 7265 6320 3d20  dex)..    rec = 
+000218d0: 5f52 6563 7572 7365 7228 7265 6375 7273  _Recurser(recurs
+000218e0: 655f 6966 3d6c 616d 6264 6120 783a 2074  e_if=lambda x: t
+000218f0: 7970 6528 7829 2069 7320 6c69 7374 290a  ype(x) is list).
+00021900: 0a20 2020 2023 2065 6e73 7572 6520 7468  .    # ensure th
+00021910: 6174 2074 6865 206c 6973 7473 2061 7265  at the lists are
+00021920: 2061 6c6c 206d 6174 6368 6564 2069 6e20   all matched in 
+00021930: 6465 7074 680a 2020 2020 6c69 7374 5f6e  depth.    list_n
+00021940: 6469 6d20 3d20 4e6f 6e65 0a20 2020 2061  dim = None.    a
+00021950: 6e79 5f65 6d70 7479 203d 2046 616c 7365  ny_empty = False
+00021960: 0a20 2020 2066 6f72 2069 6e64 6578 2c20  .    for index, 
+00021970: 7661 6c75 652c 2065 6e74 6572 696e 6720  value, entering 
+00021980: 696e 2072 6563 2e77 616c 6b28 6172 7261  in rec.walk(arra
+00021990: 7973 293a 0a20 2020 2020 2020 2069 6620  ys):.        if 
+000219a0: 7479 7065 2876 616c 7565 2920 6973 2074  type(value) is t
+000219b0: 7570 6c65 3a0a 2020 2020 2020 2020 2020  uple:.          
+000219c0: 2020 2320 6e6f 7420 7374 7269 6374 6c79    # not strictly
+000219d0: 206e 6563 6573 7361 7279 2c20 6275 7420   necessary, but 
+000219e0: 7361 7665 7320 7573 2066 726f 6d3a 0a20  saves us from:. 
+000219f0: 2020 2020 2020 2020 2020 2023 2020 2d20             #  - 
+00021a00: 6d6f 7265 2074 6861 6e20 6f6e 6520 7761  more than one wa
+00021a10: 7920 746f 2064 6f20 7468 696e 6773 202d  y to do things -
+00021a20: 206e 6f20 706f 696e 7420 7472 6561 7469   no point treati
+00021a30: 6e67 2074 7570 6c65 7320 6c69 6b65 0a20  ng tuples like. 
+00021a40: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+00021a50: 6c69 7374 730a 2020 2020 2020 2020 2020  lists.          
+00021a60: 2020 2320 202d 2068 6f72 7269 626c 7920    #  - horribly 
+00021a70: 636f 6e66 7573 696e 6720 6265 6861 7669  confusing behavi
+00021a80: 6f75 7220 7468 6174 2072 6573 756c 7473  our that results
+00021a90: 2077 6865 6e20 7475 706c 6573 2061 7265   when tuples are
+00021aa0: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+00021ab0: 2020 7472 6561 7465 6420 6c69 6b65 206e    treated like n
+00021ac0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00021ad0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00021ae0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00021af0: 2020 2020 227b 7d20 6973 2061 2074 7570      "{} is a tup
+00021b00: 6c65 2e20 220a 2020 2020 2020 2020 2020  le. ".          
+00021b10: 2020 2020 2020 224f 6e6c 7920 6c69 7374        "Only list
+00021b20: 7320 6361 6e20 6265 2075 7365 6420 746f  s can be used to
+00021b30: 2061 7272 616e 6765 2062 6c6f 636b 732c   arrange blocks,
+00021b40: 2061 6e64 206e 702e 626c 6f63 6b20 646f   and np.block do
+00021b50: 6573 2022 0a20 2020 2020 2020 2020 2020  es ".           
+00021b60: 2020 2020 2022 6e6f 7420 616c 6c6f 7720       "not allow 
+00021b70: 696d 706c 6963 6974 2063 6f6e 7665 7273  implicit convers
+00021b80: 696f 6e20 6672 6f6d 2074 7570 6c65 2074  ion from tuple t
+00021b90: 6f20 6e64 6172 7261 792e 222e 666f 726d  o ndarray.".form
+00021ba0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+00021bb0: 2020 2020 2020 2020 666f 726d 6174 5f69          format_i
+00021bc0: 6e64 6578 2869 6e64 6578 290a 2020 2020  ndex(index).    
+00021bd0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00021be0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00021bf0: 2020 2020 6966 206e 6f74 2065 6e74 6572      if not enter
+00021c00: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
+00021c10: 2063 7572 725f 6465 7074 6820 3d20 6c65   curr_depth = le
+00021c20: 6e28 696e 6465 7829 0a20 2020 2020 2020  n(index).       
+00021c30: 2065 6c69 6620 6c65 6e28 7661 6c75 6529   elif len(value)
+00021c40: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00021c50: 2020 2063 7572 725f 6465 7074 6820 3d20     curr_depth = 
+00021c60: 6c65 6e28 696e 6465 7829 202b 2031 0a20  len(index) + 1. 
+00021c70: 2020 2020 2020 2020 2020 2061 6e79 5f65             any_e
+00021c80: 6d70 7479 203d 2054 7275 650a 2020 2020  mpty = True.    
+00021c90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00021ca0: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00021cb0: 2020 2020 2020 2020 6966 206c 6973 745f          if list_
+00021cc0: 6e64 696d 2069 7320 6e6f 7420 4e6f 6e65  ndim is not None
+00021cd0: 2061 6e64 206c 6973 745f 6e64 696d 2021   and list_ndim !
+00021ce0: 3d20 6375 7272 5f64 6570 7468 3a0a 2020  = curr_depth:.  
+00021cf0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00021d00: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00021d10: 2020 2020 2020 2020 2020 2020 224c 6973              "Lis
+00021d20: 7420 6465 7074 6873 2061 7265 206d 6973  t depths are mis
+00021d30: 6d61 7463 6865 642e 2046 6972 7374 2065  matched. First e
+00021d40: 6c65 6d65 6e74 2077 6173 2061 7420 6465  lement was at de
+00021d50: 7074 6820 7b7d 2c20 220a 2020 2020 2020  pth {}, ".      
+00021d60: 2020 2020 2020 2020 2020 2262 7574 2074            "but t
+00021d70: 6865 7265 2069 7320 616e 2065 6c65 6d65  here is an eleme
+00021d80: 6e74 2061 7420 6465 7074 6820 7b7d 2028  nt at depth {} (
+00021d90: 7b7d 2922 2e66 6f72 6d61 7428 0a20 2020  {})".format(.   
+00021da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021db0: 206c 6973 745f 6e64 696d 2c20 6375 7272   list_ndim, curr
+00021dc0: 5f64 6570 7468 2c20 666f 726d 6174 5f69  _depth, format_i
+00021dd0: 6e64 6578 2869 6e64 6578 290a 2020 2020  ndex(index).    
+00021de0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00021df0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00021e00: 2020 2020 6c69 7374 5f6e 6469 6d20 3d20      list_ndim = 
+00021e10: 6375 7272 5f64 6570 7468 0a0a 2020 2020  curr_depth..    
+00021e20: 2320 646f 2074 6869 7320 6865 7265 2073  # do this here s
+00021e30: 6f20 7765 2063 6174 6368 2064 6570 7468  o we catch depth
+00021e40: 206d 6973 6d61 7463 6865 7320 6669 7273   mismatches firs
+00021e50: 740a 2020 2020 6966 2061 6e79 5f65 6d70  t.    if any_emp
+00021e60: 7479 3a0a 2020 2020 2020 2020 7261 6973  ty:.        rais
+00021e70: 6520 5661 6c75 6545 7272 6f72 2822 4c69  e ValueError("Li
+00021e80: 7374 7320 6361 6e6e 6f74 2062 6520 656d  sts cannot be em
+00021e90: 7074 7922 290a 0a20 2020 2023 2063 6f6e  pty")..    # con
+00021ea0: 7665 7274 2061 6c6c 2074 6865 2061 7272  vert all the arr
+00021eb0: 6179 7320 746f 206e 6461 7272 6179 730a  ays to ndarrays.
+00021ec0: 2020 2020 6172 7261 7973 203d 2072 6563      arrays = rec
+00021ed0: 2e6d 6170 5f72 6564 7563 6528 6172 7261  .map_reduce(arra
+00021ee0: 7973 2c20 665f 6d61 703d 6173 616e 7961  ys, f_map=asanya
+00021ef0: 7272 6179 2c20 665f 7265 6475 6365 3d6c  rray, f_reduce=l
+00021f00: 6973 7429 0a0a 2020 2020 2320 6465 7465  ist)..    # dete
+00021f10: 726d 696e 6520 7468 6520 6d61 7869 6d75  rmine the maximu
+00021f20: 6d20 6469 6d65 6e73 696f 6e20 6f66 2074  m dimension of t
+00021f30: 6865 2065 6c65 6d65 6e74 730a 2020 2020  he elements.    
+00021f40: 656c 656d 5f6e 6469 6d20 3d20 7265 632e  elem_ndim = rec.
+00021f50: 6d61 705f 7265 6475 6365 2861 7272 6179  map_reduce(array
+00021f60: 732c 2066 5f6d 6170 3d6c 616d 6264 6120  s, f_map=lambda 
+00021f70: 7869 3a20 7869 2e6e 6469 6d2c 2066 5f72  xi: xi.ndim, f_r
+00021f80: 6564 7563 653d 6d61 7829 0a20 2020 206e  educe=max).    n
+00021f90: 6469 6d20 3d20 6d61 7828 6c69 7374 5f6e  dim = max(list_n
+00021fa0: 6469 6d2c 2065 6c65 6d5f 6e64 696d 290a  dim, elem_ndim).
+00021fb0: 0a20 2020 2023 2066 6972 7374 2061 7869  .    # first axi
+00021fc0: 7320 746f 2063 6f6e 6361 7465 6e61 7465  s to concatenate
+00021fd0: 2061 6c6f 6e67 0a20 2020 2066 6972 7374   along.    first
+00021fe0: 5f61 7869 7320 3d20 6e64 696d 202d 206c  _axis = ndim - l
+00021ff0: 6973 745f 6e64 696d 0a0a 2020 2020 2320  ist_ndim..    # 
+00022000: 4d61 6b65 2061 6c6c 2074 6865 2065 6c65  Make all the ele
+00022010: 6d65 6e74 7320 7468 6520 7361 6d65 2064  ments the same d
+00022020: 696d 656e 7369 6f6e 0a20 2020 2061 7272  imension.    arr
+00022030: 6179 7320 3d20 7265 632e 6d61 705f 7265  ays = rec.map_re
+00022040: 6475 6365 280a 2020 2020 2020 2020 6172  duce(.        ar
+00022050: 7261 7973 2c20 665f 6d61 703d 6c61 6d62  rays, f_map=lamb
+00022060: 6461 2078 693a 2061 746c 6561 7374 5f6e  da xi: atleast_n
+00022070: 6428 7869 2c20 6e64 696d 292c 2066 5f72  d(xi, ndim), f_r
+00022080: 6564 7563 653d 6c69 7374 0a20 2020 2029  educe=list.    )
+00022090: 0a0a 2020 2020 2320 636f 6e63 6174 656e  ..    # concaten
+000220a0: 6174 6520 696e 6e65 726d 6f73 7420 6c69  ate innermost li
+000220b0: 7374 7320 6f6e 2074 6865 2072 6967 6874  sts on the right
+000220c0: 2c20 6f75 7465 726d 6f73 7420 6f6e 2074  , outermost on t
+000220d0: 6865 206c 6566 740a 2020 2020 7265 7475  he left.    retu
+000220e0: 726e 2072 6563 2e6d 6170 5f72 6564 7563  rn rec.map_reduc
+000220f0: 6528 0a20 2020 2020 2020 2061 7272 6179  e(.        array
+00022100: 732c 0a20 2020 2020 2020 2066 5f72 6564  s,.        f_red
+00022110: 7563 653d 6c61 6d62 6461 2078 732c 2061  uce=lambda xs, a
+00022120: 7869 733a 2063 6f6e 6361 7465 6e61 7465  xis: concatenate
+00022130: 280a 2020 2020 2020 2020 2020 2020 6c69  (.            li
+00022140: 7374 2878 7329 2c20 6178 6973 3d61 7869  st(xs), axis=axi
+00022150: 732c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  s, allow_unknown
+00022160: 5f63 6875 6e6b 7369 7a65 733d 616c 6c6f  _chunksizes=allo
+00022170: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
+00022180: 697a 6573 0a20 2020 2020 2020 2029 2c0a  izes.        ),.
+00022190: 2020 2020 2020 2020 665f 6b77 6172 6773          f_kwargs
+000221a0: 3d6c 616d 6264 6120 6178 6973 3a20 6469  =lambda axis: di
+000221b0: 6374 2861 7869 733d 2861 7869 7320 2b20  ct(axis=(axis + 
+000221c0: 3129 292c 0a20 2020 2020 2020 2061 7869  1)),.        axi
+000221d0: 733d 6669 7273 745f 6178 6973 2c0a 2020  s=first_axis,.  
+000221e0: 2020 290a 0a0a 6465 6620 636f 6e63 6174    )...def concat
+000221f0: 656e 6174 6528 7365 712c 2061 7869 733d  enate(seq, axis=
+00022200: 302c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  0, allow_unknown
+00022210: 5f63 6875 6e6b 7369 7a65 733d 4661 6c73  _chunksizes=Fals
+00022220: 6529 3a0a 2020 2020 2222 220a 2020 2020  e):.    """.    
+00022230: 436f 6e63 6174 656e 6174 6520 6172 7261  Concatenate arra
+00022240: 7973 2061 6c6f 6e67 2061 6e20 6578 6973  ys along an exis
+00022250: 7469 6e67 2061 7869 730a 0a20 2020 2047  ting axis..    G
+00022260: 6976 656e 2061 2073 6571 7565 6e63 6520  iven a sequence 
+00022270: 6f66 2064 6173 6b20 4172 7261 7973 2066  of dask Arrays f
+00022280: 6f72 6d20 6120 6e65 7720 6461 736b 2041  orm a new dask A
+00022290: 7272 6179 2062 7920 7374 6163 6b69 6e67  rray by stacking
+000222a0: 2074 6865 6d0a 2020 2020 616c 6f6e 6720   them.    along 
+000222b0: 616e 2065 7869 7374 696e 6720 6469 6d65  an existing dime
+000222c0: 6e73 696f 6e20 2861 7869 733d 3020 6279  nsion (axis=0 by
+000222d0: 2064 6566 6175 6c74 290a 0a20 2020 2050   default)..    P
+000222e0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+000222f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073 6571  --------.    seq
+00022300: 3a20 6c69 7374 206f 6620 6461 736b 2e61  : list of dask.a
+00022310: 7272 6179 730a 2020 2020 6178 6973 3a20  rrays.    axis: 
+00022320: 696e 740a 2020 2020 2020 2020 4469 6d65  int.        Dime
+00022330: 6e73 696f 6e20 616c 6f6e 6720 7768 6963  nsion along whic
+00022340: 6820 746f 2061 6c69 676e 2061 6c6c 206f  h to align all o
+00022350: 6620 7468 6520 6172 7261 7973 2e20 4966  f the arrays. If
+00022360: 2061 7869 7320 6973 204e 6f6e 652c 0a20   axis is None,. 
+00022370: 2020 2020 2020 2061 7272 6179 7320 6172         arrays ar
+00022380: 6520 666c 6174 7465 6e65 6420 6265 666f  e flattened befo
+00022390: 7265 2075 7365 2e0a 2020 2020 616c 6c6f  re use..    allo
+000223a0: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
+000223b0: 697a 6573 3a20 626f 6f6c 0a20 2020 2020  izes: bool.     
+000223c0: 2020 2041 6c6c 6f77 2075 6e6b 6e6f 776e     Allow unknown
+000223d0: 2063 6875 6e6b 7369 7a65 732c 2073 7563   chunksizes, suc
+000223e0: 6820 6173 2063 6f6d 6520 6672 6f6d 2063  h as come from c
+000223f0: 6f6e 7665 7274 696e 6720 6672 6f6d 2064  onverting from d
+00022400: 6173 6b0a 2020 2020 2020 2020 6461 7461  ask.        data
+00022410: 6672 616d 6573 2e20 2044 6173 6b2e 6172  frames.  Dask.ar
+00022420: 7261 7920 6973 2075 6e61 626c 6520 746f  ray is unable to
+00022430: 2076 6572 6966 7920 7468 6174 2063 6875   verify that chu
+00022440: 6e6b 7320 6c69 6e65 2075 702e 2020 4966  nks line up.  If
+00022450: 0a20 2020 2020 2020 2064 6174 6120 636f  .        data co
+00022460: 6d65 7320 6672 6f6d 2064 6966 6665 7265  mes from differe
+00022470: 6e74 6c79 2061 6c69 676e 6564 2073 6f75  ntly aligned sou
+00022480: 7263 6573 2074 6865 6e20 7468 6973 2063  rces then this c
+00022490: 616e 2063 6175 7365 0a20 2020 2020 2020  an cause.       
+000224a0: 2075 6e65 7870 6563 7465 6420 7265 7375   unexpected resu
+000224b0: 6c74 732e 0a0a 2020 2020 4578 616d 706c  lts...    Exampl
+000224c0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+000224d0: 0a20 2020 2043 7265 6174 6520 736c 6963  .    Create slic
+000224e0: 6573 0a0a 2020 2020 3e3e 3e20 696d 706f  es..    >>> impo
+000224f0: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
+00022500: 2064 610a 2020 2020 3e3e 3e20 696d 706f   da.    >>> impo
+00022510: 7274 206e 756d 7079 2061 7320 6e70 0a0a  rt numpy as np..
+00022520: 2020 2020 3e3e 3e20 6461 7461 203d 205b      >>> data = [
+00022530: 6461 2e66 726f 6d5f 6172 7261 7928 6e70  da.from_array(np
+00022540: 2e6f 6e65 7328 2834 2c20 3429 292c 2063  .ones((4, 4)), c
+00022550: 6875 6e6b 733d 2832 2c20 3229 290a 2020  hunks=(2, 2)).  
+00022560: 2020 2e2e 2e20 2020 2020 2020 2020 2066    ...          f
+00022570: 6f72 2069 2069 6e20 7261 6e67 6528 3329  or i in range(3)
+00022580: 5d0a 0a20 2020 203e 3e3e 2078 203d 2064  ]..    >>> x = d
+00022590: 612e 636f 6e63 6174 656e 6174 6528 6461  a.concatenate(da
+000225a0: 7461 2c20 6178 6973 3d30 290a 2020 2020  ta, axis=0).    
+000225b0: 3e3e 3e20 782e 7368 6170 650a 2020 2020  >>> x.shape.    
+000225c0: 2831 322c 2034 290a 0a20 2020 203e 3e3e  (12, 4)..    >>>
+000225d0: 2064 612e 636f 6e63 6174 656e 6174 6528   da.concatenate(
+000225e0: 6461 7461 2c20 6178 6973 3d31 292e 7368  data, axis=1).sh
+000225f0: 6170 650a 2020 2020 2834 2c20 3132 290a  ape.    (4, 12).
+00022600: 0a20 2020 2052 6573 756c 7420 6973 2061  .    Result is a
+00022610: 206e 6577 2064 6173 6b20 4172 7261 790a   new dask Array.
+00022620: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
+00022630: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073    --------.    s
+00022640: 7461 636b 0a20 2020 2022 2222 0a20 2020  tack.    """.   
+00022650: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00022660: 2069 6d70 6f72 7420 7772 6170 0a0a 2020   import wrap..  
+00022670: 2020 7365 7120 3d20 5b61 7361 7272 6179    seq = [asarray
+00022680: 2861 2c20 616c 6c6f 775f 756e 6b6e 6f77  (a, allow_unknow
+00022690: 6e5f 6368 756e 6b73 697a 6573 3d61 6c6c  n_chunksizes=all
+000226a0: 6f77 5f75 6e6b 6e6f 776e 5f63 6875 6e6b  ow_unknown_chunk
+000226b0: 7369 7a65 7329 2066 6f72 2061 2069 6e20  sizes) for a in 
+000226c0: 7365 715d 0a0a 2020 2020 6966 206e 6f74  seq]..    if not
+000226d0: 2073 6571 3a0a 2020 2020 2020 2020 7261   seq:.        ra
+000226e0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+000226f0: 4e65 6564 2061 7272 6179 2873 2920 746f  Need array(s) to
+00022700: 2063 6f6e 6361 7465 6e61 7465 2229 0a0a   concatenate")..
+00022710: 2020 2020 6966 2061 7869 7320 6973 204e      if axis is N
+00022720: 6f6e 653a 0a20 2020 2020 2020 2073 6571  one:.        seq
+00022730: 203d 205b 612e 666c 6174 7465 6e28 2920   = [a.flatten() 
+00022740: 666f 7220 6120 696e 2073 6571 5d0a 2020  for a in seq].  
+00022750: 2020 2020 2020 6178 6973 203d 2030 0a0a        axis = 0..
+00022760: 2020 2020 7365 715f 6d65 7461 7320 3d20      seq_metas = 
+00022770: 5b6d 6574 615f 6672 6f6d 5f61 7272 6179  [meta_from_array
+00022780: 2873 2920 666f 7220 7320 696e 2073 6571  (s) for s in seq
+00022790: 5d0a 2020 2020 5f63 6f6e 6361 7465 6e61  ].    _concatena
+000227a0: 7465 203d 2063 6f6e 6361 7465 6e61 7465  te = concatenate
+000227b0: 5f6c 6f6f 6b75 702e 6469 7370 6174 6368  _lookup.dispatch
+000227c0: 280a 2020 2020 2020 2020 7479 7065 286d  (.        type(m
+000227d0: 6178 2873 6571 5f6d 6574 6173 2c20 6b65  ax(seq_metas, ke
+000227e0: 793d 6c61 6d62 6461 2078 3a20 6765 7461  y=lambda x: geta
+000227f0: 7474 7228 782c 2022 5f5f 6172 7261 795f  ttr(x, "__array_
+00022800: 7072 696f 7269 7479 5f5f 222c 2030 2929  priority__", 0))
+00022810: 290a 2020 2020 290a 2020 2020 6d65 7461  ).    ).    meta
+00022820: 203d 205f 636f 6e63 6174 656e 6174 6528   = _concatenate(
+00022830: 7365 715f 6d65 7461 732c 2061 7869 733d  seq_metas, axis=
+00022840: 6178 6973 290a 0a20 2020 2023 2050 726f  axis)..    # Pro
+00022850: 6d6f 7465 2074 7970 6573 2074 6f20 6d61  mote types to ma
+00022860: 7463 6820 6d65 7461 0a20 2020 2073 6571  tch meta.    seq
+00022870: 203d 205b 612e 6173 7479 7065 286d 6574   = [a.astype(met
+00022880: 612e 6474 7970 6529 2066 6f72 2061 2069  a.dtype) for a i
+00022890: 6e20 7365 715d 0a0a 2020 2020 2320 4669  n seq]..    # Fi
+000228a0: 6e64 206f 7574 7075 7420 6172 7261 7920  nd output array 
+000228b0: 7368 6170 650a 2020 2020 6e64 696d 203d  shape.    ndim =
+000228c0: 206c 656e 2873 6571 5b30 5d2e 7368 6170   len(seq[0].shap
+000228d0: 6529 0a20 2020 2073 6861 7065 203d 2074  e).    shape = t
+000228e0: 7570 6c65 280a 2020 2020 2020 2020 7375  uple(.        su
+000228f0: 6d28 612e 7368 6170 655b 695d 2066 6f72  m(a.shape[i] for
+00022900: 2061 2069 6e20 7365 7129 2069 6620 6920   a in seq) if i 
+00022910: 3d3d 2061 7869 7320 656c 7365 2073 6571  == axis else seq
+00022920: 5b30 5d2e 7368 6170 655b 695d 0a20 2020  [0].shape[i].   
+00022930: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00022940: 6e67 6528 6e64 696d 290a 2020 2020 290a  nge(ndim).    ).
+00022950: 0a20 2020 2023 2044 726f 7020 656d 7074  .    # Drop empt
+00022960: 7920 6172 7261 7973 0a20 2020 2073 6571  y arrays.    seq
+00022970: 3220 3d20 5b61 2066 6f72 2061 2069 6e20  2 = [a for a in 
+00022980: 7365 7120 6966 2061 2e73 697a 655d 0a20  seq if a.size]. 
+00022990: 2020 2069 6620 6e6f 7420 7365 7132 3a0a     if not seq2:.
+000229a0: 2020 2020 2020 2020 7365 7132 203d 2073          seq2 = s
+000229b0: 6571 0a0a 2020 2020 6966 2061 7869 7320  eq..    if axis 
+000229c0: 3c20 303a 0a20 2020 2020 2020 2061 7869  < 0:.        axi
+000229d0: 7320 3d20 6e64 696d 202b 2061 7869 730a  s = ndim + axis.
+000229e0: 2020 2020 6966 2061 7869 7320 3e3d 206e      if axis >= n
+000229f0: 6469 6d3a 0a20 2020 2020 2020 206d 7367  dim:.        msg
+00022a00: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00022a10: 2022 4178 6973 206d 7573 7420 6265 206c   "Axis must be l
+00022a20: 6573 7320 7468 616e 2074 6861 6e20 6e75  ess than than nu
+00022a30: 6d62 6572 206f 6620 6469 6d65 6e73 696f  mber of dimensio
+00022a40: 6e73 220a 2020 2020 2020 2020 2020 2020  ns".            
+00022a50: 225c 6e44 6174 6120 6861 7320 2564 2064  "\nData has %d d
+00022a60: 696d 656e 7369 6f6e 732c 2062 7574 2067  imensions, but g
+00022a70: 6f74 2061 7869 733d 2564 220a 2020 2020  ot axis=%d".    
+00022a80: 2020 2020 290a 2020 2020 2020 2020 7261      ).        ra
+00022a90: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
+00022aa0: 7367 2025 2028 6e64 696d 2c20 6178 6973  sg % (ndim, axis
+00022ab0: 2929 0a0a 2020 2020 6e20 3d20 6c65 6e28  ))..    n = len(
+00022ac0: 7365 7132 290a 2020 2020 6966 206e 203d  seq2).    if n =
+00022ad0: 3d20 303a 0a20 2020 2020 2020 2074 7279  = 0:.        try
+00022ae0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00022af0: 7475 726e 2077 7261 702e 656d 7074 795f  turn wrap.empty_
+00022b00: 6c69 6b65 286d 6574 612c 2073 6861 7065  like(meta, shape
+00022b10: 3d73 6861 7065 2c20 6368 756e 6b73 3d73  =shape, chunks=s
+00022b20: 6861 7065 2c20 6474 7970 653d 6d65 7461  hape, dtype=meta
+00022b30: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
+00022b40: 6578 6365 7074 2054 7970 6545 7272 6f72  except TypeError
+00022b50: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00022b60: 7475 726e 2077 7261 702e 656d 7074 7928  turn wrap.empty(
+00022b70: 7368 6170 652c 2063 6875 6e6b 733d 7368  shape, chunks=sh
+00022b80: 6170 652c 2064 7479 7065 3d6d 6574 612e  ape, dtype=meta.
+00022b90: 6474 7970 6529 0a20 2020 2065 6c69 6620  dtype).    elif 
+00022ba0: 6e20 3d3d 2031 3a0a 2020 2020 2020 2020  n == 1:.        
+00022bb0: 7265 7475 726e 2073 6571 325b 305d 0a0a  return seq2[0]..
+00022bc0: 2020 2020 6966 206e 6f74 2061 6c6c 6f77      if not allow
+00022bd0: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
+00022be0: 7a65 7320 616e 6420 6e6f 7420 616c 6c28  zes and not all(
+00022bf0: 0a20 2020 2020 2020 2069 203d 3d20 6178  .        i == ax
+00022c00: 6973 206f 7220 616c 6c28 782e 7368 6170  is or all(x.shap
+00022c10: 655b 695d 203d 3d20 7365 7132 5b30 5d2e  e[i] == seq2[0].
+00022c20: 7368 6170 655b 695d 2066 6f72 2078 2069  shape[i] for x i
+00022c30: 6e20 7365 7132 290a 2020 2020 2020 2020  n seq2).        
+00022c40: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
+00022c50: 6469 6d29 0a20 2020 2029 3a0a 2020 2020  dim).    ):.    
+00022c60: 2020 2020 6966 2061 6e79 286d 6170 286e      if any(map(n
+00022c70: 702e 6973 6e61 6e2c 2073 6571 325b 305d  p.isnan, seq2[0]
+00022c80: 2e73 6861 7065 2929 3a0a 2020 2020 2020  .shape)):.      
+00022c90: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00022ca0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00022cb0: 2020 2020 2020 2020 2254 7269 6564 2074          "Tried t
+00022cc0: 6f20 636f 6e63 6174 656e 6174 6520 6172  o concatenate ar
+00022cd0: 7261 7973 2077 6974 6820 756e 6b6e 6f77  rays with unknow
+00022ce0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+00022cf0: 2020 2022 2073 6861 7065 2025 732e 5c6e     " shape %s.\n
+00022d00: 5c6e 5477 6f20 736f 6c75 7469 6f6e 733a  \nTwo solutions:
+00022d10: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
+00022d20: 2020 2020 2220 2031 2e20 466f 7263 6520      "  1. Force 
+00022d30: 636f 6e63 6174 656e 6174 696f 6e20 7061  concatenation pa
+00022d40: 7373 220a 2020 2020 2020 2020 2020 2020  ss".            
+00022d50: 2020 2020 2220 616c 6c6f 775f 756e 6b6e      " allow_unkn
+00022d60: 6f77 6e5f 6368 756e 6b73 697a 6573 3d54  own_chunksizes=T
+00022d70: 7275 652e 5c6e 220a 2020 2020 2020 2020  rue.\n".        
+00022d80: 2020 2020 2020 2020 2220 2032 2e20 436f          "  2. Co
+00022d90: 6d70 7574 6520 7368 6170 6573 2077 6974  mpute shapes wit
+00022da0: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
+00022db0: 2020 2020 225b 782e 636f 6d70 7574 655f      "[x.compute_
+00022dc0: 6368 756e 6b5f 7369 7a65 7328 2920 666f  chunk_sizes() fo
+00022dd0: 7220 7820 696e 2073 6571 5d22 2025 2073  r x in seq]" % s
+00022de0: 7472 2873 6571 325b 305d 2e73 6861 7065  tr(seq2[0].shape
+00022df0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00022e00: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00022e10: 6c75 6545 7272 6f72 2822 5368 6170 6573  lueError("Shapes
+00022e20: 2064 6f20 6e6f 7420 616c 6967 6e3a 2025   do not align: %
+00022e30: 7322 2c20 5b78 2e73 6861 7065 2066 6f72  s", [x.shape for
+00022e40: 2078 2069 6e20 7365 7132 5d29 0a0a 2020   x in seq2])..  
+00022e50: 2020 696e 6473 203d 205b 6c69 7374 2872    inds = [list(r
+00022e60: 616e 6765 286e 6469 6d29 2920 666f 7220  ange(ndim)) for 
+00022e70: 6920 696e 2072 616e 6765 286e 295d 0a20  i in range(n)]. 
+00022e80: 2020 2066 6f72 2069 2c20 696e 6420 696e     for i, ind in
+00022e90: 2065 6e75 6d65 7261 7465 2869 6e64 7329   enumerate(inds)
+00022ea0: 3a0a 2020 2020 2020 2020 696e 645b 6178  :.        ind[ax
+00022eb0: 6973 5d20 3d20 2d28 6920 2b20 3129 0a0a  is] = -(i + 1)..
+00022ec0: 2020 2020 7563 5f61 7267 7320 3d20 6c69      uc_args = li
+00022ed0: 7374 2863 6f6e 6361 7428 7a69 7028 7365  st(concat(zip(se
+00022ee0: 7132 2c20 696e 6473 2929 290a 2020 2020  q2, inds))).    
+00022ef0: 5f2c 2073 6571 3220 3d20 756e 6966 795f  _, seq2 = unify_
+00022f00: 6368 756e 6b73 282a 7563 5f61 7267 732c  chunks(*uc_args,
+00022f10: 2077 6172 6e3d 4661 6c73 6529 0a0a 2020   warn=False)..  
+00022f20: 2020 6264 7320 3d20 5b61 2e63 6875 6e6b    bds = [a.chunk
+00022f30: 7320 666f 7220 6120 696e 2073 6571 325d  s for a in seq2]
+00022f40: 0a0a 2020 2020 6368 756e 6b73 203d 2028  ..    chunks = (
+00022f50: 0a20 2020 2020 2020 2073 6571 325b 305d  .        seq2[0]
+00022f60: 2e63 6875 6e6b 735b 3a61 7869 735d 0a20  .chunks[:axis]. 
+00022f70: 2020 2020 2020 202b 2028 7375 6d28 2862         + (sum((b
+00022f80: 645b 6178 6973 5d20 666f 7220 6264 2069  d[axis] for bd i
+00022f90: 6e20 6264 7329 2c20 2829 292c 290a 2020  n bds), ()),).  
+00022fa0: 2020 2020 2020 2b20 7365 7132 5b30 5d2e        + seq2[0].
+00022fb0: 6368 756e 6b73 5b61 7869 7320 2b20 3120  chunks[axis + 1 
+00022fc0: 3a5d 0a20 2020 2029 0a0a 2020 2020 6375  :].    )..    cu
+00022fd0: 6d5f 6469 6d73 203d 205b 305d 202b 206c  m_dims = [0] + l
+00022fe0: 6973 7428 6163 6375 6d75 6c61 7465 2861  ist(accumulate(a
+00022ff0: 6464 2c20 5b6c 656e 2861 2e63 6875 6e6b  dd, [len(a.chunk
+00023000: 735b 6178 6973 5d29 2066 6f72 2061 2069  s[axis]) for a i
+00023010: 6e20 7365 7132 5d29 290a 0a20 2020 206e  n seq2]))..    n
+00023020: 616d 6573 203d 205b 612e 6e61 6d65 2066  ames = [a.name f
+00023030: 6f72 2061 2069 6e20 7365 7132 5d0a 0a20  or a in seq2].. 
+00023040: 2020 206e 616d 6520 3d20 2263 6f6e 6361     name = "conca
+00023050: 7465 6e61 7465 2d22 202b 2074 6f6b 656e  tenate-" + token
+00023060: 697a 6528 6e61 6d65 732c 2061 7869 7329  ize(names, axis)
+00023070: 0a20 2020 206b 6579 7320 3d20 6c69 7374  .    keys = list
+00023080: 2870 726f 6475 6374 285b 6e61 6d65 5d2c  (product([name],
+00023090: 202a 5b72 616e 6765 286c 656e 2862 6429   *[range(len(bd)
+000230a0: 2920 666f 7220 6264 2069 6e20 6368 756e  ) for bd in chun
+000230b0: 6b73 5d29 290a 0a20 2020 2076 616c 7565  ks]))..    value
+000230c0: 7320 3d20 5b0a 2020 2020 2020 2020 286e  s = [.        (n
+000230d0: 616d 6573 5b62 6973 6563 7428 6375 6d5f  ames[bisect(cum_
+000230e0: 6469 6d73 2c20 6b65 795b 6178 6973 202b  dims, key[axis +
+000230f0: 2031 5d29 202d 2031 5d2c 290a 2020 2020   1]) - 1],).    
+00023100: 2020 2020 2b20 6b65 795b 3120 3a20 6178      + key[1 : ax
+00023110: 6973 202b 2031 5d0a 2020 2020 2020 2020  is + 1].        
+00023120: 2b20 286b 6579 5b61 7869 7320 2b20 315d  + (key[axis + 1]
+00023130: 202d 2063 756d 5f64 696d 735b 6269 7365   - cum_dims[bise
+00023140: 6374 2863 756d 5f64 696d 732c 206b 6579  ct(cum_dims, key
+00023150: 5b61 7869 7320 2b20 315d 2920 2d20 315d  [axis + 1]) - 1]
+00023160: 2c29 0a20 2020 2020 2020 202b 206b 6579  ,).        + key
+00023170: 5b61 7869 7320 2b20 3220 3a5d 0a20 2020  [axis + 2 :].   
+00023180: 2020 2020 2066 6f72 206b 6579 2069 6e20       for key in 
+00023190: 6b65 7973 0a20 2020 205d 0a0a 2020 2020  keys.    ]..    
+000231a0: 6473 6b20 3d20 6469 6374 287a 6970 286b  dsk = dict(zip(k
+000231b0: 6579 732c 2076 616c 7565 7329 290a 2020  eys, values)).  
+000231c0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+000231d0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+000231e0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+000231f0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+00023200: 733d 7365 7132 290a 0a20 2020 2072 6574  s=seq2)..    ret
+00023210: 7572 6e20 4172 7261 7928 6772 6170 682c  urn Array(graph,
+00023220: 206e 616d 652c 2063 6875 6e6b 732c 206d   name, chunks, m
+00023230: 6574 613d 6d65 7461 290a 0a0a 6465 6620  eta=meta)...def 
+00023240: 6c6f 6164 5f73 746f 7265 5f63 6875 6e6b  load_store_chunk
+00023250: 280a 2020 2020 783a 2041 6e79 2c0a 2020  (.    x: Any,.  
+00023260: 2020 6f75 743a 2041 6e79 2c0a 2020 2020    out: Any,.    
+00023270: 696e 6465 783a 2073 6c69 6365 2c0a 2020  index: slice,.  
+00023280: 2020 6c6f 636b 3a20 416e 792c 0a20 2020    lock: Any,.   
+00023290: 2072 6574 7572 6e5f 7374 6f72 6564 3a20   return_stored: 
+000232a0: 626f 6f6c 2c0a 2020 2020 6c6f 6164 5f73  bool,.    load_s
+000232b0: 746f 7265 643a 2062 6f6f 6c2c 0a29 3a0a  tored: bool,.):.
+000232c0: 2020 2020 2222 220a 2020 2020 4120 6675      """.    A fu
+000232d0: 6e63 7469 6f6e 2069 6e73 6572 7465 6420  nction inserted 
+000232e0: 696e 2061 2044 6173 6b20 6772 6170 6820  in a Dask graph 
+000232f0: 666f 7220 7374 6f72 696e 6720 6120 6368  for storing a ch
+00023300: 756e 6b2e 0a0a 2020 2020 5061 7261 6d65  unk...    Parame
+00023310: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00023320: 2d2d 2d0a 2020 2020 783a 2061 7272 6179  ---.    x: array
+00023330: 2d6c 696b 650a 2020 2020 2020 2020 416e  -like.        An
+00023340: 2061 7272 6179 2028 706f 7465 6e74 6961   array (potentia
+00023350: 6c6c 7920 6120 4e75 6d50 7920 6f6e 6529  lly a NumPy one)
+00023360: 0a20 2020 206f 7574 3a20 6172 7261 792d  .    out: array-
+00023370: 6c69 6b65 0a20 2020 2020 2020 2057 6865  like.        Whe
+00023380: 7265 2074 6f20 7374 6f72 6520 7265 7375  re to store resu
+00023390: 6c74 732e 0a20 2020 2069 6e64 6578 3a20  lts..    index: 
+000233a0: 736c 6963 652d 6c69 6b65 0a20 2020 2020  slice-like.     
+000233b0: 2020 2057 6865 7265 2074 6f20 7374 6f72     Where to stor
+000233c0: 6520 7265 7375 6c74 2066 726f 6d20 6060  e result from ``
+000233d0: 7860 6020 696e 2060 606f 7574 6060 2e0a  x`` in ``out``..
+000233e0: 2020 2020 6c6f 636b 3a20 4c6f 636b 2d6c      lock: Lock-l
+000233f0: 696b 6520 6f72 2046 616c 7365 0a20 2020  ike or False.   
+00023400: 2020 2020 204c 6f63 6b20 746f 2075 7365       Lock to use
+00023410: 2062 6566 6f72 6520 7772 6974 696e 6720   before writing 
+00023420: 746f 2060 606f 7574 6060 2e0a 2020 2020  to ``out``..    
+00023430: 7265 7475 726e 5f73 746f 7265 643a 2062  return_stored: b
+00023440: 6f6f 6c0a 2020 2020 2020 2020 5768 6574  ool.        Whet
+00023450: 6865 7220 746f 2072 6574 7572 6e20 6060  her to return ``
+00023460: 6f75 7460 602e 0a20 2020 206c 6f61 645f  out``..    load_
+00023470: 7374 6f72 6564 3a20 626f 6f6c 0a20 2020  stored: bool.   
+00023480: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+00023490: 7265 7475 726e 2074 6865 2061 7272 6179  return the array
+000234a0: 2073 746f 7265 6420 696e 2060 606f 7574   stored in ``out
+000234b0: 6060 2e0a 2020 2020 2020 2020 4967 6e6f  ``..        Igno
+000234c0: 7265 6420 6966 2060 6072 6574 7572 6e5f  red if ``return_
+000234d0: 7374 6f72 6564 6060 2069 7320 6e6f 7420  stored`` is not 
+000234e0: 6060 5472 7565 6060 2e0a 0a20 2020 2052  ``True``...    R
+000234f0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+00023500: 2d2d 0a0a 2020 2020 4966 2072 6574 7572  --..    If retur
+00023510: 6e5f 7374 6f72 6564 3d54 7275 6520 616e  n_stored=True an
+00023520: 6420 6c6f 6164 5f73 746f 7265 643d 4661  d load_stored=Fa
+00023530: 6c73 650a 2020 2020 2020 2020 6f75 740a  lse.        out.
+00023540: 2020 2020 4966 2072 6574 7572 6e5f 7374      If return_st
+00023550: 6f72 6564 3d54 7275 6520 616e 6420 6c6f  ored=True and lo
+00023560: 6164 5f73 746f 7265 643d 5472 7565 0a20  ad_stored=True. 
+00023570: 2020 2020 2020 206f 7574 5b69 6e64 6578         out[index
+00023580: 5d0a 2020 2020 4966 2072 6574 7572 6e5f  ].    If return_
+00023590: 7374 6f72 6564 3d46 616c 7365 2061 6e64  stored=False and
+000235a0: 2063 6f6d 7075 7465 3d46 616c 7365 0a20   compute=False. 
+000235b0: 2020 2020 2020 204e 6f6e 650a 0a20 2020         None..   
+000235c0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+000235d0: 2d2d 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20  ------..    >>> 
+000235e0: 6120 3d20 6e70 2e6f 6e65 7328 2835 2c20  a = np.ones((5, 
+000235f0: 3629 290a 2020 2020 3e3e 3e20 6220 3d20  6)).    >>> b = 
+00023600: 6e70 2e65 6d70 7479 2861 2e73 6861 7065  np.empty(a.shape
+00023610: 290a 2020 2020 3e3e 3e20 6c6f 6164 5f73  ).    >>> load_s
+00023620: 746f 7265 5f63 6875 6e6b 2861 2c20 622c  tore_chunk(a, b,
+00023630: 2028 736c 6963 6528 4e6f 6e65 292c 2073   (slice(None), s
+00023640: 6c69 6365 284e 6f6e 6529 292c 2046 616c  lice(None)), Fal
+00023650: 7365 2c20 4661 6c73 652c 2046 616c 7365  se, False, False
+00023660: 290a 2020 2020 2222 220a 2020 2020 6966  ).    """.    if
+00023670: 206c 6f63 6b3a 0a20 2020 2020 2020 206c   lock:.        l
+00023680: 6f63 6b2e 6163 7175 6972 6528 290a 2020  ock.acquire().  
+00023690: 2020 7472 793a 0a20 2020 2020 2020 2069    try:.        i
+000236a0: 6620 7820 6973 206e 6f74 204e 6f6e 6520  f x is not None 
+000236b0: 616e 6420 782e 7369 7a65 2021 3d20 303a  and x.size != 0:
+000236c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000236d0: 6973 5f61 7272 6179 6c69 6b65 2878 293a  is_arraylike(x):
+000236e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000236f0: 206f 7574 5b69 6e64 6578 5d20 3d20 780a   out[index] = x.
+00023700: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00023710: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00023720: 2020 6f75 745b 696e 6465 785d 203d 206e    out[index] = n
+00023730: 702e 6173 616e 7961 7272 6179 2878 290a  p.asanyarray(x).
+00023740: 0a20 2020 2020 2020 2069 6620 7265 7475  .        if retu
+00023750: 726e 5f73 746f 7265 6420 616e 6420 6c6f  rn_stored and lo
+00023760: 6164 5f73 746f 7265 643a 0a20 2020 2020  ad_stored:.     
+00023770: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
+00023780: 745b 696e 6465 785d 0a20 2020 2020 2020  t[index].       
+00023790: 2065 6c69 6620 7265 7475 726e 5f73 746f   elif return_sto
+000237a0: 7265 6420 616e 6420 6e6f 7420 6c6f 6164  red and not load
+000237b0: 5f73 746f 7265 643a 0a20 2020 2020 2020  _stored:.       
+000237c0: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
+000237d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000237e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000237f0: 204e 6f6e 650a 2020 2020 6669 6e61 6c6c   None.    finall
+00023800: 793a 0a20 2020 2020 2020 2069 6620 6c6f  y:.        if lo
+00023810: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
+00023820: 6c6f 636b 2e72 656c 6561 7365 2829 0a0a  lock.release()..
+00023830: 0a64 6566 2073 746f 7265 5f63 6875 6e6b  .def store_chunk
+00023840: 280a 2020 2020 783a 2041 7272 6179 4c69  (.    x: ArrayLi
+00023850: 6b65 2c20 6f75 743a 2041 7272 6179 4c69  ke, out: ArrayLi
+00023860: 6b65 2c20 696e 6465 783a 2073 6c69 6365  ke, index: slice
+00023870: 2c20 6c6f 636b 3a20 416e 792c 2072 6574  , lock: Any, ret
+00023880: 7572 6e5f 7374 6f72 6564 3a20 626f 6f6c  urn_stored: bool
+00023890: 0a29 3a0a 2020 2020 7265 7475 726e 206c  .):.    return l
+000238a0: 6f61 645f 7374 6f72 655f 6368 756e 6b28  oad_store_chunk(
+000238b0: 782c 206f 7574 2c20 696e 6465 782c 206c  x, out, index, l
+000238c0: 6f63 6b2c 2072 6574 7572 6e5f 7374 6f72  ock, return_stor
+000238d0: 6564 2c20 4661 6c73 6529 0a0a 0a41 203d  ed, False)...A =
+000238e0: 2054 7970 6556 6172 2822 4122 2c20 626f   TypeVar("A", bo
+000238f0: 756e 643d 4172 7261 794c 696b 6529 0a0a  und=ArrayLike)..
+00023900: 0a64 6566 206c 6f61 645f 6368 756e 6b28  .def load_chunk(
+00023910: 6f75 743a 2041 2c20 696e 6465 783a 2073  out: A, index: s
+00023920: 6c69 6365 2c20 6c6f 636b 3a20 416e 7929  lice, lock: Any)
+00023930: 202d 3e20 413a 0a20 2020 2072 6574 7572   -> A:.    retur
+00023940: 6e20 6c6f 6164 5f73 746f 7265 5f63 6875  n load_store_chu
+00023950: 6e6b 284e 6f6e 652c 206f 7574 2c20 696e  nk(None, out, in
+00023960: 6465 782c 206c 6f63 6b2c 2054 7275 652c  dex, lock, True,
+00023970: 2054 7275 6529 0a0a 0a64 6566 2069 6e73   True)...def ins
+00023980: 6572 745f 746f 5f6f 6f63 280a 2020 2020  ert_to_ooc(.    
+00023990: 6b65 7973 3a20 6c69 7374 2c0a 2020 2020  keys: list,.    
+000239a0: 6368 756e 6b73 3a20 7475 706c 655b 7475  chunks: tuple[tu
+000239b0: 706c 655b 696e 742c 202e 2e2e 5d2c 202e  ple[int, ...], .
+000239c0: 2e2e 5d2c 0a20 2020 206f 7574 3a20 4172  ..],.    out: Ar
+000239d0: 7261 794c 696b 652c 0a20 2020 206e 616d  rayLike,.    nam
+000239e0: 653a 2073 7472 2c0a 2020 2020 2a2c 0a20  e: str,.    *,. 
+000239f0: 2020 206c 6f63 6b3a 204c 6f63 6b20 7c20     lock: Lock | 
+00023a00: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+00023a10: 2072 6567 696f 6e3a 2074 7570 6c65 5b73   region: tuple[s
+00023a20: 6c69 6365 2c20 2e2e 2e5d 207c 2073 6c69  lice, ...] | sli
+00023a30: 6365 207c 204e 6f6e 6520 3d20 4e6f 6e65  ce | None = None
+00023a40: 2c0a 2020 2020 7265 7475 726e 5f73 746f  ,.    return_sto
+00023a50: 7265 643a 2062 6f6f 6c20 3d20 4661 6c73  red: bool = Fals
+00023a60: 652c 0a20 2020 206c 6f61 645f 7374 6f72  e,.    load_stor
+00023a70: 6564 3a20 626f 6f6c 203d 2046 616c 7365  ed: bool = False
+00023a80: 2c0a 2920 2d3e 2064 6963 743a 0a20 2020  ,.) -> dict:.   
+00023a90: 2022 2222 0a20 2020 2043 7265 6174 6573   """.    Creates
+00023aa0: 2061 2044 6173 6b20 6772 6170 6820 666f   a Dask graph fo
+00023ab0: 7220 7374 6f72 696e 6720 6368 756e 6b73  r storing chunks
+00023ac0: 2066 726f 6d20 6060 6172 7260 6020 696e   from ``arr`` in
+00023ad0: 2060 606f 7574 6060 2e0a 0a20 2020 2050   ``out``...    P
+00023ae0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00023af0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 206b 6579  --------.    key
+00023b00: 733a 206c 6973 740a 2020 2020 2020 2020  s: list.        
+00023b10: 4461 736b 206b 6579 7320 6f66 2074 6865  Dask keys of the
+00023b20: 2069 6e70 7574 2061 7272 6179 0a20 2020   input array.   
+00023b30: 2063 6875 6e6b 733a 2074 7570 6c65 0a20   chunks: tuple. 
+00023b40: 2020 2020 2020 2044 6173 6b20 6368 756e         Dask chun
+00023b50: 6b73 206f 6620 7468 6520 696e 7075 7420  ks of the input 
+00023b60: 6172 7261 790a 2020 2020 6f75 743a 2061  array.    out: a
+00023b70: 7272 6179 2d6c 696b 650a 2020 2020 2020  rray-like.      
+00023b80: 2020 5768 6572 6520 746f 2073 746f 7265    Where to store
+00023b90: 2072 6573 756c 7473 2074 6f0a 2020 2020   results to.    
+00023ba0: 6e61 6d65 3a20 7374 720a 2020 2020 2020  name: str.      
+00023bb0: 2020 4669 7273 7420 656c 656d 656e 7420    First element 
+00023bc0: 6f66 2064 6173 6b20 6b65 7973 0a20 2020  of dask keys.   
+00023bd0: 206c 6f63 6b3a 204c 6f63 6b2d 6c69 6b65   lock: Lock-like
+00023be0: 206f 7220 626f 6f6c 2c20 6f70 7469 6f6e   or bool, option
+00023bf0: 616c 0a20 2020 2020 2020 2057 6865 7468  al.        Wheth
+00023c00: 6572 2074 6f20 6c6f 636b 206f 7220 7769  er to lock or wi
+00023c10: 7468 2077 6861 7420 2864 6566 6175 6c74  th what (default
+00023c20: 2069 7320 6060 5472 7565 6060 2c0a 2020   is ``True``,.  
+00023c30: 2020 2020 2020 7768 6963 6820 6d65 616e        which mean
+00023c40: 7320 6120 3a63 6c61 7373 3a60 7468 7265  s a :class:`thre
+00023c50: 6164 696e 672e 4c6f 636b 6020 696e 7374  ading.Lock` inst
+00023c60: 616e 6365 292e 0a20 2020 2072 6567 696f  ance)..    regio
+00023c70: 6e3a 2073 6c69 6365 2d6c 696b 652c 206f  n: slice-like, o
+00023c80: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00023c90: 5768 6572 6520 696e 2060 606f 7574 6060  Where in ``out``
+00023ca0: 2074 6f20 7374 6f72 6520 6060 6172 7260   to store ``arr`
+00023cb0: 6027 7320 7265 7375 6c74 730a 2020 2020  `'s results.    
+00023cc0: 2020 2020 2864 6566 6175 6c74 2069 7320      (default is 
+00023cd0: 6060 4e6f 6e65 6060 2c20 6d65 616e 696e  ``None``, meanin
+00023ce0: 6720 616c 6c20 6f66 2060 606f 7574 6060  g all of ``out``
+00023cf0: 292e 0a20 2020 2072 6574 7572 6e5f 7374  )..    return_st
+00023d00: 6f72 6564 3a20 626f 6f6c 2c20 6f70 7469  ored: bool, opti
+00023d10: 6f6e 616c 0a20 2020 2020 2020 2057 6865  onal.        Whe
+00023d20: 7468 6572 2074 6f20 7265 7475 726e 2060  ther to return `
+00023d30: 606f 7574 6060 0a20 2020 2020 2020 2028  `out``.        (
+00023d40: 6465 6661 756c 7420 6973 2060 6046 616c  default is ``Fal
+00023d50: 7365 6060 2c20 6d65 616e 696e 6720 6060  se``, meaning ``
+00023d60: 4e6f 6e65 6060 2069 7320 7265 7475 726e  None`` is return
+00023d70: 6564 292e 0a20 2020 206c 6f61 645f 7374  ed)..    load_st
+00023d80: 6f72 6564 3a20 626f 6f6c 2c20 6f70 7469  ored: bool, opti
+00023d90: 6f6e 616c 0a20 2020 2020 2020 2057 6865  onal.        Whe
+00023da0: 7468 6572 2074 6f20 6861 6e64 6c69 6e67  ther to handling
+00023db0: 206c 6f61 6469 6e67 2066 726f 6d20 6060   loading from ``
+00023dc0: 6f75 7460 6020 6174 2074 6865 2073 616d  out`` at the sam
+00023dd0: 6520 7469 6d65 2e0a 2020 2020 2020 2020  e time..        
+00023de0: 4967 6e6f 7265 6420 6966 2060 6072 6574  Ignored if ``ret
+00023df0: 7572 6e5f 7374 6f72 6564 6060 2069 7320  urn_stored`` is 
+00023e00: 6e6f 7420 6060 5472 7565 6060 2e0a 2020  not ``True``..  
+00023e10: 2020 2020 2020 2864 6566 6175 6c74 2069        (default i
+00023e20: 7320 6060 4661 6c73 6560 602c 206d 6561  s ``False``, mea
+00023e30: 6e69 6e67 2064 6566 6572 2074 6f20 6060  ning defer to ``
+00023e40: 7265 7475 726e 5f73 746f 7265 6460 6029  return_stored``)
+00023e50: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
+00023e60: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
+00023e70: 6173 6b20 6772 6170 6820 6f66 2073 746f  ask graph of sto
+00023e80: 7265 206f 7065 7261 7469 6f6e 0a0a 2020  re operation..  
+00023e90: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
+00023ea0: 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20  -------.    >>> 
+00023eb0: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
+00023ec0: 7920 6173 2064 610a 2020 2020 3e3e 3e20  y as da.    >>> 
+00023ed0: 6420 3d20 6461 2e6f 6e65 7328 2835 2c20  d = da.ones((5, 
+00023ee0: 3629 2c20 6368 756e 6b73 3d28 322c 2033  6), chunks=(2, 3
+00023ef0: 2929 0a20 2020 203e 3e3e 2061 203d 206e  )).    >>> a = n
+00023f00: 702e 656d 7074 7928 642e 7368 6170 6529  p.empty(d.shape)
+00023f10: 0a20 2020 203e 3e3e 2069 6e73 6572 745f  .    >>> insert_
+00023f20: 746f 5f6f 6f63 2864 2e5f 5f64 6173 6b5f  to_ooc(d.__dask_
+00023f30: 6b65 7973 5f5f 2829 2c20 642e 6368 756e  keys__(), d.chun
+00023f40: 6b73 2c20 612c 2022 7374 6f72 652d 3132  ks, a, "store-12
+00023f50: 3322 2920 2023 2064 6f63 7465 7374 3a20  3")  # doctest: 
+00023f60: 2b53 4b49 500a 2020 2020 2222 220a 0a20  +SKIP.    """.. 
+00023f70: 2020 2069 6620 6c6f 636b 2069 7320 5472     if lock is Tr
+00023f80: 7565 3a0a 2020 2020 2020 2020 6c6f 636b  ue:.        lock
+00023f90: 203d 204c 6f63 6b28 290a 0a20 2020 2073   = Lock()..    s
+00023fa0: 6c69 6365 7320 3d20 736c 6963 6573 5f66  lices = slices_f
+00023fb0: 726f 6d5f 6368 756e 6b73 2863 6875 6e6b  rom_chunks(chunk
+00023fc0: 7329 0a20 2020 2069 6620 7265 6769 6f6e  s).    if region
+00023fd0: 3a0a 2020 2020 2020 2020 736c 6963 6573  :.        slices
+00023fe0: 203d 205b 6675 7365 5f73 6c69 6365 2872   = [fuse_slice(r
+00023ff0: 6567 696f 6e2c 2073 6c63 2920 666f 7220  egion, slc) for 
+00024000: 736c 6320 696e 2073 6c69 6365 735d 0a0a  slc in slices]..
+00024010: 2020 2020 6966 2072 6574 7572 6e5f 7374      if return_st
+00024020: 6f72 6564 2061 6e64 206c 6f61 645f 7374  ored and load_st
+00024030: 6f72 6564 3a0a 2020 2020 2020 2020 6675  ored:.        fu
+00024040: 6e63 203d 206c 6f61 645f 7374 6f72 655f  nc = load_store_
+00024050: 6368 756e 6b0a 2020 2020 2020 2020 6172  chunk.        ar
+00024060: 6773 203d 2028 6c6f 6164 5f73 746f 7265  gs = (load_store
+00024070: 642c 290a 2020 2020 656c 7365 3a0a 2020  d,).    else:.  
+00024080: 2020 2020 2020 6675 6e63 203d 2073 746f        func = sto
+00024090: 7265 5f63 6875 6e6b 2020 2320 7479 7065  re_chunk  # type
+000240a0: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
+000240b0: 2061 7267 7320 3d20 2829 2020 2320 7479   args = ()  # ty
+000240c0: 7065 3a20 6967 6e6f 7265 0a0a 2020 2020  pe: ignore..    
+000240d0: 6473 6b20 3d20 7b0a 2020 2020 2020 2020  dsk = {.        
+000240e0: 286e 616d 652c 2920 2b20 745b 313a 5d3a  (name,) + t[1:]:
+000240f0: 2028 6675 6e63 2c20 742c 206f 7574 2c20   (func, t, out, 
+00024100: 736c 632c 206c 6f63 6b2c 2072 6574 7572  slc, lock, retur
+00024110: 6e5f 7374 6f72 6564 2920 2b20 6172 6773  n_stored) + args
+00024120: 0a20 2020 2020 2020 2066 6f72 2074 2c20  .        for t, 
+00024130: 736c 6320 696e 207a 6970 2863 6f72 652e  slc in zip(core.
+00024140: 666c 6174 7465 6e28 6b65 7973 292c 2073  flatten(keys), s
+00024150: 6c69 6365 7329 0a20 2020 207d 0a20 2020  lices).    }.   
+00024160: 2072 6574 7572 6e20 6473 6b0a 0a0a 6465   return dsk...de
+00024170: 6620 7265 7472 6965 7665 5f66 726f 6d5f  f retrieve_from_
+00024180: 6f6f 6328 0a20 2020 206b 6579 733a 2043  ooc(.    keys: C
+00024190: 6f6c 6c65 6374 696f 6e5b 4b65 795d 2c20  ollection[Key], 
+000241a0: 6473 6b5f 7072 653a 2047 7261 7068 2c20  dsk_pre: Graph, 
+000241b0: 6473 6b5f 706f 7374 3a20 4772 6170 680a  dsk_post: Graph.
+000241c0: 2920 2d3e 2064 6963 745b 7475 706c 652c  ) -> dict[tuple,
+000241d0: 2041 6e79 5d3a 0a20 2020 2022 2222 0a20   Any]:.    """. 
+000241e0: 2020 2043 7265 6174 6573 2061 2044 6173     Creates a Das
+000241f0: 6b20 6772 6170 6820 666f 7220 6c6f 6164  k graph for load
+00024200: 696e 6720 7374 6f72 6564 2060 606b 6579  ing stored ``key
+00024210: 7360 6020 6672 6f6d 2060 6064 736b 6060  s`` from ``dsk``
+00024220: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00024230: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00024240: 0a20 2020 206b 6579 733a 2043 6f6c 6c65  .    keys: Colle
+00024250: 6374 696f 6e0a 2020 2020 2020 2020 4120  ction.        A 
+00024260: 7365 7175 656e 6365 2063 6f6e 7461 696e  sequence contain
+00024270: 696e 6720 4461 736b 2067 7261 7068 206b  ing Dask graph k
+00024280: 6579 7320 746f 206c 6f61 640a 2020 2020  eys to load.    
+00024290: 6473 6b5f 7072 653a 204d 6170 7069 6e67  dsk_pre: Mapping
+000242a0: 0a20 2020 2020 2020 2041 2044 6173 6b20  .        A Dask 
+000242b0: 6772 6170 6820 636f 7272 6573 706f 6e64  graph correspond
+000242c0: 696e 6720 746f 2061 2044 6173 6b20 4172  ing to a Dask Ar
+000242d0: 7261 7920 6265 666f 7265 2063 6f6d 7075  ray before compu
+000242e0: 7461 7469 6f6e 0a20 2020 2064 736b 5f70  tation.    dsk_p
+000242f0: 6f73 743a 204d 6170 7069 6e67 0a20 2020  ost: Mapping.   
+00024300: 2020 2020 2041 2044 6173 6b20 6772 6170       A Dask grap
+00024310: 6820 636f 7272 6573 706f 6e64 696e 6720  h corresponding 
+00024320: 746f 2061 2044 6173 6b20 4172 7261 7920  to a Dask Array 
+00024330: 6166 7465 7220 636f 6d70 7574 6174 696f  after computatio
+00024340: 6e0a 0a20 2020 2045 7861 6d70 6c65 730a  n..    Examples.
+00024350: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00024360: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
+00024370: 2e61 7272 6179 2061 7320 6461 0a20 2020  .array as da.   
+00024380: 203e 3e3e 2064 203d 2064 612e 6f6e 6573   >>> d = da.ones
+00024390: 2828 352c 2036 292c 2063 6875 6e6b 733d  ((5, 6), chunks=
+000243a0: 2832 2c20 3329 290a 2020 2020 3e3e 3e20  (2, 3)).    >>> 
+000243b0: 6120 3d20 6e70 2e65 6d70 7479 2864 2e73  a = np.empty(d.s
+000243c0: 6861 7065 290a 2020 2020 3e3e 3e20 6720  hape).    >>> g 
+000243d0: 3d20 696e 7365 7274 5f74 6f5f 6f6f 6328  = insert_to_ooc(
+000243e0: 642e 5f5f 6461 736b 5f6b 6579 735f 5f28  d.__dask_keys__(
+000243f0: 292c 2064 2e63 6875 6e6b 732c 2061 2c20  ), d.chunks, a, 
+00024400: 2273 746f 7265 2d31 3233 2229 0a20 2020  "store-123").   
+00024410: 203e 3e3e 2072 6574 7269 6576 655f 6672   >>> retrieve_fr
+00024420: 6f6d 5f6f 6f63 2867 2e6b 6579 7328 292c  om_ooc(g.keys(),
+00024430: 2067 2c20 7b6b 3a20 6b20 666f 7220 6b20   g, {k: k for k 
+00024440: 696e 2067 2e6b 6579 7328 297d 2920 2023  in g.keys()})  #
+00024450: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+00024460: 2020 2020 2222 220a 2020 2020 6c6f 6164      """.    load
+00024470: 5f64 736b 203d 207b 0a20 2020 2020 2020  _dsk = {.       
+00024480: 2028 226c 6f61 642d 2220 2b20 6b5b 305d   ("load-" + k[0]
+00024490: 2c29 202b 206b 5b31 3a5d 3a20 286c 6f61  ,) + k[1:]: (loa
+000244a0: 645f 6368 756e 6b2c 2064 736b 5f70 6f73  d_chunk, dsk_pos
+000244b0: 745b 6b5d 2920 2b20 6473 6b5f 7072 655b  t[k]) + dsk_pre[
+000244c0: 6b5d 5b33 3a2d 315d 2020 2320 7479 7065  k][3:-1]  # type
+000244d0: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
+000244e0: 2066 6f72 206b 2069 6e20 6b65 7973 0a20   for k in keys. 
+000244f0: 2020 207d 0a0a 2020 2020 7265 7475 726e     }..    return
+00024500: 206c 6f61 645f 6473 6b0a 0a0a 6465 6620   load_dsk...def 
+00024510: 6173 6172 7261 7928 0a20 2020 2061 2c20  asarray(.    a, 
+00024520: 616c 6c6f 775f 756e 6b6e 6f77 6e5f 6368  allow_unknown_ch
+00024530: 756e 6b73 697a 6573 3d46 616c 7365 2c20  unksizes=False, 
+00024540: 6474 7970 653d 4e6f 6e65 2c20 6f72 6465  dtype=None, orde
+00024550: 723d 4e6f 6e65 2c20 2a2c 206c 696b 653d  r=None, *, like=
+00024560: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 0a29  None, **kwargs.)
+00024570: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
+00024580: 2074 6865 2069 6e70 7574 2074 6f20 6120   the input to a 
+00024590: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
+000245a0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000245b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2061  ----------.    a
+000245c0: 203a 2061 7272 6179 2d6c 696b 650a 2020   : array-like.  
+000245d0: 2020 2020 2020 496e 7075 7420 6461 7461        Input data
+000245e0: 2c20 696e 2061 6e79 2066 6f72 6d20 7468  , in any form th
+000245f0: 6174 2063 616e 2062 6520 636f 6e76 6572  at can be conver
+00024600: 7465 6420 746f 2061 2064 6173 6b20 6172  ted to a dask ar
+00024610: 7261 792e 2054 6869 730a 2020 2020 2020  ray. This.      
+00024620: 2020 696e 636c 7564 6573 206c 6973 7473    includes lists
+00024630: 2c20 6c69 7374 7320 6f66 2074 7570 6c65  , lists of tuple
+00024640: 732c 2074 7570 6c65 732c 2074 7570 6c65  s, tuples, tuple
+00024650: 7320 6f66 2074 7570 6c65 732c 2074 7570  s of tuples, tup
+00024660: 6c65 7320 6f66 0a20 2020 2020 2020 206c  les of.        l
+00024670: 6973 7473 2061 6e64 206e 6461 7272 6179  ists and ndarray
+00024680: 732e 0a20 2020 2061 6c6c 6f77 5f75 6e6b  s..    allow_unk
+00024690: 6e6f 776e 5f63 6875 6e6b 7369 7a65 733a  nown_chunksizes:
+000246a0: 2062 6f6f 6c0a 2020 2020 2020 2020 416c   bool.        Al
+000246b0: 6c6f 7720 756e 6b6e 6f77 6e20 6368 756e  low unknown chun
+000246c0: 6b73 697a 6573 2c20 7375 6368 2061 7320  ksizes, such as 
+000246d0: 636f 6d65 2066 726f 6d20 636f 6e76 6572  come from conver
+000246e0: 7469 6e67 2066 726f 6d20 6461 736b 0a20  ting from dask. 
+000246f0: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
+00024700: 732e 2020 4461 736b 2e61 7272 6179 2069  s.  Dask.array i
+00024710: 7320 756e 6162 6c65 2074 6f20 7665 7269  s unable to veri
+00024720: 6679 2074 6861 7420 6368 756e 6b73 206c  fy that chunks l
+00024730: 696e 6520 7570 2e20 2049 660a 2020 2020  ine up.  If.    
+00024740: 2020 2020 6461 7461 2063 6f6d 6573 2066      data comes f
+00024750: 726f 6d20 6469 6666 6572 656e 746c 7920  rom differently 
+00024760: 616c 6967 6e65 6420 736f 7572 6365 7320  aligned sources 
+00024770: 7468 656e 2074 6869 7320 6361 6e20 6361  then this can ca
+00024780: 7573 650a 2020 2020 2020 2020 756e 6578  use.        unex
+00024790: 7065 6374 6564 2072 6573 756c 7473 2e0a  pected results..
+000247a0: 2020 2020 6474 7970 6520 3a20 6461 7461      dtype : data
+000247b0: 2d74 7970 652c 206f 7074 696f 6e61 6c0a  -type, optional.
+000247c0: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
+000247d0: 6c74 2c20 7468 6520 6461 7461 2d74 7970  lt, the data-typ
+000247e0: 6520 6973 2069 6e66 6572 7265 6420 6672  e is inferred fr
+000247f0: 6f6d 2074 6865 2069 6e70 7574 2064 6174  om the input dat
+00024800: 612e 0a20 2020 206f 7264 6572 203a 207b  a..    order : {
+00024810: e280 9843 e280 992c 20e2 8098 46e2 8099  ...C..., ...F...
+00024820: 2c20 e280 9841 e280 992c 20e2 8098 4be2  , ...A..., ...K.
+00024830: 8099 7d2c 206f 7074 696f 6e61 6c0a 2020  ..}, optional.  
+00024840: 2020 2020 2020 4d65 6d6f 7279 206c 6179        Memory lay
+00024850: 6f75 742e 20e2 8098 41e2 8099 2061 6e64  out. ...A... and
+00024860: 20e2 8098 4be2 8099 2064 6570 656e 6420   ...K... depend 
+00024870: 6f6e 2074 6865 206f 7264 6572 206f 6620  on the order of 
+00024880: 696e 7075 7420 6172 7261 7920 612e 0a20  input array a.. 
+00024890: 2020 2020 2020 20e2 8098 43e2 8099 2072         ...C... r
+000248a0: 6f77 2d6d 616a 6f72 2028 432d 7374 796c  ow-major (C-styl
+000248b0: 6529 2c20 e280 9846 e280 9920 636f 6c75  e), ...F... colu
+000248c0: 6d6e 2d6d 616a 6f72 2028 466f 7274 7261  mn-major (Fortra
+000248d0: 6e2d 7374 796c 6529 206d 656d 6f72 790a  n-style) memory.
+000248e0: 2020 2020 2020 2020 7265 7072 6573 656e          represen
+000248f0: 7461 7469 6f6e 2e20 e280 9841 e280 9920  tation. ...A... 
+00024900: 2861 6e79 2920 6d65 616e 7320 e280 9846  (any) means ...F
+00024910: e280 9920 6966 2061 2069 7320 466f 7274  ... if a is Fort
+00024920: 7261 6e20 636f 6e74 6967 756f 7573 2c20  ran contiguous, 
+00024930: e280 9843 e280 990a 2020 2020 2020 2020  ...C....        
+00024940: 6f74 6865 7277 6973 6520 e280 984b e280  otherwise ...K..
+00024950: 9920 286b 6565 7029 2070 7265 7365 7276  . (keep) preserv
+00024960: 6520 696e 7075 7420 6f72 6465 722e 2044  e input order. D
+00024970: 6566 6175 6c74 7320 746f 20e2 8098 43e2  efaults to ...C.
+00024980: 8099 2e0a 2020 2020 6c69 6b65 3a20 6172  ....    like: ar
+00024990: 7261 792d 6c69 6b65 0a20 2020 2020 2020  ray-like.       
+000249a0: 2052 6566 6572 656e 6365 206f 626a 6563   Reference objec
+000249b0: 7420 746f 2061 6c6c 6f77 2074 6865 2063  t to allow the c
+000249c0: 7265 6174 696f 6e20 6f66 2044 6173 6b20  reation of Dask 
+000249d0: 6172 7261 7973 2077 6974 6820 6368 756e  arrays with chun
+000249e0: 6b73 0a20 2020 2020 2020 2074 6861 7420  ks.        that 
+000249f0: 6172 6520 6e6f 7420 4e75 6d50 7920 6172  are not NumPy ar
+00024a00: 7261 7973 2e20 4966 2061 6e20 6172 7261  rays. If an arra
+00024a10: 792d 6c69 6b65 2070 6173 7365 6420 696e  y-like passed in
+00024a20: 2061 7320 6060 6c69 6b65 6060 0a20 2020   as ``like``.   
+00024a30: 2020 2020 2073 7570 706f 7274 7320 7468       supports th
+00024a40: 6520 6060 5f5f 6172 7261 795f 6675 6e63  e ``__array_func
+00024a50: 7469 6f6e 5f5f 6060 2070 726f 746f 636f  tion__`` protoco
+00024a60: 6c2c 2074 6865 2063 6875 6e6b 2074 7970  l, the chunk typ
+00024a70: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
+00024a80: 2072 6573 756c 7469 6e67 2061 7272 6179   resulting array
+00024a90: 2077 696c 6c20 6265 2064 6566 696e 6564   will be defined
+00024aa0: 2062 7920 6974 2e20 496e 2074 6869 7320   by it. In this 
+00024ab0: 6361 7365 2c20 6974 2065 6e73 7572 6573  case, it ensures
+00024ac0: 2074 6865 0a20 2020 2020 2020 2063 7265   the.        cre
+00024ad0: 6174 696f 6e20 6f66 2061 2044 6173 6b20  ation of a Dask 
+00024ae0: 6172 7261 7920 636f 6d70 6174 6962 6c65  array compatible
+00024af0: 2077 6974 6820 7468 6174 2070 6173 7365   with that passe
+00024b00: 6420 696e 2076 6961 2074 6869 730a 2020  d in via this.  
+00024b10: 2020 2020 2020 6172 6775 6d65 6e74 2e20        argument. 
+00024b20: 4966 2060 606c 696b 6560 6020 6973 2061  If ``like`` is a
+00024b30: 2044 6173 6b20 6172 7261 792c 2074 6865   Dask array, the
+00024b40: 2063 6875 6e6b 2074 7970 6520 6f66 2074   chunk type of t
+00024b50: 6865 0a20 2020 2020 2020 2072 6573 756c  he.        resul
+00024b60: 7469 6e67 2061 7272 6179 2077 696c 6c20  ting array will 
+00024b70: 6265 2064 6566 696e 6564 2062 7920 7468  be defined by th
+00024b80: 6520 6368 756e 6b20 7479 7065 206f 6620  e chunk type of 
+00024b90: 6060 6c69 6b65 6060 2e0a 2020 2020 2020  ``like``..      
+00024ba0: 2020 5265 7175 6972 6573 204e 756d 5079    Requires NumPy
+00024bb0: 2031 2e32 302e 3020 6f72 2068 6967 6865   1.20.0 or highe
+00024bc0: 722e 0a0a 2020 2020 5265 7475 726e 730a  r...    Returns.
+00024bd0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00024be0: 6f75 7420 3a20 6461 736b 2061 7272 6179  out : dask array
+00024bf0: 0a20 2020 2020 2020 2044 6173 6b20 6172  .        Dask ar
+00024c00: 7261 7920 696e 7465 7270 7265 7461 7469  ray interpretati
+00024c10: 6f6e 206f 6620 612e 0a0a 2020 2020 4578  on of a...    Ex
+00024c20: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+00024c30: 2d2d 2d0a 2020 2020 3e3e 3e20 696d 706f  ---.    >>> impo
+00024c40: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
+00024c50: 2064 610a 2020 2020 3e3e 3e20 696d 706f   da.    >>> impo
+00024c60: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
+00024c70: 2020 203e 3e3e 2078 203d 206e 702e 6172     >>> x = np.ar
+00024c80: 616e 6765 2833 290a 2020 2020 3e3e 3e20  ange(3).    >>> 
+00024c90: 6461 2e61 7361 7272 6179 2878 290a 2020  da.asarray(x).  
+00024ca0: 2020 6461 736b 2e61 7272 6179 3c61 7272    dask.array<arr
+00024cb0: 6179 2c20 7368 6170 653d 2833 2c29 2c20  ay, shape=(3,), 
+00024cc0: 6474 7970 653d 696e 7436 342c 2063 6875  dtype=int64, chu
+00024cd0: 6e6b 7369 7a65 3d28 332c 292c 2063 6875  nksize=(3,), chu
+00024ce0: 6e6b 7479 7065 3d6e 756d 7079 2e6e 6461  nktype=numpy.nda
+00024cf0: 7272 6179 3e0a 0a20 2020 203e 3e3e 2079  rray>..    >>> y
+00024d00: 203d 205b 5b31 2c20 322c 2033 5d2c 205b   = [[1, 2, 3], [
+00024d10: 342c 2035 2c20 365d 5d0a 2020 2020 3e3e  4, 5, 6]].    >>
+00024d20: 3e20 6461 2e61 7361 7272 6179 2879 290a  > da.asarray(y).
+00024d30: 2020 2020 6461 736b 2e61 7272 6179 3c61      dask.array<a
+00024d40: 7272 6179 2c20 7368 6170 653d 2832 2c20  rray, shape=(2, 
+00024d50: 3329 2c20 6474 7970 653d 696e 7436 342c  3), dtype=int64,
+00024d60: 2063 6875 6e6b 7369 7a65 3d28 322c 2033   chunksize=(2, 3
+00024d70: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
+00024d80: 7079 2e6e 6461 7272 6179 3e0a 2020 2020  py.ndarray>.    
+00024d90: 2222 220a 2020 2020 6966 206c 696b 6520  """.    if like 
+00024da0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00024db0: 2069 6620 6973 696e 7374 616e 6365 2861   if isinstance(a
+00024dc0: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
+00024dd0: 2020 2020 2020 7265 7475 726e 2061 0a20        return a. 
+00024de0: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
+00024df0: 7474 7228 612c 2022 746f 5f64 6173 6b5f  ttr(a, "to_dask_
+00024e00: 6172 7261 7922 293a 0a20 2020 2020 2020  array"):.       
+00024e10: 2020 2020 2072 6574 7572 6e20 612e 746f       return a.to
+00024e20: 5f64 6173 6b5f 6172 7261 7928 290a 2020  _dask_array().  
+00024e30: 2020 2020 2020 656c 6966 2074 7970 6528        elif type(
+00024e40: 6129 2e5f 5f6d 6f64 756c 655f 5f2e 7370  a).__module__.sp
+00024e50: 6c69 7428 222e 2229 5b30 5d20 3d3d 2022  lit(".")[0] == "
+00024e60: 7861 7272 6179 2220 616e 6420 6861 7361  xarray" and hasa
+00024e70: 7474 7228 612c 2022 6461 7461 2229 3a0a  ttr(a, "data"):.
+00024e80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00024e90: 726e 2061 7361 7272 6179 2861 2e64 6174  rn asarray(a.dat
+00024ea0: 6129 0a20 2020 2020 2020 2065 6c69 6620  a).        elif 
+00024eb0: 6973 696e 7374 616e 6365 2861 2c20 286c  isinstance(a, (l
+00024ec0: 6973 742c 2074 7570 6c65 2929 2061 6e64  ist, tuple)) and
+00024ed0: 2061 6e79 2869 7369 6e73 7461 6e63 6528   any(isinstance(
+00024ee0: 692c 2041 7272 6179 2920 666f 7220 6920  i, Array) for i 
+00024ef0: 696e 2061 293a 0a20 2020 2020 2020 2020  in a):.         
+00024f00: 2020 2072 6574 7572 6e20 7374 6163 6b28     return stack(
+00024f10: 612c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  a, allow_unknown
+00024f20: 5f63 6875 6e6b 7369 7a65 733d 616c 6c6f  _chunksizes=allo
+00024f30: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
+00024f40: 697a 6573 290a 2020 2020 2020 2020 656c  izes).        el
+00024f50: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00024f60: 6528 6765 7461 7474 7228 612c 2022 7368  e(getattr(a, "sh
+00024f70: 6170 6522 2c20 4e6f 6e65 292c 2049 7465  ape", None), Ite
+00024f80: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
+00024f90: 2020 2020 6120 3d20 6e70 2e61 7361 7272      a = np.asarr
+00024fa0: 6179 2861 2c20 6474 7970 653d 6474 7970  ay(a, dtype=dtyp
+00024fb0: 652c 206f 7264 6572 3d6f 7264 6572 290a  e, order=order).
+00024fc0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00024fd0: 2020 6c69 6b65 5f6d 6574 6120 3d20 6d65    like_meta = me
+00024fe0: 7461 5f66 726f 6d5f 6172 7261 7928 6c69  ta_from_array(li
+00024ff0: 6b65 290a 2020 2020 2020 2020 6966 2069  ke).        if i
+00025000: 7369 6e73 7461 6e63 6528 612c 2041 7272  sinstance(a, Arr
+00025010: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
+00025020: 2072 6574 7572 6e20 612e 6d61 705f 626c   return a.map_bl
+00025030: 6f63 6b73 286e 702e 6173 6172 7261 792c  ocks(np.asarray,
+00025040: 206c 696b 653d 6c69 6b65 5f6d 6574 612c   like=like_meta,
+00025050: 2064 7479 7065 3d64 7479 7065 2c20 6f72   dtype=dtype, or
+00025060: 6465 723d 6f72 6465 7229 0a20 2020 2020  der=order).     
+00025070: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00025080: 2020 2020 2061 203d 206e 702e 6173 6172       a = np.asar
+00025090: 7261 7928 612c 206c 696b 653d 6c69 6b65  ray(a, like=like
+000250a0: 5f6d 6574 612c 2064 7479 7065 3d64 7479  _meta, dtype=dty
+000250b0: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
+000250c0: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
+000250d0: 5f61 7272 6179 2861 2c20 6765 7469 7465  _array(a, getite
+000250e0: 6d3d 6765 7474 6572 5f69 6e6c 696e 652c  m=getter_inline,
+000250f0: 202a 2a6b 7761 7267 7329 0a0a 0a64 6566   **kwargs)...def
+00025100: 2061 7361 6e79 6172 7261 7928 612c 2064   asanyarray(a, d
+00025110: 7479 7065 3d4e 6f6e 652c 206f 7264 6572  type=None, order
+00025120: 3d4e 6f6e 652c 202a 2c20 6c69 6b65 3d4e  =None, *, like=N
+00025130: 6f6e 652c 2069 6e6c 696e 655f 6172 7261  one, inline_arra
+00025140: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
+00025150: 2243 6f6e 7665 7274 2074 6865 2069 6e70  "Convert the inp
+00025160: 7574 2074 6f20 6120 6461 736b 2061 7272  ut to a dask arr
+00025170: 6179 2e0a 0a20 2020 2053 7562 636c 6173  ay...    Subclas
+00025180: 7365 7320 6f66 2060 606e 702e 6e64 6172  ses of ``np.ndar
+00025190: 7261 7960 6020 7769 6c6c 2062 6520 7061  ray`` will be pa
+000251a0: 7373 6564 2074 6872 6f75 6768 2061 7320  ssed through as 
+000251b0: 6368 756e 6b73 2075 6e63 6861 6e67 6564  chunks unchanged
+000251c0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+000251d0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+000251e0: 0a20 2020 2061 203a 2061 7272 6179 2d6c  .    a : array-l
+000251f0: 696b 650a 2020 2020 2020 2020 496e 7075  ike.        Inpu
+00025200: 7420 6461 7461 2c20 696e 2061 6e79 2066  t data, in any f
+00025210: 6f72 6d20 7468 6174 2063 616e 2062 6520  orm that can be 
+00025220: 636f 6e76 6572 7465 6420 746f 2061 2064  converted to a d
+00025230: 6173 6b20 6172 7261 792e 2054 6869 730a  ask array. This.
+00025240: 2020 2020 2020 2020 696e 636c 7564 6573          includes
+00025250: 206c 6973 7473 2c20 6c69 7374 7320 6f66   lists, lists of
+00025260: 2074 7570 6c65 732c 2074 7570 6c65 732c   tuples, tuples,
+00025270: 2074 7570 6c65 7320 6f66 2074 7570 6c65   tuples of tuple
+00025280: 732c 2074 7570 6c65 7320 6f66 0a20 2020  s, tuples of.   
+00025290: 2020 2020 206c 6973 7473 2061 6e64 206e       lists and n
+000252a0: 6461 7272 6179 732e 0a20 2020 2064 7479  darrays..    dty
+000252b0: 7065 203a 2064 6174 612d 7479 7065 2c20  pe : data-type, 
+000252c0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000252d0: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
+000252e0: 2064 6174 612d 7479 7065 2069 7320 696e   data-type is in
+000252f0: 6665 7272 6564 2066 726f 6d20 7468 6520  ferred from the 
+00025300: 696e 7075 7420 6461 7461 2e0a 2020 2020  input data..    
+00025310: 6f72 6465 7220 3a20 7be2 8098 43e2 8099  order : {...C...
+00025320: 2c20 e280 9846 e280 992c 20e2 8098 41e2  , ...F..., ...A.
+00025330: 8099 2c20 e280 984b e280 997d 2c20 6f70  .., ...K...}, op
+00025340: 7469 6f6e 616c 0a20 2020 2020 2020 204d  tional.        M
+00025350: 656d 6f72 7920 6c61 796f 7574 2e20 e280  emory layout. ..
+00025360: 9841 e280 9920 616e 6420 e280 984b e280  .A... and ...K..
+00025370: 9920 6465 7065 6e64 206f 6e20 7468 6520  . depend on the 
+00025380: 6f72 6465 7220 6f66 2069 6e70 7574 2061  order of input a
+00025390: 7272 6179 2061 2e0a 2020 2020 2020 2020  rray a..        
+000253a0: e280 9843 e280 9920 726f 772d 6d61 6a6f  ...C... row-majo
+000253b0: 7220 2843 2d73 7479 6c65 292c 20e2 8098  r (C-style), ...
+000253c0: 46e2 8099 2063 6f6c 756d 6e2d 6d61 6a6f  F... column-majo
+000253d0: 7220 2846 6f72 7472 616e 2d73 7479 6c65  r (Fortran-style
+000253e0: 2920 6d65 6d6f 7279 0a20 2020 2020 2020  ) memory.       
+000253f0: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
+00025400: 20e2 8098 41e2 8099 2028 616e 7929 206d   ...A... (any) m
+00025410: 6561 6e73 20e2 8098 46e2 8099 2069 6620  eans ...F... if 
+00025420: 6120 6973 2046 6f72 7472 616e 2063 6f6e  a is Fortran con
+00025430: 7469 6775 6f75 732c 20e2 8098 43e2 8099  tiguous, ...C...
+00025440: 0a20 2020 2020 2020 206f 7468 6572 7769  .        otherwi
+00025450: 7365 20e2 8098 4be2 8099 2028 6b65 6570  se ...K... (keep
+00025460: 2920 7072 6573 6572 7665 2069 6e70 7574  ) preserve input
+00025470: 206f 7264 6572 2e20 4465 6661 756c 7473   order. Defaults
+00025480: 2074 6f20 e280 9843 e280 992e 0a20 2020   to ...C.....   
+00025490: 206c 696b 653a 2061 7272 6179 2d6c 696b   like: array-lik
+000254a0: 650a 2020 2020 2020 2020 5265 6665 7265  e.        Refere
+000254b0: 6e63 6520 6f62 6a65 6374 2074 6f20 616c  nce object to al
+000254c0: 6c6f 7720 7468 6520 6372 6561 7469 6f6e  low the creation
+000254d0: 206f 6620 4461 736b 2061 7272 6179 7320   of Dask arrays 
+000254e0: 7769 7468 2063 6875 6e6b 730a 2020 2020  with chunks.    
+000254f0: 2020 2020 7468 6174 2061 7265 206e 6f74      that are not
+00025500: 204e 756d 5079 2061 7272 6179 732e 2049   NumPy arrays. I
+00025510: 6620 616e 2061 7272 6179 2d6c 696b 6520  f an array-like 
+00025520: 7061 7373 6564 2069 6e20 6173 2060 606c  passed in as ``l
+00025530: 696b 6560 600a 2020 2020 2020 2020 7375  ike``.        su
+00025540: 7070 6f72 7473 2074 6865 2060 605f 5f61  pports the ``__a
+00025550: 7272 6179 5f66 756e 6374 696f 6e5f 5f60  rray_function__`
+00025560: 6020 7072 6f74 6f63 6f6c 2c20 7468 6520  ` protocol, the 
+00025570: 6368 756e 6b20 7479 7065 206f 6620 7468  chunk type of th
+00025580: 650a 2020 2020 2020 2020 7265 7375 6c74  e.        result
+00025590: 696e 6720 6172 7261 7920 7769 6c6c 2062  ing array will b
+000255a0: 6520 6465 6669 6e65 6420 6279 2069 742e  e defined by it.
+000255b0: 2049 6e20 7468 6973 2063 6173 652c 2069   In this case, i
+000255c0: 7420 656e 7375 7265 7320 7468 650a 2020  t ensures the.  
+000255d0: 2020 2020 2020 6372 6561 7469 6f6e 206f        creation o
+000255e0: 6620 6120 4461 736b 2061 7272 6179 2063  f a Dask array c
+000255f0: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
+00025600: 6861 7420 7061 7373 6564 2069 6e20 7669  hat passed in vi
+00025610: 6120 7468 6973 0a20 2020 2020 2020 2061  a this.        a
+00025620: 7267 756d 656e 742e 2049 6620 6060 6c69  rgument. If ``li
+00025630: 6b65 6060 2069 7320 6120 4461 736b 2061  ke`` is a Dask a
+00025640: 7272 6179 2c20 7468 6520 6368 756e 6b20  rray, the chunk 
+00025650: 7479 7065 206f 6620 7468 650a 2020 2020  type of the.    
+00025660: 2020 2020 7265 7375 6c74 696e 6720 6172      resulting ar
+00025670: 7261 7920 7769 6c6c 2062 6520 6465 6669  ray will be defi
+00025680: 6e65 6420 6279 2074 6865 2063 6875 6e6b  ned by the chunk
+00025690: 2074 7970 6520 6f66 2060 606c 696b 6560   type of ``like`
+000256a0: 602e 0a20 2020 2020 2020 2052 6571 7569  `..        Requi
+000256b0: 7265 7320 4e75 6d50 7920 312e 3230 2e30  res NumPy 1.20.0
+000256c0: 206f 7220 6869 6768 6572 2e0a 2020 2020   or higher..    
+000256d0: 696e 6c69 6e65 5f61 7272 6179 3a0a 2020  inline_array:.  
+000256e0: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+000256f0: 2069 6e6c 696e 6520 7468 6520 6172 7261   inline the arra
+00025700: 7920 696e 2074 6865 2072 6573 756c 7469  y in the resulti
+00025710: 6e67 2064 6173 6b20 6772 6170 682e 2046  ng dask graph. F
+00025720: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+00025730: 696f 6e2c 0a20 2020 2020 2020 2073 6565  ion,.        see
+00025740: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
+00025750: 6f6e 2066 6f72 2060 6064 6173 6b2e 6172  on for ``dask.ar
+00025760: 7261 792e 6672 6f6d 5f61 7272 6179 2829  ray.from_array()
+00025770: 6060 2e0a 0a20 2020 2052 6574 7572 6e73  ``...    Returns
+00025780: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00025790: 206f 7574 203a 2064 6173 6b20 6172 7261   out : dask arra
+000257a0: 790a 2020 2020 2020 2020 4461 736b 2061  y.        Dask a
+000257b0: 7272 6179 2069 6e74 6572 7072 6574 6174  rray interpretat
+000257c0: 696f 6e20 6f66 2061 2e0a 0a20 2020 2045  ion of a...    E
+000257d0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
+000257e0: 2d2d 2d2d 0a20 2020 203e 3e3e 2069 6d70  ----.    >>> imp
+000257f0: 6f72 7420 6461 736b 2e61 7272 6179 2061  ort dask.array a
+00025800: 7320 6461 0a20 2020 203e 3e3e 2069 6d70  s da.    >>> imp
+00025810: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
+00025820: 2020 2020 3e3e 3e20 7820 3d20 6e70 2e61      >>> x = np.a
+00025830: 7261 6e67 6528 3329 0a20 2020 203e 3e3e  range(3).    >>>
+00025840: 2064 612e 6173 616e 7961 7272 6179 2878   da.asanyarray(x
+00025850: 290a 2020 2020 6461 736b 2e61 7272 6179  ).    dask.array
+00025860: 3c61 7272 6179 2c20 7368 6170 653d 2833  <array, shape=(3
+00025870: 2c29 2c20 6474 7970 653d 696e 7436 342c  ,), dtype=int64,
+00025880: 2063 6875 6e6b 7369 7a65 3d28 332c 292c   chunksize=(3,),
+00025890: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
+000258a0: 2e6e 6461 7272 6179 3e0a 0a20 2020 203e  .ndarray>..    >
+000258b0: 3e3e 2079 203d 205b 5b31 2c20 322c 2033  >> y = [[1, 2, 3
+000258c0: 5d2c 205b 342c 2035 2c20 365d 5d0a 2020  ], [4, 5, 6]].  
+000258d0: 2020 3e3e 3e20 6461 2e61 7361 6e79 6172    >>> da.asanyar
+000258e0: 7261 7928 7929 0a20 2020 2064 6173 6b2e  ray(y).    dask.
+000258f0: 6172 7261 793c 6172 7261 792c 2073 6861  array<array, sha
+00025900: 7065 3d28 322c 2033 292c 2064 7479 7065  pe=(2, 3), dtype
+00025910: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
+00025920: 653d 2832 2c20 3329 2c20 6368 756e 6b74  e=(2, 3), chunkt
+00025930: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
+00025940: 793e 0a20 2020 2022 2222 0a20 2020 2069  y>.    """.    i
+00025950: 6620 6c69 6b65 2069 7320 4e6f 6e65 3a0a  f like is None:.
+00025960: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00025970: 7461 6e63 6528 612c 2041 7272 6179 293a  tance(a, Array):
+00025980: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00025990: 7572 6e20 610a 2020 2020 2020 2020 656c  urn a.        el
+000259a0: 6966 2068 6173 6174 7472 2861 2c20 2274  if hasattr(a, "t
+000259b0: 6f5f 6461 736b 5f61 7272 6179 2229 3a0a  o_dask_array"):.
+000259c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000259d0: 726e 2061 2e74 6f5f 6461 736b 5f61 7272  rn a.to_dask_arr
+000259e0: 6179 2829 0a20 2020 2020 2020 2065 6c69  ay().        eli
+000259f0: 6620 7479 7065 2861 292e 5f5f 6d6f 6475  f type(a).__modu
+00025a00: 6c65 5f5f 2e73 706c 6974 2822 2e22 295b  le__.split(".")[
+00025a10: 305d 203d 3d20 2278 6172 7261 7922 2061  0] == "xarray" a
+00025a20: 6e64 2068 6173 6174 7472 2861 2c20 2264  nd hasattr(a, "d
+00025a30: 6174 6122 293a 0a20 2020 2020 2020 2020  ata"):.         
+00025a40: 2020 2072 6574 7572 6e20 6173 616e 7961     return asanya
+00025a50: 7272 6179 2861 2e64 6174 6129 0a20 2020  rray(a.data).   
+00025a60: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00025a70: 616e 6365 2861 2c20 286c 6973 742c 2074  ance(a, (list, t
+00025a80: 7570 6c65 2929 2061 6e64 2061 6e79 2869  uple)) and any(i
+00025a90: 7369 6e73 7461 6e63 6528 692c 2041 7272  sinstance(i, Arr
+00025aa0: 6179 2920 666f 7220 6920 696e 2061 293a  ay) for i in a):
+00025ab0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00025ac0: 7572 6e20 7374 6163 6b28 6129 0a20 2020  urn stack(a).   
+00025ad0: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
+00025ae0: 696e 7374 616e 6365 2867 6574 6174 7472  instance(getattr
+00025af0: 2861 2c20 2273 6861 7065 222c 204e 6f6e  (a, "shape", Non
+00025b00: 6529 2c20 4974 6572 6162 6c65 293a 0a20  e), Iterable):. 
+00025b10: 2020 2020 2020 2020 2020 2061 203d 206e             a = n
+00025b20: 702e 6173 616e 7961 7272 6179 2861 2c20  p.asanyarray(a, 
+00025b30: 6474 7970 653d 6474 7970 652c 206f 7264  dtype=dtype, ord
+00025b40: 6572 3d6f 7264 6572 290a 2020 2020 656c  er=order).    el
+00025b50: 7365 3a0a 2020 2020 2020 2020 6c69 6b65  se:.        like
+00025b60: 5f6d 6574 6120 3d20 6d65 7461 5f66 726f  _meta = meta_fro
+00025b70: 6d5f 6172 7261 7928 6c69 6b65 290a 2020  m_array(like).  
+00025b80: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00025b90: 6e63 6528 612c 2041 7272 6179 293a 0a20  nce(a, Array):. 
+00025ba0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00025bb0: 6e20 612e 6d61 705f 626c 6f63 6b73 286e  n a.map_blocks(n
+00025bc0: 702e 6173 616e 7961 7272 6179 2c20 6c69  p.asanyarray, li
+00025bd0: 6b65 3d6c 696b 655f 6d65 7461 2c20 6474  ke=like_meta, dt
+00025be0: 7970 653d 6474 7970 652c 206f 7264 6572  ype=dtype, order
+00025bf0: 3d6f 7264 6572 290a 2020 2020 2020 2020  =order).        
+00025c00: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00025c10: 2020 6120 3d20 6e70 2e61 7361 6e79 6172    a = np.asanyar
+00025c20: 7261 7928 612c 206c 696b 653d 6c69 6b65  ray(a, like=like
+00025c30: 5f6d 6574 612c 2064 7479 7065 3d64 7479  _meta, dtype=dty
+00025c40: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
+00025c50: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
+00025c60: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
+00025c70: 612c 0a20 2020 2020 2020 2063 6875 6e6b  a,.        chunk
+00025c80: 733d 612e 7368 6170 652c 0a20 2020 2020  s=a.shape,.     
+00025c90: 2020 2067 6574 6974 656d 3d67 6574 7465     getitem=gette
+00025ca0: 725f 696e 6c69 6e65 2c0a 2020 2020 2020  r_inline,.      
+00025cb0: 2020 6173 6172 7261 793d 4661 6c73 652c    asarray=False,
+00025cc0: 0a20 2020 2020 2020 2069 6e6c 696e 655f  .        inline_
+00025cd0: 6172 7261 793d 696e 6c69 6e65 5f61 7272  array=inline_arr
+00025ce0: 6179 2c0a 2020 2020 290a 0a0a 6465 6620  ay,.    )...def 
+00025cf0: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
+00025d00: 656d 7769 7365 2861 7267 293a 0a20 2020  emwise(arg):.   
+00025d10: 2022 2222 0a0a 2020 2020 3e3e 3e20 6973   """..    >>> is
+00025d20: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
+00025d30: 7769 7365 2834 3229 0a20 2020 2054 7275  wise(42).    Tru
+00025d40: 650a 2020 2020 3e3e 3e20 6973 5f73 6361  e.    >>> is_sca
+00025d50: 6c61 725f 666f 725f 656c 656d 7769 7365  lar_for_elemwise
+00025d60: 2827 666f 6f27 290a 2020 2020 5472 7565  ('foo').    True
+00025d70: 0a20 2020 203e 3e3e 2069 735f 7363 616c  .    >>> is_scal
+00025d80: 6172 5f66 6f72 5f65 6c65 6d77 6973 6528  ar_for_elemwise(
+00025d90: 5472 7565 290a 2020 2020 5472 7565 0a20  True).    True. 
+00025da0: 2020 203e 3e3e 2069 735f 7363 616c 6172     >>> is_scalar
+00025db0: 5f66 6f72 5f65 6c65 6d77 6973 6528 6e70  _for_elemwise(np
+00025dc0: 2e61 7272 6179 2834 3229 290a 2020 2020  .array(42)).    
+00025dd0: 5472 7565 0a20 2020 203e 3e3e 2069 735f  True.    >>> is_
+00025de0: 7363 616c 6172 5f66 6f72 5f65 6c65 6d77  scalar_for_elemw
+00025df0: 6973 6528 5b31 2c20 322c 2033 5d29 0a20  ise([1, 2, 3]). 
+00025e00: 2020 2054 7275 650a 2020 2020 3e3e 3e20     True.    >>> 
+00025e10: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
+00025e20: 656d 7769 7365 286e 702e 6172 7261 7928  emwise(np.array(
+00025e30: 5b31 2c20 322c 2033 5d29 290a 2020 2020  [1, 2, 3])).    
+00025e40: 4661 6c73 650a 2020 2020 3e3e 3e20 6973  False.    >>> is
+00025e50: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
+00025e60: 7769 7365 2866 726f 6d5f 6172 7261 7928  wise(from_array(
+00025e70: 6e70 2e61 7272 6179 2830 292c 2063 6875  np.array(0), chu
+00025e80: 6e6b 733d 2829 2929 0a20 2020 2046 616c  nks=())).    Fal
+00025e90: 7365 0a20 2020 203e 3e3e 2069 735f 7363  se.    >>> is_sc
+00025ea0: 616c 6172 5f66 6f72 5f65 6c65 6d77 6973  alar_for_elemwis
+00025eb0: 6528 6e70 2e64 7479 7065 2827 6934 2729  e(np.dtype('i4')
+00025ec0: 290a 2020 2020 5472 7565 0a20 2020 2022  ).    True.    "
+00025ed0: 2222 0a20 2020 2023 2074 6865 2073 6563  "".    # the sec
+00025ee0: 6f6e 6420 6861 6c66 206f 6620 7368 6170  ond half of shap
+00025ef0: 655f 636f 6e64 6974 696f 6e20 6973 2065  e_condition is e
+00025f00: 7373 656e 7469 616c 6c79 206a 7573 7420  ssentially just 
+00025f10: 746f 2065 6e73 7572 6520 7468 6174 0a20  to ensure that. 
+00025f20: 2020 2023 2064 6173 6b20 7365 7269 6573     # dask series
+00025f30: 202f 2066 7261 6d65 2061 7265 2074 7265   / frame are tre
+00025f40: 6174 6564 2061 7320 7363 616c 6172 7320  ated as scalars 
+00025f50: 696e 2065 6c65 6d77 6973 652e 0a20 2020  in elemwise..   
+00025f60: 206d 6179 6265 5f73 6861 7065 203d 2067   maybe_shape = g
+00025f70: 6574 6174 7472 2861 7267 2c20 2273 6861  etattr(arg, "sha
+00025f80: 7065 222c 204e 6f6e 6529 0a20 2020 2073  pe", None).    s
+00025f90: 6861 7065 5f63 6f6e 6469 7469 6f6e 203d  hape_condition =
+00025fa0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00025fb0: 6d61 7962 655f 7368 6170 652c 2049 7465  maybe_shape, Ite
+00025fc0: 7261 626c 6529 206f 7220 616e 7928 0a20  rable) or any(. 
+00025fd0: 2020 2020 2020 2069 735f 6461 736b 5f63         is_dask_c
+00025fe0: 6f6c 6c65 6374 696f 6e28 7829 2066 6f72  ollection(x) for
+00025ff0: 2078 2069 6e20 6d61 7962 655f 7368 6170   x in maybe_shap
+00026000: 650a 2020 2020 290a 0a20 2020 2072 6574  e.    )..    ret
+00026010: 7572 6e20 280a 2020 2020 2020 2020 6e70  urn (.        np
+00026020: 2e69 7373 6361 6c61 7228 6172 6729 0a20  .isscalar(arg). 
+00026030: 2020 2020 2020 206f 7220 7368 6170 655f         or shape_
+00026040: 636f 6e64 6974 696f 6e0a 2020 2020 2020  condition.      
+00026050: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
+00026060: 6172 672c 206e 702e 6474 7970 6529 0a20  arg, np.dtype). 
+00026070: 2020 2020 2020 206f 7220 2869 7369 6e73         or (isins
+00026080: 7461 6e63 6528 6172 672c 206e 702e 6e64  tance(arg, np.nd
+00026090: 6172 7261 7929 2061 6e64 2061 7267 2e6e  array) and arg.n
+000260a0: 6469 6d20 3d3d 2030 290a 2020 2020 290a  dim == 0).    ).
+000260b0: 0a0a 6465 6620 6272 6f61 6463 6173 745f  ..def broadcast_
+000260c0: 7368 6170 6573 282a 7368 6170 6573 293a  shapes(*shapes):
+000260d0: 0a20 2020 2022 2222 0a20 2020 2044 6574  .    """.    Det
+000260e0: 6572 6d69 6e65 7320 6f75 7470 7574 2073  ermines output s
+000260f0: 6861 7065 2066 726f 6d20 6272 6f61 6463  hape from broadc
+00026100: 6173 7469 6e67 2061 7272 6179 732e 0a0a  asting arrays...
+00026110: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00026120: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00026130: 2020 7368 6170 6573 203a 2074 7570 6c65    shapes : tuple
+00026140: 730a 2020 2020 2020 2020 5468 6520 7368  s.        The sh
+00026150: 6170 6573 206f 6620 7468 6520 6172 6775  apes of the argu
+00026160: 6d65 6e74 732e 0a0a 2020 2020 5265 7475  ments...    Retu
+00026170: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+00026180: 2020 2020 6f75 7470 7574 5f73 6861 7065      output_shape
+00026190: 203a 2074 7570 6c65 0a0a 2020 2020 5261   : tuple..    Ra
+000261a0: 6973 6573 0a20 2020 202d 2d2d 2d2d 2d0a  ises.    ------.
+000261b0: 2020 2020 5661 6c75 6545 7272 6f72 0a20      ValueError. 
+000261c0: 2020 2020 2020 2049 6620 7468 6520 696e         If the in
+000261d0: 7075 7420 7368 6170 6573 2063 616e 6e6f  put shapes canno
+000261e0: 7420 6265 2073 7563 6365 7373 6675 6c6c  t be successfull
+000261f0: 7920 6272 6f61 6463 6173 7420 746f 6765  y broadcast toge
+00026200: 7468 6572 2e0a 2020 2020 2222 220a 2020  ther..    """.  
+00026210: 2020 6966 206c 656e 2873 6861 7065 7329    if len(shapes)
+00026220: 203d 3d20 313a 0a20 2020 2020 2020 2072   == 1:.        r
+00026230: 6574 7572 6e20 7368 6170 6573 5b30 5d0a  eturn shapes[0].
+00026240: 2020 2020 6f75 7420 3d20 5b5d 0a20 2020      out = [].   
+00026250: 2066 6f72 2073 697a 6573 2069 6e20 7a69   for sizes in zi
+00026260: 705f 6c6f 6e67 6573 7428 2a6d 6170 2872  p_longest(*map(r
+00026270: 6576 6572 7365 642c 2073 6861 7065 7329  eversed, shapes)
+00026280: 2c20 6669 6c6c 7661 6c75 653d 2d31 293a  , fillvalue=-1):
+00026290: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
+000262a0: 736e 616e 2873 697a 6573 292e 616e 7928  snan(sizes).any(
+000262b0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
+000262c0: 696d 203d 206e 702e 6e61 6e0a 2020 2020  im = np.nan.    
+000262d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000262e0: 2020 2020 2020 6469 6d20 3d20 3020 6966        dim = 0 if
+000262f0: 2030 2069 6e20 7369 7a65 7320 656c 7365   0 in sizes else
+00026300: 206e 702e 6d61 7828 7369 7a65 7329 0a20   np.max(sizes). 
+00026310: 2020 2020 2020 2069 6620 616e 7928 6920         if any(i 
+00026320: 6e6f 7420 696e 205b 2d31 2c20 302c 2031  not in [-1, 0, 1
+00026330: 2c20 6469 6d5d 2061 6e64 206e 6f74 206e  , dim] and not n
+00026340: 702e 6973 6e61 6e28 6929 2066 6f72 2069  p.isnan(i) for i
+00026350: 2069 6e20 7369 7a65 7329 3a0a 2020 2020   in sizes):.    
+00026360: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00026370: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00026380: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+00026390: 6e64 7320 636f 756c 6420 6e6f 7420 6265  nds could not be
+000263a0: 2062 726f 6164 6361 7374 2074 6f67 6574   broadcast toget
+000263b0: 6865 7220 7769 7468 2022 0a20 2020 2020  her with ".     
+000263c0: 2020 2020 2020 2020 2020 2022 7368 6170             "shap
+000263d0: 6573 207b 7d22 2e66 6f72 6d61 7428 2220  es {}".format(" 
+000263e0: 222e 6a6f 696e 286d 6170 2873 7472 2c20  ".join(map(str, 
+000263f0: 7368 6170 6573 2929 290a 2020 2020 2020  shapes))).      
+00026400: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00026410: 6f75 742e 6170 7065 6e64 2864 696d 290a  out.append(dim).
+00026420: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
+00026430: 2872 6576 6572 7365 6428 6f75 7429 290a  (reversed(out)).
+00026440: 0a0a 6465 6620 656c 656d 7769 7365 286f  ..def elemwise(o
+00026450: 702c 202a 6172 6773 2c20 6f75 743d 4e6f  p, *args, out=No
+00026460: 6e65 2c20 7768 6572 653d 5472 7565 2c20  ne, where=True, 
+00026470: 6474 7970 653d 4e6f 6e65 2c20 6e61 6d65  dtype=None, name
+00026480: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
+00026490: 3a0a 2020 2020 2222 2241 7070 6c79 2061  :.    """Apply a
+000264a0: 6e20 656c 656d 656e 7477 6973 6520 7566  n elementwise uf
+000264b0: 756e 632d 6c69 6b65 2066 756e 6374 696f  unc-like functio
+000264c0: 6e20 626c 6f63 6b77 6973 6520 6163 726f  n blockwise acro
+000264d0: 7373 2061 7267 756d 656e 7473 2e0a 0a20  ss arguments... 
+000264e0: 2020 204c 696b 6520 6e75 6d70 7920 7566     Like numpy uf
+000264f0: 756e 6373 2c20 6272 6f61 6463 6173 7469  uncs, broadcasti
+00026500: 6e67 2072 756c 6573 2061 7265 2072 6573  ng rules are res
+00026510: 7065 6374 6564 2e0a 0a20 2020 2050 6172  pected...    Par
+00026520: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00026530: 2d2d 2d2d 2d2d 0a20 2020 206f 7020 3a20  ------.    op : 
+00026540: 6361 6c6c 6162 6c65 0a20 2020 2020 2020  callable.       
+00026550: 2054 6865 2066 756e 6374 696f 6e20 746f   The function to
+00026560: 2061 7070 6c79 2e20 5368 6f75 6c64 2062   apply. Should b
+00026570: 6520 6e75 6d70 7920 7566 756e 632d 6c69  e numpy ufunc-li
+00026580: 6b65 2069 6e20 7468 6520 7061 7261 6d65  ke in the parame
+00026590: 7465 7273 0a20 2020 2020 2020 2074 6861  ters.        tha
+000265a0: 7420 6974 2061 6363 6570 7473 2e0a 2020  t it accepts..  
+000265b0: 2020 2a61 7267 7320 3a20 416e 790a 2020    *args : Any.  
+000265c0: 2020 2020 2020 4172 6775 6d65 6e74 7320        Arguments 
+000265d0: 746f 2070 6173 7320 746f 2060 6f70 602e  to pass to `op`.
+000265e0: 204e 6f6e 2d64 6173 6b20 6172 7261 792d   Non-dask array-
+000265f0: 6c69 6b65 206f 626a 6563 7473 2061 7265  like objects are
+00026600: 2066 6972 7374 0a20 2020 2020 2020 2063   first.        c
+00026610: 6f6e 7665 7274 6564 2074 6f20 6461 736b  onverted to dask
+00026620: 2061 7272 6179 732c 2074 6865 6e20 616c   arrays, then al
+00026630: 6c20 6172 7261 7973 2061 7265 2062 726f  l arrays are bro
+00026640: 6164 6361 7374 2074 6f67 6574 6865 7220  adcast together 
+00026650: 6265 666f 7265 0a20 2020 2020 2020 2061  before.        a
+00026660: 7070 6c79 696e 6720 7468 6520 6675 6e63  pplying the func
+00026670: 7469 6f6e 2062 6c6f 636b 7769 7365 2061  tion blockwise a
+00026680: 6372 6f73 7320 616c 6c20 6172 6775 6d65  cross all argume
+00026690: 6e74 732e 2041 6e79 2073 6361 6c61 720a  nts. Any scalar.
+000266a0: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
+000266b0: 7320 6172 6520 7061 7373 6564 2061 732d  s are passed as-
+000266c0: 6973 2066 6f6c 6c6f 7769 6e67 206e 6f72  is following nor
+000266d0: 6d61 6c20 6e75 6d70 7920 7566 756e 6320  mal numpy ufunc 
+000266e0: 6265 6861 7669 6f72 2e0a 2020 2020 6f75  behavior..    ou
+000266f0: 7420 3a20 6461 736b 2061 7272 6179 2c20  t : dask array, 
+00026700: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00026710: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
+00026720: 6b2e 6172 7261 7920 7468 656e 2074 6869  k.array then thi
+00026730: 7320 6f76 6572 7772 6974 6573 2074 6865  s overwrites the
+00026740: 2063 6f6e 7465 6e74 7320 6f66 2074 6861   contents of tha
+00026750: 7420 6172 7261 790a 2020 2020 2020 2020  t array.        
+00026760: 7769 7468 2074 6865 2072 6573 756c 742e  with the result.
+00026770: 0a20 2020 2077 6865 7265 203a 2061 7272  .    where : arr
+00026780: 6179 5f6c 696b 652c 206f 7074 696f 6e61  ay_like, optiona
+00026790: 6c0a 2020 2020 2020 2020 416e 206f 7074  l.        An opt
+000267a0: 696f 6e61 6c20 626f 6f6c 6561 6e20 6d61  ional boolean ma
+000267b0: 736b 206d 6172 6b69 6e67 206c 6f63 6174  sk marking locat
+000267c0: 696f 6e73 2077 6865 7265 2074 6865 2075  ions where the u
+000267d0: 6675 6e63 2073 686f 756c 6420 6265 0a20  func should be. 
+000267e0: 2020 2020 2020 2061 7070 6c69 6564 2e20         applied. 
+000267f0: 4361 6e20 6265 2061 2073 6361 6c61 722c  Can be a scalar,
+00026800: 2064 6173 6b20 6172 7261 792c 206f 7220   dask array, or 
+00026810: 616e 7920 6f74 6865 7220 6172 7261 792d  any other array-
+00026820: 6c69 6b65 206f 626a 6563 742e 0a20 2020  like object..   
+00026830: 2020 2020 204d 6972 726f 7273 2074 6865       Mirrors the
+00026840: 2060 6077 6865 7265 6060 2061 7267 756d   ``where`` argum
+00026850: 656e 7420 746f 206e 756d 7079 2075 6675  ent to numpy ufu
+00026860: 6e63 732c 2073 6565 2065 2e67 2e20 6060  ncs, see e.g. ``
+00026870: 6e75 6d70 792e 6164 6460 600a 2020 2020  numpy.add``.    
+00026880: 2020 2020 666f 7220 6d6f 7265 2069 6e66      for more inf
+00026890: 6f72 6d61 7469 6f6e 2e0a 2020 2020 6474  ormation..    dt
+000268a0: 7970 6520 3a20 6474 7970 652c 206f 7074  ype : dtype, opt
+000268b0: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
+000268c0: 2070 726f 7669 6465 642c 206f 7665 7272   provided, overr
+000268d0: 6964 6573 2074 6865 206f 7574 7075 7420  ides the output 
+000268e0: 6172 7261 7920 6474 7970 652e 0a20 2020  array dtype..   
+000268f0: 206e 616d 6520 3a20 7374 722c 206f 7074   name : str, opt
+00026900: 696f 6e61 6c0a 2020 2020 2020 2020 4120  ional.        A 
+00026910: 756e 6971 7565 206b 6579 206e 616d 6520  unique key name 
+00026920: 746f 2075 7365 2077 6865 6e20 6275 696c  to use when buil
+00026930: 6469 6e67 2074 6865 2062 6163 6b69 6e67  ding the backing
+00026940: 2064 6173 6b20 6772 6170 682e 2049 6620   dask graph. If 
+00026950: 6e6f 740a 2020 2020 2020 2020 7072 6f76  not.        prov
+00026960: 6964 6564 2c20 6f6e 6520 7769 6c6c 2062  ided, one will b
+00026970: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
+00026980: 6765 6e65 7261 7465 6420 6261 7365 6420  generated based 
+00026990: 6f6e 2074 6865 2069 6e70 7574 0a20 2020  on the input.   
+000269a0: 2020 2020 2061 7267 756d 656e 7473 2e0a       arguments..
+000269b0: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+000269c0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
+000269d0: 3e3e 2065 6c65 6d77 6973 6528 6164 642c  >> elemwise(add,
+000269e0: 2078 2c20 7929 2020 2320 646f 6374 6573   x, y)  # doctes
+000269f0: 743a 202b 534b 4950 0a20 2020 203e 3e3e  t: +SKIP.    >>>
+00026a00: 2065 6c65 6d77 6973 6528 7369 6e2c 2078   elemwise(sin, x
+00026a10: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00026a20: 4b49 500a 2020 2020 3e3e 3e20 656c 656d  KIP.    >>> elem
+00026a30: 7769 7365 2873 696e 2c20 782c 206f 7574  wise(sin, x, out
+00026a40: 3d64 6173 6b5f 6172 7261 7929 2020 2320  =dask_array)  # 
+00026a50: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
+00026a60: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00026a70: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 626c   --------.    bl
+00026a80: 6f63 6b77 6973 650a 2020 2020 2222 220a  ockwise.    """.
+00026a90: 2020 2020 6966 206b 7761 7267 733a 0a20      if kwargs:. 
+00026aa0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00026ab0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00026ac0: 2020 2020 6622 7b6f 702e 5f5f 6e61 6d65      f"{op.__name
+00026ad0: 5f5f 7d20 646f 6573 206e 6f74 2074 616b  __} does not tak
+00026ae0: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
+00026af0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00026b00: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
+00026b10: 6622 7b73 6f72 7465 6428 6b77 6172 6773  f"{sorted(kwargs
+00026b20: 297d 220a 2020 2020 2020 2020 290a 0a20  )}".        ).. 
+00026b30: 2020 206f 7574 203d 205f 656c 656d 7769     out = _elemwi
+00026b40: 7365 5f6e 6f72 6d61 6c69 7a65 5f6f 7574  se_normalize_out
+00026b50: 286f 7574 290a 2020 2020 7768 6572 6520  (out).    where 
+00026b60: 3d20 5f65 6c65 6d77 6973 655f 6e6f 726d  = _elemwise_norm
+00026b70: 616c 697a 655f 7768 6572 6528 7768 6572  alize_where(wher
+00026b80: 6529 0a20 2020 2061 7267 7320 3d20 5b6e  e).    args = [n
+00026b90: 702e 6173 6172 7261 7928 6129 2069 6620  p.asarray(a) if 
+00026ba0: 6973 696e 7374 616e 6365 2861 2c20 286c  isinstance(a, (l
+00026bb0: 6973 742c 2074 7570 6c65 2929 2065 6c73  ist, tuple)) els
+00026bc0: 6520 6120 666f 7220 6120 696e 2061 7267  e a for a in arg
+00026bd0: 735d 0a0a 2020 2020 7368 6170 6573 203d  s]..    shapes =
+00026be0: 205b 5d0a 2020 2020 666f 7220 6172 6720   [].    for arg 
+00026bf0: 696e 2061 7267 733a 0a20 2020 2020 2020  in args:.       
+00026c00: 2073 6861 7065 203d 2067 6574 6174 7472   shape = getattr
+00026c10: 2861 7267 2c20 2273 6861 7065 222c 2028  (arg, "shape", (
+00026c20: 2929 0a20 2020 2020 2020 2069 6620 616e  )).        if an
+00026c30: 7928 6973 5f64 6173 6b5f 636f 6c6c 6563  y(is_dask_collec
+00026c40: 7469 6f6e 2878 2920 666f 7220 7820 696e  tion(x) for x in
+00026c50: 2073 6861 7065 293a 0a20 2020 2020 2020   shape):.       
+00026c60: 2020 2020 2023 2057 616e 7420 746f 2065       # Want to e
+00026c70: 7863 6c75 6465 2044 656c 6179 6564 2073  xclude Delayed s
+00026c80: 6861 7065 7320 616e 6420 6464 2e53 6361  hapes and dd.Sca
+00026c90: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
+00026ca0: 7368 6170 6520 3d20 2829 0a20 2020 2020  shape = ().     
+00026cb0: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
+00026cc0: 2873 6861 7065 290a 2020 2020 6966 2069  (shape).    if i
+00026cd0: 7369 6e73 7461 6e63 6528 7768 6572 652c  sinstance(where,
+00026ce0: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
+00026cf0: 2073 6861 7065 732e 6170 7065 6e64 2877   shapes.append(w
+00026d00: 6865 7265 2e73 6861 7065 290a 2020 2020  here.shape).    
+00026d10: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
+00026d20: 742c 2041 7272 6179 293a 0a20 2020 2020  t, Array):.     
+00026d30: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
+00026d40: 286f 7574 2e73 6861 7065 290a 0a20 2020  (out.shape)..   
+00026d50: 2073 6861 7065 7320 3d20 5b73 2069 6620   shapes = [s if 
+00026d60: 6973 696e 7374 616e 6365 2873 2c20 4974  isinstance(s, It
+00026d70: 6572 6162 6c65 2920 656c 7365 2028 2920  erable) else () 
+00026d80: 666f 7220 7320 696e 2073 6861 7065 735d  for s in shapes]
+00026d90: 0a20 2020 206f 7574 5f6e 6469 6d20 3d20  .    out_ndim = 
+00026da0: 6c65 6e28 0a20 2020 2020 2020 2062 726f  len(.        bro
+00026db0: 6164 6361 7374 5f73 6861 7065 7328 2a73  adcast_shapes(*s
+00026dc0: 6861 7065 7329 0a20 2020 2029 2020 2320  hapes).    )  # 
+00026dd0: 5261 6973 6573 2056 616c 7565 4572 726f  Raises ValueErro
+00026de0: 7220 6966 2064 696d 656e 7369 6f6e 7320  r if dimensions 
+00026df0: 6d69 736d 6174 6368 0a20 2020 2065 7870  mismatch.    exp
+00026e00: 725f 696e 6473 203d 2074 7570 6c65 2872  r_inds = tuple(r
+00026e10: 616e 6765 286f 7574 5f6e 6469 6d29 295b  ange(out_ndim))[
+00026e20: 3a3a 2d31 5d0a 0a20 2020 2069 6620 6474  ::-1]..    if dt
+00026e30: 7970 6520 6973 206e 6f74 204e 6f6e 653a  ype is not None:
+00026e40: 0a20 2020 2020 2020 206e 6565 645f 656e  .        need_en
+00026e50: 666f 7263 655f 6474 7970 6520 3d20 5472  force_dtype = Tr
+00026e60: 7565 0a20 2020 2065 6c73 653a 0a20 2020  ue.    else:.   
+00026e70: 2020 2020 2023 2057 6520 666f 6c6c 6f77       # We follow
+00026e80: 204e 756d 5079 2773 2072 756c 6573 2066   NumPy's rules f
+00026e90: 6f72 2064 7479 7065 2070 726f 6d6f 7469  or dtype promoti
+00026ea0: 6f6e 2c20 7768 6963 6820 7370 6563 6961  on, which specia
+00026eb0: 6c20 6361 7365 730a 2020 2020 2020 2020  l cases.        
+00026ec0: 2320 7363 616c 6172 7320 616e 6420 3064  # scalars and 0d
+00026ed0: 206e 6461 7272 6179 7320 2877 6869 6368   ndarrays (which
+00026ee0: 2069 7420 636f 6e73 6964 6572 7320 6571   it considers eq
+00026ef0: 7569 7661 6c65 6e74 2920 6279 2075 7369  uivalent) by usi
+00026f00: 6e67 0a20 2020 2020 2020 2023 2074 6865  ng.        # the
+00026f10: 6972 2076 616c 7565 7320 746f 2063 6f6d  ir values to com
+00026f20: 7075 7465 2074 6865 2072 6573 756c 7420  pute the result 
+00026f30: 6474 7970 653a 0a20 2020 2020 2020 2023  dtype:.        #
+00026f40: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
+00026f50: 636f 6d2f 6e75 6d70 792f 6e75 6d70 792f  com/numpy/numpy/
+00026f60: 6973 7375 6573 2f36 3234 300a 2020 2020  issues/6240.    
+00026f70: 2020 2020 2320 5765 2064 6f6e 2774 2069      # We don't i
+00026f80: 6e73 7065 6374 2074 6865 2076 616c 7565  nspect the value
+00026f90: 7320 6f66 2030 6420 6461 736b 2061 7272  s of 0d dask arr
+00026fa0: 6179 732c 2062 6563 6175 7365 2074 6865  ays, because the
+00026fb0: 7365 2063 6f75 6c64 0a20 2020 2020 2020  se could.       
+00026fc0: 2023 2068 6f6c 6420 706f 7465 6e74 6961   # hold potentia
+00026fd0: 6c6c 7920 7665 7279 2065 7870 656e 7369  lly very expensi
+00026fe0: 7665 2063 616c 6375 6c61 7469 6f6e 732e  ve calculations.
+00026ff0: 2049 6e73 7465 6164 2c20 7765 2074 7265   Instead, we tre
+00027000: 6174 0a20 2020 2020 2020 2023 2074 6865  at.        # the
+00027010: 6d20 6a75 7374 206c 696b 6520 6f74 6865  m just like othe
+00027020: 7220 6172 7261 7973 2c20 616e 6420 6966  r arrays, and if
+00027030: 206e 6563 6573 7361 7279 2063 6173 7420   necessary cast 
+00027040: 7468 6520 7265 7375 6c74 206f 6620 6f70  the result of op
+00027050: 0a20 2020 2020 2020 2023 2074 6f20 6d61  .        # to ma
+00027060: 7463 682e 0a20 2020 2020 2020 2076 616c  tch..        val
+00027070: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
+00027080: 2020 6e70 2e65 6d70 7479 2828 312c 2920    np.empty((1,) 
+00027090: 2a20 6d61 7828 312c 2061 2e6e 6469 6d29  * max(1, a.ndim)
+000270a0: 2c20 6474 7970 653d 612e 6474 7970 6529  , dtype=a.dtype)
+000270b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000270c0: 6e6f 7420 6973 5f73 6361 6c61 725f 666f  not is_scalar_fo
+000270d0: 725f 656c 656d 7769 7365 2861 290a 2020  r_elemwise(a).  
+000270e0: 2020 2020 2020 2020 2020 656c 7365 2061            else a
+000270f0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00027100: 2061 2069 6e20 6172 6773 0a20 2020 2020   a in args.     
+00027110: 2020 205d 0a20 2020 2020 2020 2074 7279     ].        try
+00027120: 3a0a 2020 2020 2020 2020 2020 2020 6474  :.            dt
+00027130: 7970 6520 3d20 6170 706c 795f 696e 6665  ype = apply_infe
+00027140: 725f 6474 7970 6528 6f70 2c20 7661 6c73  r_dtype(op, vals
+00027150: 2c20 7b7d 2c20 2265 6c65 6d77 6973 6522  , {}, "elemwise"
+00027160: 2c20 7375 6767 6573 745f 6474 7970 653d  , suggest_dtype=
+00027170: 4661 6c73 6529 0a20 2020 2020 2020 2065  False).        e
+00027180: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
+00027190: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000271a0: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
+000271b0: 6564 0a20 2020 2020 2020 206e 6565 645f  ed.        need_
+000271c0: 656e 666f 7263 655f 6474 7970 6520 3d20  enforce_dtype = 
+000271d0: 616e 7928 0a20 2020 2020 2020 2020 2020  any(.           
+000271e0: 206e 6f74 2069 735f 7363 616c 6172 5f66   not is_scalar_f
+000271f0: 6f72 5f65 6c65 6d77 6973 6528 6129 2061  or_elemwise(a) a
+00027200: 6e64 2061 2e6e 6469 6d20 3d3d 2030 2066  nd a.ndim == 0 f
+00027210: 6f72 2061 2069 6e20 6172 6773 0a20 2020  or a in args.   
+00027220: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
+00027230: 6f74 206e 616d 653a 0a20 2020 2020 2020  ot name:.       
+00027240: 206e 616d 6520 3d20 6622 7b66 756e 636e   name = f"{funcn
+00027250: 616d 6528 6f70 297d 2d7b 746f 6b65 6e69  ame(op)}-{tokeni
+00027260: 7a65 286f 702c 2064 7479 7065 2c20 2a61  ze(op, dtype, *a
+00027270: 7267 732c 2077 6865 7265 297d 220a 0a20  rgs, where)}".. 
+00027280: 2020 2062 6c6f 636b 7769 7365 5f6b 7761     blockwise_kwa
+00027290: 7267 7320 3d20 6469 6374 2864 7479 7065  rgs = dict(dtype
+000272a0: 3d64 7479 7065 2c20 6e61 6d65 3d6e 616d  =dtype, name=nam
+000272b0: 652c 2074 6f6b 656e 3d66 756e 636e 616d  e, token=funcnam
+000272c0: 6528 6f70 292e 7374 7269 7028 225f 2229  e(op).strip("_")
+000272d0: 290a 0a20 2020 2069 6620 7768 6572 6520  )..    if where 
+000272e0: 6973 206e 6f74 2054 7275 653a 0a20 2020  is not True:.   
+000272f0: 2020 2020 2062 6c6f 636b 7769 7365 5f6b       blockwise_k
+00027300: 7761 7267 735b 2265 6c65 6d77 6973 655f  wargs["elemwise_
+00027310: 7768 6572 655f 6675 6e63 7469 6f6e 225d  where_function"]
+00027320: 203d 206f 700a 2020 2020 2020 2020 6f70   = op.        op
+00027330: 203d 205f 656c 656d 7769 7365 5f68 616e   = _elemwise_han
+00027340: 646c 655f 7768 6572 650a 2020 2020 2020  dle_where.      
+00027350: 2020 6172 6773 2e65 7874 656e 6428 5b77    args.extend([w
+00027360: 6865 7265 2c20 6f75 745d 290a 0a20 2020  here, out])..   
+00027370: 2069 6620 6e65 6564 5f65 6e66 6f72 6365   if need_enforce
+00027380: 5f64 7479 7065 3a0a 2020 2020 2020 2020  _dtype:.        
+00027390: 626c 6f63 6b77 6973 655f 6b77 6172 6773  blockwise_kwargs
+000273a0: 5b22 656e 666f 7263 655f 6474 7970 6522  ["enforce_dtype"
+000273b0: 5d20 3d20 6474 7970 650a 2020 2020 2020  ] = dtype.      
+000273c0: 2020 626c 6f63 6b77 6973 655f 6b77 6172    blockwise_kwar
+000273d0: 6773 5b22 656e 666f 7263 655f 6474 7970  gs["enforce_dtyp
+000273e0: 655f 6675 6e63 7469 6f6e 225d 203d 206f  e_function"] = o
+000273f0: 700a 2020 2020 2020 2020 6f70 203d 205f  p.        op = _
+00027400: 656e 666f 7263 655f 6474 7970 650a 0a20  enforce_dtype.. 
+00027410: 2020 2072 6573 756c 7420 3d20 626c 6f63     result = bloc
+00027420: 6b77 6973 6528 0a20 2020 2020 2020 206f  kwise(.        o
+00027430: 702c 0a20 2020 2020 2020 2065 7870 725f  p,.        expr_
+00027440: 696e 6473 2c0a 2020 2020 2020 2020 2a63  inds,.        *c
+00027450: 6f6e 6361 7428 0a20 2020 2020 2020 2020  oncat(.         
+00027460: 2020 2028 612c 2074 7570 6c65 2872 616e     (a, tuple(ran
+00027470: 6765 2861 2e6e 6469 6d29 5b3a 3a2d 315d  ge(a.ndim)[::-1]
+00027480: 2920 6966 206e 6f74 2069 735f 7363 616c  ) if not is_scal
+00027490: 6172 5f66 6f72 5f65 6c65 6d77 6973 6528  ar_for_elemwise(
+000274a0: 6129 2065 6c73 6520 4e6f 6e65 290a 2020  a) else None).  
+000274b0: 2020 2020 2020 2020 2020 666f 7220 6120            for a 
+000274c0: 696e 2061 7267 730a 2020 2020 2020 2020  in args.        
+000274d0: 292c 0a20 2020 2020 2020 202a 2a62 6c6f  ),.        **blo
+000274e0: 636b 7769 7365 5f6b 7761 7267 732c 0a20  ckwise_kwargs,. 
+000274f0: 2020 2029 0a0a 2020 2020 7265 7475 726e     )..    return
+00027500: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
+00027510: 2072 6573 756c 7429 0a0a 0a64 6566 205f   result)...def _
+00027520: 656c 656d 7769 7365 5f6e 6f72 6d61 6c69  elemwise_normali
+00027530: 7a65 5f77 6865 7265 2877 6865 7265 293a  ze_where(where):
+00027540: 0a20 2020 2069 6620 7768 6572 6520 6973  .    if where is
+00027550: 2054 7275 653a 0a20 2020 2020 2020 2072   True:.        r
+00027560: 6574 7572 6e20 5472 7565 0a20 2020 2065  eturn True.    e
+00027570: 6c69 6620 7768 6572 6520 6973 2046 616c  lif where is Fal
+00027580: 7365 206f 7220 7768 6572 6520 6973 204e  se or where is N
+00027590: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
+000275a0: 7572 6e20 4661 6c73 650a 2020 2020 7265  urn False.    re
+000275b0: 7475 726e 2061 7361 7272 6179 2877 6865  turn asarray(whe
+000275c0: 7265 290a 0a0a 6465 6620 5f65 6c65 6d77  re)...def _elemw
+000275d0: 6973 655f 6861 6e64 6c65 5f77 6865 7265  ise_handle_where
+000275e0: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
+000275f0: 293a 0a20 2020 2066 756e 6374 696f 6e20  ):.    function 
+00027600: 3d20 6b77 6172 6773 2e70 6f70 2822 656c  = kwargs.pop("el
+00027610: 656d 7769 7365 5f77 6865 7265 5f66 756e  emwise_where_fun
+00027620: 6374 696f 6e22 290a 2020 2020 2a61 7267  ction").    *arg
+00027630: 732c 2077 6865 7265 2c20 6f75 7420 3d20  s, where, out = 
+00027640: 6172 6773 0a20 2020 2069 6620 6861 7361  args.    if hasa
+00027650: 7474 7228 6f75 742c 2022 636f 7079 2229  ttr(out, "copy")
+00027660: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
+00027670: 6f75 742e 636f 7079 2829 0a20 2020 2072  out.copy().    r
+00027680: 6574 7572 6e20 6675 6e63 7469 6f6e 282a  eturn function(*
+00027690: 6172 6773 2c20 7768 6572 653d 7768 6572  args, where=wher
+000276a0: 652c 206f 7574 3d6f 7574 2c20 2a2a 6b77  e, out=out, **kw
+000276b0: 6172 6773 290a 0a0a 6465 6620 5f65 6c65  args)...def _ele
+000276c0: 6d77 6973 655f 6e6f 726d 616c 697a 655f  mwise_normalize_
+000276d0: 6f75 7428 6f75 7429 3a0a 2020 2020 6966  out(out):.    if
+000276e0: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
+000276f0: 2074 7570 6c65 293a 0a20 2020 2020 2020   tuple):.       
+00027700: 2069 6620 6c65 6e28 6f75 7429 203d 3d20   if len(out) == 
+00027710: 313a 0a20 2020 2020 2020 2020 2020 206f  1:.            o
+00027720: 7574 203d 206f 7574 5b30 5d0a 2020 2020  ut = out[0].    
+00027730: 2020 2020 656c 6966 206c 656e 286f 7574      elif len(out
+00027740: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
+00027750: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00027760: 656d 656e 7465 6445 7272 6f72 2822 5468  ementedError("Th
+00027770: 6520 6f75 7420 7061 7261 6d65 7465 7220  e out parameter 
+00027780: 6973 206e 6f74 2066 756c 6c79 2073 7570  is not fully sup
+00027790: 706f 7274 6564 2229 0a20 2020 2020 2020  ported").       
+000277a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000277b0: 2020 206f 7574 203d 204e 6f6e 650a 2020     out = None.  
+000277c0: 2020 6966 206e 6f74 2028 6f75 7420 6973    if not (out is
+000277d0: 204e 6f6e 6520 6f72 2069 7369 6e73 7461   None or isinsta
+000277e0: 6e63 6528 6f75 742c 2041 7272 6179 2929  nce(out, Array))
+000277f0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00027800: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00027810: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00027820: 2066 2254 6865 206f 7574 2070 6172 616d   f"The out param
+00027830: 6574 6572 2069 7320 6e6f 7420 6675 6c6c  eter is not full
+00027840: 7920 7375 7070 6f72 7465 642e 220a 2020  y supported.".  
+00027850: 2020 2020 2020 2020 2020 6622 2052 6563            f" Rec
+00027860: 6569 7665 6420 7479 7065 207b 7479 7065  eived type {type
+00027870: 286f 7574 292e 5f5f 6e61 6d65 5f5f 7d2c  (out).__name__},
+00027880: 2065 7870 6563 7465 6420 4461 736b 2041   expected Dask A
+00027890: 7272 6179 220a 2020 2020 2020 2020 290a  rray".        ).
+000278a0: 2020 2020 7265 7475 726e 206f 7574 0a0a      return out..
+000278b0: 0a64 6566 2068 616e 646c 655f 6f75 7428  .def handle_out(
+000278c0: 6f75 742c 2072 6573 756c 7429 3a0a 2020  out, result):.  
+000278d0: 2020 2222 2248 616e 646c 6520 6f75 7420    """Handle out 
+000278e0: 7061 7261 6d65 7465 7273 0a0a 2020 2020  parameters..    
+000278f0: 4966 206f 7574 2069 7320 6120 6461 736b  If out is a dask
+00027900: 2e61 7272 6179 2074 6865 6e20 7468 6973  .array then this
+00027910: 206f 7665 7277 7269 7465 7320 7468 6520   overwrites the 
+00027920: 636f 6e74 656e 7473 206f 6620 7468 6174  contents of that
+00027930: 2061 7272 6179 2077 6974 680a 2020 2020   array with.    
+00027940: 7468 6520 7265 7375 6c74 0a20 2020 2022  the result.    "
+00027950: 2222 0a20 2020 206f 7574 203d 205f 656c  "".    out = _el
+00027960: 656d 7769 7365 5f6e 6f72 6d61 6c69 7a65  emwise_normalize
+00027970: 5f6f 7574 286f 7574 290a 2020 2020 6966  _out(out).    if
+00027980: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
+00027990: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
+000279a0: 2069 6620 6f75 742e 7368 6170 6520 213d   if out.shape !=
+000279b0: 2072 6573 756c 742e 7368 6170 653a 0a20   result.shape:. 
+000279c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000279d0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+000279e0: 2020 2020 2020 2020 2020 2020 2022 4d69               "Mi
+000279f0: 736d 6174 6368 6564 2073 6861 7065 7320  smatched shapes 
+00027a00: 6265 7477 6565 6e20 7265 7375 6c74 2061  between result a
+00027a10: 6e64 206f 7574 2070 6172 616d 6574 6572  nd out parameter
+00027a20: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+00027a30: 2020 2020 226f 7574 3d25 732c 2072 6573      "out=%s, res
+00027a40: 756c 743d 2573 2220 2520 2873 7472 286f  ult=%s" % (str(o
+00027a50: 7574 2e73 6861 7065 292c 2073 7472 2872  ut.shape), str(r
+00027a60: 6573 756c 742e 7368 6170 6529 290a 2020  esult.shape)).  
+00027a70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00027a80: 2020 2020 6f75 742e 5f63 6875 6e6b 7320      out._chunks 
+00027a90: 3d20 7265 7375 6c74 2e63 6875 6e6b 730a  = result.chunks.
+00027aa0: 2020 2020 2020 2020 6f75 742e 6461 736b          out.dask
+00027ab0: 203d 2072 6573 756c 742e 6461 736b 0a20   = result.dask. 
+00027ac0: 2020 2020 2020 206f 7574 2e5f 6d65 7461         out._meta
+00027ad0: 203d 2072 6573 756c 742e 5f6d 6574 610a   = result._meta.
+00027ae0: 2020 2020 2020 2020 6f75 742e 5f6e 616d          out._nam
+00027af0: 6520 3d20 7265 7375 6c74 2e6e 616d 650a  e = result.name.
+00027b00: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+00027b10: 7574 0a20 2020 2065 6c73 653a 0a20 2020  ut.    else:.   
+00027b20: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+00027b30: 6c74 0a0a 0a64 6566 205f 656e 666f 7263  lt...def _enforc
+00027b40: 655f 6474 7970 6528 2a61 7267 732c 202a  e_dtype(*args, *
+00027b50: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
+00027b60: 2243 616c 6c73 2061 2066 756e 6374 696f  "Calls a functio
+00027b70: 6e20 616e 6420 636f 6e76 6572 7473 2069  n and converts i
+00027b80: 7473 2072 6573 756c 7420 746f 2074 6865  ts result to the
+00027b90: 2067 6976 656e 2064 7479 7065 2e0a 0a20   given dtype... 
+00027ba0: 2020 2054 6865 2070 6172 616d 6574 6572     The parameter
+00027bb0: 7320 6861 7665 2064 656c 6962 6572 6174  s have deliberat
+00027bc0: 656c 7920 6265 656e 2067 6976 656e 2075  ely been given u
+00027bd0: 6e77 6965 6c64 7920 6e61 6d65 7320 746f  nwieldy names to
+00027be0: 2061 766f 6964 0a20 2020 2063 6c61 7368   avoid.    clash
+00027bf0: 6573 2077 6974 6820 6b65 7977 6f72 6420  es with keyword 
+00027c00: 6172 6775 6d65 6e74 7320 636f 6e73 756d  arguments consum
+00027c10: 6564 2062 7920 626c 6f63 6b77 6973 650a  ed by blockwise.
+00027c20: 0a20 2020 2041 2064 7479 7065 206f 6620  .    A dtype of 
+00027c30: 606f 626a 6563 7460 2069 7320 7472 6561  `object` is trea
+00027c40: 7465 6420 6173 2061 2073 7065 6369 616c  ted as a special
+00027c50: 2063 6173 6520 616e 6420 6e6f 7420 656e   case and not en
+00027c60: 666f 7263 6564 2c0a 2020 2020 6265 6361  forced,.    beca
+00027c70: 7573 6520 6974 2069 7320 7573 6564 2061  use it is used a
+00027c80: 7320 6120 6475 6d6d 7920 7661 6c75 6520  s a dummy value 
+00027c90: 696e 2073 6f6d 6520 706c 6163 6573 2077  in some places w
+00027ca0: 6865 6e20 7468 6520 7265 7375 6c74 2077  hen the result w
+00027cb0: 696c 6c0a 2020 2020 6e6f 7420 6265 2061  ill.    not be a
+00027cc0: 2062 6c6f 636b 2069 6e20 616e 2041 7272   block in an Arr
+00027cd0: 6179 2e0a 0a20 2020 2050 6172 616d 6574  ay...    Paramet
+00027ce0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00027cf0: 2d2d 0a20 2020 2065 6e66 6f72 6365 5f64  --.    enforce_d
+00027d00: 7479 7065 203a 2064 7479 7065 0a20 2020  type : dtype.   
+00027d10: 2020 2020 2052 6573 756c 7420 6474 7970       Result dtyp
+00027d20: 650a 2020 2020 656e 666f 7263 655f 6474  e.    enforce_dt
+00027d30: 7970 655f 6675 6e63 7469 6f6e 203a 2063  ype_function : c
+00027d40: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
+00027d50: 5468 6520 7772 6170 7065 6420 6675 6e63  The wrapped func
+00027d60: 7469 6f6e 2c20 7768 6963 6820 7769 6c6c  tion, which will
+00027d70: 2062 6520 7061 7373 6564 2074 6865 2072   be passed the r
+00027d80: 656d 6169 6e69 6e67 2061 7267 756d 656e  emaining argumen
+00027d90: 7473 0a20 2020 2022 2222 0a20 2020 2064  ts.    """.    d
+00027da0: 7479 7065 203d 206b 7761 7267 732e 706f  type = kwargs.po
+00027db0: 7028 2265 6e66 6f72 6365 5f64 7479 7065  p("enforce_dtype
+00027dc0: 2229 0a20 2020 2066 756e 6374 696f 6e20  ").    function 
+00027dd0: 3d20 6b77 6172 6773 2e70 6f70 2822 656e  = kwargs.pop("en
+00027de0: 666f 7263 655f 6474 7970 655f 6675 6e63  force_dtype_func
+00027df0: 7469 6f6e 2229 0a0a 2020 2020 7265 7375  tion")..    resu
+00027e00: 6c74 203d 2066 756e 6374 696f 6e28 2a61  lt = function(*a
+00027e10: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
+00027e20: 2020 2069 6620 6861 7361 7474 7228 7265     if hasattr(re
+00027e30: 7375 6c74 2c20 2264 7479 7065 2229 2061  sult, "dtype") a
+00027e40: 6e64 2064 7479 7065 2021 3d20 7265 7375  nd dtype != resu
+00027e50: 6c74 2e64 7479 7065 2061 6e64 2064 7479  lt.dtype and dty
+00027e60: 7065 2021 3d20 6f62 6a65 6374 3a0a 2020  pe != object:.  
+00027e70: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+00027e80: 6361 6e5f 6361 7374 2872 6573 756c 742c  can_cast(result,
+00027e90: 2064 7479 7065 2c20 6361 7374 696e 673d   dtype, casting=
+00027ea0: 2273 616d 655f 6b69 6e64 2229 3a0a 2020  "same_kind"):.  
+00027eb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00027ec0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00027ed0: 2020 2020 2020 2020 2020 2020 2249 6e66              "Inf
+00027ee0: 6572 7265 6420 6474 7970 6520 6672 6f6d  erred dtype from
+00027ef0: 2066 756e 6374 696f 6e20 2572 2077 6173   function %r was
+00027f00: 2025 7220 220a 2020 2020 2020 2020 2020   %r ".          
+00027f10: 2020 2020 2020 2262 7574 2067 6f74 2025        "but got %
+00027f20: 722c 2077 6869 6368 2063 616e 2774 2062  r, which can't b
+00027f30: 6520 6361 7374 2075 7369 6e67 2022 0a20  e cast using ". 
+00027f40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00027f50: 6361 7374 696e 673d 2773 616d 655f 6b69  casting='same_ki
+00027f60: 6e64 2722 0a20 2020 2020 2020 2020 2020  nd'".           
+00027f70: 2020 2020 2025 2028 6675 6e63 6e61 6d65       % (funcname
+00027f80: 2866 756e 6374 696f 6e29 2c20 7374 7228  (function), str(
+00027f90: 6474 7970 6529 2c20 7374 7228 7265 7375  dtype), str(resu
+00027fa0: 6c74 2e64 7479 7065 2929 0a20 2020 2020  lt.dtype)).     
+00027fb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00027fc0: 2069 6620 6e70 2e69 7373 6361 6c61 7228   if np.isscalar(
+00027fd0: 7265 7375 6c74 293a 0a20 2020 2020 2020  result):.       
+00027fe0: 2020 2020 2023 2073 6361 6c61 7220 6173       # scalar as
+00027ff0: 7479 7065 206d 6574 686f 6420 646f 6573  type method does
+00028000: 6e27 7420 7461 6b65 2074 6865 206b 6579  n't take the key
+00028010: 776f 7264 2061 7267 756d 656e 7473 2c20  word arguments, 
+00028020: 736f 0a20 2020 2020 2020 2020 2020 2023  so.            #
+00028030: 2068 6176 6520 746f 2063 6f6e 7665 7274   have to convert
+00028040: 2076 6961 2030 2d64 696d 656e 7369 6f6e   via 0-dimension
+00028050: 616c 2061 7272 6179 2061 6e64 2062 6163  al array and bac
+00028060: 6b2e 0a20 2020 2020 2020 2020 2020 2072  k..            r
+00028070: 6573 756c 7420 3d20 7265 7375 6c74 2e61  esult = result.a
+00028080: 7374 7970 6528 6474 7970 6529 0a20 2020  stype(dtype).   
+00028090: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000280a0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+000280b0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+000280c0: 6c74 203d 2072 6573 756c 742e 6173 7479  lt = result.asty
+000280d0: 7065 2864 7479 7065 2c20 636f 7079 3d46  pe(dtype, copy=F
+000280e0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
+000280f0: 2020 6578 6365 7074 2054 7970 6545 7272    except TypeErr
+00028100: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00028110: 2020 2020 2320 4d69 7373 696e 6720 636f      # Missing co
+00028120: 7079 206b 7761 7267 0a20 2020 2020 2020  py kwarg.       
+00028130: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00028140: 3d20 7265 7375 6c74 2e61 7374 7970 6528  = result.astype(
+00028150: 6474 7970 6529 0a20 2020 2072 6574 7572  dtype).    retur
+00028160: 6e20 7265 7375 6c74 0a0a 0a64 6566 2062  n result...def b
+00028170: 726f 6164 6361 7374 5f74 6f28 782c 2073  roadcast_to(x, s
+00028180: 6861 7065 2c20 6368 756e 6b73 3d4e 6f6e  hape, chunks=Non
+00028190: 652c 206d 6574 613d 4e6f 6e65 293a 0a20  e, meta=None):. 
+000281a0: 2020 2022 2222 4272 6f61 6463 6173 7420     """Broadcast 
+000281b0: 616e 2061 7272 6179 2074 6f20 6120 6e65  an array to a ne
+000281c0: 7720 7368 6170 652e 0a0a 2020 2020 5061  w shape...    Pa
+000281d0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+000281e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 7820 3a20  -------.    x : 
+000281f0: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
+00028200: 2020 2054 6865 2061 7272 6179 2074 6f20     The array to 
+00028210: 6272 6f61 6463 6173 742e 0a20 2020 2073  broadcast..    s
+00028220: 6861 7065 203a 2074 7570 6c65 0a20 2020  hape : tuple.   
+00028230: 2020 2020 2054 6865 2073 6861 7065 206f       The shape o
+00028240: 6620 7468 6520 6465 7369 7265 6420 6172  f the desired ar
+00028250: 7261 792e 0a20 2020 2063 6875 6e6b 7320  ray..    chunks 
+00028260: 3a20 7475 706c 652c 206f 7074 696f 6e61  : tuple, optiona
+00028270: 6c0a 2020 2020 2020 2020 4966 2070 726f  l.        If pro
+00028280: 7669 6465 642c 2074 6865 6e20 7468 6520  vided, then the 
+00028290: 7265 7375 6c74 2077 696c 6c20 7573 6520  result will use 
+000282a0: 7468 6573 6520 6368 756e 6b73 2069 6e73  these chunks ins
+000282b0: 7465 6164 206f 6620 7468 6520 7361 6d65  tead of the same
+000282c0: 0a20 2020 2020 2020 2063 6875 6e6b 7320  .        chunks 
+000282d0: 6173 2074 6865 2073 6f75 7263 6520 6172  as the source ar
+000282e0: 7261 792e 2053 6574 7469 6e67 2063 6875  ray. Setting chu
+000282f0: 6e6b 7320 6578 706c 6963 6974 6c79 2061  nks explicitly a
+00028300: 7320 7061 7274 206f 660a 2020 2020 2020  s part of.      
+00028310: 2020 6272 6f61 6463 6173 745f 746f 2069    broadcast_to i
+00028320: 7320 6d6f 7265 2065 6666 6963 6965 6e74  s more efficient
+00028330: 2074 6861 6e20 7265 6368 756e 6b69 6e67   than rechunking
+00028340: 2061 6674 6572 7761 7264 732e 2043 6875   afterwards. Chu
+00028350: 6e6b 7320 6172 650a 2020 2020 2020 2020  nks are.        
+00028360: 6f6e 6c79 2061 6c6c 6f77 6564 2074 6f20  only allowed to 
+00028370: 6469 6666 6572 2066 726f 6d20 7468 6520  differ from the 
+00028380: 6f72 6967 696e 616c 2073 6861 7065 2061  original shape a
+00028390: 6c6f 6e67 2064 696d 656e 7369 6f6e 7320  long dimensions 
+000283a0: 7468 6174 0a20 2020 2020 2020 2061 7265  that.        are
+000283b0: 206e 6577 206f 6e20 7468 6520 7265 7375   new on the resu
+000283c0: 6c74 206f 7220 6861 7665 2073 697a 6520  lt or have size 
+000283d0: 3120 7468 6520 696e 7075 7420 6172 7261  1 the input arra
+000283e0: 792e 0a20 2020 206d 6574 6120 3a20 656d  y..    meta : em
+000283f0: 7074 7920 6e64 6172 7261 790a 2020 2020  pty ndarray.    
+00028400: 2020 2020 656d 7074 7920 6e64 6172 7261      empty ndarra
+00028410: 7920 6372 6561 7465 6420 7769 7468 2073  y created with s
+00028420: 616d 6520 4e75 6d50 7920 6261 636b 656e  ame NumPy backen
+00028430: 642c 206e 6469 6d20 616e 6420 6474 7970  d, ndim and dtyp
+00028440: 6520 6173 2074 6865 0a20 2020 2020 2020  e as the.       
+00028450: 2044 6173 6b20 4172 7261 7920 6265 696e   Dask Array bein
+00028460: 6720 6372 6561 7465 6420 286f 7665 7272  g created (overr
+00028470: 6964 6573 2064 7479 7065 290a 0a20 2020  ides dtype)..   
+00028480: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00028490: 2d2d 2d2d 0a20 2020 2062 726f 6164 6361  ----.    broadca
+000284a0: 7374 203a 2064 6173 6b20 6172 7261 790a  st : dask array.
+000284b0: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
+000284c0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203a    --------.    :
+000284d0: 6675 6e63 3a60 6e75 6d70 792e 6272 6f61  func:`numpy.broa
+000284e0: 6463 6173 745f 746f 600a 2020 2020 2222  dcast_to`.    ""
+000284f0: 220a 2020 2020 7820 3d20 6173 6172 7261  ".    x = asarra
+00028500: 7928 7829 0a20 2020 2073 6861 7065 203d  y(x).    shape =
+00028510: 2074 7570 6c65 2873 6861 7065 290a 0a20   tuple(shape).. 
+00028520: 2020 2069 6620 6d65 7461 2069 7320 4e6f     if meta is No
+00028530: 6e65 3a0a 2020 2020 2020 2020 6d65 7461  ne:.        meta
+00028540: 203d 206d 6574 615f 6672 6f6d 5f61 7272   = meta_from_arr
+00028550: 6179 2878 290a 0a20 2020 2069 6620 782e  ay(x)..    if x.
+00028560: 7368 6170 6520 3d3d 2073 6861 7065 2061  shape == shape a
+00028570: 6e64 2028 6368 756e 6b73 2069 7320 4e6f  nd (chunks is No
+00028580: 6e65 206f 7220 6368 756e 6b73 203d 3d20  ne or chunks == 
+00028590: 782e 6368 756e 6b73 293a 0a20 2020 2020  x.chunks):.     
+000285a0: 2020 2072 6574 7572 6e20 780a 0a20 2020     return x..   
+000285b0: 206e 6469 6d5f 6e65 7720 3d20 6c65 6e28   ndim_new = len(
+000285c0: 7368 6170 6529 202d 2078 2e6e 6469 6d0a  shape) - x.ndim.
+000285d0: 2020 2020 6966 206e 6469 6d5f 6e65 7720      if ndim_new 
+000285e0: 3c20 3020 6f72 2061 6e79 280a 2020 2020  < 0 or any(.    
+000285f0: 2020 2020 6e65 7720 213d 206f 6c64 2066      new != old f
+00028600: 6f72 206e 6577 2c20 6f6c 6420 696e 207a  or new, old in z
+00028610: 6970 2873 6861 7065 5b6e 6469 6d5f 6e65  ip(shape[ndim_ne
+00028620: 773a 5d2c 2078 2e73 6861 7065 2920 6966  w:], x.shape) if
+00028630: 206f 6c64 2021 3d20 310a 2020 2020 293a   old != 1.    ):
+00028640: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00028650: 616c 7565 4572 726f 7228 6622 6361 6e6e  alueError(f"cann
+00028660: 6f74 2062 726f 6164 6361 7374 2073 6861  ot broadcast sha
+00028670: 7065 207b 782e 7368 6170 657d 2074 6f20  pe {x.shape} to 
+00028680: 7368 6170 6520 7b73 6861 7065 7d22 290a  shape {shape}").
+00028690: 0a20 2020 2069 6620 6368 756e 6b73 2069  .    if chunks i
+000286a0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000286b0: 6368 756e 6b73 203d 2074 7570 6c65 2828  chunks = tuple((
+000286c0: 732c 2920 666f 7220 7320 696e 2073 6861  s,) for s in sha
+000286d0: 7065 5b3a 6e64 696d 5f6e 6577 5d29 202b  pe[:ndim_new]) +
+000286e0: 2074 7570 6c65 280a 2020 2020 2020 2020   tuple(.        
+000286f0: 2020 2020 6264 2069 6620 6f6c 6420 3e20      bd if old > 
+00028700: 3120 656c 7365 2028 6e65 772c 290a 2020  1 else (new,).  
+00028710: 2020 2020 2020 2020 2020 666f 7220 6264            for bd
+00028720: 2c20 6f6c 642c 206e 6577 2069 6e20 7a69  , old, new in zi
+00028730: 7028 782e 6368 756e 6b73 2c20 782e 7368  p(x.chunks, x.sh
+00028740: 6170 652c 2073 6861 7065 5b6e 6469 6d5f  ape, shape[ndim_
+00028750: 6e65 773a 5d29 0a20 2020 2020 2020 2029  new:]).        )
+00028760: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00028770: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
+00028780: 616c 697a 655f 6368 756e 6b73 280a 2020  alize_chunks(.  
+00028790: 2020 2020 2020 2020 2020 6368 756e 6b73            chunks
+000287a0: 2c20 7368 6170 652c 2064 7479 7065 3d78  , shape, dtype=x
+000287b0: 2e64 7479 7065 2c20 7072 6576 696f 7573  .dtype, previous
+000287c0: 5f63 6875 6e6b 733d 782e 6368 756e 6b73  _chunks=x.chunks
+000287d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000287e0: 2020 2066 6f72 206f 6c64 5f62 642c 206e     for old_bd, n
+000287f0: 6577 5f62 6420 696e 207a 6970 2878 2e63  ew_bd in zip(x.c
+00028800: 6875 6e6b 732c 2063 6875 6e6b 735b 6e64  hunks, chunks[nd
+00028810: 696d 5f6e 6577 3a5d 293a 0a20 2020 2020  im_new:]):.     
+00028820: 2020 2020 2020 2069 6620 6f6c 645f 6264         if old_bd
+00028830: 2021 3d20 6e65 775f 6264 2061 6e64 206f   != new_bd and o
+00028840: 6c64 5f62 6420 213d 2028 312c 293a 0a20  ld_bd != (1,):. 
+00028850: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00028860: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00028870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028880: 2020 2020 2022 6361 6e6e 6f74 2062 726f       "cannot bro
+00028890: 6164 6361 7374 2063 6875 6e6b 7320 2573  adcast chunks %s
+000288a0: 2074 6f20 6368 756e 6b73 2025 733a 2022   to chunks %s: "
+000288b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000288c0: 2020 2020 2022 6e65 7720 6368 756e 6b73       "new chunks
+000288d0: 206d 7573 7420 6569 7468 6572 2062 6520   must either be 
+000288e0: 616c 6f6e 6720 6120 6e65 7720 220a 2020  along a new ".  
+000288f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028900: 2020 2264 696d 656e 7369 6f6e 206f 7220    "dimension or 
+00028910: 6120 6469 6d65 6e73 696f 6e20 6f66 2073  a dimension of s
+00028920: 697a 6520 3122 2025 2028 782e 6368 756e  ize 1" % (x.chun
+00028930: 6b73 2c20 6368 756e 6b73 290a 2020 2020  ks, chunks).    
+00028940: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00028950: 2020 206e 616d 6520 3d20 2262 726f 6164     name = "broad
+00028960: 6361 7374 5f74 6f2d 2220 2b20 746f 6b65  cast_to-" + toke
+00028970: 6e69 7a65 2878 2c20 7368 6170 652c 2063  nize(x, shape, c
+00028980: 6875 6e6b 7329 0a20 2020 2064 736b 203d  hunks).    dsk =
+00028990: 207b 7d0a 0a20 2020 2065 6e75 6d65 7261   {}..    enumera
+000289a0: 7465 645f 6368 756e 6b73 203d 2070 726f  ted_chunks = pro
+000289b0: 6475 6374 282a 2865 6e75 6d65 7261 7465  duct(*(enumerate
+000289c0: 2862 6473 2920 666f 7220 6264 7320 696e  (bds) for bds in
+000289d0: 2063 6875 6e6b 7329 290a 2020 2020 666f   chunks)).    fo
+000289e0: 7220 6e65 775f 696e 6465 782c 2063 6875  r new_index, chu
+000289f0: 6e6b 5f73 6861 7065 2069 6e20 287a 6970  nk_shape in (zip
+00028a00: 282a 6563 2920 666f 7220 6563 2069 6e20  (*ec) for ec in 
+00028a10: 656e 756d 6572 6174 6564 5f63 6875 6e6b  enumerated_chunk
+00028a20: 7329 3a0a 2020 2020 2020 2020 6f6c 645f  s):.        old_
+00028a30: 696e 6465 7820 3d20 7475 706c 6528 0a20  index = tuple(. 
+00028a40: 2020 2020 2020 2020 2020 2030 2069 6620             0 if 
+00028a50: 6264 203d 3d20 2831 2c29 2065 6c73 6520  bd == (1,) else 
+00028a60: 6920 666f 7220 6264 2c20 6920 696e 207a  i for bd, i in z
+00028a70: 6970 2878 2e63 6875 6e6b 732c 206e 6577  ip(x.chunks, new
+00028a80: 5f69 6e64 6578 5b6e 6469 6d5f 6e65 773a  _index[ndim_new:
+00028a90: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
+00028aa0: 2020 2020 206f 6c64 5f6b 6579 203d 2028       old_key = (
+00028ab0: 782e 6e61 6d65 2c29 202b 206f 6c64 5f69  x.name,) + old_i
+00028ac0: 6e64 6578 0a20 2020 2020 2020 206e 6577  ndex.        new
+00028ad0: 5f6b 6579 203d 2028 6e61 6d65 2c29 202b  _key = (name,) +
+00028ae0: 206e 6577 5f69 6e64 6578 0a20 2020 2020   new_index.     
+00028af0: 2020 2064 736b 5b6e 6577 5f6b 6579 5d20     dsk[new_key] 
+00028b00: 3d20 286e 702e 6272 6f61 6463 6173 745f  = (np.broadcast_
+00028b10: 746f 2c20 6f6c 645f 6b65 792c 2071 756f  to, old_key, quo
+00028b20: 7465 2863 6875 6e6b 5f73 6861 7065 2929  te(chunk_shape))
+00028b30: 0a0a 2020 2020 6772 6170 6820 3d20 4869  ..    graph = Hi
+00028b40: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+00028b50: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+00028b60: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+00028b70: 6e63 6965 733d 5b78 5d29 0a20 2020 2072  ncies=[x]).    r
+00028b80: 6574 7572 6e20 4172 7261 7928 6772 6170  eturn Array(grap
+00028b90: 682c 206e 616d 652c 2063 6875 6e6b 732c  h, name, chunks,
+00028ba0: 2064 7479 7065 3d78 2e64 7479 7065 2c20   dtype=x.dtype, 
+00028bb0: 6d65 7461 3d6d 6574 6129 0a0a 0a40 6465  meta=meta)...@de
+00028bc0: 7269 7665 645f 6672 6f6d 286e 7029 0a64  rived_from(np).d
+00028bd0: 6566 2062 726f 6164 6361 7374 5f61 7272  ef broadcast_arr
+00028be0: 6179 7328 2a61 7267 732c 2073 7562 6f6b  ays(*args, subok
+00028bf0: 3d46 616c 7365 293a 0a20 2020 2073 7562  =False):.    sub
+00028c00: 6f6b 203d 2062 6f6f 6c28 7375 626f 6b29  ok = bool(subok)
+00028c10: 0a0a 2020 2020 746f 5f61 7272 6179 203d  ..    to_array =
+00028c20: 2061 7361 6e79 6172 7261 7920 6966 2073   asanyarray if s
+00028c30: 7562 6f6b 2065 6c73 6520 6173 6172 7261  ubok else asarra
+00028c40: 790a 2020 2020 6172 6773 203d 2074 7570  y.    args = tup
+00028c50: 6c65 2874 6f5f 6172 7261 7928 6529 2066  le(to_array(e) f
+00028c60: 6f72 2065 2069 6e20 6172 6773 290a 0a20  or e in args).. 
+00028c70: 2020 2023 2055 6e69 6679 2075 6e65 7665     # Unify uneve
+00028c80: 6e20 6368 756e 6b69 6e67 0a20 2020 2069  n chunking.    i
+00028c90: 6e64 7320 3d20 5b6c 6973 7428 7265 7665  nds = [list(reve
+00028ca0: 7273 6564 2872 616e 6765 2878 2e6e 6469  rsed(range(x.ndi
+00028cb0: 6d29 2929 2066 6f72 2078 2069 6e20 6172  m))) for x in ar
+00028cc0: 6773 5d0a 2020 2020 7563 5f61 7267 7320  gs].    uc_args 
+00028cd0: 3d20 636f 6e63 6174 287a 6970 2861 7267  = concat(zip(arg
+00028ce0: 732c 2069 6e64 7329 290a 2020 2020 5f2c  s, inds)).    _,
+00028cf0: 2061 7267 7320 3d20 756e 6966 795f 6368   args = unify_ch
+00028d00: 756e 6b73 282a 7563 5f61 7267 732c 2077  unks(*uc_args, w
+00028d10: 6172 6e3d 4661 6c73 6529 0a0a 2020 2020  arn=False)..    
+00028d20: 7368 6170 6520 3d20 6272 6f61 6463 6173  shape = broadcas
+00028d30: 745f 7368 6170 6573 282a 2865 2e73 6861  t_shapes(*(e.sha
+00028d40: 7065 2066 6f72 2065 2069 6e20 6172 6773  pe for e in args
+00028d50: 2929 0a20 2020 2063 6875 6e6b 7320 3d20  )).    chunks = 
+00028d60: 6272 6f61 6463 6173 745f 6368 756e 6b73  broadcast_chunks
+00028d70: 282a 2865 2e63 6875 6e6b 7320 666f 7220  (*(e.chunks for 
+00028d80: 6520 696e 2061 7267 7329 290a 0a20 2020  e in args))..   
+00028d90: 2072 6573 756c 7420 3d20 5b62 726f 6164   result = [broad
+00028da0: 6361 7374 5f74 6f28 652c 2073 6861 7065  cast_to(e, shape
+00028db0: 3d73 6861 7065 2c20 6368 756e 6b73 3d63  =shape, chunks=c
+00028dc0: 6875 6e6b 7329 2066 6f72 2065 2069 6e20  hunks) for e in 
+00028dd0: 6172 6773 5d0a 0a20 2020 2072 6574 7572  args]..    retur
+00028de0: 6e20 7265 7375 6c74 0a0a 0a64 6566 206f  n result...def o
+00028df0: 6666 7365 745f 6675 6e63 2866 756e 632c  ffset_func(func,
+00028e00: 206f 6666 7365 742c 202a 6172 6773 293a   offset, *args):
+00028e10: 0a20 2020 2022 2222 4f66 6673 6574 7320  .    """Offsets 
+00028e20: 696e 7075 7473 2062 7920 6f66 6673 6574  inputs by offset
+00028e30: 0a0a 2020 2020 3e3e 3e20 646f 7562 6c65  ..    >>> double
+00028e40: 203d 206c 616d 6264 6120 783a 2078 202a   = lambda x: x *
+00028e50: 2032 0a20 2020 203e 3e3e 2066 203d 206f   2.    >>> f = o
+00028e60: 6666 7365 745f 6675 6e63 2864 6f75 626c  ffset_func(doubl
+00028e70: 652c 2028 3130 2c29 290a 2020 2020 3e3e  e, (10,)).    >>
+00028e80: 3e20 6628 3129 0a20 2020 2032 320a 2020  > f(1).    22.  
+00028e90: 2020 3e3e 3e20 6628 3330 3029 0a20 2020    >>> f(300).   
+00028ea0: 2036 3230 0a20 2020 2022 2222 0a0a 2020   620.    """..  
+00028eb0: 2020 6465 6620 5f6f 6666 7365 7428 2a61    def _offset(*a
+00028ec0: 7267 7329 3a0a 2020 2020 2020 2020 6172  rgs):.        ar
+00028ed0: 6773 3220 3d20 6c69 7374 286d 6170 2861  gs2 = list(map(a
+00028ee0: 6464 2c20 6172 6773 2c20 6f66 6673 6574  dd, args, offset
+00028ef0: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
+00028f00: 6e20 6675 6e63 282a 6172 6773 3229 0a0a  n func(*args2)..
+00028f10: 2020 2020 7769 7468 2063 6f6e 7465 7874      with context
+00028f20: 6c69 622e 7375 7070 7265 7373 2845 7863  lib.suppress(Exc
+00028f30: 6570 7469 6f6e 293a 0a20 2020 2020 2020  eption):.       
+00028f40: 205f 6f66 6673 6574 2e5f 5f6e 616d 655f   _offset.__name_
+00028f50: 5f20 3d20 226f 6666 7365 745f 2220 2b20  _ = "offset_" + 
+00028f60: 6675 6e63 2e5f 5f6e 616d 655f 5f0a 0a20  func.__name__.. 
+00028f70: 2020 2072 6574 7572 6e20 5f6f 6666 7365     return _offse
+00028f80: 740a 0a0a 6465 6620 6368 756e 6b73 5f66  t...def chunks_f
+00028f90: 726f 6d5f 6172 7261 7973 2861 7272 6179  rom_arrays(array
+00028fa0: 7329 3a0a 2020 2020 2222 2243 6875 6e6b  s):.    """Chunk
+00028fb0: 7320 7475 706c 6520 6672 6f6d 206e 6573  s tuple from nes
+00028fc0: 7465 6420 6c69 7374 206f 6620 6172 7261  ted list of arra
+00028fd0: 7973 0a0a 2020 2020 3e3e 3e20 7820 3d20  ys..    >>> x = 
+00028fe0: 6e70 2e61 7272 6179 285b 312c 2032 5d29  np.array([1, 2])
+00028ff0: 0a20 2020 203e 3e3e 2063 6875 6e6b 735f  .    >>> chunks_
+00029000: 6672 6f6d 5f61 7272 6179 7328 5b78 2c20  from_arrays([x, 
+00029010: 785d 290a 2020 2020 2828 322c 2032 292c  x]).    ((2, 2),
+00029020: 290a 0a20 2020 203e 3e3e 2078 203d 206e  )..    >>> x = n
+00029030: 702e 6172 7261 7928 5b5b 312c 2032 5d5d  p.array([[1, 2]]
+00029040: 290a 2020 2020 3e3e 3e20 6368 756e 6b73  ).    >>> chunks
+00029050: 5f66 726f 6d5f 6172 7261 7973 285b 5b78  _from_arrays([[x
+00029060: 5d2c 205b 785d 5d29 0a20 2020 2028 2831  ], [x]]).    ((1
+00029070: 2c20 3129 2c20 2832 2c29 290a 0a20 2020  , 1), (2,))..   
+00029080: 203e 3e3e 2078 203d 206e 702e 6172 7261   >>> x = np.arra
+00029090: 7928 5b5b 312c 2032 5d5d 290a 2020 2020  y([[1, 2]]).    
+000290a0: 3e3e 3e20 6368 756e 6b73 5f66 726f 6d5f  >>> chunks_from_
+000290b0: 6172 7261 7973 285b 5b78 2c20 785d 5d29  arrays([[x, x]])
+000290c0: 0a20 2020 2028 2831 2c29 2c20 2832 2c20  .    ((1,), (2, 
+000290d0: 3229 290a 0a20 2020 203e 3e3e 2063 6875  2))..    >>> chu
+000290e0: 6e6b 735f 6672 6f6d 5f61 7272 6179 7328  nks_from_arrays(
+000290f0: 5b31 2c20 315d 290a 2020 2020 2828 312c  [1, 1]).    ((1,
+00029100: 2031 292c 290a 2020 2020 2222 220a 2020   1),).    """.  
+00029110: 2020 6966 206e 6f74 2061 7272 6179 733a    if not arrays:
+00029120: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00029130: 2829 0a20 2020 2072 6573 756c 7420 3d20  ().    result = 
+00029140: 5b5d 0a20 2020 2064 696d 203d 2030 0a0a  [].    dim = 0..
+00029150: 2020 2020 6465 6620 7368 6170 6528 7829      def shape(x)
+00029160: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+00029170: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00029180: 6e20 782e 7368 6170 6520 6966 2078 2e73  n x.shape if x.s
+00029190: 6861 7065 2065 6c73 6520 2831 2c29 0a20  hape else (1,). 
+000291a0: 2020 2020 2020 2065 7863 6570 7420 4174         except At
+000291b0: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
+000291c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000291d0: 2028 312c 290a 0a20 2020 2077 6869 6c65   (1,)..    while
+000291e0: 2069 7369 6e73 7461 6e63 6528 6172 7261   isinstance(arra
+000291f0: 7973 2c20 286c 6973 742c 2074 7570 6c65  ys, (list, tuple
+00029200: 2929 3a0a 2020 2020 2020 2020 7265 7375  )):.        resu
+00029210: 6c74 2e61 7070 656e 6428 7475 706c 6528  lt.append(tuple(
+00029220: 7368 6170 6528 6465 6570 6669 7273 7428  shape(deepfirst(
+00029230: 6129 295b 6469 6d5d 2066 6f72 2061 2069  a))[dim] for a i
+00029240: 6e20 6172 7261 7973 2929 0a20 2020 2020  n arrays)).     
+00029250: 2020 2061 7272 6179 7320 3d20 6172 7261     arrays = arra
+00029260: 7973 5b30 5d0a 2020 2020 2020 2020 6469  ys[0].        di
+00029270: 6d20 2b3d 2031 0a20 2020 2072 6574 7572  m += 1.    retur
+00029280: 6e20 7475 706c 6528 7265 7375 6c74 290a  n tuple(result).
+00029290: 0a0a 6465 6620 6465 6570 6669 7273 7428  ..def deepfirst(
+000292a0: 7365 7129 3a0a 2020 2020 2222 2246 6972  seq):.    """Fir
+000292b0: 7374 2065 6c65 6d65 6e74 2069 6e20 6120  st element in a 
+000292c0: 6e65 7374 6564 206c 6973 740a 0a20 2020  nested list..   
+000292d0: 203e 3e3e 2064 6565 7066 6972 7374 285b   >>> deepfirst([
+000292e0: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
+000292f0: 2c20 5b35 2c20 365d 2c20 5b37 2c20 385d  , [5, 6], [7, 8]
+00029300: 5d29 0a20 2020 2031 0a20 2020 2022 2222  ]).    1.    """
+00029310: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
+00029320: 7374 616e 6365 2873 6571 2c20 286c 6973  stance(seq, (lis
+00029330: 742c 2074 7570 6c65 2929 3a0a 2020 2020  t, tuple)):.    
+00029340: 2020 2020 7265 7475 726e 2073 6571 0a20      return seq. 
+00029350: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00029360: 2072 6574 7572 6e20 6465 6570 6669 7273   return deepfirs
+00029370: 7428 7365 715b 305d 290a 0a0a 6465 6620  t(seq[0])...def 
+00029380: 7368 6170 656c 6973 7428 6129 3a0a 2020  shapelist(a):.  
+00029390: 2020 2222 2247 6574 2074 6865 2073 6861    """Get the sha
+000293a0: 7065 206f 6620 6e65 7374 6564 206c 6973  pe of nested lis
+000293b0: 7422 2222 0a20 2020 2069 6620 7479 7065  t""".    if type
+000293c0: 2861 2920 6973 206c 6973 743a 0a20 2020  (a) is list:.   
+000293d0: 2020 2020 2072 6574 7572 6e20 7475 706c       return tupl
+000293e0: 6528 5b6c 656e 2861 295d 202b 206c 6973  e([len(a)] + lis
+000293f0: 7428 7368 6170 656c 6973 7428 615b 305d  t(shapelist(a[0]
+00029400: 2929 290a 2020 2020 656c 7365 3a0a 2020  ))).    else:.  
+00029410: 2020 2020 2020 7265 7475 726e 2028 290a        return ().
+00029420: 0a0a 6465 6620 7472 616e 7370 6f73 656c  ..def transposel
+00029430: 6973 7428 6172 7261 7973 2c20 6178 6573  ist(arrays, axes
+00029440: 2c20 6578 7472 6164 696d 733d 3029 3a0a  , extradims=0):.
+00029450: 2020 2020 2222 2250 6572 6d75 7465 2061      """Permute a
+00029460: 7865 7320 6f66 206e 6573 7465 6420 6c69  xes of nested li
+00029470: 7374 0a0a 2020 2020 3e3e 3e20 7472 616e  st..    >>> tran
+00029480: 7370 6f73 656c 6973 7428 5b5b 312c 312c  sposelist([[1,1,
+00029490: 315d 2c5b 312c 312c 315d 5d2c 205b 322c  1],[1,1,1]], [2,
+000294a0: 315d 290a 2020 2020 5b5b 5b31 2c20 315d  1]).    [[[1, 1]
+000294b0: 2c20 5b31 2c20 315d 2c20 5b31 2c20 315d  , [1, 1], [1, 1]
+000294c0: 5d5d 0a0a 2020 2020 3e3e 3e20 7472 616e  ]]..    >>> tran
+000294d0: 7370 6f73 656c 6973 7428 5b5b 312c 312c  sposelist([[1,1,
+000294e0: 315d 2c5b 312c 312c 315d 5d2c 205b 322c  1],[1,1,1]], [2,
+000294f0: 315d 2c20 6578 7472 6164 696d 733d 3129  1], extradims=1)
+00029500: 0a20 2020 205b 5b5b 5b31 5d2c 205b 315d  .    [[[[1], [1]
+00029510: 5d2c 205b 5b31 5d2c 205b 315d 5d2c 205b  ], [[1], [1]], [
+00029520: 5b31 5d2c 205b 315d 5d5d 5d0a 2020 2020  [1], [1]]]].    
+00029530: 2222 220a 2020 2020 6966 206c 656e 2861  """.    if len(a
+00029540: 7865 7329 2021 3d20 6e64 696d 6c69 7374  xes) != ndimlist
+00029550: 2861 7272 6179 7329 3a0a 2020 2020 2020  (arrays):.      
+00029560: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00029570: 6f72 2822 4c65 6e67 7468 206f 6620 6178  or("Length of ax
+00029580: 6573 2073 686f 756c 6420 6571 7561 6c20  es should equal 
+00029590: 6465 7074 6820 6f66 206e 6573 7465 6420  depth of nested 
+000295a0: 6172 7261 7973 2229 0a20 2020 2069 6620  arrays").    if 
+000295b0: 6578 7472 6164 696d 7320 3c20 303a 0a20  extradims < 0:. 
+000295c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000295d0: 7565 4572 726f 7228 2260 6e65 7764 696d  ueError("`newdim
+000295e0: 7360 2073 686f 756c 6420 6265 2070 6f73  s` should be pos
+000295f0: 6974 6976 6522 290a 2020 2020 6966 206c  itive").    if l
+00029600: 656e 2861 7865 7329 203e 206c 656e 2873  en(axes) > len(s
+00029610: 6574 2861 7865 7329 293a 0a20 2020 2020  et(axes)):.     
+00029620: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00029630: 726f 7228 2260 6178 6573 6020 7368 6f75  ror("`axes` shou
+00029640: 6c64 2062 6520 756e 6971 7565 2229 0a0a  ld be unique")..
+00029650: 2020 2020 6e64 696d 203d 206d 6178 2861      ndim = max(a
+00029660: 7865 7329 202b 2031 0a20 2020 2073 6861  xes) + 1.    sha
+00029670: 7065 203d 2073 6861 7065 6c69 7374 2861  pe = shapelist(a
+00029680: 7272 6179 7329 0a20 2020 206e 6577 7368  rrays).    newsh
+00029690: 6170 6520 3d20 5b0a 2020 2020 2020 2020  ape = [.        
+000296a0: 7368 6170 655b 6178 6573 2e69 6e64 6578  shape[axes.index
+000296b0: 2869 295d 2069 6620 6920 696e 2061 7865  (i)] if i in axe
+000296c0: 7320 656c 7365 2031 2066 6f72 2069 2069  s else 1 for i i
+000296d0: 6e20 7261 6e67 6528 6e64 696d 202b 2065  n range(ndim + e
+000296e0: 7874 7261 6469 6d73 290a 2020 2020 5d0a  xtradims).    ].
+000296f0: 0a20 2020 2072 6573 756c 7420 3d20 6c69  .    result = li
+00029700: 7374 2863 6f72 652e 666c 6174 7465 6e28  st(core.flatten(
+00029710: 6172 7261 7973 2929 0a20 2020 2072 6574  arrays)).    ret
+00029720: 7572 6e20 7265 7368 6170 656c 6973 7428  urn reshapelist(
+00029730: 6e65 7773 6861 7065 2c20 7265 7375 6c74  newshape, result
+00029740: 290a 0a0a 6465 6620 7374 6163 6b28 7365  )...def stack(se
+00029750: 712c 2061 7869 733d 302c 2061 6c6c 6f77  q, axis=0, allow
+00029760: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
+00029770: 7a65 733d 4661 6c73 6529 3a0a 2020 2020  zes=False):.    
+00029780: 2222 220a 2020 2020 5374 6163 6b20 6172  """.    Stack ar
+00029790: 7261 7973 2061 6c6f 6e67 2061 206e 6577  rays along a new
+000297a0: 2061 7869 730a 0a20 2020 2047 6976 656e   axis..    Given
+000297b0: 2061 2073 6571 7565 6e63 6520 6f66 2064   a sequence of d
+000297c0: 6173 6b20 6172 7261 7973 2c20 666f 726d  ask arrays, form
+000297d0: 2061 206e 6577 2064 6173 6b20 6172 7261   a new dask arra
+000297e0: 7920 6279 2073 7461 636b 696e 6720 7468  y by stacking th
+000297f0: 656d 0a20 2020 2061 6c6f 6e67 2061 206e  em.    along a n
+00029800: 6577 2064 696d 656e 7369 6f6e 2028 6178  ew dimension (ax
+00029810: 6973 3d30 2062 7920 6465 6661 756c 7429  is=0 by default)
+00029820: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00029830: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00029840: 2020 2020 7365 713a 206c 6973 7420 6f66      seq: list of
+00029850: 2064 6173 6b2e 6172 7261 7973 0a20 2020   dask.arrays.   
+00029860: 2061 7869 733a 2069 6e74 0a20 2020 2020   axis: int.     
+00029870: 2020 2044 696d 656e 7369 6f6e 2061 6c6f     Dimension alo
+00029880: 6e67 2077 6869 6368 2074 6f20 616c 6967  ng which to alig
+00029890: 6e20 616c 6c20 6f66 2074 6865 2061 7272  n all of the arr
+000298a0: 6179 730a 2020 2020 616c 6c6f 775f 756e  ays.    allow_un
+000298b0: 6b6e 6f77 6e5f 6368 756e 6b73 697a 6573  known_chunksizes
+000298c0: 3a20 626f 6f6c 0a20 2020 2020 2020 2041  : bool.        A
+000298d0: 6c6c 6f77 2075 6e6b 6e6f 776e 2063 6875  llow unknown chu
+000298e0: 6e6b 7369 7a65 732c 2073 7563 6820 6173  nksizes, such as
+000298f0: 2063 6f6d 6520 6672 6f6d 2063 6f6e 7665   come from conve
+00029900: 7274 696e 6720 6672 6f6d 2064 6173 6b0a  rting from dask.
+00029910: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
+00029920: 6573 2e20 2044 6173 6b2e 6172 7261 7920  es.  Dask.array 
+00029930: 6973 2075 6e61 626c 6520 746f 2076 6572  is unable to ver
+00029940: 6966 7920 7468 6174 2063 6875 6e6b 7320  ify that chunks 
+00029950: 6c69 6e65 2075 702e 2020 4966 0a20 2020  line up.  If.   
+00029960: 2020 2020 2064 6174 6120 636f 6d65 7320       data comes 
+00029970: 6672 6f6d 2064 6966 6665 7265 6e74 6c79  from differently
+00029980: 2061 6c69 676e 6564 2073 6f75 7263 6573   aligned sources
+00029990: 2074 6865 6e20 7468 6973 2063 616e 2063   then this can c
+000299a0: 6175 7365 0a20 2020 2020 2020 2075 6e65  ause.        une
+000299b0: 7870 6563 7465 6420 7265 7375 6c74 732e  xpected results.
+000299c0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+000299d0: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
+000299e0: 2043 7265 6174 6520 736c 6963 6573 0a0a   Create slices..
+000299f0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+00029a00: 6173 6b2e 6172 7261 7920 6173 2064 610a  ask.array as da.
+00029a10: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
+00029a20: 756d 7079 2061 7320 6e70 0a0a 2020 2020  umpy as np..    
+00029a30: 3e3e 3e20 6461 7461 203d 205b 6461 2e66  >>> data = [da.f
+00029a40: 726f 6d5f 6172 7261 7928 6e70 2e6f 6e65  rom_array(np.one
+00029a50: 7328 2834 2c20 3429 292c 2063 6875 6e6b  s((4, 4)), chunk
+00029a60: 733d 2832 2c20 3229 290a 2020 2020 2e2e  s=(2, 2)).    ..
+00029a70: 2e20 2020 2020 2020 2020 666f 7220 6920  .         for i 
+00029a80: 696e 2072 616e 6765 2833 295d 0a0a 2020  in range(3)]..  
+00029a90: 2020 3e3e 3e20 7820 3d20 6461 2e73 7461    >>> x = da.sta
+00029aa0: 636b 2864 6174 612c 2061 7869 733d 3029  ck(data, axis=0)
+00029ab0: 0a20 2020 203e 3e3e 2078 2e73 6861 7065  .    >>> x.shape
+00029ac0: 0a20 2020 2028 332c 2034 2c20 3429 0a0a  .    (3, 4, 4)..
+00029ad0: 2020 2020 3e3e 3e20 6461 2e73 7461 636b      >>> da.stack
+00029ae0: 2864 6174 612c 2061 7869 733d 3129 2e73  (data, axis=1).s
+00029af0: 6861 7065 0a20 2020 2028 342c 2033 2c20  hape.    (4, 3, 
+00029b00: 3429 0a0a 2020 2020 3e3e 3e20 6461 2e73  4)..    >>> da.s
+00029b10: 7461 636b 2864 6174 612c 2061 7869 733d  tack(data, axis=
+00029b20: 2d31 292e 7368 6170 650a 2020 2020 2834  -1).shape.    (4
+00029b30: 2c20 342c 2033 290a 0a20 2020 2052 6573  , 4, 3)..    Res
+00029b40: 756c 7420 6973 2061 206e 6577 2064 6173  ult is a new das
+00029b50: 6b20 4172 7261 790a 0a20 2020 2053 6565  k Array..    See
+00029b60: 2041 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   Also.    ------
+00029b70: 2d2d 0a20 2020 2063 6f6e 6361 7465 6e61  --.    concatena
+00029b80: 7465 0a20 2020 2022 2222 0a20 2020 2066  te.    """.    f
+00029b90: 726f 6d20 6461 736b 2e61 7272 6179 2069  rom dask.array i
+00029ba0: 6d70 6f72 7420 7772 6170 0a0a 2020 2020  mport wrap..    
+00029bb0: 7365 7120 3d20 5b61 7361 7272 6179 2861  seq = [asarray(a
+00029bc0: 2c20 616c 6c6f 775f 756e 6b6e 6f77 6e5f  , allow_unknown_
+00029bd0: 6368 756e 6b73 697a 6573 3d61 6c6c 6f77  chunksizes=allow
+00029be0: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
+00029bf0: 7a65 7329 2066 6f72 2061 2069 6e20 7365  zes) for a in se
+00029c00: 715d 0a0a 2020 2020 6966 206e 6f74 2073  q]..    if not s
+00029c10: 6571 3a0a 2020 2020 2020 2020 7261 6973  eq:.        rais
+00029c20: 6520 5661 6c75 6545 7272 6f72 2822 4e65  e ValueError("Ne
+00029c30: 6564 2061 7272 6179 2873 2920 746f 2073  ed array(s) to s
+00029c40: 7461 636b 2229 0a20 2020 2069 6620 6e6f  tack").    if no
+00029c50: 7420 616c 6c6f 775f 756e 6b6e 6f77 6e5f  t allow_unknown_
+00029c60: 6368 756e 6b73 697a 6573 2061 6e64 206e  chunksizes and n
+00029c70: 6f74 2061 6c6c 2878 2e73 6861 7065 203d  ot all(x.shape =
+00029c80: 3d20 7365 715b 305d 2e73 6861 7065 2066  = seq[0].shape f
+00029c90: 6f72 2078 2069 6e20 7365 7129 3a0a 2020  or x in seq):.  
+00029ca0: 2020 2020 2020 6964 7820 3d20 6669 7273        idx = firs
+00029cb0: 7428 6920 666f 7220 6920 696e 2065 6e75  t(i for i in enu
+00029cc0: 6d65 7261 7465 2873 6571 2920 6966 2069  merate(seq) if i
+00029cd0: 5b31 5d2e 7368 6170 6520 213d 2073 6571  [1].shape != seq
+00029ce0: 5b30 5d2e 7368 6170 6529 0a20 2020 2020  [0].shape).     
+00029cf0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00029d00: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00029d10: 2022 5374 6163 6b65 6420 6172 7261 7973   "Stacked arrays
+00029d20: 206d 7573 7420 6861 7665 2074 6865 2073   must have the s
+00029d30: 616d 6520 7368 6170 652e 2054 6865 2066  ame shape. The f
+00029d40: 6972 7374 2061 7272 6179 2068 6164 2073  irst array had s
+00029d50: 6861 7065 2022 0a20 2020 2020 2020 2020  hape ".         
+00029d60: 2020 2066 227b 7365 715b 305d 2e73 6861     f"{seq[0].sha
+00029d70: 7065 7d2c 2077 6869 6c65 2061 7272 6179  pe}, while array
+00029d80: 207b 6964 785b 305d 202b 2031 7d20 6861   {idx[0] + 1} ha
+00029d90: 7320 7368 6170 6520 7b69 6478 5b31 5d2e  s shape {idx[1].
+00029da0: 7368 6170 657d 2e22 0a20 2020 2020 2020  shape}.".       
+00029db0: 2029 0a0a 2020 2020 6d65 7461 203d 206e   )..    meta = n
+00029dc0: 702e 7374 6163 6b28 5b6d 6574 615f 6672  p.stack([meta_fr
+00029dd0: 6f6d 5f61 7272 6179 2861 2920 666f 7220  om_array(a) for 
+00029de0: 6120 696e 2073 6571 5d2c 2061 7869 733d  a in seq], axis=
+00029df0: 6178 6973 290a 2020 2020 7365 7120 3d20  axis).    seq = 
+00029e00: 5b78 2e61 7374 7970 6528 6d65 7461 2e64  [x.astype(meta.d
+00029e10: 7479 7065 2920 666f 7220 7820 696e 2073  type) for x in s
+00029e20: 6571 5d0a 0a20 2020 206e 6469 6d20 3d20  eq]..    ndim = 
+00029e30: 6d65 7461 2e6e 6469 6d20 2d20 310a 2020  meta.ndim - 1.  
+00029e40: 2020 6966 2061 7869 7320 3c20 303a 0a20    if axis < 0:. 
+00029e50: 2020 2020 2020 2061 7869 7320 3d20 6e64         axis = nd
+00029e60: 696d 202b 2061 7869 7320 2b20 310a 2020  im + axis + 1.  
+00029e70: 2020 7368 6170 6520 3d20 7475 706c 6528    shape = tuple(
+00029e80: 0a20 2020 2020 2020 206c 656e 2873 6571  .        len(seq
+00029e90: 290a 2020 2020 2020 2020 6966 2069 203d  ).        if i =
+00029ea0: 3d20 6178 6973 0a20 2020 2020 2020 2065  = axis.        e
+00029eb0: 6c73 6520 2873 6571 5b30 5d2e 7368 6170  lse (seq[0].shap
+00029ec0: 655b 695d 2069 6620 6920 3c20 6178 6973  e[i] if i < axis
+00029ed0: 2065 6c73 6520 7365 715b 305d 2e73 6861   else seq[0].sha
+00029ee0: 7065 5b69 202d 2031 5d29 0a20 2020 2020  pe[i - 1]).     
+00029ef0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00029f00: 6528 6d65 7461 2e6e 6469 6d29 0a20 2020  e(meta.ndim).   
+00029f10: 2029 0a0a 2020 2020 7365 7132 203d 205b   )..    seq2 = [
+00029f20: 6120 666f 7220 6120 696e 2073 6571 2069  a for a in seq i
+00029f30: 6620 612e 7369 7a65 5d0a 2020 2020 6966  f a.size].    if
+00029f40: 206e 6f74 2073 6571 323a 0a20 2020 2020   not seq2:.     
+00029f50: 2020 2073 6571 3220 3d20 7365 710a 0a20     seq2 = seq.. 
+00029f60: 2020 206e 203d 206c 656e 2873 6571 3229     n = len(seq2)
+00029f70: 0a20 2020 2069 6620 6e20 3d3d 2030 3a0a  .    if n == 0:.
+00029f80: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00029f90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00029fa0: 7772 6170 2e65 6d70 7479 5f6c 696b 6528  wrap.empty_like(
+00029fb0: 6d65 7461 2c20 7368 6170 653d 7368 6170  meta, shape=shap
+00029fc0: 652c 2063 6875 6e6b 733d 7368 6170 652c  e, chunks=shape,
+00029fd0: 2064 7479 7065 3d6d 6574 612e 6474 7970   dtype=meta.dtyp
+00029fe0: 6529 0a20 2020 2020 2020 2065 7863 6570  e).        excep
+00029ff0: 7420 5479 7065 4572 726f 723a 0a20 2020  t TypeError:.   
+0002a000: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002a010: 7772 6170 2e65 6d70 7479 2873 6861 7065  wrap.empty(shape
+0002a020: 2c20 6368 756e 6b73 3d73 6861 7065 2c20  , chunks=shape, 
+0002a030: 6474 7970 653d 6d65 7461 2e64 7479 7065  dtype=meta.dtype
+0002a040: 290a 0a20 2020 2069 6e64 203d 206c 6973  )..    ind = lis
+0002a050: 7428 7261 6e67 6528 6e64 696d 2929 0a20  t(range(ndim)). 
+0002a060: 2020 2075 635f 6172 6773 203d 206c 6973     uc_args = lis
+0002a070: 7428 636f 6e63 6174 2828 782c 2069 6e64  t(concat((x, ind
+0002a080: 2920 666f 7220 7820 696e 2073 6571 3229  ) for x in seq2)
+0002a090: 290a 2020 2020 5f2c 2073 6571 3220 3d20  ).    _, seq2 = 
+0002a0a0: 756e 6966 795f 6368 756e 6b73 282a 7563  unify_chunks(*uc
+0002a0b0: 5f61 7267 7329 0a0a 2020 2020 6173 7365  _args)..    asse
+0002a0c0: 7274 206c 656e 287b 612e 6368 756e 6b73  rt len({a.chunks
+0002a0d0: 2066 6f72 2061 2069 6e20 7365 7132 7d29   for a in seq2})
+0002a0e0: 203d 3d20 3120 2023 2073 616d 6520 6368   == 1  # same ch
+0002a0f0: 756e 6b73 0a20 2020 2063 6875 6e6b 7320  unks.    chunks 
+0002a100: 3d20 7365 7132 5b30 5d2e 6368 756e 6b73  = seq2[0].chunks
+0002a110: 5b3a 6178 6973 5d20 2b20 2828 312c 2920  [:axis] + ((1,) 
+0002a120: 2a20 6e2c 2920 2b20 7365 7132 5b30 5d2e  * n,) + seq2[0].
+0002a130: 6368 756e 6b73 5b61 7869 733a 5d0a 0a20  chunks[axis:].. 
+0002a140: 2020 206e 616d 6573 203d 205b 612e 6e61     names = [a.na
+0002a150: 6d65 2066 6f72 2061 2069 6e20 7365 7132  me for a in seq2
+0002a160: 5d0a 2020 2020 6e61 6d65 203d 2022 7374  ].    name = "st
+0002a170: 6163 6b2d 2220 2b20 746f 6b65 6e69 7a65  ack-" + tokenize
+0002a180: 286e 616d 6573 2c20 6178 6973 290a 2020  (names, axis).  
+0002a190: 2020 6b65 7973 203d 206c 6973 7428 7072    keys = list(pr
+0002a1a0: 6f64 7563 7428 5b6e 616d 655d 2c20 2a5b  oduct([name], *[
+0002a1b0: 7261 6e67 6528 6c65 6e28 6264 2929 2066  range(len(bd)) f
+0002a1c0: 6f72 2062 6420 696e 2063 6875 6e6b 735d  or bd in chunks]
+0002a1d0: 2929 0a0a 2020 2020 696e 7075 7473 203d  ))..    inputs =
+0002a1e0: 205b 0a20 2020 2020 2020 2028 6e61 6d65   [.        (name
+0002a1f0: 735b 6b65 795b 6178 6973 202b 2031 5d5d  s[key[axis + 1]]
+0002a200: 2c29 202b 206b 6579 5b31 203a 2061 7869  ,) + key[1 : axi
+0002a210: 7320 2b20 315d 202b 206b 6579 5b61 7869  s + 1] + key[axi
+0002a220: 7320 2b20 3220 3a5d 2066 6f72 206b 6579  s + 2 :] for key
+0002a230: 2069 6e20 6b65 7973 0a20 2020 205d 0a20   in keys.    ]. 
+0002a240: 2020 2076 616c 7565 7320 3d20 5b0a 2020     values = [.  
+0002a250: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+0002a260: 2020 2020 6765 7469 7465 6d2c 0a20 2020      getitem,.   
+0002a270: 2020 2020 2020 2020 2069 6e70 2c0a 2020           inp,.  
+0002a280: 2020 2020 2020 2020 2020 2873 6c69 6365            (slice
+0002a290: 284e 6f6e 652c 204e 6f6e 652c 204e 6f6e  (None, None, Non
+0002a2a0: 6529 2c29 202a 2061 7869 730a 2020 2020  e),) * axis.    
+0002a2b0: 2020 2020 2020 2020 2b20 284e 6f6e 652c          + (None,
+0002a2c0: 290a 2020 2020 2020 2020 2020 2020 2b20  ).            + 
+0002a2d0: 2873 6c69 6365 284e 6f6e 652c 204e 6f6e  (slice(None, Non
+0002a2e0: 652c 204e 6f6e 6529 2c29 202a 2028 6e64  e, None),) * (nd
+0002a2f0: 696d 202d 2061 7869 7329 2c0a 2020 2020  im - axis),.    
+0002a300: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
+0002a310: 7220 696e 7020 696e 2069 6e70 7574 730a  r inp in inputs.
+0002a320: 2020 2020 5d0a 0a20 2020 206c 6179 6572      ]..    layer
+0002a330: 203d 2064 6963 7428 7a69 7028 6b65 7973   = dict(zip(keys
+0002a340: 2c20 7661 6c75 6573 2929 0a20 2020 2067  , values)).    g
+0002a350: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0002a360: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0002a370: 6374 696f 6e73 286e 616d 652c 206c 6179  ctions(name, lay
+0002a380: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
+0002a390: 3d73 6571 3229 0a0a 2020 2020 7265 7475  =seq2)..    retu
+0002a3a0: 726e 2041 7272 6179 2867 7261 7068 2c20  rn Array(graph, 
+0002a3b0: 6e61 6d65 2c20 6368 756e 6b73 2c20 6d65  name, chunks, me
+0002a3c0: 7461 3d6d 6574 6129 0a0a 0a64 6566 2063  ta=meta)...def c
+0002a3d0: 6f6e 6361 7465 6e61 7465 3328 6172 7261  oncatenate3(arra
+0002a3e0: 7973 293a 0a20 2020 2022 2222 5265 6375  ys):.    """Recu
+0002a3f0: 7273 6976 6520 6e70 2e63 6f6e 6361 7465  rsive np.concate
+0002a400: 6e61 7465 0a0a 2020 2020 496e 7075 7420  nate..    Input 
+0002a410: 7368 6f75 6c64 2062 6520 6120 6e65 7374  should be a nest
+0002a420: 6564 206c 6973 7420 6f66 206e 756d 7079  ed list of numpy
+0002a430: 2061 7272 6179 7320 6172 7261 6e67 6564   arrays arranged
+0002a440: 2069 6e20 7468 6520 6f72 6465 7220 7468   in the order th
+0002a450: 6579 0a20 2020 2073 686f 756c 6420 6170  ey.    should ap
+0002a460: 7065 6172 2069 6e20 7468 6520 6172 7261  pear in the arra
+0002a470: 7920 6974 7365 6c66 2e20 2045 6163 6820  y itself.  Each 
+0002a480: 6172 7261 7920 7368 6f75 6c64 2068 6176  array should hav
+0002a490: 6520 7468 6520 7361 6d65 206e 756d 6265  e the same numbe
+0002a4a0: 720a 2020 2020 6f66 2064 696d 656e 7369  r.    of dimensi
+0002a4b0: 6f6e 7320 6173 2074 6865 2064 6573 6972  ons as the desir
+0002a4c0: 6564 206f 7574 7075 7420 616e 6420 7468  ed output and th
+0002a4d0: 6520 6e65 7374 696e 6720 6f66 2074 6865  e nesting of the
+0002a4e0: 206c 6973 7473 2e0a 0a20 2020 203e 3e3e   lists...    >>>
+0002a4f0: 2078 203d 206e 702e 6172 7261 7928 5b5b   x = np.array([[
+0002a500: 312c 2032 5d5d 290a 2020 2020 3e3e 3e20  1, 2]]).    >>> 
+0002a510: 636f 6e63 6174 656e 6174 6533 285b 5b78  concatenate3([[x
+0002a520: 2c20 782c 2078 5d2c 205b 782c 2078 2c20  , x, x], [x, x, 
+0002a530: 785d 5d29 0a20 2020 2061 7272 6179 285b  x]]).    array([
+0002a540: 5b31 2c20 322c 2031 2c20 322c 2031 2c20  [1, 2, 1, 2, 1, 
+0002a550: 325d 2c0a 2020 2020 2020 2020 2020 205b  2],.           [
+0002a560: 312c 2032 2c20 312c 2032 2c20 312c 2032  1, 2, 1, 2, 1, 2
+0002a570: 5d5d 290a 0a20 2020 203e 3e3e 2063 6f6e  ]])..    >>> con
+0002a580: 6361 7465 6e61 7465 3328 5b5b 782c 2078  catenate3([[x, x
+0002a590: 5d2c 205b 782c 2078 5d2c 205b 782c 2078  ], [x, x], [x, x
+0002a5a0: 5d5d 290a 2020 2020 6172 7261 7928 5b5b  ]]).    array([[
+0002a5b0: 312c 2032 2c20 312c 2032 5d2c 0a20 2020  1, 2, 1, 2],.   
+0002a5c0: 2020 2020 2020 2020 5b31 2c20 322c 2031          [1, 2, 1
+0002a5d0: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
+0002a5e0: 205b 312c 2032 2c20 312c 2032 5d5d 290a   [1, 2, 1, 2]]).
+0002a5f0: 2020 2020 2222 220a 2020 2020 2320 5765      """.    # We
+0002a600: 206e 6565 6420 7468 6973 2061 7320 5f5f   need this as __
+0002a610: 6172 7261 795f 6675 6e63 7469 6f6e 5f5f  array_function__
+0002a620: 206d 6179 206e 6f74 2065 7869 7374 206f   may not exist o
+0002a630: 6e20 6f6c 6465 7220 4e75 6d50 7920 7665  n older NumPy ve
+0002a640: 7273 696f 6e73 2e0a 2020 2020 2320 416e  rsions..    # An
+0002a650: 6420 746f 2072 6564 7563 6520 7665 7262  d to reduce verb
+0002a660: 6f73 6974 792e 0a20 2020 204e 4441 5252  osity..    NDARR
+0002a670: 4159 5f41 5252 4159 5f46 554e 4354 494f  AY_ARRAY_FUNCTIO
+0002a680: 4e20 3d20 6765 7461 7474 7228 6e70 2e6e  N = getattr(np.n
+0002a690: 6461 7272 6179 2c20 225f 5f61 7272 6179  darray, "__array
+0002a6a0: 5f66 756e 6374 696f 6e5f 5f22 2c20 4e6f  _function__", No
+0002a6b0: 6e65 290a 0a20 2020 2061 7272 6179 7320  ne)..    arrays 
+0002a6c0: 3d20 636f 6e63 7265 7465 2861 7272 6179  = concrete(array
+0002a6d0: 7329 0a20 2020 2069 6620 6e6f 7420 6172  s).    if not ar
+0002a6e0: 7261 7973 3a0a 2020 2020 2020 2020 7265  rays:.        re
+0002a6f0: 7475 726e 206e 702e 656d 7074 7928 3029  turn np.empty(0)
+0002a700: 0a0a 2020 2020 6164 7661 6e63 6564 203d  ..    advanced =
+0002a710: 206d 6178 280a 2020 2020 2020 2020 636f   max(.        co
+0002a720: 7265 2e66 6c61 7474 656e 2861 7272 6179  re.flatten(array
+0002a730: 732c 2063 6f6e 7461 696e 6572 3d28 6c69  s, container=(li
+0002a740: 7374 2c20 7475 706c 6529 292c 0a20 2020  st, tuple)),.   
+0002a750: 2020 2020 206b 6579 3d6c 616d 6264 6120       key=lambda 
+0002a760: 783a 2067 6574 6174 7472 2878 2c20 225f  x: getattr(x, "_
+0002a770: 5f61 7272 6179 5f70 7269 6f72 6974 795f  _array_priority_
+0002a780: 5f22 2c20 3029 2c0a 2020 2020 290a 0a20  _", 0),.    ).. 
+0002a790: 2020 2069 6620 6e6f 7420 616c 6c28 0a20     if not all(. 
+0002a7a0: 2020 2020 2020 204e 4441 5252 4159 5f41         NDARRAY_A
+0002a7b0: 5252 4159 5f46 554e 4354 494f 4e0a 2020  RRAY_FUNCTION.  
+0002a7c0: 2020 2020 2020 6973 2067 6574 6174 7472        is getattr
+0002a7d0: 2874 7970 6528 6172 7229 2c20 225f 5f61  (type(arr), "__a
+0002a7e0: 7272 6179 5f66 756e 6374 696f 6e5f 5f22  rray_function__"
+0002a7f0: 2c20 4e44 4152 5241 595f 4152 5241 595f  , NDARRAY_ARRAY_
+0002a800: 4655 4e43 5449 4f4e 290a 2020 2020 2020  FUNCTION).      
+0002a810: 2020 666f 7220 6172 7220 696e 2063 6f72    for arr in cor
+0002a820: 652e 666c 6174 7465 6e28 6172 7261 7973  e.flatten(arrays
+0002a830: 2c20 636f 6e74 6169 6e65 723d 286c 6973  , container=(lis
+0002a840: 742c 2074 7570 6c65 2929 0a20 2020 2029  t, tuple)).    )
+0002a850: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+0002a860: 2020 2020 2020 2020 2020 2078 203d 2075             x = u
+0002a870: 6e70 6163 6b5f 7369 6e67 6c65 746f 6e28  npack_singleton(
+0002a880: 6172 7261 7973 290a 2020 2020 2020 2020  arrays).        
+0002a890: 2020 2020 7265 7475 726e 205f 636f 6e63      return _conc
+0002a8a0: 6174 656e 6174 6532 2861 7272 6179 732c  atenate2(arrays,
+0002a8b0: 2061 7865 733d 7475 706c 6528 7261 6e67   axes=tuple(rang
+0002a8c0: 6528 782e 6e64 696d 2929 290a 2020 2020  e(x.ndim))).    
+0002a8d0: 2020 2020 6578 6365 7074 2054 7970 6545      except TypeE
+0002a8e0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+0002a8f0: 2020 7061 7373 0a0a 2020 2020 6966 2063    pass..    if c
+0002a900: 6f6e 6361 7465 6e61 7465 5f6c 6f6f 6b75  oncatenate_looku
+0002a910: 702e 6469 7370 6174 6368 2874 7970 6528  p.dispatch(type(
+0002a920: 6164 7661 6e63 6564 2929 2069 7320 6e6f  advanced)) is no
+0002a930: 7420 6e70 2e63 6f6e 6361 7465 6e61 7465  t np.concatenate
+0002a940: 3a0a 2020 2020 2020 2020 7820 3d20 756e  :.        x = un
+0002a950: 7061 636b 5f73 696e 676c 6574 6f6e 2861  pack_singleton(a
+0002a960: 7272 6179 7329 0a20 2020 2020 2020 2072  rrays).        r
+0002a970: 6574 7572 6e20 5f63 6f6e 6361 7465 6e61  eturn _concatena
+0002a980: 7465 3228 6172 7261 7973 2c20 6178 6573  te2(arrays, axes
+0002a990: 3d6c 6973 7428 7261 6e67 6528 782e 6e64  =list(range(x.nd
+0002a9a0: 696d 2929 290a 0a20 2020 206e 6469 6d20  im)))..    ndim 
+0002a9b0: 3d20 6e64 696d 6c69 7374 2861 7272 6179  = ndimlist(array
+0002a9c0: 7329 0a20 2020 2069 6620 6e6f 7420 6e64  s).    if not nd
+0002a9d0: 696d 3a0a 2020 2020 2020 2020 7265 7475  im:.        retu
+0002a9e0: 726e 2061 7272 6179 730a 2020 2020 6368  rn arrays.    ch
+0002a9f0: 756e 6b73 203d 2063 6875 6e6b 735f 6672  unks = chunks_fr
+0002aa00: 6f6d 5f61 7272 6179 7328 6172 7261 7973  om_arrays(arrays
+0002aa10: 290a 2020 2020 7368 6170 6520 3d20 7475  ).    shape = tu
+0002aa20: 706c 6528 6d61 7028 7375 6d2c 2063 6875  ple(map(sum, chu
+0002aa30: 6e6b 7329 290a 0a20 2020 2064 6566 2064  nks))..    def d
+0002aa40: 7479 7065 2878 293a 0a20 2020 2020 2020  type(x):.       
+0002aa50: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0002aa60: 2020 7265 7475 726e 2078 2e64 7479 7065    return x.dtype
+0002aa70: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0002aa80: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
+0002aa90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002aaa0: 726e 2074 7970 6528 7829 0a0a 2020 2020  rn type(x)..    
+0002aab0: 7265 7375 6c74 203d 206e 702e 656d 7074  result = np.empt
+0002aac0: 7928 7368 6170 653d 7368 6170 652c 2064  y(shape=shape, d
+0002aad0: 7479 7065 3d64 7479 7065 2864 6565 7066  type=dtype(deepf
+0002aae0: 6972 7374 2861 7272 6179 7329 2929 0a0a  irst(arrays)))..
+0002aaf0: 2020 2020 666f 7220 6964 782c 2061 7272      for idx, arr
+0002ab00: 2069 6e20 7a69 7028 0a20 2020 2020 2020   in zip(.       
+0002ab10: 2073 6c69 6365 735f 6672 6f6d 5f63 6875   slices_from_chu
+0002ab20: 6e6b 7328 6368 756e 6b73 292c 2063 6f72  nks(chunks), cor
+0002ab30: 652e 666c 6174 7465 6e28 6172 7261 7973  e.flatten(arrays
+0002ab40: 2c20 636f 6e74 6169 6e65 723d 286c 6973  , container=(lis
+0002ab50: 742c 2074 7570 6c65 2929 0a20 2020 2029  t, tuple)).    )
+0002ab60: 3a0a 2020 2020 2020 2020 6966 2068 6173  :.        if has
+0002ab70: 6174 7472 2861 7272 2c20 226e 6469 6d22  attr(arr, "ndim"
+0002ab80: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+0002ab90: 6869 6c65 2061 7272 2e6e 6469 6d20 3c20  hile arr.ndim < 
+0002aba0: 6e64 696d 3a0a 2020 2020 2020 2020 2020  ndim:.          
+0002abb0: 2020 2020 2020 6172 7220 3d20 6172 725b        arr = arr[
+0002abc0: 4e6f 6e65 2c20 2e2e 2e5d 0a20 2020 2020  None, ...].     
+0002abd0: 2020 2072 6573 756c 745b 6964 785d 203d     result[idx] =
+0002abe0: 2061 7272 0a0a 2020 2020 7265 7475 726e   arr..    return
+0002abf0: 2072 6573 756c 740a 0a0a 6465 6620 636f   result...def co
+0002ac00: 6e63 6174 656e 6174 655f 6178 6573 2861  ncatenate_axes(a
+0002ac10: 7272 6179 732c 2061 7865 7329 3a0a 2020  rrays, axes):.  
+0002ac20: 2020 2222 2252 6563 7572 7369 7665 6c79    """Recursively
+0002ac30: 2063 616c 6c20 6e70 2e63 6f6e 6361 7465   call np.concate
+0002ac40: 6e61 7465 2061 6c6f 6e67 2061 7865 7322  nate along axes"
+0002ac50: 2222 0a20 2020 2069 6620 6c65 6e28 6178  "".    if len(ax
+0002ac60: 6573 2920 213d 206e 6469 6d6c 6973 7428  es) != ndimlist(
+0002ac70: 6172 7261 7973 293a 0a20 2020 2020 2020  arrays):.       
+0002ac80: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0002ac90: 7228 224c 656e 6774 6820 6f66 2061 7865  r("Length of axe
+0002aca0: 7320 7368 6f75 6c64 2065 7175 616c 2064  s should equal d
+0002acb0: 6570 7468 206f 6620 6e65 7374 6564 2061  epth of nested a
+0002acc0: 7272 6179 7322 290a 0a20 2020 2065 7874  rrays")..    ext
+0002acd0: 7261 6469 6d73 203d 206d 6178 2830 2c20  radims = max(0, 
+0002ace0: 6465 6570 6669 7273 7428 6172 7261 7973  deepfirst(arrays
+0002acf0: 292e 6e64 696d 202d 2028 6d61 7828 6178  ).ndim - (max(ax
+0002ad00: 6573 2920 2b20 3129 290a 2020 2020 7265  es) + 1)).    re
+0002ad10: 7475 726e 2063 6f6e 6361 7465 6e61 7465  turn concatenate
+0002ad20: 3328 7472 616e 7370 6f73 656c 6973 7428  3(transposelist(
+0002ad30: 6172 7261 7973 2c20 6178 6573 2c20 6578  arrays, axes, ex
+0002ad40: 7472 6164 696d 733d 6578 7472 6164 696d  tradims=extradim
+0002ad50: 7329 290a 0a0a 6465 6620 746f 5f68 6466  s))...def to_hdf
+0002ad60: 3528 6669 6c65 6e61 6d65 2c20 2a61 7267  5(filename, *arg
+0002ad70: 732c 2063 6875 6e6b 733d 5472 7565 2c20  s, chunks=True, 
+0002ad80: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
+0002ad90: 2222 5374 6f72 6520 6172 7261 7973 2069  ""Store arrays i
+0002ada0: 6e20 4844 4635 2066 696c 650a 0a20 2020  n HDF5 file..   
+0002adb0: 2054 6869 7320 7361 7665 7320 7365 7665   This saves seve
+0002adc0: 7261 6c20 6461 736b 2061 7272 6179 7320  ral dask arrays 
+0002add0: 696e 746f 2073 6576 6572 616c 2064 6174  into several dat
+0002ade0: 6170 6174 6873 2069 6e20 616e 2048 4446  apaths in an HDF
+0002adf0: 3520 6669 6c65 2e0a 2020 2020 4974 2063  5 file..    It c
+0002ae00: 7265 6174 6573 2074 6865 206e 6563 6573  reates the neces
+0002ae10: 7361 7279 2064 6174 6173 6574 7320 616e  sary datasets an
+0002ae20: 6420 6861 6e64 6c65 7320 636c 6561 6e20  d handles clean 
+0002ae30: 6669 6c65 206f 7065 6e69 6e67 2f63 6c6f  file opening/clo
+0002ae40: 7369 6e67 2e0a 0a20 2020 2050 6172 616d  sing...    Param
+0002ae50: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+0002ae60: 2d2d 2d2d 0a20 2020 2063 6875 6e6b 733a  ----.    chunks:
+0002ae70: 2074 7570 6c65 206f 7220 6060 5472 7565   tuple or ``True
+0002ae80: 6060 0a20 2020 2020 2020 2043 6875 6e6b  ``.        Chunk
+0002ae90: 2073 6861 7065 2c20 6f72 2060 6054 7275   shape, or ``Tru
+0002aea0: 6560 6020 746f 2070 6173 7320 7468 6520  e`` to pass the 
+0002aeb0: 6368 756e 6b73 2066 726f 6d20 7468 6520  chunks from the 
+0002aec0: 6461 736b 2061 7272 6179 2e0a 2020 2020  dask array..    
+0002aed0: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
+0002aee0: 6060 5472 7565 6060 2e0a 0a20 2020 2045  ``True``...    E
+0002aef0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
+0002af00: 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20 6461  ----..    >>> da
+0002af10: 2e74 6f5f 6864 6635 2827 6d79 6669 6c65  .to_hdf5('myfile
+0002af20: 2e68 6466 3527 2c20 272f 7827 2c20 7829  .hdf5', '/x', x)
+0002af30: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0002af40: 4950 0a0a 2020 2020 6f72 0a0a 2020 2020  IP..    or..    
+0002af50: 3e3e 3e20 6461 2e74 6f5f 6864 6635 2827  >>> da.to_hdf5('
+0002af60: 6d79 6669 6c65 2e68 6466 3527 2c20 7b27  myfile.hdf5', {'
+0002af70: 2f78 273a 2078 2c20 272f 7927 3a20 797d  /x': x, '/y': y}
+0002af80: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+0002af90: 4b49 500a 0a20 2020 204f 7074 696f 6e61  KIP..    Optiona
+0002afa0: 6c6c 7920 7072 6f76 6964 6520 6172 6775  lly provide argu
+0002afb0: 6d65 6e74 7320 6173 2074 686f 7567 6820  ments as though 
+0002afc0: 746f 2060 6068 3570 792e 4669 6c65 2e63  to ``h5py.File.c
+0002afd0: 7265 6174 655f 6461 7461 7365 7460 600a  reate_dataset``.
+0002afe0: 0a20 2020 203e 3e3e 2064 612e 746f 5f68  .    >>> da.to_h
+0002aff0: 6466 3528 276d 7966 696c 652e 6864 6635  df5('myfile.hdf5
+0002b000: 272c 2027 2f78 272c 2078 2c20 636f 6d70  ', '/x', x, comp
+0002b010: 7265 7373 696f 6e3d 276c 7a66 272c 2073  ression='lzf', s
+0002b020: 6875 6666 6c65 3d54 7275 6529 2020 2320  huffle=True)  # 
+0002b030: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
+0002b040: 2020 2020 3e3e 3e20 6461 2e74 6f5f 6864      >>> da.to_hd
+0002b050: 6635 2827 6d79 6669 6c65 2e68 6466 3527  f5('myfile.hdf5'
+0002b060: 2c20 272f 7827 2c20 782c 2063 6875 6e6b  , '/x', x, chunk
+0002b070: 733d 2831 302c 3230 2c33 3029 2920 2023  s=(10,20,30))  #
+0002b080: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+0002b090: 0a20 2020 2054 6869 7320 6361 6e20 616c  .    This can al
+0002b0a0: 736f 2062 6520 7573 6564 2061 7320 6120  so be used as a 
+0002b0b0: 6d65 7468 6f64 206f 6e20 6120 7369 6e67  method on a sing
+0002b0c0: 6c65 2041 7272 6179 0a0a 2020 2020 3e3e  le Array..    >>
+0002b0d0: 3e20 782e 746f 5f68 6466 3528 276d 7966  > x.to_hdf5('myf
+0002b0e0: 696c 652e 6864 6635 272c 2027 2f78 2729  ile.hdf5', '/x')
+0002b0f0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0002b100: 4950 0a0a 2020 2020 5365 6520 416c 736f  IP..    See Also
+0002b110: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+0002b120: 2020 6461 2e73 746f 7265 0a20 2020 2068    da.store.    h
+0002b130: 3570 792e 4669 6c65 2e63 7265 6174 655f  5py.File.create_
+0002b140: 6461 7461 7365 740a 2020 2020 2222 220a  dataset.    """.
+0002b150: 2020 2020 6966 206c 656e 2861 7267 7329      if len(args)
+0002b160: 203d 3d20 3120 616e 6420 6973 696e 7374   == 1 and isinst
+0002b170: 616e 6365 2861 7267 735b 305d 2c20 6469  ance(args[0], di
+0002b180: 6374 293a 0a20 2020 2020 2020 2064 6174  ct):.        dat
+0002b190: 6120 3d20 6172 6773 5b30 5d0a 2020 2020  a = args[0].    
+0002b1a0: 656c 6966 206c 656e 2861 7267 7329 203d  elif len(args) =
+0002b1b0: 3d20 3220 616e 6420 6973 696e 7374 616e  = 2 and isinstan
+0002b1c0: 6365 2861 7267 735b 305d 2c20 7374 7229  ce(args[0], str)
+0002b1d0: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
+0002b1e0: 6172 6773 5b31 5d2c 2041 7272 6179 293a  args[1], Array):
+0002b1f0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+0002b200: 7b61 7267 735b 305d 3a20 6172 6773 5b31  {args[0]: args[1
+0002b210: 5d7d 0a20 2020 2065 6c73 653a 0a20 2020  ]}.    else:.   
+0002b220: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002b230: 4572 726f 7228 2250 6c65 6173 6520 7072  Error("Please pr
+0002b240: 6f76 6964 6520 7b27 2f64 6174 612f 7061  ovide {'/data/pa
+0002b250: 7468 273a 2061 7272 6179 7d20 6469 6374  th': array} dict
+0002b260: 696f 6e61 7279 2229 0a0a 2020 2020 696d  ionary")..    im
+0002b270: 706f 7274 2068 3570 790a 0a20 2020 2077  port h5py..    w
+0002b280: 6974 6820 6835 7079 2e46 696c 6528 6669  ith h5py.File(fi
+0002b290: 6c65 6e61 6d65 2c20 6d6f 6465 3d22 6122  lename, mode="a"
+0002b2a0: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
+0002b2b0: 6473 6574 7320 3d20 5b0a 2020 2020 2020  dsets = [.      
+0002b2c0: 2020 2020 2020 662e 7265 7175 6972 655f        f.require_
+0002b2d0: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
+0002b2e0: 2020 2020 2020 2020 2064 702c 0a20 2020           dp,.   
+0002b2f0: 2020 2020 2020 2020 2020 2020 2073 6861               sha
+0002b300: 7065 3d78 2e73 6861 7065 2c0a 2020 2020  pe=x.shape,.    
+0002b310: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+0002b320: 653d 782e 6474 7970 652c 0a20 2020 2020  e=x.dtype,.     
+0002b330: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0002b340: 733d 7475 706c 6528 635b 305d 2066 6f72  s=tuple(c[0] for
+0002b350: 2063 2069 6e20 782e 6368 756e 6b73 2920   c in x.chunks) 
+0002b360: 6966 2063 6875 6e6b 7320 6973 2054 7275  if chunks is Tru
+0002b370: 6520 656c 7365 2063 6875 6e6b 732c 0a20  e else chunks,. 
+0002b380: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+0002b390: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
+0002b3a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0002b3b0: 2020 2066 6f72 2064 702c 2078 2069 6e20     for dp, x in 
+0002b3c0: 6461 7461 2e69 7465 6d73 2829 0a20 2020  data.items().   
+0002b3d0: 2020 2020 205d 0a20 2020 2020 2020 2073       ].        s
+0002b3e0: 746f 7265 286c 6973 7428 6461 7461 2e76  tore(list(data.v
+0002b3f0: 616c 7565 7328 2929 2c20 6473 6574 7329  alues()), dsets)
+0002b400: 0a0a 0a64 6566 2069 6e74 6572 6c65 6176  ...def interleav
+0002b410: 655f 6e6f 6e65 2861 2c20 6229 3a0a 2020  e_none(a, b):.  
+0002b420: 2020 2222 220a 0a20 2020 203e 3e3e 2069    """..    >>> i
+0002b430: 6e74 6572 6c65 6176 655f 6e6f 6e65 285b  nterleave_none([
+0002b440: 302c 204e 6f6e 652c 2032 2c20 4e6f 6e65  0, None, 2, None
+0002b450: 5d2c 205b 312c 2033 5d29 0a20 2020 2028  ], [1, 3]).    (
+0002b460: 302c 2031 2c20 322c 2033 290a 2020 2020  0, 1, 2, 3).    
+0002b470: 2222 220a 2020 2020 7265 7375 6c74 203d  """.    result =
+0002b480: 205b 5d0a 2020 2020 6920 3d20 6a20 3d20   [].    i = j = 
+0002b490: 300a 2020 2020 6e20 3d20 6c65 6e28 6129  0.    n = len(a)
+0002b4a0: 202b 206c 656e 2862 290a 2020 2020 7768   + len(b).    wh
+0002b4b0: 696c 6520 6920 2b20 6a20 3c20 6e3a 0a20  ile i + j < n:. 
+0002b4c0: 2020 2020 2020 2069 6620 615b 695d 2069         if a[i] i
+0002b4d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0002b4e0: 2020 2020 2020 2020 7265 7375 6c74 2e61          result.a
+0002b4f0: 7070 656e 6428 615b 695d 290a 2020 2020  ppend(a[i]).    
+0002b500: 2020 2020 2020 2020 6920 2b3d 2031 0a20          i += 1. 
+0002b510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002b520: 2020 2020 2020 2020 2072 6573 756c 742e           result.
+0002b530: 6170 7065 6e64 2862 5b6a 5d29 0a20 2020  append(b[j]).   
+0002b540: 2020 2020 2020 2020 2069 202b 3d20 310a           i += 1.
+0002b550: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
+0002b560: 2031 0a20 2020 2072 6574 7572 6e20 7475   1.    return tu
+0002b570: 706c 6528 7265 7375 6c74 290a 0a0a 6465  ple(result)...de
+0002b580: 6620 6b65 796e 616d 6528 6e61 6d65 2c20  f keyname(name, 
+0002b590: 692c 206f 6b65 7929 3a0a 2020 2020 2222  i, okey):.    ""
+0002b5a0: 220a 0a20 2020 203e 3e3e 206b 6579 6e61  "..    >>> keyna
+0002b5b0: 6d65 2827 7827 2c20 332c 205b 4e6f 6e65  me('x', 3, [None
+0002b5c0: 2c20 4e6f 6e65 2c20 302c 2032 5d29 0a20  , None, 0, 2]). 
+0002b5d0: 2020 2028 2778 272c 2033 2c20 302c 2032     ('x', 3, 0, 2
+0002b5e0: 290a 2020 2020 2222 220a 2020 2020 7265  ).    """.    re
+0002b5f0: 7475 726e 2028 6e61 6d65 2c20 6929 202b  turn (name, i) +
+0002b600: 2074 7570 6c65 286b 2066 6f72 206b 2069   tuple(k for k i
+0002b610: 6e20 6f6b 6579 2069 6620 6b20 6973 206e  n okey if k is n
+0002b620: 6f74 204e 6f6e 6529 0a0a 0a64 6566 205f  ot None)...def _
+0002b630: 7669 6e64 6578 2878 2c20 2a69 6e64 6578  vindex(x, *index
+0002b640: 6573 293a 0a20 2020 2022 2222 506f 696e  es):.    """Poin
+0002b650: 7420 7769 7365 2069 6e64 6578 696e 6720  t wise indexing 
+0002b660: 7769 7468 2062 726f 6164 6361 7374 696e  with broadcastin
+0002b670: 672e 0a0a 2020 2020 3e3e 3e20 7820 3d20  g...    >>> x = 
+0002b680: 6e70 2e61 7261 6e67 6528 3536 292e 7265  np.arange(56).re
+0002b690: 7368 6170 6528 2837 2c20 3829 290a 2020  shape((7, 8)).  
+0002b6a0: 2020 3e3e 3e20 780a 2020 2020 6172 7261    >>> x.    arra
+0002b6b0: 7928 5b5b 2030 2c20 2031 2c20 2032 2c20  y([[ 0,  1,  2, 
+0002b6c0: 2033 2c20 2034 2c20 2035 2c20 2036 2c20   3,  4,  5,  6, 
+0002b6d0: 2037 5d2c 0a20 2020 2020 2020 2020 2020   7],.           
+0002b6e0: 5b20 382c 2020 392c 2031 302c 2031 312c  [ 8,  9, 10, 11,
+0002b6f0: 2031 322c 2031 332c 2031 342c 2031 355d   12, 13, 14, 15]
+0002b700: 2c0a 2020 2020 2020 2020 2020 205b 3136  ,.           [16
+0002b710: 2c20 3137 2c20 3138 2c20 3139 2c20 3230  , 17, 18, 19, 20
+0002b720: 2c20 3231 2c20 3232 2c20 3233 5d2c 0a20  , 21, 22, 23],. 
+0002b730: 2020 2020 2020 2020 2020 5b32 342c 2032            [24, 2
+0002b740: 352c 2032 362c 2032 372c 2032 382c 2032  5, 26, 27, 28, 2
+0002b750: 392c 2033 302c 2033 315d 2c0a 2020 2020  9, 30, 31],.    
+0002b760: 2020 2020 2020 205b 3332 2c20 3333 2c20         [32, 33, 
+0002b770: 3334 2c20 3335 2c20 3336 2c20 3337 2c20  34, 35, 36, 37, 
+0002b780: 3338 2c20 3339 5d2c 0a20 2020 2020 2020  38, 39],.       
+0002b790: 2020 2020 5b34 302c 2034 312c 2034 322c      [40, 41, 42,
+0002b7a0: 2034 332c 2034 342c 2034 352c 2034 362c   43, 44, 45, 46,
+0002b7b0: 2034 375d 2c0a 2020 2020 2020 2020 2020   47],.          
+0002b7c0: 205b 3438 2c20 3439 2c20 3530 2c20 3531   [48, 49, 50, 51
+0002b7d0: 2c20 3532 2c20 3533 2c20 3534 2c20 3535  , 52, 53, 54, 55
+0002b7e0: 5d5d 290a 0a20 2020 203e 3e3e 2064 203d  ]])..    >>> d =
+0002b7f0: 2066 726f 6d5f 6172 7261 7928 782c 2063   from_array(x, c
+0002b800: 6875 6e6b 733d 2833 2c20 3429 290a 2020  hunks=(3, 4)).  
+0002b810: 2020 3e3e 3e20 7265 7375 6c74 203d 205f    >>> result = _
+0002b820: 7669 6e64 6578 2864 2c20 5b30 2c20 312c  vindex(d, [0, 1,
+0002b830: 2036 2c20 305d 2c20 5b30 2c20 312c 2030   6, 0], [0, 1, 0
+0002b840: 2c20 375d 290a 2020 2020 3e3e 3e20 7265  , 7]).    >>> re
+0002b850: 7375 6c74 2e63 6f6d 7075 7465 2829 0a20  sult.compute(). 
+0002b860: 2020 2061 7272 6179 285b 2030 2c20 2039     array([ 0,  9
+0002b870: 2c20 3438 2c20 2037 5d29 0a20 2020 2022  , 48,  7]).    "
+0002b880: 2222 0a20 2020 2069 6e64 6578 6573 203d  "".    indexes =
+0002b890: 2072 6570 6c61 6365 5f65 6c6c 6970 7369   replace_ellipsi
+0002b8a0: 7328 782e 6e64 696d 2c20 696e 6465 7865  s(x.ndim, indexe
+0002b8b0: 7329 0a0a 2020 2020 6e6f 6e66 616e 6379  s)..    nonfancy
+0002b8c0: 5f69 6e64 6578 6573 203d 205b 5d0a 2020  _indexes = [].  
+0002b8d0: 2020 7265 6475 6365 645f 696e 6465 7865    reduced_indexe
+0002b8e0: 7320 3d20 5b5d 0a20 2020 2066 6f72 2069  s = [].    for i
+0002b8f0: 6e64 2069 6e20 696e 6465 7865 733a 0a20  nd in indexes:. 
+0002b900: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002b910: 616e 6365 2869 6e64 2c20 4e75 6d62 6572  ance(ind, Number
+0002b920: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
+0002b930: 6f6e 6661 6e63 795f 696e 6465 7865 732e  onfancy_indexes.
+0002b940: 6170 7065 6e64 2869 6e64 290a 2020 2020  append(ind).    
+0002b950: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+0002b960: 6e63 6528 696e 642c 2073 6c69 6365 293a  nce(ind, slice):
+0002b970: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
+0002b980: 6661 6e63 795f 696e 6465 7865 732e 6170  fancy_indexes.ap
+0002b990: 7065 6e64 2869 6e64 290a 2020 2020 2020  pend(ind).      
+0002b9a0: 2020 2020 2020 7265 6475 6365 645f 696e        reduced_in
+0002b9b0: 6465 7865 732e 6170 7065 6e64 2873 6c69  dexes.append(sli
+0002b9c0: 6365 284e 6f6e 6529 290a 2020 2020 2020  ce(None)).      
+0002b9d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002b9e0: 2020 2020 6e6f 6e66 616e 6379 5f69 6e64      nonfancy_ind
+0002b9f0: 6578 6573 2e61 7070 656e 6428 736c 6963  exes.append(slic
+0002ba00: 6528 4e6f 6e65 2929 0a20 2020 2020 2020  e(None)).       
+0002ba10: 2020 2020 2072 6564 7563 6564 5f69 6e64       reduced_ind
+0002ba20: 6578 6573 2e61 7070 656e 6428 696e 6429  exes.append(ind)
+0002ba30: 0a0a 2020 2020 6e6f 6e66 616e 6379 5f69  ..    nonfancy_i
+0002ba40: 6e64 6578 6573 203d 2074 7570 6c65 286e  ndexes = tuple(n
+0002ba50: 6f6e 6661 6e63 795f 696e 6465 7865 7329  onfancy_indexes)
+0002ba60: 0a20 2020 2072 6564 7563 6564 5f69 6e64  .    reduced_ind
+0002ba70: 6578 6573 203d 2074 7570 6c65 2872 6564  exes = tuple(red
+0002ba80: 7563 6564 5f69 6e64 6578 6573 290a 0a20  uced_indexes).. 
+0002ba90: 2020 2078 203d 2078 5b6e 6f6e 6661 6e63     x = x[nonfanc
+0002baa0: 795f 696e 6465 7865 735d 0a0a 2020 2020  y_indexes]..    
+0002bab0: 6172 7261 795f 696e 6465 7865 7320 3d20  array_indexes = 
+0002bac0: 7b7d 0a20 2020 2066 6f72 2069 2c20 2869  {}.    for i, (i
+0002bad0: 6e64 2c20 7369 7a65 2920 696e 2065 6e75  nd, size) in enu
+0002bae0: 6d65 7261 7465 287a 6970 2872 6564 7563  merate(zip(reduc
+0002baf0: 6564 5f69 6e64 6578 6573 2c20 782e 7368  ed_indexes, x.sh
+0002bb00: 6170 6529 293a 0a20 2020 2020 2020 2069  ape)):.        i
+0002bb10: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+0002bb20: 2869 6e64 2c20 736c 6963 6529 3a0a 2020  (ind, slice):.  
+0002bb30: 2020 2020 2020 2020 2020 696e 6420 3d20            ind = 
+0002bb40: 6e70 2e61 7272 6179 2869 6e64 2c20 636f  np.array(ind, co
+0002bb50: 7079 3d54 7275 6529 0a20 2020 2020 2020  py=True).       
+0002bb60: 2020 2020 2069 6620 696e 642e 6474 7970       if ind.dtyp
+0002bb70: 652e 6b69 6e64 203d 3d20 2262 223a 0a20  e.kind == "b":. 
+0002bb80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0002bb90: 6169 7365 2049 6e64 6578 4572 726f 7228  aise IndexError(
+0002bba0: 2276 696e 6465 7820 646f 6573 206e 6f74  "vindex does not
+0002bbb0: 2073 7570 706f 7274 2069 6e64 6578 696e   support indexin
+0002bbc0: 6720 7769 7468 2062 6f6f 6c65 616e 2061  g with boolean a
+0002bbd0: 7272 6179 7322 290a 2020 2020 2020 2020  rrays").        
+0002bbe0: 2020 2020 6966 2028 2869 6e64 203e 3d20      if ((ind >= 
+0002bbf0: 7369 7a65 2920 7c20 2869 6e64 203c 202d  size) | (ind < -
+0002bc00: 7369 7a65 2929 2e61 6e79 2829 3a0a 2020  size)).any():.  
+0002bc10: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0002bc20: 6973 6520 496e 6465 7845 7272 6f72 280a  ise IndexError(.
+0002bc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc40: 2020 2020 2276 696e 6465 7820 6b65 7920      "vindex key 
+0002bc50: 6861 7320 656e 7472 6965 7320 6f75 7420  has entries out 
+0002bc60: 6f66 2062 6f75 6e64 7320 666f 7220 220a  of bounds for ".
+0002bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc80: 2020 2020 2269 6e64 6578 696e 6720 616c      "indexing al
+0002bc90: 6f6e 6720 6178 6973 2025 7320 6f66 2073  ong axis %s of s
+0002bca0: 697a 6520 2573 3a20 2572 2220 2520 2869  ize %s: %r" % (i
+0002bcb0: 2c20 7369 7a65 2c20 696e 6429 0a20 2020  , size, ind).   
+0002bcc0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002bcd0: 2020 2020 2020 2020 2020 2069 6e64 2025             ind %
+0002bce0: 3d20 7369 7a65 0a20 2020 2020 2020 2020  = size.         
+0002bcf0: 2020 2061 7272 6179 5f69 6e64 6578 6573     array_indexes
+0002bd00: 5b69 5d20 3d20 696e 640a 0a20 2020 2069  [i] = ind..    i
+0002bd10: 6620 6172 7261 795f 696e 6465 7865 733a  f array_indexes:
+0002bd20: 0a20 2020 2020 2020 2078 203d 205f 7669  .        x = _vi
+0002bd30: 6e64 6578 5f61 7272 6179 2878 2c20 6172  ndex_array(x, ar
+0002bd40: 7261 795f 696e 6465 7865 7329 0a0a 2020  ray_indexes)..  
+0002bd50: 2020 7265 7475 726e 2078 0a0a 0a64 6566    return x...def
+0002bd60: 205f 7669 6e64 6578 5f61 7272 6179 2878   _vindex_array(x
+0002bd70: 2c20 6469 6374 5f69 6e64 6578 6573 293a  , dict_indexes):
+0002bd80: 0a20 2020 2022 2222 506f 696e 7420 7769  .    """Point wi
+0002bd90: 7365 2069 6e64 6578 696e 6720 7769 7468  se indexing with
+0002bda0: 206f 6e6c 7920 4e75 6d50 7920 4172 7261   only NumPy Arra
+0002bdb0: 7973 2e22 2222 0a0a 2020 2020 7472 793a  ys."""..    try:
+0002bdc0: 0a20 2020 2020 2020 2062 726f 6164 6361  .        broadca
+0002bdd0: 7374 5f69 6e64 6578 6573 203d 206e 702e  st_indexes = np.
+0002bde0: 6272 6f61 6463 6173 745f 6172 7261 7973  broadcast_arrays
+0002bdf0: 282a 6469 6374 5f69 6e64 6578 6573 2e76  (*dict_indexes.v
+0002be00: 616c 7565 7328 2929 0a20 2020 2065 7863  alues()).    exc
+0002be10: 6570 7420 5661 6c75 6545 7272 6f72 2061  ept ValueError a
+0002be20: 7320 653a 0a20 2020 2020 2020 2023 206e  s e:.        # n
+0002be30: 6f74 653a 2065 7272 6f72 206d 6573 7361  ote: error messa
+0002be40: 6765 2065 7861 6374 6c79 206d 6174 6368  ge exactly match
+0002be50: 6573 206e 756d 7079 0a20 2020 2020 2020  es numpy.       
+0002be60: 2073 6861 7065 735f 7374 7220 3d20 2220   shapes_str = " 
+0002be70: 222e 6a6f 696e 2873 7472 2861 2e73 6861  ".join(str(a.sha
+0002be80: 7065 2920 666f 7220 6120 696e 2064 6963  pe) for a in dic
+0002be90: 745f 696e 6465 7865 732e 7661 6c75 6573  t_indexes.values
+0002bea0: 2829 290a 2020 2020 2020 2020 7261 6973  ()).        rais
+0002beb0: 6520 496e 6465 7845 7272 6f72 280a 2020  e IndexError(.  
+0002bec0: 2020 2020 2020 2020 2020 2273 6861 7065            "shape
+0002bed0: 206d 6973 6d61 7463 683a 2069 6e64 6578   mismatch: index
+0002bee0: 696e 6720 6172 7261 7973 2063 6f75 6c64  ing arrays could
+0002bef0: 206e 6f74 2062 6520 220a 2020 2020 2020   not be ".      
+0002bf00: 2020 2020 2020 2262 726f 6164 6361 7374        "broadcast
+0002bf10: 2074 6f67 6574 6865 7220 7769 7468 2073   together with s
+0002bf20: 6861 7065 7320 2220 2b20 7368 6170 6573  hapes " + shapes
+0002bf30: 5f73 7472 0a20 2020 2020 2020 2029 2066  _str.        ) f
+0002bf40: 726f 6d20 650a 2020 2020 6272 6f61 6463  rom e.    broadc
+0002bf50: 6173 745f 7368 6170 6520 3d20 6272 6f61  ast_shape = broa
+0002bf60: 6463 6173 745f 696e 6465 7865 735b 305d  dcast_indexes[0]
+0002bf70: 2e73 6861 7065 0a0a 2020 2020 6c6f 6f6b  .shape..    look
+0002bf80: 7570 203d 2064 6963 7428 7a69 7028 6469  up = dict(zip(di
+0002bf90: 6374 5f69 6e64 6578 6573 2c20 6272 6f61  ct_indexes, broa
+0002bfa0: 6463 6173 745f 696e 6465 7865 7329 290a  dcast_indexes)).
+0002bfb0: 2020 2020 666c 6174 5f69 6e64 6578 6573      flat_indexes
+0002bfc0: 203d 205b 0a20 2020 2020 2020 206c 6f6f   = [.        loo
+0002bfd0: 6b75 705b 695d 2e72 6176 656c 2829 2e74  kup[i].ravel().t
+0002bfe0: 6f6c 6973 7428 2920 6966 2069 2069 6e20  olist() if i in 
+0002bff0: 6c6f 6f6b 7570 2065 6c73 6520 4e6f 6e65  lookup else None
+0002c000: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0002c010: 782e 6e64 696d 290a 2020 2020 5d0a 2020  x.ndim).    ].  
+0002c020: 2020 666c 6174 5f69 6e64 6578 6573 2e65    flat_indexes.e
+0002c030: 7874 656e 6428 5b4e 6f6e 655d 202a 2028  xtend([None] * (
+0002c040: 782e 6e64 696d 202d 206c 656e 2866 6c61  x.ndim - len(fla
+0002c050: 745f 696e 6465 7865 7329 2929 0a0a 2020  t_indexes)))..  
+0002c060: 2020 666c 6174 5f69 6e64 6578 6573 203d    flat_indexes =
+0002c070: 205b 0a20 2020 2020 2020 206c 6973 7428   [.        list(
+0002c080: 696e 6465 7829 2069 6620 696e 6465 7820  index) if index 
+0002c090: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+0002c0a0: 2069 6e64 6578 2066 6f72 2069 6e64 6578   index for index
+0002c0b0: 2069 6e20 666c 6174 5f69 6e64 6578 6573   in flat_indexes
+0002c0c0: 0a20 2020 205d 0a20 2020 2062 6f75 6e64  .    ].    bound
+0002c0d0: 7320 3d20 5b6c 6973 7428 6163 6375 6d75  s = [list(accumu
+0002c0e0: 6c61 7465 2861 6464 2c20 2830 2c29 202b  late(add, (0,) +
+0002c0f0: 2063 2929 2066 6f72 2063 2069 6e20 782e   c)) for c in x.
+0002c100: 6368 756e 6b73 5d0a 2020 2020 626f 756e  chunks].    boun
+0002c110: 6473 3220 3d20 5b62 2066 6f72 2069 2c20  ds2 = [b for i, 
+0002c120: 6220 696e 207a 6970 2866 6c61 745f 696e  b in zip(flat_in
+0002c130: 6465 7865 732c 2062 6f75 6e64 7329 2069  dexes, bounds) i
+0002c140: 6620 6920 6973 206e 6f74 204e 6f6e 655d  f i is not None]
+0002c150: 0a20 2020 2061 7869 7320 3d20 5f67 6574  .    axis = _get
+0002c160: 5f61 7869 7328 666c 6174 5f69 6e64 6578  _axis(flat_index
+0002c170: 6573 290a 2020 2020 746f 6b65 6e20 3d20  es).    token = 
+0002c180: 746f 6b65 6e69 7a65 2878 2c20 666c 6174  tokenize(x, flat
+0002c190: 5f69 6e64 6578 6573 290a 2020 2020 6f75  _indexes).    ou
+0002c1a0: 745f 6e61 6d65 203d 2022 7669 6e64 6578  t_name = "vindex
+0002c1b0: 2d6d 6572 6765 2d22 202b 2074 6f6b 656e  -merge-" + token
+0002c1c0: 0a0a 2020 2020 706f 696e 7473 203d 206c  ..    points = l
+0002c1d0: 6973 7428 290a 2020 2020 666f 7220 692c  ist().    for i,
+0002c1e0: 2069 6478 2069 6e20 656e 756d 6572 6174   idx in enumerat
+0002c1f0: 6528 7a69 7028 2a5b 6920 666f 7220 6920  e(zip(*[i for i 
+0002c200: 696e 2066 6c61 745f 696e 6465 7865 7320  in flat_indexes 
+0002c210: 6966 2069 2069 7320 6e6f 7420 4e6f 6e65  if i is not None
+0002c220: 5d29 293a 0a20 2020 2020 2020 2062 6c6f  ])):.        blo
+0002c230: 636b 5f69 6478 203d 205b 6269 7365 6374  ck_idx = [bisect
+0002c240: 2862 2c20 696e 6429 202d 2031 2066 6f72  (b, ind) - 1 for
+0002c250: 2062 2c20 696e 6420 696e 207a 6970 2862   b, ind in zip(b
+0002c260: 6f75 6e64 7332 2c20 6964 7829 5d0a 2020  ounds2, idx)].  
+0002c270: 2020 2020 2020 696e 626c 6f63 6b5f 6964        inblock_id
+0002c280: 7820 3d20 5b0a 2020 2020 2020 2020 2020  x = [.          
+0002c290: 2020 696e 6420 2d20 626f 756e 6473 325b    ind - bounds2[
+0002c2a0: 6b5d 5b6a 5d20 666f 7220 6b2c 2028 696e  k][j] for k, (in
+0002c2b0: 642c 206a 2920 696e 2065 6e75 6d65 7261  d, j) in enumera
+0002c2c0: 7465 287a 6970 2869 6478 2c20 626c 6f63  te(zip(idx, bloc
+0002c2d0: 6b5f 6964 7829 290a 2020 2020 2020 2020  k_idx)).        
+0002c2e0: 5d0a 2020 2020 2020 2020 706f 696e 7473  ].        points
+0002c2f0: 2e61 7070 656e 6428 2869 2c20 7475 706c  .append((i, tupl
+0002c300: 6528 626c 6f63 6b5f 6964 7829 2c20 7475  e(block_idx), tu
+0002c310: 706c 6528 696e 626c 6f63 6b5f 6964 7829  ple(inblock_idx)
+0002c320: 2929 0a0a 2020 2020 6368 756e 6b73 203d  ))..    chunks =
+0002c330: 205b 6320 666f 7220 692c 2063 2069 6e20   [c for i, c in 
+0002c340: 7a69 7028 666c 6174 5f69 6e64 6578 6573  zip(flat_indexes
+0002c350: 2c20 782e 6368 756e 6b73 2920 6966 2069  , x.chunks) if i
+0002c360: 2069 7320 4e6f 6e65 5d0a 2020 2020 6368   is None].    ch
+0002c370: 756e 6b73 2e69 6e73 6572 7428 302c 2028  unks.insert(0, (
+0002c380: 6c65 6e28 706f 696e 7473 292c 2920 6966  len(points),) if
+0002c390: 2070 6f69 6e74 7320 656c 7365 2028 302c   points else (0,
+0002c3a0: 2929 0a20 2020 2063 6875 6e6b 7320 3d20  )).    chunks = 
+0002c3b0: 7475 706c 6528 6368 756e 6b73 290a 0a20  tuple(chunks).. 
+0002c3c0: 2020 2069 6620 706f 696e 7473 3a0a 2020     if points:.  
+0002c3d0: 2020 2020 2020 7065 725f 626c 6f63 6b20        per_block 
+0002c3e0: 3d20 6772 6f75 7062 7928 312c 2070 6f69  = groupby(1, poi
+0002c3f0: 6e74 7329 0a20 2020 2020 2020 2070 6572  nts).        per
+0002c400: 5f62 6c6f 636b 203d 207b 6b3a 2076 2066  _block = {k: v f
+0002c410: 6f72 206b 2c20 7620 696e 2070 6572 5f62  or k, v in per_b
+0002c420: 6c6f 636b 2e69 7465 6d73 2829 2069 6620  lock.items() if 
+0002c430: 767d 0a0a 2020 2020 2020 2020 6f74 6865  v}..        othe
+0002c440: 725f 626c 6f63 6b73 203d 206c 6973 7428  r_blocks = list(
+0002c450: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+0002c460: 6475 6374 280a 2020 2020 2020 2020 2020  duct(.          
+0002c470: 2020 2020 2020 2a5b 0a20 2020 2020 2020        *[.       
+0002c480: 2020 2020 2020 2020 2020 2020 206c 6973               lis
+0002c490: 7428 7261 6e67 6528 6c65 6e28 6329 2929  t(range(len(c)))
+0002c4a0: 2069 6620 6920 6973 204e 6f6e 6520 656c   if i is None el
+0002c4b0: 7365 205b 4e6f 6e65 5d0a 2020 2020 2020  se [None].      
+0002c4c0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0002c4d0: 7220 692c 2063 2069 6e20 7a69 7028 666c  r i, c in zip(fl
+0002c4e0: 6174 5f69 6e64 6578 6573 2c20 782e 6368  at_indexes, x.ch
+0002c4f0: 756e 6b73 290a 2020 2020 2020 2020 2020  unks).          
+0002c500: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+0002c510: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+0002c520: 0a20 2020 2020 2020 2066 756c 6c5f 736c  .        full_sl
+0002c530: 6963 6573 203d 205b 736c 6963 6528 4e6f  ices = [slice(No
+0002c540: 6e65 2c20 4e6f 6e65 2920 6966 2069 2069  ne, None) if i i
+0002c550: 7320 4e6f 6e65 2065 6c73 6520 4e6f 6e65  s None else None
+0002c560: 2066 6f72 2069 2069 6e20 666c 6174 5f69   for i in flat_i
+0002c570: 6e64 6578 6573 5d0a 0a20 2020 2020 2020  ndexes]..       
+0002c580: 206e 616d 6520 3d20 2276 696e 6465 782d   name = "vindex-
+0002c590: 736c 6963 652d 2220 2b20 746f 6b65 6e0a  slice-" + token.
+0002c5a0: 2020 2020 2020 2020 7669 6e64 6578 5f6d          vindex_m
+0002c5b0: 6572 6765 5f6e 616d 6520 3d20 2276 696e  erge_name = "vin
+0002c5c0: 6465 782d 6d65 7267 652d 2220 2b20 746f  dex-merge-" + to
+0002c5d0: 6b65 6e0a 2020 2020 2020 2020 6473 6b20  ken.        dsk 
+0002c5e0: 3d20 7b7d 0a20 2020 2020 2020 2066 6f72  = {}.        for
+0002c5f0: 206f 6b65 7920 696e 206f 7468 6572 5f62   okey in other_b
+0002c600: 6c6f 636b 733a 0a20 2020 2020 2020 2020  locks:.         
+0002c610: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
+0002c620: 2065 6e75 6d65 7261 7465 2870 6572 5f62   enumerate(per_b
+0002c630: 6c6f 636b 293a 0a20 2020 2020 2020 2020  lock):.         
+0002c640: 2020 2020 2020 2064 736b 5b6b 6579 6e61         dsk[keyna
+0002c650: 6d65 286e 616d 652c 2069 2c20 6f6b 6579  me(name, i, okey
+0002c660: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
+0002c670: 2020 2020 2020 2020 2020 205f 7669 6e64             _vind
+0002c680: 6578 5f74 7261 6e73 706f 7365 2c0a 2020  ex_transpose,.  
+0002c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6a0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+0002c6b0: 2020 2020 2020 2020 2020 2020 5f76 696e              _vin
+0002c6c0: 6465 785f 736c 6963 652c 0a20 2020 2020  dex_slice,.     
+0002c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6e0: 2020 2028 782e 6e61 6d65 2c29 202b 2069     (x.name,) + i
+0002c6f0: 6e74 6572 6c65 6176 655f 6e6f 6e65 286f  nterleave_none(o
+0002c700: 6b65 792c 206b 6579 292c 0a20 2020 2020  key, key),.     
+0002c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c720: 2020 2069 6e74 6572 6c65 6176 655f 6e6f     interleave_no
+0002c730: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
+0002c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c750: 6675 6c6c 5f73 6c69 6365 732c 206c 6973  full_slices, lis
+0002c760: 7428 7a69 7028 2a70 6c75 636b 2832 2c20  t(zip(*pluck(2, 
+0002c770: 7065 725f 626c 6f63 6b5b 6b65 795d 2929  per_block[key]))
+0002c780: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002c790: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0002c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7b0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0002c7c0: 2020 2020 2020 2020 6178 6973 2c0a 2020          axis,.  
+0002c7d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002c7e0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
+0002c7f0: 6b65 796e 616d 6528 7669 6e64 6578 5f6d  keyname(vindex_m
+0002c800: 6572 6765 5f6e 616d 652c 2030 2c20 6f6b  erge_name, 0, ok
+0002c810: 6579 295d 203d 2028 0a20 2020 2020 2020  ey)] = (.       
+0002c820: 2020 2020 2020 2020 205f 7669 6e64 6578           _vindex
+0002c830: 5f6d 6572 6765 2c0a 2020 2020 2020 2020  _merge,.        
+0002c840: 2020 2020 2020 2020 5b6c 6973 7428 706c          [list(pl
+0002c850: 7563 6b28 302c 2070 6572 5f62 6c6f 636b  uck(0, per_block
+0002c860: 5b6b 6579 5d29 2920 666f 7220 6b65 7920  [key])) for key 
+0002c870: 696e 2070 6572 5f62 6c6f 636b 5d2c 0a20  in per_block],. 
+0002c880: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0002c890: 6b65 796e 616d 6528 6e61 6d65 2c20 692c  keyname(name, i,
+0002c8a0: 206f 6b65 7929 2066 6f72 2069 2069 6e20   okey) for i in 
+0002c8b0: 7261 6e67 6528 6c65 6e28 7065 725f 626c  range(len(per_bl
+0002c8c0: 6f63 6b29 295d 2c0a 2020 2020 2020 2020  ock))],.        
+0002c8d0: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+0002c8e0: 6573 756c 745f 3164 203d 2041 7272 6179  esult_1d = Array
+0002c8f0: 280a 2020 2020 2020 2020 2020 2020 4869  (.            Hi
+0002c900: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0002c910: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6f75  m_collections(ou
+0002c920: 745f 6e61 6d65 2c20 6473 6b2c 2064 6570  t_name, dsk, dep
+0002c930: 656e 6465 6e63 6965 733d 5b78 5d29 2c0a  endencies=[x]),.
+0002c940: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
+0002c950: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0002c960: 2020 6368 756e 6b73 2c0a 2020 2020 2020    chunks,.      
+0002c970: 2020 2020 2020 782e 6474 7970 652c 0a20        x.dtype,. 
+0002c980: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+0002c990: 782e 5f6d 6574 612c 0a20 2020 2020 2020  x._meta,.       
+0002c9a0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+0002c9b0: 6e20 7265 7375 6c74 5f31 642e 7265 7368  n result_1d.resh
+0002c9c0: 6170 6528 6272 6f61 6463 6173 745f 7368  ape(broadcast_sh
+0002c9d0: 6170 6520 2b20 7265 7375 6c74 5f31 642e  ape + result_1d.
+0002c9e0: 7368 6170 655b 313a 5d29 0a0a 2020 2020  shape[1:])..    
+0002c9f0: 2320 6f75 7470 7574 2068 6173 2061 207a  # output has a z
+0002ca00: 6572 6f20 6469 6d65 6e73 696f 6e2c 206a  ero dimension, j
+0002ca10: 7573 7420 6372 6561 7465 2061 206e 6577  ust create a new
+0002ca20: 207a 6572 6f2d 7368 6170 6520 6172 7261   zero-shape arra
+0002ca30: 7920 7769 7468 2074 6865 0a20 2020 2023  y with the.    #
+0002ca40: 2073 616d 6520 6474 7970 650a 2020 2020   same dtype.    
+0002ca50: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+0002ca60: 7772 6170 2069 6d70 6f72 7420 656d 7074  wrap import empt
+0002ca70: 790a 0a20 2020 2072 6573 756c 745f 3164  y..    result_1d
+0002ca80: 203d 2065 6d70 7479 280a 2020 2020 2020   = empty(.      
+0002ca90: 2020 7475 706c 6528 6d61 7028 7375 6d2c    tuple(map(sum,
+0002caa0: 2063 6875 6e6b 7329 292c 2063 6875 6e6b   chunks)), chunk
+0002cab0: 733d 6368 756e 6b73 2c20 6474 7970 653d  s=chunks, dtype=
+0002cac0: 782e 6474 7970 652c 206e 616d 653d 6f75  x.dtype, name=ou
+0002cad0: 745f 6e61 6d65 0a20 2020 2029 0a20 2020  t_name.    ).   
+0002cae0: 2072 6574 7572 6e20 7265 7375 6c74 5f31   return result_1
+0002caf0: 642e 7265 7368 6170 6528 6272 6f61 6463  d.reshape(broadc
+0002cb00: 6173 745f 7368 6170 6520 2b20 7265 7375  ast_shape + resu
+0002cb10: 6c74 5f31 642e 7368 6170 655b 313a 5d29  lt_1d.shape[1:])
+0002cb20: 0a0a 0a64 6566 205f 6765 745f 6178 6973  ...def _get_axis
+0002cb30: 2869 6e64 6578 6573 293a 0a20 2020 2022  (indexes):.    "
+0002cb40: 2222 4765 7420 6178 6973 2061 6c6f 6e67  ""Get axis along
+0002cb50: 2077 6869 6368 2070 6f69 6e74 2d77 6973   which point-wis
+0002cb60: 6520 736c 6963 696e 6720 7265 7375 6c74  e slicing result
+0002cb70: 7320 6c69 650a 0a20 2020 2054 6869 7320  s lie..    This 
+0002cb80: 6973 206d 6f73 746c 7920 6120 6861 636b  is mostly a hack
+0002cb90: 2062 6563 6175 7365 2049 2063 616e 2774   because I can't
+0002cba0: 2066 6967 7572 6520 6f75 7420 4e75 6d50   figure out NumP
+0002cbb0: 7927 7320 7275 6c65 206f 6e20 7468 6973  y's rule on this
+0002cbc0: 2061 6e64 0a20 2020 2063 616e 2774 2062   and.    can't b
+0002cbd0: 6520 626f 7468 6572 6564 2074 6f20 676f  e bothered to go
+0002cbe0: 2072 6561 6469 6e67 2e0a 0a20 2020 203e   reading...    >
+0002cbf0: 3e3e 205f 6765 745f 6178 6973 285b 5b31  >> _get_axis([[1
+0002cc00: 2c20 325d 2c20 4e6f 6e65 2c20 5b31 2c20  , 2], None, [1, 
+0002cc10: 325d 2c20 4e6f 6e65 5d29 0a20 2020 2030  2], None]).    0
+0002cc20: 0a20 2020 203e 3e3e 205f 6765 745f 6178  .    >>> _get_ax
+0002cc30: 6973 285b 4e6f 6e65 2c20 5b31 2c20 325d  is([None, [1, 2]
+0002cc40: 2c20 5b31 2c20 325d 2c20 4e6f 6e65 5d29  , [1, 2], None])
+0002cc50: 0a20 2020 2031 0a20 2020 203e 3e3e 205f  .    1.    >>> _
+0002cc60: 6765 745f 6178 6973 285b 4e6f 6e65 2c20  get_axis([None, 
+0002cc70: 4e6f 6e65 2c20 5b31 2c20 325d 2c20 5b31  None, [1, 2], [1
+0002cc80: 2c20 325d 5d29 0a20 2020 2032 0a20 2020  , 2]]).    2.   
+0002cc90: 2022 2222 0a20 2020 206e 6469 6d20 3d20   """.    ndim = 
+0002cca0: 6c65 6e28 696e 6465 7865 7329 0a20 2020  len(indexes).   
+0002ccb0: 2069 6e64 6578 6573 203d 205b 736c 6963   indexes = [slic
+0002ccc0: 6528 4e6f 6e65 2c20 4e6f 6e65 2920 6966  e(None, None) if
+0002ccd0: 2069 2069 7320 4e6f 6e65 2065 6c73 6520   i is None else 
+0002cce0: 5b30 5d20 666f 7220 6920 696e 2069 6e64  [0] for i in ind
+0002ccf0: 6578 6573 5d0a 2020 2020 7820 3d20 6e70  exes].    x = np
+0002cd00: 2e65 6d70 7479 2828 322c 2920 2a20 6e64  .empty((2,) * nd
+0002cd10: 696d 290a 2020 2020 7832 203d 2078 5b74  im).    x2 = x[t
+0002cd20: 7570 6c65 2869 6e64 6578 6573 295d 0a20  uple(indexes)]. 
+0002cd30: 2020 2072 6574 7572 6e20 7832 2e73 6861     return x2.sha
+0002cd40: 7065 2e69 6e64 6578 2831 290a 0a0a 6465  pe.index(1)...de
+0002cd50: 6620 5f76 696e 6465 785f 736c 6963 6528  f _vindex_slice(
+0002cd60: 626c 6f63 6b2c 2070 6f69 6e74 7329 3a0a  block, points):.
+0002cd70: 2020 2020 2222 2250 756c 6c20 6f75 7420      """Pull out 
+0002cd80: 706f 696e 742d 7769 7365 2073 6c69 6365  point-wise slice
+0002cd90: 7320 6672 6f6d 2062 6c6f 636b 2222 220a  s from block""".
+0002cda0: 2020 2020 706f 696e 7473 203d 205b 7020      points = [p 
+0002cdb0: 6966 2069 7369 6e73 7461 6e63 6528 702c  if isinstance(p,
+0002cdc0: 2073 6c69 6365 2920 656c 7365 206c 6973   slice) else lis
+0002cdd0: 7428 7029 2066 6f72 2070 2069 6e20 706f  t(p) for p in po
+0002cde0: 696e 7473 5d0a 2020 2020 7265 7475 726e  ints].    return
+0002cdf0: 2062 6c6f 636b 5b74 7570 6c65 2870 6f69   block[tuple(poi
+0002ce00: 6e74 7329 5d0a 0a0a 6465 6620 5f76 696e  nts)]...def _vin
+0002ce10: 6465 785f 7472 616e 7370 6f73 6528 626c  dex_transpose(bl
+0002ce20: 6f63 6b2c 2061 7869 7329 3a0a 2020 2020  ock, axis):.    
+0002ce30: 2222 2252 6f74 6174 6520 626c 6f63 6b20  """Rotate block 
+0002ce40: 736f 2074 6861 7420 706f 696e 7473 2061  so that points a
+0002ce50: 7265 206f 6e20 7468 6520 6669 7273 7420  re on the first 
+0002ce60: 6469 6d65 6e73 696f 6e22 2222 0a20 2020  dimension""".   
+0002ce70: 2061 7865 7320 3d20 5b61 7869 735d 202b   axes = [axis] +
+0002ce80: 206c 6973 7428 7261 6e67 6528 6178 6973   list(range(axis
+0002ce90: 2929 202b 206c 6973 7428 7261 6e67 6528  )) + list(range(
+0002cea0: 6178 6973 202b 2031 2c20 626c 6f63 6b2e  axis + 1, block.
+0002ceb0: 6e64 696d 2929 0a20 2020 2072 6574 7572  ndim)).    retur
+0002cec0: 6e20 626c 6f63 6b2e 7472 616e 7370 6f73  n block.transpos
+0002ced0: 6528 6178 6573 290a 0a0a 6465 6620 5f76  e(axes)...def _v
+0002cee0: 696e 6465 785f 6d65 7267 6528 6c6f 6361  index_merge(loca
+0002cef0: 7469 6f6e 732c 2076 616c 7565 7329 3a0a  tions, values):.
+0002cf00: 2020 2020 2222 220a 0a20 2020 203e 3e3e      """..    >>>
+0002cf10: 206c 6f63 6174 696f 6e73 203d 205b 305d   locations = [0]
+0002cf20: 2c20 5b32 2c20 315d 0a20 2020 203e 3e3e  , [2, 1].    >>>
+0002cf30: 2076 616c 7565 7320 3d20 5b6e 702e 6172   values = [np.ar
+0002cf40: 7261 7928 5b5b 312c 2032 2c20 335d 5d29  ray([[1, 2, 3]])
+0002cf50: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
+0002cf60: 2020 2020 6e70 2e61 7272 6179 285b 5b31      np.array([[1
+0002cf70: 302c 2032 302c 2033 305d 2c20 5b34 302c  0, 20, 30], [40,
+0002cf80: 2035 302c 2036 305d 5d29 5d0a 0a20 2020   50, 60]])]..   
+0002cf90: 203e 3e3e 205f 7669 6e64 6578 5f6d 6572   >>> _vindex_mer
+0002cfa0: 6765 286c 6f63 6174 696f 6e73 2c20 7661  ge(locations, va
+0002cfb0: 6c75 6573 290a 2020 2020 6172 7261 7928  lues).    array(
+0002cfc0: 5b5b 2031 2c20 2032 2c20 2033 5d2c 0a20  [[ 1,  2,  3],. 
+0002cfd0: 2020 2020 2020 2020 2020 5b34 302c 2035            [40, 5
+0002cfe0: 302c 2036 305d 2c0a 2020 2020 2020 2020  0, 60],.        
+0002cff0: 2020 205b 3130 2c20 3230 2c20 3330 5d5d     [10, 20, 30]]
+0002d000: 290a 2020 2020 2222 220a 2020 2020 6c6f  ).    """.    lo
+0002d010: 6361 7469 6f6e 7320 3d20 6c69 7374 286d  cations = list(m
+0002d020: 6170 286c 6973 742c 206c 6f63 6174 696f  ap(list, locatio
+0002d030: 6e73 2929 0a20 2020 2076 616c 7565 7320  ns)).    values 
+0002d040: 3d20 6c69 7374 2876 616c 7565 7329 0a0a  = list(values)..
+0002d050: 2020 2020 6e20 3d20 7375 6d28 6d61 7028      n = sum(map(
+0002d060: 6c65 6e2c 206c 6f63 6174 696f 6e73 2929  len, locations))
+0002d070: 0a0a 2020 2020 7368 6170 6520 3d20 6c69  ..    shape = li
+0002d080: 7374 2876 616c 7565 735b 305d 2e73 6861  st(values[0].sha
+0002d090: 7065 290a 2020 2020 7368 6170 655b 305d  pe).    shape[0]
+0002d0a0: 203d 206e 0a20 2020 2073 6861 7065 203d   = n.    shape =
+0002d0b0: 2074 7570 6c65 2873 6861 7065 290a 0a20   tuple(shape).. 
+0002d0c0: 2020 2064 7479 7065 203d 2076 616c 7565     dtype = value
+0002d0d0: 735b 305d 2e64 7479 7065 0a0a 2020 2020  s[0].dtype..    
+0002d0e0: 7820 3d20 6e70 2e65 6d70 7479 5f6c 696b  x = np.empty_lik
+0002d0f0: 6528 7661 6c75 6573 5b30 5d2c 2064 7479  e(values[0], dty
+0002d100: 7065 3d64 7479 7065 2c20 7368 6170 653d  pe=dtype, shape=
+0002d110: 7368 6170 6529 0a0a 2020 2020 696e 6420  shape)..    ind 
+0002d120: 3d20 5b73 6c69 6365 284e 6f6e 652c 204e  = [slice(None, N
+0002d130: 6f6e 6529 2066 6f72 2069 2069 6e20 7261  one) for i in ra
+0002d140: 6e67 6528 782e 6e64 696d 295d 0a20 2020  nge(x.ndim)].   
+0002d150: 2066 6f72 206c 6f63 2c20 7661 6c20 696e   for loc, val in
+0002d160: 207a 6970 286c 6f63 6174 696f 6e73 2c20   zip(locations, 
+0002d170: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
+0002d180: 2069 6e64 5b30 5d20 3d20 6c6f 630a 2020   ind[0] = loc.  
+0002d190: 2020 2020 2020 785b 7475 706c 6528 696e        x[tuple(in
+0002d1a0: 6429 5d20 3d20 7661 6c0a 0a20 2020 2072  d)] = val..    r
+0002d1b0: 6574 7572 6e20 780a 0a0a 6465 6620 746f  eturn x...def to
+0002d1c0: 5f6e 7079 5f73 7461 636b 2864 6972 6e61  _npy_stack(dirna
+0002d1d0: 6d65 2c20 782c 2061 7869 733d 3029 3a0a  me, x, axis=0):.
+0002d1e0: 2020 2020 2222 2257 7269 7465 2064 6173      """Write das
+0002d1f0: 6b20 6172 7261 7920 746f 2061 2073 7461  k array to a sta
+0002d200: 636b 206f 6620 2e6e 7079 2066 696c 6573  ck of .npy files
+0002d210: 0a0a 2020 2020 5468 6973 2070 6172 7469  ..    This parti
+0002d220: 7469 6f6e 7320 7468 6520 6461 736b 2e61  tions the dask.a
+0002d230: 7272 6179 2061 6c6f 6e67 206f 6e65 2061  rray along one a
+0002d240: 7869 7320 616e 6420 7374 6f72 6573 2065  xis and stores e
+0002d250: 6163 6820 626c 6f63 6b20 616c 6f6e 670a  ach block along.
+0002d260: 2020 2020 7468 6174 2061 7869 7320 6173      that axis as
+0002d270: 2061 2073 696e 676c 6520 2e6e 7079 2066   a single .npy f
+0002d280: 696c 6520 696e 2074 6865 2073 7065 6369  ile in the speci
+0002d290: 6669 6564 2064 6972 6563 746f 7279 0a0a  fied directory..
+0002d2a0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0002d2b0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
+0002d2c0: 3e20 7820 3d20 6461 2e6f 6e65 7328 2835  > x = da.ones((5
+0002d2d0: 2c20 3130 2c20 3130 292c 2063 6875 6e6b  , 10, 10), chunk
+0002d2e0: 733d 2832 2c20 342c 2034 2929 2020 2320  s=(2, 4, 4))  # 
+0002d2f0: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0002d300: 2020 203e 3e3e 2064 612e 746f 5f6e 7079     >>> da.to_npy
+0002d310: 5f73 7461 636b 2827 6461 7461 2f27 2c20  _stack('data/', 
+0002d320: 782c 2061 7869 733d 3029 2020 2320 646f  x, axis=0)  # do
+0002d330: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
+0002d340: 2020 5468 6520 6060 2e6e 7079 6060 2066    The ``.npy`` f
+0002d350: 696c 6573 2073 746f 7265 206e 756d 7079  iles store numpy
+0002d360: 2061 7272 6179 7320 666f 7220 6060 785b   arrays for ``x[
+0002d370: 303a 325d 2c20 785b 323a 345d 2c20 616e  0:2], x[2:4], an
+0002d380: 6420 785b 343a 355d 6060 0a20 2020 2072  d x[4:5]``.    r
+0002d390: 6573 7065 6374 6976 656c 792c 2061 7320  espectively, as 
+0002d3a0: 6973 2073 7065 6369 6669 6564 2062 7920  is specified by 
+0002d3b0: 7468 6520 6368 756e 6b20 7369 7a65 2061  the chunk size a
+0002d3c0: 6c6f 6e67 2074 6865 207a 6572 6f74 6820  long the zeroth 
+0002d3d0: 6178 6973 3a3a 0a0a 2020 2020 2020 2020  axis::..        
+0002d3e0: 2420 7472 6565 2064 6174 612f 0a20 2020  $ tree data/.   
+0002d3f0: 2020 2020 2064 6174 612f 0a20 2020 2020       data/.     
+0002d400: 2020 207c 2d2d 2030 2e6e 7079 0a20 2020     |-- 0.npy.   
+0002d410: 2020 2020 207c 2d2d 2031 2e6e 7079 0a20       |-- 1.npy. 
+0002d420: 2020 2020 2020 207c 2d2d 2032 2e6e 7079         |-- 2.npy
+0002d430: 0a20 2020 2020 2020 207c 2d2d 2069 6e66  .        |-- inf
+0002d440: 6f0a 0a20 2020 2054 6865 2060 6069 6e66  o..    The ``inf
+0002d450: 6f60 6020 6669 6c65 2073 746f 7265 7320  o`` file stores 
+0002d460: 7468 6520 6474 7970 652c 2063 6875 6e6b  the dtype, chunk
+0002d470: 732c 2061 6e64 2061 7869 7320 696e 666f  s, and axis info
+0002d480: 726d 6174 696f 6e20 6f66 2074 6865 2061  rmation of the a
+0002d490: 7272 6179 2e0a 2020 2020 596f 7520 6361  rray..    You ca
+0002d4a0: 6e20 6c6f 6164 2074 6865 7365 2073 7461  n load these sta
+0002d4b0: 636b 7320 7769 7468 2074 6865 203a 6675  cks with the :fu
+0002d4c0: 6e63 3a60 6461 736b 2e61 7272 6179 2e66  nc:`dask.array.f
+0002d4d0: 726f 6d5f 6e70 795f 7374 6163 6b60 2066  rom_npy_stack` f
+0002d4e0: 756e 6374 696f 6e2e 0a0a 2020 2020 3e3e  unction...    >>
+0002d4f0: 3e20 7920 3d20 6461 2e66 726f 6d5f 6e70  > y = da.from_np
+0002d500: 795f 7374 6163 6b28 2764 6174 612f 2729  y_stack('data/')
+0002d510: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0002d520: 4950 0a0a 2020 2020 5365 6520 416c 736f  IP..    See Also
+0002d530: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+0002d540: 2020 6672 6f6d 5f6e 7079 5f73 7461 636b    from_npy_stack
+0002d550: 0a20 2020 2022 2222 0a0a 2020 2020 6368  .    """..    ch
+0002d560: 756e 6b73 203d 2074 7570 6c65 2828 6320  unks = tuple((c 
+0002d570: 6966 2069 203d 3d20 6178 6973 2065 6c73  if i == axis els
+0002d580: 6520 2873 756d 2863 292c 2929 2066 6f72  e (sum(c),)) for
+0002d590: 2069 2c20 6320 696e 2065 6e75 6d65 7261   i, c in enumera
+0002d5a0: 7465 2878 2e63 6875 6e6b 7329 290a 2020  te(x.chunks)).  
+0002d5b0: 2020 7878 203d 2078 2e72 6563 6875 6e6b    xx = x.rechunk
+0002d5c0: 2863 6875 6e6b 7329 0a0a 2020 2020 6966  (chunks)..    if
+0002d5d0: 206e 6f74 206f 732e 7061 7468 2e65 7869   not os.path.exi
+0002d5e0: 7374 7328 6469 726e 616d 6529 3a0a 2020  sts(dirname):.  
+0002d5f0: 2020 2020 2020 6f73 2e6d 6b64 6972 2864        os.mkdir(d
+0002d600: 6972 6e61 6d65 290a 0a20 2020 206d 6574  irname)..    met
+0002d610: 6120 3d20 7b22 6368 756e 6b73 223a 2063  a = {"chunks": c
+0002d620: 6875 6e6b 732c 2022 6474 7970 6522 3a20  hunks, "dtype": 
+0002d630: 782e 6474 7970 652c 2022 6178 6973 223a  x.dtype, "axis":
+0002d640: 2061 7869 737d 0a0a 2020 2020 7769 7468   axis}..    with
+0002d650: 206f 7065 6e28 6f73 2e70 6174 682e 6a6f   open(os.path.jo
+0002d660: 696e 2864 6972 6e61 6d65 2c20 2269 6e66  in(dirname, "inf
+0002d670: 6f22 292c 2022 7762 2229 2061 7320 663a  o"), "wb") as f:
+0002d680: 0a20 2020 2020 2020 2070 6963 6b6c 652e  .        pickle.
+0002d690: 6475 6d70 286d 6574 612c 2066 290a 0a20  dump(meta, f).. 
+0002d6a0: 2020 206e 616d 6520 3d20 2274 6f2d 6e70     name = "to-np
+0002d6b0: 792d 7374 6163 6b2d 2220 2b20 7374 7228  y-stack-" + str(
+0002d6c0: 7575 6964 2e75 7569 6431 2829 290a 2020  uuid.uuid1()).  
+0002d6d0: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
+0002d6e0: 2020 286e 616d 652c 2069 293a 2028 6e70    (name, i): (np
+0002d6f0: 2e73 6176 652c 206f 732e 7061 7468 2e6a  .save, os.path.j
+0002d700: 6f69 6e28 6469 726e 616d 652c 2022 2564  oin(dirname, "%d
+0002d710: 2e6e 7079 2220 2520 6929 2c20 6b65 7929  .npy" % i), key)
+0002d720: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
+0002d730: 6b65 7920 696e 2065 6e75 6d65 7261 7465  key in enumerate
+0002d740: 2863 6f72 652e 666c 6174 7465 6e28 7878  (core.flatten(xx
+0002d750: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
+0002d760: 2929 0a20 2020 207d 0a0a 2020 2020 6772  )).    }..    gr
+0002d770: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+0002d780: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+0002d790: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+0002d7a0: 2064 6570 656e 6465 6e63 6965 733d 5b78   dependencies=[x
+0002d7b0: 785d 290a 2020 2020 636f 6d70 7574 655f  x]).    compute_
+0002d7c0: 6173 5f69 665f 636f 6c6c 6563 7469 6f6e  as_if_collection
+0002d7d0: 2841 7272 6179 2c20 6772 6170 682c 206c  (Array, graph, l
+0002d7e0: 6973 7428 6473 6b29 290a 0a0a 6465 6620  ist(dsk))...def 
+0002d7f0: 6672 6f6d 5f6e 7079 5f73 7461 636b 2864  from_npy_stack(d
+0002d800: 6972 6e61 6d65 2c20 6d6d 6170 5f6d 6f64  irname, mmap_mod
+0002d810: 653d 2272 2229 3a0a 2020 2020 2222 224c  e="r"):.    """L
+0002d820: 6f61 6420 6461 736b 2061 7272 6179 2066  oad dask array f
+0002d830: 726f 6d20 7374 6163 6b20 6f66 206e 7079  rom stack of npy
+0002d840: 2066 696c 6573 0a0a 2020 2020 5061 7261   files..    Para
+0002d850: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+0002d860: 2d2d 2d2d 2d0a 2020 2020 6469 726e 616d  -----.    dirnam
+0002d870: 653a 2073 7472 696e 670a 2020 2020 2020  e: string.      
+0002d880: 2020 4469 7265 6374 6f72 7920 6f66 202e    Directory of .
+0002d890: 6e70 7920 6669 6c65 730a 2020 2020 6d6d  npy files.    mm
+0002d8a0: 6170 5f6d 6f64 653a 2028 4e6f 6e65 206f  ap_mode: (None o
+0002d8b0: 7220 2772 2729 0a20 2020 2020 2020 2052  r 'r').        R
+0002d8c0: 6561 6420 6461 7461 2069 6e20 6d65 6d6f  ead data in memo
+0002d8d0: 7279 206d 6170 206d 6f64 650a 0a20 2020  ry map mode..   
+0002d8e0: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
+0002d8f0: 2d2d 2d2d 2d2d 0a20 2020 2074 6f5f 6e70  ------.    to_np
+0002d900: 795f 7374 6163 6b0a 2020 2020 2222 220a  y_stack.    """.
+0002d910: 2020 2020 7769 7468 206f 7065 6e28 6f73      with open(os
+0002d920: 2e70 6174 682e 6a6f 696e 2864 6972 6e61  .path.join(dirna
+0002d930: 6d65 2c20 2269 6e66 6f22 292c 2022 7262  me, "info"), "rb
+0002d940: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
+0002d950: 2069 6e66 6f20 3d20 7069 636b 6c65 2e6c   info = pickle.l
+0002d960: 6f61 6428 6629 0a0a 2020 2020 6474 7970  oad(f)..    dtyp
+0002d970: 6520 3d20 696e 666f 5b22 6474 7970 6522  e = info["dtype"
+0002d980: 5d0a 2020 2020 6368 756e 6b73 203d 2069  ].    chunks = i
+0002d990: 6e66 6f5b 2263 6875 6e6b 7322 5d0a 2020  nfo["chunks"].  
+0002d9a0: 2020 6178 6973 203d 2069 6e66 6f5b 2261    axis = info["a
+0002d9b0: 7869 7322 5d0a 0a20 2020 206e 616d 6520  xis"]..    name 
+0002d9c0: 3d20 2266 726f 6d2d 6e70 792d 7374 6163  = "from-npy-stac
+0002d9d0: 6b2d 2573 2220 2520 6469 726e 616d 650a  k-%s" % dirname.
+0002d9e0: 2020 2020 6b65 7973 203d 206c 6973 7428      keys = list(
+0002d9f0: 7072 6f64 7563 7428 5b6e 616d 655d 2c20  product([name], 
+0002da00: 2a5b 7261 6e67 6528 6c65 6e28 6329 2920  *[range(len(c)) 
+0002da10: 666f 7220 6320 696e 2063 6875 6e6b 735d  for c in chunks]
+0002da20: 2929 0a20 2020 2076 616c 7565 7320 3d20  )).    values = 
+0002da30: 5b0a 2020 2020 2020 2020 286e 702e 6c6f  [.        (np.lo
+0002da40: 6164 2c20 6f73 2e70 6174 682e 6a6f 696e  ad, os.path.join
+0002da50: 2864 6972 6e61 6d65 2c20 2225 642e 6e70  (dirname, "%d.np
+0002da60: 7922 2025 2069 292c 206d 6d61 705f 6d6f  y" % i), mmap_mo
+0002da70: 6465 290a 2020 2020 2020 2020 666f 7220  de).        for 
+0002da80: 6920 696e 2072 616e 6765 286c 656e 2863  i in range(len(c
+0002da90: 6875 6e6b 735b 6178 6973 5d29 290a 2020  hunks[axis])).  
+0002daa0: 2020 5d0a 2020 2020 6473 6b20 3d20 6469    ].    dsk = di
+0002dab0: 6374 287a 6970 286b 6579 732c 2076 616c  ct(zip(keys, val
+0002dac0: 7565 7329 290a 0a20 2020 2072 6574 7572  ues))..    retur
+0002dad0: 6e20 4172 7261 7928 6473 6b2c 206e 616d  n Array(dsk, nam
+0002dae0: 652c 2063 6875 6e6b 732c 2064 7479 7065  e, chunks, dtype
+0002daf0: 290a 0a0a 6465 6620 6e65 775f 6461 5f6f  )...def new_da_o
+0002db00: 626a 6563 7428 6473 6b2c 206e 616d 652c  bject(dsk, name,
+0002db10: 2063 6875 6e6b 732c 206d 6574 613d 4e6f   chunks, meta=No
+0002db20: 6e65 2c20 6474 7970 653d 4e6f 6e65 293a  ne, dtype=None):
+0002db30: 0a20 2020 2022 2222 4765 6e65 7269 6320  .    """Generic 
+0002db40: 636f 6e73 7472 7563 746f 7220 666f 7220  constructor for 
+0002db50: 6461 736b 2e61 7272 6179 206f 7220 6461  dask.array or da
+0002db60: 736b 2e64 6174 6166 7261 6d65 206f 626a  sk.dataframe obj
+0002db70: 6563 7473 2e0a 0a20 2020 2044 6563 6964  ects...    Decid
+0002db80: 6573 2074 6865 2061 7070 726f 7072 6961  es the appropria
+0002db90: 7465 206f 7574 7075 7420 636c 6173 7320  te output class 
+0002dba0: 6261 7365 6420 6f6e 2074 6865 2074 7970  based on the typ
+0002dbb0: 6520 6f66 2060 6d65 7461 6020 7072 6f76  e of `meta` prov
+0002dbc0: 6964 6564 2e0a 2020 2020 2222 220a 2020  ided..    """.  
+0002dbd0: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
+0002dbe0: 655f 6c69 6b65 286d 6574 6129 206f 7220  e_like(meta) or 
+0002dbf0: 6973 5f73 6572 6965 735f 6c69 6b65 286d  is_series_like(m
+0002dc00: 6574 6129 206f 7220 6973 5f69 6e64 6578  eta) or is_index
+0002dc10: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
+0002dc20: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+0002dc30: 6174 6166 7261 6d65 2e63 6f72 6520 696d  ataframe.core im
+0002dc40: 706f 7274 206e 6577 5f64 645f 6f62 6a65  port new_dd_obje
+0002dc50: 6374 0a0a 2020 2020 2020 2020 6173 7365  ct..        asse
+0002dc60: 7274 2061 6c6c 286c 656e 2863 2920 3d3d  rt all(len(c) ==
+0002dc70: 2031 2066 6f72 2063 2069 6e20 6368 756e   1 for c in chun
+0002dc80: 6b73 5b31 3a5d 290a 2020 2020 2020 2020  ks[1:]).        
+0002dc90: 6469 7669 7369 6f6e 7320 3d20 5b4e 6f6e  divisions = [Non
+0002dca0: 655d 202a 2028 6c65 6e28 6368 756e 6b73  e] * (len(chunks
+0002dcb0: 5b30 5d29 202b 2031 290a 2020 2020 2020  [0]) + 1).      
+0002dcc0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+0002dcd0: 6f62 6a65 6374 2864 736b 2c20 6e61 6d65  object(dsk, name
+0002dce0: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+0002dcf0: 7329 0a20 2020 2065 6c73 653a 0a20 2020  s).    else:.   
+0002dd00: 2020 2020 2072 6574 7572 6e20 4172 7261       return Arra
+0002dd10: 7928 6473 6b2c 206e 616d 653d 6e61 6d65  y(dsk, name=name
+0002dd20: 2c20 6368 756e 6b73 3d63 6875 6e6b 732c  , chunks=chunks,
+0002dd30: 206d 6574 613d 6d65 7461 2c20 6474 7970   meta=meta, dtyp
+0002dd40: 653d 6474 7970 6529 0a0a 0a63 6c61 7373  e=dtype)...class
+0002dd50: 2042 6c6f 636b 5669 6577 3a0a 2020 2020   BlockView:.    
+0002dd60: 2222 2241 6e20 6172 7261 792d 6c69 6b65  """An array-like
+0002dd70: 2069 6e74 6572 6661 6365 2074 6f20 7468   interface to th
+0002dd80: 6520 626c 6f63 6b73 206f 6620 616e 2061  e blocks of an a
+0002dd90: 7272 6179 2e0a 0a20 2020 2060 6042 6c6f  rray...    ``Blo
+0002dda0: 636b 5669 6577 6060 2070 726f 7669 6465  ckView`` provide
+0002ddb0: 7320 616e 2061 7272 6179 2d6c 696b 6520  s an array-like 
+0002ddc0: 696e 7465 7266 6163 650a 2020 2020 746f  interface.    to
+0002ddd0: 2074 6865 2062 6c6f 636b 7320 6f66 2061   the blocks of a
+0002dde0: 2064 6173 6b20 6172 7261 792e 2020 4e75   dask array.  Nu
+0002ddf0: 6d70 792d 7374 796c 6520 696e 6465 7869  mpy-style indexi
+0002de00: 6e67 206f 6620 610a 2020 2020 2060 6042  ng of a.     ``B
+0002de10: 6c6f 636b 5669 6577 6060 2072 6574 7572  lockView`` retur
+0002de20: 6e73 2061 2073 656c 6563 7469 6f6e 206f  ns a selection o
+0002de30: 6620 626c 6f63 6b73 2061 7320 6120 6e65  f blocks as a ne
+0002de40: 7720 6461 736b 2061 7272 6179 2e0a 0a20  w dask array... 
+0002de50: 2020 2059 6f75 2063 616e 2069 6e64 6578     You can index
+0002de60: 2060 6042 6c6f 636b 5669 6577 6060 206c   ``BlockView`` l
+0002de70: 696b 6520 6120 6e75 6d70 7920 6172 7261  ike a numpy arra
+0002de80: 7920 6f66 2073 6861 7065 0a20 2020 2065  y of shape.    e
+0002de90: 7175 616c 2074 6f20 7468 6520 6e75 6d62  qual to the numb
+0002dea0: 6572 206f 6620 626c 6f63 6b73 2069 6e20  er of blocks in 
+0002deb0: 6561 6368 2064 696d 656e 7369 6f6e 2c20  each dimension, 
+0002dec0: 2861 7661 696c 6162 6c65 2061 730a 2020  (available as.  
+0002ded0: 2020 6172 7261 792e 626c 6f63 6b73 2e73    array.blocks.s
+0002dee0: 697a 6529 2e20 2054 6865 2064 696d 656e  ize).  The dimen
+0002def0: 7369 6f6e 616c 6974 7920 6f66 2074 6865  sionality of the
+0002df00: 206f 7574 7075 7420 6172 7261 7920 6d61   output array ma
+0002df10: 7463 6865 730a 2020 2020 7468 6520 6469  tches.    the di
+0002df20: 6d65 6e73 696f 6e20 6f66 2074 6869 7320  mension of this 
+0002df30: 6172 7261 792c 2065 7665 6e20 6966 2069  array, even if i
+0002df40: 6e74 6567 6572 2069 6e64 6963 6573 2061  nteger indices a
+0002df50: 7265 2070 6173 7365 642e 0a20 2020 2053  re passed..    S
+0002df60: 6c69 6369 6e67 2077 6974 6820 6060 6e70  licing with ``np
+0002df70: 2e6e 6577 6178 6973 6060 206f 7220 6d75  .newaxis`` or mu
+0002df80: 6c74 6970 6c65 206c 6973 7473 2069 7320  ltiple lists is 
+0002df90: 6e6f 7420 7375 7070 6f72 7465 642e 0a0a  not supported...
+0002dfa0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0002dfb0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
+0002dfc0: 3e20 696d 706f 7274 2064 6173 6b2e 6172  > import dask.ar
+0002dfd0: 7261 7920 6173 2064 610a 2020 2020 3e3e  ray as da.    >>
+0002dfe0: 3e20 6672 6f6d 2064 6173 6b2e 6172 7261  > from dask.arra
+0002dff0: 792e 636f 7265 2069 6d70 6f72 7420 426c  y.core import Bl
+0002e000: 6f63 6b56 6965 770a 2020 2020 3e3e 3e20  ockView.    >>> 
+0002e010: 7820 3d20 6461 2e61 7261 6e67 6528 382c  x = da.arange(8,
+0002e020: 2063 6875 6e6b 733d 3229 0a20 2020 203e   chunks=2).    >
+0002e030: 3e3e 2062 7620 3d20 426c 6f63 6b56 6965  >> bv = BlockVie
+0002e040: 7728 7829 0a20 2020 203e 3e3e 2062 762e  w(x).    >>> bv.
+0002e050: 7368 6170 6520 2320 616c 6961 7365 7320  shape # aliases 
+0002e060: 782e 6e75 6d62 6c6f 636b 730a 2020 2020  x.numblocks.    
+0002e070: 2834 2c29 0a20 2020 203e 3e3e 2062 762e  (4,).    >>> bv.
+0002e080: 7369 7a65 0a20 2020 2034 0a20 2020 203e  size.    4.    >
+0002e090: 3e3e 2062 765b 305d 2e63 6f6d 7075 7465  >> bv[0].compute
+0002e0a0: 2829 0a20 2020 2061 7272 6179 285b 302c  ().    array([0,
+0002e0b0: 2031 5d29 0a20 2020 203e 3e3e 2062 765b   1]).    >>> bv[
+0002e0c0: 3a33 5d2e 636f 6d70 7574 6528 290a 2020  :3].compute().  
+0002e0d0: 2020 6172 7261 7928 5b30 2c20 312c 2032    array([0, 1, 2
+0002e0e0: 2c20 332c 2034 2c20 355d 290a 2020 2020  , 3, 4, 5]).    
+0002e0f0: 3e3e 3e20 6276 5b3a 3a32 5d2e 636f 6d70  >>> bv[::2].comp
+0002e100: 7574 6528 290a 2020 2020 6172 7261 7928  ute().    array(
+0002e110: 5b30 2c20 312c 2034 2c20 355d 290a 2020  [0, 1, 4, 5]).  
+0002e120: 2020 3e3e 3e20 6276 5b5b 2d31 2c20 305d    >>> bv[[-1, 0]
+0002e130: 5d2e 636f 6d70 7574 6528 290a 2020 2020  ].compute().    
+0002e140: 6172 7261 7928 5b36 2c20 372c 2030 2c20  array([6, 7, 0, 
+0002e150: 315d 290a 2020 2020 3e3e 3e20 6276 2e72  1]).    >>> bv.r
+0002e160: 6176 656c 2829 2020 2320 646f 6374 6573  avel()  # doctes
+0002e170: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
+0002e180: 4954 4553 5041 4345 0a20 2020 205b 6461  ITESPACE.    [da
+0002e190: 736b 2e61 7272 6179 3c62 6c6f 636b 732c  sk.array<blocks,
+0002e1a0: 2073 6861 7065 3d28 322c 292c 2064 7479   shape=(2,), dty
+0002e1b0: 7065 3d69 6e74 3634 2c20 6368 756e 6b73  pe=int64, chunks
+0002e1c0: 697a 653d 2832 2c29 2c20 6368 756e 6b74  ize=(2,), chunkt
+0002e1d0: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
+0002e1e0: 793e 2c0a 2020 2020 2064 6173 6b2e 6172  y>,.     dask.ar
+0002e1f0: 7261 793c 626c 6f63 6b73 2c20 7368 6170  ray<blocks, shap
+0002e200: 653d 2832 2c29 2c20 6474 7970 653d 696e  e=(2,), dtype=in
+0002e210: 7436 342c 2063 6875 6e6b 7369 7a65 3d28  t64, chunksize=(
+0002e220: 322c 292c 2063 6875 6e6b 7479 7065 3d6e  2,), chunktype=n
+0002e230: 756d 7079 2e6e 6461 7272 6179 3e2c 0a20  umpy.ndarray>,. 
+0002e240: 2020 2020 6461 736b 2e61 7272 6179 3c62      dask.array<b
+0002e250: 6c6f 636b 732c 2073 6861 7065 3d28 322c  locks, shape=(2,
+0002e260: 292c 2064 7479 7065 3d69 6e74 3634 2c20  ), dtype=int64, 
+0002e270: 6368 756e 6b73 697a 653d 2832 2c29 2c20  chunksize=(2,), 
+0002e280: 6368 756e 6b74 7970 653d 6e75 6d70 792e  chunktype=numpy.
+0002e290: 6e64 6172 7261 793e 2c0a 2020 2020 2064  ndarray>,.     d
+0002e2a0: 6173 6b2e 6172 7261 793c 626c 6f63 6b73  ask.array<blocks
+0002e2b0: 2c20 7368 6170 653d 2832 2c29 2c20 6474  , shape=(2,), dt
+0002e2c0: 7970 653d 696e 7436 342c 2063 6875 6e6b  ype=int64, chunk
+0002e2d0: 7369 7a65 3d28 322c 292c 2063 6875 6e6b  size=(2,), chunk
+0002e2e0: 7479 7065 3d6e 756d 7079 2e6e 6461 7272  type=numpy.ndarr
+0002e2f0: 6179 3e5d 0a0a 2020 2020 5265 7475 726e  ay>]..    Return
+0002e300: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+0002e310: 2020 416e 2069 6e73 7461 6e63 6520 6f66    An instance of
+0002e320: 2060 6064 612e 6172 7261 792e 426c 6f63   ``da.array.Bloc
+0002e330: 6b76 6965 7760 600a 2020 2020 2222 220a  kview``.    """.
+0002e340: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0002e350: 5f28 7365 6c66 2c20 6172 7261 793a 2041  _(self, array: A
+0002e360: 7272 6179 293a 0a20 2020 2020 2020 2073  rray):.        s
+0002e370: 656c 662e 5f61 7272 6179 203d 2061 7272  elf._array = arr
+0002e380: 6179 0a0a 2020 2020 6465 6620 5f5f 6765  ay..    def __ge
+0002e390: 7469 7465 6d5f 5f28 7365 6c66 2c20 696e  titem__(self, in
+0002e3a0: 6465 783a 2041 6e79 2920 2d3e 2041 7272  dex: Any) -> Arr
+0002e3b0: 6179 3a0a 2020 2020 2020 2020 6672 6f6d  ay:.        from
+0002e3c0: 2064 6173 6b2e 6172 7261 792e 736c 6963   dask.array.slic
+0002e3d0: 696e 6720 696d 706f 7274 206e 6f72 6d61  ing import norma
+0002e3e0: 6c69 7a65 5f69 6e64 6578 0a0a 2020 2020  lize_index..    
+0002e3f0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0002e400: 7461 6e63 6528 696e 6465 782c 2074 7570  tance(index, tup
+0002e410: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
+0002e420: 2069 6e64 6578 203d 2028 696e 6465 782c   index = (index,
+0002e430: 290a 2020 2020 2020 2020 6966 2073 756d  ).        if sum
+0002e440: 2869 7369 6e73 7461 6e63 6528 696e 642c  (isinstance(ind,
+0002e450: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
+0002e460: 7374 2929 2066 6f72 2069 6e64 2069 6e20  st)) for ind in 
+0002e470: 696e 6465 7829 203e 2031 3a0a 2020 2020  index) > 1:.    
+0002e480: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002e490: 6c75 6545 7272 6f72 2822 4361 6e20 6f6e  lueError("Can on
+0002e4a0: 6c79 2073 6c69 6365 2077 6974 6820 6120  ly slice with a 
+0002e4b0: 7369 6e67 6c65 206c 6973 7422 290a 2020  single list").  
+0002e4c0: 2020 2020 2020 6966 2061 6e79 2869 6e64        if any(ind
+0002e4d0: 2069 7320 4e6f 6e65 2066 6f72 2069 6e64   is None for ind
+0002e4e0: 2069 6e20 696e 6465 7829 3a0a 2020 2020   in index):.    
+0002e4f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002e500: 6c75 6545 7272 6f72 2822 536c 6963 696e  lueError("Slicin
+0002e510: 6720 7769 7468 206e 702e 6e65 7761 7869  g with np.newaxi
+0002e520: 7320 6f72 204e 6f6e 6520 6973 206e 6f74  s or None is not
+0002e530: 2073 7570 706f 7274 6564 2229 0a20 2020   supported").   
+0002e540: 2020 2020 2069 6e64 6578 203d 206e 6f72       index = nor
+0002e550: 6d61 6c69 7a65 5f69 6e64 6578 2869 6e64  malize_index(ind
+0002e560: 6578 2c20 7365 6c66 2e5f 6172 7261 792e  ex, self._array.
+0002e570: 6e75 6d62 6c6f 636b 7329 0a20 2020 2020  numblocks).     
+0002e580: 2020 2069 6e64 6578 203d 2074 7570 6c65     index = tuple
+0002e590: 280a 2020 2020 2020 2020 2020 2020 736c  (.            sl
+0002e5a0: 6963 6528 6b2c 206b 202b 2031 2920 6966  ice(k, k + 1) if
+0002e5b0: 2069 7369 6e73 7461 6e63 6528 6b2c 204e   isinstance(k, N
+0002e5c0: 756d 6265 7229 2065 6c73 6520 6b20 2023  umber) else k  #
+0002e5d0: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
+0002e5e0: 2020 2020 2020 2020 2020 666f 7220 6b20            for k 
+0002e5f0: 696e 2069 6e64 6578 0a20 2020 2020 2020  in index.       
+0002e600: 2029 0a0a 2020 2020 2020 2020 6e61 6d65   )..        name
+0002e610: 203d 2022 626c 6f63 6b73 2d22 202b 2074   = "blocks-" + t
+0002e620: 6f6b 656e 697a 6528 7365 6c66 2e5f 6172  okenize(self._ar
+0002e630: 7261 792c 2069 6e64 6578 290a 0a20 2020  ray, index)..   
+0002e640: 2020 2020 206e 6577 5f6b 6579 7320 3d20       new_keys = 
+0002e650: 7365 6c66 2e5f 6172 7261 792e 5f6b 6579  self._array._key
+0002e660: 5f61 7272 6179 5b69 6e64 6578 5d0a 0a20  _array[index].. 
+0002e670: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
+0002e680: 7475 706c 6528 0a20 2020 2020 2020 2020  tuple(.         
+0002e690: 2020 2074 7570 6c65 286e 702e 6172 7261     tuple(np.arra
+0002e6a0: 7928 6329 5b69 5d2e 746f 6c69 7374 2829  y(c)[i].tolist()
+0002e6b0: 2920 666f 7220 632c 2069 2069 6e20 7a69  ) for c, i in zi
+0002e6c0: 7028 7365 6c66 2e5f 6172 7261 792e 6368  p(self._array.ch
+0002e6d0: 756e 6b73 2c20 696e 6465 7829 0a20 2020  unks, index).   
+0002e6e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002e6f0: 6b65 7973 203d 2070 726f 6475 6374 282a  keys = product(*
+0002e700: 2872 616e 6765 286c 656e 2863 2929 2066  (range(len(c)) f
+0002e710: 6f72 2063 2069 6e20 6368 756e 6b73 2929  or c in chunks))
+0002e720: 0a0a 2020 2020 2020 2020 6772 6170 683a  ..        graph:
+0002e730: 2047 7261 7068 203d 207b 286e 616d 652c   Graph = {(name,
+0002e740: 2920 2b20 6b65 793a 2074 7570 6c65 286e  ) + key: tuple(n
+0002e750: 6577 5f6b 6579 735b 6b65 795d 2e74 6f6c  ew_keys[key].tol
+0002e760: 6973 7428 2929 2066 6f72 206b 6579 2069  ist()) for key i
+0002e770: 6e20 6b65 7973 7d0a 0a20 2020 2020 2020  n keys}..       
+0002e780: 2068 6c67 203d 2048 6967 684c 6576 656c   hlg = HighLevel
+0002e790: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0002e7a0: 6374 696f 6e73 286e 616d 652c 2067 7261  ctions(name, gra
+0002e7b0: 7068 2c20 6465 7065 6e64 656e 6369 6573  ph, dependencies
+0002e7c0: 3d5b 7365 6c66 2e5f 6172 7261 795d 290a  =[self._array]).
+0002e7d0: 2020 2020 2020 2020 7265 7475 726e 2041          return A
+0002e7e0: 7272 6179 2868 6c67 2c20 6e61 6d65 2c20  rray(hlg, name, 
+0002e7f0: 6368 756e 6b73 2c20 6d65 7461 3d73 656c  chunks, meta=sel
+0002e800: 662e 5f61 7272 6179 290a 0a20 2020 2064  f._array)..    d
+0002e810: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
+0002e820: 6f74 6865 723a 2041 6e79 2920 2d3e 2062  other: Any) -> b
+0002e830: 6f6f 6c3a 0a20 2020 2020 2020 2069 6620  ool:.        if 
+0002e840: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+0002e850: 2c20 426c 6f63 6b56 6965 7729 3a0a 2020  , BlockView):.  
+0002e860: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002e870: 2073 656c 662e 5f61 7272 6179 2069 7320   self._array is 
+0002e880: 6f74 6865 722e 5f61 7272 6179 0a20 2020  other._array.   
+0002e890: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002e8a0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+0002e8b0: 7449 6d70 6c65 6d65 6e74 6564 0a0a 2020  tImplemented..  
+0002e8c0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0002e8d0: 6465 6620 7369 7a65 2873 656c 6629 202d  def size(self) -
+0002e8e0: 3e20 696e 743a 0a20 2020 2020 2020 2022  > int:.        "
+0002e8f0: 2222 0a20 2020 2020 2020 2054 6865 2074  "".        The t
+0002e900: 6f74 616c 206e 756d 6265 7220 6f66 2062  otal number of b
+0002e910: 6c6f 636b 7320 696e 2074 6865 2061 7272  locks in the arr
+0002e920: 6179 2e0a 2020 2020 2020 2020 2222 220a  ay..        """.
+0002e930: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0002e940: 6174 682e 7072 6f64 2873 656c 662e 7368  ath.prod(self.sh
+0002e950: 6170 6529 0a0a 2020 2020 4070 726f 7065  ape)..    @prope
+0002e960: 7274 790a 2020 2020 6465 6620 7368 6170  rty.    def shap
+0002e970: 6528 7365 6c66 2920 2d3e 2074 7570 6c65  e(self) -> tuple
+0002e980: 5b69 6e74 2c20 2e2e 2e5d 3a0a 2020 2020  [int, ...]:.    
+0002e990: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002e9a0: 5468 6520 6e75 6d62 6572 206f 6620 626c  The number of bl
+0002e9b0: 6f63 6b73 2070 6572 2061 7869 732e 2041  ocks per axis. A
+0002e9c0: 6c69 6173 206f 6620 6060 6461 736b 2e61  lias of ``dask.a
+0002e9d0: 7272 6179 2e6e 756d 626c 6f63 6b73 6060  rray.numblocks``
+0002e9e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0002e9f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002ea00: 662e 5f61 7272 6179 2e6e 756d 626c 6f63  f._array.numbloc
+0002ea10: 6b73 0a0a 2020 2020 6465 6620 7261 7665  ks..    def rave
+0002ea20: 6c28 7365 6c66 2920 2d3e 206c 6973 745b  l(self) -> list[
+0002ea30: 4172 7261 795d 3a0a 2020 2020 2020 2020  Array]:.        
+0002ea40: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0002ea50: 726e 2061 2066 6c61 7474 656e 6564 206c  rn a flattened l
+0002ea60: 6973 7420 6f66 2061 6c6c 2074 6865 2062  ist of all the b
+0002ea70: 6c6f 636b 7320 696e 2074 6865 2061 7272  locks in the arr
+0002ea80: 6179 2069 6e20 4320 6f72 6465 722e 0a20  ay in C order.. 
+0002ea90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0002eaa0: 2020 2072 6574 7572 6e20 5b73 656c 665b     return [self[
+0002eab0: 6964 785d 2066 6f72 2069 6478 2069 6e20  idx] for idx in 
+0002eac0: 6e70 2e6e 6469 6e64 6578 2873 656c 662e  np.ndindex(self.
+0002ead0: 7368 6170 6529 5d0a 0a0a 6672 6f6d 2064  shape)]...from d
+0002eae0: 6173 6b2e 6172 7261 792e 626c 6f63 6b77  ask.array.blockw
+0002eaf0: 6973 6520 696d 706f 7274 2062 6c6f 636b  ise import block
+0002eb00: 7769 7365 0a66 726f 6d20 6461 736b 2e61  wise.from dask.a
+0002eb10: 7272 6179 2e75 7469 6c73 2069 6d70 6f72  rray.utils impor
+0002eb20: 7420 636f 6d70 7574 655f 6d65 7461 2c20  t compute_meta, 
+0002eb30: 6d65 7461 5f66 726f 6d5f 6172 7261 790a  meta_from_array.
```

### Comparing `dask-2024.4.1/dask/array/creation.py` & `dask-2024.4.2/dask/array/creation.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/cupy_entry_point.py` & `dask-2024.4.2/dask/array/cupy_entry_point.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/dispatch.py` & `dask-2024.4.2/dask/array/dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/einsumfuncs.py` & `dask-2024.4.2/dask/array/einsumfuncs.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/fft.py` & `dask-2024.4.2/dask/array/fft.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/gufunc.py` & `dask-2024.4.2/dask/array/gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/image.py` & `dask-2024.4.2/dask/array/image.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/linalg.py` & `dask-2024.4.2/dask/array/linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/ma.py` & `dask-2024.4.2/dask/array/ma.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/numpy_compat.py` & `dask-2024.4.2/dask/array/numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/optimization.py` & `dask-2024.4.2/dask/array/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/overlap.py` & `dask-2024.4.2/dask/array/overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/percentile.py` & `dask-2024.4.2/dask/array/percentile.py`

 * *Files 0% similar despite different names*

```diff
@@ -79,15 +79,15 @@
     ----------
     a : Array
     q : array_like of float
         Percentile or sequence of percentiles to compute, which must be between
         0 and 100 inclusive.
     method : {'linear', 'lower', 'higher', 'midpoint', 'nearest'}, optional
         The interpolation method to use when the desired percentile lies
-        between two data points ``i < j``. Only valid for ``method='dask'``.
+        between two data points ``i < j``. Only valid for ``internal_method='dask'``.
 
         - 'linear': ``i + (j - i) * fraction``, where ``fraction``
           is the fractional part of the index surrounded by ``i``
           and ``j``.
         - 'lower': ``i``.
         - 'higher': ``j``.
         - 'nearest': ``i`` or ``j``, whichever is nearest.
```

### Comparing `dask-2024.4.1/dask/array/random.py` & `dask-2024.4.2/dask/array/random.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/rechunk.py` & `dask-2024.4.2/dask/array/rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/reductions.py` & `dask-2024.4.2/dask/array/reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/reshape.py` & `dask-2024.4.2/dask/array/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/routines.py` & `dask-2024.4.2/dask/array/routines.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/slicing.py` & `dask-2024.4.2/dask/array/slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/stats.py` & `dask-2024.4.2/dask/array/stats.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/svg.py` & `dask-2024.4.2/dask/array/svg.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_array_core.py` & `dask-2024.4.2/dask/array/tests/test_array_core.py`

 * *Files 0% similar despite different names*

```diff
@@ -3907,14 +3907,25 @@
     assert_eq(x, dx)
 
     index = da.arange(3)
     with pytest.raises(ValueError, match="Boolean index assignment in Dask"):
         dx[index] = 1
 
 
+def test_setitem_masked():
+    # Test np.ma.masked assignment to object-type arrays
+    x = np.ma.array(["a", 1, 3.14], dtype=object)
+    dx = da.from_array(x.copy(), chunks=2)
+
+    x[...] = np.ma.masked
+    dx[...] = np.ma.masked
+
+    assert_eq(x.mask, da.ma.getmaskarray(dx))
+
+
 def test_setitem_hardmask():
     x = np.ma.array([1, 2, 3, 4], dtype=int)
     x.harden_mask()
 
     y = x.copy()
     assert y.hardmask
```

### Comparing `dask-2024.4.1/dask/array/tests/test_array_function.py` & `dask-2024.4.2/dask/array/tests/test_array_function.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_array_utils.py` & `dask-2024.4.2/dask/array/tests/test_array_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_atop.py` & `dask-2024.4.2/dask/array/tests/test_atop.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_chunk.py` & `dask-2024.4.2/dask/array/tests/test_chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_creation.py` & `dask-2024.4.2/dask/array/tests/test_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_core.py` & `dask-2024.4.2/dask/array/tests/test_cupy_core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_creation.py` & `dask-2024.4.2/dask/array/tests/test_cupy_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_gufunc.py` & `dask-2024.4.2/dask/array/tests/test_cupy_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_linalg.py` & `dask-2024.4.2/dask/array/tests/test_cupy_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_overlap.py` & `dask-2024.4.2/dask/array/tests/test_cupy_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_percentile.py` & `dask-2024.4.2/dask/array/tests/test_cupy_percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_random.py` & `dask-2024.4.2/dask/array/tests/test_cupy_random.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_reductions.py` & `dask-2024.4.2/dask/array/tests/test_cupy_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_routines.py` & `dask-2024.4.2/dask/array/tests/test_cupy_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_slicing.py` & `dask-2024.4.2/dask/array/tests/test_cupy_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_cupy_sparse.py` & `dask-2024.4.2/dask/array/tests/test_cupy_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_dispatch.py` & `dask-2024.4.2/dask/array/tests/test_dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_fft.py` & `dask-2024.4.2/dask/array/tests/test_fft.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_gufunc.py` & `dask-2024.4.2/dask/array/tests/test_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_image.py` & `dask-2024.4.2/dask/array/tests/test_image.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_linalg.py` & `dask-2024.4.2/dask/array/tests/test_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_masked.py` & `dask-2024.4.2/dask/array/tests/test_masked.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_numpy_compat.py` & `dask-2024.4.2/dask/array/tests/test_numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_optimization.py` & `dask-2024.4.2/dask/array/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_overlap.py` & `dask-2024.4.2/dask/array/tests/test_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_percentiles.py` & `dask-2024.4.2/dask/array/tests/test_percentiles.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_random.py` & `dask-2024.4.2/dask/array/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_rechunk.py` & `dask-2024.4.2/dask/array/tests/test_rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_reductions.py` & `dask-2024.4.2/dask/array/tests/test_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_reshape.py` & `dask-2024.4.2/dask/array/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_routines.py` & `dask-2024.4.2/dask/array/tests/test_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_slicing.py` & `dask-2024.4.2/dask/array/tests/test_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_sparse.py` & `dask-2024.4.2/dask/array/tests/test_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_stats.py` & `dask-2024.4.2/dask/array/tests/test_stats.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_svg.py` & `dask-2024.4.2/dask/array/tests/test_svg.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_testing.py` & `dask-2024.4.2/dask/array/tests/test_testing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_ufunc.py` & `dask-2024.4.2/dask/array/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_wrap.py` & `dask-2024.4.2/dask/array/tests/test_wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tests/test_xarray.py` & `dask-2024.4.2/dask/array/tests/test_xarray.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/tiledb_io.py` & `dask-2024.4.2/dask/array/tiledb_io.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/ufunc.py` & `dask-2024.4.2/dask/array/ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/utils.py` & `dask-2024.4.2/dask/array/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/array/wrap.py` & `dask-2024.4.2/dask/array/wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/backends.py` & `dask-2024.4.2/dask/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/__init__.py` & `dask-2024.4.2/dask/bag/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/avro.py` & `dask-2024.4.2/dask/bag/avro.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/chunk.py` & `dask-2024.4.2/dask/bag/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/core.py` & `dask-2024.4.2/dask/bag/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -1620,20 +1620,20 @@
         else:
             dsk = dfs.dask
 
         divisions = [None] * (self.npartitions + 1)
         if not dd._dask_expr_enabled():
             return dd.DataFrame(dsk, dfs.name, meta, divisions)
         else:
-            from dask_expr import from_dask_dataframe
+            from dask_expr import from_legacy_dataframe
 
             from dask.dataframe.core import DataFrame
 
             df = DataFrame(dsk, dfs.name, meta, divisions)
-            return from_dask_dataframe(df)
+            return from_legacy_dataframe(df)
 
     def to_delayed(self, optimize_graph=True):
         """Convert into a list of ``dask.delayed`` objects, one per partition.
 
         Parameters
         ----------
         optimize_graph : bool, optional
@@ -1739,15 +1739,15 @@
 
 def partition(grouper, sequence, npartitions, p, nelements=2**20):
     """Partition a bag along a grouper, store partitions on disk."""
     for block in partition_all(nelements, sequence):
         d = groupby(grouper, block)
         d2 = defaultdict(list)
         for k, v in d.items():
-            d2[abs(hash(k)) % npartitions].extend(v)
+            d2[abs(int(tokenize(k), 16)) % npartitions].extend(v)
         p.append(d2, fsync=True)
     return p
 
 
 def collect(grouper, group, p, barrier_token):
     """Collect partitions from disk and yield k,v group pairs."""
     d = groupby(grouper, p.get(group, lock=False))
@@ -2359,15 +2359,15 @@
 def make_group(k, stage):
     def h(x):
         return x[0] // k**stage % k
 
     return h
 
 
-def groupby_tasks(b, grouper, hash=hash, max_branch=32):
+def groupby_tasks(b, grouper, hash=lambda x: int(tokenize(x), 16), max_branch=32):
     max_branch = max_branch or 32
     n = b.npartitions
 
     stages = int(math.ceil(math.log(n) / math.log(max_branch))) or 1
     if stages > 1:
         k = int(math.ceil(n ** (1 / stages)))
     else:
```

### Comparing `dask-2024.4.1/dask/bag/random.py` & `dask-2024.4.2/dask/bag/random.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/tests/test_avro.py` & `dask-2024.4.2/dask/bag/tests/test_avro.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/tests/test_bag.py` & `dask-2024.4.2/dask/bag/tests/test_bag.py`

 * *Files 2% similar despite different names*

```diff
@@ -5,14 +5,15 @@
 import os
 import random
 import warnings
 import weakref
 from bz2 import BZ2File
 from collections.abc import Iterator
 from concurrent.futures import ProcessPoolExecutor
+from dataclasses import dataclass
 from gzip import GzipFile
 from itertools import repeat
 
 import partd
 import pytest
 from tlz import groupby, identity, join, merge, pluck, unique, valmap
 
@@ -61,25 +62,60 @@
 def test_keys():
     assert b.__dask_keys__() == sorted(dsk.keys())
 
 
 def test_bag_groupby_pure_hash():
     # https://github.com/dask/dask/issues/6640
     result = b.groupby(iseven).compute()
-    assert result == [(False, [1, 3] * 3), (True, [0, 2, 4] * 3)]
+    assert result == [(True, [0, 2, 4] * 3), (False, [1, 3] * 3)]
 
 
 def test_bag_groupby_normal_hash():
     # https://github.com/dask/dask/issues/6640
     result = b.groupby(lambda x: "even" if iseven(x) else "odd").compute()
     assert len(result) == 2
     assert ("odd", [1, 3] * 3) in result
     assert ("even", [0, 2, 4] * 3) in result
 
 
+@pytest.mark.parametrize("shuffle", ["disk", "tasks"])
+@pytest.mark.parametrize("scheduler", ["synchronous", "processes"])
+def test_bag_groupby_none(shuffle, scheduler):
+    with dask.config.set(scheduler=scheduler):
+        seq = [(None, i) for i in range(50)]
+        b = db.from_sequence(seq).groupby(lambda x: x[0], shuffle=shuffle)
+        result = b.compute()
+        assert len(result) == 1
+
+
+@dataclass(frozen=True)
+class Key:
+    foo: int
+    bar: int | None = None
+
+
+@pytest.mark.parametrize(
+    "key",
+    # if a value for `bar` is not explicitly passed, Key.bar will default to `None`,
+    # thereby introducing the risk of inter-process inconsistency for the value returned by
+    # built-in `hash` (due to lack of deterministic hashing for `None` prior to python 3.12).
+    # without https://github.com/dask/dask/pull/10734, this results in failures for this test.
+    [Key(foo=1), Key(foo=1, bar=2)],
+    ids=["none_field", "no_none_fields"],
+)
+@pytest.mark.parametrize("shuffle", ["disk", "tasks"])
+@pytest.mark.parametrize("scheduler", ["synchronous", "processes"])
+def test_bag_groupby_dataclass(key, shuffle, scheduler):
+    seq = [(key, i) for i in range(50)]
+    b = db.from_sequence(seq).groupby(lambda x: x[0], shuffle=shuffle)
+    with dask.config.set(scheduler=scheduler):
+        result = b.compute()
+    assert len(result) == 1
+
+
 def test_bag_map():
     b = db.from_sequence(range(100), npartitions=10)
     b2 = db.from_sequence(range(100, 200), npartitions=10)
     x = b.compute()
     x2 = b2.compute()
 
     def myadd(a=1, b=2, c=3):
@@ -759,19 +795,19 @@
     assert z.name != b2.name
     assert z.name == x.product(y).name
 
 
 def test_partition_collect():
     with partd.Pickle() as p:
         partition(identity, range(6), 3, p)
-        assert set(p.get(0)) == {0, 3}
-        assert set(p.get(1)) == {1, 4}
-        assert set(p.get(2)) == {2, 5}
+        assert set(p.get(0)) == {3, 5}
+        assert set(p.get(1)) == {1}
+        assert set(p.get(2)) == {0, 2, 4}
 
-        assert sorted(collect(identity, 0, p, "")) == [(0, [0]), (3, [3])]
+        assert sorted(collect(identity, 2, p, "")) == [(0, [0]), (2, [2]), (4, [4])]
 
 
 def test_groupby():
     c = b.groupby(identity)
     result = dict(c)
     assert result == {
         0: [0, 0, 0],
```

### Comparing `dask-2024.4.1/dask/bag/tests/test_random.py` & `dask-2024.4.2/dask/bag/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/tests/test_text.py` & `dask-2024.4.2/dask/bag/tests/test_text.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bag/text.py` & `dask-2024.4.2/dask/bag/text.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/base.py` & `dask-2024.4.2/dask/base.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/blockwise.py` & `dask-2024.4.2/dask/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bytes/core.py` & `dask-2024.4.2/dask/bytes/core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bytes/tests/test_bytes_utils.py` & `dask-2024.4.2/dask/bytes/tests/test_bytes_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bytes/tests/test_compression.py` & `dask-2024.4.2/dask/bytes/tests/test_compression.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bytes/tests/test_http.py` & `dask-2024.4.2/dask/bytes/tests/test_http.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bytes/tests/test_local.py` & `dask-2024.4.2/dask/bytes/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/bytes/tests/test_s3.py` & `dask-2024.4.2/dask/bytes/tests/test_s3.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/cache.py` & `dask-2024.4.2/dask/cache.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/callbacks.py` & `dask-2024.4.2/dask/callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/cli.py` & `dask-2024.4.2/dask/cli.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/compatibility.py` & `dask-2024.4.2/dask/compatibility.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/config.py` & `dask-2024.4.2/dask/config.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/conftest.py` & `dask-2024.4.2/dask/conftest.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/context.py` & `dask-2024.4.2/dask/context.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/core.py` & `dask-2024.4.2/dask/core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dask-schema.yaml` & `dask-2024.4.2/dask/dask-schema.yaml`

 * *Files 2% similar despite different names*

```diff
@@ -80,14 +80,20 @@
 
           metadata-task-size-remote:
             type: integer
             description: |
               The number of files to handle within each metadata-processing
               task when reading a parquet dataset from a REMOTE file system.
               Specifying 0 will result in serial execution on the client.
+          minimum-partition-size:
+            type: integer
+            description: |
+              The minimum in-memory size of a single partition after reading
+              from parquet. Smaller parquet files will be combined into
+              a single partitions to reach this threshold.
 
       convert-string:
         type: [boolean, 'null']
         description: |
           Whether to convert string-like data to pyarrow strings.
       query-planning:
         type: [boolean, "null"]
```

### Comparing `dask-2024.4.1/dask/dask.yaml` & `dask-2024.4.2/dask/dask.yaml`

 * *Files 5% similar despite different names*

```diff
@@ -10,14 +10,15 @@
   backend: "pandas"  # Backend dataframe library for input IO and data creation
   shuffle:
     method: null
     compression: null  # compression for on disk-shuffling. Partd supports ZLib, BZ2, SNAPPY
   parquet:
     metadata-task-size-local: 512  # Number of files per local metadata-processing task
     metadata-task-size-remote: 1  # Number of files per remote metadata-processing task
+    minimum-partition-size: 75000000
   convert-string: null  # Whether to convert string-like data to pyarrow strings
   query-planning: null  # Whether to use dask-expr
 
 array:
   backend: "numpy"  # Backend array library for input IO and data creation
   chunk-size: "128MiB"
   rechunk:
```

### Comparing `dask-2024.4.1/dask/dataframe/__init__.py` & `dask-2024.4.2/dask/dataframe/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,14 +25,15 @@
 Dask dataframe query planning is disabled because dask-expr is not installed.
 
 You can install it with `pip install dask[dataframe]` or `conda install dask`.
 This will raise in a future version.
 """
         if use_dask_expr is None:
             warnings.warn(msg, FutureWarning)
+            return False
         else:
             raise ImportError(msg)
     return True
 
 
 try:
     import dask.dataframe._pyarrow_compat
@@ -119,16 +120,18 @@
             concat,
             from_array,
             from_dask_array,
             from_dask_dataframe,
             from_delayed,
             from_dict,
             from_graph,
+            from_legacy_dataframe,
             from_map,
             from_pandas,
+            get_collection_type,
             get_dummies,
             isna,
             map_overlap,
             map_partitions,
             merge,
             merge_asof,
             pivot_table,
```

### Comparing `dask-2024.4.1/dask/dataframe/_compat.py` & `dask-2024.4.2/dask/dataframe/_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/_dtypes.py` & `dask-2024.4.2/dask/dataframe/_dtypes.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/_pyarrow.py` & `dask-2024.4.2/dask/dataframe/_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/_pyarrow_compat.py` & `dask-2024.4.2/dask/dataframe/_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/accessor.py` & `dask-2024.4.2/dask/dataframe/accessor.py`

 * *Files 0% similar despite different names*

```diff
@@ -25,24 +25,26 @@
 
 def _bind_property(cls, pd_cls, attr, min_version=None):
     def func(self):
         return self._property_map(attr)
 
     func.__name__ = attr
     func.__qualname__ = f"{cls.__name__}.{attr}"
-    original_prop = getattr(pd_cls, attr)
-    if isinstance(original_prop, property):
-        method = original_prop.fget
-    elif isinstance(original_prop, functools.cached_property):
-        method = original_prop.func
-    else:
-        method = original_prop
     try:
-        func.__wrapped__ = method
+        # Attempt to determine the method we are wrapping
+        original_prop = getattr(pd_cls, attr)
+        if isinstance(original_prop, property):
+            method = original_prop.fget
+        elif isinstance(original_prop, functools.cached_property):
+            method = original_prop.func
+        else:
+            method = original_prop
+            func.__wrapped__ = method
     except Exception:
+        # If we can't then no matter, the function still works.
         pass
     setattr(cls, attr, property(derived_from(pd_cls, version=min_version)(func)))
 
 
 def maybe_wrap_pandas(obj, x):
     if isinstance(x, np.ndarray):
         if isinstance(obj, pd.Series):
```

### Comparing `dask-2024.4.1/dask/dataframe/backends.py` & `dask-2024.4.2/dask/dataframe/backends.py`

 * *Files 1% similar despite different names*

```diff
@@ -767,21 +767,23 @@
 
 ######################################
 # cuDF: Pandas Dataframes on the GPU #
 ######################################
 
 
 @concat_dispatch.register_lazy("cudf")
-@hash_object_dispatch.register_lazy("cudf")
+@from_pyarrow_table_dispatch.register_lazy("cudf")
 @group_split_dispatch.register_lazy("cudf")
 @get_parallel_type.register_lazy("cudf")
+@hash_object_dispatch.register_lazy("cudf")
 @meta_nonempty.register_lazy("cudf")
 @make_meta_dispatch.register_lazy("cudf")
 @make_meta_obj.register_lazy("cudf")
 @percentile_lookup.register_lazy("cudf")
+@to_pyarrow_table_dispatch.register_lazy("cudf")
 @tolist_dispatch.register_lazy("cudf")
 def _register_cudf():
     import dask_cudf  # noqa: F401
 
 
 @meta_lib_from_array.register_lazy("cupy")
 @tolist_dispatch.register_lazy("cupy")
```

### Comparing `dask-2024.4.1/dask/dataframe/categorical.py` & `dask-2024.4.2/dask/dataframe/categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/core.py` & `dask-2024.4.2/dask/dataframe/core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/dispatch.py` & `dask-2024.4.2/dask/dataframe/dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/extensions.py` & `dask-2024.4.2/dask/dataframe/extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/groupby.py` & `dask-2024.4.2/dask/dataframe/groupby.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/hyperloglog.py` & `dask-2024.4.2/dask/dataframe/hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/indexing.py` & `dask-2024.4.2/dask/dataframe/indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/__init__.py` & `dask-2024.4.2/dask/dataframe/io/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/csv.py` & `dask-2024.4.2/dask/dataframe/io/csv.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/demo.py` & `dask-2024.4.2/dask/dataframe/io/demo.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/hdf.py` & `dask-2024.4.2/dask/dataframe/io/hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/io.py` & `dask-2024.4.2/dask/dataframe/io/io.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/json.py` & `dask-2024.4.2/dask/dataframe/io/json.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/orc/arrow.py` & `dask-2024.4.2/dask/dataframe/io/orc/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/orc/core.py` & `dask-2024.4.2/dask/dataframe/io/orc/core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/parquet/arrow.py` & `dask-2024.4.2/dask/dataframe/io/parquet/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/parquet/core.py` & `dask-2024.4.2/dask/dataframe/io/parquet/core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/parquet/fastparquet.py` & `dask-2024.4.2/dask/dataframe/io/parquet/fastparquet.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/parquet/utils.py` & `dask-2024.4.2/dask/dataframe/io/parquet/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/sql.py` & `dask-2024.4.2/dask/dataframe/io/sql.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_csv.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_csv.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_demo.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_demo.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_hdf.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_io.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_io.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_json.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_json.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_orc.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_orc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_parquet.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_parquet.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/tests/test_sql.py` & `dask-2024.4.2/dask/dataframe/io/tests/test_sql.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/io/utils.py` & `dask-2024.4.2/dask/dataframe/io/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/methods.py` & `dask-2024.4.2/dask/dataframe/methods.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/multi.py` & `dask-2024.4.2/dask/dataframe/multi.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/numeric.py` & `dask-2024.4.2/dask/dataframe/numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/optimize.py` & `dask-2024.4.2/dask/dataframe/optimize.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/partitionquantiles.py` & `dask-2024.4.2/dask/dataframe/partitionquantiles.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/reshape.py` & `dask-2024.4.2/dask/dataframe/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/rolling.py` & `dask-2024.4.2/dask/dataframe/rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/shuffle.py` & `dask-2024.4.2/dask/dataframe/shuffle.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_accessors.py` & `dask-2024.4.2/dask/dataframe/tests/test_accessors.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_arithmetics_reduction.py` & `dask-2024.4.2/dask/dataframe/tests/test_arithmetics_reduction.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_boolean.py` & `dask-2024.4.2/dask/dataframe/tests/test_boolean.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_categorical.py` & `dask-2024.4.2/dask/dataframe/tests/test_categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_dataframe.py` & `dask-2024.4.2/dask/dataframe/tests/test_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_extensions.py` & `dask-2024.4.2/dask/dataframe/tests/test_extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_format.py` & `dask-2024.4.2/dask/dataframe/tests/test_format.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_groupby.py` & `dask-2024.4.2/dask/dataframe/tests/test_groupby.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_hashing.py` & `dask-2024.4.2/dask/dataframe/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_hyperloglog.py` & `dask-2024.4.2/dask/dataframe/tests/test_hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_indexing.py` & `dask-2024.4.2/dask/dataframe/tests/test_indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_merge_column_and_index.py` & `dask-2024.4.2/dask/dataframe/tests/test_merge_column_and_index.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_multi.py` & `dask-2024.4.2/dask/dataframe/tests/test_multi.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_numeric.py` & `dask-2024.4.2/dask/dataframe/tests/test_numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_optimize_dataframe.py` & `dask-2024.4.2/dask/dataframe/tests/test_optimize_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_pyarrow.py` & `dask-2024.4.2/dask/dataframe/tests/test_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_pyarrow_compat.py` & `dask-2024.4.2/dask/dataframe/tests/test_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_reshape.py` & `dask-2024.4.2/dask/dataframe/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_rolling.py` & `dask-2024.4.2/dask/dataframe/tests/test_rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_shuffle.py` & `dask-2024.4.2/dask/dataframe/tests/test_shuffle.py`

 * *Files 0% similar despite different names*

```diff
@@ -723,30 +723,27 @@
     "engine", ["pandas", pytest.param("cudf", marks=pytest.mark.gpu)]
 )
 def test_set_index(engine):
     if engine == "cudf":
         # NOTE: engine == "cudf" requires cudf/dask_cudf,
         # will be skipped by non-GPU CI.
 
-        dask_cudf = pytest.importorskip("dask_cudf")
+        pytest.importorskip("dask_cudf")
 
     dsk = {
         ("x", 0): pd.DataFrame({"a": [1, 2, 3], "b": [4, 2, 6]}, index=[0, 1, 3]),
         ("x", 1): pd.DataFrame({"a": [4, 5, 6], "b": [3, 5, 8]}, index=[5, 6, 8]),
         ("x", 2): pd.DataFrame({"a": [7, 8, 9], "b": [9, 1, 8]}, index=[9, 9, 9]),
     }
 
-    if DASK_EXPR_ENABLED and engine != "cudf":
+    if DASK_EXPR_ENABLED:
         d = dd.repartition(pd.concat(dsk.values()), [0, 4, 9, 9])
     else:
         d = dd.DataFrame(dsk, "x", meta, [0, 4, 9, 9])
 
-    if engine == "cudf":
-        d = dask_cudf.from_dask_dataframe(d)
-
     full = d.compute()
 
     d2 = d.set_index("b", npartitions=3)
     assert d2.npartitions == 3
     assert d2.index.name == "b"
     assert_eq(d2, full.set_index("b"))
```

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_ufunc.py` & `dask-2024.4.2/dask/dataframe/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tests/test_utils_dataframe.py` & `dask-2024.4.2/dask/dataframe/tests/test_utils_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tseries/resample.py` & `dask-2024.4.2/dask/dataframe/tseries/resample.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/tseries/tests/test_resample.py` & `dask-2024.4.2/dask/dataframe/tseries/tests/test_resample.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dataframe/utils.py` & `dask-2024.4.2/dask/dataframe/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/datasets.py` & `dask-2024.4.2/dask/datasets.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/delayed.py` & `dask-2024.4.2/dask/delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/diagnostics/profile.py` & `dask-2024.4.2/dask/diagnostics/profile.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/diagnostics/profile_visualize.py` & `dask-2024.4.2/dask/diagnostics/profile_visualize.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/diagnostics/progress.py` & `dask-2024.4.2/dask/diagnostics/progress.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/diagnostics/tests/test_profiler.py` & `dask-2024.4.2/dask/diagnostics/tests/test_profiler.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/diagnostics/tests/test_progress.py` & `dask-2024.4.2/dask/diagnostics/tests/test_progress.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/distributed.py` & `dask-2024.4.2/dask/distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/dot.py` & `dask-2024.4.2/dask/dot.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/graph_manipulation.py` & `dask-2024.4.2/dask/graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/hashing.py` & `dask-2024.4.2/dask/hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/highlevelgraph.py` & `dask-2024.4.2/dask/highlevelgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/layers.py` & `dask-2024.4.2/dask/layers.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/local.py` & `dask-2024.4.2/dask/local.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/multiprocessing.py` & `dask-2024.4.2/dask/multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/optimization.py` & `dask-2024.4.2/dask/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/order.py` & `dask-2024.4.2/dask/order.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/rewrite.py` & `dask-2024.4.2/dask/rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/sizeof.py` & `dask-2024.4.2/dask/sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/system.py` & `dask-2024.4.2/dask/system.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_backends.py` & `dask-2024.4.2/dask/tests/test_backends.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_base.py` & `dask-2024.4.2/dask/tests/test_base.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_cache.py` & `dask-2024.4.2/dask/tests/test_cache.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_callbacks.py` & `dask-2024.4.2/dask/tests/test_callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_ci.py` & `dask-2024.4.2/dask/tests/test_ci.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_cli.py` & `dask-2024.4.2/dask/tests/test_cli.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_config.py` & `dask-2024.4.2/dask/tests/test_config.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_context.py` & `dask-2024.4.2/dask/tests/test_context.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_core.py` & `dask-2024.4.2/dask/tests/test_core.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_datasets.py` & `dask-2024.4.2/dask/tests/test_datasets.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_delayed.py` & `dask-2024.4.2/dask/tests/test_delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_distributed.py` & `dask-2024.4.2/dask/tests/test_distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_docs.py` & `dask-2024.4.2/dask/tests/test_docs.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_dot.py` & `dask-2024.4.2/dask/tests/test_dot.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_graph_manipulation.py` & `dask-2024.4.2/dask/tests/test_graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_hashing.py` & `dask-2024.4.2/dask/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_highgraph.py` & `dask-2024.4.2/dask/tests/test_highgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_layers.py` & `dask-2024.4.2/dask/tests/test_layers.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_local.py` & `dask-2024.4.2/dask/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_multiprocessing.py` & `dask-2024.4.2/dask/tests/test_multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_optimization.py` & `dask-2024.4.2/dask/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_order.py` & `dask-2024.4.2/dask/tests/test_order.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_rewrite.py` & `dask-2024.4.2/dask/tests/test_rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_sizeof.py` & `dask-2024.4.2/dask/tests/test_sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_spark_compat.py` & `dask-2024.4.2/dask/tests/test_spark_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_system.py` & `dask-2024.4.2/dask/tests/test_system.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_threaded.py` & `dask-2024.4.2/dask/tests/test_threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_tokenize.py` & `dask-2024.4.2/dask/tests/test_tokenize.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_traceback.py` & `dask-2024.4.2/dask/tests/test_traceback.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_typing.py` & `dask-2024.4.2/dask/tests/test_typing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_utils.py` & `dask-2024.4.2/dask/tests/test_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/tests/test_utils_test.py` & `dask-2024.4.2/dask/tests/test_utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/threaded.py` & `dask-2024.4.2/dask/threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/typing.py` & `dask-2024.4.2/dask/typing.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/utils.py` & `dask-2024.4.2/dask/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/utils_test.py` & `dask-2024.4.2/dask/utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/widgets/__init__.py` & `dask-2024.4.2/dask/widgets/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/widgets/templates/array.html.j2` & `dask-2024.4.2/dask/widgets/templates/array.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/widgets/templates/highlevelgraph.html.j2` & `dask-2024.4.2/dask/widgets/templates/highlevelgraph.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/widgets/templates/highlevelgraph_layer.html.j2` & `dask-2024.4.2/dask/widgets/templates/highlevelgraph_layer.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/widgets/tests/test_widgets.py` & `dask-2024.4.2/dask/widgets/tests/test_widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask/widgets/widgets.py` & `dask-2024.4.2/dask/widgets/widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/dask.egg-info/PKG-INFO` & `dask-2024.4.2/dask.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2024.4.1
+Version: 2024.4.2
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD-3-Clause
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
@@ -36,15 +36,15 @@
 Requires-Dist: numpy>=1.21; extra == "array"
 Provides-Extra: bag
 Provides-Extra: dataframe
 Requires-Dist: dask[array]; extra == "dataframe"
 Requires-Dist: pandas>=1.3; extra == "dataframe"
 Requires-Dist: dask-expr<1.1,>=1.0; extra == "dataframe"
 Provides-Extra: distributed
-Requires-Dist: distributed==2024.4.1; extra == "distributed"
+Requires-Dist: distributed==2024.4.2; extra == "distributed"
 Provides-Extra: diagnostics
 Requires-Dist: bokeh>=2.4.2; extra == "diagnostics"
 Requires-Dist: jinja2>=2.10.3; extra == "diagnostics"
 Provides-Extra: delayed
 Provides-Extra: complete
 Requires-Dist: dask[array,dataframe,diagnostics,distributed]; extra == "complete"
 Requires-Dist: pyarrow>=7.0; extra == "complete"
```

### Comparing `dask-2024.4.1/dask.egg-info/SOURCES.txt` & `dask-2024.4.2/dask.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -320,14 +320,15 @@
 docs/source/dataframe-extend.rst
 docs/source/dataframe-extra.rst
 docs/source/dataframe-groupby.rst
 docs/source/dataframe-hive.rst
 docs/source/dataframe-indexing.rst
 docs/source/dataframe-joins.rst
 docs/source/dataframe-legacy-api.rst
+docs/source/dataframe-optimizer.rst
 docs/source/dataframe-parquet.rst
 docs/source/dataframe-sql.rst
 docs/source/dataframe.rst
 docs/source/debugging-performance.rst
 docs/source/delayed-api.rst
 docs/source/delayed-best-practices.rst
 docs/source/delayed-collections.rst
@@ -420,14 +421,15 @@
 docs/source/images/dask_horizontal_on_blue.svg
 docs/source/images/dask_horizontal_on_pink.svg
 docs/source/images/dask_horizontal_white.svg
 docs/source/images/dask_icon.svg
 docs/source/images/dask_icon_black.svg
 docs/source/images/dask_icon_on_pink.svg
 docs/source/images/dask_icon_white.svg
+docs/source/images/dataframe-optimize-explain.png
 docs/source/images/delayed-inc-double-add.svg
 docs/source/images/distributed-overview.svg
 docs/source/images/frame-shuffle.svg
 docs/source/images/frame-sort.svg
 docs/source/images/frame.svg
 docs/source/images/futures-graph.png
 docs/source/images/gputester-msg.png
```

### Comparing `dask-2024.4.1/dask.egg-info/requires.txt` & `dask-2024.4.2/dask.egg-info/requires.txt`

 * *Files 16% similar despite different names*

```diff
@@ -28,15 +28,15 @@
 [delayed]
 
 [diagnostics]
 bokeh>=2.4.2
 jinja2>=2.10.3
 
 [distributed]
-distributed==2024.4.1
+distributed==2024.4.2
 
 [test]
 pandas[test]
 pytest
 pytest-cov
 pytest-rerunfailures
 pytest-timeout
```

### Comparing `dask-2024.4.1/docs/Makefile` & `dask-2024.4.2/docs/Makefile`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/make.bat` & `dask-2024.4.2/docs/make.bat`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/10-minutes-to-dask.rst` & `dask-2024.4.2/docs/source/10-minutes-to-dask.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/config_converter.js` & `dask-2024.4.2/docs/source/_static/config_converter.js`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/dask-simple.png` & `dask-2024.4.2/docs/source/_static/dask-simple.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/main-page.css` & `dask-2024.4.2/docs/source/_static/main-page.css`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/profile.html` & `dask-2024.4.2/docs/source/_static/profile.html`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/stacked_profile.html` & `dask-2024.4.2/docs/source/_static/stacked_profile.html`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/style.css` & `dask-2024.4.2/docs/source/_static/style.css`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/transpose_cyto.html` & `dask-2024.4.2/docs/source/_static/transpose_cyto.html`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/_static/yaml.min.js` & `dask-2024.4.2/docs/source/_static/yaml.min.js`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/adaptive.rst` & `dask-2024.4.2/docs/source/adaptive.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/api.rst` & `dask-2024.4.2/docs/source/api.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-api.rst` & `dask-2024.4.2/docs/source/array-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-assignment.rst` & `dask-2024.4.2/docs/source/array-assignment.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-best-practices.rst` & `dask-2024.4.2/docs/source/array-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-chunks.rst` & `dask-2024.4.2/docs/source/array-chunks.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-creation.rst` & `dask-2024.4.2/docs/source/array-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-design.rst` & `dask-2024.4.2/docs/source/array-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-gufunc.rst` & `dask-2024.4.2/docs/source/array-gufunc.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-numpy-compatibility.rst` & `dask-2024.4.2/docs/source/array-numpy-compatibility.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-overlap.rst` & `dask-2024.4.2/docs/source/array-overlap.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-random.rst` & `dask-2024.4.2/docs/source/array-random.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-slicing.rst` & `dask-2024.4.2/docs/source/array-slicing.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-sparse.rst` & `dask-2024.4.2/docs/source/array-sparse.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-stack.rst` & `dask-2024.4.2/docs/source/array-stack.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array-stats.rst` & `dask-2024.4.2/docs/source/array-stats.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/array.rst` & `dask-2024.4.2/docs/source/array.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/bag-api.rst` & `dask-2024.4.2/docs/source/bag-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/bag-creation.rst` & `dask-2024.4.2/docs/source/bag-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/bag.rst` & `dask-2024.4.2/docs/source/bag.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/best-practices.rst` & `dask-2024.4.2/docs/source/best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/caching.rst` & `dask-2024.4.2/docs/source/caching.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/changelog.rst` & `dask-2024.4.2/docs/source/changelog.rst`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,82 @@
 Changelog
 =========
 
+.. _v2024.4.2:
+
+2024.4.2
+--------
+
+Highlights
+^^^^^^^^^^
+
+Trivial Merge Implementation
+""""""""""""""""""""""""""""
+
+The Query Optimizer will inspect quires to determine if a ``merge(...)`` or
+``groupby(...).apply(...)`` requires a shuffle. A shuffle can be avoided, if the
+DataFrame was shuffled on the same columns in a previous step without any operations
+in between that change the partitioning layout or the relevant values in each
+partition.
+
+.. code-block:: python
+
+    >>> result = df.merge(df2, on="a")
+    >>> result = result.merge(df3, on="a")
+
+The Query optimizer will identify that ``result`` was previously shuffled on ``"a"`` as
+well and thus only shuffle ``df3`` in the second merge operation before doing a blockwise
+merge.
+
+Auto-partitioning in ``read_parquet``
+"""""""""""""""""""""""""""""""""""""
+
+The Query Optimizer will automatically repartition datasets read from Parquet files
+if individual partitions are too small. This will reduce the number of partitions in
+consequentially also the size of the task graph.
+
+The Optimizer aims to produce partitions of at least 75MB and will combine multiple files
+together if necessary to reach this threshold. The value can be configured by using
+
+.. code-block:: python
+
+    >>> dask.config.set({"dataframe.parquet.minimum-partition-size": 100_000_000})
+
+The value is given in bytes. The default threshold is relatively conservative to avoid
+memory issues on worker nodes with a relatively small amount of memory per thread.
+
+.. dropdown:: Additional changes
+
+  - Add GitHub Releases automation (:pr:`11057`) `Jacob Tomlinson`_
+  - Add changelog entries for new release (:pr:`11058`) `Patrick Hoefler`_
+  - Reinstate try/except block in ``_bind_property`` (:pr:`11049`) `Lawrence Mitchell`_
+  - Fix link for query planning docs (:pr:`11054`) `Patrick Hoefler`_
+  - Add config parameter for parquet file size (:pr:`11052`) `Patrick Hoefler`_
+  - Update ``percentile`` docstring (:pr:`11053`) `Abel Aoun`_
+  - Add docs for query optimizer (:pr:`11043`) `Patrick Hoefler`_
+  - Assignment of np.ma.masked to obect-type Array (:pr:`9627`) `David Hassell`_
+  - Don't error if ``dask_expr`` is not installed (:pr:`11048`) `Simon Høxbro Hansen`_
+  - Adjust ``test_set_index`` for "cudf" backend (:pr:`11029`) `Richard (Rick) Zamora`_
+  - Use ``to/from_legacy_dataframe`` instead of ``to/from_dask_dataframe`` (:pr:`11025`) `Richard (Rick) Zamora`_
+  - Tokenize bag ``groupby`` keys (:pr:`10734`) `Charles Stern`_
+  - Add lazy "cudf" registration for p2p-related dispatch functions (:pr:`11040`) `Richard (Rick) Zamora`_
+
+  - Collect ``memray`` profiles on exception (:pr-distributed:`8625`) `Florian Jetter`_
+  - Ensure ``inproc`` properly emulates serialization protocol (:pr-distributed:`8622`) `Florian Jetter`_
+  - Relax test stats profiling2 (:pr-distributed:`8621`) `Florian Jetter`_
+  - Restart workers when ``worker-ttl`` expires (:pr-distributed:`8538`) `crusaderky`_
+  - Use ``monotonic`` for deadline test (:pr-distributed:`8620`) `Florian Jetter`_
+  - Fix race condition for published futures with annotations (:pr-distributed:`8577`) `Florian Jetter`_
+  - Scatter by worker instead of ``worker`` -> ``nthreads`` (:pr-distributed:`8590`) `Miles`_
+  - Send log-event if worker is restarted because of memory pressure (:pr-distributed:`8617`) `Patrick Hoefler`_
+  - Do not print xfailed tests in CI (:pr-distributed:`8619`) `Florian Jetter`_
+  - ensure workers are not downscaled when participating in p2p (:pr-distributed:`8610`) `Florian Jetter`_
+  - Run against stable ``fsspec`` (:pr-distributed:`8615`) `Florian Jetter`_
+
+
 .. _v2024.4.1:
 
 2024.4.1
 --------
 
 This is a minor bugfix release that that fixes an error when importing
 ``dask.dataframe`` with Python 3.11.9.
@@ -297,15 +369,15 @@
 .. code-block:: python
 
     >>> import dask
     >>> dask.config.set({'dataframe.query-planning': True})
     >>> import dask.dataframe as dd
 
 API documentation for the new implementation is available at
-https://docs.dask.org/en/stable/dask-expr-api.html
+https://docs.dask.org/en/stable/dataframe-api.html
 
 Any feedback can be reported on the Dask issue tracker
 https://github.com/dask/dask/issues
 
 See :pr:`10912` from `Patrick Hoefler`_ for details.
 
 Improved tokenization
@@ -8041,7 +8113,9 @@
 .. _`Charles Stern`: https://github.com/cisaacstern
 .. _`templiert`: https://github.com/templiert
 .. _`Lindsey Gray`: https://github.com/lgray
 .. _`wim glenn`: https://github.com/wimglenn
 .. _`Dimitri Papadopoulos Orfanos`: https://github.com/DimitriPapadopoulos
 .. _`Quentin Lhoest`: https://github.com/lhoestq
 .. _`Jonas Lähnemann`: https://github.com/jlaehne
+.. _`Abel Aoun`: https://github.com/bzah
+.. _`Simon Høxbro Hansen`: https://github.com/Hoxbro
```

### Comparing `dask-2024.4.1/docs/source/cli.rst` & `dask-2024.4.2/docs/source/cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/conf.py` & `dask-2024.4.2/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/configuration.rst` & `dask-2024.4.2/docs/source/configuration.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/custom-collections.rst` & `dask-2024.4.2/docs/source/custom-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/custom-graphs.rst` & `dask-2024.4.2/docs/source/custom-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/customize-initialization.rst` & `dask-2024.4.2/docs/source/customize-initialization.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dashboard-progress-script.py` & `dask-2024.4.2/docs/source/dashboard-progress-script.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dashboard.rst` & `dask-2024.4.2/docs/source/dashboard.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/daskcheatsheet.pdf` & `dask-2024.4.2/docs/source/daskcheatsheet.pdf`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dataframe-api.rst` & `dask-2024.4.2/docs/source/dataframe-api.rst`

 * *Files 11% similar despite different names*

```diff
@@ -126,14 +126,15 @@
     DataFrame.to_csv
     DataFrame.to_dask_array
     DataFrame.to_dask_dataframe
     DataFrame.to_delayed
     DataFrame.to_hdf
     DataFrame.to_html
     DataFrame.to_json
+    DataFrame.to_legacy_dataframe
     DataFrame.to_parquet
     DataFrame.to_records
     DataFrame.to_string
     DataFrame.to_sql
     DataFrame.to_timestamp
     DataFrame.truediv
     DataFrame.values
@@ -522,14 +523,26 @@
 .. autosummary::
    :toctree: generated/
 
    DataFrame.to_bag
    DataFrame.to_dask_array
    DataFrame.to_delayed
 
+
+Convert from/to legacy DataFrames
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+.. currentmodule:: dask_expr._collection
+
+.. autosummary::
+   :toctree: generated/
+
+   DataFrame.to_legacy_dataframe
+   from_legacy_dataframe
+
 Reshape DataFrames
 ~~~~~~~~~~~~~~~~~~
 
 .. currentmodule:: dask_expr
 
 .. autosummary::
    :toctree: generated/
@@ -585,14 +598,27 @@
 .. currentmodule:: dask.dataframe.utils
 
 .. autosummary::
    :toctree: generated/
 
    make_meta
 
+
+Query Planning and Optimization
+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+
+.. currentmodule:: dask_expr._collection
+
+.. autosummary::
+   :toctree: generated/
+
+   DataFrame.explain
+   DataFrame.visualize
+   DataFrame.analyze
+
 Other functions
 ~~~~~~~~~~~~~~~
 
 .. currentmodule:: dask_expr._collection
 
 .. autosummary::
    :toctree: generated/
```

### Comparing `dask-2024.4.1/docs/source/dataframe-best-practices.rst` & `dask-2024.4.2/docs/source/dataframe-best-practices.rst`

 * *Files 4% similar despite different names*

```diff
@@ -71,17 +71,15 @@
 parallel or distributed setting than if they are in-memory on a single machine.
 In particular, *shuffling operations* that rearrange data become much more
 communication intensive.  For example, if your data is arranged by customer ID
 but now you want to arrange it by time, all of your partitions will have to talk
 to each other to exchange shards of data.  This can be an intensive process,
 particularly on a cluster.
 
-So, definitely set the index but try do so infrequently.  After you set the
-index, you may want to ``persist`` your data if you are on a cluster
-(see `Persist Intelligently`_):
+So, definitely set the index but try do so infrequently.
 
 .. code-block:: python
 
    df = df.set_index('column_name')  # do this infrequently
 
 Additionally, ``set_index`` has a few options that can accelerate it in some
 situations.  For example, if you know that your dataset is sorted or you already
@@ -95,14 +93,21 @@
 
 
 Persist Intelligently
 ---------------------
 
 .. note:: This section is only relevant to users on distributed systems.
 
+.. warning::
+
+    persist has a number of drawbacks with the query optimizer. It will block all
+    optimizations and prevent us from pushing column projections or filters into
+    the IO layer. Use persist sparingly only when absolutely necessary or you need
+    the full dataset afterwards.
+
 Often DataFrame workloads look like the following:
 
 1.  Load data from files
 2.  Filter data to a particular subset
 3.  Shuffle data to set an intelligent index
 4.  Several complex queries on top of this indexed data
 
@@ -179,20 +184,14 @@
 
    df = df.persist()  # if on a distributed system
 
 This helps to reduce overhead and increase the effectiveness of vectorized
 Pandas operations.  You should aim for partitions that have around 100MB of
 data each.
 
-Additionally, reducing partitions is very helpful just before shuffling, which
-creates ``n log(n)`` tasks relative to the number of partitions.  DataFrames
-with less than 100 partitions are much easier to shuffle than DataFrames with
-tens of thousands.
-
-
 Joins
 -----
 
 Joining two DataFrames can be either very expensive or very cheap depending on
 the situation.  It is cheap in the following cases:
 
 1.  Joining a Dask DataFrame with a pandas DataFrame
```

### Comparing `dask-2024.4.1/docs/source/dataframe-categoricals.rst` & `dask-2024.4.2/docs/source/dataframe-categoricals.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dataframe-create.rst` & `dask-2024.4.2/docs/source/dataframe-create.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dataframe-design.rst` & `dask-2024.4.2/docs/source/dataframe-design.rst`

 * *Files 24% similar despite different names*

```diff
@@ -58,18 +58,18 @@
 
 .. code-block:: python
 
   >>> ddf.map_partitions(foo, meta=pd.DataFrame({'a': [1], 'b': [2]}))
 
 2. A description of the appropriate names and dtypes.  This can take several forms:
 
-    * A ``dict`` of ``{name: dtype}`` or an iterable of ``(name, dtype)``
-      specifies a DataFrame. Note that order is important: the order of the
-      names in ``meta`` should match the order of the columns
-    * A tuple of ``(name, dtype)`` specifies a series
+* A ``dict`` of ``{name: dtype}`` or an iterable of ``(name, dtype)``
+  specifies a DataFrame. Note that order is important: the order of the
+  names in ``meta`` should match the order of the columns
+* A tuple of ``(name, dtype)`` specifies a series
 
 This keyword is available on all functions/methods that take user provided
 callables (e.g. ``DataFrame.map_partitions``, ``DataFrame.apply``, etc...), as
 well as many creation functions (e.g. ``dd.from_delayed``).
 
 
 .. _dataframe-design-partitions:
@@ -93,14 +93,18 @@
 .. code-block:: python
 
    >>> df.npartitions
    4
    >>> df.divisions
    ['2015-01-01', '2015-02-01', '2015-03-01', '2015-04-01', '2015-04-31']
 
+The number of partitions and the division values might change during optimization.
+The optimizer will try to create partitions with a sensible size to avoid straining
+the scheduler with many small partitions.
+
 Divisions includes the minimum value of every partition's index and the maximum
 value of the last partition's index.  In the example above, if the user searches
 for a specific datetime range, then we know which partitions we need to inspect
 and which we can drop:
 
 .. code-block:: python
 
@@ -121,19 +125,32 @@
 
 
 .. _dataframe-design-groupby:
 
 Groupby
 -------
 
-By default, groupby methods return an object with only 1 partition. This is to
-optimize performance, and assumes the groupby reduction returns an object that
-is small enough to fit into memory. If your returned object is larger than this,
-you can increase the number of output partitions using the `split_out` argument.
+By default, groupby will choose the number of output partitions based on a few
+different factors. It will look at the number of grouping keys to guess the
+cardinality of your data. It will use this information to calculate a factor
+based on the number of input partitions. You can override this behavior by
+specifying the number of output partitions using the `split_out` argument.
 
 .. code-block:: python
 
    result = df.groupby('id').value.mean()
    result.npartitions  # returns 1
 
+   result = df.groupby(['id', 'id2']).value.mean()
+   result.npartitions  # returns 5
+
    result = df.groupby('id').value.mean(split_out=8)
    result.npartitions  # returns 8
+
+Some groupby aggregation functions have a different `split_out` default value.
+`split_out=True` will keep the number of partitions constant, which is useful
+for operations that either don't reduce the number of rows very much.
+
+.. code-block:: python
+
+   result = df.groupby('id').value.nunique()
+   result.npartitions  # returns same as df.npartitions
```

### Comparing `dask-2024.4.1/docs/source/dataframe-extend.rst` & `dask-2024.4.2/docs/source/dataframe-extend.rst`

 * *Files 13% similar despite different names*

```diff
@@ -25,15 +25,15 @@
 
 
 Extend Dispatched Methods
 ^^^^^^^^^^^^^^^^^^^^^^^^^
 
 If you are going to pass around Pandas-like objects that are not normal Pandas
 objects, then we ask you to extend a few dispatched methods: ``make_meta``,
-``get_parallel_type``, and ``concat``.
+``get_collection_type``, and ``concat``.
 
 make_meta
 """""""""
 
 This function returns an empty version of one of your non-Dask objects, given a
 non-empty non-Dask object:
 
@@ -96,35 +96,35 @@
 
 
    @meta_nonempty.register(MyIndex)
    def meta_nonempty_index(ind):
        ...
 
 
-get_parallel_type
-"""""""""""""""""
+get_collection_type
+"""""""""""""""""""
 
 Given a non-Dask DataFrame object, return the Dask equivalent:
 
 .. code-block:: python
 
-   from dask.dataframe.core import get_parallel_type
+   from dask.dataframe import get_collection_type
 
-   @get_parallel_type.register(MyDataFrame)
-   def get_parallel_type_dataframe(df):
+   @get_collection_type.register(MyDataFrame)
+   def get_collection_type_dataframe(df):
        return MyDaskDataFrame
 
 
-   @get_parallel_type.register(MySeries)
-   def get_parallel_type_series(s):
+   @get_collection_type.register(MySeries)
+   def get_collection_type_series(s):
        return MyDaskSeries
 
 
-   @get_parallel_type.register(MyIndex)
-   def get_parallel_type_index(ind):
+   @get_collection_type.register(MyIndex)
+   def get_collection_type_index(ind):
        return MyDaskIndex
 
 
 concat
 """"""
 
 Concatenate many of your non-Dask DataFrame objects together.  It should expect
```

### Comparing `dask-2024.4.1/docs/source/dataframe-groupby.rst` & `dask-2024.4.2/docs/source/dataframe-groupby.rst`

 * *Files 2% similar despite different names*

```diff
@@ -110,22 +110,22 @@
 
 .. code-block:: python
 
     with dask.config.set({"dataframe.shuffle.method": "p2p"}):
         ddf.groupby(...).apply(...)
 
 
-In addition, ``set_index`` also accepts a ``shuffle`` keyword argument that
+In addition, ``set_index`` also accepts a ``shuffle_method`` keyword argument that
 can be used to select either on-disk or task-based shuffling:
 
 .. code-block:: python
 
-    ddf.set_index(column, shuffle='disk')
-    ddf.set_index(column, shuffle='tasks')
-    ddf.set_index(column, shuffle='p2p')
+    ddf.set_index(column, shuffle_method='disk')
+    ddf.set_index(column, shuffle_method='tasks')
+    ddf.set_index(column, shuffle_method='p2p')
 
 
 .. _dataframe.groupby.aggregate:
 
 Aggregate
 =========
```

### Comparing `dask-2024.4.1/docs/source/dataframe-hive.rst` & `dask-2024.4.2/docs/source/dataframe-hive.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dataframe-indexing.rst` & `dask-2024.4.2/docs/source/dataframe-indexing.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dataframe-joins.rst` & `dask-2024.4.2/docs/source/dataframe-joins.rst`

 * *Files 6% similar despite different names*

```diff
@@ -71,18 +71,14 @@
     # timestamp, we don't need to set_index.
 
     # left.set_index("timestamp")
 
     left.to_parquet("left", overwrite=True)
     left = dd.read_parquet("left")
 
-    # If the dataframe can fit in RAM, you can also use persist
-
-    # left = left.persist()
-
     right_one = dask.datasets.timeseries(dtypes={"bar": int})
     right_two = dask.datasets.timeseries(dtypes={"baz": int})
 
     result = left.merge(
         right_one, how="left", left_index=True, right_index=True)
     result = result.merge(
         right_two, how="left", left_index=True, right_index=True)
```

### Comparing `dask-2024.4.1/docs/source/dataframe-legacy-api.rst` & `dask-2024.4.2/docs/source/dataframe-legacy-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/dataframe-parquet.rst` & `dask-2024.4.2/docs/source/dataframe-parquet.rst`

 * *Files 0% similar despite different names*

```diff
@@ -103,15 +103,15 @@
 
 For best performance, use files that can be individually mapped to good
 dataframe partition sizes, and set ``blocksize`` accordingly. If individual
 files need to be divided into multiple row-group ranges, and the dataset
 does not contain a ``_metadata`` file, Dask will need to load all footer
 metadata up-front.
 
-We recommend aiming for 10-250 MiB in-memory size per file once loaded into
+We recommend aiming for 100-300 MiB in-memory size per file once loaded into
 pandas. Oversized partitions can lead to excessive memory usage on a single
 worker, while undersized partitions can lead to poor performance as the
 overhead of Dask dominates.
 
 If you know your parquet dataset comprises oversized files, you can pass
 ``split_row_groups='adaptive'`` to ensure that Dask will attempt to keep
 each partition under the ``blocksize`` limit. Note that partitions may
@@ -200,15 +200,15 @@
    ... )
 
 For more information on connecting to remote data, see
 :doc:`how-to/connect-to-remote-data`.
 
 Dask will write one file per Dask dataframe partition to this directory. To
 optimize access for downstream consumers, we recommend aiming for an in-memory
-size of 10-250 MiB per partition. This helps balance worker memory usage
+size of 100-300 MiB per partition. This helps balance worker memory usage
 against Dask overhead. You may find the
 :meth:`DataFrame.memory_usage_per_partition` method useful for determining if
 your data is partitioned optimally.
 
 :func:`to_parquet` has many configuration options affecting both behavior and
 performance. Here we highlight a few common options.
```

### Comparing `dask-2024.4.1/docs/source/dataframe-sql.rst` & `dask-2024.4.2/docs/source/dataframe-sql.rst`

 * *Files 1% similar despite different names*

```diff
@@ -29,22 +29,17 @@
 
 - `dask-sql`_ adds a SQL query engine on top of Dask.
   In addition to working on CPU, it offers experimental support for CUDA-enabled GPUs through RAPIDS libraries such as `cuDF`_.
 
 - `FugueSQL`_ provides a unified interface to run SQL code on a variety of different computing frameworks.
   Specifying ``DaskExecutionEngine`` or ``DaskSQLExecutionEngine`` as the execution engine for queries allows them to be computed using Dask or dask-sql, respectively.
 
-- `pandasql`_ allows executing SQL queries on a pandas table by writing the data to
-  ``SQLite``, which may be useful for small toy examples (this package has not been
-  maintained for some time).
-
 .. _dask-sql: https://dask-sql.readthedocs.io/en/latest/
 .. _cuDF: https://docs.rapids.ai/api/cudf/stable/
 .. _FugueSQL: https://fugue-tutorials.readthedocs.io/en/latest/tutorials/fugue_sql/index.html
-.. _pandasql: https://github.com/yhat/pandasql/
 
 Database or Dask?
 -----------------
 
 A database server is able to process tabular data and produce results just like
 Dask Dataframe. Why would you choose to use one over the other?
```

### Comparing `dask-2024.4.1/docs/source/dataframe.rst` & `dask-2024.4.2/docs/source/dataframe.rst`

 * *Files 1% similar despite different names*

```diff
@@ -6,14 +6,15 @@
 
 .. toctree::
    :maxdepth: 1
    :hidden:
 
    Load and Save Data <dataframe-create.rst>
    Internal Design <dataframe-design.rst>
+   Optimizer <dataframe-optimizer.rst>
    Best Practices <dataframe-best-practices.rst>
    API <dataframe-api.rst>
    dataframe-extra.rst
 
 .. grid:: 1 1 2 2
 
    .. grid-item::
```

### Comparing `dask-2024.4.1/docs/source/delayed-api.rst` & `dask-2024.4.2/docs/source/delayed-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/delayed-best-practices.rst` & `dask-2024.4.2/docs/source/delayed-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/delayed-collections.rst` & `dask-2024.4.2/docs/source/delayed-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/delayed.rst` & `dask-2024.4.2/docs/source/delayed.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-cli.rst` & `dask-2024.4.2/docs/source/deploying-cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-cloud.rst` & `dask-2024.4.2/docs/source/deploying-cloud.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-docker.rst` & `dask-2024.4.2/docs/source/deploying-docker.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-hpc.rst` & `dask-2024.4.2/docs/source/deploying-hpc.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-kubernetes.rst` & `dask-2024.4.2/docs/source/deploying-kubernetes.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-python-advanced.rst` & `dask-2024.4.2/docs/source/deploying-python-advanced.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-python.rst` & `dask-2024.4.2/docs/source/deploying-python.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying-ssh.rst` & `dask-2024.4.2/docs/source/deploying-ssh.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deploying.rst` & `dask-2024.4.2/docs/source/deploying.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/deployment-considerations.rst` & `dask-2024.4.2/docs/source/deployment-considerations.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/develop.rst` & `dask-2024.4.2/docs/source/develop.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/diagnostics-distributed.rst` & `dask-2024.4.2/docs/source/diagnostics-distributed.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/diagnostics-local.rst` & `dask-2024.4.2/docs/source/diagnostics-local.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/ecosystem.rst` & `dask-2024.4.2/docs/source/ecosystem.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/faq.rst` & `dask-2024.4.2/docs/source/faq.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/futures.rst` & `dask-2024.4.2/docs/source/futures.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/gpu.rst` & `dask-2024.4.2/docs/source/gpu.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/graph_manipulation.rst` & `dask-2024.4.2/docs/source/graph_manipulation.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/graphs.rst` & `dask-2024.4.2/docs/source/graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/graphviz.rst` & `dask-2024.4.2/docs/source/graphviz.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/high-level-graphs.rst` & `dask-2024.4.2/docs/source/high-level-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/how-to/connect-to-remote-data.rst` & `dask-2024.4.2/docs/source/how-to/connect-to-remote-data.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/how-to/debug.rst` & `dask-2024.4.2/docs/source/how-to/debug.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/how-to/extend-sizeof.rst` & `dask-2024.4.2/docs/source/how-to/extend-sizeof.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/how-to/selecting-the-collection-backend.rst` & `dask-2024.4.2/docs/source/how-to/selecting-the-collection-backend.rst`

 * *Files 0% similar despite different names*

```diff
@@ -129,15 +129,15 @@
    - percentile_lookup
    - tensordot_lookup
 
 Dask-Dataframe compute-based dispatch functions (as defined in ``dask.dataframe.dispatch``, and defined for Pandas in ``dask.dataframe.backends``):
 
    - categorical_dtype_dispatch
    - concat_dispatch
-   - get_parallel_type
+   - get_collection_type
    - group_split_dispatch
    - grouper_dispatch
    - hash_object_dispatch
    - is_categorical_dtype_dispatch
    - make_meta_dispatch
    - make_meta_obj
    - meta_lib_from_array
```

### Comparing `dask-2024.4.1/docs/source/images/10_minutes_array_graph.png` & `dask-2024.4.2/docs/source/images/10_minutes_array_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/10_minutes_bag_graph.png` & `dask-2024.4.2/docs/source/images/10_minutes_bag_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/10_minutes_dataframe_graph.png` & `dask-2024.4.2/docs/source/images/10_minutes_dataframe_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/HHMI_Janelia_Color.png` & `dask-2024.4.2/docs/source/images/HHMI_Janelia_Color.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/array.svg` & `dask-2024.4.2/docs/source/images/array.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/async-embarrassing.gif` & `dask-2024.4.2/docs/source/images/async-embarrassing.gif`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/changelog/2023110-rechunking-disk-perf.png` & `dask-2024.4.2/docs/source/images/changelog/2023110-rechunking-disk-perf.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/cloud-provider-logos.svg` & `dask-2024.4.2/docs/source/images/cloud-provider-logos.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/concurrent-futures-threaded.webp` & `dask-2024.4.2/docs/source/images/concurrent-futures-threaded.webp`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/crosstalk.svg` & `dask-2024.4.2/docs/source/images/crosstalk.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_jupyterlab.png` & `dask-2024.4.2/docs/source/images/dashboard_jupyterlab.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_link.png` & `dask-2024.4.2/docs/source/images/dashboard_link.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_memory.png` & `dask-2024.4.2/docs/source/images/dashboard_memory.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_memory_new.gif` & `dask-2024.4.2/docs/source/images/dashboard_memory_new.gif`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_progress.png` & `dask-2024.4.2/docs/source/images/dashboard_progress.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_status.png` & `dask-2024.4.2/docs/source/images/dashboard_status.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_task_processing.png` & `dask-2024.4.2/docs/source/images/dashboard_task_processing.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_task_stream_unhealthy.png` & `dask-2024.4.2/docs/source/images/dashboard_task_stream_unhealthy.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dashboard_taskstream_healthy.png` & `dask-2024.4.2/docs/source/images/dashboard_taskstream_healthy.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-adaptive.svg` & `dask-2024.4.2/docs/source/images/dask-adaptive.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-array.svg` & `dask-2024.4.2/docs/source/images/dask-array.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-cluster-manager.svg` & `dask-2024.4.2/docs/source/images/dask-cluster-manager.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-dataframe.svg` & `dask-2024.4.2/docs/source/images/dask-dataframe.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-overview-distributed-callout.svg` & `dask-2024.4.2/docs/source/images/dask-overview-distributed-callout.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-overview-schedulers.svg` & `dask-2024.4.2/docs/source/images/dask-overview-schedulers.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask-overview.svg` & `dask-2024.4.2/docs/source/images/dask-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_horizontal.svg` & `dask-2024.4.2/docs/source/images/dask_horizontal.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_horizontal_black.svg` & `dask-2024.4.2/docs/source/images/dask_horizontal_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_horizontal_on_blue.svg` & `dask-2024.4.2/docs/source/images/dask_horizontal_on_blue.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_horizontal_on_pink.svg` & `dask-2024.4.2/docs/source/images/dask_horizontal_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_horizontal_white.svg` & `dask-2024.4.2/docs/source/images/dask_horizontal_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_icon.svg` & `dask-2024.4.2/docs/source/images/dask_icon.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_icon_black.svg` & `dask-2024.4.2/docs/source/images/dask_icon_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_icon_on_pink.svg` & `dask-2024.4.2/docs/source/images/dask_icon_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/dask_icon_white.svg` & `dask-2024.4.2/docs/source/images/dask_icon_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/delayed-inc-double-add.svg` & `dask-2024.4.2/docs/source/images/delayed-inc-double-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/distributed-overview.svg` & `dask-2024.4.2/docs/source/images/distributed-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/frame-shuffle.svg` & `dask-2024.4.2/docs/source/images/frame-shuffle.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/frame-sort.svg` & `dask-2024.4.2/docs/source/images/frame-sort.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/frame.svg` & `dask-2024.4.2/docs/source/images/frame.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/futures-graph.png` & `dask-2024.4.2/docs/source/images/futures-graph.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/gputester-msg.png` & `dask-2024.4.2/docs/source/images/gputester-msg.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/growth_of_languages.png` & `dask-2024.4.2/docs/source/images/growth_of_languages.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/growth_of_libraries.png` & `dask-2024.4.2/docs/source/images/growth_of_libraries.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/inc-add.svg` & `dask-2024.4.2/docs/source/images/inc-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/map-reduce-task-scheduling.svg` & `dask-2024.4.2/docs/source/images/map-reduce-task-scheduling.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/map_blocks_drop_axis.png` & `dask-2024.4.2/docs/source/images/map_blocks_drop_axis.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/merge_chunks.png` & `dask-2024.4.2/docs/source/images/merge_chunks.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/merge_chunks_false.png` & `dask-2024.4.2/docs/source/images/merge_chunks_false.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/optimize_dask1.svg` & `dask-2024.4.2/docs/source/images/optimize_dask1.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/optimize_dask2.svg` & `dask-2024.4.2/docs/source/images/optimize_dask2.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/optimize_dask3.svg` & `dask-2024.4.2/docs/source/images/optimize_dask3.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/optimize_dask4.svg` & `dask-2024.4.2/docs/source/images/optimize_dask4.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/optimize_dask5.svg` & `dask-2024.4.2/docs/source/images/optimize_dask5.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/order-failure.png` & `dask-2024.4.2/docs/source/images/order-failure.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/order-success.png` & `dask-2024.4.2/docs/source/images/order-success.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/overlap.svg` & `dask-2024.4.2/docs/source/images/overlap.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/overlapping-blocks.svg` & `dask-2024.4.2/docs/source/images/overlapping-blocks.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/overlapping-neighbors.svg` & `dask-2024.4.2/docs/source/images/overlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/pipeline.svg` & `dask-2024.4.2/docs/source/images/pipeline.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/reshape.png` & `dask-2024.4.2/docs/source/images/reshape.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/reshape_problem.png` & `dask-2024.4.2/docs/source/images/reshape_problem.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/reshape_rechunked.png` & `dask-2024.4.2/docs/source/images/reshape_rechunked.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/scaling-edges.png` & `dask-2024.4.2/docs/source/images/scaling-edges.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/scaling-nodes.png` & `dask-2024.4.2/docs/source/images/scaling-nodes.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/simple-dask.png` & `dask-2024.4.2/docs/source/images/simple-dask.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/transpose-hlg-hovertooltip.png` & `dask-2024.4.2/docs/source/images/transpose-hlg-hovertooltip.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/transpose-hlg-html-repr.png` & `dask-2024.4.2/docs/source/images/transpose-hlg-html-repr.png`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/transpose.svg` & `dask-2024.4.2/docs/source/images/transpose.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/transpose_opt.svg` & `dask-2024.4.2/docs/source/images/transpose_opt.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/trivial.svg` & `dask-2024.4.2/docs/source/images/trivial.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/images/unoverlapping-neighbors.svg` & `dask-2024.4.2/docs/source/images/unoverlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/index.rst` & `dask-2024.4.2/docs/source/index.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/install.rst` & `dask-2024.4.2/docs/source/install.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/logos.rst` & `dask-2024.4.2/docs/source/logos.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/maintainers.rst` & `dask-2024.4.2/docs/source/maintainers.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/optimize.rst` & `dask-2024.4.2/docs/source/optimize.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/order.rst` & `dask-2024.4.2/docs/source/order.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/phases-of-computation.rst` & `dask-2024.4.2/docs/source/phases-of-computation.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/presentations.rst` & `dask-2024.4.2/docs/source/presentations.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/prometheus.rst` & `dask-2024.4.2/docs/source/prometheus.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/scheduler-overview.rst` & `dask-2024.4.2/docs/source/scheduler-overview.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/scheduling-policy.rst` & `dask-2024.4.2/docs/source/scheduling-policy.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/scheduling.rst` & `dask-2024.4.2/docs/source/scheduling.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/scripts/scheduling.py` & `dask-2024.4.2/docs/source/scripts/scheduling.py`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/shared.rst` & `dask-2024.4.2/docs/source/shared.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/software-environments.rst` & `dask-2024.4.2/docs/source/software-environments.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/spark.rst` & `dask-2024.4.2/docs/source/spark.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/spec.rst` & `dask-2024.4.2/docs/source/spec.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/support.rst` & `dask-2024.4.2/docs/source/support.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/understanding-performance.rst` & `dask-2024.4.2/docs/source/understanding-performance.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/user-interfaces.rst` & `dask-2024.4.2/docs/source/user-interfaces.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/docs/source/why.rst` & `dask-2024.4.2/docs/source/why.rst`

 * *Files identical despite different names*

### Comparing `dask-2024.4.1/pyproject.toml` & `dask-2024.4.2/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -53,15 +53,15 @@
 dataframe = [
     "dask[array]",
     # NOTE: dask-expr is pinning pandas>2. To use pandas<2, please install dask
     # without using the dataframe extra
     "pandas >= 1.3",
     "dask-expr >= 1.0, <1.1",  # dask-expr pins the dask version
 ]
-distributed = ["distributed == 2024.4.1"]
+distributed = ["distributed == 2024.4.2"]
 diagnostics = [
     "bokeh >= 2.4.2",
     "jinja2 >= 2.10.3",
 ]
 # keeping for backwards compatibility
 delayed = []
 complete = [
```

