# Comparing `tmp/dask-expr-1.0.9.tar.gz` & `tmp/dask_expr-1.1.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-expr-1.0.9.tar", last modified: Tue Apr  2 18:01:21 2024, max compression
+gzip compressed data, was "dask_expr-1.1.0.tar", last modified: Fri May  3 21:18:55 2024, max compression
```

## Comparing `dask-expr-1.0.9.tar` & `dask_expr-1.1.0.tar`

### file list

```diff
@@ -1,62 +1,59 @@
-drwxr-xr-x   0 patrick    (502) staff       (20)        0 2024-04-02 18:01:21.384607 dask-expr-1.0.9/
--rw-r--r--   0 patrick    (502) staff       (20)     1516 2023-08-02 08:54:32.000000 dask-expr-1.0.9/LICENSE.txt
--rw-r--r--   0 patrick    (502) staff       (20)     2426 2024-04-02 18:01:21.384549 dask-expr-1.0.9/PKG-INFO
--rw-r--r--   0 patrick    (502) staff       (20)     1358 2024-03-14 18:38:28.000000 dask-expr-1.0.9/README.md
-drwxr-xr-x   0 patrick    (502) staff       (20)        0 2024-04-02 18:01:21.385131 dask-expr-1.0.9/dask_expr/
--rw-r--r--   0 patrick    (502) staff       (20)      714 2024-03-15 18:34:20.000000 dask-expr-1.0.9/dask_expr/__init__.py
--rw-r--r--   0 patrick    (502) staff       (20)     3495 2024-02-06 10:39:38.000000 dask-expr-1.0.9/dask_expr/_accessor.py
--rw-r--r--   0 patrick    (502) staff       (20)     3089 2024-03-02 13:10:24.000000 dask-expr-1.0.9/dask_expr/_backends.py
--rw-r--r--   0 patrick    (502) staff       (20)     5913 2024-01-10 12:42:12.000000 dask-expr-1.0.9/dask_expr/_categorical.py
--rw-r--r--   0 patrick    (502) staff       (20)   201017 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/_collection.py
--rw-r--r--   0 patrick    (502) staff       (20)    12014 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/_concat.py
--rw-r--r--   0 patrick    (502) staff       (20)    23241 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/_core.py
--rw-r--r--   0 patrick    (502) staff       (20)     3402 2024-02-24 11:18:02.000000 dask-expr-1.0.9/dask_expr/_cumulative.py
--rw-r--r--   0 patrick    (502) staff       (20)     1423 2023-12-13 22:55:14.000000 dask-expr-1.0.9/dask_expr/_datetime.py
--rw-r--r--   0 patrick    (502) staff       (20)     3125 2024-01-05 09:26:35.000000 dask-expr-1.0.9/dask_expr/_describe.py
--rw-r--r--   0 patrick    (502) staff       (20)      123 2024-02-06 10:39:38.000000 dask-expr-1.0.9/dask_expr/_dispatch.py
--rw-r--r--   0 patrick    (502) staff       (20)     5500 2024-01-12 09:44:45.000000 dask-expr-1.0.9/dask_expr/_dummies.py
--rw-r--r--   0 patrick    (502) staff       (20)   119003 2024-04-02 15:22:44.000000 dask-expr-1.0.9/dask_expr/_expr.py
--rw-r--r--   0 patrick    (502) staff       (20)    67239 2024-04-02 17:51:46.000000 dask-expr-1.0.9/dask_expr/_groupby.py
--rw-r--r--   0 patrick    (502) staff       (20)      110 2023-10-16 12:23:51.000000 dask-expr-1.0.9/dask_expr/_helpers.py
--rw-r--r--   0 patrick    (502) staff       (20)    11390 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/_indexing.py
--rw-r--r--   0 patrick    (502) staff       (20)    30030 2024-04-02 15:22:44.000000 dask-expr-1.0.9/dask_expr/_merge.py
--rw-r--r--   0 patrick    (502) staff       (20)    11712 2024-03-06 13:47:43.000000 dask-expr-1.0.9/dask_expr/_merge_asof.py
--rw-r--r--   0 patrick    (502) staff       (20)     3903 2023-12-19 16:33:28.000000 dask-expr-1.0.9/dask_expr/_quantile.py
--rw-r--r--   0 patrick    (502) staff       (20)     2491 2023-12-13 22:55:14.000000 dask-expr-1.0.9/dask_expr/_quantiles.py
--rw-r--r--   0 patrick    (502) staff       (20)    43097 2024-04-02 15:23:05.000000 dask-expr-1.0.9/dask_expr/_reductions.py
--rw-r--r--   0 patrick    (502) staff       (20)    16908 2024-04-02 15:22:44.000000 dask-expr-1.0.9/dask_expr/_repartition.py
--rw-r--r--   0 patrick    (502) staff       (20)     7020 2024-02-06 10:39:38.000000 dask-expr-1.0.9/dask_expr/_resample.py
--rw-r--r--   0 patrick    (502) staff       (20)     8765 2024-03-06 13:47:43.000000 dask-expr-1.0.9/dask_expr/_rolling.py
--rw-r--r--   0 patrick    (502) staff       (20)    43784 2024-04-02 15:22:44.000000 dask-expr-1.0.9/dask_expr/_shuffle.py
--rw-r--r--   0 patrick    (502) staff       (20)     5022 2024-03-14 18:38:28.000000 dask-expr-1.0.9/dask_expr/_str_accessor.py
--rw-r--r--   0 patrick    (502) staff       (20)      217 2023-06-27 15:57:00.000000 dask-expr-1.0.9/dask_expr/_typing.py
--rw-r--r--   0 patrick    (502) staff       (20)     6825 2024-03-14 18:38:28.000000 dask-expr-1.0.9/dask_expr/_util.py
--rw-r--r--   0 patrick    (502) staff       (20)      497 2024-04-02 18:01:21.385172 dask-expr-1.0.9/dask_expr/_version.py
--rw-r--r--   0 patrick    (502) staff       (20)     6636 2024-03-02 13:39:21.000000 dask-expr-1.0.9/dask_expr/datasets.py
-drwxr-xr-x   0 patrick    (502) staff       (20)        0 2024-04-02 18:01:21.380479 dask-expr-1.0.9/dask_expr/diagnostics/
--rw-r--r--   0 patrick    (502) staff       (20)      136 2024-03-26 18:32:00.000000 dask-expr-1.0.9/dask_expr/diagnostics/__init__.py
--rw-r--r--   0 patrick    (502) staff       (20)     5125 2024-03-26 18:32:00.000000 dask-expr-1.0.9/dask_expr/diagnostics/_analyze.py
--rw-r--r--   0 patrick    (502) staff       (20)     3943 2024-03-26 18:32:00.000000 dask-expr-1.0.9/dask_expr/diagnostics/_analyze_plugin.py
--rw-r--r--   0 patrick    (502) staff       (20)     2614 2024-02-24 14:19:27.000000 dask-expr-1.0.9/dask_expr/diagnostics/_explain.py
-drwxr-xr-x   0 patrick    (502) staff       (20)        0 2024-04-02 18:01:21.384043 dask-expr-1.0.9/dask_expr/io/
--rw-r--r--   0 patrick    (502) staff       (20)       96 2023-05-16 14:29:09.000000 dask-expr-1.0.9/dask_expr/io/__init__.py
--rw-r--r--   0 patrick    (502) staff       (20)     3938 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/io/_delayed.py
--rw-r--r--   0 patrick    (502) staff       (20)      171 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/io/bag.py
--rw-r--r--   0 patrick    (502) staff       (20)     3947 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/io/csv.py
--rw-r--r--   0 patrick    (502) staff       (20)     1056 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/io/hdf.py
--rw-r--r--   0 patrick    (502) staff       (20)    19484 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/io/io.py
--rw-r--r--   0 patrick    (502) staff       (20)     1657 2024-04-02 15:36:59.000000 dask-expr-1.0.9/dask_expr/io/json.py
--rw-r--r--   0 patrick    (502) staff       (20)     1076 2024-04-02 15:36:59.000000 dask-expr-1.0.9/dask_expr/io/orc.py
--rw-r--r--   0 patrick    (502) staff       (20)    62734 2024-04-02 15:36:59.000000 dask-expr-1.0.9/dask_expr/io/parquet.py
--rw-r--r--   0 patrick    (502) staff       (20)       90 2024-01-10 12:42:12.000000 dask-expr-1.0.9/dask_expr/io/records.py
--rw-r--r--   0 patrick    (502) staff       (20)     2272 2024-03-26 18:32:06.000000 dask-expr-1.0.9/dask_expr/io/sql.py
-drwxr-xr-x   0 patrick    (502) staff       (20)        0 2024-04-02 18:01:21.384318 dask-expr-1.0.9/dask_expr.egg-info/
--rw-r--r--   0 patrick    (502) staff       (20)     2426 2024-04-02 18:01:21.000000 dask-expr-1.0.9/dask_expr.egg-info/PKG-INFO
--rw-r--r--   0 patrick    (502) staff       (20)     1296 2024-04-02 18:01:21.000000 dask-expr-1.0.9/dask_expr.egg-info/SOURCES.txt
--rw-r--r--   0 patrick    (502) staff       (20)        1 2024-04-02 18:01:21.000000 dask-expr-1.0.9/dask_expr.egg-info/dependency_links.txt
--rw-r--r--   0 patrick    (502) staff       (20)       40 2024-04-02 18:01:21.000000 dask-expr-1.0.9/dask_expr.egg-info/requires.txt
--rw-r--r--   0 patrick    (502) staff       (20)       10 2024-04-02 18:01:21.000000 dask-expr-1.0.9/dask_expr.egg-info/top_level.txt
--rw-r--r--   0 patrick    (502) staff       (20)     2195 2024-04-02 15:36:59.000000 dask-expr-1.0.9/pyproject.toml
--rw-r--r--   0 patrick    (502) staff       (20)      230 2024-04-02 18:01:21.384859 dask-expr-1.0.9/setup.cfg
--rwxr-xr-x   0 patrick    (502) staff       (20)      194 2023-08-04 10:47:33.000000 dask-expr-1.0.9/setup.py
--rw-r--r--   0 patrick    (502) staff       (20)    86677 2023-07-12 17:47:49.000000 dask-expr-1.0.9/versioneer.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-05-03 21:18:55.710291 dask_expr-1.1.0/
+-rw-r--r--   0 james      (501) staff       (20)     1516 2024-04-01 19:20:57.000000 dask_expr-1.1.0/LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)     2415 2024-05-03 21:18:55.710206 dask_expr-1.1.0/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1347 2024-05-03 20:30:23.000000 dask_expr-1.1.0/README.md
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-05-03 21:18:55.710823 dask_expr-1.1.0/dask_expr/
+-rw-r--r--   0 james      (501) staff       (20)      714 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3495 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_accessor.py
+-rw-r--r--   0 james      (501) staff       (20)     3089 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_backends.py
+-rw-r--r--   0 james      (501) staff       (20)     5913 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   231049 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_collection.py
+-rw-r--r--   0 james      (501) staff       (20)    12014 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_concat.py
+-rw-r--r--   0 james      (501) staff       (20)    23241 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_core.py
+-rw-r--r--   0 james      (501) staff       (20)     3402 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_cumulative.py
+-rw-r--r--   0 james      (501) staff       (20)     1423 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_datetime.py
+-rw-r--r--   0 james      (501) staff       (20)     3125 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_describe.py
+-rw-r--r--   0 james      (501) staff       (20)      123 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     5641 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_dummies.py
+-rw-r--r--   0 james      (501) staff       (20)   125219 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_expr.py
+-rw-r--r--   0 james      (501) staff       (20)    68056 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_groupby.py
+-rw-r--r--   0 james      (501) staff       (20)    12215 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_indexing.py
+-rw-r--r--   0 james      (501) staff       (20)    32183 2024-04-19 21:01:12.000000 dask_expr-1.1.0/dask_expr/_merge.py
+-rw-r--r--   0 james      (501) staff       (20)    11712 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_merge_asof.py
+-rw-r--r--   0 james      (501) staff       (20)     3903 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_quantile.py
+-rw-r--r--   0 james      (501) staff       (20)     2491 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_quantiles.py
+-rw-r--r--   0 james      (501) staff       (20)    44935 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)    17307 2024-04-19 21:01:12.000000 dask_expr-1.1.0/dask_expr/_repartition.py
+-rw-r--r--   0 james      (501) staff       (20)     7020 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_resample.py
+-rw-r--r--   0 james      (501) staff       (20)     8765 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    43801 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_shuffle.py
+-rw-r--r--   0 james      (501) staff       (20)     5022 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/_str_accessor.py
+-rw-r--r--   0 james      (501) staff       (20)     7068 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/_util.py
+-rw-r--r--   0 james      (501) staff       (20)      497 2024-05-03 21:18:55.710948 dask_expr-1.1.0/dask_expr/_version.py
+-rw-r--r--   0 james      (501) staff       (20)     6636 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/datasets.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-05-03 21:18:55.706290 dask_expr-1.1.0/dask_expr/diagnostics/
+-rw-r--r--   0 james      (501) staff       (20)      136 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/diagnostics/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     5099 2024-04-19 21:01:12.000000 dask_expr-1.1.0/dask_expr/diagnostics/_analyze.py
+-rw-r--r--   0 james      (501) staff       (20)     3943 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/diagnostics/_analyze_plugin.py
+-rw-r--r--   0 james      (501) staff       (20)     2793 2024-04-19 21:01:12.000000 dask_expr-1.1.0/dask_expr/diagnostics/_explain.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-05-03 21:18:55.709481 dask_expr-1.1.0/dask_expr/io/
+-rw-r--r--   0 james      (501) staff       (20)       96 2024-04-01 19:20:51.000000 dask_expr-1.1.0/dask_expr/io/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3955 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/_delayed.py
+-rw-r--r--   0 james      (501) staff       (20)      171 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/io/bag.py
+-rw-r--r--   0 james      (501) staff       (20)     8297 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/csv.py
+-rw-r--r--   0 james      (501) staff       (20)     4366 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    19484 2024-04-01 19:20:57.000000 dask_expr-1.1.0/dask_expr/io/io.py
+-rw-r--r--   0 james      (501) staff       (20)     6474 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/json.py
+-rw-r--r--   0 james      (501) staff       (20)     2410 2024-04-19 21:01:12.000000 dask_expr-1.1.0/dask_expr/io/orc.py
+-rw-r--r--   0 james      (501) staff       (20)    69891 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/parquet.py
+-rw-r--r--   0 james      (501) staff       (20)      482 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/records.py
+-rw-r--r--   0 james      (501) staff       (20)    13147 2024-05-03 20:30:23.000000 dask_expr-1.1.0/dask_expr/io/sql.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2024-05-03 21:18:55.709896 dask_expr-1.1.0/dask_expr.egg-info/
+-rw-r--r--   0 james      (501) staff       (20)     2415 2024-05-03 21:18:55.000000 dask_expr-1.1.0/dask_expr.egg-info/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1239 2024-05-03 21:18:55.000000 dask_expr-1.1.0/dask_expr.egg-info/SOURCES.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2024-05-03 21:18:55.000000 dask_expr-1.1.0/dask_expr.egg-info/dependency_links.txt
+-rw-r--r--   0 james      (501) staff       (20)       40 2024-05-03 21:18:55.000000 dask_expr-1.1.0/dask_expr.egg-info/requires.txt
+-rw-r--r--   0 james      (501) staff       (20)       10 2024-05-03 21:18:55.000000 dask_expr-1.1.0/dask_expr.egg-info/top_level.txt
+-rw-r--r--   0 james      (501) staff       (20)     2195 2024-05-03 21:08:58.000000 dask_expr-1.1.0/pyproject.toml
+-rw-r--r--   0 james      (501) staff       (20)      230 2024-05-03 21:18:55.710599 dask_expr-1.1.0/setup.cfg
+-rwxr-xr-x   0 james      (501) staff       (20)      194 2024-04-01 19:20:57.000000 dask_expr-1.1.0/setup.py
```

### Comparing `dask-expr-1.0.9/LICENSE.txt` & `dask_expr-1.1.0/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/PKG-INFO` & `dask_expr-1.1.0/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask-expr
-Version: 1.0.9
+Version: 1.1.0
 Summary: High Level Expressions for Dask 
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Source code, https://github.com/dask-contrib/dask-expr/
 Keywords: dask pandas
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
@@ -18,15 +18,15 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System :: Distributed Computing
 Requires-Python: >=3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.txt
-Requires-Dist: dask==2024.4.0
+Requires-Dist: dask==2024.5.0
 Requires-Dist: pyarrow>=7.0.0
 Requires-Dist: pandas>=2
 
 Dask Expressions
 ================
 
 Dask DataFrames with query optimization.
@@ -85,9 +85,8 @@
 This is the default backend for dask.DataFrame since version 2024.3.0.
 
 API Coverage
 ------------
 
 Dask-Expr covers almost everything of the Dask DataFrame API. The only missing features are:
 
-- ``melt``
 - named GroupBy Aggregations
```

### Comparing `dask-expr-1.0.9/README.md` & `dask_expr-1.1.0/README.md`

 * *Files 11% similar despite different names*

```diff
@@ -57,9 +57,8 @@
 This is the default backend for dask.DataFrame since version 2024.3.0.
 
 API Coverage
 ------------
 
 Dask-Expr covers almost everything of the Dask DataFrame API. The only missing features are:
 
-- ``melt``
 - named GroupBy Aggregations
```

### Comparing `dask-expr-1.0.9/dask_expr/__init__.py` & `dask_expr-1.1.0/dask_expr/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_accessor.py` & `dask_expr-1.1.0/dask_expr/_accessor.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_backends.py` & `dask_expr-1.1.0/dask_expr/_backends.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_categorical.py` & `dask_expr-1.1.0/dask_expr/_categorical.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_collection.py` & `dask_expr-1.1.0/dask_expr/_collection.py`

 * *Files 12% similar despite different names*

```diff
@@ -4,12561 +4,14438 @@
 00000030: 696d 650a 696d 706f 7274 2066 756e 6374  ime.import funct
 00000040: 6f6f 6c73 0a69 6d70 6f72 7420 696e 7370  ools.import insp
 00000050: 6563 740a 696d 706f 7274 2077 6172 6e69  ect.import warni
 00000060: 6e67 730a 6672 6f6d 2063 6f6c 6c65 6374  ngs.from collect
 00000070: 696f 6e73 2e61 6263 2069 6d70 6f72 7420  ions.abc import 
 00000080: 4361 6c6c 6162 6c65 2c20 4861 7368 6162  Callable, Hashab
 00000090: 6c65 2c20 4d61 7070 696e 670a 6672 6f6d  le, Mapping.from
-000000a0: 206e 756d 6265 7273 2069 6d70 6f72 7420   numbers import 
-000000b0: 496e 7465 6772 616c 2c20 4e75 6d62 6572  Integral, Number
-000000c0: 0a66 726f 6d20 7479 7069 6e67 2069 6d70  .from typing imp
-000000d0: 6f72 7420 416e 792c 2043 6c61 7373 5661  ort Any, ClassVa
-000000e0: 722c 2049 7465 7261 626c 652c 204c 6974  r, Iterable, Lit
-000000f0: 6572 616c 0a0a 696d 706f 7274 2064 6173  eral..import das
-00000100: 6b2e 6172 7261 7920 6173 2064 610a 696d  k.array as da.im
-00000110: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
-00000120: 616d 652e 6d65 7468 6f64 7320 6173 206d  ame.methods as m
-00000130: 6574 686f 6473 0a69 6d70 6f72 7420 6e75  ethods.import nu
-00000140: 6d70 7920 6173 206e 700a 696d 706f 7274  mpy as np.import
-00000150: 2070 616e 6461 7320 6173 2070 640a 696d   pandas as pd.im
-00000160: 706f 7274 2070 7961 7272 6f77 2061 7320  port pyarrow as 
-00000170: 7061 0a66 726f 6d20 6461 736b 2069 6d70  pa.from dask imp
-00000180: 6f72 7420 636f 6d70 7574 652c 2067 6574  ort compute, get
-00000190: 5f61 6e6e 6f74 6174 696f 6e73 0a66 726f  _annotations.fro
-000001a0: 6d20 6461 736b 2e61 7272 6179 2069 6d70  m dask.array imp
-000001b0: 6f72 7420 4172 7261 790a 6672 6f6d 2064  ort Array.from d
-000001c0: 6173 6b2e 6261 7365 2069 6d70 6f72 7420  ask.base import 
-000001d0: 4461 736b 4d65 7468 6f64 734d 6978 696e  DaskMethodsMixin
-000001e0: 2c20 6973 5f64 6173 6b5f 636f 6c6c 6563  , is_dask_collec
-000001f0: 7469 6f6e 2c20 6e61 6d65 645f 7363 6865  tion, named_sche
-00000200: 6475 6c65 7273 0a66 726f 6d20 6461 736b  dulers.from dask
-00000210: 2e63 6f72 6520 696d 706f 7274 2066 6c61  .core import fla
-00000220: 7474 656e 0a66 726f 6d20 6461 736b 2e64  tten.from dask.d
-00000230: 6174 6166 7261 6d65 2e5f 636f 6d70 6174  ataframe._compat
-00000240: 2069 6d70 6f72 7420 5041 4e44 4153 5f47   import PANDAS_G
-00000250: 455f 3231 302c 2050 414e 4441 535f 4745  E_210, PANDAS_GE
-00000260: 5f32 3230 2c20 5041 4e44 4153 5f56 4552  _220, PANDAS_VER
-00000270: 5349 4f4e 0a66 726f 6d20 6461 736b 2e64  SION.from dask.d
-00000280: 6174 6166 7261 6d65 2e61 6363 6573 736f  ataframe.accesso
-00000290: 7220 696d 706f 7274 2043 6163 6865 6441  r import CachedA
-000002a0: 6363 6573 736f 720a 6672 6f6d 2064 6173  ccessor.from das
-000002b0: 6b2e 6461 7461 6672 616d 652e 636f 7265  k.dataframe.core
-000002c0: 2069 6d70 6f72 7420 280a 2020 2020 5f63   import (.    _c
-000002d0: 6f6e 6361 742c 0a20 2020 205f 636f 6e76  oncat,.    _conv
-000002e0: 6572 745f 746f 5f6e 756d 6572 6963 2c0a  ert_to_numeric,.
-000002f0: 2020 2020 5f46 7261 6d65 2c0a 2020 2020      _Frame,.    
-00000300: 5f72 6570 725f 6461 7461 5f73 6572 6965  _repr_data_serie
-00000310: 732c 0a20 2020 205f 7371 7274 5f61 6e64  s,.    _sqrt_and
-00000320: 5f63 6f6e 7665 7274 5f74 6f5f 7469 6d65  _convert_to_time
-00000330: 6465 6c74 612c 0a20 2020 2063 6865 636b  delta,.    check
-00000340: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
-00000350: 6861 735f 7061 7261 6c6c 656c 5f74 7970  has_parallel_typ
-00000360: 652c 0a20 2020 2069 735f 6172 7261 796c  e,.    is_arrayl
-00000370: 696b 652c 0a20 2020 2069 735f 6461 7461  ike,.    is_data
-00000380: 6672 616d 655f 6c69 6b65 2c0a 2020 2020  frame_like,.    
-00000390: 6973 5f73 6572 6965 735f 6c69 6b65 2c0a  is_series_like,.
-000003a0: 2020 2020 6d65 7461 5f77 6172 6e69 6e67      meta_warning
-000003b0: 2c0a 2020 2020 6e65 775f 6464 5f6f 626a  ,.    new_dd_obj
-000003c0: 6563 742c 0a29 0a66 726f 6d20 6461 736b  ect,.).from dask
-000003d0: 2e64 6174 6166 7261 6d65 2e64 6973 7061  .dataframe.dispa
-000003e0: 7463 6820 696d 706f 7274 2069 735f 6361  tch import is_ca
-000003f0: 7465 676f 7269 6361 6c5f 6474 7970 652c  tegorical_dtype,
-00000400: 206d 616b 655f 6d65 7461 2c20 6d65 7461   make_meta, meta
-00000410: 5f6e 6f6e 656d 7074 790a 6672 6f6d 2064  _nonempty.from d
-00000420: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-00000430: 6c74 6920 696d 706f 7274 2077 6172 6e5f  lti import warn_
-00000440: 6474 7970 655f 6d69 736d 6174 6368 0a66  dtype_mismatch.f
-00000450: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-00000460: 6d65 2e75 7469 6c73 2069 6d70 6f72 7420  me.utils import 
-00000470: 280a 2020 2020 4174 7472 6962 7574 654e  (.    AttributeN
-00000480: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00000490: 6f72 2c0a 2020 2020 6861 735f 6b6e 6f77  or,.    has_know
-000004a0: 6e5f 6361 7465 676f 7269 6573 2c0a 2020  n_categories,.  
-000004b0: 2020 696e 6465 785f 7375 6d6d 6172 792c    index_summary,
-000004c0: 0a20 2020 2069 6e73 6572 745f 6d65 7461  .    insert_meta
-000004d0: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
-000004e0: 6f6e 2c0a 2020 2020 6d65 7461 5f66 7261  on,.    meta_fra
-000004f0: 6d65 5f63 6f6e 7374 7275 6374 6f72 2c0a  me_constructor,.
-00000500: 2020 2020 6d65 7461 5f73 6572 6965 735f      meta_series_
-00000510: 636f 6e73 7472 7563 746f 722c 0a20 2020  constructor,.   
-00000520: 2070 7961 7272 6f77 5f73 7472 696e 6773   pyarrow_strings
-00000530: 5f65 6e61 626c 6564 2c0a 290a 6672 6f6d  _enabled,.).from
-00000540: 2064 6173 6b2e 6465 6c61 7965 6420 696d   dask.delayed im
-00000550: 706f 7274 2064 656c 6179 6564 0a66 726f  port delayed.fro
-00000560: 6d20 6461 736b 2e75 7469 6c73 2069 6d70  m dask.utils imp
-00000570: 6f72 7420 280a 2020 2020 496e 6465 7843  ort (.    IndexC
-00000580: 616c 6c61 626c 652c 0a20 2020 204d 2c0a  allable,.    M,.
-00000590: 2020 2020 6465 7269 7665 645f 6672 6f6d      derived_from
-000005a0: 2c0a 2020 2020 6765 745f 6465 6661 756c  ,.    get_defaul
-000005b0: 745f 7368 7566 666c 655f 6d65 7468 6f64  t_shuffle_method
-000005c0: 2c0a 2020 2020 6765 745f 6d65 7461 5f6c  ,.    get_meta_l
-000005d0: 6962 7261 7279 2c0a 2020 2020 6b65 795f  ibrary,.    key_
-000005e0: 7370 6c69 742c 0a20 2020 206d 6179 6265  split,.    maybe
-000005f0: 5f70 6c75 7261 6c69 7a65 2c0a 2020 2020  _pluralize,.    
-00000600: 6d65 6d6f 7279 5f72 6570 722c 0a20 2020  memory_repr,.   
-00000610: 2070 7574 5f6c 696e 6573 2c0a 2020 2020   put_lines,.    
-00000620: 7261 6e64 6f6d 5f73 7461 7465 5f64 6174  random_state_dat
-00000630: 612c 0a20 2020 2074 7970 656e 616d 652c  a,.    typename,
-00000640: 0a29 0a66 726f 6d20 6461 736b 2e77 6964  .).from dask.wid
-00000650: 6765 7473 2069 6d70 6f72 7420 6765 745f  gets import get_
-00000660: 7465 6d70 6c61 7465 0a66 726f 6d20 6673  template.from fs
-00000670: 7370 6563 2e75 7469 6c73 2069 6d70 6f72  spec.utils impor
-00000680: 7420 7374 7269 6e67 6966 795f 7061 7468  t stringify_path
-00000690: 0a66 726f 6d20 7061 636b 6167 696e 672e  .from packaging.
-000006a0: 7665 7273 696f 6e20 696d 706f 7274 2070  version import p
-000006b0: 6172 7365 2061 7320 7061 7273 655f 7665  arse as parse_ve
-000006c0: 7273 696f 6e0a 6672 6f6d 2070 616e 6461  rsion.from panda
-000006d0: 7320 696d 706f 7274 2043 6174 6567 6f72  s import Categor
-000006e0: 6963 616c 4474 7970 650a 6672 6f6d 2070  icalDtype.from p
-000006f0: 616e 6461 732e 6170 692e 7479 7065 7320  andas.api.types 
-00000700: 696d 706f 7274 2069 735f 626f 6f6c 5f64  import is_bool_d
-00000710: 7479 7065 2c20 6973 5f64 6174 6574 696d  type, is_datetim
-00000720: 6536 345f 616e 795f 6474 7970 652c 2069  e64_any_dtype, i
-00000730: 735f 6e75 6d65 7269 635f 6474 7970 650a  s_numeric_dtype.
-00000740: 6672 6f6d 2070 616e 6461 732e 6170 692e  from pandas.api.
-00000750: 7479 7065 7320 696d 706f 7274 2069 735f  types import is_
-00000760: 7363 616c 6172 2061 7320 7064 5f69 735f  scalar as pd_is_
-00000770: 7363 616c 6172 0a66 726f 6d20 7061 6e64  scalar.from pand
-00000780: 6173 2e61 7069 2e74 7970 6573 2069 6d70  as.api.types imp
-00000790: 6f72 7420 6973 5f74 696d 6564 656c 7461  ort is_timedelta
-000007a0: 3634 5f64 7479 7065 0a66 726f 6d20 7079  64_dtype.from py
-000007b0: 6172 726f 7720 696d 706f 7274 2066 7320  arrow import fs 
-000007c0: 6173 2070 615f 6673 0a66 726f 6d20 746c  as pa_fs.from tl
-000007d0: 7a20 696d 706f 7274 2066 6972 7374 0a0a  z import first..
-000007e0: 696d 706f 7274 2064 6173 6b5f 6578 7072  import dask_expr
-000007f0: 2e5f 6261 636b 656e 6473 2020 2320 6e6f  ._backends  # no
-00000800: 7161 3a20 4634 3031 0a66 726f 6d20 6461  qa: F401.from da
-00000810: 736b 5f65 7870 7220 696d 706f 7274 205f  sk_expr import _
-00000820: 6578 7072 2061 7320 6578 7072 0a66 726f  expr as expr.fro
-00000830: 6d20 6461 736b 5f65 7870 722e 5f62 6163  m dask_expr._bac
-00000840: 6b65 6e64 7320 696d 706f 7274 2064 6174  kends import dat
-00000850: 6166 7261 6d65 5f63 7265 6174 696f 6e5f  aframe_creation_
-00000860: 6469 7370 6174 6368 0a66 726f 6d20 6461  dispatch.from da
-00000870: 736b 5f65 7870 722e 5f63 6174 6567 6f72  sk_expr._categor
-00000880: 6963 616c 2069 6d70 6f72 7420 4361 7465  ical import Cate
-00000890: 676f 7269 6361 6c41 6363 6573 736f 722c  goricalAccessor,
-000008a0: 2043 6174 6567 6f72 697a 652c 2047 6574   Categorize, Get
-000008b0: 4361 7465 676f 7269 6573 0a66 726f 6d20  Categories.from 
-000008c0: 6461 736b 5f65 7870 722e 5f63 6f6e 6361  dask_expr._conca
-000008d0: 7420 696d 706f 7274 2043 6f6e 6361 740a  t import Concat.
-000008e0: 6672 6f6d 2064 6173 6b5f 6578 7072 2e5f  from dask_expr._
-000008f0: 636f 7265 2069 6d70 6f72 7420 4f70 7469  core import Opti
-00000900: 6d69 7a65 7253 7461 6765 0a66 726f 6d20  mizerStage.from 
-00000910: 6461 736b 5f65 7870 722e 5f64 6174 6574  dask_expr._datet
-00000920: 696d 6520 696d 706f 7274 2044 6174 6574  ime import Datet
-00000930: 696d 6541 6363 6573 736f 720a 6672 6f6d  imeAccessor.from
-00000940: 2064 6173 6b5f 6578 7072 2e5f 6465 7363   dask_expr._desc
-00000950: 7269 6265 2069 6d70 6f72 7420 4465 7363  ribe import Desc
-00000960: 7269 6265 4e6f 6e4e 756d 6572 6963 2c20  ribeNonNumeric, 
-00000970: 4465 7363 7269 6265 4e75 6d65 7269 630a  DescribeNumeric.
-00000980: 6672 6f6d 2064 6173 6b5f 6578 7072 2e5f  from dask_expr._
-00000990: 6469 7370 6174 6368 2069 6d70 6f72 7420  dispatch import 
-000009a0: 6765 745f 636f 6c6c 6563 7469 6f6e 5f74  get_collection_t
-000009b0: 7970 650a 6672 6f6d 2064 6173 6b5f 6578  ype.from dask_ex
-000009c0: 7072 2e5f 6578 7072 2069 6d70 6f72 7420  pr._expr import 
-000009d0: 280a 2020 2020 4246 696c 6c2c 0a20 2020  (.    BFill,.   
-000009e0: 2044 6966 662c 0a20 2020 2045 7661 6c2c   Diff,.    Eval,
-000009f0: 0a20 2020 2046 4669 6c6c 2c0a 2020 2020  .    FFill,.    
-00000a00: 4669 6c6c 6e61 4368 6563 6b2c 0a20 2020  FillnaCheck,.   
-00000a10: 2051 7565 7279 2c0a 2020 2020 5368 6966   Query,.    Shif
-00000a20: 742c 0a20 2020 2054 6f44 6174 6574 696d  t,.    ToDatetim
-00000a30: 652c 0a20 2020 2054 6f4e 756d 6572 6963  e,.    ToNumeric
-00000a40: 2c0a 2020 2020 546f 5469 6d65 6465 6c74  ,.    ToTimedelt
-00000a50: 612c 0a20 2020 206e 6f5f 6465 6661 756c  a,.    no_defaul
-00000a60: 742c 0a29 0a66 726f 6d20 6461 736b 5f65  t,.).from dask_e
-00000a70: 7870 722e 5f6d 6572 6765 2069 6d70 6f72  xpr._merge impor
-00000a80: 7420 4a6f 696e 5265 6375 7273 6976 652c  t JoinRecursive,
-00000a90: 204d 6572 6765 0a66 726f 6d20 6461 736b   Merge.from dask
-00000aa0: 5f65 7870 722e 5f71 7561 6e74 696c 6520  _expr._quantile 
-00000ab0: 696d 706f 7274 2053 6572 6965 7351 7561  import SeriesQua
-00000ac0: 6e74 696c 650a 6672 6f6d 2064 6173 6b5f  ntile.from dask_
-00000ad0: 6578 7072 2e5f 7175 616e 7469 6c65 7320  expr._quantiles 
-00000ae0: 696d 706f 7274 2052 6570 6172 7469 7469  import Repartiti
-00000af0: 6f6e 5175 616e 7469 6c65 730a 6672 6f6d  onQuantiles.from
-00000b00: 2064 6173 6b5f 6578 7072 2e5f 7265 6475   dask_expr._redu
-00000b10: 6374 696f 6e73 2069 6d70 6f72 7420 280a  ctions import (.
-00000b20: 2020 2020 436f 7272 2c0a 2020 2020 436f      Corr,.    Co
-00000b30: 762c 0a20 2020 2043 7573 746f 6d52 6564  v,.    CustomRed
-00000b40: 7563 7469 6f6e 2c0a 2020 2020 4472 6f70  uction,.    Drop
-00000b50: 4475 706c 6963 6174 6573 2c0a 2020 2020  Duplicates,.    
-00000b60: 496e 6465 7843 6f75 6e74 2c0a 2020 2020  IndexCount,.    
-00000b70: 4973 4d6f 6e6f 746f 6e69 6344 6563 7265  IsMonotonicDecre
-00000b80: 6173 696e 672c 0a20 2020 2049 734d 6f6e  asing,.    IsMon
-00000b90: 6f74 6f6e 6963 496e 6372 6561 7369 6e67  otonicIncreasing
-00000ba0: 2c0a 2020 2020 4c65 6e2c 0a20 2020 204d  ,.    Len,.    M
-00000bb0: 656d 6f72 7955 7361 6765 4672 616d 652c  emoryUsageFrame,
-00000bc0: 0a20 2020 204d 656d 6f72 7955 7361 6765  .    MemoryUsage
-00000bd0: 496e 6465 782c 0a20 2020 204d 6f6d 656e  Index,.    Momen
-00000be0: 742c 0a20 2020 204e 4c61 7267 6573 742c  t,.    NLargest,
-00000bf0: 0a20 2020 204e 536d 616c 6c65 7374 2c0a  .    NSmallest,.
-00000c00: 2020 2020 5069 766f 7454 6162 6c65 2c0a      PivotTable,.
-00000c10: 2020 2020 556e 6971 7565 2c0a 2020 2020      Unique,.    
-00000c20: 5661 6c75 6543 6f75 6e74 732c 0a29 0a66  ValueCounts,.).f
-00000c30: 726f 6d20 6461 736b 5f65 7870 722e 5f72  rom dask_expr._r
-00000c40: 6570 6172 7469 7469 6f6e 2069 6d70 6f72  epartition impor
-00000c50: 7420 5265 7061 7274 6974 696f 6e2c 2052  t Repartition, R
-00000c60: 6570 6172 7469 7469 6f6e 4672 6571 0a66  epartitionFreq.f
-00000c70: 726f 6d20 6461 736b 5f65 7870 722e 5f73  rom dask_expr._s
-00000c80: 6875 6666 6c65 2069 6d70 6f72 7420 280a  huffle import (.
-00000c90: 2020 2020 5265 6172 7261 6e67 6542 7943      RearrangeByC
-00000ca0: 6f6c 756d 6e2c 0a20 2020 2053 6574 496e  olumn,.    SetIn
-00000cb0: 6465 782c 0a20 2020 2053 6574 496e 6465  dex,.    SetInde
-00000cc0: 7842 6c6f 636b 7769 7365 2c0a 2020 2020  xBlockwise,.    
-00000cd0: 536f 7274 5661 6c75 6573 2c0a 290a 6672  SortValues,.).fr
-00000ce0: 6f6d 2064 6173 6b5f 6578 7072 2e5f 7374  om dask_expr._st
-00000cf0: 725f 6163 6365 7373 6f72 2069 6d70 6f72  r_accessor impor
-00000d00: 7420 5374 7269 6e67 4163 6365 7373 6f72  t StringAccessor
-00000d10: 0a66 726f 6d20 6461 736b 5f65 7870 722e  .from dask_expr.
-00000d20: 5f75 7469 6c20 696d 706f 7274 2028 0a20  _util import (. 
-00000d30: 2020 205f 4261 636b 656e 6444 6174 612c     _BackendData,
-00000d40: 0a20 2020 205f 636f 6e76 6572 745f 746f  .    _convert_to
-00000d50: 5f6c 6973 742c 0a20 2020 205f 6765 745f  _list,.    _get_
-00000d60: 7368 7566 666c 655f 7072 6566 6572 7269  shuffle_preferri
-00000d70: 6e67 5f6f 7264 6572 2c0a 2020 2020 5f69  ng_order,.    _i
-00000d80: 735f 616e 795f 7265 616c 5f6e 756d 6572  s_any_real_numer
-00000d90: 6963 5f64 7479 7065 2c0a 2020 2020 5f6d  ic_dtype,.    _m
-00000da0: 6179 6265 5f66 726f 6d5f 7061 6e64 6173  aybe_from_pandas
-00000db0: 2c0a 2020 2020 5f72 6169 7365 5f69 665f  ,.    _raise_if_
-00000dc0: 6f62 6a65 6374 5f73 6572 6965 732c 0a20  object_series,. 
-00000dd0: 2020 205f 746f 6b65 6e69 7a65 5f64 6574     _tokenize_det
-00000de0: 6572 6d69 6e69 7374 6963 2c0a 2020 2020  erministic,.    
-00000df0: 5f76 616c 6964 6174 655f 6178 6973 2c0a  _validate_axis,.
-00000e00: 2020 2020 6765 745f 7370 6563 6966 6965      get_specifie
-00000e10: 645f 7368 7566 666c 652c 0a20 2020 2069  d_shuffle,.    i
-00000e20: 735f 7363 616c 6172 2c0a 290a 6672 6f6d  s_scalar,.).from
-00000e30: 2064 6173 6b5f 6578 7072 2e69 6f20 696d   dask_expr.io im
-00000e40: 706f 7274 2046 726f 6d50 616e 6461 7344  port FromPandasD
-00000e50: 6976 6973 696f 6e73 2c20 4672 6f6d 5363  ivisions, FromSc
-00000e60: 616c 6172 730a 0a23 0a23 2055 7469 6c69  alars..#.# Utili
-00000e70: 7469 6573 2074 6f20 7772 6170 2045 7870  ties to wrap Exp
-00000e80: 7220 4150 490a 2320 2848 656c 7073 206c  r API.# (Helps l
-00000e90: 696d 6974 2062 6f69 6c65 722d 706c 6174  imit boiler-plat
-00000ea0: 6520 636f 6465 2069 6e20 636f 6c6c 6563  e code in collec
-00000eb0: 7469 6f6e 2041 5049 7329 0a23 0a0a 0a64  tion APIs).#...d
-00000ec0: 6566 205f 7772 6170 5f65 7870 725f 6170  ef _wrap_expr_ap
-00000ed0: 6928 2a61 7267 732c 2077 7261 705f 6170  i(*args, wrap_ap
-00000ee0: 693d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  i=None, **kwargs
-00000ef0: 293a 0a20 2020 2023 2055 7365 2045 7870  ):.    # Use Exp
-00000f00: 7220 4150 492c 2062 7574 2063 6f6e 7665  r API, but conve
-00000f10: 7274 2074 6f2f 6672 6f6d 2045 7870 7220  rt to/from Expr 
-00000f20: 6f62 6a65 6374 730a 2020 2020 6173 7365  objects.    asse
-00000f30: 7274 2077 7261 705f 6170 6920 6973 206e  rt wrap_api is n
-00000f40: 6f74 204e 6f6e 650a 2020 2020 7265 7375  ot None.    resu
-00000f50: 6c74 203d 2077 7261 705f 6170 6928 0a20  lt = wrap_api(. 
-00000f60: 2020 2020 2020 202a 5b61 7267 2e65 7870         *[arg.exp
-00000f70: 7220 6966 2069 7369 6e73 7461 6e63 6528  r if isinstance(
-00000f80: 6172 672c 2046 7261 6d65 4261 7365 2920  arg, FrameBase) 
-00000f90: 656c 7365 2061 7267 2066 6f72 2061 7267  else arg for arg
-00000fa0: 2069 6e20 6172 6773 5d2c 0a20 2020 2020   in args],.     
-00000fb0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-00000fc0: 2029 0a20 2020 2069 6620 6973 696e 7374   ).    if isinst
-00000fd0: 616e 6365 2872 6573 756c 742c 2065 7870  ance(result, exp
-00000fe0: 722e 4578 7072 293a 0a20 2020 2020 2020  r.Expr):.       
-00000ff0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00001000: 6563 7469 6f6e 2872 6573 756c 7429 0a20  ection(result). 
-00001010: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-00001020: 0a0a 0a64 6566 205f 7772 6170 5f65 7870  ...def _wrap_exp
-00001030: 725f 6f70 2873 656c 662c 206f 7468 6572  r_op(self, other
-00001040: 2c20 6f70 3d4e 6f6e 6529 3a0a 2020 2020  , op=None):.    
-00001050: 2320 5772 6170 2065 7870 7220 6f70 6572  # Wrap expr oper
-00001060: 6174 6f72 0a20 2020 2061 7373 6572 7420  ator.    assert 
-00001070: 6f70 2069 7320 6e6f 7420 4e6f 6e65 0a20  op is not None. 
-00001080: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00001090: 286f 7468 6572 2c20 4672 616d 6542 6173  (other, FrameBas
-000010a0: 6529 3a0a 2020 2020 2020 2020 6f74 6865  e):.        othe
-000010b0: 7220 3d20 6f74 6865 722e 6578 7072 0a20  r = other.expr. 
-000010c0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-000010d0: 6365 286f 7468 6572 2c20 6461 2e41 7272  ce(other, da.Arr
-000010e0: 6179 293a 0a20 2020 2020 2020 206f 7468  ay):.        oth
-000010f0: 6572 203d 2066 726f 6d5f 6461 736b 5f61  er = from_dask_a
-00001100: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00001110: 2020 6f74 6865 722c 2069 6e64 6578 3d73    other, index=s
-00001120: 656c 662e 696e 6465 782e 746f 5f6c 6567  elf.index.to_leg
-00001130: 6163 795f 6461 7461 6672 616d 6528 292c  acy_dataframe(),
-00001140: 2063 6f6c 756d 6e73 3d73 656c 662e 636f   columns=self.co
-00001150: 6c75 6d6e 730a 2020 2020 2020 2020 290a  lumns.        ).
-00001160: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00001170: 6e64 696d 203d 3d20 3120 616e 6420 6c65  ndim == 1 and le
-00001180: 6e28 7365 6c66 2e63 6f6c 756d 6e73 293a  n(self.columns):
-00001190: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-000011a0: 6572 203d 206f 7468 6572 5b73 656c 662e  er = other[self.
-000011b0: 636f 6c75 6d6e 735b 305d 5d0a 0a20 2020  columns[0]]..   
-000011c0: 2069 6620 280a 2020 2020 2020 2020 6e6f   if (.        no
-000011d0: 7420 6973 696e 7374 616e 6365 286f 7468  t isinstance(oth
-000011e0: 6572 2c20 6578 7072 2e45 7870 7229 0a20  er, expr.Expr). 
-000011f0: 2020 2020 2020 2061 6e64 2069 735f 6461         and is_da
-00001200: 7461 6672 616d 655f 6c69 6b65 286f 7468  taframe_like(oth
-00001210: 6572 290a 2020 2020 2020 2020 6f72 2069  er).        or i
-00001220: 735f 7365 7269 6573 5f6c 696b 6528 6f74  s_series_like(ot
-00001230: 6865 7229 0a20 2020 2029 3a0a 2020 2020  her).    ):.    
-00001240: 2020 2020 6f74 6865 7220 3d20 7365 6c66      other = self
-00001250: 2e5f 6372 6561 7465 5f61 6c69 676e 6162  ._create_alignab
-00001260: 6c65 5f66 7261 6d65 286f 7468 6572 292e  le_frame(other).
-00001270: 6578 7072 0a0a 2020 2020 6966 206e 6f74  expr..    if not
-00001280: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00001290: 722c 2065 7870 722e 4578 7072 293a 0a20  r, expr.Expr):. 
-000012a0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000012b0: 775f 636f 6c6c 6563 7469 6f6e 2867 6574  w_collection(get
-000012c0: 6174 7472 2873 656c 662e 6578 7072 2c20  attr(self.expr, 
-000012d0: 6f70 2928 6f74 6865 7229 290a 2020 2020  op)(other)).    
-000012e0: 656c 6966 2065 7870 722e 6172 655f 636f  elif expr.are_co
-000012f0: 5f61 6c69 676e 6564 2873 656c 662e 6578  _aligned(self.ex
-00001300: 7072 2c20 6f74 6865 7229 3a0a 2020 2020  pr, other):.    
-00001310: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00001320: 6f6c 6c65 6374 696f 6e28 6765 7461 7474  ollection(getatt
-00001330: 7228 7365 6c66 2e65 7870 722c 206f 7029  r(self.expr, op)
-00001340: 286f 7468 6572 2929 0a20 2020 2065 6c73  (other)).    els
-00001350: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-00001360: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00001370: 2865 7870 722e 4f70 416c 6967 6e50 6172  (expr.OpAlignPar
-00001380: 7469 7469 6f6e 7328 7365 6c66 2c20 6f74  titions(self, ot
-00001390: 6865 722c 206f 7029 290a 0a0a 6465 6620  her, op))...def 
-000013a0: 5f77 7261 705f 6578 7072 5f6d 6574 686f  _wrap_expr_metho
-000013b0: 645f 6f70 6572 6174 6f72 286e 616d 652c  d_operator(name,
-000013c0: 2063 6c61 7373 5f29 3a0a 2020 2020 2222   class_):.    ""
-000013d0: 220a 2020 2020 4164 6420 6d65 7468 6f64  ".    Add method
-000013e0: 206f 7065 7261 746f 7273 2074 6f20 5365   operators to Se
-000013f0: 7269 6573 206f 7220 4461 7461 4672 616d  ries or DataFram
-00001400: 6520 6c69 6b65 2044 6174 6146 7261 6d65  e like DataFrame
-00001410: 2e61 6464 2e0a 2020 2020 5f77 7261 705f  .add..    _wrap_
-00001420: 6578 7072 5f6d 6574 686f 645f 6f70 6572  expr_method_oper
-00001430: 6174 6f72 2822 6164 6422 2c20 4461 7461  ator("add", Data
-00001440: 4672 616d 6529 0a20 2020 2022 2222 0a20  Frame).    """. 
-00001450: 2020 2069 6620 636c 6173 735f 203d 3d20     if class_ == 
-00001460: 4461 7461 4672 616d 653a 0a0a 2020 2020  DataFrame:..    
-00001470: 2020 2020 6465 6620 6d65 7468 6f64 2873      def method(s
-00001480: 656c 662c 206f 7468 6572 2c20 6178 6973  elf, other, axis
-00001490: 3d22 636f 6c75 6d6e 7322 2c20 6c65 7665  ="columns", leve
-000014a0: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
-000014b0: 7565 3d4e 6f6e 6529 3a0a 2020 2020 2020  ue=None):.      
-000014c0: 2020 2020 2020 6966 206c 6576 656c 2069        if level i
-000014d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-000014e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000014f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00001500: 4572 726f 7228 226c 6576 656c 206d 7573  Error("level mus
-00001510: 7420 6265 204e 6f6e 6522 290a 0a20 2020  t be None")..   
-00001520: 2020 2020 2020 2020 2061 7869 7320 3d20           axis = 
-00001530: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-00001540: 7869 7329 0a0a 2020 2020 2020 2020 2020  xis)..          
-00001550: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-00001560: 2020 2020 2020 2069 735f 6461 7461 6672         is_datafr
-00001570: 616d 655f 6c69 6b65 286f 7468 6572 290a  ame_like(other).
-00001580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001590: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
-000015a0: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
-000015b0: 2020 2020 2020 2020 2061 6e64 2061 7869           and axi
-000015c0: 7320 696e 2028 302c 2022 696e 6465 7822  s in (0, "index"
-000015d0: 290a 2020 2020 2020 2020 2020 2020 2920  ).            ) 
-000015e0: 616e 6420 6e6f 7420 6973 5f64 6173 6b5f  and not is_dask_
-000015f0: 636f 6c6c 6563 7469 6f6e 286f 7468 6572  collection(other
-00001600: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00001610: 2020 206f 7468 6572 203d 2073 656c 662e     other = self.
-00001620: 5f63 7265 6174 655f 616c 6967 6e61 626c  _create_alignabl
-00001630: 655f 6672 616d 6528 6f74 6865 7229 0a0a  e_frame(other)..
-00001640: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00001650: 7869 7320 696e 2028 312c 2022 636f 6c75  xis in (1, "colu
-00001660: 6d6e 7322 293a 0a20 2020 2020 2020 2020  mns"):.         
-00001670: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00001680: 616e 6365 286f 7468 6572 2c20 5365 7269  ance(other, Seri
-00001690: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-000016a0: 2020 2020 2020 2020 206d 7367 203d 2066           msg = f
-000016b0: 2255 6e61 626c 6520 746f 207b 6e61 6d65  "Unable to {name
-000016c0: 7d20 6464 2e53 6572 6965 7320 7769 7468  } dd.Series with
-000016d0: 2061 7869 733d 3122 0a20 2020 2020 2020   axis=1".       
-000016e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000016f0: 7365 2056 616c 7565 4572 726f 7228 6d73  se ValueError(ms
-00001700: 6729 0a0a 2020 2020 2020 2020 2020 2020  g)..            
-00001710: 6672 616d 6520 3d20 7365 6c66 0a20 2020  frame = self.   
-00001720: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00001730: 7374 616e 6365 286f 7468 6572 2c20 4672  stance(other, Fr
-00001740: 616d 6542 6173 6529 2061 6e64 206e 6f74  ameBase) and not
-00001750: 2065 7870 722e 6172 655f 636f 5f61 6c69   expr.are_co_ali
-00001760: 676e 6564 280a 2020 2020 2020 2020 2020  gned(.          
-00001770: 2020 2020 2020 7365 6c66 2e65 7870 722c        self.expr,
-00001780: 206f 7468 6572 2e65 7870 720a 2020 2020   other.expr.    
-00001790: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-000017a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000017b0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-000017c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000017d0: 2020 2020 2020 6578 7072 2e4d 6574 686f        expr.Metho
-000017e0: 644f 7065 7261 746f 7241 6c69 676e 280a  dOperatorAlign(.
-000017f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001800: 2020 2020 2020 2020 6f70 3d6e 616d 652c          op=name,
-00001810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001820: 2020 2020 2020 2020 2066 7261 6d65 3d66           frame=f
-00001830: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
-00001840: 2020 2020 2020 2020 2020 2020 2020 6f74                ot
-00001850: 6865 723d 6f74 6865 722c 0a20 2020 2020  her=other,.     
+000000a0: 2066 756e 6374 6f6f 6c73 2069 6d70 6f72   functools impor
+000000b0: 7420 7772 6170 730a 6672 6f6d 206e 756d  t wraps.from num
+000000c0: 6265 7273 2069 6d70 6f72 7420 496e 7465  bers import Inte
+000000d0: 6772 616c 2c20 4e75 6d62 6572 0a66 726f  gral, Number.fro
+000000e0: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+000000f0: 416e 792c 2043 6c61 7373 5661 722c 2049  Any, ClassVar, I
+00000100: 7465 7261 626c 652c 204c 6974 6572 616c  terable, Literal
+00000110: 0a0a 696d 706f 7274 2064 6173 6b2e 6172  ..import dask.ar
+00000120: 7261 7920 6173 2064 610a 696d 706f 7274  ray as da.import
+00000130: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00000140: 6d65 7468 6f64 7320 6173 206d 6574 686f  methods as metho
+00000150: 6473 0a69 6d70 6f72 7420 6e75 6d70 7920  ds.import numpy 
+00000160: 6173 206e 700a 696d 706f 7274 2070 616e  as np.import pan
+00000170: 6461 7320 6173 2070 640a 696d 706f 7274  das as pd.import
+00000180: 2070 7961 7272 6f77 2061 7320 7061 0a66   pyarrow as pa.f
+00000190: 726f 6d20 6461 736b 2069 6d70 6f72 7420  rom dask import 
+000001a0: 636f 6d70 7574 652c 2063 6f6e 6669 672c  compute, config,
+000001b0: 2067 6574 5f61 6e6e 6f74 6174 696f 6e73   get_annotations
+000001c0: 0a66 726f 6d20 6461 736b 2e61 7272 6179  .from dask.array
+000001d0: 2069 6d70 6f72 7420 4172 7261 790a 6672   import Array.fr
+000001e0: 6f6d 2064 6173 6b2e 6261 7365 2069 6d70  om dask.base imp
+000001f0: 6f72 7420 4461 736b 4d65 7468 6f64 734d  ort DaskMethodsM
+00000200: 6978 696e 2c20 6973 5f64 6173 6b5f 636f  ixin, is_dask_co
+00000210: 6c6c 6563 7469 6f6e 2c20 6e61 6d65 645f  llection, named_
+00000220: 7363 6865 6475 6c65 7273 0a66 726f 6d20  schedulers.from 
+00000230: 6461 736b 2e63 6f72 6520 696d 706f 7274  dask.core import
+00000240: 2066 6c61 7474 656e 0a66 726f 6d20 6461   flatten.from da
+00000250: 736b 2e64 6174 6166 7261 6d65 2e5f 636f  sk.dataframe._co
+00000260: 6d70 6174 2069 6d70 6f72 7420 5041 4e44  mpat import PAND
+00000270: 4153 5f47 455f 3231 302c 2050 414e 4441  AS_GE_210, PANDA
+00000280: 535f 4745 5f32 3230 2c20 5041 4e44 4153  S_GE_220, PANDAS
+00000290: 5f56 4552 5349 4f4e 0a66 726f 6d20 6461  _VERSION.from da
+000002a0: 736b 2e64 6174 6166 7261 6d65 2e61 6363  sk.dataframe.acc
+000002b0: 6573 736f 7220 696d 706f 7274 2043 6163  essor import Cac
+000002c0: 6865 6441 6363 6573 736f 720a 6672 6f6d  hedAccessor.from
+000002d0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+000002e0: 636f 7265 2069 6d70 6f72 7420 280a 2020  core import (.  
+000002f0: 2020 5f63 6f6e 6361 742c 0a20 2020 205f    _concat,.    _
+00000300: 636f 6e76 6572 745f 746f 5f6e 756d 6572  convert_to_numer
+00000310: 6963 2c0a 2020 2020 5f46 7261 6d65 2c0a  ic,.    _Frame,.
+00000320: 2020 2020 5f72 6570 725f 6461 7461 5f73      _repr_data_s
+00000330: 6572 6965 732c 0a20 2020 205f 7371 7274  eries,.    _sqrt
+00000340: 5f61 6e64 5f63 6f6e 7665 7274 5f74 6f5f  _and_convert_to_
+00000350: 7469 6d65 6465 6c74 612c 0a20 2020 2063  timedelta,.    c
+00000360: 6865 636b 5f64 6976 6973 696f 6e73 2c0a  heck_divisions,.
+00000370: 2020 2020 6861 735f 7061 7261 6c6c 656c      has_parallel
+00000380: 5f74 7970 652c 0a20 2020 2069 735f 6172  _type,.    is_ar
+00000390: 7261 796c 696b 652c 0a20 2020 2069 735f  raylike,.    is_
+000003a0: 6461 7461 6672 616d 655f 6c69 6b65 2c0a  dataframe_like,.
+000003b0: 2020 2020 6973 5f73 6572 6965 735f 6c69      is_series_li
+000003c0: 6b65 2c0a 2020 2020 6d65 7461 5f77 6172  ke,.    meta_war
+000003d0: 6e69 6e67 2c0a 2020 2020 6e65 775f 6464  ning,.    new_dd
+000003e0: 5f6f 626a 6563 742c 0a29 0a66 726f 6d20  _object,.).from 
+000003f0: 6461 736b 2e64 6174 6166 7261 6d65 2e64  dask.dataframe.d
+00000400: 6973 7061 7463 6820 696d 706f 7274 2069  ispatch import i
+00000410: 735f 6361 7465 676f 7269 6361 6c5f 6474  s_categorical_dt
+00000420: 7970 652c 206d 616b 655f 6d65 7461 2c20  ype, make_meta, 
+00000430: 6d65 7461 5f6e 6f6e 656d 7074 790a 6672  meta_nonempty.fr
+00000440: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00000450: 652e 6d75 6c74 6920 696d 706f 7274 2077  e.multi import w
+00000460: 6172 6e5f 6474 7970 655f 6d69 736d 6174  arn_dtype_mismat
+00000470: 6368 0a66 726f 6d20 6461 736b 2e64 6174  ch.from dask.dat
+00000480: 6166 7261 6d65 2e75 7469 6c73 2069 6d70  aframe.utils imp
+00000490: 6f72 7420 280a 2020 2020 4174 7472 6962  ort (.    Attrib
+000004a0: 7574 654e 6f74 496d 706c 656d 656e 7465  uteNotImplemente
+000004b0: 6445 7272 6f72 2c0a 2020 2020 6861 735f  dError,.    has_
+000004c0: 6b6e 6f77 6e5f 6361 7465 676f 7269 6573  known_categories
+000004d0: 2c0a 2020 2020 696e 6465 785f 7375 6d6d  ,.    index_summ
+000004e0: 6172 792c 0a20 2020 2069 6e73 6572 745f  ary,.    insert_
+000004f0: 6d65 7461 5f70 6172 616d 5f64 6573 6372  meta_param_descr
+00000500: 6970 7469 6f6e 2c0a 2020 2020 6d65 7461  iption,.    meta
+00000510: 5f66 7261 6d65 5f63 6f6e 7374 7275 6374  _frame_construct
+00000520: 6f72 2c0a 2020 2020 6d65 7461 5f73 6572  or,.    meta_ser
+00000530: 6965 735f 636f 6e73 7472 7563 746f 722c  ies_constructor,
+00000540: 0a20 2020 2070 7961 7272 6f77 5f73 7472  .    pyarrow_str
+00000550: 696e 6773 5f65 6e61 626c 6564 2c0a 290a  ings_enabled,.).
+00000560: 6672 6f6d 2064 6173 6b2e 6465 6c61 7965  from dask.delaye
+00000570: 6420 696d 706f 7274 2064 656c 6179 6564  d import delayed
+00000580: 0a66 726f 6d20 6461 736b 2e75 7469 6c73  .from dask.utils
+00000590: 2069 6d70 6f72 7420 280a 2020 2020 496e   import (.    In
+000005a0: 6465 7843 616c 6c61 626c 652c 0a20 2020  dexCallable,.   
+000005b0: 204d 2c0a 2020 2020 6465 7269 7665 645f   M,.    derived_
+000005c0: 6672 6f6d 2c0a 2020 2020 6765 745f 6465  from,.    get_de
+000005d0: 6661 756c 745f 7368 7566 666c 655f 6d65  fault_shuffle_me
+000005e0: 7468 6f64 2c0a 2020 2020 6765 745f 6d65  thod,.    get_me
+000005f0: 7461 5f6c 6962 7261 7279 2c0a 2020 2020  ta_library,.    
+00000600: 6b65 795f 7370 6c69 742c 0a20 2020 206d  key_split,.    m
+00000610: 6179 6265 5f70 6c75 7261 6c69 7a65 2c0a  aybe_pluralize,.
+00000620: 2020 2020 6d65 6d6f 7279 5f72 6570 722c      memory_repr,
+00000630: 0a20 2020 2070 7574 5f6c 696e 6573 2c0a  .    put_lines,.
+00000640: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00000650: 5f64 6174 612c 0a20 2020 2074 7970 656e  _data,.    typen
+00000660: 616d 652c 0a29 0a66 726f 6d20 6461 736b  ame,.).from dask
+00000670: 2e77 6964 6765 7473 2069 6d70 6f72 7420  .widgets import 
+00000680: 6765 745f 7465 6d70 6c61 7465 0a66 726f  get_template.fro
+00000690: 6d20 6673 7370 6563 2e75 7469 6c73 2069  m fsspec.utils i
+000006a0: 6d70 6f72 7420 7374 7269 6e67 6966 795f  mport stringify_
+000006b0: 7061 7468 0a66 726f 6d20 7061 636b 6167  path.from packag
+000006c0: 696e 672e 7665 7273 696f 6e20 696d 706f  ing.version impo
+000006d0: 7274 2070 6172 7365 2061 7320 7061 7273  rt parse as pars
+000006e0: 655f 7665 7273 696f 6e0a 6672 6f6d 2070  e_version.from p
+000006f0: 616e 6461 7320 696d 706f 7274 2043 6174  andas import Cat
+00000700: 6567 6f72 6963 616c 4474 7970 650a 6672  egoricalDtype.fr
+00000710: 6f6d 2070 616e 6461 732e 6170 692e 7479  om pandas.api.ty
+00000720: 7065 7320 696d 706f 7274 2069 735f 626f  pes import is_bo
+00000730: 6f6c 5f64 7479 7065 2c20 6973 5f64 6174  ol_dtype, is_dat
+00000740: 6574 696d 6536 345f 616e 795f 6474 7970  etime64_any_dtyp
+00000750: 652c 2069 735f 6e75 6d65 7269 635f 6474  e, is_numeric_dt
+00000760: 7970 650a 6672 6f6d 2070 616e 6461 732e  ype.from pandas.
+00000770: 6170 692e 7479 7065 7320 696d 706f 7274  api.types import
+00000780: 2069 735f 7363 616c 6172 2061 7320 7064   is_scalar as pd
+00000790: 5f69 735f 7363 616c 6172 0a66 726f 6d20  _is_scalar.from 
+000007a0: 7061 6e64 6173 2e61 7069 2e74 7970 6573  pandas.api.types
+000007b0: 2069 6d70 6f72 7420 6973 5f74 696d 6564   import is_timed
+000007c0: 656c 7461 3634 5f64 7479 7065 0a66 726f  elta64_dtype.fro
+000007d0: 6d20 7079 6172 726f 7720 696d 706f 7274  m pyarrow import
+000007e0: 2066 7320 6173 2070 615f 6673 0a66 726f   fs as pa_fs.fro
+000007f0: 6d20 746c 7a20 696d 706f 7274 2066 6972  m tlz import fir
+00000800: 7374 0a0a 696d 706f 7274 2064 6173 6b5f  st..import dask_
+00000810: 6578 7072 2e5f 6261 636b 656e 6473 2020  expr._backends  
+00000820: 2320 6e6f 7161 3a20 4634 3031 0a66 726f  # noqa: F401.fro
+00000830: 6d20 6461 736b 5f65 7870 7220 696d 706f  m dask_expr impo
+00000840: 7274 205f 6578 7072 2061 7320 6578 7072  rt _expr as expr
+00000850: 0a66 726f 6d20 6461 736b 5f65 7870 722e  .from dask_expr.
+00000860: 5f62 6163 6b65 6e64 7320 696d 706f 7274  _backends import
+00000870: 2064 6174 6166 7261 6d65 5f63 7265 6174   dataframe_creat
+00000880: 696f 6e5f 6469 7370 6174 6368 0a66 726f  ion_dispatch.fro
+00000890: 6d20 6461 736b 5f65 7870 722e 5f63 6174  m dask_expr._cat
+000008a0: 6567 6f72 6963 616c 2069 6d70 6f72 7420  egorical import 
+000008b0: 4361 7465 676f 7269 6361 6c41 6363 6573  CategoricalAcces
+000008c0: 736f 722c 2043 6174 6567 6f72 697a 652c  sor, Categorize,
+000008d0: 2047 6574 4361 7465 676f 7269 6573 0a66   GetCategories.f
+000008e0: 726f 6d20 6461 736b 5f65 7870 722e 5f63  rom dask_expr._c
+000008f0: 6f6e 6361 7420 696d 706f 7274 2043 6f6e  oncat import Con
+00000900: 6361 740a 6672 6f6d 2064 6173 6b5f 6578  cat.from dask_ex
+00000910: 7072 2e5f 636f 7265 2069 6d70 6f72 7420  pr._core import 
+00000920: 4f70 7469 6d69 7a65 7253 7461 6765 0a66  OptimizerStage.f
+00000930: 726f 6d20 6461 736b 5f65 7870 722e 5f64  rom dask_expr._d
+00000940: 6174 6574 696d 6520 696d 706f 7274 2044  atetime import D
+00000950: 6174 6574 696d 6541 6363 6573 736f 720a  atetimeAccessor.
+00000960: 6672 6f6d 2064 6173 6b5f 6578 7072 2e5f  from dask_expr._
+00000970: 6465 7363 7269 6265 2069 6d70 6f72 7420  describe import 
+00000980: 4465 7363 7269 6265 4e6f 6e4e 756d 6572  DescribeNonNumer
+00000990: 6963 2c20 4465 7363 7269 6265 4e75 6d65  ic, DescribeNume
+000009a0: 7269 630a 6672 6f6d 2064 6173 6b5f 6578  ric.from dask_ex
+000009b0: 7072 2e5f 6469 7370 6174 6368 2069 6d70  pr._dispatch imp
+000009c0: 6f72 7420 6765 745f 636f 6c6c 6563 7469  ort get_collecti
+000009d0: 6f6e 5f74 7970 650a 6672 6f6d 2064 6173  on_type.from das
+000009e0: 6b5f 6578 7072 2e5f 6578 7072 2069 6d70  k_expr._expr imp
+000009f0: 6f72 7420 280a 2020 2020 4246 696c 6c2c  ort (.    BFill,
+00000a00: 0a20 2020 2044 6966 662c 0a20 2020 2045  .    Diff,.    E
+00000a10: 7661 6c2c 0a20 2020 2046 4669 6c6c 2c0a  val,.    FFill,.
+00000a20: 2020 2020 4669 6c6c 6e61 4368 6563 6b2c      FillnaCheck,
+00000a30: 0a20 2020 2051 7565 7279 2c0a 2020 2020  .    Query,.    
+00000a40: 5368 6966 742c 0a20 2020 2054 6f44 6174  Shift,.    ToDat
+00000a50: 6574 696d 652c 0a20 2020 2054 6f4e 756d  etime,.    ToNum
+00000a60: 6572 6963 2c0a 2020 2020 546f 5469 6d65  eric,.    ToTime
+00000a70: 6465 6c74 612c 0a20 2020 206e 6f5f 6465  delta,.    no_de
+00000a80: 6661 756c 742c 0a29 0a66 726f 6d20 6461  fault,.).from da
+00000a90: 736b 5f65 7870 722e 5f6d 6572 6765 2069  sk_expr._merge i
+00000aa0: 6d70 6f72 7420 4a6f 696e 5265 6375 7273  mport JoinRecurs
+00000ab0: 6976 652c 204d 6572 6765 0a66 726f 6d20  ive, Merge.from 
+00000ac0: 6461 736b 5f65 7870 722e 5f71 7561 6e74  dask_expr._quant
+00000ad0: 696c 6520 696d 706f 7274 2053 6572 6965  ile import Serie
+00000ae0: 7351 7561 6e74 696c 650a 6672 6f6d 2064  sQuantile.from d
+00000af0: 6173 6b5f 6578 7072 2e5f 7175 616e 7469  ask_expr._quanti
+00000b00: 6c65 7320 696d 706f 7274 2052 6570 6172  les import Repar
+00000b10: 7469 7469 6f6e 5175 616e 7469 6c65 730a  titionQuantiles.
+00000b20: 6672 6f6d 2064 6173 6b5f 6578 7072 2e5f  from dask_expr._
+00000b30: 7265 6475 6374 696f 6e73 2069 6d70 6f72  reductions impor
+00000b40: 7420 280a 2020 2020 436f 7272 2c0a 2020  t (.    Corr,.  
+00000b50: 2020 436f 762c 0a20 2020 2043 7573 746f    Cov,.    Custo
+00000b60: 6d52 6564 7563 7469 6f6e 2c0a 2020 2020  mReduction,.    
+00000b70: 4472 6f70 4475 706c 6963 6174 6573 2c0a  DropDuplicates,.
+00000b80: 2020 2020 496e 6465 7843 6f75 6e74 2c0a      IndexCount,.
+00000b90: 2020 2020 4973 4d6f 6e6f 746f 6e69 6344      IsMonotonicD
+00000ba0: 6563 7265 6173 696e 672c 0a20 2020 2049  ecreasing,.    I
+00000bb0: 734d 6f6e 6f74 6f6e 6963 496e 6372 6561  sMonotonicIncrea
+00000bc0: 7369 6e67 2c0a 2020 2020 4c65 6e2c 0a20  sing,.    Len,. 
+00000bd0: 2020 204d 656d 6f72 7955 7361 6765 4672     MemoryUsageFr
+00000be0: 616d 652c 0a20 2020 204d 656d 6f72 7955  ame,.    MemoryU
+00000bf0: 7361 6765 496e 6465 782c 0a20 2020 204d  sageIndex,.    M
+00000c00: 6f6d 656e 742c 0a20 2020 204e 4c61 7267  oment,.    NLarg
+00000c10: 6573 742c 0a20 2020 204e 536d 616c 6c65  est,.    NSmalle
+00000c20: 7374 2c0a 2020 2020 5069 766f 7454 6162  st,.    PivotTab
+00000c30: 6c65 2c0a 2020 2020 556e 6971 7565 2c0a  le,.    Unique,.
+00000c40: 2020 2020 5661 6c75 6543 6f75 6e74 732c      ValueCounts,
+00000c50: 0a29 0a66 726f 6d20 6461 736b 5f65 7870  .).from dask_exp
+00000c60: 722e 5f72 6570 6172 7469 7469 6f6e 2069  r._repartition i
+00000c70: 6d70 6f72 7420 5265 7061 7274 6974 696f  mport Repartitio
+00000c80: 6e2c 2052 6570 6172 7469 7469 6f6e 4672  n, RepartitionFr
+00000c90: 6571 0a66 726f 6d20 6461 736b 5f65 7870  eq.from dask_exp
+00000ca0: 722e 5f73 6875 6666 6c65 2069 6d70 6f72  r._shuffle impor
+00000cb0: 7420 280a 2020 2020 5265 6172 7261 6e67  t (.    Rearrang
+00000cc0: 6542 7943 6f6c 756d 6e2c 0a20 2020 2053  eByColumn,.    S
+00000cd0: 6574 496e 6465 782c 0a20 2020 2053 6574  etIndex,.    Set
+00000ce0: 496e 6465 7842 6c6f 636b 7769 7365 2c0a  IndexBlockwise,.
+00000cf0: 2020 2020 536f 7274 5661 6c75 6573 2c0a      SortValues,.
+00000d00: 290a 6672 6f6d 2064 6173 6b5f 6578 7072  ).from dask_expr
+00000d10: 2e5f 7374 725f 6163 6365 7373 6f72 2069  ._str_accessor i
+00000d20: 6d70 6f72 7420 5374 7269 6e67 4163 6365  mport StringAcce
+00000d30: 7373 6f72 0a66 726f 6d20 6461 736b 5f65  ssor.from dask_e
+00000d40: 7870 722e 5f75 7469 6c20 696d 706f 7274  xpr._util import
+00000d50: 2028 0a20 2020 205f 4261 636b 656e 6444   (.    _BackendD
+00000d60: 6174 612c 0a20 2020 205f 636f 6e76 6572  ata,.    _conver
+00000d70: 745f 746f 5f6c 6973 742c 0a20 2020 205f  t_to_list,.    _
+00000d80: 6765 745f 7368 7566 666c 655f 7072 6566  get_shuffle_pref
+00000d90: 6572 7269 6e67 5f6f 7264 6572 2c0a 2020  erring_order,.  
+00000da0: 2020 5f69 735f 616e 795f 7265 616c 5f6e    _is_any_real_n
+00000db0: 756d 6572 6963 5f64 7479 7065 2c0a 2020  umeric_dtype,.  
+00000dc0: 2020 5f6d 6179 6265 5f66 726f 6d5f 7061    _maybe_from_pa
+00000dd0: 6e64 6173 2c0a 2020 2020 5f72 6169 7365  ndas,.    _raise
+00000de0: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
+00000df0: 732c 0a20 2020 205f 746f 6b65 6e69 7a65  s,.    _tokenize
+00000e00: 5f64 6574 6572 6d69 6e69 7374 6963 2c0a  _deterministic,.
+00000e10: 2020 2020 5f76 616c 6964 6174 655f 6178      _validate_ax
+00000e20: 6973 2c0a 2020 2020 6765 745f 7370 6563  is,.    get_spec
+00000e30: 6966 6965 645f 7368 7566 666c 652c 0a20  ified_shuffle,. 
+00000e40: 2020 2069 735f 7363 616c 6172 2c0a 290a     is_scalar,.).
+00000e50: 6672 6f6d 2064 6173 6b5f 6578 7072 2e69  from dask_expr.i
+00000e60: 6f20 696d 706f 7274 2046 726f 6d50 616e  o import FromPan
+00000e70: 6461 7344 6976 6973 696f 6e73 2c20 4672  dasDivisions, Fr
+00000e80: 6f6d 5363 616c 6172 730a 0a23 0a23 2055  omScalars..#.# U
+00000e90: 7469 6c69 7469 6573 2074 6f20 7772 6170  tilities to wrap
+00000ea0: 2045 7870 7220 4150 490a 2320 2848 656c   Expr API.# (Hel
+00000eb0: 7073 206c 696d 6974 2062 6f69 6c65 722d  ps limit boiler-
+00000ec0: 706c 6174 6520 636f 6465 2069 6e20 636f  plate code in co
+00000ed0: 6c6c 6563 7469 6f6e 2041 5049 7329 0a23  llection APIs).#
+00000ee0: 0a0a 0a64 6566 205f 7772 6170 5f65 7870  ...def _wrap_exp
+00000ef0: 725f 6170 6928 2a61 7267 732c 2077 7261  r_api(*args, wra
+00000f00: 705f 6170 693d 4e6f 6e65 2c20 2a2a 6b77  p_api=None, **kw
+00000f10: 6172 6773 293a 0a20 2020 2023 2055 7365  args):.    # Use
+00000f20: 2045 7870 7220 4150 492c 2062 7574 2063   Expr API, but c
+00000f30: 6f6e 7665 7274 2074 6f2f 6672 6f6d 2045  onvert to/from E
+00000f40: 7870 7220 6f62 6a65 6374 730a 2020 2020  xpr objects.    
+00000f50: 6173 7365 7274 2077 7261 705f 6170 6920  assert wrap_api 
+00000f60: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00000f70: 7265 7375 6c74 203d 2077 7261 705f 6170  result = wrap_ap
+00000f80: 6928 0a20 2020 2020 2020 202a 5b61 7267  i(.        *[arg
+00000f90: 2e65 7870 7220 6966 2069 7369 6e73 7461  .expr if isinsta
+00000fa0: 6e63 6528 6172 672c 2046 7261 6d65 4261  nce(arg, FrameBa
+00000fb0: 7365 2920 656c 7365 2061 7267 2066 6f72  se) else arg for
+00000fc0: 2061 7267 2069 6e20 6172 6773 5d2c 0a20   arg in args],. 
+00000fd0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+00000fe0: 0a20 2020 2029 0a20 2020 2069 6620 6973  .    ).    if is
+00000ff0: 696e 7374 616e 6365 2872 6573 756c 742c  instance(result,
+00001000: 2065 7870 722e 4578 7072 293a 0a20 2020   expr.Expr):.   
+00001010: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00001020: 636f 6c6c 6563 7469 6f6e 2872 6573 756c  collection(resul
+00001030: 7429 0a20 2020 2072 6574 7572 6e20 7265  t).    return re
+00001040: 7375 6c74 0a0a 0a64 6566 205f 7772 6170  sult...def _wrap
+00001050: 5f65 7870 725f 6f70 2873 656c 662c 206f  _expr_op(self, o
+00001060: 7468 6572 2c20 6f70 3d4e 6f6e 6529 3a0a  ther, op=None):.
+00001070: 2020 2020 2320 5772 6170 2065 7870 7220      # Wrap expr 
+00001080: 6f70 6572 6174 6f72 0a20 2020 2061 7373  operator.    ass
+00001090: 6572 7420 6f70 2069 7320 6e6f 7420 4e6f  ert op is not No
+000010a0: 6e65 0a20 2020 2069 6620 6973 696e 7374  ne.    if isinst
+000010b0: 616e 6365 286f 7468 6572 2c20 4672 616d  ance(other, Fram
+000010c0: 6542 6173 6529 3a0a 2020 2020 2020 2020  eBase):.        
+000010d0: 6f74 6865 7220 3d20 6f74 6865 722e 6578  other = other.ex
+000010e0: 7072 0a20 2020 2065 6c69 6620 6973 696e  pr.    elif isin
+000010f0: 7374 616e 6365 286f 7468 6572 2c20 6461  stance(other, da
+00001100: 2e41 7272 6179 293a 0a20 2020 2020 2020  .Array):.       
+00001110: 206f 7468 6572 203d 2066 726f 6d5f 6461   other = from_da
+00001120: 736b 5f61 7272 6179 280a 2020 2020 2020  sk_array(.      
+00001130: 2020 2020 2020 6f74 6865 722c 2069 6e64        other, ind
+00001140: 6578 3d73 656c 662e 696e 6465 782e 746f  ex=self.index.to
+00001150: 5f6c 6567 6163 795f 6461 7461 6672 616d  _legacy_datafram
+00001160: 6528 292c 2063 6f6c 756d 6e73 3d73 656c  e(), columns=sel
+00001170: 662e 636f 6c75 6d6e 730a 2020 2020 2020  f.columns.      
+00001180: 2020 290a 2020 2020 2020 2020 6966 2073    ).        if s
+00001190: 656c 662e 6e64 696d 203d 3d20 3120 616e  elf.ndim == 1 an
+000011a0: 6420 6c65 6e28 7365 6c66 2e63 6f6c 756d  d len(self.colum
+000011b0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+000011c0: 206f 7468 6572 203d 206f 7468 6572 5b73   other = other[s
+000011d0: 656c 662e 636f 6c75 6d6e 735b 305d 5d0a  elf.columns[0]].
+000011e0: 0a20 2020 2069 6620 280a 2020 2020 2020  .    if (.      
+000011f0: 2020 6e6f 7420 6973 696e 7374 616e 6365    not isinstance
+00001200: 286f 7468 6572 2c20 6578 7072 2e45 7870  (other, expr.Exp
+00001210: 7229 0a20 2020 2020 2020 2061 6e64 2069  r).        and i
+00001220: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
+00001230: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
+00001240: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
+00001250: 6528 6f74 6865 7229 0a20 2020 2029 3a0a  e(other).    ):.
+00001260: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
+00001270: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
+00001280: 676e 6162 6c65 5f66 7261 6d65 286f 7468  gnable_frame(oth
+00001290: 6572 292e 6578 7072 0a0a 2020 2020 6966  er).expr..    if
+000012a0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000012b0: 6f74 6865 722c 2065 7870 722e 4578 7072  other, expr.Expr
+000012c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000012d0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+000012e0: 2867 6574 6174 7472 2873 656c 662e 6578  (getattr(self.ex
+000012f0: 7072 2c20 6f70 2928 6f74 6865 7229 290a  pr, op)(other)).
+00001300: 2020 2020 656c 6966 2065 7870 722e 6172      elif expr.ar
+00001310: 655f 636f 5f61 6c69 676e 6564 2873 656c  e_co_aligned(sel
+00001320: 662e 6578 7072 2c20 6f74 6865 7229 3a0a  f.expr, other):.
+00001330: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00001340: 6577 5f63 6f6c 6c65 6374 696f 6e28 6765  ew_collection(ge
+00001350: 7461 7474 7228 7365 6c66 2e65 7870 722c  tattr(self.expr,
+00001360: 206f 7029 286f 7468 6572 2929 0a20 2020   op)(other)).   
+00001370: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+00001380: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00001390: 7469 6f6e 2865 7870 722e 4f70 416c 6967  tion(expr.OpAlig
+000013a0: 6e50 6172 7469 7469 6f6e 7328 7365 6c66  nPartitions(self
+000013b0: 2c20 6f74 6865 722c 206f 7029 290a 0a0a  , other, op))...
+000013c0: 6465 6620 5f77 7261 705f 6578 7072 5f6d  def _wrap_expr_m
+000013d0: 6574 686f 645f 6f70 6572 6174 6f72 286e  ethod_operator(n
+000013e0: 616d 652c 2063 6c61 7373 5f29 3a0a 2020  ame, class_):.  
+000013f0: 2020 2222 220a 2020 2020 4164 6420 6d65    """.    Add me
+00001400: 7468 6f64 206f 7065 7261 746f 7273 2074  thod operators t
+00001410: 6f20 5365 7269 6573 206f 7220 4461 7461  o Series or Data
+00001420: 4672 616d 6520 6c69 6b65 2044 6174 6146  Frame like DataF
+00001430: 7261 6d65 2e61 6464 2e0a 2020 2020 5f77  rame.add..    _w
+00001440: 7261 705f 6578 7072 5f6d 6574 686f 645f  rap_expr_method_
+00001450: 6f70 6572 6174 6f72 2822 6164 6422 2c20  operator("add", 
+00001460: 4461 7461 4672 616d 6529 0a20 2020 2022  DataFrame).    "
+00001470: 2222 0a20 2020 2069 6620 636c 6173 735f  "".    if class_
+00001480: 203d 3d20 4461 7461 4672 616d 653a 0a0a   == DataFrame:..
+00001490: 2020 2020 2020 2020 6465 6620 6d65 7468          def meth
+000014a0: 6f64 2873 656c 662c 206f 7468 6572 2c20  od(self, other, 
+000014b0: 6178 6973 3d22 636f 6c75 6d6e 7322 2c20  axis="columns", 
+000014c0: 6c65 7665 6c3d 4e6f 6e65 2c20 6669 6c6c  level=None, fill
+000014d0: 5f76 616c 7565 3d4e 6f6e 6529 3a0a 2020  _value=None):.  
+000014e0: 2020 2020 2020 2020 2020 6966 206c 6576            if lev
+000014f0: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
+00001500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001510: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00001520: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
+00001530: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
+00001540: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
+00001550: 7320 3d20 5f76 616c 6964 6174 655f 6178  s = _validate_ax
+00001560: 6973 2861 7869 7329 0a0a 2020 2020 2020  is(axis)..      
+00001570: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+00001580: 2020 2020 2020 2020 2020 2069 735f 6461             is_da
+00001590: 7461 6672 616d 655f 6c69 6b65 286f 7468  taframe_like(oth
+000015a0: 6572 290a 2020 2020 2020 2020 2020 2020  er).            
+000015b0: 2020 2020 6f72 2069 735f 7365 7269 6573      or is_series
+000015c0: 5f6c 696b 6528 6f74 6865 7229 0a20 2020  _like(other).   
+000015d0: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+000015e0: 2061 7869 7320 696e 2028 302c 2022 696e   axis in (0, "in
+000015f0: 6465 7822 290a 2020 2020 2020 2020 2020  dex").          
+00001600: 2020 2920 616e 6420 6e6f 7420 6973 5f64    ) and not is_d
+00001610: 6173 6b5f 636f 6c6c 6563 7469 6f6e 286f  ask_collection(o
+00001620: 7468 6572 293a 0a20 2020 2020 2020 2020  ther):.         
+00001630: 2020 2020 2020 206f 7468 6572 203d 2073         other = s
+00001640: 656c 662e 5f63 7265 6174 655f 616c 6967  elf._create_alig
+00001650: 6e61 626c 655f 6672 616d 6528 6f74 6865  nable_frame(othe
+00001660: 7229 0a0a 2020 2020 2020 2020 2020 2020  r)..            
+00001670: 6966 2061 7869 7320 696e 2028 312c 2022  if axis in (1, "
+00001680: 636f 6c75 6d6e 7322 293a 0a20 2020 2020  columns"):.     
+00001690: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000016a0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+000016b0: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+000016c0: 2020 2020 2020 2020 2020 2020 206d 7367               msg
+000016d0: 203d 2066 2255 6e61 626c 6520 746f 207b   = f"Unable to {
+000016e0: 6e61 6d65 7d20 6464 2e53 6572 6965 7320  name} dd.Series 
+000016f0: 7769 7468 2061 7869 733d 3122 0a20 2020  with axis=1".   
+00001700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001710: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00001720: 7228 6d73 6729 0a0a 2020 2020 2020 2020  r(msg)..        
+00001730: 2020 2020 6672 616d 6520 3d20 7365 6c66      frame = self
+00001740: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00001750: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+00001760: 2c20 4672 616d 6542 6173 6529 2061 6e64  , FrameBase) and
+00001770: 206e 6f74 2065 7870 722e 6172 655f 636f   not expr.are_co
+00001780: 5f61 6c69 676e 6564 280a 2020 2020 2020  _aligned(.      
+00001790: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+000017a0: 7870 722c 206f 7468 6572 2e65 7870 720a  xpr, other.expr.
+000017b0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+000017c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000017d0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+000017e0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+000017f0: 2020 2020 2020 2020 2020 6578 7072 2e4d            expr.M
+00001800: 6574 686f 644f 7065 7261 746f 7241 6c69  ethodOperatorAli
+00001810: 676e 280a 2020 2020 2020 2020 2020 2020  gn(.            
+00001820: 2020 2020 2020 2020 2020 2020 6f70 3d6e              op=n
+00001830: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00001840: 2020 2020 2020 2020 2020 2020 2066 7261               fra
+00001850: 6d65 3d66 7261 6d65 2c0a 2020 2020 2020  me=frame,.      
 00001860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001870: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00001870: 2020 6f74 6865 723d 6f74 6865 722c 0a20    other=other,. 
 00001880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001890: 2020 2020 2020 6c65 7665 6c3d 6c65 7665        level=leve
-000018a0: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-000018b0: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
-000018c0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-000018d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000018e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000018f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00001900: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00001910: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-00001920: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00001930: 7072 2e4d 6574 686f 644f 7065 7261 746f  pr.MethodOperato
-00001940: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00001950: 2020 2020 2020 206e 616d 653d 6e61 6d65         name=name
-00001960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001970: 2020 2020 2020 6c65 6674 3d66 7261 6d65        left=frame
-00001980: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001990: 2020 2020 2020 7269 6768 743d 6f74 6865        right=othe
-000019a0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-000019b0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-000019c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000019d0: 2020 2020 2020 6c65 7665 6c3d 6c65 7665        level=leve
-000019e0: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-000019f0: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
-00001a00: 653d 6669 6c6c 5f76 616c 7565 2c0a 2020  e=fill_value,.  
-00001a10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00001a20: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00001a30: 2020 2065 6c69 6620 636c 6173 735f 203d     elif class_ =
-00001a40: 3d20 5365 7269 6573 3a0a 0a20 2020 2020  = Series:..     
-00001a50: 2020 2064 6566 206d 6574 686f 6428 7365     def method(se
-00001a60: 6c66 2c20 6f74 6865 722c 206c 6576 656c  lf, other, level
-00001a70: 3d4e 6f6e 652c 2066 696c 6c5f 7661 6c75  =None, fill_valu
-00001a80: 653d 4e6f 6e65 2c20 6178 6973 3d30 293a  e=None, axis=0):
-00001a90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00001aa0: 6c65 7665 6c20 6973 206e 6f74 204e 6f6e  level is not Non
-00001ab0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00001ac0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00001ad0: 656d 656e 7465 6445 7272 6f72 2822 6c65  ementedError("le
-00001ae0: 7665 6c20 6d75 7374 2062 6520 4e6f 6e65  vel must be None
-00001af0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00001b00: 6178 6973 203d 205f 7661 6c69 6461 7465  axis = _validate
-00001b10: 5f61 7869 7328 6178 6973 290a 0a20 2020  _axis(axis)..   
-00001b20: 2020 2020 2020 2020 2069 6620 6973 5f73           if is_s
-00001b30: 6572 6965 735f 6c69 6b65 286f 7468 6572  eries_like(other
-00001b40: 2920 616e 6420 6e6f 7420 6973 5f64 6173  ) and not is_das
-00001b50: 6b5f 636f 6c6c 6563 7469 6f6e 286f 7468  k_collection(oth
-00001b60: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
-00001b70: 2020 2020 206f 7468 6572 203d 2073 656c       other = sel
-00001b80: 662e 5f63 7265 6174 655f 616c 6967 6e61  f._create_aligna
-00001b90: 626c 655f 6672 616d 6528 6f74 6865 7229  ble_frame(other)
-00001ba0: 0a0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
-00001bb0: 616d 6520 3d20 7365 6c66 0a20 2020 2020  ame = self.     
-00001bc0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00001bd0: 616e 6365 286f 7468 6572 2c20 4672 616d  ance(other, Fram
-00001be0: 6542 6173 6529 2061 6e64 206e 6f74 2065  eBase) and not e
-00001bf0: 7870 722e 6172 655f 636f 5f61 6c69 676e  xpr.are_co_align
-00001c00: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00001c10: 2020 2020 7365 6c66 2e65 7870 722c 206f      self.expr, o
-00001c20: 7468 6572 2e65 7870 720a 2020 2020 2020  ther.expr.      
-00001c30: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00001c40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00001c50: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-00001c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c70: 2020 2020 6578 7072 2e4d 6574 686f 644f      expr.MethodO
-00001c80: 7065 7261 746f 7241 6c69 676e 280a 2020  peratorAlign(.  
-00001c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ca0: 2020 2020 2020 6f70 3d6e 616d 652c 0a20        op=name,. 
-00001cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001cc0: 2020 2020 2020 2066 7261 6d65 3d66 7261         frame=fra
-00001cd0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00001ce0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-00001cf0: 723d 6f74 6865 722c 0a20 2020 2020 2020  r=other,.       
+00001890: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000018a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000018b0: 2020 2020 2020 2020 2020 6c65 7665 6c3d            level=
+000018c0: 6c65 7665 6c2c 0a20 2020 2020 2020 2020  level,.         
+000018d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000018e0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
+000018f0: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
+00001900: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00001910: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00001920: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00001930: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00001940: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00001950: 2020 6578 7072 2e4d 6574 686f 644f 7065    expr.MethodOpe
+00001960: 7261 746f 7228 0a20 2020 2020 2020 2020  rator(.         
+00001970: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00001980: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00001990: 2020 2020 2020 2020 2020 6c65 6674 3d66            left=f
+000019a0: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
+000019b0: 2020 2020 2020 2020 2020 7269 6768 743d            right=
+000019c0: 6f74 6865 722c 0a20 2020 2020 2020 2020  other,.         
+000019d0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+000019e0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+000019f0: 2020 2020 2020 2020 2020 6c65 7665 6c3d            level=
+00001a00: 6c65 7665 6c2c 0a20 2020 2020 2020 2020  level,.         
+00001a10: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
+00001a20: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+00001a30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00001a40: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00001a50: 290a 0a20 2020 2065 6c69 6620 636c 6173  )..    elif clas
+00001a60: 735f 203d 3d20 5365 7269 6573 3a0a 0a20  s_ == Series:.. 
+00001a70: 2020 2020 2020 2064 6566 206d 6574 686f         def metho
+00001a80: 6428 7365 6c66 2c20 6f74 6865 722c 206c  d(self, other, l
+00001a90: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
+00001aa0: 7661 6c75 653d 4e6f 6e65 2c20 6178 6973  value=None, axis
+00001ab0: 3d30 293a 0a20 2020 2020 2020 2020 2020  =0):.           
+00001ac0: 2069 6620 6c65 7665 6c20 6973 206e 6f74   if level is not
+00001ad0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00001ae0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00001af0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00001b00: 2822 6c65 7665 6c20 6d75 7374 2062 6520  ("level must be 
+00001b10: 4e6f 6e65 2229 0a0a 2020 2020 2020 2020  None")..        
+00001b20: 2020 2020 6178 6973 203d 205f 7661 6c69      axis = _vali
+00001b30: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
+00001b40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00001b50: 6973 5f73 6572 6965 735f 6c69 6b65 286f  is_series_like(o
+00001b60: 7468 6572 2920 616e 6420 6e6f 7420 6973  ther) and not is
+00001b70: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
+00001b80: 286f 7468 6572 293a 0a20 2020 2020 2020  (other):.       
+00001b90: 2020 2020 2020 2020 206f 7468 6572 203d           other =
+00001ba0: 2073 656c 662e 5f63 7265 6174 655f 616c   self._create_al
+00001bb0: 6967 6e61 626c 655f 6672 616d 6528 6f74  ignable_frame(ot
+00001bc0: 6865 7229 0a0a 2020 2020 2020 2020 2020  her)..          
+00001bd0: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
+00001be0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00001bf0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+00001c00: 4672 616d 6542 6173 6529 2061 6e64 206e  FrameBase) and n
+00001c10: 6f74 2065 7870 722e 6172 655f 636f 5f61  ot expr.are_co_a
+00001c20: 6c69 676e 6564 280a 2020 2020 2020 2020  ligned(.        
+00001c30: 2020 2020 2020 2020 7365 6c66 2e65 7870          self.exp
+00001c40: 722c 206f 7468 6572 2e65 7870 720a 2020  r, other.expr.  
+00001c50: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00001c60: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00001c70: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00001c80: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00001c90: 2020 2020 2020 2020 6578 7072 2e4d 6574          expr.Met
+00001ca0: 686f 644f 7065 7261 746f 7241 6c69 676e  hodOperatorAlign
+00001cb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00001cc0: 2020 2020 2020 2020 2020 6f70 3d6e 616d            op=nam
+00001cd0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00001ce0: 2020 2020 2020 2020 2020 2066 7261 6d65             frame
+00001cf0: 3d66 7261 6d65 2c0a 2020 2020 2020 2020  =frame,.        
 00001d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d10: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+00001d10: 6f74 6865 723d 6f74 6865 722c 0a20 2020  other=other,.   
 00001d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d30: 2020 2020 6c65 7665 6c3d 6c65 7665 6c2c      level=level,
-00001d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001d50: 2020 2020 2020 2020 2066 696c 6c5f 7661           fill_va
-00001d60: 6c75 653d 6669 6c6c 5f76 616c 7565 2c0a  lue=fill_value,.
-00001d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00001d90: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00001da0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00001db0: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
-00001dc0: 2020 2020 2020 2020 2020 2020 6578 7072              expr
-00001dd0: 2e4d 6574 686f 644f 7065 7261 746f 7228  .MethodOperator(
-00001de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001df0: 2020 2020 206e 616d 653d 6e61 6d65 2c0a       name=name,.
-00001e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e10: 2020 2020 6c65 6674 3d66 7261 6d65 2c0a      left=frame,.
-00001e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e30: 2020 2020 7269 6768 743d 6f74 6865 722c      right=other,
-00001e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001e50: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-00001e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001e70: 2020 2020 6669 6c6c 5f76 616c 7565 3d66      fill_value=f
-00001e80: 696c 6c5f 7661 6c75 652c 0a20 2020 2020  ill_value,.     
-00001e90: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00001ea0: 6576 656c 3d6c 6576 656c 2c0a 2020 2020  evel=level,.    
-00001eb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00001ec0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00001ed0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-00001ee0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00001ef0: 7465 6445 7272 6f72 2866 2243 616e 6e6f  tedError(f"Canno
-00001f00: 7420 6372 6561 7465 206d 6574 686f 6420  t create method 
-00001f10: 6f70 6572 6174 6f72 2066 6f72 207b 636c  operator for {cl
-00001f20: 6173 735f 3d7d 2229 0a0a 2020 2020 6d65  ass_=}")..    me
-00001f30: 7468 6f64 2e5f 5f6e 616d 655f 5f20 3d20  thod.__name__ = 
-00001f40: 6e61 6d65 0a20 2020 2072 6574 7572 6e20  name.    return 
-00001f50: 6d65 7468 6f64 0a0a 0a64 6566 205f 7772  method...def _wr
-00001f60: 6170 5f75 6e61 7279 5f65 7870 725f 6f70  ap_unary_expr_op
-00001f70: 2873 656c 662c 206f 703d 4e6f 6e65 293a  (self, op=None):
-00001f80: 0a20 2020 2023 2057 7261 7020 6578 7072  .    # Wrap expr
-00001f90: 206f 7065 7261 746f 720a 2020 2020 6173   operator.    as
-00001fa0: 7365 7274 206f 7020 6973 206e 6f74 204e  sert op is not N
-00001fb0: 6f6e 650a 2020 2020 7265 7475 726e 206e  one.    return n
-00001fc0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6765  ew_collection(ge
-00001fd0: 7461 7474 7228 7365 6c66 2e65 7870 722c  tattr(self.expr,
-00001fe0: 206f 7029 2829 290a 0a0a 5f57 4152 4e5f   op)())..._WARN_
-00001ff0: 414e 4e4f 5441 5449 4f4e 5320 3d20 5472  ANNOTATIONS = Tr
-00002000: 7565 0a23 0a23 2043 6f6c 6c65 6374 696f  ue.#.# Collectio
-00002010: 6e20 636c 6173 7365 730a 230a 0a0a 636c  n classes.#...cl
-00002020: 6173 7320 4672 616d 6542 6173 6528 4461  ass FrameBase(Da
-00002030: 736b 4d65 7468 6f64 734d 6978 696e 293a  skMethodsMixin):
-00002040: 0a20 2020 2022 2222 4261 7365 2063 6c61  .    """Base cla
-00002050: 7373 2066 6f72 2045 7870 722d 6261 636b  ss for Expr-back
-00002060: 6564 2043 6f6c 6c65 6374 696f 6e73 2222  ed Collections""
-00002070: 220a 0a20 2020 205f 5f64 6173 6b5f 7363  "..    __dask_sc
-00002080: 6865 6475 6c65 725f 5f20 3d20 7374 6174  heduler__ = stat
-00002090: 6963 6d65 7468 6f64 280a 2020 2020 2020  icmethod(.      
-000020a0: 2020 6e61 6d65 645f 7363 6865 6475 6c65    named_schedule
-000020b0: 7273 2e67 6574 2822 7468 7265 6164 7322  rs.get("threads"
-000020c0: 2c20 6e61 6d65 645f 7363 6865 6475 6c65  , named_schedule
-000020d0: 7273 5b22 7379 6e63 225d 290a 2020 2020  rs["sync"]).    
-000020e0: 290a 2020 2020 5f5f 6461 736b 5f6f 7074  ).    __dask_opt
-000020f0: 696d 697a 655f 5f20 3d20 7374 6174 6963  imize__ = static
-00002100: 6d65 7468 6f64 286c 616d 6264 6120 6473  method(lambda ds
-00002110: 6b2c 206b 6579 732c 202a 2a6b 7761 7267  k, keys, **kwarg
-00002120: 733a 2064 736b 290a 0a20 2020 2064 6566  s: dsk)..    def
-00002130: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00002140: 6578 7072 293a 0a20 2020 2020 2020 2067  expr):.        g
-00002150: 6c6f 6261 6c20 5f57 4152 4e5f 414e 4e4f  lobal _WARN_ANNO
-00002160: 5441 5449 4f4e 530a 2020 2020 2020 2020  TATIONS.        
-00002170: 6966 205f 5741 524e 5f41 4e4e 4f54 4154  if _WARN_ANNOTAT
-00002180: 494f 4e53 2061 6e64 2028 616e 6e6f 7420  IONS and (annot 
-00002190: 3a3d 2067 6574 5f61 6e6e 6f74 6174 696f  := get_annotatio
-000021a0: 6e73 2829 293a 0a20 2020 2020 2020 2020  ns()):.         
-000021b0: 2020 205f 5741 524e 5f41 4e4e 4f54 4154     _WARN_ANNOTAT
-000021c0: 494f 4e53 203d 2046 616c 7365 0a20 2020  IONS = False.   
-000021d0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
-000021e0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
-000021f0: 2020 2020 2020 2020 6622 4461 736b 2061          f"Dask a
-00002200: 6e6e 6f74 6174 696f 6e73 207b 616e 6e6f  nnotations {anno
-00002210: 747d 2064 6574 6563 7465 642e 2041 6e6e  t} detected. Ann
-00002220: 6f74 6174 696f 6e73 2077 696c 6c20 6265  otations will be
-00002230: 2069 676e 6f72 6564 2077 6865 6e20 7573   ignored when us
-00002240: 696e 6720 7175 6572 792d 706c 616e 6e69  ing query-planni
-00002250: 6e67 2e22 0a20 2020 2020 2020 2020 2020  ng.".           
-00002260: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00002270: 5f65 7870 7220 3d20 6578 7072 0a0a 2020  _expr = expr..  
-00002280: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00002290: 6465 6620 6578 7072 2873 656c 6629 202d  def expr(self) -
-000022a0: 3e20 6578 7072 2e45 7870 723a 0a20 2020  > expr.Expr:.   
-000022b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000022c0: 2e5f 6578 7072 0a0a 2020 2020 4070 726f  ._expr..    @pro
-000022d0: 7065 7274 790a 2020 2020 6465 6620 5f6d  perty.    def _m
-000022e0: 6574 6128 7365 6c66 293a 0a20 2020 2020  eta(self):.     
-000022f0: 2020 2072 6574 7572 6e20 7365 6c66 2e65     return self.e
-00002300: 7870 722e 5f6d 6574 610a 0a20 2020 2040  xpr._meta..    @
-00002310: 6675 6e63 746f 6f6c 732e 6361 6368 6564  functools.cached
-00002320: 5f70 726f 7065 7274 790a 2020 2020 6465  _property.    de
-00002330: 6620 5f6d 6574 615f 6e6f 6e65 6d70 7479  f _meta_nonempty
-00002340: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00002350: 7265 7475 726e 206d 6574 615f 6e6f 6e65  return meta_none
-00002360: 6d70 7479 2873 656c 662e 5f6d 6574 6129  mpty(self._meta)
-00002370: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00002380: 2020 2020 6465 6620 6469 7669 7369 6f6e      def division
-00002390: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-000023a0: 2022 2222 0a20 2020 2020 2020 2054 7570   """.        Tup
-000023b0: 6c65 206f 6620 6060 6e70 6172 7469 7469  le of ``npartiti
-000023c0: 6f6e 7320 2b20 3160 6020 7661 6c75 6573  ons + 1`` values
-000023d0: 2c20 696e 2061 7363 656e 6469 6e67 206f  , in ascending o
-000023e0: 7264 6572 2c20 6d61 726b 696e 6720 7468  rder, marking th
-000023f0: 650a 2020 2020 2020 2020 6c6f 7765 722f  e.        lower/
-00002400: 7570 7065 7220 626f 756e 6473 206f 6620  upper bounds of 
-00002410: 6561 6368 2070 6172 7469 7469 6f6e 2773  each partition's
-00002420: 2069 6e64 6578 2e20 4469 7669 7369 6f6e   index. Division
-00002430: 7320 616c 6c6f 7720 4461 736b 0a20 2020  s allow Dask.   
-00002440: 2020 2020 2074 6f20 6b6e 6f77 2077 6869       to know whi
-00002450: 6368 2070 6172 7469 7469 6f6e 2077 696c  ch partition wil
-00002460: 6c20 636f 6e74 6169 6e20 6120 6769 7665  l contain a give
-00002470: 6e20 7661 6c75 652c 2073 6967 6e69 6669  n value, signifi
-00002480: 6361 6e74 6c79 0a20 2020 2020 2020 2073  cantly.        s
-00002490: 7065 6564 696e 6720 7570 206f 7065 7261  peeding up opera
-000024a0: 7469 6f6e 7320 6c69 6b65 2060 6c6f 6360  tions like `loc`
-000024b0: 2c20 606d 6572 6765 602c 2061 6e64 2060  , `merge`, and `
-000024c0: 6772 6f75 7062 7960 2062 7920 6e6f 740a  groupby` by not.
-000024d0: 2020 2020 2020 2020 6861 7669 6e67 2074          having t
-000024e0: 6f20 7365 6172 6368 2074 6865 2066 756c  o search the ful
-000024f0: 6c20 6461 7461 7365 742e 0a0a 2020 2020  l dataset...    
-00002500: 2020 2020 4578 616d 706c 653a 2066 6f72      Example: for
-00002510: 2060 6064 6976 6973 696f 6e73 203d 2028   ``divisions = (
-00002520: 302c 2031 302c 2035 302c 2031 3030 2960  0, 10, 50, 100)`
-00002530: 602c 2074 6865 7265 2061 7265 2074 6872  `, there are thr
-00002540: 6565 2070 6172 7469 7469 6f6e 732c 0a20  ee partitions,. 
-00002550: 2020 2020 2020 2077 6865 7265 2074 6865         where the
-00002560: 2069 6e64 6578 2069 6e20 6561 6368 2070   index in each p
-00002570: 6172 7469 7469 6f6e 2063 6f6e 7461 696e  artition contain
-00002580: 7320 7661 6c75 6573 205b 302c 2031 3029  s values [0, 10)
-00002590: 2c20 5b31 302c 2035 3029 2c0a 2020 2020  , [10, 50),.    
-000025a0: 2020 2020 616e 6420 5b35 302c 2031 3030      and [50, 100
-000025b0: 5d2c 2072 6573 7065 6374 6976 656c 792e  ], respectively.
-000025c0: 2044 6173 6b20 7468 6572 6566 6f72 6520   Dask therefore 
-000025d0: 6b6e 6f77 7320 6060 6466 2e6c 6f63 5b34  knows ``df.loc[4
-000025e0: 355d 6060 0a20 2020 2020 2020 2077 696c  5]``.        wil
-000025f0: 6c20 6265 2069 6e20 7468 6520 7365 636f  l be in the seco
-00002600: 6e64 2070 6172 7469 7469 6f6e 2e0a 0a20  nd partition... 
-00002610: 2020 2020 2020 2057 6865 6e20 6576 6572         When ever
-00002620: 7920 6974 656d 2069 6e20 6060 6469 7669  y item in ``divi
-00002630: 7369 6f6e 7360 6020 6973 2060 604e 6f6e  sions`` is ``Non
-00002640: 6560 602c 2074 6865 2064 6976 6973 696f  e``, the divisio
-00002650: 6e73 2061 7265 2075 6e6b 6e6f 776e 2e0a  ns are unknown..
-00002660: 2020 2020 2020 2020 4d6f 7374 206f 7065          Most ope
-00002670: 7261 7469 6f6e 7320 6361 6e20 7374 696c  rations can stil
-00002680: 6c20 6265 2070 6572 666f 726d 6564 2c20  l be performed, 
-00002690: 6275 7420 736f 6d65 2077 696c 6c20 6265  but some will be
-000026a0: 206d 7563 6820 736c 6f77 6572 2c0a 2020   much slower,.  
-000026b0: 2020 2020 2020 616e 6420 6120 6665 7720        and a few 
-000026c0: 6d61 7920 6661 696c 2e0a 0a20 2020 2020  may fail...     
-000026d0: 2020 2049 7420 6973 206e 6f74 2073 7570     It is not sup
-000026e0: 706f 7274 6564 2074 6f20 7365 7420 6060  ported to set ``
-000026f0: 6469 7669 7369 6f6e 7360 6020 6469 7265  divisions`` dire
-00002700: 6374 6c79 2e20 496e 7374 6561 642c 2075  ctly. Instead, u
-00002710: 7365 2060 6073 6574 5f69 6e64 6578 6060  se ``set_index``
-00002720: 2c0a 2020 2020 2020 2020 7768 6963 6820  ,.        which 
-00002730: 736f 7274 7320 616e 6420 7370 6c69 7473  sorts and splits
-00002740: 2074 6865 2064 6174 6120 6173 206e 6565   the data as nee
-00002750: 6465 642e 0a20 2020 2020 2020 2053 6565  ded..        See
-00002760: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
-00002770: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
-00002780: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
-00002790: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
-000027a0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-000027b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000027c0: 6c66 2e65 7870 722e 6469 7669 7369 6f6e  lf.expr.division
-000027d0: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-000027e0: 0a20 2020 2064 6566 206e 7061 7274 6974  .    def npartit
-000027f0: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
-00002800: 2020 2020 2222 2252 6574 7572 6e20 6e75      """Return nu
-00002810: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
-00002820: 6e73 2222 220a 2020 2020 2020 2020 7265  ns""".        re
-00002830: 7475 726e 2073 656c 662e 6578 7072 2e6e  turn self.expr.n
-00002840: 7061 7274 6974 696f 6e73 0a0a 2020 2020  partitions..    
-00002850: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00002860: 6620 6474 7970 6573 2873 656c 6629 3a0a  f dtypes(self):.
-00002870: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00002880: 6e20 6461 7461 2074 7970 6573 2222 220a  n data types""".
-00002890: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000028a0: 656c 662e 6578 7072 2e5f 6d65 7461 2e64  elf.expr._meta.d
-000028b0: 7479 7065 730a 0a20 2020 2040 7072 6f70  types..    @prop
-000028c0: 6572 7479 0a20 2020 2064 6566 2073 697a  erty.    def siz
-000028d0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000028e0: 2022 2222 5369 7a65 206f 6620 7468 6520   """Size of the 
-000028f0: 5365 7269 6573 206f 7220 4461 7461 4672  Series or DataFr
-00002900: 616d 6520 6173 2061 2044 656c 6179 6564  ame as a Delayed
-00002910: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
-00002920: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-00002930: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00002940: 2020 2020 3e3e 3e20 7365 7269 6573 2e73      >>> series.s
-00002950: 697a 6520 2023 2064 6f63 7465 7374 3a20  ize  # doctest: 
-00002960: 2b53 4b49 500a 2020 2020 2020 2020 3c64  +SKIP.        <d
-00002970: 6173 6b5f 6578 7072 2e65 7870 722e 5363  ask_expr.expr.Sc
-00002980: 616c 6172 3a20 6578 7072 3d64 662e 7369  alar: expr=df.si
-00002990: 7a65 2829 2c20 6474 7970 653d 696e 7436  ze(), dtype=int6
-000029a0: 343e 0a20 2020 2020 2020 2022 2222 0a20  4>.        """. 
-000029b0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000029c0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
-000029d0: 662e 6578 7072 2e73 697a 6529 0a0a 2020  f.expr.size)..  
-000029e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000029f0: 6465 6620 636f 6c75 6d6e 7328 7365 6c66  def columns(self
-00002a00: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00002a10: 6e20 7365 6c66 2e5f 6d65 7461 2e63 6f6c  n self._meta.col
-00002a20: 756d 6e73 0a0a 2020 2020 4063 6f6c 756d  umns..    @colum
-00002a30: 6e73 2e73 6574 7465 720a 2020 2020 6465  ns.setter.    de
-00002a40: 6620 636f 6c75 6d6e 7328 7365 6c66 2c20  f columns(self, 
-00002a50: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
-00002a60: 2020 6966 206c 656e 2863 6f6c 756d 6e73    if len(columns
-00002a70: 2920 213d 206c 656e 2873 656c 662e 636f  ) != len(self.co
-00002a80: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
-00002a90: 2020 2020 2320 7375 7266 6163 6520 7061      # surface pa
-00002aa0: 6e64 6173 2065 7272 6f72 0a20 2020 2020  ndas error.     
-00002ab0: 2020 2020 2020 2073 656c 662e 5f65 7870         self._exp
-00002ac0: 722e 5f6d 6574 612e 636f 6c75 6d6e 7320  r._meta.columns 
-00002ad0: 3d20 636f 6c75 6d6e 730a 2020 2020 2020  = columns.      
-00002ae0: 2020 7365 6c66 2e5f 6578 7072 203d 2065    self._expr = e
-00002af0: 7870 722e 436f 6c75 6d6e 7353 6574 7465  xpr.ColumnsSette
-00002b00: 7228 7365 6c66 2c20 636f 6c75 6d6e 7329  r(self, columns)
-00002b10: 0a0a 2020 2020 6465 6620 636c 6561 725f  ..    def clear_
-00002b20: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
-00002b30: 0a20 2020 2020 2020 2022 2222 466f 7267  .        """Forg
-00002b40: 6574 2064 6976 6973 696f 6e20 696e 666f  et division info
-00002b50: 726d 6174 696f 6e2e 0a0a 2020 2020 2020  rmation...      
-00002b60: 2020 5468 6973 2069 7320 7573 6566 756c    This is useful
-00002b70: 2069 6620 7468 6520 6469 7669 7369 6f6e   if the division
-00002b80: 7320 6172 6520 6e6f 206c 6f6e 6765 7220  s are no longer 
-00002b90: 6d65 616e 696e 6766 756c 2e0a 2020 2020  meaningful..    
-00002ba0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00002bb0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00002bc0: 6374 696f 6e28 6578 7072 2e43 6c65 6172  ction(expr.Clear
-00002bd0: 4469 7669 7369 6f6e 7328 7365 6c66 2929  Divisions(self))
-00002be0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-00002bf0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00002c00: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00002c10: 6563 7469 6f6e 284c 656e 2873 656c 6629  ection(Len(self)
-00002c20: 292e 636f 6d70 7574 6528 290a 0a20 2020  ).compute()..   
-00002c30: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00002c40: 6566 206e 6279 7465 7328 7365 6c66 293a  ef nbytes(self):
-00002c50: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-00002c60: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00002c70: 6f72 2822 6e62 7974 6573 2069 7320 6e6f  or("nbytes is no
-00002c80: 7420 696d 706c 656d 656e 7465 6420 6f6e  t implemented on
-00002c90: 2044 6174 6146 7261 6d65 2229 0a0a 2020   DataFrame")..  
-00002ca0: 2020 6465 6620 5f5f 7265 6475 6365 5f5f    def __reduce__
-00002cb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00002cc0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00002cd0: 6374 696f 6e2c 2028 7365 6c66 2e5f 6578  ction, (self._ex
-00002ce0: 7072 2c29 0a0a 2020 2020 6465 6620 5f5f  pr,)..    def __
-00002cf0: 6765 7469 7465 6d5f 5f28 7365 6c66 2c20  getitem__(self, 
-00002d00: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00002d10: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-00002d20: 6865 722c 2046 7261 6d65 4261 7365 293a  her, FrameBase):
-00002d30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00002d40: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-00002d50: 6f6e 2873 656c 662e 6578 7072 2e5f 5f67  on(self.expr.__g
-00002d60: 6574 6974 656d 5f5f 286f 7468 6572 2e65  etitem__(other.e
-00002d70: 7870 7229 290a 2020 2020 2020 2020 656c  xpr)).        el
-00002d80: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-00002d90: 6865 722c 2073 6c69 6365 293a 0a20 2020  her, slice):.   
-00002da0: 2020 2020 2020 2020 2066 726f 6d20 7061           from pa
-00002db0: 6e64 6173 2e61 7069 2e74 7970 6573 2069  ndas.api.types i
-00002dc0: 6d70 6f72 7420 6973 5f66 6c6f 6174 5f64  mport is_float_d
-00002dd0: 7479 7065 0a0a 2020 2020 2020 2020 2020  type..          
-00002de0: 2020 6973 5f69 6e74 6567 6572 5f73 6c69    is_integer_sli
-00002df0: 6365 203d 2061 6e79 280a 2020 2020 2020  ce = any(.      
-00002e00: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
-00002e10: 616e 6365 2869 2c20 496e 7465 6772 616c  ance(i, Integral
-00002e20: 2920 666f 7220 6920 696e 2028 6f74 6865  ) for i in (othe
-00002e30: 722e 7374 6172 742c 206f 7468 6572 2e73  r.start, other.s
-00002e40: 7465 702c 206f 7468 6572 2e73 746f 7029  tep, other.stop)
-00002e50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00002e60: 2020 2020 2020 2020 2020 2069 6620 280a             if (.
-00002e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002e80: 7365 6c66 2e6e 6469 6d20 3d3d 2032 0a20  self.ndim == 2. 
-00002e90: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00002ea0: 6e64 2069 735f 696e 7465 6765 725f 736c  nd is_integer_sl
-00002eb0: 6963 650a 2020 2020 2020 2020 2020 2020  ice.            
-00002ec0: 2020 2020 616e 6420 6e6f 7420 6973 5f66      and not is_f
-00002ed0: 6c6f 6174 5f64 7479 7065 2873 656c 662e  loat_dtype(self.
-00002ee0: 696e 6465 782e 6474 7970 6529 0a20 2020  index.dtype).   
-00002ef0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-00002f00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00002f10: 726e 2073 656c 662e 696c 6f63 5b6f 7468  rn self.iloc[oth
-00002f20: 6572 5d0a 2020 2020 2020 2020 2020 2020  er].            
-00002f30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00002f40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00002f50: 662e 6c6f 635b 6f74 6865 725d 0a20 2020  f.loc[other].   
-00002f60: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00002f70: 6365 286f 7468 6572 2c20 6e70 2e6e 6461  ce(other, np.nda
-00002f80: 7272 6179 2920 6f72 2069 735f 7365 7269  rray) or is_seri
-00002f90: 6573 5f6c 696b 6528 6f74 6865 7229 3a0a  es_like(other):.
-00002fa0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-00002fb0: 7220 3d20 6c69 7374 286f 7468 6572 290a  r = list(other).
-00002fc0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00002fd0: 6e73 7461 6e63 6528 6f74 6865 722c 206c  nstance(other, l
-00002fe0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
-00002ff0: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
-00003000: 636f 7079 2829 0a20 2020 2020 2020 2072  copy().        r
-00003010: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00003020: 7469 6f6e 2873 656c 662e 6578 7072 2e5f  tion(self.expr._
-00003030: 5f67 6574 6974 656d 5f5f 286f 7468 6572  _getitem__(other
-00003040: 2929 0a0a 2020 2020 6465 6620 5f5f 6461  ))..    def __da
-00003050: 736b 5f74 6f6b 656e 697a 655f 5f28 7365  sk_tokenize__(se
-00003060: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00003070: 7572 6e20 7479 7065 2873 656c 6629 2e5f  urn type(self)._
-00003080: 5f6e 616d 655f 5f2c 2073 656c 662e 5f65  _name__, self._e
-00003090: 7870 722e 5f6e 616d 650a 0a20 2020 2064  xpr._name..    d
-000030a0: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
-000030b0: 293a 0a20 2020 2020 2020 2064 6174 6120  ):.        data 
-000030c0: 3d20 7365 6c66 2e5f 7265 7072 5f64 6174  = self._repr_dat
-000030d0: 6128 292e 746f 5f73 7472 696e 6728 6d61  a().to_string(ma
-000030e0: 785f 726f 7773 3d35 290a 2020 2020 2020  x_rows=5).      
-000030f0: 2020 5f73 7472 5f66 6d74 203d 2022 2222    _str_fmt = """
-00003100: 4461 736b 207b 6b6c 6173 737d 2053 7472  Dask {klass} Str
-00003110: 7563 7475 7265 3a0a 7b64 6174 617d 0a44  ucture:.{data}.D
-00003120: 6173 6b20 4e61 6d65 3a20 7b6e 616d 657d  ask Name: {name}
-00003130: 2c20 7b6e 5f65 7870 727d 0a45 7870 723d  , {n_expr}.Expr=
-00003140: 7b65 7870 727d 2222 220a 2020 2020 2020  {expr}""".      
-00003150: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00003160: 6e63 6528 7365 6c66 2c20 5365 7269 6573  nce(self, Series
-00003170: 2920 616e 6420 6e6f 7420 6c65 6e28 7365  ) and not len(se
-00003180: 6c66 2e63 6f6c 756d 6e73 293a 0a20 2020  lf.columns):.   
-00003190: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
-000031a0: 6461 7461 2e70 6172 7469 7469 6f6e 2822  data.partition("
-000031b0: 5c6e 2229 5b2d 315d 2e72 6570 6c61 6365  \n")[-1].replace
-000031c0: 2822 496e 6465 7822 2c20 2244 6976 6973  ("Index", "Divis
-000031d0: 696f 6e73 2229 0a20 2020 2020 2020 2020  ions").         
-000031e0: 2020 205f 7374 725f 666d 7420 3d20 6622     _str_fmt = f"
-000031f0: 456d 7074 7920 7b5f 7374 725f 666d 747d  Empty {_str_fmt}
-00003200: 220a 2020 2020 2020 2020 6e5f 6578 7072  ".        n_expr
-00003210: 203d 206c 656e 287b 652e 5f6e 616d 6520   = len({e._name 
-00003220: 666f 7220 6520 696e 2073 656c 662e 6578  for e in self.ex
-00003230: 7072 2e77 616c 6b28 297d 290a 0a20 2020  pr.walk()})..   
-00003240: 2020 2020 2072 6574 7572 6e20 5f73 7472       return _str
-00003250: 5f66 6d74 2e66 6f72 6d61 7428 0a20 2020  _fmt.format(.   
-00003260: 2020 2020 2020 2020 206b 6c61 7373 3d73           klass=s
-00003270: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-00003280: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-00003290: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
-000032a0: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-000032b0: 6b65 795f 7370 6c69 7428 7365 6c66 2e5f  key_split(self._
-000032c0: 6e61 6d65 292c 0a20 2020 2020 2020 2020  name),.         
-000032d0: 2020 206e 5f65 7870 723d 6d61 7962 655f     n_expr=maybe_
-000032e0: 706c 7572 616c 697a 6528 6e5f 6578 7072  pluralize(n_expr
-000032f0: 2c20 2265 7870 7265 7373 696f 6e22 292c  , "expression"),
-00003300: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
-00003310: 723d 7365 6c66 2e65 7870 722c 0a20 2020  r=self.expr,.   
-00003320: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00003330: 5f5f 626f 6f6c 5f5f 2873 656c 6629 3a0a  __bool__(self):.
-00003340: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00003350: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00003360: 2020 2020 2020 6622 5468 6520 7472 7574        f"The trut
-00003370: 6820 7661 6c75 6520 6f66 2061 207b 7365  h value of a {se
-00003380: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-00003390: 616d 655f 5f7d 2069 7320 616d 6269 6775  ame__} is ambigu
-000033a0: 6f75 732e 2022 0a20 2020 2020 2020 2020  ous. ".         
-000033b0: 2020 2022 5573 6520 612e 616e 7928 2920     "Use a.any() 
-000033c0: 6f72 2061 2e61 6c6c 2829 2e22 0a20 2020  or a.all().".   
-000033d0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-000033e0: 5f5f 6172 7261 795f 5f28 7365 6c66 2c20  __array__(self, 
-000033f0: 6474 7970 653d 4e6f 6e65 2c20 2a2a 6b77  dtype=None, **kw
-00003400: 6172 6773 293a 0a20 2020 2020 2020 2072  args):.        r
-00003410: 6574 7572 6e20 6e70 2e61 7272 6179 2873  eturn np.array(s
-00003420: 656c 662e 636f 6d70 7574 6528 2929 0a0a  elf.compute())..
-00003430: 2020 2020 6465 6620 7065 7273 6973 7428      def persist(
-00003440: 7365 6c66 2c20 6675 7365 3d54 7275 652c  self, fuse=True,
-00003450: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00003460: 2020 2020 6f75 7420 3d20 7365 6c66 2e6f      out = self.o
-00003470: 7074 696d 697a 6528 6675 7365 3d66 7573  ptimize(fuse=fus
-00003480: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-00003490: 6e20 4461 736b 4d65 7468 6f64 734d 6978  n DaskMethodsMix
-000034a0: 696e 2e70 6572 7369 7374 286f 7574 2c20  in.persist(out, 
-000034b0: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
-000034c0: 6566 2063 6f6d 7075 7465 2873 656c 662c  ef compute(self,
-000034d0: 2066 7573 653d 5472 7565 2c20 2a2a 6b77   fuse=True, **kw
-000034e0: 6172 6773 293a 0a20 2020 2020 2020 206f  args):.        o
-000034f0: 7574 203d 2073 656c 660a 2020 2020 2020  ut = self.      
-00003500: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00003510: 6e63 6528 6f75 742c 2053 6361 6c61 7229  nce(out, Scalar)
-00003520: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
-00003530: 7420 3d20 6f75 742e 7265 7061 7274 6974  t = out.repartit
-00003540: 696f 6e28 6e70 6172 7469 7469 6f6e 733d  ion(npartitions=
-00003550: 3129 0a20 2020 2020 2020 206f 7574 203d  1).        out =
-00003560: 206f 7574 2e6f 7074 696d 697a 6528 6675   out.optimize(fu
-00003570: 7365 3d66 7573 6529 0a20 2020 2020 2020  se=fuse).       
-00003580: 2072 6574 7572 6e20 4461 736b 4d65 7468   return DaskMeth
-00003590: 6f64 734d 6978 696e 2e63 6f6d 7075 7465  odsMixin.compute
-000035a0: 286f 7574 2c20 2a2a 6b77 6172 6773 290a  (out, **kwargs).
-000035b0: 0a20 2020 2064 6566 2061 6e61 6c79 7a65  .    def analyze
-000035c0: 2873 656c 662c 2066 696c 656e 616d 653a  (self, filename:
-000035d0: 2073 7472 207c 204e 6f6e 6520 3d20 4e6f   str | None = No
-000035e0: 6e65 2c20 666f 726d 6174 3a20 7374 7220  ne, format: str 
-000035f0: 7c20 4e6f 6e65 203d 204e 6f6e 6529 202d  | None = None) -
-00003600: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00003610: 6f75 7420 3d20 7365 6c66 0a20 2020 2020  out = self.     
-00003620: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00003630: 616e 6365 286f 7574 2c20 5363 616c 6172  ance(out, Scalar
-00003640: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-00003650: 7574 203d 206f 7574 2e72 6570 6172 7469  ut = out.reparti
-00003660: 7469 6f6e 286e 7061 7274 6974 696f 6e73  tion(npartitions
-00003670: 3d31 290a 2020 2020 2020 2020 7265 7475  =1).        retu
-00003680: 726e 206f 7574 2e65 7870 722e 616e 616c  rn out.expr.anal
-00003690: 797a 6528 6669 6c65 6e61 6d65 3d66 696c  yze(filename=fil
-000036a0: 656e 616d 652c 2066 6f72 6d61 743d 666f  ename, format=fo
-000036b0: 726d 6174 290a 0a20 2020 2064 6566 2065  rmat)..    def e
-000036c0: 7870 6c61 696e 2873 656c 662c 2073 7461  xplain(self, sta
-000036d0: 6765 3a20 4f70 7469 6d69 7a65 7253 7461  ge: OptimizerSta
-000036e0: 6765 203d 2022 6675 7365 6422 2c20 666f  ge = "fused", fo
-000036f0: 726d 6174 3a20 7374 7220 7c20 4e6f 6e65  rmat: str | None
-00003700: 203d 204e 6f6e 6529 3a0a 2020 2020 2020   = None):.      
-00003710: 2020 6f75 7420 3d20 7365 6c66 0a20 2020    out = self.   
-00003720: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00003730: 7374 616e 6365 286f 7574 2c20 5363 616c  stance(out, Scal
-00003740: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
-00003750: 206f 7574 203d 206f 7574 2e72 6570 6172   out = out.repar
-00003760: 7469 7469 6f6e 286e 7061 7274 6974 696f  tition(npartitio
-00003770: 6e73 3d31 290a 2020 2020 2020 2020 7265  ns=1).        re
-00003780: 7475 726e 206f 7574 2e65 7870 722e 6578  turn out.expr.ex
-00003790: 706c 6169 6e28 7374 6167 652c 2066 6f72  plain(stage, for
-000037a0: 6d61 7429 0a0a 2020 2020 4070 726f 7065  mat)..    @prope
-000037b0: 7274 790a 2020 2020 6465 6620 6461 736b  rty.    def dask
-000037c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000037d0: 7265 7475 726e 2073 656c 662e 5f5f 6461  return self.__da
-000037e0: 736b 5f67 7261 7068 5f5f 2829 0a0a 2020  sk_graph__()..  
-000037f0: 2020 6465 6620 5f5f 6461 736b 5f67 7261    def __dask_gra
-00003800: 7068 5f5f 2873 656c 6629 3a0a 2020 2020  ph__(self):.    
-00003810: 2020 2020 6f75 7420 3d20 7365 6c66 2e65      out = self.e
-00003820: 7870 720a 2020 2020 2020 2020 6f75 7420  xpr.        out 
-00003830: 3d20 6f75 742e 6c6f 7765 725f 636f 6d70  = out.lower_comp
-00003840: 6c65 7465 6c79 2829 0a20 2020 2020 2020  letely().       
-00003850: 2072 6574 7572 6e20 6f75 742e 5f5f 6461   return out.__da
-00003860: 736b 5f67 7261 7068 5f5f 2829 0a0a 2020  sk_graph__()..  
-00003870: 2020 6465 6620 5f5f 6461 736b 5f6b 6579    def __dask_key
-00003880: 735f 5f28 7365 6c66 293a 0a20 2020 2020  s__(self):.     
-00003890: 2020 206f 7574 203d 2073 656c 662e 6578     out = self.ex
-000038a0: 7072 0a20 2020 2020 2020 206f 7574 203d  pr.        out =
-000038b0: 206f 7574 2e6c 6f77 6572 5f63 6f6d 706c   out.lower_compl
-000038c0: 6574 656c 7928 290a 2020 2020 2020 2020  etely().        
-000038d0: 7265 7475 726e 206f 7574 2e5f 5f64 6173  return out.__das
-000038e0: 6b5f 6b65 7973 5f5f 2829 0a0a 2020 2020  k_keys__()..    
-000038f0: 6465 6620 7369 6d70 6c69 6679 2873 656c  def simplify(sel
-00003900: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00003910: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00003920: 6e28 7365 6c66 2e65 7870 722e 7369 6d70  n(self.expr.simp
-00003930: 6c69 6679 2829 290a 0a20 2020 2064 6566  lify())..    def
-00003940: 206c 6f77 6572 5f6f 6e63 6528 7365 6c66   lower_once(self
-00003950: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003960: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00003970: 2873 656c 662e 6578 7072 2e6c 6f77 6572  (self.expr.lower
-00003980: 5f6f 6e63 6528 2929 0a0a 2020 2020 6465  _once())..    de
-00003990: 6620 6f70 7469 6d69 7a65 2873 656c 662c  f optimize(self,
-000039a0: 2066 7573 653a 2062 6f6f 6c20 3d20 5472   fuse: bool = Tr
-000039b0: 7565 293a 0a20 2020 2020 2020 2072 6574  ue):.        ret
-000039c0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-000039d0: 6f6e 2873 656c 662e 6578 7072 2e6f 7074  on(self.expr.opt
-000039e0: 696d 697a 6528 6675 7365 3d66 7573 6529  imize(fuse=fuse)
-000039f0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00003a00: 0a20 2020 2064 6566 2064 6173 6b28 7365  .    def dask(se
-00003a10: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00003a20: 7572 6e20 7365 6c66 2e5f 5f64 6173 6b5f  urn self.__dask_
-00003a30: 6772 6170 685f 5f28 290a 0a20 2020 2064  graph__()..    d
-00003a40: 6566 205f 5f64 6173 6b5f 706f 7374 636f  ef __dask_postco
-00003a50: 6d70 7574 655f 5f28 7365 6c66 293a 0a20  mpute__(self):. 
-00003a60: 2020 2020 2020 2073 7461 7465 203d 206e         state = n
-00003a70: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
-00003a80: 6c66 2e65 7870 722e 6c6f 7765 725f 636f  lf.expr.lower_co
-00003a90: 6d70 6c65 7465 6c79 2829 290a 2020 2020  mpletely()).    
-00003aa0: 2020 2020 6966 2074 7970 6528 7365 6c66      if type(self
-00003ab0: 2920 213d 2074 7970 6528 7374 6174 6529  ) != type(state)
-00003ac0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00003ad0: 7475 726e 2073 7461 7465 2e5f 5f64 6173  turn state.__das
-00003ae0: 6b5f 706f 7374 636f 6d70 7574 655f 5f28  k_postcompute__(
-00003af0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00003b00: 205f 636f 6e63 6174 2c20 2829 0a0a 2020   _concat, ()..  
-00003b10: 2020 6465 6620 5f5f 6461 736b 5f70 6f73    def __dask_pos
-00003b20: 7470 6572 7369 7374 5f5f 2873 656c 6629  tpersist__(self)
-00003b30: 3a0a 2020 2020 2020 2020 7374 6174 6520  :.        state 
-00003b40: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-00003b50: 2873 656c 662e 6578 7072 2e6c 6f77 6572  (self.expr.lower
-00003b60: 5f63 6f6d 706c 6574 656c 7928 2929 0a20  _completely()). 
-00003b70: 2020 2020 2020 2072 6574 7572 6e20 6672         return fr
-00003b80: 6f6d 5f67 7261 7068 2c20 280a 2020 2020  om_graph, (.    
-00003b90: 2020 2020 2020 2020 7374 6174 652e 5f6d          state._m
-00003ba0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00003bb0: 2073 7461 7465 2e64 6976 6973 696f 6e73   state.divisions
-00003bc0: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-00003bd0: 6174 652e 5f5f 6461 736b 5f6b 6579 735f  ate.__dask_keys_
-00003be0: 5f28 292c 0a20 2020 2020 2020 2020 2020  _(),.           
-00003bf0: 206b 6579 5f73 706c 6974 2873 7461 7465   key_split(state
-00003c00: 2e5f 6e61 6d65 292c 0a20 2020 2020 2020  ._name),.       
-00003c10: 2029 0a0a 2020 2020 6465 6620 5f5f 6765   )..    def __ge
-00003c20: 7461 7474 725f 5f28 7365 6c66 2c20 6b65  tattr__(self, ke
-00003c30: 7929 3a0a 2020 2020 2020 2020 7472 793a  y):.        try:
-00003c40: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
-00003c50: 7269 6f72 6974 697a 6520 6046 7261 6d65  rioritize `Frame
-00003c60: 4261 7365 6020 6174 7472 6962 7574 6573  Base` attributes
-00003c70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003c80: 7572 6e20 6f62 6a65 6374 2e5f 5f67 6574  urn object.__get
-00003c90: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
-00003ca0: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
-00003cb0: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
-00003cc0: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
-00003cd0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00003ce0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00003cf0: 4661 6c6c 2062 6163 6b20 746f 2060 6578  Fall back to `ex
-00003d00: 7072 6020 4150 490a 2020 2020 2020 2020  pr` API.        
-00003d10: 2020 2020 2020 2020 2320 284d 616b 696e          # (Makin
-00003d20: 6720 7375 7265 2074 6f20 636f 6e76 6572  g sure to conver
-00003d30: 7420 746f 2f66 726f 6d20 4578 7072 290a  t to/from Expr).
-00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d50: 7661 6c20 3d20 6765 7461 7474 7228 7365  val = getattr(se
-00003d60: 6c66 2e65 7870 722c 206b 6579 290a 2020  lf.expr, key).  
-00003d70: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00003d80: 2063 616c 6c61 626c 6528 7661 6c29 3a0a   callable(val):.
-00003d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003da0: 2020 2020 7265 7475 726e 2066 756e 6374      return funct
-00003db0: 6f6f 6c73 2e70 6172 7469 616c 285f 7772  ools.partial(_wr
-00003dc0: 6170 5f65 7870 725f 6170 692c 2077 7261  ap_expr_api, wra
-00003dd0: 705f 6170 693d 7661 6c29 0a20 2020 2020  p_api=val).     
-00003de0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00003df0: 6e20 7661 6c0a 2020 2020 2020 2020 2020  n val.          
-00003e00: 2020 6578 6365 7074 2041 7474 7269 6275    except Attribu
-00003e10: 7465 4572 726f 723a 0a20 2020 2020 2020  teError:.       
-00003e20: 2020 2020 2020 2020 2023 2052 6169 7365           # Raise
-00003e30: 206f 7269 6769 6e61 6c20 6572 726f 720a   original error.
-00003e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003e50: 7261 6973 6520 6572 720a 0a20 2020 2064  raise err..    d
-00003e60: 6566 2076 6973 7561 6c69 7a65 2873 656c  ef visualize(sel
-00003e70: 662c 2074 6173 6b73 3a20 626f 6f6c 203d  f, tasks: bool =
-00003e80: 2046 616c 7365 2c20 2a2a 6b77 6172 6773   False, **kwargs
-00003e90: 293a 0a20 2020 2020 2020 2022 2222 5669  ):.        """Vi
-00003ea0: 7375 616c 697a 6520 7468 6520 6578 7072  sualize the expr
-00003eb0: 6573 7369 6f6e 206f 7220 7461 736b 2067  ession or task g
-00003ec0: 7261 7068 0a0a 2020 2020 2020 2020 5061  raph..        Pa
-00003ed0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00003ee0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00003ef0: 2020 2020 7461 736b 733a 0a20 2020 2020      tasks:.     
-00003f00: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00003f10: 6f20 7669 7375 616c 697a 6520 7468 6520  o visualize the 
-00003f20: 7461 736b 2067 7261 7068 2e20 4279 2064  task graph. By d
-00003f30: 6566 6175 6c74 0a20 2020 2020 2020 2020  efault.         
-00003f40: 2020 2074 6865 2065 7870 7265 7373 696f     the expressio
-00003f50: 6e20 6772 6170 6820 7769 6c6c 2062 6520  n graph will be 
-00003f60: 7669 7375 616c 697a 6564 2069 6e73 7465  visualized inste
-00003f70: 6164 2e0a 2020 2020 2020 2020 2222 220a  ad..        """.
-00003f80: 2020 2020 2020 2020 6966 2074 6173 6b73          if tasks
-00003f90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00003fa0: 7475 726e 2073 7570 6572 2829 2e76 6973  turn super().vis
-00003fb0: 7561 6c69 7a65 282a 2a6b 7761 7267 7329  ualize(**kwargs)
-00003fc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003fd0: 7365 6c66 2e65 7870 722e 7669 7375 616c  self.expr.visual
-00003fe0: 697a 6528 2a2a 6b77 6172 6773 290a 0a20  ize(**kwargs).. 
-00003ff0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00004000: 2064 6566 206b 6e6f 776e 5f64 6976 6973   def known_divis
-00004010: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
-00004020: 2020 2020 2222 2257 6865 7468 6572 2074      """Whether t
-00004030: 6865 2064 6976 6973 696f 6e73 2061 7265  he divisions are
-00004040: 206b 6e6f 776e 2e0a 0a20 2020 2020 2020   known...       
-00004050: 2054 6869 7320 6368 6563 6b20 6361 6e20   This check can 
-00004060: 6265 2065 7870 656e 7369 7665 2069 6620  be expensive if 
-00004070: 7468 6520 6469 7669 7369 6f6e 2063 616c  the division cal
-00004080: 6375 6c61 7469 6f6e 2069 7320 6578 7065  culation is expe
-00004090: 6e73 6976 652e 0a20 2020 2020 2020 2044  nsive..        D
-000040a0: 6174 6146 7261 6d65 2e73 6574 5f69 6e64  ataFrame.set_ind
-000040b0: 6578 2069 7320 6120 676f 6f64 2065 7861  ex is a good exa
-000040c0: 6d70 6c65 2077 6865 7265 2074 6865 2063  mple where the c
-000040d0: 616c 6375 6c61 7469 6f6e 206e 6565 6473  alculation needs
-000040e0: 2061 6e0a 2020 2020 2020 2020 696e 7370   an.        insp
-000040f0: 6563 7469 6f6e 206f 6620 7468 6520 6461  ection of the da
-00004100: 7461 2e0a 2020 2020 2020 2020 2222 220a  ta..        """.
-00004110: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00004120: 656c 662e 6578 7072 2e6b 6e6f 776e 5f64  elf.expr.known_d
-00004130: 6976 6973 696f 6e73 0a0a 2020 2020 4070  ivisions..    @p
-00004140: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00004150: 696e 6465 7828 7365 6c66 293a 0a20 2020  index(self):.   
-00004160: 2020 2020 2022 2222 5265 7475 726e 2064       """Return d
-00004170: 6173 6b20 496e 6465 7820 696e 7374 616e  ask Index instan
-00004180: 6365 2222 220a 2020 2020 2020 2020 7265  ce""".        re
-00004190: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-000041a0: 696f 6e28 7365 6c66 2e65 7870 722e 696e  ion(self.expr.in
-000041b0: 6465 7829 0a0a 2020 2020 4069 6e64 6578  dex)..    @index
-000041c0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-000041d0: 696e 6465 7828 7365 6c66 2c20 7661 6c75  index(self, valu
-000041e0: 6529 3a0a 2020 2020 2020 2020 6173 7365  e):.        asse
-000041f0: 7274 2065 7870 722e 6172 655f 636f 5f61  rt expr.are_co_a
-00004200: 6c69 676e 6564 280a 2020 2020 2020 2020  ligned(.        
-00004210: 2020 2020 7365 6c66 2e65 7870 722c 2076      self.expr, v
-00004220: 616c 7565 2e65 7870 720a 2020 2020 2020  alue.expr.      
-00004230: 2020 292c 2022 7661 6c75 6520 6e65 6564    ), "value need
-00004240: 7320 746f 2062 6520 616c 6967 6e65 6420  s to be aligned 
-00004250: 7769 7468 2074 6865 2069 6e64 6578 220a  with the index".
-00004260: 2020 2020 2020 2020 5f65 7870 7220 3d20          _expr = 
-00004270: 6578 7072 2e41 7373 6967 6e49 6e64 6578  expr.AssignIndex
-00004280: 2873 656c 662c 2076 616c 7565 290a 2020  (self, value).  
-00004290: 2020 2020 2020 7365 6c66 2e5f 6578 7072        self._expr
-000042a0: 203d 205f 6578 7072 0a0a 2020 2020 6465   = _expr..    de
-000042b0: 6620 7265 7365 745f 696e 6465 7828 7365  f reset_index(se
-000042c0: 6c66 2c20 6472 6f70 3a20 626f 6f6c 203d  lf, drop: bool =
-000042d0: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
-000042e0: 2022 2222 5265 7365 7420 7468 6520 696e   """Reset the in
-000042f0: 6465 7820 746f 2074 6865 2064 6566 6175  dex to the defau
-00004300: 6c74 2069 6e64 6578 2e0a 0a20 2020 2020  lt index...     
-00004310: 2020 204e 6f74 6520 7468 6174 2075 6e6c     Note that unl
-00004320: 696b 6520 696e 2060 6070 616e 6461 7360  ike in ``pandas`
-00004330: 602c 2074 6865 2072 6573 6574 2069 6e64  `, the reset ind
-00004340: 6578 2066 6f72 2061 2044 6173 6b20 4461  ex for a Dask Da
-00004350: 7461 4672 616d 6520 7769 6c6c 0a20 2020  taFrame will.   
-00004360: 2020 2020 206e 6f74 2062 6520 6d6f 6e6f       not be mono
-00004370: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
-00004380: 7369 6e67 2066 726f 6d20 302e 2049 6e73  sing from 0. Ins
-00004390: 7465 6164 2c20 6974 2077 696c 6c20 7265  tead, it will re
-000043a0: 7374 6172 7420 6174 2030 0a20 2020 2020  start at 0.     
-000043b0: 2020 2066 6f72 2065 6163 6820 7061 7274     for each part
-000043c0: 6974 696f 6e20 2865 2e67 2e20 6060 696e  ition (e.g. ``in
-000043d0: 6465 7831 203d 205b 302c 202e 2e2e 2c20  dex1 = [0, ..., 
-000043e0: 3130 5d2c 2069 6e64 6578 3220 3d20 5b30  10], index2 = [0
-000043f0: 2c20 2e2e 2e5d 6060 292e 0a20 2020 2020  , ...]``)..     
-00004400: 2020 2054 6869 7320 6973 2064 7565 2074     This is due t
-00004410: 6f20 7468 6520 696e 6162 696c 6974 7920  o the inability 
-00004420: 746f 2073 7461 7469 6361 6c6c 7920 6b6e  to statically kn
-00004430: 6f77 2074 6865 2066 756c 6c20 6c65 6e67  ow the full leng
-00004440: 7468 206f 6620 7468 650a 2020 2020 2020  th of the.      
-00004450: 2020 696e 6465 782e 0a0a 2020 2020 2020    index...      
-00004460: 2020 466f 7220 4461 7461 4672 616d 6520    For DataFrame 
-00004470: 7769 7468 206d 756c 7469 2d6c 6576 656c  with multi-level
-00004480: 2069 6e64 6578 2c20 7265 7475 726e 7320   index, returns 
-00004490: 6120 6e65 7720 4461 7461 4672 616d 6520  a new DataFrame 
-000044a0: 7769 7468 0a20 2020 2020 2020 206c 6162  with.        lab
-000044b0: 656c 696e 6720 696e 666f 726d 6174 696f  eling informatio
-000044c0: 6e20 696e 2074 6865 2063 6f6c 756d 6e73  n in the columns
-000044d0: 2075 6e64 6572 2074 6865 2069 6e64 6578   under the index
-000044e0: 206e 616d 6573 2c20 6465 6661 756c 7469   names, defaulti
-000044f0: 6e67 0a20 2020 2020 2020 2074 6f20 276c  ng.        to 'l
-00004500: 6576 656c 5f30 272c 2027 6c65 7665 6c5f  evel_0', 'level_
-00004510: 3127 2c20 6574 632e 2069 6620 616e 7920  1', etc. if any 
-00004520: 6172 6520 4e6f 6e65 2e20 466f 7220 6120  are None. For a 
-00004530: 7374 616e 6461 7264 2069 6e64 6578 2c0a  standard index,.
-00004540: 2020 2020 2020 2020 7468 6520 696e 6465          the inde
-00004550: 7820 6e61 6d65 2077 696c 6c20 6265 2075  x name will be u
-00004560: 7365 6420 2869 6620 7365 7429 2c20 6f74  sed (if set), ot
-00004570: 6865 7277 6973 6520 6120 6465 6661 756c  herwise a defaul
-00004580: 7420 2769 6e64 6578 2720 6f72 0a20 2020  t 'index' or.   
-00004590: 2020 2020 2027 6c65 7665 6c5f 3027 2028       'level_0' (
-000045a0: 6966 2027 696e 6465 7827 2069 7320 616c  if 'index' is al
-000045b0: 7265 6164 7920 7461 6b65 6e29 2077 696c  ready taken) wil
-000045c0: 6c20 6265 2075 7365 642e 0a0a 2020 2020  l be used...    
-000045d0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-000045e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000045f0: 2d0a 2020 2020 2020 2020 6472 6f70 203a  -.        drop :
-00004600: 2062 6f6f 6c65 616e 2c20 6465 6661 756c   boolean, defaul
-00004610: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
-00004620: 2020 2020 446f 206e 6f74 2074 7279 2074      Do not try t
-00004630: 6f20 696e 7365 7274 2069 6e64 6578 2069  o insert index i
-00004640: 6e74 6f20 6461 7461 6672 616d 6520 636f  nto dataframe co
-00004650: 6c75 6d6e 732e 0a20 2020 2020 2020 2022  lumns..        "
-00004660: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00004670: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-00004680: 2865 7870 722e 5265 7365 7449 6e64 6578  (expr.ResetIndex
-00004690: 2873 656c 662c 2064 726f 7029 290a 0a20  (self, drop)).. 
-000046a0: 2020 2064 6566 2068 6561 6428 7365 6c66     def head(self
-000046b0: 2c20 6e3a 2069 6e74 203d 2035 2c20 6e70  , n: int = 5, np
-000046c0: 6172 7469 7469 6f6e 733d 312c 2063 6f6d  artitions=1, com
-000046d0: 7075 7465 3a20 626f 6f6c 203d 2054 7275  pute: bool = Tru
-000046e0: 6529 3a0a 2020 2020 2020 2020 2222 2246  e):.        """F
-000046f0: 6972 7374 206e 2072 6f77 7320 6f66 2074  irst n rows of t
-00004700: 6865 2064 6174 6173 6574 0a0a 2020 2020  he dataset..    
-00004710: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00004720: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00004730: 2d0a 2020 2020 2020 2020 6e20 3a20 696e  -.        n : in
-00004740: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00004750: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
-00004760: 6572 206f 6620 726f 7773 2074 6f20 7265  er of rows to re
-00004770: 7475 726e 2e20 4465 6661 756c 7420 6973  turn. Default is
-00004780: 2035 2e0a 2020 2020 2020 2020 6e70 6172   5..        npar
-00004790: 7469 7469 6f6e 7320 3a20 696e 742c 206f  titions : int, o
-000047a0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000047b0: 2020 2020 456c 656d 656e 7473 2061 7265      Elements are
-000047c0: 206f 6e6c 7920 7461 6b65 6e20 6672 6f6d   only taken from
-000047d0: 2074 6865 2066 6972 7374 2060 606e 7061   the first ``npa
-000047e0: 7274 6974 696f 6e73 6060 2c20 7769 7468  rtitions``, with
-000047f0: 2061 0a20 2020 2020 2020 2020 2020 2064   a.            d
-00004800: 6566 6175 6c74 206f 6620 312e 2049 6620  efault of 1. If 
-00004810: 7468 6572 6520 6172 6520 6665 7765 7220  there are fewer 
-00004820: 7468 616e 2060 606e 6060 2072 6f77 7320  than ``n`` rows 
-00004830: 696e 2074 6865 2066 6972 7374 0a20 2020  in the first.   
-00004840: 2020 2020 2020 2020 2060 606e 7061 7274           ``npart
-00004850: 6974 696f 6e73 6060 2061 2077 6172 6e69  itions`` a warni
-00004860: 6e67 2077 696c 6c20 6265 2072 6169 7365  ng will be raise
-00004870: 6420 616e 6420 616e 7920 666f 756e 6420  d and any found 
-00004880: 726f 7773 0a20 2020 2020 2020 2020 2020  rows.           
-00004890: 2072 6574 7572 6e65 642e 2050 6173 7320   returned. Pass 
-000048a0: 2d31 2074 6f20 7573 6520 616c 6c20 7061  -1 to use all pa
-000048b0: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
-000048c0: 2020 636f 6d70 7574 6520 3a20 626f 6f6c    compute : bool
-000048d0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-000048e0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-000048f0: 6f20 636f 6d70 7574 6520 7468 6520 7265  o compute the re
-00004900: 7375 6c74 2c20 6465 6661 756c 7420 6973  sult, default is
-00004910: 2054 7275 652e 0a20 2020 2020 2020 2022   True..        "
-00004920: 2222 0a20 2020 2020 2020 206f 7574 203d  "".        out =
-00004930: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-00004940: 6578 7072 2e48 6561 6428 7365 6c66 2c20  expr.Head(self, 
-00004950: 6e3d 6e2c 206e 7061 7274 6974 696f 6e73  n=n, npartitions
-00004960: 3d6e 7061 7274 6974 696f 6e73 2929 0a20  =npartitions)). 
-00004970: 2020 2020 2020 2069 6620 636f 6d70 7574         if comput
-00004980: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
-00004990: 7574 203d 206f 7574 2e63 6f6d 7075 7465  ut = out.compute
-000049a0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-000049b0: 6e20 6f75 740a 0a20 2020 2064 6566 2074  n out..    def t
-000049c0: 6169 6c28 7365 6c66 2c20 6e3a 2069 6e74  ail(self, n: int
-000049d0: 203d 2035 2c20 636f 6d70 7574 653a 2062   = 5, compute: b
-000049e0: 6f6f 6c20 3d20 5472 7565 293a 0a20 2020  ool = True):.   
-000049f0: 2020 2020 2022 2222 4c61 7374 206e 2072       """Last n r
-00004a00: 6f77 7320 6f66 2074 6865 2064 6174 6173  ows of the datas
-00004a10: 6574 0a0a 2020 2020 2020 2020 4361 7665  et..        Cave
-00004a20: 6174 2c20 7468 6520 6f6e 6c79 2063 6865  at, the only che
-00004a30: 636b 7320 7468 6520 6c61 7374 206e 2072  cks the last n r
-00004a40: 6f77 7320 6f66 2074 6865 206c 6173 7420  ows of the last 
-00004a50: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-00004a60: 2020 2022 2222 0a20 2020 2020 2020 206f     """.        o
-00004a70: 7574 203d 206e 6577 5f63 6f6c 6c65 6374  ut = new_collect
-00004a80: 696f 6e28 6578 7072 2e54 6169 6c28 7365  ion(expr.Tail(se
-00004a90: 6c66 2c20 6e3d 6e29 290a 2020 2020 2020  lf, n=n)).      
-00004aa0: 2020 6966 2063 6f6d 7075 7465 3a0a 2020    if compute:.  
-00004ab0: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
-00004ac0: 6f75 742e 636f 6d70 7574 6528 290a 2020  out.compute().  
-00004ad0: 2020 2020 2020 7265 7475 726e 206f 7574        return out
-00004ae0: 0a0a 2020 2020 6465 6620 636f 7079 2873  ..    def copy(s
-00004af0: 656c 662c 2064 6565 703a 2062 6f6f 6c20  elf, deep: bool 
-00004b00: 3d20 4661 6c73 6529 3a0a 2020 2020 2020  = False):.      
-00004b10: 2020 2222 224d 616b 6520 6120 636f 7079    """Make a copy
-00004b20: 206f 6620 7468 6520 6461 7461 6672 616d   of the datafram
-00004b30: 650a 0a20 2020 2020 2020 2054 6869 7320  e..        This 
-00004b40: 6973 2073 7472 6963 746c 7920 6120 7368  is strictly a sh
-00004b50: 616c 6c6f 7720 636f 7079 206f 6620 7468  allow copy of th
-00004b60: 6520 756e 6465 726c 7969 6e67 2063 6f6d  e underlying com
-00004b70: 7075 7461 7469 6f6e 616c 2067 7261 7068  putational graph
-00004b80: 2e0a 2020 2020 2020 2020 4974 2064 6f65  ..        It doe
-00004b90: 7320 6e6f 7420 6166 6665 6374 2074 6865  s not affect the
-00004ba0: 2075 6e64 6572 6c79 696e 6720 6461 7461   underlying data
-00004bb0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00004bc0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00004bd0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00004be0: 6465 6570 203a 2062 6f6f 6c65 616e 2c20  deep : boolean, 
-00004bf0: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-00004c00: 2020 2020 2020 2020 2020 5468 6520 6465            The de
-00004c10: 6570 2076 616c 7565 206d 7573 7420 6265  ep value must be
-00004c20: 2060 4661 6c73 6560 2061 6e64 2069 7420   `False` and it 
-00004c30: 6973 2064 6563 6c61 7265 6420 6173 2061  is declared as a
-00004c40: 2070 6172 616d 6574 6572 206a 7573 7420   parameter just 
-00004c50: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
-00004c60: 636f 6d70 6174 6962 696c 6974 7920 7769  compatibility wi
-00004c70: 7468 2074 6869 7264 2d70 6172 7479 206c  th third-party l
-00004c80: 6962 7261 7269 6573 206c 696b 6520 6375  ibraries like cu
-00004c90: 4446 2061 6e64 2070 616e 6461 730a 2020  DF and pandas.  
-00004ca0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004cb0: 2020 6966 2064 6565 7020 6973 206e 6f74    if deep is not
-00004cc0: 2046 616c 7365 3a0a 2020 2020 2020 2020   False:.        
-00004cd0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00004ce0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00004cf0: 2020 2020 2020 2254 6865 2060 6465 6570        "The `deep
-00004d00: 6020 7661 6c75 6520 6d75 7374 2062 6520  ` value must be 
-00004d10: 4661 6c73 652e 2054 6869 7320 6973 2073  False. This is s
-00004d20: 7472 6963 746c 7920 6120 7368 616c 6c6f  trictly a shallo
-00004d30: 7720 636f 7079 2022 0a20 2020 2020 2020  w copy ".       
-00004d40: 2020 2020 2020 2020 2022 6f66 2074 6865           "of the
-00004d50: 2075 6e64 6572 6c79 696e 6720 636f 6d70   underlying comp
-00004d60: 7574 6174 696f 6e61 6c20 6772 6170 682e  utational graph.
-00004d70: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00004d80: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00004d90: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
-00004da0: 6c66 2e65 7870 7229 0a0a 2020 2020 4064  lf.expr)..    @d
-00004db0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00004dc0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00004dd0: 6620 6973 696e 2873 656c 662c 2076 616c  f isin(self, val
-00004de0: 7565 7329 3a0a 2020 2020 2020 2020 6966  ues):.        if
-00004df0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00004e00: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
-00004e10: 2020 2020 2020 2020 2020 2320 4461 7461            # Data
-00004e20: 4672 616d 652e 6973 696e 2064 6f65 7320  Frame.isin does 
-00004e30: 7765 6972 6420 616c 6967 6e6d 656e 7420  weird alignment 
-00004e40: 7374 7566 660a 2020 2020 2020 2020 2020  stuff.          
-00004e50: 2020 6261 645f 7479 7065 7320 3d20 2846    bad_types = (F
-00004e60: 7261 6d65 4261 7365 2c20 7064 2e53 6572  rameBase, pd.Ser
-00004e70: 6965 732c 2070 642e 4461 7461 4672 616d  ies, pd.DataFram
-00004e80: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
-00004e90: 0a20 2020 2020 2020 2020 2020 2062 6164  .            bad
-00004ea0: 5f74 7970 6573 203d 2028 4672 616d 6542  _types = (FrameB
-00004eb0: 6173 652c 290a 2020 2020 2020 2020 6966  ase,).        if
-00004ec0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
-00004ed0: 6573 2c20 6261 645f 7479 7065 7329 3a0a  es, bad_types):.
-00004ee0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00004ef0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00004f00: 4572 726f 7228 2250 6173 7369 6e67 2061  Error("Passing a
-00004f10: 2025 7220 746f 2060 6973 696e 6022 2025   %r to `isin`" %
-00004f20: 2074 7970 656e 616d 6528 7479 7065 2876   typename(type(v
-00004f30: 616c 7565 7329 2929 0a0a 2020 2020 2020  alues)))..      
-00004f40: 2020 2320 5765 2077 7261 7020 7661 6c75    # We wrap valu
-00004f50: 6573 2069 6e20 6120 6465 6c61 7965 6420  es in a delayed 
-00004f60: 666f 7220 7477 6f20 7265 6173 6f6e 733a  for two reasons:
-00004f70: 0a20 2020 2020 2020 2023 202d 2061 766f  .        # - avo
-00004f80: 6964 2073 6572 6961 6c69 7a69 6e67 2064  id serializing d
-00004f90: 6174 6120 696e 2065 7665 7279 2074 6173  ata in every tas
-00004fa0: 6b0a 2020 2020 2020 2020 2320 2d20 6176  k.        # - av
-00004fb0: 6f69 6420 636f 7374 206f 6620 7472 6176  oid cost of trav
-00004fc0: 6572 7361 6c20 6f66 206c 6172 6765 206c  ersal of large l
-00004fd0: 6973 7420 696e 206f 7074 696d 697a 6174  ist in optimizat
-00004fe0: 696f 6e73 0a20 2020 2020 2020 2069 6620  ions.        if 
-00004ff0: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-00005000: 732c 206c 6973 7429 3a0a 2020 2020 2020  s, list):.      
-00005010: 2020 2020 2020 2320 4d6f 7469 7661 7465        # Motivate
-00005020: 6420 6279 2068 7474 7073 3a2f 2f67 6974  d by https://git
-00005030: 6875 622e 636f 6d2f 6461 736b 2f64 6173  hub.com/dask/das
-00005040: 6b2f 6973 7375 6573 2f39 3431 312e 2020  k/issues/9411.  
-00005050: 5468 6973 2061 7070 6561 7273 2074 6f20  This appears to 
-00005060: 6265 0a20 2020 2020 2020 2020 2020 2023  be.            #
-00005070: 2063 6175 7365 6420 6279 2068 7474 7073   caused by https
-00005080: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
-00005090: 736b 2f64 6973 7472 6962 7574 6564 2f69  sk/distributed/i
-000050a0: 7373 7565 732f 3633 3638 2c20 616e 6420  ssues/6368, and 
-000050b0: 6675 7274 6865 720a 2020 2020 2020 2020  further.        
-000050c0: 2020 2020 2320 6578 6163 6572 6261 7465      # exacerbate
-000050d0: 6420 6279 2074 6865 2066 6163 7420 7468  d by the fact th
-000050e0: 6174 2074 6865 206c 6973 7420 636f 6e74  at the list cont
-000050f0: 6169 6e73 2064 7570 6c69 6361 7465 732e  ains duplicates.
-00005100: 2020 5468 6973 2069 7320 6120 7061 7463    This is a patc
-00005110: 6820 756e 7469 6c0a 2020 2020 2020 2020  h until.        
-00005120: 2020 2020 2320 7765 2063 616e 2063 7265      # we can cre
-00005130: 6174 6520 6120 6265 7474 6572 2066 6978  ate a better fix
-00005140: 2066 6f72 2053 6572 6961 6c69 7a61 7469   for Serializati
-00005150: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-00005160: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00005170: 2020 2020 2076 616c 7565 7320 3d20 6c69       values = li
-00005180: 7374 2873 6574 2876 616c 7565 7329 290a  st(set(values)).
-00005190: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-000051a0: 7074 2054 7970 6545 7272 6f72 3a0a 2020  pt TypeError:.  
-000051b0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000051c0: 7373 0a20 2020 2020 2020 2020 2020 2069  ss.            i
-000051d0: 6620 6e6f 7420 616e 7928 6973 5f64 6173  f not any(is_das
-000051e0: 6b5f 636f 6c6c 6563 7469 6f6e 2876 2920  k_collection(v) 
-000051f0: 666f 7220 7620 696e 2076 616c 7565 7329  for v in values)
-00005200: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00005210: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00005220: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00005230: 7320 3d20 6e70 2e66 726f 6d69 7465 7228  s = np.fromiter(
-00005240: 7661 6c75 6573 2c20 6474 7970 653d 6f62  values, dtype=ob
-00005250: 6a65 6374 290a 2020 2020 2020 2020 2020  ject).          
-00005260: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
-00005270: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
-00005280: 2020 2020 2020 2020 2020 2020 2023 204e               # N
-00005290: 756d 7079 2031 2e32 3320 7375 7070 6f72  umpy 1.23 suppor
-000052a0: 7473 2063 7265 6174 696e 6720 6172 7261  ts creating arra
-000052b0: 7973 206f 6620 6974 6572 6162 6c65 732c  ys of iterables,
-000052c0: 2077 6869 6c65 206c 6f77 6572 0a20 2020   while lower.   
-000052d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052e0: 2023 2076 6572 7369 6f6e 2031 2e32 312e   # version 1.21.
-000052f0: 7820 616e 6420 312e 3232 2e78 2064 6f20  x and 1.22.x do 
-00005300: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
-00005310: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-00005320: 2020 2020 2066 726f 6d20 6461 736b 5f65       from dask_e
-00005330: 7870 722e 696f 2e5f 6465 6c61 7965 6420  xpr.io._delayed 
-00005340: 696d 706f 7274 205f 4465 6c61 7965 6445  import _DelayedE
-00005350: 7870 720a 0a20 2020 2020 2020 2072 6574  xpr..        ret
-00005360: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-00005370: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00005380: 6578 7072 2e49 7369 6e28 0a20 2020 2020  expr.Isin(.     
-00005390: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-000053a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000053b0: 2076 616c 7565 733d 5f44 656c 6179 6564   values=_Delayed
-000053c0: 4578 7072 280a 2020 2020 2020 2020 2020  Expr(.          
-000053d0: 2020 2020 2020 2020 2020 6465 6c61 7965            delaye
-000053e0: 6428 7661 6c75 6573 2c20 6e61 6d65 3d22  d(values, name="
-000053f0: 6465 6c61 7965 642d 2220 2b20 5f74 6f6b  delayed-" + _tok
-00005400: 656e 697a 655f 6465 7465 726d 696e 6973  enize_determinis
-00005410: 7469 6328 7661 6c75 6573 2929 0a20 2020  tic(values)).   
-00005420: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
-00005430: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00005440: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00005450: 205f 7061 7274 6974 696f 6e73 2873 656c   _partitions(sel
-00005460: 662c 2069 6e64 6578 293a 0a20 2020 2020  f, index):.     
-00005470: 2020 2023 2055 7365 6420 6279 2060 7061     # Used by `pa
-00005480: 7274 6974 696f 6e73 6020 666f 7220 7061  rtitions` for pa
-00005490: 7274 6974 696f 6e2d 7769 7365 2073 6c69  rtition-wise sli
-000054a0: 6369 6e67 0a0a 2020 2020 2020 2020 2320  cing..        # 
-000054b0: 436f 6e76 6572 7420 696e 6465 7820 746f  Convert index to
-000054c0: 206c 6973 740a 2020 2020 2020 2020 6966   list.        if
-000054d0: 2069 7369 6e73 7461 6e63 6528 696e 6465   isinstance(inde
-000054e0: 782c 2069 6e74 293a 0a20 2020 2020 2020  x, int):.       
-000054f0: 2020 2020 2069 6e64 6578 203d 205b 696e       index = [in
-00005500: 6465 785d 0a20 2020 2020 2020 2069 6e64  dex].        ind
-00005510: 6578 203d 206e 702e 6172 616e 6765 2873  ex = np.arange(s
-00005520: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
-00005530: 2064 7479 7065 3d6f 626a 6563 7429 5b69   dtype=object)[i
-00005540: 6e64 6578 5d2e 746f 6c69 7374 2829 0a0a  ndex].tolist()..
-00005550: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-00005560: 7468 6174 2073 656c 6563 7469 6f6e 206d  that selection m
-00005570: 616b 6573 2073 656e 7365 0a20 2020 2020  akes sense.     
-00005580: 2020 2061 7373 6572 7420 7365 7428 696e     assert set(in
-00005590: 6465 7829 2e69 7373 7562 7365 7428 7261  dex).issubset(ra
-000055a0: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
-000055b0: 696f 6e73 2929 0a0a 2020 2020 2020 2020  ions))..        
-000055c0: 2320 5265 7475 726e 2073 656c 6563 7465  # Return selecte
-000055d0: 6420 7061 7274 6974 696f 6e73 0a20 2020  d partitions.   
-000055e0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-000055f0: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
-00005600: 5061 7274 6974 696f 6e73 2873 656c 662c  Partitions(self,
-00005610: 2069 6e64 6578 2929 0a0a 2020 2020 4070   index))..    @p
-00005620: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00005630: 7061 7274 6974 696f 6e73 2873 656c 6629  partitions(self)
-00005640: 3a0a 2020 2020 2020 2020 2222 2253 6c69  :.        """Sli
-00005650: 6365 2064 6174 6166 7261 6d65 2062 7920  ce dataframe by 
-00005660: 7061 7274 6974 696f 6e73 0a0a 2020 2020  partitions..    
-00005670: 2020 2020 5468 6973 2061 6c6c 6f77 7320      This allows 
-00005680: 7061 7274 6974 696f 6e77 6973 6520 736c  partitionwise sl
-00005690: 6963 696e 6720 6f66 2061 2044 6173 6b20  icing of a Dask 
-000056a0: 4461 7461 6672 616d 652e 2020 596f 7520  Dataframe.  You 
-000056b0: 6361 6e20 7065 7266 6f72 6d20 6e6f 726d  can perform norm
-000056c0: 616c 0a20 2020 2020 2020 204e 756d 7079  al.        Numpy
-000056d0: 2d73 7479 6c65 2073 6c69 6369 6e67 2c20  -style slicing, 
-000056e0: 6275 7420 6e6f 7720 7261 7468 6572 2074  but now rather t
-000056f0: 6861 6e20 736c 6963 6520 656c 656d 656e  han slice elemen
-00005700: 7473 206f 6620 7468 6520 6172 7261 7920  ts of the array 
-00005710: 796f 750a 2020 2020 2020 2020 736c 6963  you.        slic
-00005720: 6520 616c 6f6e 6720 7061 7274 6974 696f  e along partitio
-00005730: 6e73 2073 6f2c 2066 6f72 2065 7861 6d70  ns so, for examp
-00005740: 6c65 2c20 6060 6466 2e70 6172 7469 7469  le, ``df.partiti
-00005750: 6f6e 735b 3a35 5d60 6020 7072 6f64 7563  ons[:5]`` produc
-00005760: 6573 2061 206e 6577 0a20 2020 2020 2020  es a new.       
-00005770: 2044 6173 6b20 4461 7461 6672 616d 6520   Dask Dataframe 
-00005780: 6f66 2074 6865 2066 6972 7374 2066 6976  of the first fiv
-00005790: 6520 7061 7274 6974 696f 6e73 2e20 5661  e partitions. Va
-000057a0: 6c69 6420 696e 6465 7865 7273 2061 7265  lid indexers are
-000057b0: 2069 6e74 6567 6572 732c 2073 6571 7565   integers, seque
-000057c0: 6e63 6573 0a20 2020 2020 2020 206f 6620  nces.        of 
-000057d0: 696e 7465 6765 7273 2c20 736c 6963 6573  integers, slices
-000057e0: 2c20 6f72 2062 6f6f 6c65 616e 206d 6173  , or boolean mas
-000057f0: 6b73 2e0a 0a20 2020 2020 2020 2045 7861  ks...        Exa
-00005800: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-00005810: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-00005820: 3e3e 2064 662e 7061 7274 6974 696f 6e73  >> df.partitions
-00005830: 5b30 5d20 2023 2064 6f63 7465 7374 3a20  [0]  # doctest: 
-00005840: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
-00005850: 3e20 6466 2e70 6172 7469 7469 6f6e 735b  > df.partitions[
-00005860: 3a33 5d20 2023 2064 6f63 7465 7374 3a20  :3]  # doctest: 
-00005870: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
-00005880: 3e20 6466 2e70 6172 7469 7469 6f6e 735b  > df.partitions[
-00005890: 3a3a 3130 5d20 2023 2064 6f63 7465 7374  ::10]  # doctest
-000058a0: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-000058b0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-000058c0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-000058d0: 2041 2044 6173 6b20 4461 7461 4672 616d   A Dask DataFram
-000058e0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-000058f0: 2020 2020 2020 7265 7475 726e 2049 6e64        return Ind
-00005900: 6578 4361 6c6c 6162 6c65 2873 656c 662e  exCallable(self.
-00005910: 5f70 6172 7469 7469 6f6e 7329 0a0a 2020  _partitions)..  
-00005920: 2020 6465 6620 6765 745f 7061 7274 6974    def get_partit
-00005930: 696f 6e28 7365 6c66 2c20 6e29 3a0a 2020  ion(self, n):.  
-00005940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00005950: 2020 4765 7420 6120 6461 736b 2044 6174    Get a dask Dat
-00005960: 6146 7261 6d65 2f53 6572 6965 7320 7265  aFrame/Series re
-00005970: 7072 6573 656e 7469 6e67 2074 6865 2060  presenting the `
-00005980: 6e74 6860 2070 6172 7469 7469 6f6e 2e0a  nth` partition..
-00005990: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000059a0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-000059b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
-000059c0: 203a 2069 6e74 0a20 2020 2020 2020 2020   : int.         
-000059d0: 2020 2054 6865 2030 2d69 6e64 6578 6564     The 0-indexed
-000059e0: 2070 6172 7469 7469 6f6e 206e 756d 6265   partition numbe
-000059f0: 7220 746f 2073 656c 6563 742e 0a0a 2020  r to select...  
-00005a00: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00005a10: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00005a20: 2020 2020 2020 4461 736b 2044 6174 6146        Dask DataF
-00005a30: 7261 6d65 206f 7220 5365 7269 6573 0a20  rame or Series. 
-00005a40: 2020 2020 2020 2020 2020 2054 6865 2073             The s
-00005a50: 616d 6520 7479 7065 2061 7320 7468 6520  ame type as the 
-00005a60: 6f72 6967 696e 616c 206f 626a 6563 742e  original object.
-00005a70: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00005a80: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-00005a90: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-00005aa0: 4672 616d 652e 7061 7274 6974 696f 6e73  Frame.partitions
-00005ab0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00005ac0: 2020 2020 2069 6620 6e6f 7420 3020 3c3d       if not 0 <=
-00005ad0: 206e 203c 2073 656c 662e 6e70 6172 7469   n < self.nparti
-00005ae0: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
-00005af0: 2020 206d 7367 203d 2066 226e 206d 7573     msg = f"n mus
-00005b00: 7420 6265 2030 203c 3d20 6e20 3c20 7b73  t be 0 <= n < {s
-00005b10: 656c 662e 6e70 6172 7469 7469 6f6e 737d  elf.npartitions}
-00005b20: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
-00005b30: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
-00005b40: 7367 290a 2020 2020 2020 2020 7265 7475  sg).        retu
-00005b50: 726e 2073 656c 662e 7061 7274 6974 696f  rn self.partitio
-00005b60: 6e73 5b6e 5d0a 0a20 2020 2064 6566 2073  ns[n]..    def s
-00005b70: 6875 6666 6c65 280a 2020 2020 2020 2020  huffle(.        
-00005b80: 7365 6c66 2c0a 2020 2020 2020 2020 6f6e  self,.        on
-00005b90: 3a20 7374 7220 7c20 6c69 7374 207c 206e  : str | list | n
-00005ba0: 6f5f 6465 6661 756c 7420 3d20 6e6f 5f64  o_default = no_d
-00005bb0: 6566 6175 6c74 2c0a 2020 2020 2020 2020  efault,.        
-00005bc0: 6967 6e6f 7265 5f69 6e64 6578 3a20 626f  ignore_index: bo
-00005bd0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00005be0: 2020 2020 6e70 6172 7469 7469 6f6e 733a      npartitions:
-00005bf0: 2069 6e74 207c 204e 6f6e 6520 3d20 4e6f   int | None = No
-00005c00: 6e65 2c0a 2020 2020 2020 2020 7368 7566  ne,.        shuf
-00005c10: 666c 655f 6d65 7468 6f64 3a20 7374 7220  fle_method: str 
-00005c20: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00005c30: 2020 2020 2020 206f 6e5f 696e 6465 783a         on_index:
-00005c40: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-00005c50: 2020 2020 2020 202a 2a6f 7074 696f 6e73         **options
-00005c60: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00005c70: 2022 2222 5265 6172 7261 6e67 6520 4461   """Rearrange Da
-00005c80: 7461 4672 616d 6520 696e 746f 206e 6577  taFrame into new
-00005c90: 2070 6172 7469 7469 6f6e 730a 0a20 2020   partitions..   
-00005ca0: 2020 2020 2055 7365 7320 6861 7368 696e       Uses hashin
-00005cb0: 6720 6f66 2060 6f6e 6020 746f 206d 6170  g of `on` to map
-00005cc0: 2072 6f77 7320 746f 206f 7574 7075 7420   rows to output 
-00005cd0: 7061 7274 6974 696f 6e73 2e20 4166 7465  partitions. Afte
-00005ce0: 7220 7468 6973 0a20 2020 2020 2020 206f  r this.        o
-00005cf0: 7065 7261 7469 6f6e 2c20 726f 7773 2077  peration, rows w
-00005d00: 6974 6820 7468 6520 7361 6d65 2076 616c  ith the same val
-00005d10: 7565 206f 6620 606f 6e60 2077 696c 6c20  ue of `on` will 
-00005d20: 6265 2069 6e20 7468 6520 7361 6d65 0a20  be in the same. 
-00005d30: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00005d40: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00005d50: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00005d60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00005d70: 206f 6e20 3a20 7374 722c 206c 6973 7420   on : str, list 
-00005d80: 6f66 2073 7472 2c20 6f72 2053 6572 6965  of str, or Serie
-00005d90: 732c 2049 6e64 6578 2c20 6f72 2044 6174  s, Index, or Dat
-00005da0: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
-00005db0: 2020 2043 6f6c 756d 6e20 6e61 6d65 7320     Column names 
-00005dc0: 746f 2073 6875 6666 6c65 2062 792e 0a20  to shuffle by.. 
-00005dd0: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
-00005de0: 6465 7820 3a20 6f70 7469 6f6e 616c 0a20  dex : optional. 
-00005df0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00005e00: 6572 2074 6f20 6967 6e6f 7265 2074 6865  er to ignore the
-00005e10: 2069 6e64 6578 2e20 4465 6661 756c 7420   index. Default 
-00005e20: 6973 2060 6046 616c 7365 6060 2e0a 2020  is ``False``..  
-00005e30: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
-00005e40: 7320 3a20 6f70 7469 6f6e 616c 0a20 2020  s : optional.   
-00005e50: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00005e60: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
-00005e70: 696f 6e73 2e20 5468 6520 7061 7274 6974  ions. The partit
-00005e80: 696f 6e20 636f 756e 7420 7769 6c6c 0a20  ion count will. 
-00005e90: 2020 2020 2020 2020 2020 2062 6520 7072             be pr
-00005ea0: 6573 6572 7665 6420 6279 2064 6566 6175  eserved by defau
-00005eb0: 6c74 2e0a 2020 2020 2020 2020 7368 7566  lt..        shuf
-00005ec0: 666c 655f 6d65 7468 6f64 203a 206f 7074  fle_method : opt
-00005ed0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00005ee0: 2020 4465 7369 7265 6420 7368 7566 666c    Desired shuffl
-00005ef0: 6520 6d65 7468 6f64 2e20 4465 6661 756c  e method. Defaul
-00005f00: 7420 6368 6f73 656e 2061 7420 6f70 7469  t chosen at opti
-00005f10: 6d69 7a61 7469 6f6e 2074 696d 652e 0a20  mization time.. 
-00005f20: 2020 2020 2020 206f 6e5f 696e 6465 7820         on_index 
-00005f30: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-00005f40: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00005f50: 2020 5768 6574 6865 7220 746f 2073 6875    Whether to shu
-00005f60: 6666 6c65 206f 6e20 7468 6520 696e 6465  ffle on the inde
-00005f70: 782e 204d 7574 7561 6c6c 7920 6578 636c  x. Mutually excl
-00005f80: 7573 6976 6520 7769 7468 2027 6f6e 272e  usive with 'on'.
-00005f90: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
-00005fa0: 2074 6869 7320 746f 2060 6054 7275 6560   this to ``True`
-00005fb0: 6020 6966 2027 6f6e 2720 6973 206e 6f74  ` if 'on' is not
-00005fc0: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
-00005fd0: 2020 202a 2a6f 7074 696f 6e73 203a 206f     **options : o
-00005fe0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00005ff0: 2020 2020 416c 676f 7269 7468 6d2d 7370      Algorithm-sp
-00006000: 6563 6966 6963 206f 7074 696f 6e73 2e0a  ecific options..
-00006010: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
-00006020: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
-00006030: 2020 2020 2054 6869 7320 646f 6573 206e       This does n
-00006040: 6f74 2070 7265 7365 7276 6520 6120 6d65  ot preserve a me
-00006050: 616e 696e 6766 756c 2069 6e64 6578 2f70  aningful index/p
-00006060: 6172 7469 7469 6f6e 696e 6720 7363 6865  artitioning sche
-00006070: 6d65 2e20 5468 6973 0a20 2020 2020 2020  me. This.       
-00006080: 2069 7320 6e6f 7420 6465 7465 726d 696e   is not determin
-00006090: 6973 7469 6320 6966 2064 6f6e 6520 696e  istic if done in
-000060a0: 2070 6172 616c 6c65 6c2e 0a0a 2020 2020   parallel...    
-000060b0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-000060c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-000060d0: 2020 2020 2020 3e3e 3e20 6466 203d 2064        >>> df = d
-000060e0: 662e 7368 7566 666c 6528 6466 2e63 6f6c  f.shuffle(df.col
-000060f0: 756d 6e73 5b30 5d29 2020 2320 646f 6374  umns[0])  # doct
-00006100: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
-00006110: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00006120: 6620 6f6e 2069 7320 6e6f 5f64 6566 6175  f on is no_defau
-00006130: 6c74 2061 6e64 206e 6f74 206f 6e5f 696e  lt and not on_in
-00006140: 6465 783a 0a20 2020 2020 2020 2020 2020  dex:.           
-00006150: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00006160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00006170: 2020 224d 7573 7420 7368 7566 666c 6520    "Must shuffle 
-00006180: 6f6e 2065 6974 6865 7220 636f 6c75 6d6e  on either column
-00006190: 7320 6f72 2074 6865 2069 6e64 6578 3b20  s or the index; 
-000061a0: 6375 7272 656e 746c 7920 7368 7566 666c  currently shuffl
-000061b0: 696e 6720 6f6e 2022 0a20 2020 2020 2020  ing on ".       
-000061c0: 2020 2020 2020 2020 2022 6e65 6974 6865           "neithe
-000061d0: 722e 2050 6173 7320 636f 6c75 6d6e 2873  r. Pass column(s
-000061e0: 2920 746f 2027 6f6e 2720 6f72 2073 6574  ) to 'on' or set
-000061f0: 2027 6f6e 5f69 6e64 6578 2720 746f 2054   'on_index' to T
-00006200: 7275 652e 220a 2020 2020 2020 2020 2020  rue.".          
-00006210: 2020 290a 2020 2020 2020 2020 656c 6966    ).        elif
-00006220: 206f 6e20 6973 206e 6f74 206e 6f5f 6465   on is not no_de
-00006230: 6661 756c 7420 616e 6420 6f6e 5f69 6e64  fault and on_ind
-00006240: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
-00006250: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00006260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006270: 2022 4361 6e6e 6f74 2073 6875 6666 6c65   "Cannot shuffle
-00006280: 206f 6e20 626f 7468 2063 6f6c 756d 6e73   on both columns
-00006290: 2061 6e64 2074 6865 2069 6e64 6578 2e20   and the index. 
-000062a0: 446f 206e 6f74 2070 6173 7320 636f 6c75  Do not pass colu
-000062b0: 6d6e 2873 2920 220a 2020 2020 2020 2020  mn(s) ".        
-000062c0: 2020 2020 2020 2020 2274 6f20 276f 6e27          "to 'on'
-000062d0: 206f 7220 7365 7420 276f 6e5f 696e 6465   or set 'on_inde
-000062e0: 7827 2074 6f20 4661 6c73 652e 220a 2020  x' to False.".  
-000062f0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00006300: 2020 2020 2023 2050 7265 7365 7276 6520       # Preserve 
-00006310: 7061 7274 6974 696f 6e20 636f 756e 7420  partition count 
-00006320: 6279 2064 6566 6175 6c74 0a20 2020 2020  by default.     
-00006330: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
-00006340: 206e 7061 7274 6974 696f 6e73 206f 7220   npartitions or 
-00006350: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00006360: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-00006370: 6e73 7461 6e63 6528 6f6e 2c20 4672 616d  nstance(on, Fram
-00006380: 6542 6173 6529 3a0a 2020 2020 2020 2020  eBase):.        
-00006390: 2020 2020 6966 206e 6f74 2065 7870 722e      if not expr.
-000063a0: 6172 655f 636f 5f61 6c69 676e 6564 2873  are_co_aligned(s
-000063b0: 656c 662e 6578 7072 2c20 6f6e 2e65 7870  elf.expr, on.exp
-000063c0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-000063d0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000063e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000063f0: 2020 2020 2020 2020 2022 696e 6465 7820           "index 
-00006400: 6d75 7374 2062 6520 616c 6967 6e65 6420  must be aligned 
-00006410: 7769 7468 2074 6865 2044 6174 6146 7261  with the DataFra
-00006420: 6d65 2074 6f20 7573 6520 6173 2073 6875  me to use as shu
-00006430: 6666 6c65 2069 6e64 6578 2e22 0a20 2020  ffle index.".   
-00006440: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00006450: 2020 2020 2020 2065 6c69 6620 7064 2e61         elif pd.a
-00006460: 7069 2e74 7970 6573 2e69 735f 6c69 7374  pi.types.is_list
-00006470: 5f6c 696b 6528 6f6e 2920 616e 6420 6e6f  _like(on) and no
-00006480: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
-00006490: 7469 6f6e 286f 6e29 3a0a 2020 2020 2020  tion(on):.      
-000064a0: 2020 2020 2020 6f6e 203d 206c 6973 7428        on = list(
-000064b0: 6f6e 290a 0a20 2020 2020 2020 2069 6620  on)..        if 
-000064c0: 2873 6875 6666 6c65 5f6d 6574 686f 6420  (shuffle_method 
-000064d0: 6f72 2067 6574 5f64 6566 6175 6c74 5f73  or get_default_s
-000064e0: 6875 6666 6c65 5f6d 6574 686f 6428 2929  huffle_method())
-000064f0: 203d 3d20 2270 3270 223a 0a20 2020 2020   == "p2p":.     
-00006500: 2020 2020 2020 2066 726f 6d20 6469 7374         from dist
-00006510: 7269 6275 7465 642e 7368 7566 666c 652e  ributed.shuffle.
-00006520: 5f61 7272 6f77 2069 6d70 6f72 7420 6368  _arrow import ch
-00006530: 6563 6b5f 6474 7970 655f 7375 7070 6f72  eck_dtype_suppor
-00006540: 740a 0a20 2020 2020 2020 2020 2020 2063  t..            c
-00006550: 6865 636b 5f64 7479 7065 5f73 7570 706f  heck_dtype_suppo
-00006560: 7274 2873 656c 662e 5f6d 6574 6129 0a0a  rt(self._meta)..
-00006570: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00006580: 6e79 286e 6f74 2069 7369 6e73 7461 6e63  ny(not isinstanc
-00006590: 6528 632c 2073 7472 2920 666f 7220 6320  e(c, str) for c 
-000065a0: 696e 2073 656c 662e 5f6d 6574 612e 636f  in self._meta.co
-000065b0: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
-000065c0: 2020 2020 2020 2020 756e 7375 7070 6f72          unsuppor
-000065d0: 7465 6420 3d20 7b0a 2020 2020 2020 2020  ted = {.        
-000065e0: 2020 2020 2020 2020 2020 2020 633a 2074              c: t
-000065f0: 7970 6528 6329 2066 6f72 2063 2069 6e20  ype(c) for c in 
-00006600: 7365 6c66 2e5f 6d65 7461 2e63 6f6c 756d  self._meta.colum
-00006610: 6e73 2069 6620 6e6f 7420 6973 696e 7374  ns if not isinst
-00006620: 616e 6365 2863 2c20 7374 7229 0a20 2020  ance(c, str).   
-00006630: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00006640: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00006650: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-00006660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006670: 2020 2020 6622 7032 7020 7265 7175 6972      f"p2p requir
-00006680: 6573 2061 6c6c 2063 6f6c 756d 6e20 6e61  es all column na
-00006690: 6d65 7320 746f 2062 6520 7374 722c 2066  mes to be str, f
-000066a0: 6f75 6e64 3a20 7b75 6e73 7570 706f 7274  ound: {unsupport
-000066b0: 6564 7d22 2c0a 2020 2020 2020 2020 2020  ed}",.          
-000066c0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000066d0: 2023 2052 6574 7572 6e65 6420 7368 7566   # Returned shuf
-000066e0: 666c 6564 2072 6573 756c 740a 2020 2020  fled result.    
-000066f0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00006700: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-00006710: 2020 2020 2020 2052 6561 7272 616e 6765         Rearrange
-00006720: 4279 436f 6c75 6d6e 280a 2020 2020 2020  ByColumn(.      
-00006730: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00006740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006750: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00006760: 2020 2020 6e70 6172 7469 7469 6f6e 732c      npartitions,
-00006770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006780: 2069 676e 6f72 655f 696e 6465 782c 0a20   ignore_index,. 
-00006790: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-000067a0: 6574 5f73 7065 6369 6669 6564 5f73 6875  et_specified_shu
-000067b0: 6666 6c65 2873 6875 6666 6c65 5f6d 6574  ffle(shuffle_met
-000067c0: 686f 6429 2c0a 2020 2020 2020 2020 2020  hod),.          
-000067d0: 2020 2020 2020 6f70 7469 6f6e 732c 0a20        options,. 
-000067e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000067f0: 6e64 6578 5f73 6875 6666 6c65 3d6f 6e5f  ndex_shuffle=on_
-00006800: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-00006810: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
-00006820: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00006830: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00006840: 2020 2020 6465 6620 7265 7361 6d70 6c65      def resample
-00006850: 2873 656c 662c 2072 756c 652c 2063 6c6f  (self, rule, clo
-00006860: 7365 643d 4e6f 6e65 2c20 6c61 6265 6c3d  sed=None, label=
-00006870: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
-00006880: 726f 6d20 6461 736b 5f65 7870 722e 5f72  rom dask_expr._r
-00006890: 6573 616d 706c 6520 696d 706f 7274 2052  esample import R
-000068a0: 6573 616d 706c 6572 0a0a 2020 2020 2020  esampler..      
-000068b0: 2020 7265 7475 726e 2052 6573 616d 706c    return Resampl
-000068c0: 6572 2873 656c 662c 2072 756c 652c 202a  er(self, rule, *
-000068d0: 2a7b 2263 6c6f 7365 6422 3a20 636c 6f73  *{"closed": clos
-000068e0: 6564 2c20 226c 6162 656c 223a 206c 6162  ed, "label": lab
-000068f0: 656c 7d29 0a0a 2020 2020 6465 6620 726f  el})..    def ro
-00006900: 6c6c 696e 6728 7365 6c66 2c20 7769 6e64  lling(self, wind
-00006910: 6f77 2c20 2a2a 6b77 6172 6773 293a 0a20  ow, **kwargs):. 
-00006920: 2020 2020 2020 2022 2222 5072 6f76 6964         """Provid
-00006930: 6573 2072 6f6c 6c69 6e67 2074 7261 6e73  es rolling trans
-00006940: 666f 726d 6174 696f 6e73 2e0a 0a20 2020  formations...   
-00006950: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00006960: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00006970: 2d2d 0a20 2020 2020 2020 2077 696e 646f  --.        windo
-00006980: 7720 3a20 696e 742c 2073 7472 2c20 6f66  w : int, str, of
-00006990: 6673 6574 0a20 2020 2020 2020 2020 2020  fset.           
-000069a0: 5369 7a65 206f 6620 7468 6520 6d6f 7669  Size of the movi
-000069b0: 6e67 2077 696e 646f 772e 2054 6869 7320  ng window. This 
-000069c0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
-000069d0: 206f 6273 6572 7661 7469 6f6e 7320 7573   observations us
-000069e0: 6564 0a20 2020 2020 2020 2020 2020 666f  ed.           fo
-000069f0: 7220 6361 6c63 756c 6174 696e 6720 7468  r calculating th
-00006a00: 6520 7374 6174 6973 7469 632e 2057 6865  e statistic. Whe
-00006a10: 6e20 6e6f 7420 7573 696e 6720 6120 6060  n not using a ``
-00006a20: 4461 7465 7469 6d65 496e 6465 7860 602c  DatetimeIndex``,
-00006a30: 0a20 2020 2020 2020 2020 2020 7468 6520  .           the 
-00006a40: 7769 6e64 6f77 2073 697a 6520 6d75 7374  window size must
-00006a50: 206e 6f74 2062 6520 736f 206c 6172 6765   not be so large
-00006a60: 2061 7320 746f 2073 7061 6e20 6d6f 7265   as to span more
-00006a70: 2074 6861 6e20 6f6e 650a 2020 2020 2020   than one.      
-00006a80: 2020 2020 2061 646a 6163 656e 7420 7061       adjacent pa
-00006a90: 7274 6974 696f 6e2e 2049 6620 7573 696e  rtition. If usin
-00006aa0: 6720 616e 206f 6666 7365 7420 6f72 206f  g an offset or o
-00006ab0: 6666 7365 7420 616c 6961 7320 6c69 6b65  ffset alias like
-00006ac0: 2027 3544 272c 0a20 2020 2020 2020 2020   '5D',.         
-00006ad0: 2020 7468 6520 6461 7461 206d 7573 7420    the data must 
-00006ae0: 6861 7665 2061 2060 6044 6174 6574 696d  have a ``Datetim
-00006af0: 6549 6e64 6578 6060 0a20 2020 2020 2020  eIndex``.       
-00006b00: 206d 696e 5f70 6572 696f 6473 203a 2069   min_periods : i
-00006b10: 6e74 2c20 6465 6661 756c 7420 4e6f 6e65  nt, default None
-00006b20: 0a20 2020 2020 2020 2020 2020 204d 696e  .            Min
-00006b30: 696d 756d 206e 756d 6265 7220 6f66 206f  imum number of o
-00006b40: 6273 6572 7661 7469 6f6e 7320 696e 2077  bservations in w
-00006b50: 696e 646f 7720 7265 7175 6972 6564 2074  indow required t
-00006b60: 6f20 6861 7665 2061 2076 616c 7565 0a20  o have a value. 
-00006b70: 2020 2020 2020 2020 2020 2028 6f74 6865             (othe
-00006b80: 7277 6973 6520 7265 7375 6c74 2069 7320  rwise result is 
-00006b90: 4e41 292e 0a20 2020 2020 2020 2063 656e  NA)..        cen
-00006ba0: 7465 7220 3a20 626f 6f6c 6561 6e2c 2064  ter : boolean, d
-00006bb0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-00006bc0: 2020 2020 2020 2020 2053 6574 2074 6865           Set the
-00006bd0: 206c 6162 656c 7320 6174 2074 6865 2063   labels at the c
-00006be0: 656e 7465 7220 6f66 2074 6865 2077 696e  enter of the win
-00006bf0: 646f 772e 0a20 2020 2020 2020 2077 696e  dow..        win
-00006c00: 5f74 7970 6520 3a20 7374 7269 6e67 2c20  _type : string, 
-00006c10: 6465 6661 756c 7420 4e6f 6e65 0a20 2020  default None.   
-00006c20: 2020 2020 2020 2020 2050 726f 7669 6465           Provide
-00006c30: 2061 2077 696e 646f 7720 7479 7065 2e20   a window type. 
-00006c40: 5468 6520 7265 636f 676e 697a 6564 2077  The recognized w
-00006c50: 696e 646f 7720 7479 7065 7320 6172 6520  indow types are 
-00006c60: 6964 656e 7469 6361 6c0a 2020 2020 2020  identical.      
-00006c70: 2020 2020 2020 746f 2070 616e 6461 732e        to pandas.
-00006c80: 0a20 2020 2020 2020 2061 7869 7320 3a20  .        axis : 
-00006c90: 696e 742c 2073 7472 2c20 4e6f 6e65 2c20  int, str, None, 
-00006ca0: 6465 6661 756c 7420 300a 2020 2020 2020  default 0.      
-00006cb0: 2020 2020 2020 5468 6973 2070 6172 616d        This param
-00006cc0: 6574 6572 2069 7320 6465 7072 6563 6174  eter is deprecat
-00006cd0: 6564 2077 6974 6820 6060 7061 6e64 6173  ed with ``pandas
-00006ce0: 3e3d 322e 3160 602e 0a0a 2020 2020 2020  >=2.1``...      
-00006cf0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00006d00: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00006d10: 2020 6120 526f 6c6c 696e 6720 6f62 6a65    a Rolling obje
-00006d20: 6374 206f 6e20 7768 6963 6820 746f 2063  ct on which to c
-00006d30: 616c 6c20 6120 6d65 7468 6f64 2074 6f20  all a method to 
-00006d40: 636f 6d70 7574 6520 6120 7374 6174 6973  compute a statis
-00006d50: 7469 630a 2020 2020 2020 2020 2222 220a  tic.        """.
-00006d60: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00006d70: 6b5f 6578 7072 2e5f 726f 6c6c 696e 6720  k_expr._rolling 
-00006d80: 696d 706f 7274 2052 6f6c 6c69 6e67 0a0a  import Rolling..
-00006d90: 2020 2020 2020 2020 7265 7475 726e 2052          return R
-00006da0: 6f6c 6c69 6e67 2873 656c 662c 2077 696e  olling(self, win
-00006db0: 646f 772c 202a 2a6b 7761 7267 7329 0a0a  dow, **kwargs)..
-00006dc0: 2020 2020 4069 6e73 6572 745f 6d65 7461      @insert_meta
-00006dd0: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
-00006de0: 6f6e 2870 6164 3d31 3229 0a20 2020 2064  on(pad=12).    d
-00006df0: 6566 206d 6170 5f70 6172 7469 7469 6f6e  ef map_partition
-00006e00: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00006e10: 0a20 2020 2020 2020 2066 756e 632c 0a20  .        func,. 
-00006e20: 2020 2020 2020 202a 6172 6773 2c0a 2020         *args,.  
-00006e30: 2020 2020 2020 6d65 7461 3d6e 6f5f 6465        meta=no_de
-00006e40: 6661 756c 742c 0a20 2020 2020 2020 2065  fault,.        e
-00006e50: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-00006e60: 5472 7565 2c0a 2020 2020 2020 2020 7472  True,.        tr
-00006e70: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
-00006e80: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
-00006e90: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
-00006ea0: 4661 6c73 652c 0a20 2020 2020 2020 2061  False,.        a
-00006eb0: 6c69 676e 5f64 6174 6166 7261 6d65 733d  lign_dataframes=
-00006ec0: 4661 6c73 652c 0a20 2020 2020 2020 2070  False,.        p
-00006ed0: 6172 656e 745f 6d65 7461 3d4e 6f6e 652c  arent_meta=None,
-00006ee0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-00006ef0: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
-00006f00: 2020 2222 2241 7070 6c79 2061 2050 7974    """Apply a Pyt
-00006f10: 686f 6e20 6675 6e63 7469 6f6e 2074 6f20  hon function to 
-00006f20: 6561 6368 2070 6172 7469 7469 6f6e 0a0a  each partition..
-00006f30: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00006f40: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00006f50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6675  -----.        fu
-00006f60: 6e63 203a 2066 756e 6374 696f 6e0a 2020  nc : function.  
-00006f70: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
-00006f80: 6f6e 2061 7070 6c69 6564 2074 6f20 6561  on applied to ea
-00006f90: 6368 2070 6172 7469 7469 6f6e 2e0a 2020  ch partition..  
-00006fa0: 2020 2020 2020 6172 6773 2c20 6b77 6172        args, kwar
-00006fb0: 6773 203a 0a20 2020 2020 2020 2020 2020  gs :.           
-00006fc0: 2041 7267 756d 656e 7473 2061 6e64 206b   Arguments and k
-00006fd0: 6579 776f 7264 7320 746f 2070 6173 7320  eywords to pass 
-00006fe0: 746f 2074 6865 2066 756e 6374 696f 6e2e  to the function.
-00006ff0: 2041 7267 756d 656e 7473 2061 6e64 0a20   Arguments and. 
-00007000: 2020 2020 2020 2020 2020 206b 6579 776f             keywo
-00007010: 7264 7320 6d61 7920 636f 6e74 6169 6e20  rds may contain 
-00007020: 6060 4672 616d 6542 6173 6560 6020 6f72  ``FrameBase`` or
-00007030: 2072 6567 756c 6172 2070 7974 686f 6e20   regular python 
-00007040: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
-00007050: 2020 2020 2044 6174 6146 7261 6d65 2d6c       DataFrame-l
-00007060: 696b 6520 6172 6773 2028 626f 7468 2064  ike args (both d
-00007070: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
-00007080: 6d75 7374 2068 6176 6520 7468 6520 7361  must have the sa
-00007090: 6d65 0a20 2020 2020 2020 2020 2020 206e  me.            n
-000070a0: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
-000070b0: 6f6e 7320 6173 2060 6073 656c 6660 6020  ons as ``self`` 
-000070c0: 6f72 2063 6f6d 7072 6973 6520 6120 7369  or comprise a si
-000070d0: 6e67 6c65 2070 6172 7469 7469 6f6e 2e0a  ngle partition..
-000070e0: 2020 2020 2020 2020 2020 2020 4b65 792d              Key-
-000070f0: 776f 7264 2061 7267 756d 656e 7473 2c20  word arguments, 
-00007100: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
-00007110: 2061 7267 756d 656e 7473 2c20 616e 6420   arguments, and 
-00007120: 6765 6e65 7261 6c0a 2020 2020 2020 2020  general.        
-00007130: 2020 2020 7079 7468 6f6e 2d6f 626a 6563      python-objec
-00007140: 7420 6172 6775 6d65 6e74 7320 7769 6c6c  t arguments will
-00007150: 2062 6520 6272 6f61 6463 6173 7465 6420   be broadcasted 
-00007160: 746f 2061 6c6c 2070 6172 7469 7469 6f6e  to all partition
-00007170: 732e 0a20 2020 2020 2020 2065 6e66 6f72  s..        enfor
-00007180: 6365 5f6d 6574 6164 6174 6120 3a20 626f  ce_metadata : bo
-00007190: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
-000071a0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-000071b0: 7468 6572 2074 6f20 656e 666f 7263 6520  ther to enforce 
-000071c0: 6174 2072 756e 7469 6d65 2074 6861 7420  at runtime that 
-000071d0: 7468 6520 7374 7275 6374 7572 6520 6f66  the structure of
-000071e0: 2074 6865 2044 6174 6146 7261 6d65 0a20   the DataFrame. 
-000071f0: 2020 2020 2020 2020 2020 2070 726f 6475             produ
-00007200: 6365 6420 6279 2060 6066 756e 6360 6020  ced by ``func`` 
-00007210: 6163 7475 616c 6c79 206d 6174 6368 6573  actually matches
-00007220: 2074 6865 2073 7472 7563 7475 7265 206f   the structure o
-00007230: 6620 6060 6d65 7461 6060 2e0a 2020 2020  f ``meta``..    
-00007240: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
-00007250: 6c20 7265 6e61 6d65 2061 6e64 2072 656f  l rename and reo
-00007260: 7264 6572 2063 6f6c 756d 6e73 2066 6f72  rder columns for
-00007270: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
-00007280: 2061 6e64 2077 696c 6c0a 2020 2020 2020   and will.      
-00007290: 2020 2020 2020 7261 6973 6520 616e 2065        raise an e
-000072a0: 7272 6f72 2069 6620 7468 6973 2064 6f65  rror if this doe
-000072b0: 736e 2774 2077 6f72 6b2c 2062 7574 2069  sn't work, but i
-000072c0: 7420 776f 6e27 7420 7261 6973 6520 6966  t won't raise if
-000072d0: 2064 7479 7065 730a 2020 2020 2020 2020   dtypes.        
-000072e0: 2020 2020 646f 6e27 7420 6d61 7463 682e      don't match.
-000072f0: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
-00007300: 726d 5f64 6976 6973 696f 6e73 203a 2062  rm_divisions : b
-00007310: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
-00007320: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
-00007330: 6574 6865 7220 746f 2061 7070 6c79 2074  ether to apply t
-00007340: 6865 2066 756e 6374 696f 6e20 6f6e 746f  he function onto
-00007350: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
-00007360: 6e64 2061 7070 6c79 2074 686f 7365 0a20  nd apply those. 
-00007370: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00007380: 666f 726d 6564 2064 6976 6973 696f 6e73  formed divisions
-00007390: 2074 6f20 7468 6520 6f75 7470 7574 2e0a   to the output..
-000073a0: 2020 2020 2020 2020 636c 6561 725f 6469          clear_di
-000073b0: 7669 7369 6f6e 7320 3a20 626f 6f6c 2c20  visions : bool, 
-000073c0: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-000073d0: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-000073e0: 7220 6469 7669 7369 6f6e 7320 7368 6f75  r divisions shou
-000073f0: 6c64 2062 6520 636c 6561 7265 642e 2049  ld be cleared. I
-00007400: 6620 5472 7565 2c20 6074 7261 6e73 666f  f True, `transfo
-00007410: 726d 5f64 6976 6973 696f 6e73 600a 2020  rm_divisions`.  
-00007420: 2020 2020 2020 2020 2020 7769 6c6c 2062            will b
-00007430: 6520 6967 6e6f 7265 642e 0a20 2020 2020  e ignored..     
-00007440: 2020 2024 4d45 5441 0a0a 2020 2020 2020     $META..      
-00007450: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-00007460: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00007470: 2020 2020 4769 7665 6e20 6120 4461 7461      Given a Data
-00007480: 4672 616d 652c 2053 6572 6965 732c 206f  Frame, Series, o
-00007490: 7220 496e 6465 782c 2073 7563 6820 6173  r Index, such as
-000074a0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2069  :..        >>> i
-000074b0: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
-000074c0: 7064 0a20 2020 2020 2020 203e 3e3e 2069  pd.        >>> i
-000074d0: 6d70 6f72 7420 6461 736b 5f65 7870 7220  mport dask_expr 
-000074e0: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
-000074f0: 3e20 6466 203d 2070 642e 4461 7461 4672  > df = pd.DataFr
-00007500: 616d 6528 7b27 7827 3a20 5b31 2c20 322c  ame({'x': [1, 2,
-00007510: 2033 2c20 342c 2035 5d2c 0a20 2020 2020   3, 4, 5],.     
-00007520: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00007530: 2020 2020 2020 2020 2020 2779 273a 205b            'y': [
-00007540: 312e 2c20 322e 2c20 332e 2c20 342e 2c20  1., 2., 3., 4., 
-00007550: 352e 5d7d 290a 2020 2020 2020 2020 3e3e  5.]}).        >>
-00007560: 3e20 6464 6620 3d20 6464 2e66 726f 6d5f  > ddf = dd.from_
-00007570: 7061 6e64 6173 2864 662c 206e 7061 7274  pandas(df, npart
-00007580: 6974 696f 6e73 3d32 290a 0a20 2020 2020  itions=2)..     
-00007590: 2020 204f 6e65 2063 616e 2075 7365 2060     One can use `
-000075a0: 606d 6170 5f70 6172 7469 7469 6f6e 7360  `map_partitions`
-000075b0: 6020 746f 2061 7070 6c79 2061 2066 756e  ` to apply a fun
-000075c0: 6374 696f 6e20 6f6e 2065 6163 6820 7061  ction on each pa
-000075d0: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
-000075e0: 2045 7874 7261 2061 7267 756d 656e 7473   Extra arguments
-000075f0: 2061 6e64 206b 6579 776f 7264 7320 6361   and keywords ca
-00007600: 6e20 6f70 7469 6f6e 616c 6c79 2062 6520  n optionally be 
-00007610: 7072 6f76 6964 6564 2c20 616e 6420 7769  provided, and wi
-00007620: 6c6c 2062 650a 2020 2020 2020 2020 7061  ll be.        pa
-00007630: 7373 6564 2074 6f20 7468 6520 6675 6e63  ssed to the func
-00007640: 7469 6f6e 2061 6674 6572 2074 6865 2070  tion after the p
-00007650: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
-00007660: 2020 2048 6572 6520 7765 2061 7070 6c79     Here we apply
-00007670: 2061 2066 756e 6374 696f 6e20 7769 7468   a function with
-00007680: 2061 7267 756d 656e 7473 2061 6e64 206b   arguments and k
-00007690: 6579 776f 7264 7320 746f 2061 2044 6174  eywords to a Dat
-000076a0: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
-000076b0: 7265 7375 6c74 696e 6720 696e 2061 2053  resulting in a S
-000076c0: 6572 6965 733a 0a0a 2020 2020 2020 2020  eries:..        
-000076d0: 3e3e 3e20 6465 6620 6d79 6164 6428 6466  >>> def myadd(df
-000076e0: 2c20 612c 2062 3d31 293a 0a20 2020 2020  , a, b=1):.     
-000076f0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
-00007700: 6e20 6466 2e78 202b 2064 662e 7920 2b20  n df.x + df.y + 
-00007710: 6120 2b20 620a 2020 2020 2020 2020 3e3e  a + b.        >>
-00007720: 3e20 7265 7320 3d20 6464 662e 6d61 705f  > res = ddf.map_
-00007730: 7061 7274 6974 696f 6e73 286d 7961 6464  partitions(myadd
-00007740: 2c20 312c 2062 3d32 290a 2020 2020 2020  , 1, b=2).      
-00007750: 2020 3e3e 3e20 7265 732e 6474 7970 650a    >>> res.dtype.
-00007760: 2020 2020 2020 2020 6474 7970 6528 2766          dtype('f
-00007770: 6c6f 6174 3634 2729 0a0a 2020 2020 2020  loat64')..      
-00007780: 2020 4865 7265 2077 6520 6170 706c 7920    Here we apply 
-00007790: 6120 6675 6e63 7469 6f6e 2074 6f20 6120  a function to a 
-000077a0: 5365 7269 6573 2072 6573 756c 7469 6e67  Series resulting
-000077b0: 2069 6e20 6120 5365 7269 6573 3a0a 0a20   in a Series:.. 
-000077c0: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-000077d0: 2064 6466 2e78 2e6d 6170 5f70 6172 7469   ddf.x.map_parti
-000077e0: 7469 6f6e 7328 6c61 6d62 6461 2078 3a20  tions(lambda x: 
-000077f0: 6c65 6e28 7829 2920 2320 6464 662e 7820  len(x)) # ddf.x 
-00007800: 6973 2061 2044 6173 6b20 5365 7269 6573  is a Dask Series
-00007810: 2053 7472 7563 7475 7265 0a20 2020 2020   Structure.     
-00007820: 2020 203e 3e3e 2072 6573 2e64 7479 7065     >>> res.dtype
-00007830: 0a20 2020 2020 2020 2064 7479 7065 2827  .        dtype('
-00007840: 696e 7436 3427 290a 0a20 2020 2020 2020  int64')..       
-00007850: 2042 7920 6465 6661 756c 742c 2064 6173   By default, das
-00007860: 6b20 7472 6965 7320 746f 2069 6e66 6572  k tries to infer
-00007870: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
-00007880: 6461 7461 2062 7920 7275 6e6e 696e 6720  data by running 
-00007890: 796f 7572 0a20 2020 2020 2020 2070 726f  your.        pro
-000078a0: 7669 6465 6420 6675 6e63 7469 6f6e 206f  vided function o
-000078b0: 6e20 736f 6d65 2066 616b 6520 6461 7461  n some fake data
-000078c0: 2e20 5468 6973 2077 6f72 6b73 2077 656c  . This works wel
-000078d0: 6c20 696e 206d 616e 7920 6361 7365 732c  l in many cases,
-000078e0: 2062 7574 0a20 2020 2020 2020 2063 616e   but.        can
-000078f0: 2073 6f6d 6574 696d 6573 2062 6520 6578   sometimes be ex
-00007900: 7065 6e73 6976 652c 206f 7220 6576 656e  pensive, or even
-00007910: 2066 6169 6c2e 2054 6f20 6176 6f69 6420   fail. To avoid 
-00007920: 7468 6973 2c20 796f 7520 6361 6e0a 2020  this, you can.  
-00007930: 2020 2020 2020 6d61 6e75 616c 6c79 2073        manually s
-00007940: 7065 6369 6679 2074 6865 206f 7574 7075  pecify the outpu
-00007950: 7420 6d65 7461 6461 7461 2077 6974 6820  t metadata with 
-00007960: 7468 6520 6060 6d65 7461 6060 206b 6579  the ``meta`` key
-00007970: 776f 7264 2e20 5468 6973 0a20 2020 2020  word. This.     
-00007980: 2020 2063 616e 2062 6520 7370 6563 6966     can be specif
-00007990: 6965 6420 696e 206d 616e 7920 666f 726d  ied in many form
-000079a0: 732c 2066 6f72 206d 6f72 6520 696e 666f  s, for more info
-000079b0: 726d 6174 696f 6e20 7365 650a 2020 2020  rmation see.    
-000079c0: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
-000079d0: 7261 6d65 2e75 7469 6c73 2e6d 616b 655f  rame.utils.make_
-000079e0: 6d65 7461 6060 2e0a 0a20 2020 2020 2020  meta``...       
-000079f0: 2048 6572 6520 7765 2073 7065 6369 6679   Here we specify
-00007a00: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
-00007a10: 2053 6572 6965 7320 7769 7468 206e 6f20   Series with no 
-00007a20: 6e61 6d65 2c20 616e 6420 6474 7970 650a  name, and dtype.
-00007a30: 2020 2020 2020 2020 6060 666c 6f61 7436          ``float6
-00007a40: 3460 603a 0a0a 2020 2020 2020 2020 3e3e  4``:..        >>
-00007a50: 3e20 7265 7320 3d20 6464 662e 6d61 705f  > res = ddf.map_
-00007a60: 7061 7274 6974 696f 6e73 286d 7961 6464  partitions(myadd
-00007a70: 2c20 312c 2062 3d32 2c20 6d65 7461 3d28  , 1, b=2, meta=(
-00007a80: 4e6f 6e65 2c20 2766 3827 2929 0a0a 2020  None, 'f8'))..  
-00007a90: 2020 2020 2020 4865 7265 2077 6520 6d61        Here we ma
-00007aa0: 7020 6120 6675 6e63 7469 6f6e 2074 6861  p a function tha
-00007ab0: 7420 7461 6b65 7320 696e 2061 2044 6174  t takes in a Dat
-00007ac0: 6146 7261 6d65 2c20 616e 6420 7265 7475  aFrame, and retu
-00007ad0: 726e 7320 610a 2020 2020 2020 2020 4461  rns a.        Da
-00007ae0: 7461 4672 616d 6520 7769 7468 2061 206e  taFrame with a n
-00007af0: 6577 2063 6f6c 756d 6e3a 0a0a 2020 2020  ew column:..    
-00007b00: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-00007b10: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-00007b20: 286c 616d 6264 6120 6466 3a20 6466 2e61  (lambda df: df.a
-00007b30: 7373 6967 6e28 7a3d 6466 2e78 202a 2064  ssign(z=df.x * d
-00007b40: 662e 7929 290a 2020 2020 2020 2020 3e3e  f.y)).        >>
-00007b50: 3e20 7265 732e 6474 7970 6573 0a20 2020  > res.dtypes.   
-00007b60: 2020 2020 2078 2020 2020 2020 696e 7436       x      int6
-00007b70: 340a 2020 2020 2020 2020 7920 2020 2066  4.        y    f
-00007b80: 6c6f 6174 3634 0a20 2020 2020 2020 207a  loat64.        z
-00007b90: 2020 2020 666c 6f61 7436 340a 2020 2020      float64.    
-00007ba0: 2020 2020 6474 7970 653a 206f 626a 6563      dtype: objec
-00007bb0: 740a 0a20 2020 2020 2020 2041 7320 6265  t..        As be
-00007bc0: 666f 7265 2c20 7468 6520 6f75 7470 7574  fore, the output
-00007bd0: 206d 6574 6164 6174 6120 6361 6e20 616c   metadata can al
-00007be0: 736f 2062 6520 7370 6563 6966 6965 6420  so be specified 
-00007bf0: 6d61 6e75 616c 6c79 2e20 5468 6973 0a20  manually. This. 
-00007c00: 2020 2020 2020 2074 696d 6520 7765 2070         time we p
-00007c10: 6173 7320 696e 2061 2060 6064 6963 7460  ass in a ``dict`
-00007c20: 602c 2061 7320 7468 6520 6f75 7470 7574  `, as the output
-00007c30: 2069 7320 6120 4461 7461 4672 616d 653a   is a DataFrame:
-00007c40: 0a0a 2020 2020 2020 2020 3e3e 3e20 7265  ..        >>> re
-00007c50: 7320 3d20 6464 662e 6d61 705f 7061 7274  s = ddf.map_part
-00007c60: 6974 696f 6e73 286c 616d 6264 6120 6466  itions(lambda df
-00007c70: 3a20 6466 2e61 7373 6967 6e28 7a3d 6466  : df.assign(z=df
-00007c80: 2e78 202a 2064 662e 7929 2c0a 2020 2020  .x * df.y),.    
-00007c90: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00007ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007cb0: 206d 6574 613d 7b27 7827 3a20 2769 3827   meta={'x': 'i8'
-00007cc0: 2c20 2779 273a 2027 6638 272c 2027 7a27  , 'y': 'f8', 'z'
-00007cd0: 3a20 2766 3827 7d29 0a0a 2020 2020 2020  : 'f8'})..      
-00007ce0: 2020 496e 2074 6865 2063 6173 6520 7768    In the case wh
-00007cf0: 6572 6520 7468 6520 6d65 7461 6461 7461  ere the metadata
-00007d00: 2064 6f65 736e 2774 2063 6861 6e67 652c   doesn't change,
-00007d10: 2079 6f75 2063 616e 2061 6c73 6f20 7061   you can also pa
-00007d20: 7373 2069 6e0a 2020 2020 2020 2020 7468  ss in.        th
-00007d30: 6520 6f62 6a65 6374 2069 7473 656c 6620  e object itself 
-00007d40: 6469 7265 6374 6c79 3a0a 0a20 2020 2020  directly:..     
-00007d50: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
-00007d60: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00007d70: 6c61 6d62 6461 2064 663a 2064 662e 6865  lambda df: df.he
-00007d80: 6164 2829 2c20 6d65 7461 3d64 6466 290a  ad(), meta=ddf).
-00007d90: 0a20 2020 2020 2020 2041 6c73 6f20 6e6f  .        Also no
-00007da0: 7465 2074 6861 7420 7468 6520 696e 6465  te that the inde
-00007db0: 7820 616e 6420 6469 7669 7369 6f6e 7320  x and divisions 
-00007dc0: 6172 6520 6173 7375 6d65 6420 746f 2072  are assumed to r
-00007dd0: 656d 6169 6e20 756e 6368 616e 6765 642e  emain unchanged.
-00007de0: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
-00007df0: 6675 6e63 7469 6f6e 2079 6f75 2772 6520  function you're 
-00007e00: 6d61 7070 696e 6720 6368 616e 6765 7320  mapping changes 
-00007e10: 7468 6520 696e 6465 782f 6469 7669 7369  the index/divisi
-00007e20: 6f6e 732c 2079 6f75 276c 6c20 6e65 6564  ons, you'll need
-00007e30: 0a20 2020 2020 2020 2074 6f20 7061 7373  .        to pass
-00007e40: 2060 6063 6c65 6172 5f64 6976 6973 696f   ``clear_divisio
-00007e50: 6e73 3d54 7275 6560 602e 0a0a 2020 2020  ns=True``...    
-00007e60: 2020 2020 3e3e 3e20 6464 662e 6d61 705f      >>> ddf.map_
-00007e70: 7061 7274 6974 696f 6e73 2866 756e 632c  partitions(func,
-00007e80: 2063 6c65 6172 5f64 6976 6973 696f 6e73   clear_divisions
-00007e90: 3d54 7275 6529 2020 2320 646f 6374 6573  =True)  # doctes
-00007ea0: 743a 202b 534b 4950 0a0a 2020 2020 2020  t: +SKIP..      
-00007eb0: 2020 596f 7572 206d 6170 2066 756e 6374    Your map funct
-00007ec0: 696f 6e20 6765 7473 2069 6e66 6f72 6d61  ion gets informa
-00007ed0: 7469 6f6e 2061 626f 7574 2077 6865 7265  tion about where
-00007ee0: 2069 7420 6973 2069 6e20 7468 6520 6461   it is in the da
-00007ef0: 7461 6672 616d 6520 6279 0a20 2020 2020  taframe by.     
-00007f00: 2020 2061 6363 6570 7469 6e67 2061 2073     accepting a s
-00007f10: 7065 6369 616c 2060 6070 6172 7469 7469  pecial ``partiti
-00007f20: 6f6e 5f69 6e66 6f60 6020 6b65 7977 6f72  on_info`` keywor
-00007f30: 6420 6172 6775 6d65 6e74 2e0a 0a20 2020  d argument...   
-00007f40: 2020 2020 203e 3e3e 2064 6566 2066 756e       >>> def fun
-00007f50: 6328 7061 7274 6974 696f 6e2c 2070 6172  c(partition, par
-00007f60: 7469 7469 6f6e 5f69 6e66 6f3d 4e6f 6e65  tition_info=None
-00007f70: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
-00007f80: 2020 2070 6173 730a 0a20 2020 2020 2020     pass..       
-00007f90: 2054 6869 7320 7769 6c6c 2072 6563 6569   This will recei
-00007fa0: 7665 2074 6865 2066 6f6c 6c6f 7769 6e67  ve the following
-00007fb0: 2069 6e66 6f72 6d61 7469 6f6e 3a0a 0a20   information:.. 
-00007fc0: 2020 2020 2020 203e 3e3e 2070 6172 7469         >>> parti
-00007fd0: 7469 6f6e 5f69 6e66 6f20 2023 2064 6f63  tion_info  # doc
-00007fe0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-00007ff0: 2020 2020 7b27 6e75 6d62 6572 273a 2031      {'number': 1
-00008000: 2c20 2764 6976 6973 696f 6e27 3a20 337d  , 'division': 3}
-00008010: 0a0a 2020 2020 2020 2020 466f 7220 6561  ..        For ea
-00008020: 6368 2061 7267 756d 656e 7420 616e 6420  ch argument and 
-00008030: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00008040: 7320 7468 6174 2061 7265 2064 6173 6b20  s that are dask 
-00008050: 6461 7461 6672 616d 6573 2079 6f75 2077  dataframes you w
-00008060: 696c 6c0a 2020 2020 2020 2020 7265 6365  ill.        rece
-00008070: 6976 6520 7468 6520 6e75 6d62 6572 2028  ive the number (
-00008080: 6e29 2077 6869 6368 2072 6570 7265 7365  n) which represe
-00008090: 6e74 7320 7468 6520 6e74 6820 7061 7274  nts the nth part
-000080a0: 6974 696f 6e20 6f66 2074 6865 2064 6174  ition of the dat
-000080b0: 6166 7261 6d65 0a20 2020 2020 2020 2061  aframe.        a
-000080c0: 6e64 2074 6865 2064 6976 6973 696f 6e20  nd the division 
-000080d0: 2874 6865 2066 6972 7374 2069 6e64 6578  (the first index
-000080e0: 2076 616c 7565 2069 6e20 7468 6520 7061   value in the pa
-000080f0: 7274 6974 696f 6e29 2e20 4966 2064 6976  rtition). If div
-00008100: 6973 696f 6e73 0a20 2020 2020 2020 2061  isions.        a
-00008110: 7265 206e 6f74 206b 6e6f 776e 2028 666f  re not known (fo
-00008120: 7220 696e 7374 616e 6365 2069 6620 7468  r instance if th
-00008130: 6520 696e 6465 7820 6973 206e 6f74 2073  e index is not s
-00008140: 6f72 7465 6429 2074 6865 6e20 796f 7520  orted) then you 
-00008150: 7769 6c6c 2067 6574 0a20 2020 2020 2020  will get.       
-00008160: 204e 6f6e 6520 6173 2074 6865 2064 6976   None as the div
-00008170: 6973 696f 6e2e 0a20 2020 2020 2020 2022  ision..        "
-00008180: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00008190: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
-000081a0: 280a 2020 2020 2020 2020 2020 2020 6675  (.            fu
-000081b0: 6e63 2c0a 2020 2020 2020 2020 2020 2020  nc,.            
-000081c0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-000081d0: 2020 2a61 7267 732c 0a20 2020 2020 2020    *args,.       
-000081e0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-000081f0: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-00008200: 7263 655f 6d65 7461 6461 7461 3d65 6e66  rce_metadata=enf
-00008210: 6f72 6365 5f6d 6574 6164 6174 612c 0a20  orce_metadata,. 
-00008220: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00008230: 666f 726d 5f64 6976 6973 696f 6e73 3d74  form_divisions=t
-00008240: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-00008250: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00008260: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
-00008270: 636c 6561 725f 6469 7669 7369 6f6e 732c  clear_divisions,
-00008280: 0a20 2020 2020 2020 2020 2020 2061 6c69  .            ali
-00008290: 676e 5f64 6174 6166 7261 6d65 733d 616c  gn_dataframes=al
-000082a0: 6967 6e5f 6461 7461 6672 616d 6573 2c0a  ign_dataframes,.
-000082b0: 2020 2020 2020 2020 2020 2020 7061 7265              pare
-000082c0: 6e74 5f6d 6574 613d 7061 7265 6e74 5f6d  nt_meta=parent_m
-000082d0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-000082e0: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
-000082f0: 2020 2029 0a0a 2020 2020 4069 6e73 6572     )..    @inser
-00008300: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
-00008310: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
-00008320: 0a20 2020 2064 6566 206d 6170 5f6f 7665  .    def map_ove
-00008330: 726c 6170 280a 2020 2020 2020 2020 7365  rlap(.        se
-00008340: 6c66 2c0a 2020 2020 2020 2020 6675 6e63  lf,.        func
-00008350: 2c0a 2020 2020 2020 2020 6265 666f 7265  ,.        before
-00008360: 2c0a 2020 2020 2020 2020 6166 7465 722c  ,.        after,
-00008370: 0a20 2020 2020 2020 202a 6172 6773 2c0a  .        *args,.
-00008380: 2020 2020 2020 2020 6d65 7461 3d6e 6f5f          meta=no_
-00008390: 6465 6661 756c 742c 0a20 2020 2020 2020  default,.       
-000083a0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-000083b0: 613d 5472 7565 2c0a 2020 2020 2020 2020  a=True,.        
-000083c0: 7472 616e 7366 6f72 6d5f 6469 7669 7369  transform_divisi
-000083d0: 6f6e 733d 5472 7565 2c0a 2020 2020 2020  ons=True,.      
-000083e0: 2020 636c 6561 725f 6469 7669 7369 6f6e    clear_division
-000083f0: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
-00008400: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
-00008410: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
-00008420: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
-00008430: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
-00008440: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
-00008450: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
-00008460: 2073 6861 7269 6e67 2072 6f77 7320 7769   sharing rows wi
-00008470: 7468 2061 646a 6163 656e 7420 7061 7274  th adjacent part
-00008480: 6974 696f 6e73 2e0a 0a20 2020 2020 2020  itions...       
-00008490: 2054 6869 7320 6361 6e20 6265 2075 7365   This can be use
-000084a0: 6675 6c20 666f 7220 696d 706c 656d 656e  ful for implemen
-000084b0: 7469 6e67 2077 696e 646f 7769 6e67 2066  ting windowing f
-000084c0: 756e 6374 696f 6e73 2073 7563 6820 6173  unctions such as
-000084d0: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
-000084e0: 6c6c 696e 6728 2e2e 2e29 2e6d 6561 6e28  lling(...).mean(
-000084f0: 2960 6020 6f72 2060 6064 662e 6469 6666  )`` or ``df.diff
-00008500: 2829 6060 2e0a 0a20 2020 2020 2020 2050  ()``...        P
-00008510: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00008520: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00008530: 2020 2020 2066 756e 6320 3a20 6675 6e63       func : func
-00008540: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00008550: 2046 756e 6374 696f 6e20 6170 706c 6965   Function applie
-00008560: 6420 746f 2065 6163 6820 7061 7274 6974  d to each partit
-00008570: 696f 6e2e 0a20 2020 2020 2020 2062 6566  ion..        bef
-00008580: 6f72 6520 3a20 696e 742c 2074 696d 6564  ore : int, timed
-00008590: 656c 7461 206f 7220 7374 7269 6e67 2074  elta or string t
-000085a0: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
-000085b0: 2020 2020 2054 6865 2072 6f77 7320 746f       The rows to
-000085c0: 2070 7265 7065 6e64 2074 6f20 7061 7274   prepend to part
-000085d0: 6974 696f 6e20 6060 6960 6020 6672 6f6d  ition ``i`` from
-000085e0: 2074 6865 2065 6e64 206f 660a 2020 2020   the end of.    
-000085f0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00008600: 6e20 6060 6920 2d20 3160 602e 0a20 2020  n ``i - 1``..   
-00008610: 2020 2020 2061 6674 6572 203a 2069 6e74       after : int
-00008620: 2c20 7469 6d65 6465 6c74 6120 6f72 2073  , timedelta or s
-00008630: 7472 696e 6720 7469 6d65 6465 6c74 610a  tring timedelta.
-00008640: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00008650: 726f 7773 2074 6f20 6170 7065 6e64 2074  rows to append t
-00008660: 6f20 7061 7274 6974 696f 6e20 6060 6960  o partition ``i`
-00008670: 6020 6672 6f6d 2074 6865 2062 6567 696e  ` from the begin
-00008680: 6e69 6e67 0a20 2020 2020 2020 2020 2020  ning.           
-00008690: 206f 6620 7061 7274 6974 696f 6e20 6060   of partition ``
-000086a0: 6920 2b20 3160 602e 0a20 2020 2020 2020  i + 1``..       
-000086b0: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
-000086c0: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
-000086d0: 7469 6f6e 616c 2061 6e64 206b 6579 776f  tional and keywo
-000086e0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
-000086f0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
-00008700: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-00008710: 2020 506f 7369 7469 6f6e 616c 2061 7267    Positional arg
-00008720: 756d 656e 7473 2061 7265 2063 6f6d 7075  uments are compu
-00008730: 7465 6420 6f6e 2061 2070 6572 2d70 6172  ted on a per-par
-00008740: 7469 7469 6f6e 2062 6173 6973 2c20 7768  tition basis, wh
-00008750: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
-00008760: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00008770: 7320 6172 6520 7368 6172 6564 2061 6372  s are shared acr
-00008780: 6f73 7320 616c 6c20 7061 7274 6974 696f  oss all partitio
-00008790: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
-000087a0: 6e0a 2020 2020 2020 2020 2020 2020 6974  n.            it
-000087b0: 7365 6c66 2077 696c 6c20 6265 2074 6865  self will be the
-000087c0: 2066 6972 7374 2070 6f73 6974 696f 6e61   first positiona
-000087d0: 6c20 6172 6775 6d65 6e74 2c20 7769 7468  l argument, with
-000087e0: 2061 6c6c 206f 7468 6572 0a20 2020 2020   all other.     
-000087f0: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
-00008800: 2070 6173 7365 6420 2a61 6674 6572 2a2e   passed *after*.
-00008810: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
-00008820: 6520 6060 5363 616c 6172 6060 2c20 6060  e ``Scalar``, ``
-00008830: 4465 6c61 7965 6460 602c 0a20 2020 2020  Delayed``,.     
-00008840: 2020 2020 2020 206f 7220 7265 6775 6c61         or regula
-00008850: 7220 5079 7468 6f6e 206f 626a 6563 7473  r Python objects
-00008860: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
-00008870: 2061 7267 7320 2862 6f74 6820 6461 736b   args (both dask
-00008880: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00008890: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
-000088a0: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
-000088b0: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
-000088c0: 7373 6172 7929 2062 6566 6f72 650a 2020  ssary) before.  
-000088d0: 2020 2020 2020 2020 2020 6170 706c 7969            applyi
-000088e0: 6e67 2074 6865 2066 756e 6374 696f 6e3b  ng the function;
-000088f0: 2073 6565 2060 6061 6c69 676e 5f64 6174   see ``align_dat
-00008900: 6166 7261 6d65 7360 6020 746f 2063 6f6e  aframes`` to con
-00008910: 7472 6f6c 2074 6869 730a 2020 2020 2020  trol this.      
-00008920: 2020 2020 2020 6265 6861 7669 6f72 2e0a        behavior..
-00008930: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-00008940: 6d65 7461 6461 7461 203a 2062 6f6f 6c2c  metadata : bool,
-00008950: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
-00008960: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-00008970: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
-00008980: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
-00008990: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
-000089a0: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
-000089b0: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
-000089c0: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
-000089d0: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
-000089e0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
-000089f0: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
-00008a00: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
-00008a10: 656e 616d 6520 616e 6420 7265 6f72 6465  ename and reorde
-00008a20: 7220 636f 6c75 6d6e 7320 666f 7220 6561  r columns for ea
-00008a30: 6368 2070 6172 7469 7469 6f6e 2c0a 2020  ch partition,.  
-00008a40: 2020 2020 2020 2020 2020 616e 6420 7769            and wi
-00008a50: 6c6c 2072 6169 7365 2061 6e20 6572 726f  ll raise an erro
-00008a60: 7220 6966 2074 6869 7320 646f 6573 6e27  r if this doesn'
-00008a70: 7420 776f 726b 2c0a 2020 2020 2020 2020  t work,.        
-00008a80: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
-00008a90: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
-00008aa0: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
-00008ab0: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
-00008ac0: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
-00008ad0: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-00008ae0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00008af0: 6572 2074 6f20 6170 706c 7920 7468 6520  er to apply the 
-00008b00: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
-00008b10: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
-00008b20: 6170 706c 7920 7468 6f73 650a 2020 2020  apply those.    
-00008b30: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-00008b40: 6d65 6420 6469 7669 7369 6f6e 7320 746f  med divisions to
-00008b50: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
-00008b60: 2020 2020 2061 6c69 676e 5f64 6174 6166       align_dataf
-00008b70: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
-00008b80: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-00008b90: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00008ba0: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
-00008bb0: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
-00008bc0: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
-00008bd0: 2020 2020 2020 2020 2028 626f 7468 2064           (both d
-00008be0: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
-00008bf0: 736f 2074 6865 6972 2064 6976 6973 696f  so their divisio
-00008c00: 6e73 2061 6c69 676e 2062 6566 6f72 6520  ns align before 
-00008c10: 6170 706c 7969 6e67 0a20 2020 2020 2020  applying.       
-00008c20: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
-00008c30: 6e2e 2054 6869 7320 7265 7175 6972 6573  n. This requires
-00008c40: 2061 6c6c 2069 6e70 7574 7320 746f 2068   all inputs to h
-00008c50: 6176 6520 6b6e 6f77 6e20 6469 7669 7369  ave known divisi
-00008c60: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-00008c70: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
-00008c80: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
-00008c90: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
-00008ca0: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
-00008cb0: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00008cc0: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
-00008cd0: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
-00008ce0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
-00008cf0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-00008d00: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
-00008d10: 2061 2073 696e 676c 6520 7061 7274 6974   a single partit
-00008d20: 696f 6e2e 2053 696e 676c 652d 7061 7274  ion. Single-part
-00008d30: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
-00008d40: 6c20 6265 2062 726f 6164 6361 7374 2074  l be broadcast t
-00008d50: 6f0a 2020 2020 2020 2020 2020 2020 6576  o.            ev
-00008d60: 6572 7920 7061 7274 6974 696f 6e20 6f66  ery partition of
-00008d70: 206d 756c 7469 2d70 6172 7469 7469 6f6e   multi-partition
-00008d80: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
-00008d90: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
-00008da0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
-00008db0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
-00008dc0: 6e20 706f 7369 7469 7665 2069 6e74 6567  n positive integ
-00008dd0: 6572 7320 6060 6265 666f 7265 6060 2061  ers ``before`` a
-00008de0: 6e64 2060 6061 6674 6572 6060 2c20 616e  nd ``after``, an
-00008df0: 6420 6120 6675 6e63 7469 6f6e 0a20 2020  d a function.   
-00008e00: 2020 2020 2060 6066 756e 6360 602c 2060       ``func``, `
-00008e10: 606d 6170 5f6f 7665 726c 6170 6060 2064  `map_overlap`` d
-00008e20: 6f65 7320 7468 6520 666f 6c6c 6f77 696e  oes the followin
-00008e30: 673a 0a0a 2020 2020 2020 2020 312e 2050  g:..        1. P
-00008e40: 7265 7065 6e64 2060 6062 6566 6f72 6560  repend ``before`
-00008e50: 6020 726f 7773 2074 6f20 6561 6368 2070  ` rows to each p
-00008e60: 6172 7469 7469 6f6e 2060 6069 6060 2066  artition ``i`` f
-00008e70: 726f 6d20 7468 6520 656e 6420 6f66 0a20  rom the end of. 
-00008e80: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00008e90: 696f 6e20 6060 6920 2d20 3160 602e 2054  ion ``i - 1``. T
-00008ea0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
-00008eb0: 6f6e 2068 6173 206e 6f20 726f 7773 2070  on has no rows p
-00008ec0: 7265 7065 6e64 6564 2e0a 0a20 2020 2020  repended...     
-00008ed0: 2020 2032 2e20 4170 7065 6e64 2060 6061     2. Append ``a
-00008ee0: 6674 6572 6060 2072 6f77 7320 746f 2065  fter`` rows to e
-00008ef0: 6163 6820 7061 7274 6974 696f 6e20 6060  ach partition ``
-00008f00: 6960 6020 6672 6f6d 2074 6865 2062 6567  i`` from the beg
-00008f10: 696e 6e69 6e67 206f 660a 2020 2020 2020  inning of.      
-00008f20: 2020 2020 2070 6172 7469 7469 6f6e 2060       partition `
-00008f30: 6069 202b 2031 6060 2e20 5468 6520 6c61  `i + 1``. The la
-00008f40: 7374 2070 6172 7469 7469 6f6e 2068 6173  st partition has
-00008f50: 206e 6f20 726f 7773 2061 7070 656e 6465   no rows appende
-00008f60: 642e 0a0a 2020 2020 2020 2020 332e 2041  d...        3. A
-00008f70: 7070 6c79 2060 6066 756e 6360 6020 746f  pply ``func`` to
-00008f80: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
-00008f90: 2070 6173 7369 6e67 2069 6e20 616e 7920   passing in any 
-00008fa0: 6578 7472 6120 6060 6172 6773 6060 2061  extra ``args`` a
-00008fb0: 6e64 0a20 2020 2020 2020 2020 2020 6060  nd.           ``
-00008fc0: 6b77 6172 6773 6060 2069 6620 7072 6f76  kwargs`` if prov
-00008fd0: 6964 6564 2e0a 0a20 2020 2020 2020 2034  ided...        4
-00008fe0: 2e20 5472 696d 2060 6062 6566 6f72 6560  . Trim ``before`
-00008ff0: 6020 726f 7773 2066 726f 6d20 7468 6520  ` rows from the 
-00009000: 6265 6769 6e6e 696e 6720 6f66 2061 6c6c  beginning of all
-00009010: 2062 7574 2074 6865 2066 6972 7374 0a20   but the first. 
-00009020: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00009030: 696f 6e2e 0a0a 2020 2020 2020 2020 352e  ion...        5.
-00009040: 2054 7269 6d20 6060 6166 7465 7260 6020   Trim ``after`` 
-00009050: 726f 7773 2066 726f 6d20 7468 6520 656e  rows from the en
-00009060: 6420 6f66 2061 6c6c 2062 7574 2074 6865  d of all but the
-00009070: 206c 6173 7420 7061 7274 6974 696f 6e2e   last partition.
-00009080: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00009090: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-000090a0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
-000090b0: 6e20 6120 4461 7461 4672 616d 652c 2053  n a DataFrame, S
-000090c0: 6572 6965 732c 206f 7220 496e 6465 782c  eries, or Index,
-000090d0: 2073 7563 6820 6173 3a0a 0a20 2020 2020   such as:..     
-000090e0: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
-000090f0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
-00009100: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00009110: 736b 5f65 7870 7220 6173 2064 640a 2020  sk_expr as dd.  
-00009120: 2020 2020 2020 3e3e 3e20 6466 203d 2070        >>> df = p
-00009130: 642e 4461 7461 4672 616d 6528 7b27 7827  d.DataFrame({'x'
-00009140: 3a20 5b31 2c20 322c 2034 2c20 372c 2031  : [1, 2, 4, 7, 1
-00009150: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
-00009160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009170: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
-00009180: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
-00009190: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
-000091a0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-000091b0: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
-000091c0: 3229 0a0a 2020 2020 2020 2020 4120 726f  2)..        A ro
-000091d0: 6c6c 696e 6720 7375 6d20 7769 7468 2061  lling sum with a
-000091e0: 2074 7261 696c 696e 6720 6d6f 7669 6e67   trailing moving
-000091f0: 2077 696e 646f 7720 6f66 2073 697a 6520   window of size 
-00009200: 3220 6361 6e20 6265 2063 6f6d 7075 7465  2 can be compute
-00009210: 6420 6279 0a20 2020 2020 2020 206f 7665  d by.        ove
-00009220: 726c 6170 7069 6e67 2032 2072 6f77 7320  rlapping 2 rows 
-00009230: 6265 666f 7265 2065 6163 6820 7061 7274  before each part
-00009240: 6974 696f 6e2c 2061 6e64 2074 6865 6e20  ition, and then 
-00009250: 6d61 7070 696e 6720 6361 6c6c 7320 746f  mapping calls to
-00009260: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
-00009270: 6c6c 696e 6728 3229 2e73 756d 2829 6060  lling(2).sum()``
-00009280: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-00009290: 6466 2e63 6f6d 7075 7465 2829 0a20 2020  df.compute().   
-000092a0: 2020 2020 2020 2020 2078 2020 2020 790a           x    y.
-000092b0: 2020 2020 2020 2020 3020 2020 3120 2031          0   1  1
-000092c0: 2e30 0a20 2020 2020 2020 2031 2020 2032  .0.        1   2
-000092d0: 2020 322e 300a 2020 2020 2020 2020 3220    2.0.        2 
-000092e0: 2020 3420 2033 2e30 0a20 2020 2020 2020    4  3.0.       
-000092f0: 2033 2020 2037 2020 342e 300a 2020 2020   3   7  4.0.    
-00009300: 2020 2020 3420 2031 3120 2035 2e30 0a20      4  11  5.0. 
-00009310: 2020 2020 2020 203e 3e3e 2064 6466 2e6d         >>> ddf.m
-00009320: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
-00009330: 6120 6466 3a20 6466 2e72 6f6c 6c69 6e67  a df: df.rolling
-00009340: 2832 292e 7375 6d28 292c 2032 2c20 3029  (2).sum(), 2, 0)
-00009350: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00009360: 2020 2020 2020 2020 2078 2020 2020 790a           x    y.
-00009370: 2020 2020 2020 2020 3020 2020 4e61 4e20          0   NaN 
-00009380: 204e 614e 0a20 2020 2020 2020 2031 2020   NaN.        1  
-00009390: 2033 2e30 2020 332e 300a 2020 2020 2020   3.0  3.0.      
-000093a0: 2020 3220 2020 362e 3020 2035 2e30 0a20    2   6.0  5.0. 
-000093b0: 2020 2020 2020 2033 2020 3131 2e30 2020         3  11.0  
-000093c0: 372e 300a 2020 2020 2020 2020 3420 2031  7.0.        4  1
-000093d0: 382e 3020 2039 2e30 0a0a 2020 2020 2020  8.0  9.0..      
-000093e0: 2020 5468 6520 7061 6e64 6173 2060 6064    The pandas ``d
-000093f0: 6966 6660 6020 6d65 7468 6f64 2063 6f6d  iff`` method com
-00009400: 7075 7465 7320 6120 6469 7363 7265 7465  putes a discrete
-00009410: 2064 6966 6665 7265 6e63 6520 7368 6966   difference shif
-00009420: 7465 6420 6279 2061 0a20 2020 2020 2020  ted by a.       
-00009430: 206e 756d 6265 7220 6f66 2070 6572 696f   number of perio
-00009440: 6473 2028 6361 6e20 6265 2070 6f73 6974  ds (can be posit
-00009450: 6976 6520 6f72 206e 6567 6174 6976 6529  ive or negative)
-00009460: 2e20 5468 6973 2063 616e 2062 650a 2020  . This can be.  
-00009470: 2020 2020 2020 696d 706c 656d 656e 7465        implemente
-00009480: 6420 6279 206d 6170 7069 6e67 2063 616c  d by mapping cal
-00009490: 6c73 2074 6f20 6060 6466 2e64 6966 6660  ls to ``df.diff`
-000094a0: 6020 746f 2065 6163 6820 7061 7274 6974  ` to each partit
-000094b0: 696f 6e20 6166 7465 720a 2020 2020 2020  ion after.      
-000094c0: 2020 7072 6570 656e 6469 6e67 2f61 7070    prepending/app
-000094d0: 656e 6469 6e67 2074 6861 7420 6d61 6e79  ending that many
-000094e0: 2072 6f77 732c 2064 6570 656e 6469 6e67   rows, depending
-000094f0: 206f 6e20 7369 676e 3a0a 0a20 2020 2020   on sign:..     
-00009500: 2020 203e 3e3e 2064 6566 2064 6966 6628     >>> def diff(
-00009510: 6466 2c20 7065 7269 6f64 733d 3129 3a0a  df, periods=1):.
-00009520: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00009530: 6265 666f 7265 2c20 6166 7465 7220 3d20  before, after = 
-00009540: 2870 6572 696f 6473 2c20 3029 2069 6620  (periods, 0) if 
-00009550: 7065 7269 6f64 7320 3e20 3020 656c 7365  periods > 0 else
-00009560: 2028 302c 202d 7065 7269 6f64 7329 0a20   (0, -periods). 
-00009570: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
-00009580: 6574 7572 6e20 6466 2e6d 6170 5f6f 7665  eturn df.map_ove
-00009590: 726c 6170 286c 616d 6264 6120 6466 2c20  rlap(lambda df, 
-000095a0: 7065 7269 6f64 733d 313a 2064 662e 6469  periods=1: df.di
-000095b0: 6666 2870 6572 696f 6473 292c 0a20 2020  ff(periods),.   
-000095c0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000095d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095e0: 2020 2070 6572 696f 6473 2c20 302c 2070     periods, 0, p
-000095f0: 6572 696f 6473 3d70 6572 696f 6473 290a  eriods=periods).
-00009600: 2020 2020 2020 2020 3e3e 3e20 6469 6666          >>> diff
-00009610: 2864 6466 2c20 3129 2e63 6f6d 7075 7465  (ddf, 1).compute
-00009620: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00009630: 7820 2020 2079 0a20 2020 2020 2020 2030  x    y.        0
-00009640: 2020 4e61 4e20 204e 614e 0a20 2020 2020    NaN  NaN.     
-00009650: 2020 2031 2020 312e 3020 2031 2e30 0a20     1  1.0  1.0. 
-00009660: 2020 2020 2020 2032 2020 322e 3020 2031         2  2.0  1
-00009670: 2e30 0a20 2020 2020 2020 2033 2020 332e  .0.        3  3.
-00009680: 3020 2031 2e30 0a20 2020 2020 2020 2034  0  1.0.        4
-00009690: 2020 342e 3020 2031 2e30 0a0a 2020 2020    4.0  1.0..    
-000096a0: 2020 2020 4966 2079 6f75 2068 6176 6520      If you have 
-000096b0: 6120 6060 4461 7465 7469 6d65 496e 6465  a ``DatetimeInde
-000096c0: 7860 602c 2079 6f75 2063 616e 2075 7365  x``, you can use
-000096d0: 2061 2060 6070 642e 5469 6d65 6465 6c74   a ``pd.Timedelt
-000096e0: 6160 6020 666f 7220 7469 6d65 2d0a 2020  a`` for time-.  
-000096f0: 2020 2020 2020 6261 7365 6420 7769 6e64        based wind
-00009700: 6f77 7320 6f72 2061 6e79 2060 6070 642e  ows or any ``pd.
-00009710: 5469 6d65 6465 6c74 6160 6020 636f 6e76  Timedelta`` conv
-00009720: 6572 7469 626c 6520 7374 7269 6e67 3a0a  ertible string:.
-00009730: 0a20 2020 2020 2020 203e 3e3e 2074 7320  .        >>> ts 
-00009740: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
-00009750: 6528 3130 292c 2069 6e64 6578 3d70 642e  e(10), index=pd.
-00009760: 6461 7465 5f72 616e 6765 2827 3230 3137  date_range('2017
-00009770: 272c 2070 6572 696f 6473 3d31 3029 290a  ', periods=10)).
-00009780: 2020 2020 2020 2020 3e3e 3e20 6474 7320          >>> dts 
-00009790: 3d20 6464 2e66 726f 6d5f 7061 6e64 6173  = dd.from_pandas
-000097a0: 2874 732c 206e 7061 7274 6974 696f 6e73  (ts, npartitions
-000097b0: 3d32 290a 2020 2020 2020 2020 3e3e 3e20  =2).        >>> 
-000097c0: 6474 732e 6d61 705f 6f76 6572 6c61 7028  dts.map_overlap(
-000097d0: 6c61 6d62 6461 2064 663a 2064 662e 726f  lambda df: df.ro
-000097e0: 6c6c 696e 6728 2732 4427 292e 7375 6d28  lling('2D').sum(
-000097f0: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
-00009800: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00009810: 642e 5469 6d65 6465 6c74 6128 2732 4427  d.Timedelta('2D'
-00009820: 292c 2030 292e 636f 6d70 7574 6528 290a  ), 0).compute().
-00009830: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
-00009840: 3031 2020 2020 2030 2e30 0a20 2020 2020  01     0.0.     
-00009850: 2020 2032 3031 372d 3031 2d30 3220 2020     2017-01-02   
-00009860: 2020 312e 300a 2020 2020 2020 2020 3230    1.0.        20
-00009870: 3137 2d30 312d 3033 2020 2020 2033 2e30  17-01-03     3.0
-00009880: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
-00009890: 2d30 3420 2020 2020 352e 300a 2020 2020  -04     5.0.    
-000098a0: 2020 2020 3230 3137 2d30 312d 3035 2020      2017-01-05  
-000098b0: 2020 2037 2e30 0a20 2020 2020 2020 2032     7.0.        2
-000098c0: 3031 372d 3031 2d30 3620 2020 2020 392e  017-01-06     9.
-000098d0: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
-000098e0: 312d 3037 2020 2020 3131 2e30 0a20 2020  1-07    11.0.   
-000098f0: 2020 2020 2032 3031 372d 3031 2d30 3820       2017-01-08 
-00009900: 2020 2031 332e 300a 2020 2020 2020 2020     13.0.        
-00009910: 3230 3137 2d30 312d 3039 2020 2020 3135  2017-01-09    15
-00009920: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
-00009930: 3031 2d31 3020 2020 2031 372e 300a 2020  01-10    17.0.  
-00009940: 2020 2020 2020 4672 6571 3a20 442c 2064        Freq: D, d
-00009950: 7479 7065 3a20 666c 6f61 7436 340a 2020  type: float64.  
-00009960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00009970: 2020 7265 7475 726e 206d 6170 5f6f 7665    return map_ove
-00009980: 726c 6170 280a 2020 2020 2020 2020 2020  rlap(.          
-00009990: 2020 6675 6e63 2c0a 2020 2020 2020 2020    func,.        
-000099a0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000099b0: 2020 2020 2020 6265 666f 7265 2c0a 2020        before,.  
-000099c0: 2020 2020 2020 2020 2020 6166 7465 722c            after,
-000099d0: 0a20 2020 2020 2020 2020 2020 202a 6172  .            *ar
-000099e0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-000099f0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-00009a00: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
-00009a10: 6574 6164 6174 613d 656e 666f 7263 655f  etadata=enforce_
-00009a20: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
-00009a30: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
-00009a40: 6469 7669 7369 6f6e 733d 7472 616e 7366  divisions=transf
-00009a50: 6f72 6d5f 6469 7669 7369 6f6e 732c 0a20  orm_divisions,. 
-00009a60: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
-00009a70: 5f64 6976 6973 696f 6e73 3d63 6c65 6172  _divisions=clear
-00009a80: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
-00009a90: 2020 2020 2020 2020 616c 6967 6e5f 6461          align_da
-00009aa0: 7461 6672 616d 6573 3d61 6c69 676e 5f64  taframes=align_d
-00009ab0: 6174 6166 7261 6d65 732c 0a20 2020 2020  ataframes,.     
-00009ac0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-00009ad0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00009ae0: 6465 6620 7265 7061 7274 6974 696f 6e28  def repartition(
-00009af0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00009b00: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-00009b10: 3a20 7475 706c 6520 7c20 4e6f 6e65 203d  : tuple | None =
-00009b20: 204e 6f6e 652c 0a20 2020 2020 2020 206e   None,.        n
-00009b30: 7061 7274 6974 696f 6e73 3a20 696e 7420  partitions: int 
-00009b40: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00009b50: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00009b60: 5f73 697a 653a 2073 7472 203d 204e 6f6e  _size: str = Non
-00009b70: 652c 0a20 2020 2020 2020 2066 7265 713d  e,.        freq=
-00009b80: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
-00009b90: 7263 653a 2062 6f6f 6c20 3d20 4661 6c73  rce: bool = Fals
-00009ba0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00009bb0: 2020 2222 2252 6570 6172 7469 7469 6f6e    """Repartition
-00009bc0: 2061 2063 6f6c 6c65 6374 696f 6e0a 0a20   a collection.. 
-00009bd0: 2020 2020 2020 2045 7861 6374 6c79 206f         Exactly o
-00009be0: 6e65 206f 6620 6064 6976 6973 696f 6e73  ne of `divisions
-00009bf0: 602c 2060 6e70 6172 7469 7469 6f6e 7360  `, `npartitions`
-00009c00: 206f 7220 6070 6172 7469 7469 6f6e 5f73   or `partition_s
-00009c10: 697a 6560 2073 686f 756c 6420 6265 0a20  ize` should be. 
-00009c20: 2020 2020 2020 2073 7065 6369 6669 6564         specified
-00009c30: 2e20 4120 6060 5661 6c75 6545 7272 6f72  . A ``ValueError
-00009c40: 6060 2077 696c 6c20 6265 2072 6169 7365  `` will be raise
-00009c50: 6420 7768 656e 2074 6861 7420 6973 206e  d when that is n
-00009c60: 6f74 2074 6865 2063 6173 652e 0a0a 2020  ot the case...  
-00009c70: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00009c80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00009c90: 2d2d 2d0a 2020 2020 2020 2020 6469 7669  ---.        divi
-00009ca0: 7369 6f6e 7320 3a20 6c69 7374 2c20 6f70  sions : list, op
-00009cb0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00009cc0: 2020 2054 6865 2022 6469 7669 6469 6e67     The "dividing
-00009cd0: 206c 696e 6573 2220 7573 6564 2074 6f20   lines" used to 
-00009ce0: 7370 6c69 7420 7468 6520 6461 7461 6672  split the datafr
-00009cf0: 616d 6520 696e 746f 2070 6172 7469 7469  ame into partiti
-00009d00: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-00009d10: 2046 6f72 2060 6064 6976 6973 696f 6e73   For ``divisions
-00009d20: 3d5b 302c 2031 302c 2035 302c 2031 3030  =[0, 10, 50, 100
-00009d30: 5d60 602c 2074 6865 7265 2077 6f75 6c64  ]``, there would
-00009d40: 2062 6520 7468 7265 6520 6f75 7470 7574   be three output
-00009d50: 2070 6172 7469 7469 6f6e 732c 0a20 2020   partitions,.   
-00009d60: 2020 2020 2020 2020 2077 6865 7265 2074           where t
-00009d70: 6865 206e 6577 2069 6e64 6578 2063 6f6e  he new index con
-00009d80: 7461 696e 6564 205b 302c 2031 3029 2c20  tained [0, 10), 
-00009d90: 5b31 302c 2035 3029 2c20 616e 6420 5b35  [10, 50), and [5
-00009da0: 302c 2031 3030 292c 2072 6573 7065 6374  0, 100), respect
-00009db0: 6976 656c 792e 0a20 2020 2020 2020 2020  ively..         
-00009dc0: 2020 2053 6565 2068 7474 7073 3a2f 2f64     See https://d
-00009dd0: 6f63 732e 6461 736b 2e6f 7267 2f65 6e2f  ocs.dask.org/en/
-00009de0: 6c61 7465 7374 2f64 6174 6166 7261 6d65  latest/dataframe
-00009df0: 2d64 6573 6967 6e2e 6874 6d6c 2370 6172  -design.html#par
-00009e00: 7469 7469 6f6e 732e 0a20 2020 2020 2020  titions..       
-00009e10: 206e 7061 7274 6974 696f 6e73 203a 2069   npartitions : i
-00009e20: 6e74 2c20 4361 6c6c 6162 6c65 2c20 6f70  nt, Callable, op
-00009e30: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00009e40: 2020 2041 7070 726f 7869 6d61 7465 206e     Approximate n
-00009e50: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
-00009e60: 6f6e 7320 6f66 206f 7574 7075 742e 2054  ons of output. T
-00009e70: 6865 206e 756d 6265 7220 6f66 0a20 2020  he number of.   
-00009e80: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
-00009e90: 6f6e 7320 7573 6564 206d 6179 2062 6520  ons used may be 
-00009ea0: 736c 6967 6874 6c79 206c 6f77 6572 2074  slightly lower t
-00009eb0: 6861 6e20 6e70 6172 7469 7469 6f6e 7320  han npartitions 
-00009ec0: 6465 7065 6e64 696e 670a 2020 2020 2020  depending.      
-00009ed0: 2020 2020 2020 6f6e 2064 6174 6120 6469        on data di
-00009ee0: 7374 7269 6275 7469 6f6e 2c20 6275 7420  stribution, but 
-00009ef0: 7769 6c6c 206e 6576 6572 2062 6520 6869  will never be hi
-00009f00: 6768 6572 2e0a 2020 2020 2020 2020 2020  gher..          
-00009f10: 2020 5468 6520 4361 6c6c 6162 6c65 2067    The Callable g
-00009f20: 6574 7320 7468 6520 6e75 6d62 6572 206f  ets the number o
-00009f30: 6620 7061 7274 6974 696f 6e73 206f 6620  f partitions of 
-00009f40: 7468 6520 696e 7075 7420 6173 2061 6e20  the input as an 
-00009f50: 6172 6775 6d65 6e74 0a20 2020 2020 2020  argument.       
-00009f60: 2020 2020 2061 6e64 2073 686f 756c 6420       and should 
-00009f70: 7265 7475 726e 2061 6e20 696e 742e 0a20  return an int.. 
-00009f80: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00009f90: 5f73 697a 6520 3a20 7374 722c 206f 7074  _size : str, opt
-00009fa0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00009fb0: 2020 4d61 7820 6e75 6d62 6572 206f 6620    Max number of 
-00009fc0: 6279 7465 7320 6f66 206d 656d 6f72 7920  bytes of memory 
-00009fd0: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
-00009fe0: 6f6e 2e20 5573 6520 6e75 6d62 6572 7320  on. Use numbers 
-00009ff0: 6f72 2073 7472 696e 6773 0a20 2020 2020  or strings.     
-0000a000: 2020 2020 2020 206c 696b 6520 354d 422e         like 5MB.
-0000a010: 2049 6620 7370 6563 6966 6965 6420 6e70   If specified np
-0000a020: 6172 7469 7469 6f6e 7320 616e 6420 6469  artitions and di
-0000a030: 7669 7369 6f6e 7320 7769 6c6c 2062 6520  visions will be 
-0000a040: 6967 6e6f 7265 642e 204e 6f74 6520 7468  ignored. Note th
-0000a050: 6174 0a20 2020 2020 2020 2020 2020 2074  at.            t
-0000a060: 6865 2073 697a 6520 7265 666c 6563 7473  he size reflects
-0000a070: 2074 6865 206e 756d 6265 7220 6f66 2062   the number of b
-0000a080: 7974 6573 2075 7365 6420 6173 2063 6f6d  ytes used as com
-0000a090: 7075 7465 6420 6279 0a20 2020 2020 2020  puted by.       
-0000a0a0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
-0000a0b0: 4672 616d 652e 6d65 6d6f 7279 5f75 7361  Frame.memory_usa
-0000a0c0: 6765 2c20 7768 6963 6820 7769 6c6c 206e  ge, which will n
-0000a0d0: 6f74 206e 6563 6573 7361 7269 6c79 206d  ot necessarily m
-0000a0e0: 6174 6368 2074 6865 2073 697a 650a 2020  atch the size.  
-0000a0f0: 2020 2020 2020 2020 2020 7768 656e 2073            when s
-0000a100: 746f 7269 6e67 2074 6f20 6469 736b 2e0a  toring to disk..
-0000a110: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
-0000a120: 7761 726e 696e 673a 3a0a 0a20 2020 2020  warning::..     
-0000a130: 2020 2020 2020 2020 2020 5468 6973 206b            This k
-0000a140: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
-0000a150: 7472 6967 6765 7273 2063 6f6d 7075 7461  triggers computa
-0000a160: 7469 6f6e 2074 6f20 6465 7465 726d 696e  tion to determin
-0000a170: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0000a180: 2074 6865 206d 656d 6f72 7920 7369 7a65   the memory size
-0000a190: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
-0000a1a0: 6f6e 2c20 7768 6963 6820 6d61 7920 6265  on, which may be
-0000a1b0: 2065 7870 656e 7369 7665 2e0a 0a20 2020   expensive...   
-0000a1c0: 2020 2020 2066 6f72 6365 203a 2062 6f6f       force : boo
-0000a1d0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
-0000a1e0: 0a20 2020 2020 2020 2020 2020 2041 6c6c  .            All
-0000a1f0: 6f77 7320 7468 6520 6578 7061 6e73 696f  ows the expansio
-0000a200: 6e20 6f66 2074 6865 2065 7869 7374 696e  n of the existin
-0000a210: 6720 6469 7669 7369 6f6e 732e 0a20 2020  g divisions..   
-0000a220: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
-0000a230: 6520 7468 656e 2074 6865 206e 6577 2064  e then the new d
-0000a240: 6976 6973 696f 6e73 2720 6c6f 7765 7220  ivisions' lower 
-0000a250: 616e 6420 7570 7065 7220 626f 756e 6473  and upper bounds
-0000a260: 206d 7573 7420 6265 0a20 2020 2020 2020   must be.       
-0000a270: 2020 2020 2074 6865 2073 616d 6520 6173       the same as
-0000a280: 2074 6865 206f 6c64 2064 6976 6973 696f   the old divisio
-0000a290: 6e73 272e 0a20 2020 2020 2020 2066 7265  ns'..        fre
-0000a2a0: 7120 3a20 7374 722c 2070 642e 5469 6d65  q : str, pd.Time
-0000a2b0: 6465 6c74 610a 2020 2020 2020 2020 2020  delta.          
-0000a2c0: 2020 4120 7065 7269 6f64 206f 6e20 7768    A period on wh
-0000a2d0: 6963 6820 746f 2070 6172 7469 7469 6f6e  ich to partition
-0000a2e0: 2074 696d 6573 6572 6965 7320 6461 7461   timeseries data
-0000a2f0: 206c 696b 6520 6060 2737 4427 6060 206f   like ``'7D'`` o
-0000a300: 720a 2020 2020 2020 2020 2020 2020 6060  r.            ``
-0000a310: 2731 3268 2760 6020 6f72 2060 6070 642e  '12h'`` or ``pd.
-0000a320: 5469 6d65 6465 6c74 6128 686f 7572 733d  Timedelta(hours=
-0000a330: 3132 2960 602e 2020 4173 7375 6d65 7320  12)``.  Assumes 
-0000a340: 6120 6461 7465 7469 6d65 2069 6e64 6578  a datetime index
-0000a350: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
-0000a360: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
-0000a370: 2020 2020 2020 2045 7861 6374 6c79 206f         Exactly o
-0000a380: 6e65 206f 6620 6064 6976 6973 696f 6e73  ne of `divisions
-0000a390: 602c 2060 6e70 6172 7469 7469 6f6e 7360  `, `npartitions`
-0000a3a0: 2c20 6070 6172 7469 7469 6f6e 5f73 697a  , `partition_siz
-0000a3b0: 6560 2c20 6f72 2060 6672 6571 600a 2020  e`, or `freq`.  
-0000a3c0: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
-0000a3d0: 7370 6563 6966 6965 642e 2041 2060 6056  specified. A ``V
-0000a3e0: 616c 7565 4572 726f 7260 6020 7769 6c6c  alueError`` will
-0000a3f0: 2062 6520 7261 6973 6564 2077 6865 6e20   be raised when 
-0000a400: 7468 6174 2069 730a 2020 2020 2020 2020  that is.        
-0000a410: 6e6f 7420 7468 6520 6361 7365 2e0a 0a20  not the case... 
-0000a420: 2020 2020 2020 2041 6c73 6f20 6e6f 7465         Also note
-0000a430: 2074 6861 7420 6060 6c65 6e28 6469 7669   that ``len(divi
-0000a440: 736f 6e73 2960 6020 6973 2065 7175 616c  sons)`` is equal
-0000a450: 2074 6f20 6060 6e70 6172 7469 7469 6f6e   to ``npartition
-0000a460: 7320 2b20 3160 602e 2054 6869 7320 6973  s + 1``. This is
-0000a470: 2062 6563 6175 7365 2060 6064 6976 6973   because ``divis
-0000a480: 696f 6e73 6060 0a20 2020 2020 2020 2072  ions``.        r
-0000a490: 6570 7265 7365 6e74 7320 7468 6520 7570  epresents the up
-0000a4a0: 7065 7220 616e 6420 6c6f 7765 7220 626f  per and lower bo
-0000a4b0: 756e 6473 206f 6620 6561 6368 2070 6172  unds of each par
-0000a4c0: 7469 7469 6f6e 2e20 5468 6520 6669 7273  tition. The firs
-0000a4d0: 7420 6974 656d 2069 7320 7468 650a 2020  t item is the.  
-0000a4e0: 2020 2020 2020 6c6f 7765 7220 626f 756e        lower boun
-0000a4f0: 6420 6f66 2074 6865 2066 6972 7374 2070  d of the first p
-0000a500: 6172 7469 7469 6f6e 2c20 7468 6520 7365  artition, the se
-0000a510: 636f 6e64 2069 7465 6d20 6973 2074 6865  cond item is the
-0000a520: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
-0000a530: 7468 650a 2020 2020 2020 2020 7365 636f  the.        seco
-0000a540: 6e64 2070 6172 7469 7469 6f6e 2061 6e64  nd partition and
-0000a550: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
-0000a560: 206f 6620 7468 6520 6669 7273 7420 7061   of the first pa
-0000a570: 7274 6974 696f 6e2c 2061 6e64 2073 6f20  rtition, and so 
-0000a580: 6f6e 2e0a 2020 2020 2020 2020 5468 6520  on..        The 
-0000a590: 7365 636f 6e64 2d74 6f2d 6c61 7374 2069  second-to-last i
-0000a5a0: 7465 6d20 6973 2074 6865 206c 6f77 6572  tem is the lower
-0000a5b0: 2062 6f75 6e64 206f 6620 7468 6520 6c61   bound of the la
-0000a5c0: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
-0000a5d0: 6420 7468 6520 6c61 7374 0a20 2020 2020  d the last.     
-0000a5e0: 2020 2028 6578 7472 6129 2069 7465 6d20     (extra) item 
-0000a5f0: 6973 2074 6865 2075 7070 6572 2062 6f75  is the upper bou
-0000a600: 6e64 206f 6620 7468 6520 6c61 7374 2070  nd of the last p
-0000a610: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
-0000a620: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0000a630: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000a640: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
-0000a650: 2e72 6570 6172 7469 7469 6f6e 286e 7061  .repartition(npa
-0000a660: 7274 6974 696f 6e73 3d31 3029 2020 2320  rtitions=10)  # 
-0000a670: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0000a680: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
-0000a690: 6466 2e72 6570 6172 7469 7469 6f6e 2864  df.repartition(d
-0000a6a0: 6976 6973 696f 6e73 3d5b 302c 2035 2c20  ivisions=[0, 5, 
-0000a6b0: 3130 2c20 3230 5d29 2020 2320 646f 6374  10, 20])  # doct
-0000a6c0: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
-0000a6d0: 2020 203e 3e3e 2064 6620 3d20 6466 2e72     >>> df = df.r
-0000a6e0: 6570 6172 7469 7469 6f6e 2866 7265 713d  epartition(freq=
-0000a6f0: 2737 6427 2920 2023 2064 6f63 7465 7374  '7d')  # doctest
-0000a700: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-0000a710: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-0000a720: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0000a730: 2020 2044 6174 6146 7261 6d65 2e6d 656d     DataFrame.mem
-0000a740: 6f72 795f 7573 6167 655f 7065 725f 7061  ory_usage_per_pa
-0000a750: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
-0000a760: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-0000a770: 2e6d 656d 6f72 795f 7573 6167 650a 2020  .memory_usage.  
-0000a780: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000a790: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-0000a7a0: 2020 2020 7375 6d28 0a20 2020 2020 2020      sum(.       
-0000a7b0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0000a7c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000a7d0: 6976 6973 696f 6e73 2069 7320 6e6f 7420  ivisions is not 
-0000a7e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0000a7f0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
-0000a800: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
-0000a810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000a820: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-0000a830: 5f73 697a 6520 6973 206e 6f74 204e 6f6e  _size is not Non
-0000a840: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000a850: 2020 2020 2020 2066 7265 7120 6973 206e         freq is n
-0000a860: 6f74 204e 6f6e 652c 0a20 2020 2020 2020  ot None,.       
-0000a870: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0000a880: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000a890: 2020 2020 2021 3d20 310a 2020 2020 2020       != 1.      
-0000a8a0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0000a8b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000a8c0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0000a8d0: 2020 2022 506c 6561 7365 2070 726f 7669     "Please provi
-0000a8e0: 6465 2065 7861 6374 6c79 206f 6e65 206f  de exactly one o
-0000a8f0: 6620 7468 6520 6060 6e70 6172 7469 7469  f the ``npartiti
-0000a900: 6f6e 733d 6060 206f 7220 220a 2020 2020  ons=`` or ".    
-0000a910: 2020 2020 2020 2020 2020 2020 2260 6064              "``d
-0000a920: 6976 6973 696f 6e73 3d60 6020 6b65 7977  ivisions=`` keyw
-0000a930: 6f72 6420 6172 6775 6d65 6e74 732e 220a  ord arguments.".
-0000a940: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000a950: 2020 2020 2020 6966 2064 6976 6973 696f        if divisio
-0000a960: 6e73 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ns is not None:.
-0000a970: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-0000a980: 6b5f 6469 7669 7369 6f6e 7328 6469 7669  k_divisions(divi
-0000a990: 7369 6f6e 7329 0a20 2020 2020 2020 2069  sions).        i
-0000a9a0: 6620 6672 6571 2069 7320 6e6f 7420 4e6f  f freq is not No
-0000a9b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000a9c0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-0000a9d0: 6528 7365 6c66 2e64 6976 6973 696f 6e73  e(self.divisions
-0000a9e0: 5b30 5d2c 2070 642e 5469 6d65 7374 616d  [0], pd.Timestam
-0000a9f0: 7029 3a0a 2020 2020 2020 2020 2020 2020  p):.            
-0000aa00: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-0000aa10: 726f 7228 2243 616e 206f 6e6c 7920 7265  ror("Can only re
-0000aa20: 7061 7274 6974 696f 6e20 6f6e 2066 7265  partition on fre
-0000aa30: 7175 656e 6379 2066 6f72 2074 696d 6573  quency for times
-0000aa40: 6572 6965 7322 290a 2020 2020 2020 2020  eries").        
-0000aa50: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0000aa60: 6f6c 6c65 6374 696f 6e28 5265 7061 7274  ollection(Repart
-0000aa70: 6974 696f 6e46 7265 7128 7365 6c66 2c20  itionFreq(self, 
-0000aa80: 6672 6571 2929 0a20 2020 2020 2020 2065  freq)).        e
-0000aa90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000aaa0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0000aab0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-0000aac0: 2020 2020 2020 2020 5265 7061 7274 6974          Repartit
-0000aad0: 696f 6e28 7365 6c66 2c20 6e70 6172 7469  ion(self, nparti
-0000aae0: 7469 6f6e 732c 2064 6976 6973 696f 6e73  tions, divisions
-0000aaf0: 2c20 666f 7263 652c 2070 6172 7469 7469  , force, partiti
-0000ab00: 6f6e 5f73 697a 652c 2066 7265 7129 0a20  on_size, freq). 
-0000ab10: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000ab20: 2020 6465 6620 746f 5f64 6173 6b5f 6461    def to_dask_da
-0000ab30: 7461 6672 616d 6528 7365 6c66 2c20 2a61  taframe(self, *a
-0000ab40: 7267 732c 202a 2a6b 7761 7267 7329 202d  rgs, **kwargs) -
-0000ab50: 3e20 5f46 7261 6d65 3a0a 2020 2020 2020  > _Frame:.      
-0000ab60: 2020 2222 2243 6f6e 7665 7274 2074 6f20    """Convert to 
-0000ab70: 6120 6c65 6761 6379 2064 6173 6b2d 6461  a legacy dask-da
-0000ab80: 7461 6672 616d 6520 636f 6c6c 6563 7469  taframe collecti
-0000ab90: 6f6e 0a0a 2020 2020 2020 2020 5741 524e  on..        WARN
-0000aba0: 494e 473a 2054 6869 7320 4150 4920 6973  ING: This API is
-0000abb0: 2064 6570 7265 6361 7465 642e 2050 6c65   deprecated. Ple
-0000abc0: 6173 6520 7573 6520 6074 6f5f 6c65 6761  ase use `to_lega
-0000abd0: 6379 5f64 6174 6166 7261 6d65 602e 0a0a  cy_dataframe`...
-0000abe0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000abf0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000ac00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6f70  -----.        op
-0000ac10: 7469 6d69 7a65 0a20 2020 2020 2020 2020  timize.         
-0000ac20: 2020 2057 6865 7468 6572 2074 6f20 6f70     Whether to op
-0000ac30: 7469 6d69 7a65 2074 6865 2075 6e64 6572  timize the under
-0000ac40: 6c79 696e 6720 6045 7870 7260 206f 626a  lying `Expr` obj
-0000ac50: 6563 7420 6265 666f 7265 2063 6f6e 7665  ect before conve
-0000ac60: 7273 696f 6e2e 0a20 2020 2020 2020 202a  rsion..        *
-0000ac70: 2a6f 7074 696d 697a 655f 6b77 6172 6773  *optimize_kwargs
-0000ac80: 0a20 2020 2020 2020 2020 2020 204b 6579  .            Key
-0000ac90: 2d77 6f72 6420 6172 6775 6d65 6e74 7320  -word arguments 
-0000aca0: 746f 2070 6173 7320 7468 726f 7567 6820  to pass through 
-0000acb0: 746f 2060 6f70 7469 6d69 7a65 602e 0a20  to `optimize`.. 
-0000acc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000acd0: 2020 2023 2054 4f44 4f3a 2044 6570 7265     # TODO: Depre
-0000ace0: 6361 7465 2060 746f 5f64 6173 6b5f 6461  cate `to_dask_da
-0000acf0: 7461 6672 616d 6560 0a20 2020 2020 2020  taframe`.       
-0000ad00: 2023 2053 6565 3a20 6874 7470 733a 2f2f   # See: https://
-0000ad10: 6769 7468 7562 2e63 6f6d 2f64 6173 6b2f  github.com/dask/
-0000ad20: 6461 736b 2d65 7870 722f 6973 7375 6573  dask-expr/issues
-0000ad30: 2f39 3035 0a20 2020 2020 2020 2072 6574  /905.        ret
-0000ad40: 7572 6e20 7365 6c66 2e74 6f5f 6c65 6761  urn self.to_lega
-0000ad50: 6379 5f64 6174 6166 7261 6d65 282a 6172  cy_dataframe(*ar
-0000ad60: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
-0000ad70: 2020 2064 6566 2074 6f5f 6c65 6761 6379     def to_legacy
-0000ad80: 5f64 6174 6166 7261 6d65 2873 656c 662c  _dataframe(self,
-0000ad90: 206f 7074 696d 697a 653a 2062 6f6f 6c20   optimize: bool 
-0000ada0: 3d20 5472 7565 2c20 2a2a 6f70 7469 6d69  = True, **optimi
-0000adb0: 7a65 5f6b 7761 7267 7329 202d 3e20 5f46  ze_kwargs) -> _F
-0000adc0: 7261 6d65 3a0a 2020 2020 2020 2020 2222  rame:.        ""
-0000add0: 2243 6f6e 7665 7274 2074 6f20 6120 6c65  "Convert to a le
-0000ade0: 6761 6379 2064 6173 6b2d 6461 7461 6672  gacy dask-datafr
-0000adf0: 616d 6520 636f 6c6c 6563 7469 6f6e 0a0a  ame collection..
-0000ae00: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000ae10: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000ae20: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6f70  -----.        op
-0000ae30: 7469 6d69 7a65 0a20 2020 2020 2020 2020  timize.         
-0000ae40: 2020 2057 6865 7468 6572 2074 6f20 6f70     Whether to op
-0000ae50: 7469 6d69 7a65 2074 6865 2075 6e64 6572  timize the under
-0000ae60: 6c79 696e 6720 6045 7870 7260 206f 626a  lying `Expr` obj
-0000ae70: 6563 7420 6265 666f 7265 2063 6f6e 7665  ect before conve
-0000ae80: 7273 696f 6e2e 0a20 2020 2020 2020 202a  rsion..        *
-0000ae90: 2a6f 7074 696d 697a 655f 6b77 6172 6773  *optimize_kwargs
-0000aea0: 0a20 2020 2020 2020 2020 2020 204b 6579  .            Key
-0000aeb0: 2d77 6f72 6420 6172 6775 6d65 6e74 7320  -word arguments 
-0000aec0: 746f 2070 6173 7320 7468 726f 7567 6820  to pass through 
-0000aed0: 746f 2060 6f70 7469 6d69 7a65 602e 0a20  to `optimize`.. 
-0000aee0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000aef0: 2020 2064 6620 3d20 7365 6c66 2e6f 7074     df = self.opt
-0000af00: 696d 697a 6528 2a2a 6f70 7469 6d69 7a65  imize(**optimize
-0000af10: 5f6b 7761 7267 7329 2069 6620 6f70 7469  _kwargs) if opti
-0000af20: 6d69 7a65 2065 6c73 6520 7365 6c66 0a20  mize else self. 
-0000af30: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0000af40: 775f 6464 5f6f 626a 6563 7428 6466 2e64  w_dd_object(df.d
-0000af50: 6173 6b2c 2064 662e 5f6e 616d 652c 2064  ask, df._name, d
-0000af60: 662e 5f6d 6574 612c 2064 662e 6469 7669  f._meta, df.divi
-0000af70: 7369 6f6e 7329 0a0a 2020 2020 6465 6620  sions)..    def 
-0000af80: 746f 5f64 6173 6b5f 6172 7261 7928 0a20  to_dask_array(. 
-0000af90: 2020 2020 2020 2073 656c 662c 206c 656e         self, len
-0000afa0: 6774 6873 3d4e 6f6e 652c 206d 6574 613d  gths=None, meta=
-0000afb0: 4e6f 6e65 2c20 6f70 7469 6d69 7a65 3a20  None, optimize: 
-0000afc0: 626f 6f6c 203d 2054 7275 652c 202a 2a6f  bool = True, **o
-0000afd0: 7074 696d 697a 655f 6b77 6172 6773 0a20  ptimize_kwargs. 
-0000afe0: 2020 2029 202d 3e20 4172 7261 793a 0a20     ) -> Array:. 
-0000aff0: 2020 2020 2020 2022 2222 436f 6e76 6572         """Conver
-0000b000: 7420 6120 6461 736b 2044 6174 6146 7261  t a dask DataFra
-0000b010: 6d65 2074 6f20 6120 6461 736b 2061 7272  me to a dask arr
-0000b020: 6179 2e0a 0a20 2020 2020 2020 2050 6172  ay...        Par
-0000b030: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0000b040: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000b050: 2020 206c 656e 6774 6873 203a 2062 6f6f     lengths : boo
-0000b060: 6c20 6f72 2053 6571 7565 6e63 6520 6f66  l or Sequence of
-0000b070: 2069 6e74 732c 206f 7074 696f 6e61 6c0a   ints, optional.
-0000b080: 2020 2020 2020 2020 2020 2020 486f 7720              How 
-0000b090: 746f 2064 6574 6572 6d69 6e65 2074 6865  to determine the
-0000b0a0: 2063 6875 6e6b 7320 7369 7a65 7320 666f   chunks sizes fo
-0000b0b0: 7220 7468 6520 6f75 7470 7574 2061 7272  r the output arr
-0000b0c0: 6179 2e0a 2020 2020 2020 2020 2020 2020  ay..            
-0000b0d0: 4279 2064 6566 6175 6c74 2c20 7468 6520  By default, the 
-0000b0e0: 6f75 7470 7574 2061 7272 6179 2077 696c  output array wil
-0000b0f0: 6c20 6861 7665 2075 6e6b 6e6f 776e 2063  l have unknown c
-0000b100: 6875 6e6b 206c 656e 6774 6873 0a20 2020  hunk lengths.   
-0000b110: 2020 2020 2020 2020 2061 6c6f 6e67 2074           along t
-0000b120: 6865 2066 6972 7374 2061 7869 732c 2077  he first axis, w
-0000b130: 6869 6368 2063 616e 2063 6175 7365 2073  hich can cause s
-0000b140: 6f6d 6520 6c61 7465 7220 6f70 6572 6174  ome later operat
-0000b150: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-0000b160: 2074 6f20 6661 696c 2e0a 0a20 2020 2020   to fail...     
-0000b170: 2020 2020 2020 202a 2054 7275 6520 3a20         * True : 
-0000b180: 696d 6d65 6469 6174 656c 7920 636f 6d70  immediately comp
-0000b190: 7574 6520 7468 6520 6c65 6e67 7468 206f  ute the length o
-0000b1a0: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
-0000b1b0: 0a20 2020 2020 2020 2020 2020 202a 2053  .            * S
-0000b1c0: 6571 7565 6e63 6520 3a20 6120 7365 7175  equence : a sequ
-0000b1d0: 656e 6365 206f 6620 696e 7465 6765 7273  ence of integers
-0000b1e0: 2074 6f20 7573 6520 666f 7220 7468 6520   to use for the 
-0000b1f0: 6368 756e 6b20 7369 7a65 730a 2020 2020  chunk sizes.    
-0000b200: 2020 2020 2020 2020 2020 6f6e 2074 6865            on the
-0000b210: 2066 6972 7374 2061 7869 732e 2054 6865   first axis. The
-0000b220: 7365 2076 616c 7565 7320 6172 6520 2a6e  se values are *n
-0000b230: 6f74 2a20 7661 6c69 6461 7465 6420 666f  ot* validated fo
-0000b240: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000b250: 636f 7272 6563 746e 6573 732c 2062 6579  correctness, bey
-0000b260: 6f6e 6420 656e 7375 7269 6e67 2074 6861  ond ensuring tha
-0000b270: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
-0000b280: 6974 656d 730a 2020 2020 2020 2020 2020  items.          
-0000b290: 2020 2020 6d61 7463 6865 7320 7468 6520      matches the 
-0000b2a0: 6e75 6d62 6572 206f 6620 7061 7274 6974  number of partit
-0000b2b0: 696f 6e73 2e0a 2020 2020 2020 2020 6d65  ions..        me
-0000b2c0: 7461 203a 206f 626a 6563 742c 206f 7074  ta : object, opt
-0000b2d0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000b2e0: 2020 416e 206f 7074 696f 6e61 6c20 606d    An optional `m
-0000b2f0: 6574 6160 2070 6172 616d 6574 6572 2063  eta` parameter c
-0000b300: 616e 2062 6520 7061 7373 6564 2066 6f72  an be passed for
-0000b310: 2064 6173 6b20 746f 206f 7665 7272 6964   dask to overrid
-0000b320: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
-0000b330: 2020 6465 6661 756c 7420 6d65 7461 6461    default metada
-0000b340: 7461 206f 6e20 7468 6520 756e 6465 726c  ta on the underl
-0000b350: 7969 6e67 2064 6173 6b20 6172 7261 792e  ying dask array.
-0000b360: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
-0000b370: 6520 3a20 626f 6f6c 0a20 2020 2020 2020  e : bool.       
-0000b380: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-0000b390: 6f70 7469 6d69 7a65 2074 6865 2065 7870  optimize the exp
-0000b3a0: 7265 7373 696f 6e20 6265 666f 7265 2063  ression before c
-0000b3b0: 6f6e 7665 7274 696e 6720 746f 2061 6e20  onverting to an 
-0000b3c0: 4172 7261 792e 0a0a 2020 2020 2020 2020  Array...        
-0000b3d0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0000b3e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000b3f0: 4120 4461 736b 2041 7272 6179 0a20 2020  A Dask Array.   
-0000b400: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000b410: 2072 6574 7572 6e20 7365 6c66 2e74 6f5f   return self.to_
-0000b420: 6c65 6761 6379 5f64 6174 6166 7261 6d65  legacy_dataframe
-0000b430: 286f 7074 696d 697a 652c 202a 2a6f 7074  (optimize, **opt
-0000b440: 696d 697a 655f 6b77 6172 6773 292e 746f  imize_kwargs).to
-0000b450: 5f64 6173 6b5f 6172 7261 7928 0a20 2020  _dask_array(.   
-0000b460: 2020 2020 2020 2020 206c 656e 6774 6873           lengths
-0000b470: 3d6c 656e 6774 6873 2c20 6d65 7461 3d6d  =lengths, meta=m
-0000b480: 6574 610a 2020 2020 2020 2020 290a 0a20  eta.        ).. 
-0000b490: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000b4a0: 2064 6566 2076 616c 7565 7328 7365 6c66   def values(self
-0000b4b0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0000b4c0: 7475 726e 2061 2064 6173 6b2e 6172 7261  turn a dask.arra
-0000b4d0: 7920 6f66 2074 6865 2076 616c 7565 7320  y of the values 
-0000b4e0: 6f66 2074 6869 7320 6461 7461 6672 616d  of this datafram
-0000b4f0: 650a 0a20 2020 2020 2020 2057 6172 6e69  e..        Warni
-0000b500: 6e67 3a20 5468 6973 2063 7265 6174 6573  ng: This creates
-0000b510: 2061 2064 6173 6b2e 6172 7261 7920 7769   a dask.array wi
-0000b520: 7468 6f75 7420 7072 6563 6973 6520 7368  thout precise sh
-0000b530: 6170 6520 696e 666f 726d 6174 696f 6e2e  ape information.
-0000b540: 0a20 2020 2020 2020 204f 7065 7261 7469  .        Operati
-0000b550: 6f6e 7320 7468 6174 2064 6570 656e 6420  ons that depend 
-0000b560: 6f6e 2073 6861 7065 2069 6e66 6f72 6d61  on shape informa
-0000b570: 7469 6f6e 2c20 6c69 6b65 2073 6c69 6369  tion, like slici
-0000b580: 6e67 206f 7220 7265 7368 6170 696e 672c  ng or reshaping,
-0000b590: 0a20 2020 2020 2020 2077 696c 6c20 6e6f  .        will no
-0000b5a0: 7420 776f 726b 2e0a 2020 2020 2020 2020  t work..        
-0000b5b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0000b5c0: 726e 2073 656c 662e 746f 5f64 6173 6b5f  rn self.to_dask_
-0000b5d0: 6172 7261 7928 290a 0a20 2020 2064 6566  array()..    def
-0000b5e0: 205f 5f64 6976 6d6f 645f 5f28 7365 6c66   __divmod__(self
-0000b5f0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-0000b600: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
-0000b610: 6578 7072 2e5f 5f64 6976 6d6f 645f 5f28  expr.__divmod__(
-0000b620: 6f74 6865 7229 0a20 2020 2020 2020 2072  other).        r
-0000b630: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000b640: 7469 6f6e 2872 6573 756c 745b 305d 292c  tion(result[0]),
-0000b650: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0000b660: 7265 7375 6c74 5b31 5d29 0a0a 2020 2020  result[1])..    
-0000b670: 6465 6620 5f5f 7264 6976 6d6f 645f 5f28  def __rdivmod__(
-0000b680: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-0000b690: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
-0000b6a0: 656c 662e 6578 7072 2e5f 5f72 6469 766d  elf.expr.__rdivm
-0000b6b0: 6f64 5f5f 286f 7468 6572 290a 2020 2020  od__(other).    
-0000b6c0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0000b6d0: 6f6c 6c65 6374 696f 6e28 7265 7375 6c74  ollection(result
-0000b6e0: 5b30 5d29 2c20 6e65 775f 636f 6c6c 6563  [0]), new_collec
-0000b6f0: 7469 6f6e 2872 6573 756c 745b 315d 290a  tion(result[1]).
-0000b700: 0a20 2020 2064 6566 205f 5f61 6273 5f5f  .    def __abs__
-0000b710: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000b720: 7265 7475 726e 2073 656c 662e 6162 7328  return self.abs(
-0000b730: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0000b740: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0000b750: 6529 0a20 2020 2064 6566 2073 756d 280a  e).    def sum(.
-0000b760: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000b770: 2020 2020 2020 6178 6973 3d30 2c0a 2020        axis=0,.  
-0000b780: 2020 2020 2020 736b 6970 6e61 3d54 7275        skipna=Tru
-0000b790: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
-0000b7a0: 6963 5f6f 6e6c 793d 4661 6c73 652c 0a20  ic_only=False,. 
-0000b7b0: 2020 2020 2020 206d 696e 5f63 6f75 6e74         min_count
-0000b7c0: 3d30 2c0a 2020 2020 2020 2020 7370 6c69  =0,.        spli
-0000b7d0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
-0000b7e0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-0000b7f0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000b800: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-0000b810: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-0000b820: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-0000b830: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-0000b840: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0000b850: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-0000b860: 2020 2020 2020 2020 2020 2020 2020 204d                 M
-0000b870: 2e73 756d 2c0a 2020 2020 2020 2020 2020  .sum,.          
-0000b880: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
-0000b890: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-0000b8a0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-0000b8b0: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
-0000b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b8d0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-0000b8e0: 2020 2020 2020 2020 2020 206d 696e 5f63             min_c
-0000b8f0: 6f75 6e74 3d6d 696e 5f63 6f75 6e74 2c0a  ount=min_count,.
-0000b900: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000b910: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000b920: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-0000b930: 656c 662e 6578 7072 2e73 756d 2873 6b69  elf.expr.sum(ski
-0000b940: 706e 612c 206e 756d 6572 6963 5f6f 6e6c  pna, numeric_onl
-0000b950: 792c 2073 706c 6974 5f65 7665 7279 2c20  y, split_every, 
-0000b960: 6178 6973 2929 0a20 2020 2020 2020 2072  axis)).        r
-0000b970: 6574 7572 6e20 7365 6c66 2e5f 6170 706c  eturn self._appl
-0000b980: 795f 6d69 6e5f 636f 756e 7428 7265 7375  y_min_count(resu
-0000b990: 6c74 2c20 6d69 6e5f 636f 756e 7429 0a0a  lt, min_count)..
-0000b9a0: 2020 2020 6465 6620 5f61 7070 6c79 5f6d      def _apply_m
-0000b9b0: 696e 5f63 6f75 6e74 2873 656c 662c 2072  in_count(self, r
-0000b9c0: 6573 756c 742c 206d 696e 5f63 6f75 6e74  esult, min_count
-0000b9d0: 293a 0a20 2020 2020 2020 2069 6620 6d69  ):.        if mi
-0000b9e0: 6e5f 636f 756e 743a 0a20 2020 2020 2020  n_count:.       
-0000b9f0: 2020 2020 2063 6f6e 6420 3d20 7365 6c66       cond = self
-0000ba00: 2e6e 6f74 6e75 6c6c 2829 2e73 756d 2829  .notnull().sum()
-0000ba10: 203e 3d20 6d69 6e5f 636f 756e 740a 2020   >= min_count.  
-0000ba20: 2020 2020 2020 2020 2020 636f 6e64 5f6d            cond_m
-0000ba30: 6574 6120 3d20 636f 6e64 2e5f 6d65 7461  eta = cond._meta
-0000ba40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ba50: 6e6f 7420 6973 5f73 6572 6965 735f 6c69  not is_series_li
-0000ba60: 6b65 2863 6f6e 645f 6d65 7461 293a 0a20  ke(cond_meta):. 
-0000ba70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000ba80: 6573 756c 7420 3d20 7265 7375 6c74 2e74  esult = result.t
-0000ba90: 6f5f 7365 7269 6573 2829 0a20 2020 2020  o_series().     
-0000baa0: 2020 2020 2020 2020 2020 2063 6f6e 6420             cond 
-0000bab0: 3d20 636f 6e64 2e74 6f5f 7365 7269 6573  = cond.to_series
-0000bac0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-0000bad0: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
-0000bae0: 7768 6572 6528 636f 6e64 2c20 6f74 6865  where(cond, othe
-0000baf0: 723d 6e70 2e6e 616e 290a 2020 2020 2020  r=np.nan).      
-0000bb00: 2020 2020 2020 6966 206e 6f74 2069 735f        if not is_
-0000bb10: 7365 7269 6573 5f6c 696b 6528 636f 6e64  series_like(cond
-0000bb20: 5f6d 6574 6129 3a0a 2020 2020 2020 2020  _meta):.        
-0000bb30: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000bb40: 6573 756c 742e 6d69 6e28 290a 2020 2020  esult.min().    
-0000bb50: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000bb60: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000bb70: 7475 726e 2072 6573 756c 740a 2020 2020  turn result.    
-0000bb80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000bb90: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000bba0: 756c 740a 0a20 2020 2040 6465 7269 7665  ult..    @derive
-0000bbb0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0000bbc0: 616d 6529 0a20 2020 2064 6566 2070 726f  ame).    def pro
-0000bbd0: 6428 0a20 2020 2020 2020 2073 656c 662c  d(.        self,
-0000bbe0: 0a20 2020 2020 2020 2061 7869 733d 302c  .        axis=0,
-0000bbf0: 0a20 2020 2020 2020 2073 6b69 706e 613d  .        skipna=
-0000bc00: 5472 7565 2c0a 2020 2020 2020 2020 6e75  True,.        nu
-0000bc10: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-0000bc20: 2c0a 2020 2020 2020 2020 6d69 6e5f 636f  ,.        min_co
-0000bc30: 756e 743d 302c 0a20 2020 2020 2020 2073  unt=0,.        s
-0000bc40: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-0000bc50: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
-0000bc60: 6773 2c0a 2020 2020 293a 0a20 2020 2020  gs,.    ):.     
-0000bc70: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
-0000bc80: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
-0000bc90: 6973 290a 2020 2020 2020 2020 6966 2061  is).        if a
-0000bca0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-0000bcb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000bcc0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0000bcd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000bce0: 2020 4d2e 7072 6f64 2c0a 2020 2020 2020    M.prod,.      
-0000bcf0: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-0000bd00: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
-0000bd10: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-0000bd20: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-0000bd30: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
-0000bd40: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-0000bd50: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000bd60: 696e 5f63 6f75 6e74 3d6d 696e 5f63 6f75  in_count=min_cou
-0000bd70: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-0000bd80: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
-0000bd90: 203d 206e 6577 5f63 6f6c 6c65 6374 696f   = new_collectio
-0000bda0: 6e28 7365 6c66 2e65 7870 722e 7072 6f64  n(self.expr.prod
-0000bdb0: 2873 6b69 706e 612c 206e 756d 6572 6963  (skipna, numeric
-0000bdc0: 5f6f 6e6c 792c 2073 706c 6974 5f65 7665  _only, split_eve
-0000bdd0: 7279 2c20 6178 6973 2929 0a20 2020 2020  ry, axis)).     
-0000bde0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000bdf0: 6170 706c 795f 6d69 6e5f 636f 756e 7428  apply_min_count(
-0000be00: 7265 7375 6c74 2c20 6d69 6e5f 636f 756e  result, min_coun
-0000be10: 7429 0a0a 2020 2020 7072 6f64 7563 7420  t)..    product 
-0000be20: 3d20 7072 6f64 0a0a 2020 2020 4064 6572  = prod..    @der
-0000be30: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0000be40: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0000be50: 7661 7228 0a20 2020 2020 2020 2073 656c  var(.        sel
-0000be60: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
-0000be70: 302c 0a20 2020 2020 2020 2073 6b69 706e  0,.        skipn
-0000be80: 613d 5472 7565 2c0a 2020 2020 2020 2020  a=True,.        
-0000be90: 6464 6f66 3d31 2c0a 2020 2020 2020 2020  ddof=1,.        
-0000bea0: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
-0000beb0: 7365 2c0a 2020 2020 2020 2020 7370 6c69  se,.        spli
-0000bec0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
-0000bed0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-0000bee0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000bef0: 5f72 6169 7365 5f69 665f 6f62 6a65 6374  _raise_if_object
-0000bf00: 5f73 6572 6965 7328 7365 6c66 2c20 2276  _series(self, "v
-0000bf10: 6172 2229 0a20 2020 2020 2020 2061 7869  ar").        axi
-0000bf20: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-0000bf30: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
-0000bf40: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
-0000bf50: 2e76 6172 2861 7869 733d 6178 6973 2c20  .var(axis=axis, 
-0000bf60: 736b 6970 6e61 3d73 6b69 706e 612c 206e  skipna=skipna, n
-0000bf70: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
-0000bf80: 7269 635f 6f6e 6c79 290a 2020 2020 2020  ric_only).      
-0000bf90: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
-0000bfa0: 2020 2020 2020 2069 6620 6973 5f64 6174         if is_dat
-0000bfb0: 6166 7261 6d65 5f6c 696b 6528 7365 6c66  aframe_like(self
-0000bfc0: 2e5f 6d65 7461 2920 616e 6420 6e75 6d65  ._meta) and nume
-0000bfd0: 7269 635f 6f6e 6c79 3a0a 2020 2020 2020  ric_only:.      
-0000bfe0: 2020 2020 2020 6672 616d 6520 3d20 6672        frame = fr
-0000bff0: 616d 655b 6c69 7374 2873 656c 662e 5f6d  ame[list(self._m
-0000c000: 6574 612e 7661 7228 6e75 6d65 7269 635f  eta.var(numeric_
-0000c010: 6f6e 6c79 3d54 7275 6529 2e69 6e64 6578  only=True).index
-0000c020: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
-0000c030: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-0000c040: 280a 2020 2020 2020 2020 2020 2020 6672  (.            fr
-0000c050: 616d 652e 6578 7072 2e76 6172 2861 7869  ame.expr.var(axi
-0000c060: 732c 2073 6b69 706e 612c 2064 646f 662c  s, skipna, ddof,
-0000c070: 206e 756d 6572 6963 5f6f 6e6c 792c 2073   numeric_only, s
-0000c080: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0000c090: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
-0000c0a0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0000c0b0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0000c0c0: 6529 0a20 2020 2064 6566 2073 7464 280a  e).    def std(.
-0000c0d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000c0e0: 2020 2020 2020 6178 6973 3d30 2c0a 2020        axis=0,.  
-0000c0f0: 2020 2020 2020 736b 6970 6e61 3d54 7275        skipna=Tru
-0000c100: 652c 0a20 2020 2020 2020 2064 646f 663d  e,.        ddof=
-0000c110: 312c 0a20 2020 2020 2020 206e 756d 6572  1,.        numer
-0000c120: 6963 5f6f 6e6c 793d 4661 6c73 652c 0a20  ic_only=False,. 
-0000c130: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-0000c140: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
-0000c150: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-0000c160: 293a 0a20 2020 2020 2020 205f 7261 6973  ):.        _rais
-0000c170: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
-0000c180: 6573 2873 656c 662c 2022 7374 6422 290a  es(self, "std").
-0000c190: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-0000c1a0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-0000c1b0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-0000c1c0: 206e 756d 6572 6963 5f64 6420 3d20 7365   numeric_dd = se
-0000c1d0: 6c66 0a20 2020 2020 2020 206d 6574 6120  lf.        meta 
-0000c1e0: 3d20 6d65 7461 5f6e 6f6e 656d 7074 7928  = meta_nonempty(
-0000c1f0: 7365 6c66 2e5f 6d65 7461 292e 7374 6428  self._meta).std(
-0000c200: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-0000c210: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
-0000c220: 6b69 706e 612c 2064 646f 663d 6464 6f66  kipna, ddof=ddof
-0000c230: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d6e  , numeric_only=n
-0000c240: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
-0000c250: 2020 2020 290a 2020 2020 2020 2020 6e65      ).        ne
-0000c260: 6564 735f 7469 6d65 5f63 6f6e 7665 7273  eds_time_convers
-0000c270: 696f 6e2c 2074 696d 655f 636f 6c73 203d  ion, time_cols =
-0000c280: 2046 616c 7365 2c20 4e6f 6e65 0a20 2020   False, None.   
-0000c290: 2020 2020 2069 6620 6973 5f64 6174 6166       if is_dataf
-0000c2a0: 7261 6d65 5f6c 696b 6528 7365 6c66 2e5f  rame_like(self._
-0000c2b0: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
-0000c2c0: 2020 2069 6620 6178 6973 203d 3d20 303a     if axis == 0:
-0000c2d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c2e0: 206e 756d 6572 6963 5f64 6420 3d20 6e75   numeric_dd = nu
-0000c2f0: 6d65 7269 635f 6464 5b6c 6973 7428 6d65  meric_dd[list(me
-0000c300: 7461 2e69 6e64 6578 295d 0a20 2020 2020  ta.index)].     
-0000c310: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000c320: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0000c330: 6572 6963 5f64 6420 3d20 6e75 6d65 7269  eric_dd = numeri
-0000c340: 635f 6464 2e63 6f70 7928 290a 0a20 2020  c_dd.copy()..   
-0000c350: 2020 2020 2020 2020 2069 6620 6e75 6d65           if nume
-0000c360: 7269 635f 6f6e 6c79 2069 7320 5472 7565  ric_only is True
-0000c370: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c380: 2020 5f6d 6574 6120 3d20 6e75 6d65 7269    _meta = numeri
-0000c390: 635f 6464 2e5f 6d65 7461 2e73 656c 6563  c_dd._meta.selec
-0000c3a0: 745f 6474 7970 6573 2869 6e63 6c75 6465  t_dtypes(include
-0000c3b0: 3d5b 6e70 2e6e 756d 6265 725d 290a 2020  =[np.number]).  
-0000c3c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3e0: 5f6d 6574 6120 3d20 6e75 6d65 7269 635f  _meta = numeric_
-0000c3f0: 6464 2e5f 6d65 7461 0a20 2020 2020 2020  dd._meta.       
-0000c400: 2020 2020 2074 696d 655f 636f 6c73 203d       time_cols =
-0000c410: 205f 6d65 7461 2e73 656c 6563 745f 6474   _meta.select_dt
-0000c420: 7970 6573 2869 6e63 6c75 6465 3d5b 2264  ypes(include=["d
-0000c430: 6174 6574 696d 6522 2c20 2274 696d 6564  atetime", "timed
-0000c440: 656c 7461 225d 292e 636f 6c75 6d6e 730a  elta"]).columns.
-0000c450: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000c460: 656e 2874 696d 655f 636f 6c73 2920 3e20  en(time_cols) > 
-0000c470: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0000c480: 2020 2069 6620 6178 6973 203d 3d20 3120     if axis == 1 
-0000c490: 616e 6420 6c65 6e28 7469 6d65 5f63 6f6c  and len(time_col
-0000c4a0: 7329 2021 3d20 6c65 6e28 7365 6c66 2e63  s) != len(self.c
-0000c4b0: 6f6c 756d 6e73 293a 0a20 2020 2020 2020  olumns):.       
-0000c4c0: 2020 2020 2020 2020 2020 2020 206e 756d               num
-0000c4d0: 6572 6963 5f64 6420 3d20 6672 6f6d 5f70  eric_dd = from_p
-0000c4e0: 616e 6461 7328 0a20 2020 2020 2020 2020  andas(.         
-0000c4f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000c500: 6574 615f 6672 616d 655f 636f 6e73 7472  eta_frame_constr
-0000c510: 7563 746f 7228 7365 6c66 2928 0a20 2020  uctor(self)(.   
-0000c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c530: 2020 2020 2020 2020 207b 225f 223a 206d           {"_": m
-0000c540: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
-0000c550: 7275 6374 6f72 2873 656c 6629 285b 6e70  ructor(self)([np
-0000c560: 2e6e 616e 5d29 7d2c 0a20 2020 2020 2020  .nan])},.       
-0000c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c580: 2020 2020 2069 6e64 6578 3d73 656c 662e       index=self.
-0000c590: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-0000c5a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000c5b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000c5c0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
-0000c5d0: 7469 6f6e 733d 7365 6c66 2e6e 7061 7274  tions=self.npart
-0000c5e0: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
-0000c5f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000c600: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0000c610: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000c620: 2020 2020 2020 2020 6e65 6564 735f 7469          needs_ti
-0000c630: 6d65 5f63 6f6e 7665 7273 696f 6e20 3d20  me_conversion = 
-0000c640: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-0000c650: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
-0000c660: 2069 6e20 7469 6d65 5f63 6f6c 733a 0a20   in time_cols:. 
-0000c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c680: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
-0000c690: 645b 636f 6c5d 203d 205f 636f 6e76 6572  d[col] = _conver
-0000c6a0: 745f 746f 5f6e 756d 6572 6963 286e 756d  t_to_numeric(num
-0000c6b0: 6572 6963 5f64 645b 636f 6c5d 2c20 736b  eric_dd[col], sk
-0000c6c0: 6970 6e61 290a 2020 2020 2020 2020 656c  ipna).        el
-0000c6d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000c6e0: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
-0000c6f0: 7273 696f 6e20 3d20 6973 5f64 6174 6574  rsion = is_datet
-0000c700: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
-0000c710: 7365 6c66 2e5f 6d65 7461 290a 2020 2020  self._meta).    
-0000c720: 2020 2020 2020 2020 6966 206e 6565 6473          if needs
-0000c730: 5f74 696d 655f 636f 6e76 6572 7369 6f6e  _time_conversion
-0000c740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c750: 2020 6e75 6d65 7269 635f 6464 203d 205f    numeric_dd = _
-0000c760: 636f 6e76 6572 745f 746f 5f6e 756d 6572  convert_to_numer
-0000c770: 6963 2873 656c 662c 2073 6b69 706e 6129  ic(self, skipna)
-0000c780: 0a0a 2020 2020 2020 2020 6966 2061 7869  ..        if axi
-0000c790: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-0000c7a0: 2020 2020 7265 7475 726e 206e 756d 6572      return numer
-0000c7b0: 6963 5f64 642e 6d61 705f 7061 7274 6974  ic_dd.map_partit
-0000c7c0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-0000c7d0: 2020 2020 2020 4d2e 7374 6420 6966 206e        M.std if n
-0000c7e0: 6f74 206e 6565 6473 5f74 696d 655f 636f  ot needs_time_co
-0000c7f0: 6e76 6572 7369 6f6e 2065 6c73 6520 5f73  nversion else _s
-0000c800: 7172 745f 616e 645f 636f 6e76 6572 745f  qrt_and_convert_
-0000c810: 746f 5f74 696d 6564 656c 7461 2c0a 2020  to_timedelta,.  
-0000c820: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0000c830: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-0000c840: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
-0000c850: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
-0000c860: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
-0000c870: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-0000c880: 2020 2064 646f 663d 6464 6f66 2c0a 2020     ddof=ddof,.  
-0000c890: 2020 2020 2020 2020 2020 2020 2020 656e                en
-0000c8a0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-0000c8b0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-0000c8c0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-0000c8d0: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
-0000c8e0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000c8f0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0000c900: 206e 756d 6572 6963 5f64 642e 7661 7228   numeric_dd.var(
-0000c910: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
-0000c920: 706e 613d 736b 6970 6e61 2c20 6464 6f66  pna=skipna, ddof
-0000c930: 3d64 646f 662c 206e 756d 6572 6963 5f6f  =ddof, numeric_o
-0000c940: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-0000c950: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-0000c960: 6c69 745f 6576 6572 790a 2020 2020 2020  lit_every.      
-0000c970: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0000c980: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
-0000c990: 7273 696f 6e3a 0a20 2020 2020 2020 2020  rsion:.         
-0000c9a0: 2020 2073 7172 745f 6675 6e63 5f6b 7761     sqrt_func_kwa
-0000c9b0: 7267 7320 3d20 7b0a 2020 2020 2020 2020  rgs = {.        
-0000c9c0: 2020 2020 2020 2020 2269 735f 6466 5f6c          "is_df_l
-0000c9d0: 696b 6522 3a20 6973 5f64 6174 6166 7261  ike": is_datafra
-0000c9e0: 6d65 5f6c 696b 6528 7365 6c66 2e5f 6d65  me_like(self._me
-0000c9f0: 7461 292c 0a20 2020 2020 2020 2020 2020  ta),.           
-0000ca00: 2020 2020 2022 7469 6d65 5f63 6f6c 7322       "time_cols"
-0000ca10: 3a20 7469 6d65 5f63 6f6c 732c 0a20 2020  : time_cols,.   
-0000ca20: 2020 2020 2020 2020 2020 2020 2022 6178               "ax
-0000ca30: 6973 223a 2061 7869 732c 0a20 2020 2020  is": axis,.     
-0000ca40: 2020 2020 2020 2020 2020 2022 6474 7970             "dtyp
-0000ca50: 6522 3a20 6765 7461 7474 7228 6d65 7461  e": getattr(meta
-0000ca60: 2c20 2264 7479 7065 222c 204e 6f6e 6529  , "dtype", None)
-0000ca70: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
-0000ca80: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
-0000ca90: 5f66 756e 6320 3d20 5f73 7172 745f 616e  _func = _sqrt_an
-0000caa0: 645f 636f 6e76 6572 745f 746f 5f74 696d  d_convert_to_tim
-0000cab0: 6564 656c 7461 0a20 2020 2020 2020 2065  edelta.        e
-0000cac0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000cad0: 2073 7172 745f 6675 6e63 5f6b 7761 7267   sqrt_func_kwarg
-0000cae0: 7320 3d20 7b7d 0a20 2020 2020 2020 2020  s = {}.         
-0000caf0: 2020 2073 7172 745f 6675 6e63 203d 206e     sqrt_func = n
-0000cb00: 702e 7371 7274 0a0a 2020 2020 2020 2020  p.sqrt..        
-0000cb10: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
-0000cb20: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-0000cb30: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
-0000cb40: 5f66 756e 632c 0a20 2020 2020 2020 2020  _func,.         
-0000cb50: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-0000cb60: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
-0000cb70: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0000cb80: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0000cb90: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
-0000cba0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-0000cbb0: 2020 2a2a 7371 7274 5f66 756e 635f 6b77    **sqrt_func_kw
-0000cbc0: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
-0000cbd0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000cbe0: 6573 756c 740a 0a20 2020 2064 6566 2065  esult..    def e
-0000cbf0: 6e66 6f72 6365 5f72 756e 7469 6d65 5f64  nforce_runtime_d
-0000cc00: 6976 6973 696f 6e73 2873 656c 6629 3a0a  ivisions(self):.
-0000cc10: 2020 2020 2020 2020 2222 2245 6e66 6f72          """Enfor
-0000cc20: 6365 2074 6865 2063 7572 7265 6e74 2064  ce the current d
-0000cc30: 6976 6973 696f 6e73 2061 7420 7275 6e74  ivisions at runt
-0000cc40: 696d 652e 0a0a 2020 2020 2020 2020 496e  ime...        In
-0000cc50: 6a65 6374 7320 6120 6c61 7965 7220 696e  jects a layer in
-0000cc60: 746f 2074 6865 2054 6173 6b20 4772 6170  to the Task Grap
-0000cc70: 6820 7468 6174 2063 6865 636b 7320 7468  h that checks th
-0000cc80: 6174 2074 6865 2063 7572 7265 6e74 2064  at the current d
-0000cc90: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
-0000cca0: 206d 6174 6368 2074 6865 2065 7870 6563   match the expec
-0000ccb0: 7465 6420 6469 7669 7369 6f6e 7320 6174  ted divisions at
-0000ccc0: 2072 756e 7469 6d65 2e0a 2020 2020 2020   runtime..      
-0000ccd0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0000cce0: 206e 6f74 2073 656c 662e 6b6e 6f77 6e5f   not self.known_
-0000ccf0: 6469 7669 7369 6f6e 733a 0a20 2020 2020  divisions:.     
-0000cd00: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000cd10: 7565 4572 726f 7228 224e 6f20 6b6e 6f77  ueError("No know
-0000cd20: 6e20 6469 7669 7369 6f6e 7320 746f 2065  n divisions to e
-0000cd30: 6e66 6f72 6365 2122 290a 2020 2020 2020  nforce!").      
-0000cd40: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-0000cd50: 6c65 6374 696f 6e28 6578 7072 2e45 6e66  lection(expr.Enf
-0000cd60: 6f72 6365 5275 6e74 696d 6544 6976 6973  orceRuntimeDivis
-0000cd70: 696f 6e73 2873 656c 6629 290a 0a20 2020  ions(self))..   
-0000cd80: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000cd90: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000cda0: 2064 6566 2073 6b65 7728 0a20 2020 2020   def skew(.     
-0000cdb0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000cdc0: 2061 7869 733d 302c 0a20 2020 2020 2020   axis=0,.       
-0000cdd0: 2062 6961 733d 5472 7565 2c0a 2020 2020   bias=True,.    
-0000cde0: 2020 2020 6e61 6e5f 706f 6c69 6379 3d22      nan_policy="
-0000cdf0: 7072 6f70 6167 6174 6522 2c0a 2020 2020  propagate",.    
-0000ce00: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
-0000ce10: 3d46 616c 7365 2c0a 2020 2020 293a 0a20  =False,.    ):. 
-0000ce20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000ce30: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
-0000ce40: 2020 2020 2020 2020 2054 6869 7320 696d           This im
-0000ce50: 706c 656d 656e 7461 7469 6f6e 2066 6f6c  plementation fol
-0000ce60: 6c6f 7773 2074 6865 2064 6173 6b2e 6172  lows the dask.ar
-0000ce70: 7261 792e 7374 6174 7320 696d 706c 656d  ray.stats implem
-0000ce80: 656e 7461 7469 6f6e 0a20 2020 2020 2020  entation.       
-0000ce90: 2020 2020 6f66 2073 6b65 776e 6573 7320      of skewness 
-0000cea0: 616e 6420 6361 6c63 756c 6174 6573 2073  and calculates s
-0000ceb0: 6b65 776e 6573 7320 7769 7468 6f75 7420  kewness without 
-0000cec0: 7461 6b69 6e67 2069 6e74 6f20 6163 636f  taking into acco
-0000ced0: 756e 740a 2020 2020 2020 2020 2020 2061  unt.           a
-0000cee0: 2062 6961 7320 7465 726d 2066 6f72 2066   bias term for f
-0000cef0: 696e 6974 6520 7361 6d70 6c65 2073 697a  inite sample siz
-0000cf00: 652c 2077 6869 6368 2063 6f72 7265 7370  e, which corresp
-0000cf10: 6f6e 6473 2074 6f20 7468 650a 2020 2020  onds to the.    
-0000cf20: 2020 2020 2020 2064 6566 6175 6c74 2073         default s
-0000cf30: 6574 7469 6e67 7320 6f66 2074 6865 2073  ettings of the s
-0000cf40: 6369 7079 2e73 7461 7473 2073 6b65 776e  cipy.stats skewn
-0000cf50: 6573 7320 6361 6c63 756c 6174 696f 6e2e  ess calculation.
-0000cf60: 2048 6f77 6576 6572 2c0a 2020 2020 2020   However,.      
-0000cf70: 2020 2020 2050 616e 6461 7320 636f 7272       Pandas corr
-0000cf80: 6563 7473 2066 6f72 2074 6869 732c 2073  ects for this, s
-0000cf90: 6f20 7468 6520 7661 6c75 6573 2064 6966  o the values dif
-0000cfa0: 6665 7220 6279 2061 2066 6163 746f 7220  fer by a factor 
-0000cfb0: 6f66 0a20 2020 2020 2020 2020 2020 286e  of.           (n
-0000cfc0: 202a 2028 6e20 2d20 3129 2920 2a2a 2030   * (n - 1)) ** 0
-0000cfd0: 2e35 202f 2028 6e20 2d20 3229 2c20 7768  .5 / (n - 2), wh
-0000cfe0: 6572 6520 6e20 6973 2074 6865 206e 756d  ere n is the num
-0000cff0: 6265 7220 6f66 2073 616d 706c 6573 2e0a  ber of samples..
-0000d000: 0a20 2020 2020 2020 2020 2020 4675 7274  .           Furt
-0000d010: 6865 722c 2074 6869 7320 6d65 7468 6f64  her, this method
-0000d020: 2063 7572 7265 6e74 6c79 2064 6f65 7320   currently does 
-0000d030: 6e6f 7420 7375 7070 6f72 7420 6669 6c74  not support filt
-0000d040: 6572 696e 6720 6f75 7420 4e61 4e0a 2020  ering out NaN.  
-0000d050: 2020 2020 2020 2020 2076 616c 7565 732c           values,
-0000d060: 2077 6869 6368 2069 7320 6167 6169 6e20   which is again 
-0000d070: 6120 6469 6666 6572 656e 6365 2074 6f20  a difference to 
-0000d080: 5061 6e64 6173 2e0a 2020 2020 2020 2020  Pandas..        
-0000d090: 2222 220a 2020 2020 2020 2020 5f72 6169  """.        _rai
-0000d0a0: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
-0000d0b0: 6965 7328 7365 6c66 2c20 2273 6b65 7722  ies(self, "skew"
-0000d0c0: 290a 2020 2020 2020 2020 6966 2061 7869  ).        if axi
-0000d0d0: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0000d0e0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000d0f0: 7565 4572 726f 7228 2260 6178 6973 3d4e  ueError("`axis=N
-0000d100: 6f6e 6560 2069 736e 2774 2063 7572 7265  one` isn't curre
-0000d110: 6e74 6c79 2073 7570 706f 7274 6564 2066  ntly supported f
-0000d120: 6f72 2060 736b 6577 6022 290a 2020 2020  or `skew`").    
-0000d130: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
-0000d140: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-0000d150: 7869 7329 0a0a 2020 2020 2020 2020 6966  xis)..        if
-0000d160: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-0000d170: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
-0000d180: 2020 2020 2020 2320 4c65 7420 7061 6e64        # Let pand
-0000d190: 6173 2072 6169 7365 2065 7272 6f72 7320  as raise errors 
-0000d1a0: 6966 206e 6563 6573 7361 7279 0a20 2020  if necessary.   
-0000d1b0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-0000d1c0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-0000d1d0: 7074 792e 736b 6577 2861 7869 733d 6178  pty.skew(axis=ax
-0000d1e0: 6973 2c20 6e75 6d65 7269 635f 6f6e 6c79  is, numeric_only
-0000d1f0: 3d6e 756d 6572 6963 5f6f 6e6c 7929 0a20  =numeric_only). 
-0000d200: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000d210: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-0000d220: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-0000d230: 7074 792e 736b 6577 2829 0a0a 2020 2020  pty.skew()..    
-0000d240: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-0000d250: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000d260: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-0000d270: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-0000d280: 2020 2020 2020 2020 2020 4d2e 736b 6577            M.skew
-0000d290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d2a0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-0000d2b0: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-0000d2c0: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-0000d2d0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-0000d2e0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
-0000d2f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000d300: 2020 2020 2020 2069 6620 6e6f 7420 6269         if not bi
-0000d310: 6173 3a0a 2020 2020 2020 2020 2020 2020  as:.            
-0000d320: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0000d330: 6e74 6564 4572 726f 7228 2262 6961 733d  ntedError("bias=
-0000d340: 4661 6c73 6520 6973 206e 6f74 2069 6d70  False is not imp
-0000d350: 6c65 6d65 6e74 6564 2e22 290a 2020 2020  lemented.").    
-0000d360: 2020 2020 6966 206e 616e 5f70 6f6c 6963      if nan_polic
-0000d370: 7920 213d 2022 7072 6f70 6167 6174 6522  y != "propagate"
-0000d380: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000d390: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0000d3a0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-0000d3b0: 2020 2020 2020 2020 2022 606e 616e 5f70           "`nan_p
-0000d3c0: 6f6c 6963 7960 206f 7468 6572 2074 6861  olicy` other tha
-0000d3d0: 6e20 2770 726f 7061 6761 7465 2720 6861  n 'propagate' ha
-0000d3e0: 7665 206e 6f74 2062 6565 6e20 696d 706c  ve not been impl
-0000d3f0: 656d 656e 7465 642e 220a 2020 2020 2020  emented.".      
-0000d400: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000d410: 2066 7261 6d65 203d 2073 656c 660a 2020   frame = self.  
-0000d420: 2020 2020 2020 6966 2066 7261 6d65 2e6e        if frame.n
-0000d430: 6469 6d20 3e20 313a 0a20 2020 2020 2020  dim > 1:.       
-0000d440: 2020 2020 2066 7261 6d65 203d 2066 7261       frame = fra
-0000d450: 6d65 2e73 656c 6563 745f 6474 7970 6573  me.select_dtypes
-0000d460: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000d470: 2020 696e 636c 7564 653d 5b22 6e75 6d62    include=["numb
-0000d480: 6572 222c 2022 626f 6f6c 225d 2c20 6578  er", "bool"], ex
-0000d490: 636c 7564 653d 5b6e 702e 7469 6d65 6465  clude=[np.timede
-0000d4a0: 6c74 6136 345d 0a20 2020 2020 2020 2020  lta64].         
-0000d4b0: 2020 2029 0a20 2020 2020 2020 206d 3220     ).        m2 
-0000d4c0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-0000d4d0: 284d 6f6d 656e 7428 6672 616d 652c 206f  (Moment(frame, o
-0000d4e0: 7264 6572 3d32 2929 0a20 2020 2020 2020  rder=2)).       
-0000d4f0: 206d 3320 3d20 6e65 775f 636f 6c6c 6563   m3 = new_collec
-0000d500: 7469 6f6e 284d 6f6d 656e 7428 6672 616d  tion(Moment(fram
-0000d510: 652c 206f 7264 6572 3d33 2929 0a20 2020  e, order=3)).   
-0000d520: 2020 2020 2072 6573 756c 7420 3d20 6d33       result = m3
-0000d530: 202f 206d 322a 2a31 2e35 0a20 2020 2020   / m2**1.5.     
-0000d540: 2020 2069 6620 7265 7375 6c74 2e6e 6469     if result.ndi
-0000d550: 6d20 3d3d 2031 3a0a 2020 2020 2020 2020  m == 1:.        
-0000d560: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
-0000d570: 756c 742e 6669 6c6c 6e61 2830 2e30 290a  ult.fillna(0.0).
-0000d580: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000d590: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
-0000d5a0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000d5b0: 4672 616d 6529 0a20 2020 2064 6566 206b  Frame).    def k
-0000d5c0: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
-0000d5d0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-0000d5e0: 7869 733d 302c 0a20 2020 2020 2020 2066  xis=0,.        f
-0000d5f0: 6973 6865 723d 5472 7565 2c0a 2020 2020  isher=True,.    
-0000d600: 2020 2020 6269 6173 3d54 7275 652c 0a20      bias=True,. 
-0000d610: 2020 2020 2020 206e 616e 5f70 6f6c 6963         nan_polic
-0000d620: 793d 2270 726f 7061 6761 7465 222c 0a20  y="propagate",. 
-0000d630: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-0000d640: 6e6c 793d 4661 6c73 652c 0a20 2020 2029  nly=False,.    )
-0000d650: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000d660: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
-0000d670: 0a20 2020 2020 2020 2020 2020 5468 6973  .           This
-0000d680: 2069 6d70 6c65 6d65 6e74 6174 696f 6e20   implementation 
-0000d690: 666f 6c6c 6f77 7320 7468 6520 6461 736b  follows the dask
-0000d6a0: 2e61 7272 6179 2e73 7461 7473 2069 6d70  .array.stats imp
-0000d6b0: 6c65 6d65 6e74 6174 696f 6e0a 2020 2020  lementation.    
-0000d6c0: 2020 2020 2020 206f 6620 6b75 7274 6f73         of kurtos
-0000d6d0: 6973 2061 6e64 2063 616c 6375 6c61 7465  is and calculate
-0000d6e0: 7320 6b75 7274 6f73 6973 2077 6974 686f  s kurtosis witho
-0000d6f0: 7574 2074 616b 696e 6720 696e 746f 2061  ut taking into a
-0000d700: 6363 6f75 6e74 0a20 2020 2020 2020 2020  ccount.         
-0000d710: 2020 6120 6269 6173 2074 6572 6d20 666f    a bias term fo
-0000d720: 7220 6669 6e69 7465 2073 616d 706c 6520  r finite sample 
-0000d730: 7369 7a65 2c20 7768 6963 6820 636f 7272  size, which corr
-0000d740: 6573 706f 6e64 7320 746f 2074 6865 0a20  esponds to the. 
-0000d750: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
-0000d760: 7420 7365 7474 696e 6773 206f 6620 7468  t settings of th
-0000d770: 6520 7363 6970 792e 7374 6174 7320 6b75  e scipy.stats ku
-0000d780: 7274 6f73 6973 2063 616c 6375 6c61 7469  rtosis calculati
-0000d790: 6f6e 2e20 5468 6973 2064 6966 6665 7273  on. This differs
-0000d7a0: 0a20 2020 2020 2020 2020 2020 6672 6f6d  .           from
-0000d7b0: 2070 616e 6461 732e 0a0a 2020 2020 2020   pandas...      
-0000d7c0: 2020 2020 2046 7572 7468 6572 2c20 7468       Further, th
-0000d7d0: 6973 206d 6574 686f 6420 6375 7272 656e  is method curren
-0000d7e0: 746c 7920 646f 6573 206e 6f74 2073 7570  tly does not sup
-0000d7f0: 706f 7274 2066 696c 7465 7269 6e67 206f  port filtering o
-0000d800: 7574 204e 614e 0a20 2020 2020 2020 2020  ut NaN.         
-0000d810: 2020 7661 6c75 6573 2c20 7768 6963 6820    values, which 
-0000d820: 6973 2061 6761 696e 2061 2064 6966 6665  is again a diffe
-0000d830: 7265 6e63 6520 746f 2050 616e 6461 732e  rence to Pandas.
-0000d840: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000d850: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
-0000d860: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
-0000d870: 662c 2022 6b75 7274 6f73 6973 2229 0a20  f, "kurtosis"). 
-0000d880: 2020 2020 2020 2069 6620 6178 6973 2069         if axis i
-0000d890: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000d8a0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000d8b0: 7272 6f72 2822 6061 7869 733d 4e6f 6e65  rror("`axis=None
-0000d8c0: 6020 6973 6e27 7420 6375 7272 656e 746c  ` isn't currentl
-0000d8d0: 7920 7375 7070 6f72 7465 6420 666f 7220  y supported for 
-0000d8e0: 6073 6b65 7760 2229 0a20 2020 2020 2020  `skew`").       
-0000d8f0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
-0000d900: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
-0000d910: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
-0000d920: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-0000d930: 7365 6c66 293a 0a20 2020 2020 2020 2020  self):.         
-0000d940: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
-0000d950: 7261 6973 6520 6572 726f 7273 2069 6620  raise errors if 
-0000d960: 6e65 6365 7373 6172 790a 2020 2020 2020  necessary.      
-0000d970: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-0000d980: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
-0000d990: 2e6b 7572 746f 7369 7328 6178 6973 3d61  .kurtosis(axis=a
-0000d9a0: 7869 732c 206e 756d 6572 6963 5f6f 6e6c  xis, numeric_onl
-0000d9b0: 793d 6e75 6d65 7269 635f 6f6e 6c79 290a  y=numeric_only).
-0000d9c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000d9d0: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-0000d9e0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-0000d9f0: 6d70 7479 2e6b 7572 746f 7369 7328 290a  mpty.kurtosis().
-0000da00: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-0000da10: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-0000da20: 2020 2072 6574 7572 6e20 6d61 705f 7061     return map_pa
-0000da30: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-0000da40: 2020 2020 2020 2020 2020 4d2e 6b75 7274            M.kurt
-0000da50: 6f73 6973 2c0a 2020 2020 2020 2020 2020  osis,.          
-0000da60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0000da70: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-0000da80: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
-0000da90: 2020 2020 2020 2074 6f6b 656e 3d73 656c         token=sel
-0000daa0: 662e 5f74 6f6b 656e 5f70 7265 6669 7820  f._token_prefix 
-0000dab0: 2b20 226b 7572 746f 7369 7322 2c0a 2020  + "kurtosis",.  
-0000dac0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0000dad0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-0000dae0: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-0000daf0: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-0000db00: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000db10: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
-0000db20: 6961 733a 0a20 2020 2020 2020 2020 2020  ias:.           
-0000db30: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0000db40: 656e 7465 6445 7272 6f72 2822 6269 6173  entedError("bias
-0000db50: 3d46 616c 7365 2069 7320 6e6f 7420 696d  =False is not im
-0000db60: 706c 656d 656e 7465 642e 2229 0a20 2020  plemented.").   
-0000db70: 2020 2020 2069 6620 6e61 6e5f 706f 6c69       if nan_poli
-0000db80: 6379 2021 3d20 2270 726f 7061 6761 7465  cy != "propagate
-0000db90: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
-0000dba0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0000dbb0: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-0000dbc0: 2020 2020 2020 2020 2020 2260 6e61 6e5f            "`nan_
-0000dbd0: 706f 6c69 6379 6020 6f74 6865 7220 7468  policy` other th
-0000dbe0: 616e 2027 7072 6f70 6167 6174 6527 2068  an 'propagate' h
-0000dbf0: 6176 6520 6e6f 7420 6265 656e 2069 6d70  ave not been imp
-0000dc00: 6c65 6d65 6e74 6564 2e22 0a20 2020 2020  lemented.".     
-0000dc10: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000dc20: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
-0000dc30: 2020 2020 2020 2069 6620 6672 616d 652e         if frame.
-0000dc40: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
-0000dc50: 2020 2020 2020 6672 616d 6520 3d20 6672        frame = fr
-0000dc60: 616d 652e 7365 6c65 6374 5f64 7479 7065  ame.select_dtype
-0000dc70: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0000dc80: 2020 2069 6e63 6c75 6465 3d5b 226e 756d     include=["num
-0000dc90: 6265 7222 2c20 2262 6f6f 6c22 5d2c 2065  ber", "bool"], e
-0000dca0: 7863 6c75 6465 3d5b 6e70 2e74 696d 6564  xclude=[np.timed
-0000dcb0: 656c 7461 3634 5d0a 2020 2020 2020 2020  elta64].        
-0000dcc0: 2020 2020 290a 2020 2020 2020 2020 6d32      ).        m2
-0000dcd0: 203d 206e 6577 5f63 6f6c 6c65 6374 696f   = new_collectio
-0000dce0: 6e28 4d6f 6d65 6e74 2866 7261 6d65 2c20  n(Moment(frame, 
-0000dcf0: 6f72 6465 723d 3229 290a 2020 2020 2020  order=2)).      
-0000dd00: 2020 6d34 203d 206e 6577 5f63 6f6c 6c65    m4 = new_colle
-0000dd10: 6374 696f 6e28 4d6f 6d65 6e74 2866 7261  ction(Moment(fra
-0000dd20: 6d65 2c20 6f72 6465 723d 3429 290a 2020  me, order=4)).  
-0000dd30: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
-0000dd40: 3420 2f20 6d32 2a2a 322e 300a 2020 2020  4 / m2**2.0.    
-0000dd50: 2020 2020 6966 2072 6573 756c 742e 6e64      if result.nd
-0000dd60: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
-0000dd70: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
-0000dd80: 7375 6c74 2e66 696c 6c6e 6128 302e 3029  sult.fillna(0.0)
-0000dd90: 0a20 2020 2020 2020 2069 6620 6669 7368  .        if fish
-0000dda0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-0000ddb0: 7265 7475 726e 2072 6573 756c 7420 2d20  return result - 
-0000ddc0: 330a 2020 2020 2020 2020 656c 7365 3a0a  3.        else:.
-0000ddd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000dde0: 726e 2072 6573 756c 740a 0a20 2020 206b  rn result..    k
-0000ddf0: 7572 7420 3d20 6b75 7274 6f73 6973 0a0a  urt = kurtosis..
-0000de00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0000de10: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0000de20: 2020 2020 6465 6620 7365 6d28 0a20 2020      def sem(.   
-0000de30: 2020 2020 2073 656c 662c 2061 7869 733d       self, axis=
-0000de40: 4e6f 6e65 2c20 736b 6970 6e61 3d54 7275  None, skipna=Tru
-0000de50: 652c 2064 646f 663d 312c 2073 706c 6974  e, ddof=1, split
-0000de60: 5f65 7665 7279 3d46 616c 7365 2c20 6e75  _every=False, nu
-0000de70: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-0000de80: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000de90: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-0000dea0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-0000deb0: 0a20 2020 2020 2020 205f 7261 6973 655f  .        _raise_
-0000dec0: 6966 5f6f 626a 6563 745f 7365 7269 6573  if_object_series
-0000ded0: 2873 656c 662c 2022 7365 6d22 290a 2020  (self, "sem").  
-0000dee0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-0000def0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-0000df00: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-0000df10: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0000df20: 2020 2020 2020 2020 2020 2020 4d2e 7365              M.se
-0000df30: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
-0000df40: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
-0000df50: 2020 2020 2020 2020 2020 2020 2020 736b                sk
-0000df60: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
-0000df70: 2020 2020 2020 2020 2020 2020 2064 646f               ddo
-0000df80: 663d 6464 6f66 2c0a 2020 2020 2020 2020  f=ddof,.        
-0000df90: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-0000dfa0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
-0000dfb0: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
-0000dfc0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0000dfd0: 7365 6c66 2e5f 6d65 7461 2e73 656d 2873  self._meta.sem(s
-0000dfe0: 6b69 706e 613d 736b 6970 6e61 2c20 6464  kipna=skipna, dd
-0000dff0: 6f66 3d64 646f 662c 206e 756d 6572 6963  of=ddof, numeric
-0000e000: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-0000e010: 6c79 290a 2020 2020 2020 2020 6672 616d  ly).        fram
-0000e020: 6520 3d20 7365 6c66 0a20 2020 2020 2020  e = self.       
-0000e030: 2069 6620 7365 6c66 2e6e 6469 6d20 3d3d   if self.ndim ==
-0000e040: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-0000e050: 6672 616d 6520 3d20 7365 6c66 5b6c 6973  frame = self[lis
-0000e060: 7428 6d65 7461 2e69 6e64 6578 295d 0a0a  t(meta.index)]..
-0000e070: 2020 2020 2020 2020 7620 3d20 6672 616d          v = fram
-0000e080: 652e 7661 7228 736b 6970 6e61 3d73 6b69  e.var(skipna=ski
-0000e090: 706e 612c 2064 646f 663d 6464 6f66 2c20  pna, ddof=ddof, 
-0000e0a0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0000e0b0: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
-0000e0c0: 206e 203d 2066 7261 6d65 2e63 6f75 6e74   n = frame.count
-0000e0d0: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
-0000e0e0: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-0000e0f0: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
-0000e100: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0000e110: 2020 2020 2020 206e 702e 7371 7274 2c0a         np.sqrt,.
-0000e120: 2020 2020 2020 2020 2020 2020 7620 2f20              v / 
-0000e130: 6e2c 0a20 2020 2020 2020 2020 2020 206d  n,.            m
-0000e140: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
-0000e150: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-0000e160: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-0000e170: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
-0000e180: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
-0000e190: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000e1a0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0000e1b0: 740a 0a20 2020 2064 6566 205f 7072 6570  t..    def _prep
-0000e1c0: 6172 655f 636f 765f 636f 7272 2873 656c  are_cov_corr(sel
-0000e1d0: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
-0000e1e0: 6e75 6d65 7269 635f 6f6e 6c79 293a 0a20  numeric_only):. 
-0000e1f0: 2020 2020 2020 2069 6620 6d69 6e5f 7065         if min_pe
-0000e200: 7269 6f64 7320 6973 204e 6f6e 653a 0a20  riods is None:. 
-0000e210: 2020 2020 2020 2020 2020 206d 696e 5f70             min_p
-0000e220: 6572 696f 6473 203d 2032 0a20 2020 2020  eriods = 2.     
-0000e230: 2020 2065 6c69 6620 6d69 6e5f 7065 7269     elif min_peri
-0000e240: 6f64 7320 3c20 323a 0a20 2020 2020 2020  ods < 2:.       
-0000e250: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000e260: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
-0000e270: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
-0000e280: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000e290: 5f6d 6574 612e 636f 7628 6e75 6d65 7269  _meta.cov(numeri
-0000e2a0: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
-0000e2b0: 6e6c 792c 206d 696e 5f70 6572 696f 6473  nly, min_periods
-0000e2c0: 3d6d 696e 5f70 6572 696f 6473 290a 0a20  =min_periods).. 
-0000e2d0: 2020 2020 2020 2066 7261 6d65 203d 2073         frame = s
-0000e2e0: 656c 660a 2020 2020 2020 2020 6966 206e  elf.        if n
-0000e2f0: 756d 6572 6963 5f6f 6e6c 793a 0a20 2020  umeric_only:.   
-0000e300: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-0000e310: 7320 3d20 7365 6c66 2e5f 6d65 7461 2e5f  s = self._meta._
-0000e320: 6765 745f 6e75 6d65 7269 635f 6461 7461  get_numeric_data
-0000e330: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-0000e340: 6620 6c65 6e28 6e75 6d65 7269 6373 2e63  f len(numerics.c
-0000e350: 6f6c 756d 6e73 2920 213d 206c 656e 2873  olumns) != len(s
-0000e360: 656c 662e 636f 6c75 6d6e 7329 3a0a 2020  elf.columns):.  
-0000e370: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-0000e380: 616d 6520 3d20 6672 616d 655b 6c69 7374  ame = frame[list
-0000e390: 286e 756d 6572 6963 732e 636f 6c75 6d6e  (numerics.column
-0000e3a0: 7329 5d0a 2020 2020 2020 2020 7265 7475  s)].        retu
-0000e3b0: 726e 2066 7261 6d65 2c20 6d69 6e5f 7065  rn frame, min_pe
-0000e3c0: 7269 6f64 730a 0a20 2020 2064 6566 205f  riods..    def _
-0000e3d0: 636f 7628 0a20 2020 2020 2020 2073 656c  cov(.        sel
-0000e3e0: 662c 206d 696e 5f70 6572 696f 6473 3d4e  f, min_periods=N
-0000e3f0: 6f6e 652c 206e 756d 6572 6963 5f6f 6e6c  one, numeric_onl
-0000e400: 793d 4661 6c73 652c 2073 706c 6974 5f65  y=False, split_e
-0000e410: 7665 7279 3d46 616c 7365 2c20 7363 616c  very=False, scal
-0000e420: 6172 3d46 616c 7365 0a20 2020 2029 3a0a  ar=False.    ):.
-0000e430: 2020 2020 2020 2020 6672 616d 652c 206d          frame, m
-0000e440: 696e 5f70 6572 696f 6473 203d 2073 656c  in_periods = sel
-0000e450: 662e 5f70 7265 7061 7265 5f63 6f76 5f63  f._prepare_cov_c
-0000e460: 6f72 7228 6d69 6e5f 7065 7269 6f64 732c  orr(min_periods,
-0000e470: 206e 756d 6572 6963 5f6f 6e6c 7929 0a20   numeric_only). 
-0000e480: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0000e490: 775f 636f 6c6c 6563 7469 6f6e 2843 6f76  w_collection(Cov
-0000e4a0: 2866 7261 6d65 2c20 6d69 6e5f 7065 7269  (frame, min_peri
-0000e4b0: 6f64 732c 2073 706c 6974 5f65 7665 7279  ods, split_every
-0000e4c0: 2c20 7363 616c 6172 2929 0a0a 2020 2020  , scalar))..    
-0000e4d0: 6465 6620 5f63 6f72 7228 0a20 2020 2020  def _corr(.     
-0000e4e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000e4f0: 206d 6574 686f 643d 2270 6561 7273 6f6e   method="pearson
-0000e500: 222c 0a20 2020 2020 2020 206d 696e 5f70  ",.        min_p
-0000e510: 6572 696f 6473 3d4e 6f6e 652c 0a20 2020  eriods=None,.   
-0000e520: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-0000e530: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
-0000e540: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-0000e550: 7365 2c0a 2020 2020 2020 2020 7363 616c  se,.        scal
-0000e560: 6172 3d46 616c 7365 2c0a 2020 2020 293a  ar=False,.    ):
-0000e570: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-0000e580: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
-0000e590: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000e5a0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0000e5b0: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
-0000e5c0: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-0000e5d0: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
-0000e5e0: 656e 7465 6422 290a 2020 2020 2020 2020  ented").        
-0000e5f0: 6672 616d 652c 206d 696e 5f70 6572 696f  frame, min_perio
-0000e600: 6473 203d 2073 656c 662e 5f70 7265 7061  ds = self._prepa
-0000e610: 7265 5f63 6f76 5f63 6f72 7228 6d69 6e5f  re_cov_corr(min_
-0000e620: 7065 7269 6f64 732c 206e 756d 6572 6963  periods, numeric
-0000e630: 5f6f 6e6c 7929 0a20 2020 2020 2020 2072  _only).        r
-0000e640: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000e650: 7469 6f6e 2843 6f72 7228 6672 616d 652c  tion(Corr(frame,
-0000e660: 206d 696e 5f70 6572 696f 6473 2c20 7370   min_periods, sp
-0000e670: 6c69 745f 6576 6572 792c 2073 6361 6c61  lit_every, scala
-0000e680: 7229 290a 0a20 2020 2040 6465 7269 7665  r))..    @derive
-0000e690: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0000e6a0: 616d 6529 0a20 2020 2064 6566 206d 6561  ame).    def mea
-0000e6b0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
-0000e6c0: 2061 7869 733d 302c 2073 6b69 706e 613d   axis=0, skipna=
-0000e6d0: 5472 7565 2c20 6e75 6d65 7269 635f 6f6e  True, numeric_on
-0000e6e0: 6c79 3d46 616c 7365 2c20 7370 6c69 745f  ly=False, split_
-0000e6f0: 6576 6572 793d 4661 6c73 652c 202a 2a6b  every=False, **k
-0000e700: 7761 7267 730a 2020 2020 293a 0a20 2020  wargs.    ):.   
-0000e710: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
-0000e720: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
-0000e730: 662c 2022 6d65 616e 2229 0a20 2020 2020  f, "mean").     
-0000e740: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
-0000e750: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
-0000e760: 6973 290a 2020 2020 2020 2020 6966 2061  is).        if a
-0000e770: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-0000e780: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000e790: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0000e7a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000e7b0: 2020 4d2e 6d65 616e 2c20 736b 6970 6e61    M.mean, skipna
-0000e7c0: 3d73 6b69 706e 612c 206e 756d 6572 6963  =skipna, numeric
-0000e7d0: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-0000e7e0: 6c79 2c20 6178 6973 3d61 7869 730a 2020  ly, axis=axis.  
-0000e7f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000e800: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0000e810: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-0000e820: 2020 2020 2020 2073 656c 662e 6578 7072         self.expr
-0000e830: 2e6d 6561 6e28 736b 6970 6e61 2c20 6e75  .mean(skipna, nu
-0000e840: 6d65 7269 635f 6f6e 6c79 2c20 7370 6c69  meric_only, spli
-0000e850: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-0000e860: 6572 792c 2061 7869 733d 6178 6973 290a  ery, axis=axis).
-0000e870: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0000e880: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0000e890: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000e8a0: 6566 206d 6178 2873 656c 662c 2061 7869  ef max(self, axi
-0000e8b0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
-0000e8c0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
-0000e8d0: 616c 7365 2c20 7370 6c69 745f 6576 6572  alse, split_ever
-0000e8e0: 793d 4661 6c73 652c 202a 2a6b 7761 7267  y=False, **kwarg
-0000e8f0: 7329 3a0a 2020 2020 2020 2020 6178 6973  s):.        axis
-0000e900: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-0000e910: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-0000e920: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0000e930: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0000e940: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0000e950: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0000e960: 2020 2020 2020 2020 2020 204d 2e6d 6178             M.max
-0000e970: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
-0000e980: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-0000e990: 6d65 7269 635f 6f6e 6c79 2c20 6178 6973  meric_only, axis
-0000e9a0: 3d61 7869 730a 2020 2020 2020 2020 2020  =axis.          
-0000e9b0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0000e9c0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0000e9d0: 6e28 7365 6c66 2e65 7870 722e 6d61 7828  n(self.expr.max(
-0000e9e0: 736b 6970 6e61 2c20 6e75 6d65 7269 635f  skipna, numeric_
-0000e9f0: 6f6e 6c79 2c20 7370 6c69 745f 6576 6572  only, split_ever
-0000ea00: 792c 2061 7869 7329 290a 0a20 2020 2040  y, axis))..    @
-0000ea10: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0000ea20: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000ea30: 6566 2061 6e79 2873 656c 662c 2061 7869  ef any(self, axi
-0000ea40: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
-0000ea50: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-0000ea60: 6c73 652c 202a 2a6b 7761 7267 7329 3a0a  lse, **kwargs):.
-0000ea70: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-0000ea80: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-0000ea90: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-0000eaa0: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
-0000eab0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000eac0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-0000ead0: 7469 6f6e 7328 4d2e 616e 792c 2073 6b69  tions(M.any, ski
-0000eae0: 706e 613d 736b 6970 6e61 2c20 6178 6973  pna=skipna, axis
-0000eaf0: 3d61 7869 7329 0a20 2020 2020 2020 2072  =axis).        r
-0000eb00: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000eb10: 7469 6f6e 2873 656c 662e 6578 7072 2e61  tion(self.expr.a
-0000eb20: 6e79 2873 6b69 706e 612c 2073 706c 6974  ny(skipna, split
-0000eb30: 5f65 7665 7279 2929 0a0a 2020 2020 4064  _every))..    @d
-0000eb40: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0000eb50: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0000eb60: 6620 616c 6c28 7365 6c66 2c20 6178 6973  f all(self, axis
-0000eb70: 3d30 2c20 736b 6970 6e61 3d54 7275 652c  =0, skipna=True,
-0000eb80: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-0000eb90: 7365 2c20 2a2a 6b77 6172 6773 293a 0a20  se, **kwargs):. 
-0000eba0: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
-0000ebb0: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
-0000ebc0: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
-0000ebd0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
-0000ebe0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ebf0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0000ec00: 696f 6e73 284d 2e61 6c6c 2c20 736b 6970  ions(M.all, skip
-0000ec10: 6e61 3d73 6b69 706e 612c 2061 7869 733d  na=skipna, axis=
-0000ec20: 6178 6973 290a 2020 2020 2020 2020 7265  axis).        re
-0000ec30: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-0000ec40: 696f 6e28 7365 6c66 2e65 7870 722e 616c  ion(self.expr.al
-0000ec50: 6c28 736b 6970 6e61 2c20 7370 6c69 745f  l(skipna, split_
-0000ec60: 6576 6572 7929 290a 0a20 2020 2040 6465  every))..    @de
-0000ec70: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0000ec80: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0000ec90: 2069 6478 6d69 6e28 7365 6c66 2c20 6178   idxmin(self, ax
-0000eca0: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
-0000ecb0: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
-0000ecc0: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
-0000ecd0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
-0000ece0: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
-0000ecf0: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
-0000ed00: 6973 290a 2020 2020 2020 2020 6966 2061  is).        if a
-0000ed10: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-0000ed20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000ed30: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0000ed40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000ed50: 2020 4d2e 6964 786d 696e 2c20 736b 6970    M.idxmin, skip
-0000ed60: 6e61 3d73 6b69 706e 612c 206e 756d 6572  na=skipna, numer
-0000ed70: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
-0000ed80: 6f6e 6c79 2c20 6178 6973 3d61 7869 730a  only, axis=axis.
-0000ed90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000eda0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0000edb0: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
-0000edc0: 2e65 7870 722e 6964 786d 696e 2873 6b69  .expr.idxmin(ski
-0000edd0: 706e 612c 206e 756d 6572 6963 5f6f 6e6c  pna, numeric_onl
-0000ede0: 792c 2073 706c 6974 5f65 7665 7279 2929  y, split_every))
-0000edf0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0000ee00: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0000ee10: 290a 2020 2020 6465 6620 6964 786d 6178  ).    def idxmax
-0000ee20: 2873 656c 662c 2061 7869 733d 302c 2073  (self, axis=0, s
-0000ee30: 6b69 706e 613d 5472 7565 2c20 6e75 6d65  kipna=True, nume
-0000ee40: 7269 635f 6f6e 6c79 3d46 616c 7365 2c20  ric_only=False, 
-0000ee50: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-0000ee60: 6529 3a0a 2020 2020 2020 2020 6178 6973  e):.        axis
-0000ee70: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-0000ee80: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-0000ee90: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0000eea0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0000eeb0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0000eec0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0000eed0: 2020 2020 2020 2020 2020 204d 2e69 6478             M.idx
-0000eee0: 6d61 782c 2073 6b69 706e 613d 736b 6970  max, skipna=skip
-0000eef0: 6e61 2c20 6e75 6d65 7269 635f 6f6e 6c79  na, numeric_only
-0000ef00: 3d6e 756d 6572 6963 5f6f 6e6c 792c 2061  =numeric_only, a
-0000ef10: 7869 733d 6178 6973 0a20 2020 2020 2020  xis=axis.       
-0000ef20: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000ef30: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000ef40: 7469 6f6e 2873 656c 662e 6578 7072 2e69  tion(self.expr.i
-0000ef50: 6478 6d61 7828 736b 6970 6e61 2c20 6e75  dxmax(skipna, nu
-0000ef60: 6d65 7269 635f 6f6e 6c79 2c20 7370 6c69  meric_only, spli
-0000ef70: 745f 6576 6572 7929 290a 0a20 2020 2040  t_every))..    @
-0000ef80: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0000ef90: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000efa0: 6566 206d 696e 2873 656c 662c 2061 7869  ef min(self, axi
-0000efb0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
-0000efc0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
-0000efd0: 616c 7365 2c20 7370 6c69 745f 6576 6572  alse, split_ever
-0000efe0: 793d 4661 6c73 652c 202a 2a6b 7761 7267  y=False, **kwarg
-0000eff0: 7329 3a0a 2020 2020 2020 2020 6178 6973  s):.        axis
-0000f000: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-0000f010: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-0000f020: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-0000f030: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0000f040: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0000f050: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0000f060: 2020 2020 2020 2020 2020 204d 2e6d 696e             M.min
-0000f070: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
-0000f080: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-0000f090: 6d65 7269 635f 6f6e 6c79 2c20 6178 6973  meric_only, axis
-0000f0a0: 3d61 7869 730a 2020 2020 2020 2020 2020  =axis.          
-0000f0b0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0000f0c0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0000f0d0: 6e28 7365 6c66 2e65 7870 722e 6d69 6e28  n(self.expr.min(
-0000f0e0: 736b 6970 6e61 2c20 6e75 6d65 7269 635f  skipna, numeric_
-0000f0f0: 6f6e 6c79 2c20 7370 6c69 745f 6576 6572  only, split_ever
-0000f100: 792c 2061 7869 7329 290a 0a20 2020 2040  y, axis))..    @
-0000f110: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0000f120: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000f130: 6566 2063 6f75 6e74 2873 656c 662c 2061  ef count(self, a
-0000f140: 7869 733d 302c 206e 756d 6572 6963 5f6f  xis=0, numeric_o
-0000f150: 6e6c 793d 4661 6c73 652c 2073 706c 6974  nly=False, split
-0000f160: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
-0000f170: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
-0000f180: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
-0000f190: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
-0000f1a0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
-0000f1b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000f1c0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0000f1d0: 696f 6e73 284d 2e63 6f75 6e74 2c20 6e75  ions(M.count, nu
-0000f1e0: 6d65 7269 635f 6f6e 6c79 3d6e 756d 6572  meric_only=numer
-0000f1f0: 6963 5f6f 6e6c 792c 2061 7869 733d 6178  ic_only, axis=ax
-0000f200: 6973 290a 2020 2020 2020 2020 7265 7475  is).        retu
-0000f210: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0000f220: 6e28 7365 6c66 2e65 7870 722e 636f 756e  n(self.expr.coun
-0000f230: 7428 6e75 6d65 7269 635f 6f6e 6c79 2c20  t(numeric_only, 
-0000f240: 7370 6c69 745f 6576 6572 7929 290a 0a20  split_every)).. 
-0000f250: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0000f260: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0000f270: 2020 2064 6566 2061 6273 2873 656c 6629     def abs(self)
-0000f280: 3a0a 2020 2020 2020 2020 2320 5261 6973  :.        # Rais
-0000f290: 6520 7061 6e64 6173 2065 7272 6f72 730a  e pandas errors.
-0000f2a0: 2020 2020 2020 2020 5f72 6169 7365 5f69          _raise_i
-0000f2b0: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
-0000f2c0: 7365 6c66 2c20 2261 6273 2229 0a20 2020  self, "abs").   
-0000f2d0: 2020 2020 206d 6574 615f 6e6f 6e65 6d70       meta_nonemp
-0000f2e0: 7479 2873 656c 662e 5f6d 6574 6129 2e61  ty(self._meta).a
-0000f2f0: 6273 2829 0a20 2020 2020 2020 2072 6574  bs().        ret
-0000f300: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-0000f310: 6f6e 2873 656c 662e 6578 7072 2e61 6273  on(self.expr.abs
-0000f320: 2829 290a 0a20 2020 2040 6465 7269 7665  ())..    @derive
-0000f330: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0000f340: 616d 6529 0a20 2020 2064 6566 2061 7374  ame).    def ast
-0000f350: 7970 6528 7365 6c66 2c20 6474 7970 6573  ype(self, dtypes
-0000f360: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0000f370: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
-0000f380: 2873 656c 662e 6578 7072 2e61 7374 7970  (self.expr.astyp
-0000f390: 6528 6474 7970 6573 2929 0a0a 2020 2020  e(dtypes))..    
-0000f3a0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0000f3b0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0000f3c0: 6465 6620 636f 6d62 696e 655f 6669 7273  def combine_firs
-0000f3d0: 7428 7365 6c66 2c20 6f74 6865 7229 3a0a  t(self, other):.
-0000f3e0: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
-0000f3f0: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
-0000f400: 676e 6162 6c65 5f66 7261 6d65 286f 7468  gnable_frame(oth
-0000f410: 6572 2c20 226f 7574 6572 2229 2e65 7870  er, "outer").exp
-0000f420: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
-0000f430: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0000f440: 7365 6c66 2e65 7870 722e 636f 6d62 696e  self.expr.combin
-0000f450: 655f 6669 7273 7428 6f74 6865 7229 290a  e_first(other)).
-0000f460: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0000f470: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0000f480: 0a20 2020 2064 6566 2074 6f5f 7469 6d65  .    def to_time
-0000f490: 7374 616d 7028 7365 6c66 2c20 6672 6571  stamp(self, freq
-0000f4a0: 3d4e 6f6e 652c 2068 6f77 3d22 7374 6172  =None, how="star
-0000f4b0: 7422 293a 0a20 2020 2020 2020 2072 6574  t"):.        ret
-0000f4c0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-0000f4d0: 6f6e 2873 656c 662e 6578 7072 2e74 6f5f  on(self.expr.to_
-0000f4e0: 7469 6d65 7374 616d 7028 6672 6571 2c20  timestamp(freq, 
-0000f4f0: 686f 7729 290a 0a20 2020 2040 6465 7269  how))..    @deri
-0000f500: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000f510: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
-0000f520: 736e 6128 7365 6c66 293a 0a20 2020 2020  sna(self):.     
-0000f530: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-0000f540: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
-0000f550: 7072 2e69 736e 6128 2929 0a0a 2020 2020  pr.isna())..    
-0000f560: 6465 6620 7261 6e64 6f6d 5f73 706c 6974  def random_split
-0000f570: 2873 656c 662c 2066 7261 632c 2072 616e  (self, frac, ran
-0000f580: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
-0000f590: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
-0000f5a0: 2020 2020 2020 2020 2222 2250 7365 7564          """Pseud
-0000f5b0: 6f72 616e 646f 6d6c 7920 7370 6c69 7420  orandomly split 
-0000f5c0: 6461 7461 6672 616d 6520 696e 746f 2064  dataframe into d
-0000f5d0: 6966 6665 7265 6e74 2070 6965 6365 7320  ifferent pieces 
-0000f5e0: 726f 772d 7769 7365 0a0a 2020 2020 2020  row-wise..      
-0000f5f0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000f600: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000f610: 2020 2020 2020 2020 6672 6163 203a 206c          frac : l
-0000f620: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
-0000f630: 4c69 7374 206f 6620 666c 6f61 7473 2074  List of floats t
-0000f640: 6861 7420 7368 6f75 6c64 2073 756d 2074  hat should sum t
-0000f650: 6f20 6f6e 652e 0a20 2020 2020 2020 2072  o one..        r
-0000f660: 616e 646f 6d5f 7374 6174 6520 3a20 696e  andom_state : in
-0000f670: 7420 6f72 206e 702e 7261 6e64 6f6d 2e52  t or np.random.R
-0000f680: 616e 646f 6d53 7461 7465 0a20 2020 2020  andomState.     
-0000f690: 2020 2020 2020 2049 6620 696e 7420 6f72         If int or
-0000f6a0: 204e 6f6e 6520 6372 6561 7465 2061 206e   None create a n
-0000f6b0: 6577 2052 616e 646f 6d53 7461 7465 2077  ew RandomState w
-0000f6c0: 6974 6820 7468 6973 2061 7320 7468 6520  ith this as the 
-0000f6d0: 7365 6564 2e0a 2020 2020 2020 2020 2020  seed..          
-0000f6e0: 2020 4f74 6865 7277 6973 6520 6472 6177    Otherwise draw
-0000f6f0: 2066 726f 6d20 7468 6520 7061 7373 6564   from the passed
-0000f700: 2052 616e 646f 6d53 7461 7465 2e0a 2020   RandomState..  
-0000f710: 2020 2020 2020 7368 7566 666c 6520 3a20        shuffle : 
-0000f720: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
-0000f730: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0000f740: 4966 2073 6574 2074 6f20 5472 7565 2c20  If set to True, 
-0000f750: 7468 6520 6461 7461 6672 616d 6520 6973  the dataframe is
-0000f760: 2073 6875 6666 6c65 6420 2877 6974 6869   shuffled (withi
-0000f770: 6e20 7061 7274 6974 696f 6e29 0a20 2020  n partition).   
-0000f780: 2020 2020 2020 2020 2062 6566 6f72 6520           before 
-0000f790: 7468 6520 7370 6c69 742e 0a0a 2020 2020  the split...    
-0000f7a0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0000f7b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20       --------.. 
-0000f7c0: 2020 2020 2020 2035 302f 3530 2073 706c         50/50 spl
-0000f7d0: 6974 0a0a 2020 2020 2020 2020 3e3e 3e20  it..        >>> 
-0000f7e0: 612c 2062 203d 2064 662e 7261 6e64 6f6d  a, b = df.random
-0000f7f0: 5f73 706c 6974 285b 302e 352c 2030 2e35  _split([0.5, 0.5
-0000f800: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
-0000f810: 534b 4950 0a0a 2020 2020 2020 2020 3830  SKIP..        80
-0000f820: 2f31 302f 3130 2073 706c 6974 2c20 636f  /10/10 split, co
-0000f830: 6e73 6973 7465 6e74 2072 616e 646f 6d5f  nsistent random_
-0000f840: 7374 6174 650a 0a20 2020 2020 2020 203e  state..        >
-0000f850: 3e3e 2061 2c20 622c 2063 203d 2064 662e  >> a, b, c = df.
-0000f860: 7261 6e64 6f6d 5f73 706c 6974 285b 302e  random_split([0.
-0000f870: 382c 2030 2e31 2c20 302e 315d 2c20 7261  8, 0.1, 0.1], ra
-0000f880: 6e64 6f6d 5f73 7461 7465 3d31 3233 2920  ndom_state=123) 
-0000f890: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0000f8a0: 500a 0a20 2020 2020 2020 2053 6565 2041  P..        See A
-0000f8b0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-0000f8c0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-0000f8d0: 6b2e 4461 7461 4672 616d 652e 7361 6d70  k.DataFrame.samp
-0000f8e0: 6c65 0a20 2020 2020 2020 2022 2222 0a20  le.        """. 
-0000f8f0: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
-0000f900: 2e61 6c6c 636c 6f73 6528 7375 6d28 6672  .allclose(sum(fr
-0000f910: 6163 292c 2031 293a 0a20 2020 2020 2020  ac), 1):.       
-0000f920: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000f930: 4572 726f 7228 2266 7261 6320 7368 6f75  Error("frac shou
-0000f940: 6c64 2073 756d 2074 6f20 3122 290a 2020  ld sum to 1").  
-0000f950: 2020 2020 2020 6672 616d 6520 3d20 6578        frame = ex
-0000f960: 7072 2e53 706c 6974 2873 656c 662c 2066  pr.Split(self, f
-0000f970: 7261 632c 2072 616e 646f 6d5f 7374 6174  rac, random_stat
-0000f980: 652c 2073 6875 6666 6c65 290a 0a20 2020  e, shuffle)..   
-0000f990: 2020 2020 206f 7574 203d 205b 5d0a 2020       out = [].  
-0000f9a0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0000f9b0: 616e 6765 286c 656e 2866 7261 6329 293a  ange(len(frac)):
-0000f9c0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-0000f9d0: 2e61 7070 656e 6428 6e65 775f 636f 6c6c  .append(new_coll
-0000f9e0: 6563 7469 6f6e 2865 7870 722e 5370 6c69  ection(expr.Spli
-0000f9f0: 7454 616b 6528 6672 616d 652c 2069 2c20  tTake(frame, i, 
-0000fa00: 7365 6c66 2e6e 6469 6d29 2929 0a20 2020  self.ndim))).   
-0000fa10: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
-0000fa20: 0a20 2020 2064 6566 2069 736e 756c 6c28  .    def isnull(
-0000fa30: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0000fa40: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0000fa50: 7469 6f6e 2873 656c 662e 6578 7072 2e69  tion(self.expr.i
-0000fa60: 736e 756c 6c28 2929 0a0a 2020 2020 4064  snull())..    @d
-0000fa70: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0000fa80: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0000fa90: 6620 726f 756e 6428 7365 6c66 2c20 6465  f round(self, de
-0000faa0: 6369 6d61 6c73 3d30 293a 0a20 2020 2020  cimals=0):.     
-0000fab0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-0000fac0: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
-0000fad0: 7072 2e72 6f75 6e64 2864 6563 696d 616c  pr.round(decimal
-0000fae0: 7329 290a 0a20 2020 2040 6465 7269 7665  s))..    @derive
-0000faf0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-0000fb00: 616d 6529 0a20 2020 2064 6566 2077 6865  ame).    def whe
-0000fb10: 7265 2873 656c 662c 2063 6f6e 642c 206f  re(self, cond, o
-0000fb20: 7468 6572 3d6e 702e 6e61 6e29 3a0a 2020  ther=np.nan):.  
-0000fb30: 2020 2020 2020 636f 6e64 203d 2073 656c        cond = sel
-0000fb40: 662e 5f63 7265 6174 655f 616c 6967 6e61  f._create_aligna
-0000fb50: 626c 655f 6672 616d 6528 636f 6e64 290a  ble_frame(cond).
-0000fb60: 2020 2020 2020 2020 6f74 6865 7220 3d20          other = 
-0000fb70: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
-0000fb80: 676e 6162 6c65 5f66 7261 6d65 286f 7468  gnable_frame(oth
-0000fb90: 6572 290a 2020 2020 2020 2020 636f 6e64  er).        cond
-0000fba0: 203d 2063 6f6e 642e 6578 7072 2069 6620   = cond.expr if 
-0000fbb0: 6973 696e 7374 616e 6365 2863 6f6e 642c  isinstance(cond,
-0000fbc0: 2046 7261 6d65 4261 7365 2920 656c 7365   FrameBase) else
-0000fbd0: 2063 6f6e 640a 2020 2020 2020 2020 6f74   cond.        ot
-0000fbe0: 6865 7220 3d20 6f74 6865 722e 6578 7072  her = other.expr
-0000fbf0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-0000fc00: 7468 6572 2c20 4672 616d 6542 6173 6529  ther, FrameBase)
-0000fc10: 2065 6c73 6520 6f74 6865 720a 2020 2020   else other.    
-0000fc20: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0000fc30: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
-0000fc40: 7870 722e 7768 6572 6528 636f 6e64 2c20  xpr.where(cond, 
-0000fc50: 6f74 6865 7229 290a 0a20 2020 2040 6465  other))..    @de
-0000fc60: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0000fc70: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0000fc80: 206d 6173 6b28 7365 6c66 2c20 636f 6e64   mask(self, cond
-0000fc90: 2c20 6f74 6865 723d 6e70 2e6e 616e 293a  , other=np.nan):
-0000fca0: 0a20 2020 2020 2020 2063 6f6e 6420 3d20  .        cond = 
-0000fcb0: 7365 6c66 2e5f 6372 6561 7465 5f61 6c69  self._create_ali
-0000fcc0: 676e 6162 6c65 5f66 7261 6d65 2863 6f6e  gnable_frame(con
-0000fcd0: 6429 0a20 2020 2020 2020 206f 7468 6572  d).        other
-0000fce0: 203d 2073 656c 662e 5f63 7265 6174 655f   = self._create_
-0000fcf0: 616c 6967 6e61 626c 655f 6672 616d 6528  alignable_frame(
-0000fd00: 6f74 6865 7229 0a20 2020 2020 2020 2063  other).        c
-0000fd10: 6f6e 6420 3d20 636f 6e64 2e65 7870 7220  ond = cond.expr 
-0000fd20: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
-0000fd30: 6e64 2c20 4672 616d 6542 6173 6529 2065  nd, FrameBase) e
-0000fd40: 6c73 6520 636f 6e64 0a20 2020 2020 2020  lse cond.       
-0000fd50: 206f 7468 6572 203d 206f 7468 6572 2e65   other = other.e
-0000fd60: 7870 7220 6966 2069 7369 6e73 7461 6e63  xpr if isinstanc
-0000fd70: 6528 6f74 6865 722c 2046 7261 6d65 4261  e(other, FrameBa
-0000fd80: 7365 2920 656c 7365 206f 7468 6572 0a20  se) else other. 
-0000fd90: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0000fda0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
-0000fdb0: 662e 6578 7072 2e6d 6173 6b28 636f 6e64  f.expr.mask(cond
-0000fdc0: 2c20 6f74 6865 7229 290a 0a20 2020 2040  , other))..    @
-0000fdd0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0000fde0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0000fdf0: 6566 2072 6570 6c61 6365 2873 656c 662c  ef replace(self,
-0000fe00: 2074 6f5f 7265 706c 6163 653d 4e6f 6e65   to_replace=None
-0000fe10: 2c20 7661 6c75 653d 6e6f 5f64 6566 6175  , value=no_defau
-0000fe20: 6c74 2c20 7265 6765 783d 4661 6c73 6529  lt, regex=False)
-0000fe30: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000fe40: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0000fe50: 7365 6c66 2e65 7870 722e 7265 706c 6163  self.expr.replac
-0000fe60: 6528 746f 5f72 6570 6c61 6365 2c20 7661  e(to_replace, va
-0000fe70: 6c75 652c 2072 6567 6578 2929 0a0a 2020  lue, regex))..  
-0000fe80: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0000fe90: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0000fea0: 2020 6465 6620 6666 696c 6c28 7365 6c66    def ffill(self
-0000feb0: 2c20 6178 6973 3d30 2c20 6c69 6d69 743d  , axis=0, limit=
-0000fec0: 4e6f 6e65 293a 0a20 2020 2020 2020 2061  None):.        a
-0000fed0: 7869 7320 3d20 5f76 616c 6964 6174 655f  xis = _validate_
-0000fee0: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-0000fef0: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-0000ff00: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000ff10: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-0000ff20: 7469 7469 6f6e 7328 4d2e 6666 696c 6c2c  titions(M.ffill,
-0000ff30: 2061 7869 733d 6178 6973 2c20 6c69 6d69   axis=axis, limi
-0000ff40: 743d 6c69 6d69 7429 0a20 2020 2020 2020  t=limit).       
-0000ff50: 2066 7261 6d65 203d 2073 656c 660a 2020   frame = self.  
-0000ff60: 2020 2020 2020 6966 206c 696d 6974 2069        if limit i
-0000ff70: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000ff80: 2020 2020 6672 616d 6520 3d20 4669 6c6c      frame = Fill
-0000ff90: 6e61 4368 6563 6b28 7365 6c66 2c20 2266  naCheck(self, "f
-0000ffa0: 6669 6c6c 222c 206c 616d 6264 6120 783a  fill", lambda x:
-0000ffb0: 2030 290a 2020 2020 2020 2020 7265 7475   0).        retu
-0000ffc0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0000ffd0: 6e28 4646 696c 6c28 6672 616d 652c 206c  n(FFill(frame, l
-0000ffe0: 696d 6974 2929 0a0a 2020 2020 4064 6572  imit))..    @der
-0000fff0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00010000: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00010010: 6266 696c 6c28 7365 6c66 2c20 6178 6973  bfill(self, axis
-00010020: 3d30 2c20 6c69 6d69 743d 4e6f 6e65 293a  =0, limit=None):
-00010030: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-00010040: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-00010050: 7869 7329 0a20 2020 2020 2020 2069 6620  xis).        if 
-00010060: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-00010070: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00010080: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00010090: 7328 4d2e 6266 696c 6c2c 2061 7869 733d  s(M.bfill, axis=
-000100a0: 6178 6973 2c20 6c69 6d69 743d 6c69 6d69  axis, limit=limi
-000100b0: 7429 0a20 2020 2020 2020 2066 7261 6d65  t).        frame
-000100c0: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
-000100d0: 6966 206c 696d 6974 2069 7320 4e6f 6e65  if limit is None
-000100e0: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
-000100f0: 616d 6520 3d20 4669 6c6c 6e61 4368 6563  ame = FillnaChec
-00010100: 6b28 7365 6c66 2c20 2262 6669 6c6c 222c  k(self, "bfill",
-00010110: 206c 616d 6264 6120 783a 2078 2e6e 7061   lambda x: x.npa
-00010120: 7274 6974 696f 6e73 202d 2031 290a 2020  rtitions - 1).  
-00010130: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00010140: 5f63 6f6c 6c65 6374 696f 6e28 4246 696c  _collection(BFil
-00010150: 6c28 6672 616d 652c 206c 696d 6974 2929  l(frame, limit))
-00010160: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00010170: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00010180: 290a 2020 2020 6465 6620 6669 6c6c 6e61  ).    def fillna
-00010190: 2873 656c 662c 2076 616c 7565 3d4e 6f6e  (self, value=Non
-000101a0: 652c 2061 7869 733d 4e6f 6e65 293a 0a20  e, axis=None):. 
-000101b0: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
-000101c0: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
-000101d0: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
-000101e0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
-000101f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00010200: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00010210: 696f 6e73 284d 2e66 696c 6c6e 612c 2076  ions(M.fillna, v
-00010220: 616c 7565 2c20 6178 6973 3d61 7869 7329  alue, axis=axis)
-00010230: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00010240: 7374 616e 6365 2876 616c 7565 2c20 4672  stance(value, Fr
-00010250: 616d 6542 6173 6529 3a0a 2020 2020 2020  ameBase):.      
-00010260: 2020 2020 2020 7661 6c75 6520 3d20 7661        value = va
-00010270: 6c75 652e 6578 7072 0a20 2020 2020 2020  lue.expr.       
-00010280: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00010290: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
-000102a0: 2e66 696c 6c6e 6128 7661 6c75 6529 290a  .fillna(value)).
-000102b0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000102c0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-000102d0: 0a20 2020 2064 6566 2073 6869 6674 2873  .    def shift(s
-000102e0: 656c 662c 2070 6572 696f 6473 3d31 2c20  elf, periods=1, 
-000102f0: 6672 6571 3d4e 6f6e 652c 2061 7869 733d  freq=None, axis=
-00010300: 3029 3a0a 2020 2020 2020 2020 6966 206e  0):.        if n
-00010310: 6f74 2069 7369 6e73 7461 6e63 6528 7065  ot isinstance(pe
-00010320: 7269 6f64 732c 2049 6e74 6567 7261 6c29  riods, Integral)
-00010330: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00010340: 6973 6520 5479 7065 4572 726f 7228 2270  ise TypeError("p
-00010350: 6572 696f 6473 206d 7573 7420 6265 2061  eriods must be a
-00010360: 6e20 696e 7465 6765 7222 290a 0a20 2020  n integer")..   
-00010370: 2020 2020 2061 7869 7320 3d20 5f76 616c       axis = _val
-00010380: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-00010390: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-000103a0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-000103b0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-000103c0: 6c6c 6563 7469 6f6e 2853 6869 6674 2873  llection(Shift(s
-000103d0: 656c 662c 2070 6572 696f 6473 2c20 6672  elf, periods, fr
-000103e0: 6571 2929 0a0a 2020 2020 2020 2020 7265  eq))..        re
-000103f0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-00010400: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00010410: 2020 2020 2020 6675 6e63 3d53 6869 6674        func=Shift
-00010420: 2e66 756e 632c 0a20 2020 2020 2020 2020  .func,.         
-00010430: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-00010440: 6174 613d 4661 6c73 652c 0a20 2020 2020  ata=False,.     
-00010450: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-00010460: 5f64 6976 6973 696f 6e73 3d46 616c 7365  _divisions=False
-00010470: 2c0a 2020 2020 2020 2020 2020 2020 7065  ,.            pe
-00010480: 7269 6f64 733d 7065 7269 6f64 732c 0a20  riods=periods,. 
-00010490: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-000104a0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-000104b0: 2020 6672 6571 3d66 7265 712c 0a20 2020    freq=freq,.   
-000104c0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-000104d0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-000104e0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-000104f0: 6469 6666 2873 656c 662c 2070 6572 696f  diff(self, perio
-00010500: 6473 3d31 2c20 6178 6973 3d30 293a 0a20  ds=1, axis=0):. 
-00010510: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00010520: 2020 202e 2e20 6e6f 7465 3a3a 0a0a 2020     .. note::..  
-00010530: 2020 2020 2020 2020 2050 616e 6461 7320           Pandas 
-00010540: 6375 7272 656e 746c 7920 7573 6573 2061  currently uses a
-00010550: 6e20 6060 6f62 6a65 6374 6060 2d64 7479  n ``object``-dty
-00010560: 7065 2063 6f6c 756d 6e20 746f 2072 6570  pe column to rep
-00010570: 7265 7365 6e74 0a20 2020 2020 2020 2020  resent.         
-00010580: 2020 626f 6f6c 6561 6e20 6461 7461 2077    boolean data w
-00010590: 6974 6820 6d69 7373 696e 6720 7661 6c75  ith missing valu
-000105a0: 6573 2e20 5468 6973 2063 616e 2063 6175  es. This can cau
-000105b0: 7365 2069 7373 7565 7320 666f 720a 2020  se issues for.  
-000105c0: 2020 2020 2020 2020 2062 6f6f 6c65 616e           boolean
-000105d0: 2d73 7065 6369 6669 6320 6f70 6572 6174  -specific operat
-000105e0: 696f 6e73 2c20 6c69 6b65 2060 607c 6060  ions, like ``|``
-000105f0: 2e20 546f 2065 6e61 626c 6520 626f 6f6c  . To enable bool
-00010600: 6561 6e2d 0a20 2020 2020 2020 2020 2020  ean-.           
-00010610: 7370 6563 6966 6963 206f 7065 7261 7469  specific operati
-00010620: 6f6e 732c 2061 7420 7468 6520 636f 7374  ons, at the cost
-00010630: 206f 6620 6d65 7461 6461 7461 2074 6861   of metadata tha
-00010640: 7420 646f 6573 6e27 7420 6d61 7463 680a  t doesn't match.
-00010650: 2020 2020 2020 2020 2020 2070 616e 6461             panda
-00010660: 732c 2075 7365 2060 602e 6173 7479 7065  s, use ``.astype
-00010670: 2862 6f6f 6c29 6060 2061 6674 6572 2074  (bool)`` after t
-00010680: 6865 2060 6073 6869 6674 6060 2e0a 2020  he ``shift``..  
-00010690: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000106a0: 2020 6178 6973 203d 205f 7661 6c69 6461    axis = _valida
-000106b0: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
-000106c0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-000106d0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-000106e0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-000106f0: 6374 696f 6e28 4469 6666 2873 656c 662c  ction(Diff(self,
-00010700: 2070 6572 696f 6473 2929 0a20 2020 2020   periods)).     
-00010710: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00010720: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00010730: 2020 2020 2020 2020 2020 2066 756e 633d             func=
-00010740: 4469 6666 2e66 756e 632c 0a20 2020 2020  Diff.func,.     
-00010750: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
-00010760: 6574 6164 6174 613d 4661 6c73 652c 0a20  etadata=False,. 
-00010770: 2020 2020 2020 2020 2020 2074 7261 6e73             trans
-00010780: 666f 726d 5f64 6976 6973 696f 6e73 3d46  form_divisions=F
-00010790: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-000107a0: 2020 636c 6561 725f 6469 7669 7369 6f6e    clear_division
-000107b0: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
-000107c0: 2020 2020 2070 6572 696f 6473 3d70 6572       periods=per
-000107d0: 696f 6473 2c0a 2020 2020 2020 2020 2020  iods,.          
-000107e0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-000107f0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-00010800: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00010810: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00010820: 7265 6e61 6d65 5f61 7869 7328 0a20 2020  rename_axis(.   
-00010830: 2020 2020 2073 656c 662c 206d 6170 7065       self, mappe
-00010840: 723d 6e6f 5f64 6566 6175 6c74 2c20 696e  r=no_default, in
-00010850: 6465 783d 6e6f 5f64 6566 6175 6c74 2c20  dex=no_default, 
-00010860: 636f 6c75 6d6e 733d 6e6f 5f64 6566 6175  columns=no_defau
-00010870: 6c74 2c20 6178 6973 3d30 0a20 2020 2029  lt, axis=0.    )
-00010880: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00010890: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-000108a0: 7365 6c66 2e65 7870 722e 7265 6e61 6d65  self.expr.rename
-000108b0: 5f61 7869 7328 6d61 7070 6572 2c20 696e  _axis(mapper, in
-000108c0: 6465 782c 2063 6f6c 756d 6e73 2c20 6178  dex, columns, ax
-000108d0: 6973 2929 0a0a 2020 2020 6465 6620 5f63  is))..    def _c
-000108e0: 7265 6174 655f 616c 6967 6e61 626c 655f  reate_alignable_
-000108f0: 6672 616d 6528 7365 6c66 2c20 6f74 6865  frame(self, othe
-00010900: 722c 206a 6f69 6e3d 226f 7574 6572 2229  r, join="outer")
-00010910: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-00010920: 2069 735f 6461 736b 5f63 6f6c 6c65 6374   is_dask_collect
-00010930: 696f 6e28 6f74 6865 7229 2061 6e64 2028  ion(other) and (
-00010940: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-00010950: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
-00010960: 7229 206f 7220 6973 5f64 6174 6166 7261  r) or is_datafra
-00010970: 6d65 5f6c 696b 6528 6f74 6865 7229 0a20  me_like(other). 
-00010980: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00010990: 2020 2020 2020 6966 206a 6f69 6e20 696e        if join in
-000109a0: 2028 2269 6e6e 6572 222c 2022 6c65 6674   ("inner", "left
-000109b0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-000109c0: 2020 2020 6e70 6172 7469 7469 6f6e 7320      npartitions 
-000109d0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-000109e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000109f0: 2020 2020 2020 2320 5765 2068 6176 6520        # We have 
-00010a00: 746f 2074 7269 6767 6572 2061 6c69 676e  to trigger align
-00010a10: 6d65 6e74 2c20 6f74 6865 7277 6973 6520  ment, otherwise 
-00010a20: 7061 6e64 6173 2077 696c 6c20 6164 640a  pandas will add.
-00010a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a40: 2320 7468 6520 7361 6d65 2076 616c 7565  # the same value
-00010a50: 7320 746f 2065 7665 7279 2070 6172 7469  s to every parti
-00010a60: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00010a70: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-00010a80: 203d 2032 0a20 2020 2020 2020 2020 2020   = 2.           
-00010a90: 206f 7468 6572 203d 2066 726f 6d5f 7061   other = from_pa
-00010aa0: 6e64 6173 286f 7468 6572 2c20 6e70 6172  ndas(other, npar
-00010ab0: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
-00010ac0: 6f6e 7329 0a20 2020 2020 2020 2072 6574  ons).        ret
-00010ad0: 7572 6e20 6f74 6865 720a 0a20 2020 2040  urn other..    @
-00010ae0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00010af0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00010b00: 6566 2061 6c69 676e 2873 656c 662c 206f  ef align(self, o
-00010b10: 7468 6572 2c20 6a6f 696e 3d22 6f75 7465  ther, join="oute
-00010b20: 7222 2c20 6178 6973 3d4e 6f6e 652c 2066  r", axis=None, f
-00010b30: 696c 6c5f 7661 6c75 653d 4e6f 6e65 293a  ill_value=None):
-00010b40: 0a20 2020 2020 2020 206f 7468 6572 203d  .        other =
-00010b50: 2073 656c 662e 5f63 7265 6174 655f 616c   self._create_al
-00010b60: 6967 6e61 626c 655f 6672 616d 6528 6f74  ignable_frame(ot
-00010b70: 6865 722c 206a 6f69 6e29 0a20 2020 2020  her, join).     
-00010b80: 2020 2072 6574 7572 6e20 7365 6c66 2e65     return self.e
-00010b90: 7870 722e 616c 6967 6e28 6f74 6865 722e  xpr.align(other.
-00010ba0: 6578 7072 2c20 6a6f 696e 2c20 6178 6973  expr, join, axis
-00010bb0: 2c20 6669 6c6c 5f76 616c 7565 290a 0a20  , fill_value).. 
-00010bc0: 2020 2064 6566 206e 756e 6971 7565 5f61     def nunique_a
-00010bd0: 7070 726f 7828 7365 6c66 2c20 7370 6c69  pprox(self, spli
-00010be0: 745f 6576 6572 793d 4e6f 6e65 293a 0a20  t_every=None):. 
-00010bf0: 2020 2020 2020 2022 2222 4170 7072 6f78         """Approx
-00010c00: 696d 6174 6520 6e75 6d62 6572 206f 6620  imate number of 
-00010c10: 756e 6971 7565 2072 6f77 732e 0a0a 2020  unique rows...  
-00010c20: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-00010c30: 6420 7573 6573 2074 6865 2048 7970 6572  d uses the Hyper
-00010c40: 4c6f 674c 6f67 2061 6c67 6f72 6974 686d  LogLog algorithm
-00010c50: 2066 6f72 2063 6172 6469 6e61 6c69 7479   for cardinality
-00010c60: 0a20 2020 2020 2020 2065 7374 696d 6174  .        estimat
-00010c70: 696f 6e20 746f 2063 6f6d 7075 7465 2074  ion to compute t
-00010c80: 6865 2061 7070 726f 7869 6d61 7465 206e  he approximate n
-00010c90: 756d 6265 7220 6f66 2075 6e69 7175 6520  umber of unique 
-00010ca0: 726f 7773 2e0a 2020 2020 2020 2020 5468  rows..        Th
-00010cb0: 6520 6170 7072 6f78 696d 6174 6520 6572  e approximate er
-00010cc0: 726f 7220 6973 2030 2e34 3036 252e 0a0a  ror is 0.406%...
-00010cd0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00010ce0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00010cf0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7370  -----.        sp
-00010d00: 6c69 745f 6576 6572 7920 3a20 696e 742c  lit_every : int,
-00010d10: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00010d20: 2020 2020 2020 4772 6f75 7020 7061 7274        Group part
-00010d30: 6974 696f 6e73 2069 6e74 6f20 6772 6f75  itions into grou
-00010d40: 7073 206f 6620 7468 6973 2073 697a 6520  ps of this size 
-00010d50: 7768 696c 6520 7065 7266 6f72 6d69 6e67  while performing
-00010d60: 2061 0a20 2020 2020 2020 2020 2020 2074   a.            t
-00010d70: 7265 652d 7265 6475 6374 696f 6e2e 2049  ree-reduction. I
-00010d80: 6620 7365 7420 746f 2046 616c 7365 2c20  f set to False, 
-00010d90: 6e6f 2074 7265 652d 7265 6475 6374 696f  no tree-reductio
-00010da0: 6e20 7769 6c6c 2062 6520 7573 6564 2e0a  n will be used..
-00010db0: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00010dc0: 756c 7420 6973 2038 2e0a 0a20 2020 2020  ult is 8...     
-00010dd0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00010de0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00010df0: 2020 2061 2066 6c6f 6174 2072 6570 7265     a float repre
-00010e00: 7365 6e74 696e 6720 7468 6520 6170 7072  senting the appr
-00010e10: 6f78 696d 6174 6520 6e75 6d62 6572 206f  oximate number o
-00010e20: 6620 656c 656d 656e 7473 0a20 2020 2020  f elements.     
-00010e30: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00010e40: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00010e50: 7469 6f6e 2873 656c 662e 6578 7072 2e6e  tion(self.expr.n
-00010e60: 756e 6971 7565 5f61 7070 726f 7828 7370  unique_approx(sp
-00010e70: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00010e80: 6576 6572 7929 290a 0a20 2020 2040 6465  every))..    @de
-00010e90: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00010ea0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00010eb0: 2063 756d 7375 6d28 7365 6c66 2c20 6178   cumsum(self, ax
-00010ec0: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
-00010ed0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
-00010ee0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-00010ef0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00010f00: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00010f10: 7061 7274 6974 696f 6e73 284d 2e63 756d  partitions(M.cum
-00010f20: 7375 6d2c 2061 7869 733d 6178 6973 2c20  sum, axis=axis, 
-00010f30: 736b 6970 6e61 3d73 6b69 706e 6129 0a20  skipna=skipna). 
-00010f40: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00010f50: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
-00010f60: 662e 6578 7072 2e63 756d 7375 6d28 736b  f.expr.cumsum(sk
-00010f70: 6970 6e61 3d73 6b69 706e 6129 290a 0a20  ipna=skipna)).. 
-00010f80: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00010f90: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00010fa0: 2020 2064 6566 2063 756d 7072 6f64 2873     def cumprod(s
-00010fb0: 656c 662c 2061 7869 733d 302c 2073 6b69  elf, axis=0, ski
-00010fc0: 706e 613d 5472 7565 2c20 2a2a 6b77 6172  pna=True, **kwar
-00010fd0: 6773 293a 0a20 2020 2020 2020 2069 6620  gs):.        if 
-00010fe0: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-00010ff0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00011000: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00011010: 7328 4d2e 6375 6d70 726f 642c 2061 7869  s(M.cumprod, axi
-00011020: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
-00011030: 6b69 706e 6129 0a20 2020 2020 2020 2072  kipna).        r
-00011040: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00011050: 7469 6f6e 2873 656c 662e 6578 7072 2e63  tion(self.expr.c
-00011060: 756d 7072 6f64 2873 6b69 706e 613d 736b  umprod(skipna=sk
-00011070: 6970 6e61 2929 0a0a 2020 2020 4064 6572  ipna))..    @der
-00011080: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00011090: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-000110a0: 6375 6d6d 6178 2873 656c 662c 2061 7869  cummax(self, axi
-000110b0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
-000110c0: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
-000110d0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-000110e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000110f0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00011100: 4d2e 6375 6d6d 6178 2c20 6178 6973 3d61  M.cummax, axis=a
-00011110: 7869 732c 2073 6b69 706e 613d 736b 6970  xis, skipna=skip
-00011120: 6e61 290a 2020 2020 2020 2020 7265 7475  na).        retu
-00011130: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00011140: 6e28 7365 6c66 2e65 7870 722e 6375 6d6d  n(self.expr.cumm
-00011150: 6178 2873 6b69 706e 613d 736b 6970 6e61  ax(skipna=skipna
-00011160: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
-00011170: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00011180: 6d65 290a 2020 2020 6465 6620 6375 6d6d  me).    def cumm
-00011190: 696e 2873 656c 662c 2061 7869 733d 302c  in(self, axis=0,
-000111a0: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
-000111b0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-000111c0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-000111d0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-000111e0: 5f70 6172 7469 7469 6f6e 7328 4d2e 6375  _partitions(M.cu
-000111f0: 6d6d 696e 2c20 6178 6973 3d61 7869 732c  mmin, axis=axis,
-00011200: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
-00011210: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00011220: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
-00011230: 6c66 2e65 7870 722e 6375 6d6d 696e 2873  lf.expr.cummin(s
-00011240: 6b69 706e 613d 736b 6970 6e61 2929 0a0a  kipna=skipna))..
-00011250: 2020 2020 6465 6620 7265 6475 6374 696f      def reductio
-00011260: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
-00011270: 0a20 2020 2020 2020 2063 6875 6e6b 2c0a  .        chunk,.
-00011280: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-00011290: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-000112a0: 636f 6d62 696e 653d 4e6f 6e65 2c0a 2020  combine=None,.  
-000112b0: 2020 2020 2020 6d65 7461 3d6e 6f5f 6465        meta=no_de
-000112c0: 6661 756c 742c 0a20 2020 2020 2020 2074  fault,.        t
-000112d0: 6f6b 656e 3d4e 6f6e 652c 0a20 2020 2020  oken=None,.     
-000112e0: 2020 2073 706c 6974 5f65 7665 7279 3d4e     split_every=N
-000112f0: 6f6e 652c 0a20 2020 2020 2020 2063 6875  one,.        chu
-00011300: 6e6b 5f6b 7761 7267 733d 4e6f 6e65 2c0a  nk_kwargs=None,.
-00011310: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-00011320: 655f 6b77 6172 6773 3d4e 6f6e 652c 0a20  e_kwargs=None,. 
-00011330: 2020 2020 2020 2063 6f6d 6269 6e65 5f6b         combine_k
-00011340: 7761 7267 733d 4e6f 6e65 2c0a 2020 2020  wargs=None,.    
-00011350: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-00011360: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00011370: 4765 6e65 7269 6320 726f 772d 7769 7365  Generic row-wise
-00011380: 2072 6564 7563 7469 6f6e 732e 0a0a 2020   reductions...  
-00011390: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000113a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000113b0: 2d2d 2d0a 2020 2020 2020 2020 6368 756e  ---.        chun
-000113c0: 6b20 3a20 6361 6c6c 6162 6c65 0a20 2020  k : callable.   
-000113d0: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
-000113e0: 6e20 746f 206f 7065 7261 7465 206f 6e20  n to operate on 
-000113f0: 6561 6368 2070 6172 7469 7469 6f6e 2e20  each partition. 
-00011400: 5368 6f75 6c64 2072 6574 7572 6e20 610a  Should return a.
-00011410: 2020 2020 2020 2020 2020 2020 6060 7061              ``pa
-00011420: 6e64 6173 2e44 6174 6146 7261 6d65 6060  ndas.DataFrame``
-00011430: 2c20 6060 7061 6e64 6173 2e53 6572 6965  , ``pandas.Serie
-00011440: 7360 602c 206f 7220 6120 7363 616c 6172  s``, or a scalar
-00011450: 2e0a 2020 2020 2020 2020 6167 6772 6567  ..        aggreg
-00011460: 6174 6520 3a20 6361 6c6c 6162 6c65 2c20  ate : callable, 
-00011470: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00011480: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
-00011490: 206f 7065 7261 7465 206f 6e20 7468 6520   operate on the 
-000114a0: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
-000114b0: 756c 7420 6f66 2060 6063 6875 6e6b 6060  ult of ``chunk``
-000114c0: 2e20 4966 206e 6f74 0a20 2020 2020 2020  . If not.       
-000114d0: 2020 2020 2073 7065 6369 6669 6564 2c20       specified, 
-000114e0: 6465 6661 756c 7473 2074 6f20 6060 6368  defaults to ``ch
-000114f0: 756e 6b60 602e 2055 7365 6420 746f 2064  unk``. Used to d
-00011500: 6f20 7468 6520 6669 6e61 6c20 6167 6772  o the final aggr
-00011510: 6567 6174 696f 6e0a 2020 2020 2020 2020  egation.        
-00011520: 2020 2020 696e 2061 2074 7265 6520 7265      in a tree re
-00011530: 6475 6374 696f 6e2e 0a0a 2020 2020 2020  duction...      
-00011540: 2020 2020 2020 5468 6520 696e 7075 7420        The input 
-00011550: 746f 2060 6061 6767 7265 6761 7465 6060  to ``aggregate``
-00011560: 2064 6570 656e 6473 206f 6e20 7468 6520   depends on the 
-00011570: 6f75 7470 7574 206f 6620 6060 6368 756e  output of ``chun
-00011580: 6b60 602e 0a20 2020 2020 2020 2020 2020  k``..           
-00011590: 2049 6620 7468 6520 6f75 7470 7574 206f   If the output o
-000115a0: 6620 6060 6368 756e 6b60 6020 6973 2061  f ``chunk`` is a
-000115b0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-000115c0: 2073 6361 6c61 723a 2049 6e70 7574 2069   scalar: Input i
-000115d0: 7320 6120 5365 7269 6573 2c20 7769 7468  s a Series, with
-000115e0: 206f 6e65 2072 6f77 2070 6572 2070 6172   one row per par
-000115f0: 7469 7469 6f6e 2e0a 2020 2020 2020 2020  tition..        
-00011600: 2020 2020 2d20 5365 7269 6573 3a20 496e      - Series: In
-00011610: 7075 7420 6973 2061 2044 6174 6146 7261  put is a DataFra
-00011620: 6d65 2c20 7769 7468 206f 6e65 2072 6f77  me, with one row
-00011630: 2070 6572 2070 6172 7469 7469 6f6e 2e20   per partition. 
-00011640: 436f 6c75 6d6e 730a 2020 2020 2020 2020  Columns.        
-00011650: 2020 2020 2020 6172 6520 7468 6520 726f        are the ro
-00011660: 7773 2069 6e20 7468 6520 6f75 7470 7574  ws in the output
-00011670: 2073 6572 6965 732e 0a20 2020 2020 2020   series..       
-00011680: 2020 2020 202d 2044 6174 6146 7261 6d65       - DataFrame
-00011690: 3a20 496e 7075 7420 6973 2061 2044 6174  : Input is a Dat
-000116a0: 6146 7261 6d65 2c20 7769 7468 206f 6e65  aFrame, with one
-000116b0: 2072 6f77 2070 6572 2070 6172 7469 7469   row per partiti
-000116c0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-000116d0: 2020 436f 6c75 6d6e 7320 6172 6520 7468    Columns are th
-000116e0: 6520 636f 6c75 6d6e 7320 696e 2074 6865  e columns in the
-000116f0: 206f 7574 7075 7420 6461 7461 6672 616d   output datafram
-00011700: 6573 2e0a 0a20 2020 2020 2020 2020 2020  es...           
-00011710: 2053 686f 756c 6420 7265 7475 726e 2061   Should return a
-00011720: 2060 6070 616e 6461 732e 4461 7461 4672   ``pandas.DataFr
-00011730: 616d 6560 602c 2060 6070 616e 6461 732e  ame``, ``pandas.
-00011740: 5365 7269 6573 6060 2c20 6f72 2061 0a20  Series``, or a. 
-00011750: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
-00011760: 722e 0a20 2020 2020 2020 2063 6f6d 6269  r..        combi
-00011770: 6e65 203a 2063 616c 6c61 626c 652c 206f  ne : callable, o
-00011780: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00011790: 2020 2020 4675 6e63 7469 6f6e 2074 6f20      Function to 
-000117a0: 6f70 6572 6174 6520 6f6e 2069 6e74 6572  operate on inter
-000117b0: 6d65 6469 6174 6520 636f 6e63 6174 656e  mediate concaten
-000117c0: 6174 6564 2072 6573 756c 7473 206f 660a  ated results of.
-000117d0: 2020 2020 2020 2020 2020 2020 6060 6368              ``ch
-000117e0: 756e 6b60 6020 696e 2061 2074 7265 652d  unk`` in a tree-
-000117f0: 7265 6475 6374 696f 6e2e 2049 6620 6e6f  reduction. If no
-00011800: 7420 7072 6f76 6964 6564 2c20 6465 6661  t provided, defa
-00011810: 756c 7473 2074 6f0a 2020 2020 2020 2020  ults to.        
-00011820: 2020 2020 6060 6167 6772 6567 6174 6560      ``aggregate`
-00011830: 602e 2054 6865 2069 6e70 7574 2f6f 7574  `. The input/out
-00011840: 7075 7420 7265 7175 6972 656d 656e 7473  put requirements
-00011850: 2073 686f 756c 6420 6d61 7463 6820 7468   should match th
-00011860: 6174 206f 660a 2020 2020 2020 2020 2020  at of.          
-00011870: 2020 6060 6167 6772 6567 6174 6560 6020    ``aggregate`` 
-00011880: 6465 7363 7269 6265 6420 6162 6f76 652e  described above.
-00011890: 0a20 2020 2020 2020 2024 4d45 5441 0a20  .        $META. 
-000118a0: 2020 2020 2020 2074 6f6b 656e 203a 2073         token : s
-000118b0: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
-000118c0: 2020 2020 2020 2020 2054 6865 206e 616d           The nam
-000118d0: 6520 746f 2075 7365 2066 6f72 2074 6865  e to use for the
-000118e0: 206f 7574 7075 7420 6b65 7973 2e0a 2020   output keys..  
-000118f0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00011900: 7920 3a20 696e 742c 206f 7074 696f 6e61  y : int, optiona
-00011910: 6c0a 2020 2020 2020 2020 2020 2020 4772  l.            Gr
-00011920: 6f75 7020 7061 7274 6974 696f 6e73 2069  oup partitions i
-00011930: 6e74 6f20 6772 6f75 7073 206f 6620 7468  nto groups of th
-00011940: 6973 2073 697a 6520 7768 696c 6520 7065  is size while pe
-00011950: 7266 6f72 6d69 6e67 2061 0a20 2020 2020  rforming a.     
-00011960: 2020 2020 2020 2074 7265 652d 7265 6475         tree-redu
-00011970: 6374 696f 6e2e 2049 6620 7365 7420 746f  ction. If set to
-00011980: 2046 616c 7365 2c20 6e6f 2074 7265 652d   False, no tree-
-00011990: 7265 6475 6374 696f 6e20 7769 6c6c 2062  reduction will b
-000119a0: 6520 7573 6564 2c0a 2020 2020 2020 2020  e used,.        
-000119b0: 2020 2020 616e 6420 616c 6c20 696e 7465      and all inte
-000119c0: 726d 6564 6961 7465 7320 7769 6c6c 2062  rmediates will b
-000119d0: 6520 636f 6e63 6174 656e 6174 6564 2061  e concatenated a
-000119e0: 6e64 2070 6173 7365 6420 746f 0a20 2020  nd passed to.   
-000119f0: 2020 2020 2020 2020 2060 6061 6767 7265           ``aggre
-00011a00: 6761 7465 6060 2e20 4465 6661 756c 7420  gate``. Default 
-00011a10: 6973 2038 2e0a 2020 2020 2020 2020 6368  is 8..        ch
-00011a20: 756e 6b5f 6b77 6172 6773 203a 2064 6963  unk_kwargs : dic
-00011a30: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00011a40: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
-00011a50: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
-00011a60: 7320 6f6e 2074 6f20 6060 6368 756e 6b60  s on to ``chunk`
-00011a70: 6020 6f6e 6c79 2e0a 2020 2020 2020 2020  ` only..        
-00011a80: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-00011a90: 203a 2064 6963 742c 206f 7074 696f 6e61   : dict, optiona
-00011aa0: 6c0a 2020 2020 2020 2020 2020 2020 4b65  l.            Ke
-00011ab0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00011ac0: 746f 2070 6173 7320 6f6e 2074 6f20 6060  to pass on to ``
-00011ad0: 6167 6772 6567 6174 6560 6020 6f6e 6c79  aggregate`` only
-00011ae0: 2e0a 2020 2020 2020 2020 636f 6d62 696e  ..        combin
-00011af0: 655f 6b77 6172 6773 203a 2064 6963 742c  e_kwargs : dict,
-00011b00: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00011b10: 2020 2020 2020 4b65 7977 6f72 6420 6172        Keyword ar
-00011b20: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
-00011b30: 6f6e 2074 6f20 6060 636f 6d62 696e 6560  on to ``combine`
-00011b40: 6020 6f6e 6c79 2e0a 2020 2020 2020 2020  ` only..        
-00011b50: 6b77 6172 6773 203a 0a20 2020 2020 2020  kwargs :.       
-00011b60: 2020 2020 2041 6c6c 2072 656d 6169 6e69       All remaini
-00011b70: 6e67 206b 6579 776f 7264 7320 7769 6c6c  ng keywords will
-00011b80: 2062 6520 7061 7373 6564 2074 6f20 6060   be passed to ``
-00011b90: 6368 756e 6b60 602c 2060 6063 6f6d 6269  chunk``, ``combi
-00011ba0: 6e65 6060 2c0a 2020 2020 2020 2020 2020  ne``,.          
-00011bb0: 2020 616e 6420 6060 6167 6772 6567 6174    and ``aggregat
-00011bc0: 6560 602e 0a0a 2020 2020 2020 2020 4578  e``...        Ex
-00011bd0: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-00011be0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011bf0: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
-00011c00: 7320 6173 2070 640a 2020 2020 2020 2020  s as pd.        
-00011c10: 3e3e 3e20 696d 706f 7274 2064 6173 6b2e  >>> import dask.
-00011c20: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
-00011c30: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
-00011c40: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
-00011c50: 7827 3a20 7261 6e67 6528 3530 292c 2027  x': range(50), '
-00011c60: 7927 3a20 7261 6e67 6528 3530 2c20 3130  y': range(50, 10
-00011c70: 3029 7d29 0a20 2020 2020 2020 203e 3e3e  0)}).        >>>
-00011c80: 2064 6466 203d 2064 642e 6672 6f6d 5f70   ddf = dd.from_p
-00011c90: 616e 6461 7328 6466 2c20 6e70 6172 7469  andas(df, nparti
-00011ca0: 7469 6f6e 733d 3429 0a0a 2020 2020 2020  tions=4)..      
-00011cb0: 2020 436f 756e 7420 7468 6520 6e75 6d62    Count the numb
-00011cc0: 6572 206f 6620 726f 7773 2069 6e20 6120  er of rows in a 
-00011cd0: 4461 7461 4672 616d 652e 2054 6f20 646f  DataFrame. To do
-00011ce0: 2074 6869 732c 2063 6f75 6e74 2074 6865   this, count the
-00011cf0: 206e 756d 6265 720a 2020 2020 2020 2020   number.        
-00011d00: 6f66 2072 6f77 7320 696e 2065 6163 6820  of rows in each 
-00011d10: 7061 7274 6974 696f 6e2c 2074 6865 6e20  partition, then 
-00011d20: 7375 6d20 7468 6520 7265 7375 6c74 733a  sum the results:
-00011d30: 0a0a 2020 2020 2020 2020 3e3e 3e20 7265  ..        >>> re
-00011d40: 7320 3d20 6464 662e 7265 6475 6374 696f  s = ddf.reductio
-00011d50: 6e28 6c61 6d62 6461 2078 3a20 782e 636f  n(lambda x: x.co
-00011d60: 756e 7428 292c 0a20 2020 2020 2020 202e  unt(),.        .
-00011d70: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-00011d80: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-00011d90: 3d6c 616d 6264 6120 783a 2078 2e73 756d  =lambda x: x.sum
-00011da0: 2829 290a 2020 2020 2020 2020 3e3e 3e20  ()).        >>> 
-00011db0: 7265 732e 636f 6d70 7574 6528 290a 2020  res.compute().  
-00011dc0: 2020 2020 2020 7820 2020 2035 300a 2020        x    50.  
-00011dd0: 2020 2020 2020 7920 2020 2035 300a 2020        y    50.  
-00011de0: 2020 2020 2020 6474 7970 653a 2069 6e74        dtype: int
-00011df0: 3634 0a0a 2020 2020 2020 2020 436f 756e  64..        Coun
-00011e00: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
-00011e10: 726f 7773 2069 6e20 6120 5365 7269 6573  rows in a Series
-00011e20: 2077 6974 6820 656c 656d 656e 7473 2067   with elements g
-00011e30: 7265 6174 6572 2074 6861 6e20 6f72 0a20  reater than or. 
-00011e40: 2020 2020 2020 2065 7175 616c 2074 6f20         equal to 
-00011e50: 6120 7661 6c75 6520 2870 726f 7669 6465  a value (provide
-00011e60: 6420 7669 6120 6120 6b65 7977 6f72 6429  d via a keyword)
-00011e70: 2e0a 0a20 2020 2020 2020 203e 3e3e 2064  ...        >>> d
-00011e80: 6566 2063 6f75 6e74 5f67 7265 6174 6572  ef count_greater
-00011e90: 2878 2c20 7661 6c75 653d 3029 3a0a 2020  (x, value=0):.  
-00011ea0: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
-00011eb0: 7475 726e 2028 7820 3e3d 2076 616c 7565  turn (x >= value
-00011ec0: 292e 7375 6d28 290a 2020 2020 2020 2020  ).sum().        
-00011ed0: 3e3e 3e20 7265 7320 3d20 6464 662e 782e  >>> res = ddf.x.
-00011ee0: 7265 6475 6374 696f 6e28 636f 756e 745f  reduction(count_
-00011ef0: 6772 6561 7465 722c 2061 6767 7265 6761  greater, aggrega
-00011f00: 7465 3d6c 616d 6264 6120 783a 2078 2e73  te=lambda x: x.s
-00011f10: 756d 2829 2c0a 2020 2020 2020 2020 2e2e  um(),.        ..
-00011f20: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-00011f30: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-00011f40: 6172 6773 3d7b 2776 616c 7565 273a 2032  args={'value': 2
-00011f50: 357d 290a 2020 2020 2020 2020 3e3e 3e20  5}).        >>> 
-00011f60: 7265 732e 636f 6d70 7574 6528 290a 2020  res.compute().  
-00011f70: 2020 2020 2020 3235 0a0a 2020 2020 2020        25..      
-00011f80: 2020 4167 6772 6567 6174 6520 626f 7468    Aggregate both
-00011f90: 2074 6865 2073 756d 2061 6e64 2063 6f75   the sum and cou
-00011fa0: 6e74 206f 6620 6120 5365 7269 6573 2061  nt of a Series a
-00011fb0: 7420 7468 6520 7361 6d65 2074 696d 653a  t the same time:
-00011fc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6465  ..        >>> de
-00011fd0: 6620 7375 6d5f 616e 645f 636f 756e 7428  f sum_and_count(
-00011fe0: 7829 3a0a 2020 2020 2020 2020 2e2e 2e20  x):.        ... 
-00011ff0: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
-00012000: 7269 6573 287b 2763 6f75 6e74 273a 2078  ries({'count': x
-00012010: 2e63 6f75 6e74 2829 2c20 2773 756d 273a  .count(), 'sum':
-00012020: 2078 2e73 756d 2829 7d2c 0a20 2020 2020   x.sum()},.     
-00012030: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-00012040: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-00012050: 783d 5b27 636f 756e 7427 2c20 2773 756d  x=['count', 'sum
-00012060: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
-00012070: 7265 7320 3d20 6464 662e 782e 7265 6475  res = ddf.x.redu
-00012080: 6374 696f 6e28 7375 6d5f 616e 645f 636f  ction(sum_and_co
-00012090: 756e 742c 2061 6767 7265 6761 7465 3d6c  unt, aggregate=l
-000120a0: 616d 6264 6120 783a 2078 2e73 756d 2829  ambda x: x.sum()
-000120b0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-000120c0: 732e 636f 6d70 7574 6528 290a 2020 2020  s.compute().    
-000120d0: 2020 2020 636f 756e 7420 2020 2020 2035      count      5
-000120e0: 300a 2020 2020 2020 2020 7375 6d20 2020  0.        sum   
-000120f0: 2020 2031 3232 350a 2020 2020 2020 2020     1225.        
-00012100: 6474 7970 653a 2069 6e74 3634 0a0a 2020  dtype: int64..  
-00012110: 2020 2020 2020 446f 696e 6720 7468 6520        Doing the 
-00012120: 7361 6d65 2c20 6275 7420 666f 7220 6120  same, but for a 
-00012130: 4461 7461 4672 616d 652e 2048 6572 6520  DataFrame. Here 
-00012140: 6060 6368 756e 6b60 6020 7265 7475 726e  ``chunk`` return
-00012150: 7320 610a 2020 2020 2020 2020 4461 7461  s a.        Data
-00012160: 4672 616d 652c 206d 6561 6e69 6e67 2074  Frame, meaning t
-00012170: 6865 2069 6e70 7574 2074 6f20 6060 6167  he input to ``ag
-00012180: 6772 6567 6174 6560 6020 6973 2061 2044  gregate`` is a D
-00012190: 6174 6146 7261 6d65 2077 6974 6820 616e  ataFrame with an
-000121a0: 0a20 2020 2020 2020 2069 6e64 6578 2077  .        index w
-000121b0: 6974 6820 6e6f 6e2d 756e 6971 7565 2065  ith non-unique e
-000121c0: 6e74 7269 6573 2066 6f72 2062 6f74 6820  ntries for both 
-000121d0: 2778 2720 616e 6420 2779 272e 2057 6520  'x' and 'y'. We 
-000121e0: 6772 6f75 7062 7920 7468 650a 2020 2020  groupby the.    
-000121f0: 2020 2020 696e 6465 782c 2061 6e64 2073      index, and s
-00012200: 756d 2065 6163 6820 6772 6f75 7020 746f  um each group to
-00012210: 2067 6574 2074 6865 2066 696e 616c 2072   get the final r
-00012220: 6573 756c 742e 0a0a 2020 2020 2020 2020  esult...        
-00012230: 3e3e 3e20 6465 6620 7375 6d5f 616e 645f  >>> def sum_and_
-00012240: 636f 756e 7428 7829 3a0a 2020 2020 2020  count(x):.      
-00012250: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
-00012260: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
-00012270: 636f 756e 7427 3a20 782e 636f 756e 7428  count': x.count(
-00012280: 292c 2027 7375 6d27 3a20 782e 7375 6d28  ), 'sum': x.sum(
-00012290: 297d 2c0a 2020 2020 2020 2020 2e2e 2e20  )},.        ... 
-000122a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122b0: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
-000122c0: 5b27 636f 756e 7427 2c20 2773 756d 275d  ['count', 'sum']
-000122d0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-000122e0: 7320 3d20 6464 662e 7265 6475 6374 696f  s = ddf.reductio
-000122f0: 6e28 7375 6d5f 616e 645f 636f 756e 742c  n(sum_and_count,
-00012300: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00012310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012320: 2061 6767 7265 6761 7465 3d6c 616d 6264   aggregate=lambd
-00012330: 6120 783a 2078 2e67 726f 7570 6279 286c  a x: x.groupby(l
-00012340: 6576 656c 3d30 292e 7375 6d28 2929 0a20  evel=0).sum()). 
-00012350: 2020 2020 2020 203e 3e3e 2072 6573 2e63         >>> res.c
-00012360: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
-00012370: 2020 2020 636f 756e 7420 2020 7375 6d0a      count   sum.
-00012380: 2020 2020 2020 2020 7820 2020 2020 3530          x     50
-00012390: 2020 3132 3235 0a20 2020 2020 2020 2079    1225.        y
-000123a0: 2020 2020 2035 3020 2033 3732 350a 2020       50  3725.  
-000123b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000123c0: 2020 6966 2073 706c 6974 5f65 7665 7279    if split_every
-000123d0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-000123e0: 2073 706c 6974 5f65 7665 7279 203c 2032   split_every < 2
-000123f0: 2061 6e64 2073 706c 6974 5f65 7665 7279   and split_every
-00012400: 2069 7320 6e6f 7420 4661 6c73 653a 0a20   is not False:. 
-00012410: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00012420: 2056 616c 7565 4572 726f 7228 2273 706c   ValueError("spl
-00012430: 6974 5f65 7665 7279 206d 7573 7420 6265  it_every must be
-00012440: 2061 7420 6c65 6173 7420 3222 290a 0a20   at least 2").. 
-00012450: 2020 2020 2020 2069 6620 636f 6d62 696e         if combin
-00012460: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00012470: 2020 2020 2020 2069 6620 636f 6d62 696e         if combin
-00012480: 655f 6b77 6172 6773 3a0a 2020 2020 2020  e_kwargs:.      
-00012490: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000124a0: 5661 6c75 6545 7272 6f72 2822 6063 6f6d  ValueError("`com
-000124b0: 6269 6e65 5f6b 7761 7267 7360 2070 726f  bine_kwargs` pro
-000124c0: 7669 6465 6420 7769 7468 206e 6f20 6063  vided with no `c
-000124d0: 6f6d 6269 6e65 6022 290a 0a20 2020 2020  ombine`")..     
-000124e0: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
-000124f0: 3d20 6368 756e 6b5f 6b77 6172 6773 2e63  = chunk_kwargs.c
-00012500: 6f70 7928 2920 6966 2063 6875 6e6b 5f6b  opy() if chunk_k
-00012510: 7761 7267 7320 656c 7365 207b 7d0a 2020  wargs else {}.  
-00012520: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
-00012530: 6773 2e75 7064 6174 6528 6b77 6172 6773  gs.update(kwargs
-00012540: 290a 2020 2020 2020 2020 6368 756e 6b5f  ).        chunk_
-00012550: 6b77 6172 6773 5b22 6675 6e63 225d 203d  kwargs["func"] =
-00012560: 2063 6875 6e6b 0a0a 2020 2020 2020 2020   chunk..        
-00012570: 636f 6d62 696e 655f 6b77 6172 6773 203d  combine_kwargs =
-00012580: 2063 6f6d 6269 6e65 5f6b 7761 7267 732e   combine_kwargs.
-00012590: 636f 7079 2829 2069 6620 636f 6d62 696e  copy() if combin
-000125a0: 655f 6b77 6172 6773 2065 6c73 6520 7b7d  e_kwargs else {}
-000125b0: 0a20 2020 2020 2020 2063 6f6d 6269 6e65  .        combine
-000125c0: 5f6b 7761 7267 732e 7570 6461 7465 286b  _kwargs.update(k
-000125d0: 7761 7267 7329 0a20 2020 2020 2020 2063  wargs).        c
-000125e0: 6f6d 6269 6e65 5f6b 7761 7267 735b 2266  ombine_kwargs["f
-000125f0: 756e 6322 5d20 3d20 636f 6d62 696e 6520  unc"] = combine 
-00012600: 6f72 2061 6767 7265 6761 7465 206f 7220  or aggregate or 
-00012610: 6368 756e 6b0a 0a20 2020 2020 2020 2061  chunk..        a
-00012620: 6767 7265 6761 7465 5f6b 7761 7267 7320  ggregate_kwargs 
-00012630: 3d20 6167 6772 6567 6174 655f 6b77 6172  = aggregate_kwar
-00012640: 6773 2e63 6f70 7928 2920 6966 2061 6767  gs.copy() if agg
-00012650: 7265 6761 7465 5f6b 7761 7267 7320 656c  regate_kwargs el
-00012660: 7365 207b 7d0a 2020 2020 2020 2020 6167  se {}.        ag
-00012670: 6772 6567 6174 655f 6b77 6172 6773 2e75  gregate_kwargs.u
-00012680: 7064 6174 6528 6b77 6172 6773 290a 2020  pdate(kwargs).  
-00012690: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
-000126a0: 6b77 6172 6773 5b22 6675 6e63 225d 203d  kwargs["func"] =
-000126b0: 2061 6767 7265 6761 7465 206f 7220 6368   aggregate or ch
-000126c0: 756e 6b0a 0a20 2020 2020 2020 2072 6574  unk..        ret
-000126d0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-000126e0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-000126f0: 4375 7374 6f6d 5265 6475 6374 696f 6e28  CustomReduction(
-00012700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012710: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00012720: 2020 2020 2020 206d 6574 612c 0a20 2020         meta,.   
-00012730: 2020 2020 2020 2020 2020 2020 2063 6875               chu
-00012740: 6e6b 5f6b 7761 7267 732c 0a20 2020 2020  nk_kwargs,.     
-00012750: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-00012760: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
-00012770: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00012780: 6269 6e65 5f6b 7761 7267 732c 0a20 2020  bine_kwargs,.   
-00012790: 2020 2020 2020 2020 2020 2020 2073 706c               spl
-000127a0: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-000127b0: 2020 2020 2020 2020 2020 746f 6b65 6e2c            token,
-000127c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000127d0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-000127e0: 6620 6d65 6d6f 7279 5f75 7361 6765 5f70  f memory_usage_p
-000127f0: 6572 5f70 6172 7469 7469 6f6e 2873 656c  er_partition(sel
-00012800: 662c 2069 6e64 6578 3a20 626f 6f6c 203d  f, index: bool =
-00012810: 2054 7275 652c 2064 6565 703a 2062 6f6f   True, deep: boo
-00012820: 6c20 3d20 4661 6c73 6529 3a0a 2020 2020  l = False):.    
-00012830: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-00012840: 6520 6d65 6d6f 7279 2075 7361 6765 206f  e memory usage o
-00012850: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
-00012860: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00012870: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00012880: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00012890: 696e 6465 7820 3a20 626f 6f6c 2c20 6465  index : bool, de
-000128a0: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-000128b0: 2020 2020 2020 2053 7065 6369 6669 6573         Specifies
-000128c0: 2077 6865 7468 6572 2074 6f20 696e 636c   whether to incl
-000128d0: 7564 6520 7468 6520 6d65 6d6f 7279 2075  ude the memory u
-000128e0: 7361 6765 206f 6620 7468 6520 696e 6465  sage of the inde
-000128f0: 7820 696e 0a20 2020 2020 2020 2020 2020  x in.           
-00012900: 2072 6574 7572 6e65 6420 5365 7269 6573   returned Series
-00012910: 2e0a 2020 2020 2020 2020 6465 6570 203a  ..        deep :
-00012920: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
-00012930: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00012940: 2049 6620 5472 7565 2c20 696e 7472 6f73   If True, intros
-00012950: 7065 6374 2074 6865 2064 6174 6120 6465  pect the data de
-00012960: 6570 6c79 2062 7920 696e 7465 7272 6f67  eply by interrog
-00012970: 6174 696e 670a 2020 2020 2020 2020 2020  ating.          
-00012980: 2020 6060 6f62 6a65 6374 6060 2064 7479    ``object`` dty
-00012990: 7065 7320 666f 7220 7379 7374 656d 2d6c  pes for system-l
-000129a0: 6576 656c 206d 656d 6f72 7920 636f 6e73  evel memory cons
-000129b0: 756d 7074 696f 6e2c 2061 6e64 2069 6e63  umption, and inc
-000129c0: 6c75 6465 0a20 2020 2020 2020 2020 2020  lude.           
-000129d0: 2069 7420 696e 2074 6865 2072 6574 7572   it in the retur
-000129e0: 6e65 6420 7661 6c75 6573 2e0a 0a20 2020  ned values...   
-000129f0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00012a00: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00012a10: 2020 2020 2053 6572 6965 730a 2020 2020       Series.    
-00012a20: 2020 2020 2020 2020 4120 5365 7269 6573          A Series
-00012a30: 2077 686f 7365 2069 6e64 6578 2069 7320   whose index is 
-00012a40: 7468 6520 7061 7274 6974 696f 6e20 6e75  the partition nu
-00012a50: 6d62 6572 2061 6e64 2077 686f 7365 2076  mber and whose v
-00012a60: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
-00012a70: 2020 6172 6520 7468 6520 6d65 6d6f 7279    are the memory
-00012a80: 2075 7361 6765 206f 6620 6561 6368 2070   usage of each p
-00012a90: 6172 7469 7469 6f6e 2069 6e20 6279 7465  artition in byte
-00012aa0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00012ab0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00012ac0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
-00012ad0: 662e 6578 7072 2e6d 656d 6f72 795f 7573  f.expr.memory_us
-00012ae0: 6167 655f 7065 725f 7061 7274 6974 696f  age_per_partitio
-00012af0: 6e28 696e 6465 782c 2064 6565 7029 290a  n(index, deep)).
-00012b00: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00012b10: 2020 2064 6566 206c 6f63 2873 656c 6629     def loc(self)
-00012b20: 3a0a 2020 2020 2020 2020 2222 2250 7572  :.        """Pur
-00012b30: 656c 7920 6c61 6265 6c2d 6c6f 6361 7469  ely label-locati
-00012b40: 6f6e 2062 6173 6564 2069 6e64 6578 6572  on based indexer
-00012b50: 2066 6f72 2073 656c 6563 7469 6f6e 2062   for selection b
-00012b60: 7920 6c61 6265 6c2e 0a0a 2020 2020 2020  y label...      
-00012b70: 2020 3e3e 3e20 6466 2e6c 6f63 5b22 6222    >>> df.loc["b"
-00012b80: 5d20 2023 2064 6f63 7465 7374 3a20 2b53  ]  # doctest: +S
-00012b90: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
-00012ba0: 6466 2e6c 6f63 5b22 6222 3a22 6422 5d20  df.loc["b":"d"] 
-00012bb0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00012bc0: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
-00012bd0: 2020 2020 2020 6672 6f6d 2064 6173 6b5f        from dask_
-00012be0: 6578 7072 2e5f 696e 6465 7869 6e67 2069  expr._indexing i
-00012bf0: 6d70 6f72 7420 4c6f 6349 6e64 6578 6572  mport LocIndexer
-00012c00: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00012c10: 204c 6f63 496e 6465 7865 7228 7365 6c66   LocIndexer(self
-00012c20: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00012c30: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00012c40: 6529 0a20 2020 2064 6566 206e 6f74 6e75  e).    def notnu
-00012c50: 6c6c 2873 656c 6629 3a0a 2020 2020 2020  ll(self):.      
-00012c60: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00012c70: 6c65 6374 696f 6e28 6578 7072 2e4e 6f74  lection(expr.Not
-00012c80: 4e75 6c6c 2873 656c 6629 290a 0a20 2020  Null(self))..   
-00012c90: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00012ca0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00012cb0: 2064 6566 2069 736e 756c 6c28 7365 6c66   def isnull(self
-00012cc0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00012cd0: 6e20 7e73 656c 662e 6e6f 746e 756c 6c28  n ~self.notnull(
-00012ce0: 290a 0a20 2020 2064 6566 2063 6f6d 7075  )..    def compu
-00012cf0: 7465 5f63 7572 7265 6e74 5f64 6976 6973  te_current_divis
-00012d00: 696f 6e73 2873 656c 662c 2063 6f6c 3d4e  ions(self, col=N
-00012d10: 6f6e 652c 2073 6574 5f64 6976 6973 696f  one, set_divisio
-00012d20: 6e73 3a20 626f 6f6c 203d 2046 616c 7365  ns: bool = False
-00012d30: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-00012d40: 6d70 7574 6520 7468 6520 6375 7272 656e  mpute the curren
-00012d50: 7420 6469 7669 7369 6f6e 7320 6f66 2074  t divisions of t
-00012d60: 6865 2044 6174 6146 7261 6d65 2e0a 0a20  he DataFrame... 
-00012d70: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00012d80: 6f64 2074 7269 6767 6572 7320 696d 6d65  od triggers imme
-00012d90: 6469 6174 6520 636f 6d70 7574 6174 696f  diate computatio
-00012da0: 6e2e 2049 6620 796f 7520 6669 6e64 2079  n. If you find y
-00012db0: 6f75 7273 656c 6620 7275 6e6e 696e 6720  ourself running 
-00012dc0: 7468 6973 2063 6f6d 6d61 6e64 0a20 2020  this command.   
-00012dd0: 2020 2020 2072 6570 6561 7465 646c 7920       repeatedly 
-00012de0: 666f 7220 7468 6520 7361 6d65 2064 6174  for the same dat
-00012df0: 6166 7261 6d65 2c20 7765 2072 6563 6f6d  aframe, we recom
-00012e00: 6d65 6e64 2073 746f 7269 6e67 2074 6865  mend storing the
-00012e10: 2072 6573 756c 740a 2020 2020 2020 2020   result.        
-00012e20: 736f 2079 6f75 2064 6f6e 2774 2068 6176  so you don't hav
-00012e30: 6520 746f 2072 6572 756e 2069 742e 0a0a  e to rerun it...
-00012e40: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
-00012e50: 6f6c 756d 6e20 6f72 2069 6e64 6578 2076  olumn or index v
-00012e60: 616c 7565 7320 6f76 6572 6c61 7020 6265  alues overlap be
-00012e70: 7477 6565 6e20 7061 7274 6974 696f 6e73  tween partitions
-00012e80: 2c20 7261 6973 6573 2060 6056 616c 7565  , raises ``Value
-00012e90: 4572 726f 7260 602e 0a20 2020 2020 2020  Error``..       
-00012ea0: 2054 6f20 7072 6576 656e 7420 7468 6973   To prevent this
-00012eb0: 2c20 6d61 6b65 2073 7572 6520 7468 6520  , make sure the 
-00012ec0: 6461 7461 2061 7265 2073 6f72 7465 6420  data are sorted 
-00012ed0: 6279 2074 6865 2063 6f6c 756d 6e20 6f72  by the column or
-00012ee0: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
-00012ef0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00012f00: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00012f10: 2020 2020 2020 2063 6f6c 203a 2073 7472         col : str
-00012f20: 696e 672c 206f 7074 696f 6e61 6c0a 2020  ing, optional.  
-00012f30: 2020 2020 2020 2020 2020 4361 6c63 756c            Calcul
-00012f40: 6174 6520 7468 6520 6469 7669 7369 6f6e  ate the division
-00012f50: 7320 666f 7220 6120 6e6f 6e2d 696e 6465  s for a non-inde
-00012f60: 7820 636f 6c75 6d6e 2062 7920 7061 7373  x column by pass
-00012f70: 696e 6720 696e 2074 6865 206e 616d 6520  ing in the name 
-00012f80: 6f66 2074 6865 2063 6f6c 756d 6e2e 0a20  of the column.. 
-00012f90: 2020 2020 2020 2020 2020 2049 6620 636f             If co
-00012fa0: 6c20 6973 206e 6f74 2073 7065 6369 6669  l is not specifi
-00012fb0: 6564 2c20 7468 6520 696e 6465 7820 7769  ed, the index wi
-00012fc0: 6c6c 2062 6520 7573 6564 2074 6f20 6361  ll be used to ca
-00012fd0: 6c63 756c 6174 6520 6469 7669 7369 6f6e  lculate division
-00012fe0: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
-00012ff0: 6e20 7468 6973 2063 6173 652c 2069 6620  n this case, if 
-00013000: 7468 6520 6469 7669 7369 6f6e 7320 6172  the divisions ar
-00013010: 6520 616c 7265 6164 7920 6b6e 6f77 6e2c  e already known,
-00013020: 2074 6865 7920 7769 6c6c 2062 6520 7265   they will be re
-00013030: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
-00013040: 2020 2069 6d6d 6564 6961 7465 6c79 2077     immediately w
-00013050: 6974 686f 7574 2063 6f6d 7075 7469 6e67  ithout computing
-00013060: 2e0a 2020 2020 2020 2020 7365 745f 6469  ..        set_di
-00013070: 7669 7369 6f6e 7320 3a20 626f 6f6c 2c20  visions : bool, 
-00013080: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-00013090: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-000130a0: 7220 746f 2073 6574 2074 6865 2063 6f6d  r to set the com
-000130b0: 7075 7465 6420 6469 7669 7369 6f6e 7320  puted divisions 
-000130c0: 696e 746f 2074 6865 2044 6174 6146 7261  into the DataFra
-000130d0: 6d65 2e20 4966 2046 616c 7365 2c20 7468  me. If False, th
-000130e0: 6520 6469 7669 7369 6f6e 730a 2020 2020  e divisions.    
-000130f0: 2020 2020 2020 2020 6f66 2074 6865 2044          of the D
-00013100: 6174 6146 7261 6d65 2061 7265 2075 6e63  ataFrame are unc
-00013110: 6861 6e67 6564 2e0a 0a20 2020 2020 2020  hanged...       
-00013120: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-00013130: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00013140: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00013150: 736b 0a20 2020 2020 2020 203e 3e3e 2064  sk.        >>> d
-00013160: 6466 203d 2064 6173 6b2e 6461 7461 7365  df = dask.datase
-00013170: 7473 2e74 696d 6573 6572 6965 7328 7374  ts.timeseries(st
-00013180: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
-00013190: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
-000131a0: 3722 2c20 6672 6571 3d22 3168 2229 2e63  7", freq="1h").c
-000131b0: 6c65 6172 5f64 6976 6973 696f 6e73 2829  lear_divisions()
-000131c0: 0a20 2020 2020 2020 203e 3e3e 2064 6976  .        >>> div
-000131d0: 6973 696f 6e73 203d 2064 6466 2e63 6f6d  isions = ddf.com
-000131e0: 7075 7465 5f63 7572 7265 6e74 5f64 6976  pute_current_div
-000131f0: 6973 696f 6e73 2829 0a20 2020 2020 2020  isions().       
-00013200: 203e 3e3e 2070 7269 6e74 2864 6976 6973   >>> print(divis
-00013210: 696f 6e73 2920 2023 2064 6f63 7465 7374  ions)  # doctest
-00013220: 3a20 2b4e 4f52 4d41 4c49 5a45 5f57 4849  : +NORMALIZE_WHI
-00013230: 5445 5350 4143 450a 2020 2020 2020 2020  TESPACE.        
-00013240: 2854 696d 6573 7461 6d70 2827 3230 3231  (Timestamp('2021
-00013250: 2d30 312d 3031 2030 303a 3030 3a30 3027  -01-01 00:00:00'
-00013260: 292c 0a20 2020 2020 2020 2020 5469 6d65  ),.         Time
-00013270: 7374 616d 7028 2732 3032 312d 3031 2d30  stamp('2021-01-0
-00013280: 3220 3030 3a30 303a 3030 2729 2c0a 2020  2 00:00:00'),.  
-00013290: 2020 2020 2020 2054 696d 6573 7461 6d70         Timestamp
-000132a0: 2827 3230 3231 2d30 312d 3033 2030 303a  ('2021-01-03 00:
-000132b0: 3030 3a30 3027 292c 0a20 2020 2020 2020  00:00'),.       
-000132c0: 2020 5469 6d65 7374 616d 7028 2732 3032    Timestamp('202
-000132d0: 312d 3031 2d30 3420 3030 3a30 303a 3030  1-01-04 00:00:00
-000132e0: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
-000132f0: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
-00013300: 3035 2030 303a 3030 3a30 3027 292c 0a20  05 00:00:00'),. 
-00013310: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
-00013320: 7028 2732 3032 312d 3031 2d30 3620 3030  p('2021-01-06 00
-00013330: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
-00013340: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
-00013350: 3231 2d30 312d 3036 2032 333a 3030 3a30  21-01-06 23:00:0
-00013360: 3027 2929 0a0a 2020 2020 2020 2020 3e3e  0'))..        >>
-00013370: 3e20 6464 662e 6469 7669 7369 6f6e 7320  > ddf.divisions 
-00013380: 3d20 6469 7669 7369 6f6e 730a 2020 2020  = divisions.    
-00013390: 2020 2020 3e3e 3e20 6464 662e 6b6e 6f77      >>> ddf.know
-000133a0: 6e5f 6469 7669 7369 6f6e 730a 2020 2020  n_divisions.    
-000133b0: 2020 2020 5472 7565 0a0a 2020 2020 2020      True..      
-000133c0: 2020 3e3e 3e20 6464 6620 3d20 6464 662e    >>> ddf = ddf.
-000133d0: 7265 7365 745f 696e 6465 7828 292e 636c  reset_index().cl
-000133e0: 6561 725f 6469 7669 7369 6f6e 7328 290a  ear_divisions().
-000133f0: 2020 2020 2020 2020 3e3e 3e20 6469 7669          >>> divi
-00013400: 7369 6f6e 7320 3d20 6464 662e 636f 6d70  sions = ddf.comp
-00013410: 7574 655f 6375 7272 656e 745f 6469 7669  ute_current_divi
-00013420: 7369 6f6e 7328 2274 696d 6573 7461 6d70  sions("timestamp
-00013430: 2229 0a20 2020 2020 2020 203e 3e3e 2070  ").        >>> p
-00013440: 7269 6e74 2864 6976 6973 696f 6e73 2920  rint(divisions) 
-00013450: 2023 2064 6f63 7465 7374 3a20 2b4e 4f52   # doctest: +NOR
-00013460: 4d41 4c49 5a45 5f57 4849 5445 5350 4143  MALIZE_WHITESPAC
-00013470: 450a 2020 2020 2020 2020 2854 696d 6573  E.        (Times
-00013480: 7461 6d70 2827 3230 3231 2d30 312d 3031  tamp('2021-01-01
-00013490: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
-000134a0: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
-000134b0: 2732 3032 312d 3031 2d30 3220 3030 3a30  '2021-01-02 00:0
-000134c0: 303a 3030 2729 2c0a 2020 2020 2020 2020  0:00'),.        
-000134d0: 2054 696d 6573 7461 6d70 2827 3230 3231   Timestamp('2021
-000134e0: 2d30 312d 3033 2030 303a 3030 3a30 3027  -01-03 00:00:00'
-000134f0: 292c 0a20 2020 2020 2020 2020 5469 6d65  ),.         Time
-00013500: 7374 616d 7028 2732 3032 312d 3031 2d30  stamp('2021-01-0
-00013510: 3420 3030 3a30 303a 3030 2729 2c0a 2020  4 00:00:00'),.  
-00013520: 2020 2020 2020 2054 696d 6573 7461 6d70         Timestamp
-00013530: 2827 3230 3231 2d30 312d 3035 2030 303a  ('2021-01-05 00:
-00013540: 3030 3a30 3027 292c 0a20 2020 2020 2020  00:00'),.       
-00013550: 2020 5469 6d65 7374 616d 7028 2732 3032    Timestamp('202
-00013560: 312d 3031 2d30 3620 3030 3a30 303a 3030  1-01-06 00:00:00
-00013570: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
-00013580: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
-00013590: 3036 2032 333a 3030 3a30 3027 2929 0a0a  06 23:00:00'))..
-000135a0: 2020 2020 2020 2020 3e3e 3e20 6464 6620          >>> ddf 
-000135b0: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
-000135c0: 2274 696d 6573 7461 6d70 222c 2064 6976  "timestamp", div
-000135d0: 6973 696f 6e73 3d64 6976 6973 696f 6e73  isions=divisions
-000135e0: 2c20 736f 7274 6564 3d54 7275 6529 0a20  , sorted=True). 
-000135f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00013600: 2020 2069 6620 636f 6c20 6973 204e 6f6e     if col is Non
-00013610: 6520 616e 6420 7365 6c66 2e6b 6e6f 776e  e and self.known
-00013620: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
-00013630: 2020 2020 2020 2020 6966 2073 6574 5f64          if set_d
-00013640: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
-00013650: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013660: 2073 656c 660a 2020 2020 2020 2020 2020   self.          
-00013670: 2020 7265 7475 726e 2073 656c 662e 6469    return self.di
-00013680: 7669 7369 6f6e 730a 0a20 2020 2020 2020  visions..       
-00013690: 2069 6620 636f 6c20 6973 206e 6f74 204e   if col is not N
-000136a0: 6f6e 6520 616e 6420 7365 745f 6469 7669  one and set_divi
-000136b0: 7369 6f6e 733a 0a20 2020 2020 2020 2020  sions:.         
-000136c0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-000136d0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-000136e0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-000136f0: 616e 2774 2073 6574 2064 6976 6973 696f  an't set divisio
-00013700: 6e73 206f 6620 6e6f 6e2d 696e 6465 782c  ns of non-index,
-00013710: 2063 616c 6c20 7365 745f 696e 6465 7820   call set_index 
-00013720: 696e 7374 6561 642e 220a 2020 2020 2020  instead.".      
-00013730: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00013740: 2069 6620 636f 6c20 6973 206e 6f74 204e   if col is not N
-00013750: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00013760: 2066 7261 6d65 203d 2073 656c 665b 636f   frame = self[co
-00013770: 6c5d 0a20 2020 2020 2020 2065 6c73 653a  l].        else:
-00013780: 0a20 2020 2020 2020 2020 2020 2066 7261  .            fra
-00013790: 6d65 203d 2073 656c 662e 696e 6465 780a  me = self.index.
-000137a0: 0a20 2020 2020 2020 206d 696e 732c 206d  .        mins, m
-000137b0: 6178 6573 2c20 6c65 6e73 203d 205f 636f  axes, lens = _co
-000137c0: 6d70 7574 655f 7061 7274 6974 696f 6e5f  mpute_partition_
-000137d0: 7374 6174 7328 6672 616d 652c 2061 6c6c  stats(frame, all
-000137e0: 6f77 5f6f 7665 726c 6170 3d73 6574 5f64  ow_overlap=set_d
-000137f0: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
-00013800: 2020 6469 7669 7369 6f6e 7320 3d20 7475    divisions = tu
-00013810: 706c 6528 6d69 6e73 2920 2b20 286d 6178  ple(mins) + (max
-00013820: 6573 5b2d 315d 2c29 0a20 2020 2020 2020  es[-1],).       
-00013830: 2069 6620 6e6f 7420 7365 745f 6469 7669   if not set_divi
-00013840: 7369 6f6e 733a 0a20 2020 2020 2020 2020  sions:.         
-00013850: 2020 2072 6574 7572 6e20 6469 7669 7369     return divisi
-00013860: 6f6e 730a 2020 2020 2020 2020 6966 206c  ons.        if l
-00013870: 656e 286d 696e 7329 203d 3d20 6c65 6e28  en(mins) == len(
-00013880: 7365 6c66 2e64 6976 6973 696f 6e73 2920  self.divisions) 
-00013890: 2d20 313a 0a20 2020 2020 2020 2020 2020  - 1:.           
-000138a0: 2069 6620 6e6f 7420 616e 7928 6d69 6e73   if not any(mins
-000138b0: 5b69 5d20 3e3d 206d 6178 6573 5b69 202d  [i] >= maxes[i -
-000138c0: 2031 5d20 666f 7220 6920 696e 2072 616e   1] for i in ran
-000138d0: 6765 2831 2c20 6c65 6e28 6d69 6e73 2929  ge(1, len(mins))
-000138e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000138f0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00013900: 6c6c 6563 7469 6f6e 2865 7870 722e 5365  llection(expr.Se
-00013910: 7444 6976 6973 696f 6e73 2873 656c 662c  tDivisions(self,
-00013920: 2064 6976 6973 696f 6e73 2929 0a0a 2020   divisions))..  
-00013930: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00013940: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
-00013950: 2e52 6573 6f6c 7665 4f76 6572 6c61 7070  .ResolveOverlapp
-00013960: 696e 6744 6976 6973 696f 6e73 2873 656c  ingDivisions(sel
-00013970: 662c 206d 696e 732c 206d 6178 6573 2c20  f, mins, maxes, 
-00013980: 6c65 6e73 2929 0a0a 2020 2020 4063 6c61  lens))..    @cla
-00013990: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-000139a0: 2066 726f 6d5f 6469 6374 280a 2020 2020   from_dict(.    
-000139b0: 2020 2020 636c 732c 2064 6174 612c 202a      cls, data, *
-000139c0: 2c20 6e70 6172 7469 7469 6f6e 733d 312c  , npartitions=1,
-000139d0: 206f 7269 656e 743d 2263 6f6c 756d 6e73   orient="columns
-000139e0: 222c 2064 7479 7065 3d4e 6f6e 652c 2063  ", dtype=None, c
-000139f0: 6f6c 756d 6e73 3d4e 6f6e 650a 2020 2020  olumns=None.    
-00013a00: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00013a10: 2020 2020 2020 2043 6f6e 7374 7275 6374         Construct
-00013a20: 2061 2044 6173 6b20 4461 7461 4672 616d   a Dask DataFram
-00013a30: 6520 6672 6f6d 2061 2050 7974 686f 6e20  e from a Python 
-00013a40: 4469 6374 696f 6e61 7279 0a0a 2020 2020  Dictionary..    
-00013a50: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00013a60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00013a70: 2020 2020 2020 6461 736b 2e64 6174 6166        dask.dataf
-00013a80: 7261 6d65 2e66 726f 6d5f 6469 6374 0a20  rame.from_dict. 
-00013a90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00013aa0: 2020 2072 6574 7572 6e20 6672 6f6d 5f64     return from_d
-00013ab0: 6963 7428 6461 7461 2c20 6e70 6172 7469  ict(data, nparti
-00013ac0: 7469 6f6e 732c 206f 7269 656e 742c 2064  tions, orient, d
-00013ad0: 7479 7065 3d64 7479 7065 2c20 636f 6c75  type=dtype, colu
-00013ae0: 6d6e 733d 636f 6c75 6d6e 7329 0a0a 2020  mns=columns)..  
-00013af0: 2020 6465 6620 746f 5f6a 736f 6e28 7365    def to_json(se
-00013b00: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a61  lf, filename, *a
-00013b10: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00013b20: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
-00013b30: 642e 746f 5f6a 736f 6e20 646f 6373 7472  d.to_json docstr
-00013b40: 696e 6720 666f 7220 6d6f 7265 2069 6e66  ing for more inf
-00013b50: 6f72 6d61 7469 6f6e 2222 220a 2020 2020  ormation""".    
-00013b60: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00013b70: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
-00013b80: 7420 746f 5f6a 736f 6e0a 0a20 2020 2020  t to_json..     
-00013b90: 2020 2072 6574 7572 6e20 746f 5f6a 736f     return to_jso
-00013ba0: 6e28 7365 6c66 2c20 6669 6c65 6e61 6d65  n(self, filename
-00013bb0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00013bc0: 7329 0a0a 2020 2020 6465 6620 746f 5f73  s)..    def to_s
-00013bd0: 716c 280a 2020 2020 2020 2020 7365 6c66  ql(.        self
-00013be0: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-00013bf0: 7374 722c 0a20 2020 2020 2020 2075 7269  str,.        uri
-00013c00: 3a20 7374 722c 0a20 2020 2020 2020 2073  : str,.        s
-00013c10: 6368 656d 613d 4e6f 6e65 2c0a 2020 2020  chema=None,.    
-00013c20: 2020 2020 6966 5f65 7869 7374 733a 2073      if_exists: s
-00013c30: 7472 203d 2022 6661 696c 222c 0a20 2020  tr = "fail",.   
-00013c40: 2020 2020 2069 6e64 6578 3a20 626f 6f6c       index: bool
-00013c50: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-00013c60: 2069 6e64 6578 5f6c 6162 656c 3d4e 6f6e   index_label=Non
-00013c70: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
-00013c80: 7369 7a65 3d4e 6f6e 652c 0a20 2020 2020  size=None,.     
-00013c90: 2020 2064 7479 7065 3d4e 6f6e 652c 0a20     dtype=None,. 
-00013ca0: 2020 2020 2020 206d 6574 686f 643d 4e6f         method=No
-00013cb0: 6e65 2c0a 2020 2020 2020 2020 636f 6d70  ne,.        comp
-00013cc0: 7574 653d 5472 7565 2c0a 2020 2020 2020  ute=True,.      
-00013cd0: 2020 7061 7261 6c6c 656c 3d46 616c 7365    parallel=False
-00013ce0: 2c0a 2020 2020 2020 2020 656e 6769 6e65  ,.        engine
-00013cf0: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
-00013d00: 2020 293a 0a20 2020 2020 2020 2066 726f    ):.        fro
-00013d10: 6d20 6461 736b 5f65 7870 722e 696f 2e73  m dask_expr.io.s
-00013d20: 716c 2069 6d70 6f72 7420 746f 5f73 716c  ql import to_sql
-00013d30: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00013d40: 2074 6f5f 7371 6c28 0a20 2020 2020 2020   to_sql(.       
-00013d50: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00013d60: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
-00013d70: 2020 2020 2020 2020 2075 7269 2c0a 2020           uri,.  
-00013d80: 2020 2020 2020 2020 2020 7363 6865 6d61            schema
-00013d90: 3d73 6368 656d 612c 0a20 2020 2020 2020  =schema,.       
-00013da0: 2020 2020 2069 665f 6578 6973 7473 3d69       if_exists=i
-00013db0: 665f 6578 6973 7473 2c0a 2020 2020 2020  f_exists,.      
-00013dc0: 2020 2020 2020 696e 6465 783d 696e 6465        index=inde
-00013dd0: 782c 0a20 2020 2020 2020 2020 2020 2069  x,.            i
-00013de0: 6e64 6578 5f6c 6162 656c 3d69 6e64 6578  ndex_label=index
-00013df0: 5f6c 6162 656c 2c0a 2020 2020 2020 2020  _label,.        
-00013e00: 2020 2020 6368 756e 6b73 697a 653d 6368      chunksize=ch
-00013e10: 756e 6b73 697a 652c 0a20 2020 2020 2020  unksize,.       
-00013e20: 2020 2020 2064 7479 7065 3d64 7479 7065       dtype=dtype
-00013e30: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-00013e40: 7468 6f64 3d6d 6574 686f 642c 0a20 2020  thod=method,.   
-00013e50: 2020 2020 2020 2020 2063 6f6d 7075 7465           compute
-00013e60: 3d63 6f6d 7075 7465 2c0a 2020 2020 2020  =compute,.      
-00013e70: 2020 2020 2020 7061 7261 6c6c 656c 3d70        parallel=p
-00013e80: 6172 616c 6c65 6c2c 0a20 2020 2020 2020  arallel,.       
-00013e90: 2020 2020 2065 6e67 696e 655f 6b77 6172       engine_kwar
-00013ea0: 6773 3d65 6e67 696e 655f 6b77 6172 6773  gs=engine_kwargs
-00013eb0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00013ec0: 2064 6566 2074 6f5f 6f72 6328 7365 6c66   def to_orc(self
-00013ed0: 2c20 7061 7468 2c20 2a61 7267 732c 202a  , path, *args, *
-00013ee0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00013ef0: 2020 2222 2253 6565 2064 642e 746f 5f6f    """See dd.to_o
-00013f00: 7263 2064 6f63 7374 7269 6e67 2066 6f72  rc docstring for
-00013f10: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-00013f20: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
-00013f30: 6d20 6461 736b 5f65 7870 722e 696f 2e6f  m dask_expr.io.o
-00013f40: 7263 2069 6d70 6f72 7420 746f 5f6f 7263  rc import to_orc
-00013f50: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00013f60: 2074 6f5f 6f72 6328 7365 6c66 2c20 7061   to_orc(self, pa
-00013f70: 7468 2c20 2a61 7267 732c 202a 2a6b 7761  th, *args, **kwa
-00013f80: 7267 7329 0a0a 2020 2020 6465 6620 746f  rgs)..    def to
-00013f90: 5f63 7376 2873 656c 662c 2066 696c 656e  _csv(self, filen
-00013fa0: 616d 652c 202a 2a6b 7761 7267 7329 3a0a  ame, **kwargs):.
-00013fb0: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
-00013fc0: 642e 746f 5f63 7376 2064 6f63 7374 7269  d.to_csv docstri
-00013fd0: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
-00013fe0: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
-00013ff0: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
-00014000: 722e 696f 2e63 7376 2069 6d70 6f72 7420  r.io.csv import 
-00014010: 746f 5f63 7376 0a0a 2020 2020 2020 2020  to_csv..        
-00014020: 7265 7475 726e 2074 6f5f 6373 7628 7365  return to_csv(se
-00014030: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
-00014040: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
-00014050: 2074 6f5f 7265 636f 7264 7328 7365 6c66   to_records(self
-00014060: 2c20 696e 6465 783d 4661 6c73 652c 206c  , index=False, l
-00014070: 656e 6774 6873 3d4e 6f6e 6529 3a0a 2020  engths=None):.  
-00014080: 2020 2020 2020 6672 6f6d 2064 6173 6b5f        from dask_
-00014090: 6578 7072 2e69 6f2e 7265 636f 7264 7320  expr.io.records 
-000140a0: 696d 706f 7274 2074 6f5f 7265 636f 7264  import to_record
-000140b0: 730a 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
-000140c0: 6e67 7468 7320 6973 2054 7275 653a 0a20  ngths is True:. 
-000140d0: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
-000140e0: 6873 203d 2074 7570 6c65 2873 656c 662e  hs = tuple(self.
-000140f0: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
-00014100: 656e 292e 636f 6d70 7574 6528 2929 0a0a  en).compute())..
-00014110: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
-00014120: 7365 6c66 2e74 6f5f 6c65 6761 6379 5f64  self.to_legacy_d
-00014130: 6174 6166 7261 6d65 2829 0a20 2020 2020  ataframe().     
-00014140: 2020 2072 6563 6f72 6473 203d 2074 6f5f     records = to_
-00014150: 7265 636f 7264 7328 6672 616d 6529 0a0a  records(frame)..
-00014160: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
-00014170: 2066 7261 6d65 2e5f 7661 6c69 6461 7465   frame._validate
-00014180: 5f63 6875 6e6b 7328 7265 636f 7264 732c  _chunks(records,
-00014190: 206c 656e 6774 6873 290a 2020 2020 2020   lengths).      
-000141a0: 2020 7265 636f 7264 732e 5f63 6875 6e6b    records._chunk
-000141b0: 7320 3d20 2863 6875 6e6b 735b 305d 2c29  s = (chunks[0],)
-000141c0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000141d0: 2072 6563 6f72 6473 0a0a 2020 2020 6465   records..    de
-000141e0: 6620 746f 5f62 6167 2873 656c 662c 2069  f to_bag(self, i
-000141f0: 6e64 6578 3d46 616c 7365 2c20 666f 726d  ndex=False, form
-00014200: 6174 3d22 7475 706c 6522 293a 0a20 2020  at="tuple"):.   
-00014210: 2020 2020 2022 2222 4372 6561 7465 2061       """Create a
-00014220: 2044 6173 6b20 4261 6720 6672 6f6d 2061   Dask Bag from a
-00014230: 2053 6572 6965 7322 2222 0a20 2020 2020   Series""".     
-00014240: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
-00014250: 722e 696f 2e62 6167 2069 6d70 6f72 7420  r.io.bag import 
-00014260: 746f 5f62 6167 0a0a 2020 2020 2020 2020  to_bag..        
-00014270: 7265 7475 726e 2074 6f5f 6261 6728 7365  return to_bag(se
-00014280: 6c66 2c20 696e 6465 782c 2066 6f72 6d61  lf, index, forma
-00014290: 743d 666f 726d 6174 290a 0a20 2020 2064  t=format)..    d
-000142a0: 6566 2074 6f5f 6864 6628 7365 6c66 2c20  ef to_hdf(self, 
-000142b0: 7061 7468 5f6f 725f 6275 662c 206b 6579  path_or_buf, key
-000142c0: 2c20 6d6f 6465 3d22 6122 2c20 6170 7065  , mode="a", appe
-000142d0: 6e64 3d46 616c 7365 2c20 2a2a 6b77 6172  nd=False, **kwar
-000142e0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-000142f0: 5365 6520 6464 2e74 6f5f 6864 6620 646f  See dd.to_hdf do
-00014300: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
-00014310: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
-00014320: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00014330: 6b5f 6578 7072 2e69 6f2e 6864 6620 696d  k_expr.io.hdf im
-00014340: 706f 7274 2074 6f5f 6864 660a 0a20 2020  port to_hdf..   
-00014350: 2020 2020 2072 6574 7572 6e20 746f 5f68       return to_h
-00014360: 6466 2873 656c 662c 2070 6174 685f 6f72  df(self, path_or
-00014370: 5f62 7566 2c20 6b65 792c 206d 6f64 652c  _buf, key, mode,
-00014380: 2061 7070 656e 642c 202a 2a6b 7761 7267   append, **kwarg
-00014390: 7329 0a0a 2020 2020 6465 6620 746f 5f64  s)..    def to_d
-000143a0: 656c 6179 6564 2873 656c 662c 206f 7074  elayed(self, opt
-000143b0: 696d 697a 655f 6772 6170 683d 5472 7565  imize_graph=True
-000143c0: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-000143d0: 6e76 6572 7420 696e 746f 2061 206c 6973  nvert into a lis
-000143e0: 7420 6f66 2060 6064 6173 6b2e 6465 6c61  t of ``dask.dela
-000143f0: 7965 6460 6020 6f62 6a65 6374 732c 206f  yed`` objects, o
-00014400: 6e65 2070 6572 2070 6172 7469 7469 6f6e  ne per partition
-00014410: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00014420: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00014430: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00014440: 206f 7074 696d 697a 655f 6772 6170 6820   optimize_graph 
-00014450: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-00014460: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00014470: 5472 7565 205b 6465 6661 756c 745d 2c20  True [default], 
-00014480: 7468 6520 6772 6170 6820 6973 206f 7074  the graph is opt
-00014490: 696d 697a 6564 2062 6566 6f72 6520 636f  imized before co
-000144a0: 6e76 6572 7469 6e67 2069 6e74 6f0a 2020  nverting into.  
-000144b0: 2020 2020 2020 2020 2020 6060 6461 736b            ``dask
-000144c0: 2e64 656c 6179 6564 6060 206f 626a 6563  .delayed`` objec
-000144d0: 7473 2e0a 0a20 2020 2020 2020 2045 7861  ts...        Exa
-000144e0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-000144f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-00014500: 3e3e 2070 6172 7469 7469 6f6e 7320 3d20  >> partitions = 
-00014510: 6466 2e74 6f5f 6465 6c61 7965 6428 2920  df.to_delayed() 
-00014520: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00014530: 500a 0a20 2020 2020 2020 2053 6565 2041  P..        See A
-00014540: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00014550: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-00014560: 6b5f 6578 7072 2e66 726f 6d5f 6465 6c61  k_expr.from_dela
-00014570: 7965 640a 2020 2020 2020 2020 2222 220a  yed.        """.
-00014580: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00014590: 656c 662e 746f 5f6c 6567 6163 795f 6461  elf.to_legacy_da
-000145a0: 7461 6672 616d 6528 292e 746f 5f64 656c  taframe().to_del
-000145b0: 6179 6564 286f 7074 696d 697a 655f 6772  ayed(optimize_gr
-000145c0: 6170 683d 6f70 7469 6d69 7a65 5f67 7261  aph=optimize_gra
-000145d0: 7068 290a 0a20 2020 2064 6566 2074 6f5f  ph)..    def to_
-000145e0: 6261 636b 656e 6428 7365 6c66 2c20 6261  backend(self, ba
-000145f0: 636b 656e 643a 2073 7472 207c 204e 6f6e  ckend: str | Non
-00014600: 6520 3d20 4e6f 6e65 2c20 2a2a 6b77 6172  e = None, **kwar
-00014610: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00014620: 4d6f 7665 2074 6f20 6120 6e65 7720 4461  Move to a new Da
-00014630: 7461 4672 616d 6520 6261 636b 656e 640a  taFrame backend.
-00014640: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00014650: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00014660: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2062  ------.        b
-00014670: 6163 6b65 6e64 203a 2073 7472 2c20 4f70  ackend : str, Op
-00014680: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00014690: 2020 2054 6865 206e 616d 6520 6f66 2074     The name of t
-000146a0: 6865 206e 6577 2062 6163 6b65 6e64 2074  he new backend t
-000146b0: 6f20 6d6f 7665 2074 6f2e 2054 6865 2064  o move to. The d
-000146c0: 6566 6175 6c74 0a20 2020 2020 2020 2020  efault.         
-000146d0: 2020 2069 7320 7468 6520 6375 7272 656e     is the curren
-000146e0: 7420 2264 6174 6166 7261 6d65 2e62 6163  t "dataframe.bac
-000146f0: 6b65 6e64 2220 636f 6e66 6967 7572 6174  kend" configurat
-00014700: 696f 6e2e 0a0a 2020 2020 2020 2020 5265  ion...        Re
-00014710: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00014720: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-00014730: 7461 4672 616d 652c 2053 6572 6965 7320  taFrame, Series 
-00014740: 6f72 2049 6e64 6578 0a20 2020 2020 2020  or Index.       
-00014750: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00014760: 6d20 6461 736b 5f65 7870 722e 5f62 6163  m dask_expr._bac
-00014770: 6b65 6e64 7320 696d 706f 7274 2064 6174  kends import dat
-00014780: 6166 7261 6d65 5f63 7265 6174 696f 6e5f  aframe_creation_
-00014790: 6469 7370 6174 6368 0a0a 2020 2020 2020  dispatch..      
-000147a0: 2020 2320 4765 7420 6465 7369 7265 6420    # Get desired 
-000147b0: 6261 636b 656e 640a 2020 2020 2020 2020  backend.        
-000147c0: 6261 636b 656e 6420 3d20 6261 636b 656e  backend = backen
-000147d0: 6420 6f72 2064 6174 6166 7261 6d65 5f63  d or dataframe_c
-000147e0: 7265 6174 696f 6e5f 6469 7370 6174 6368  reation_dispatch
-000147f0: 2e62 6163 6b65 6e64 0a20 2020 2020 2020  .backend.       
-00014800: 2023 2043 6865 636b 2074 6861 7420 2262   # Check that "b
-00014810: 6163 6b65 6e64 2220 6861 7320 6120 7265  ackend" has a re
-00014820: 6769 7374 6572 6564 2065 6e74 7279 706f  gistered entrypo
-00014830: 696e 740a 2020 2020 2020 2020 6261 636b  int.        back
-00014840: 656e 645f 656e 7472 7970 6f69 6e74 203d  end_entrypoint =
-00014850: 2064 6174 6166 7261 6d65 5f63 7265 6174   dataframe_creat
-00014860: 696f 6e5f 6469 7370 6174 6368 2e64 6973  ion_dispatch.dis
-00014870: 7061 7463 6828 6261 636b 656e 6429 0a20  patch(backend). 
-00014880: 2020 2020 2020 2023 2043 616c 6c20 6044         # Call `D
-00014890: 6174 6146 7261 6d65 4261 636b 656e 6445  ataFrameBackendE
-000148a0: 6e74 7279 706f 696e 742e 746f 5f62 6163  ntrypoint.to_bac
-000148b0: 6b65 6e64 600a 2020 2020 2020 2020 7265  kend`.        re
-000148c0: 7475 726e 2062 6163 6b65 6e64 5f65 6e74  turn backend_ent
-000148d0: 7279 706f 696e 742e 746f 5f62 6163 6b65  rypoint.to_backe
-000148e0: 6e64 2873 656c 662c 202a 2a6b 7761 7267  nd(self, **kwarg
-000148f0: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
-00014900: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00014910: 0a20 2020 2064 6566 2064 6f74 2873 656c  .    def dot(sel
-00014920: 662c 206f 7468 6572 2c20 6d65 7461 3d6e  f, other, meta=n
-00014930: 6f5f 6465 6661 756c 7429 3a0a 2020 2020  o_default):.    
-00014940: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00014950: 7461 6e63 6528 6f74 6865 722c 2046 7261  tance(other, Fra
-00014960: 6d65 4261 7365 293a 0a20 2020 2020 2020  meBase):.       
-00014970: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00014980: 7272 6f72 2822 5468 6520 7365 636f 6e64  rror("The second
-00014990: 206f 7065 7261 6e64 206d 7573 7420 6265   operand must be
-000149a0: 2061 2064 6173 6b20 6461 7461 6672 616d   a dask datafram
-000149b0: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
-000149c0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-000149d0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
-000149e0: 2020 2020 2020 2020 2020 7320 3d20 7365            s = se
-000149f0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00014a00: 7328 4d2e 646f 742c 206f 7468 6572 2c20  s(M.dot, other, 
-00014a10: 6d65 7461 3d6d 6574 6129 0a20 2020 2020  meta=meta).     
-00014a20: 2020 2020 2020 2072 6574 7572 6e20 732e         return s.
-00014a30: 6772 6f75 7062 7928 6279 3d73 2e69 6e64  groupby(by=s.ind
-00014a40: 6578 292e 6170 706c 7928 0a20 2020 2020  ex).apply(.     
-00014a50: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
-00014a60: 6120 783a 2078 2e73 756d 2873 6b69 706e  a x: x.sum(skipn
-00014a70: 613d 4661 6c73 6529 2c20 6d65 7461 3d73  a=False), meta=s
-00014a80: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 790a  ._meta_nonempty.
-00014a90: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00014aa0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00014ab0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00014ac0: 7328 5f64 6f74 5f73 6572 6965 732c 206f  s(_dot_series, o
-00014ad0: 7468 6572 2c20 6d65 7461 3d6d 6574 6129  ther, meta=meta)
-00014ae0: 2e73 756d 2873 6b69 706e 613d 4661 6c73  .sum(skipna=Fals
-00014af0: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
-00014b00: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00014b10: 6d65 290a 2020 2020 6465 6620 7069 7065  me).    def pipe
-00014b20: 2873 656c 662c 2066 756e 632c 202a 6172  (self, func, *ar
-00014b30: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00014b40: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00014b50: 616e 6365 2866 756e 632c 2074 7570 6c65  ance(func, tuple
-00014b60: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-00014b70: 756e 632c 2074 6172 6765 7420 3d20 6675  unc, target = fu
-00014b80: 6e63 0a20 2020 2020 2020 2020 2020 2069  nc.            i
-00014b90: 6620 7461 7267 6574 2069 6e20 6b77 6172  f target in kwar
-00014ba0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00014bb0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00014bc0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00014bd0: 2020 2020 2020 2020 2020 2225 7320 6973            "%s is
-00014be0: 2062 6f74 6820 7468 6520 7069 7065 2074   both the pipe t
-00014bf0: 6172 6765 7420 616e 6420 6120 6b65 7977  arget and a keyw
-00014c00: 6f72 6420 6172 6775 6d65 6e74 2220 2520  ord argument" % 
-00014c10: 7461 7267 6574 0a20 2020 2020 2020 2020  target.         
-00014c20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00014c30: 2020 2020 206b 7761 7267 735b 7461 7267       kwargs[targ
-00014c40: 6574 5d20 3d20 7365 6c66 0a20 2020 2020  et] = self.     
-00014c50: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
-00014c60: 6e63 282a 6172 6773 2c20 2a2a 6b77 6172  nc(*args, **kwar
-00014c70: 6773 290a 2020 2020 2020 2020 656c 7365  gs).        else
-00014c80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00014c90: 7475 726e 2066 756e 6328 7365 6c66 2c20  turn func(self, 
-00014ca0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00014cb0: 0a0a 2020 2020 6465 6620 7361 6d70 6c65  ..    def sample
-00014cc0: 2873 656c 662c 206e 3d4e 6f6e 652c 2066  (self, n=None, f
-00014cd0: 7261 633d 4e6f 6e65 2c20 7265 706c 6163  rac=None, replac
-00014ce0: 653d 4661 6c73 652c 2072 616e 646f 6d5f  e=False, random_
-00014cf0: 7374 6174 653d 4e6f 6e65 293a 0a20 2020  state=None):.   
-00014d00: 2020 2020 2022 2222 5261 6e64 6f6d 2073       """Random s
-00014d10: 616d 706c 6520 6f66 2069 7465 6d73 0a0a  ample of items..
-00014d20: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00014d30: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00014d40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6e20  -----.        n 
-00014d50: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
-00014d60: 2020 2020 2020 2020 2020 2020 4e75 6d62              Numb
-00014d70: 6572 206f 6620 6974 656d 7320 746f 2072  er of items to r
-00014d80: 6574 7572 6e20 6973 206e 6f74 2073 7570  eturn is not sup
-00014d90: 706f 7274 6564 2062 7920 6461 736b 2e20  ported by dask. 
-00014da0: 5573 6520 6672 6163 0a20 2020 2020 2020  Use frac.       
-00014db0: 2020 2020 2069 6e73 7465 6164 2e0a 2020       instead..  
-00014dc0: 2020 2020 2020 6672 6163 203a 2066 6c6f        frac : flo
-00014dd0: 6174 2c20 6f70 7469 6f6e 616c 0a20 2020  at, optional.   
-00014de0: 2020 2020 2020 2020 2041 7070 726f 7869           Approxi
-00014df0: 6d61 7465 2066 7261 6374 696f 6e20 6f66  mate fraction of
-00014e00: 2069 7465 6d73 2074 6f20 7265 7475 726e   items to return
-00014e10: 2e20 5468 6973 2073 616d 706c 696e 6720  . This sampling 
-00014e20: 6672 6163 7469 6f6e 2069 730a 2020 2020  fraction is.    
-00014e30: 2020 2020 2020 2020 6170 706c 6965 6420          applied 
-00014e40: 746f 2061 6c6c 2070 6172 7469 7469 6f6e  to all partition
-00014e50: 7320 6571 7561 6c6c 792e 204e 6f74 6520  s equally. Note 
-00014e60: 7468 6174 2074 6869 7320 6973 2061 6e0a  that this is an.
-00014e70: 2020 2020 2020 2020 2020 2020 2a2a 6170              **ap
-00014e80: 7072 6f78 696d 6174 6520 6672 6163 7469  proximate fracti
-00014e90: 6f6e 2a2a 2e20 596f 7520 7368 6f75 6c64  on**. You should
-00014ea0: 206e 6f74 2065 7870 6563 7420 6578 6163   not expect exac
-00014eb0: 746c 7920 6060 6c65 6e28 6466 2920 2a20  tly ``len(df) * 
-00014ec0: 6672 6163 6060 0a20 2020 2020 2020 2020  frac``.         
-00014ed0: 2020 2069 7465 6d73 2074 6f20 6265 2072     items to be r
-00014ee0: 6574 7572 6e65 642c 2061 7320 7468 6520  eturned, as the 
-00014ef0: 6578 6163 7420 6e75 6d62 6572 206f 6620  exact number of 
-00014f00: 656c 656d 656e 7473 2073 656c 6563 7465  elements selecte
-00014f10: 6420 7769 6c6c 0a20 2020 2020 2020 2020  d will.         
-00014f20: 2020 2064 6570 656e 6420 6f6e 2068 6f77     depend on how
-00014f30: 2079 6f75 7220 6461 7461 2069 7320 7061   your data is pa
-00014f40: 7274 6974 696f 6e65 6420 2862 7574 2073  rtitioned (but s
-00014f50: 686f 756c 6420 6265 2070 7265 7474 7920  hould be pretty 
-00014f60: 636c 6f73 650a 2020 2020 2020 2020 2020  close.          
-00014f70: 2020 696e 2070 7261 6374 6963 6529 2e0a    in practice)..
-00014f80: 2020 2020 2020 2020 7265 706c 6163 6520          replace 
-00014f90: 3a20 626f 6f6c 6561 6e2c 206f 7074 696f  : boolean, optio
-00014fa0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00014fb0: 5361 6d70 6c65 2077 6974 6820 6f72 2077  Sample with or w
-00014fc0: 6974 686f 7574 2072 6570 6c61 6365 6d65  ithout replaceme
-00014fd0: 6e74 2e20 4465 6661 756c 7420 3d20 4661  nt. Default = Fa
-00014fe0: 6c73 652e 0a20 2020 2020 2020 2072 616e  lse..        ran
-00014ff0: 646f 6d5f 7374 6174 6520 3a20 696e 7420  dom_state : int 
-00015000: 6f72 2060 606e 702e 7261 6e64 6f6d 2e52  or ``np.random.R
-00015010: 616e 646f 6d53 7461 7465 6060 0a20 2020  andomState``.   
-00015020: 2020 2020 2020 2020 2049 6620 616e 2069           If an i
-00015030: 6e74 2c20 7765 2063 7265 6174 6520 6120  nt, we create a 
-00015040: 6e65 7720 5261 6e64 6f6d 5374 6174 6520  new RandomState 
-00015050: 7769 7468 2074 6869 7320 6173 2074 6865  with this as the
-00015060: 2073 6565 643b 0a20 2020 2020 2020 2020   seed;.         
-00015070: 2020 204f 7468 6572 7769 7365 2077 6520     Otherwise we 
-00015080: 6472 6177 2066 726f 6d20 7468 6520 7061  draw from the pa
-00015090: 7373 6564 2052 616e 646f 6d53 7461 7465  ssed RandomState
-000150a0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-000150b0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-000150c0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
-000150d0: 6146 7261 6d65 2e72 616e 646f 6d5f 7370  aFrame.random_sp
-000150e0: 6c69 740a 2020 2020 2020 2020 7061 6e64  lit.        pand
-000150f0: 6173 2e44 6174 6146 7261 6d65 2e73 616d  as.DataFrame.sam
-00015100: 706c 650a 2020 2020 2020 2020 2222 220a  ple.        """.
-00015110: 2020 2020 2020 2020 6966 206e 2069 7320          if n is 
-00015120: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00015130: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
-00015140: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00015150: 616d 706c 6520 646f 6573 206e 6f74 2073  ample does not s
-00015160: 7570 706f 7274 2074 6865 206e 756d 6265  upport the numbe
-00015170: 7220 6f66 2073 616d 706c 6564 2069 7465  r of sampled ite
-00015180: 6d73 2022 0a20 2020 2020 2020 2020 2020  ms ".           
-00015190: 2020 2020 2022 7061 7261 6d65 7465 722c       "parameter,
-000151a0: 2027 6e27 2e20 506c 6561 7365 2075 7365   'n'. Please use
-000151b0: 2074 6865 2027 6672 6163 2720 7061 7261   the 'frac' para
-000151c0: 6d65 7465 7220 696e 7374 6561 642e 220a  meter instead.".
-000151d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000151e0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-000151f0: 6e73 7461 6e63 6528 6e2c 204e 756d 6265  nstance(n, Numbe
-00015200: 7229 2061 6e64 2030 203c 3d20 6e20 3c3d  r) and 0 <= n <=
-00015210: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00015220: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00015230: 6e28 6d73 6729 0a20 2020 2020 2020 2020  n(msg).         
-00015240: 2020 2020 2020 2066 7261 6320 3d20 6e0a         frac = n.
-00015250: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00015260: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015270: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00015280: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
-00015290: 2069 6620 6672 6163 2069 7320 4e6f 6e65   if frac is None
-000152a0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000152b0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-000152c0: 6672 6163 206d 7573 7420 6e6f 7420 6265  frac must not be
-000152d0: 204e 6f6e 6522 290a 0a20 2020 2020 2020   None")..       
-000152e0: 2069 6620 7261 6e64 6f6d 5f73 7461 7465   if random_state
-000152f0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00015300: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-00015310: 7465 203d 206e 702e 7261 6e64 6f6d 2e52  te = np.random.R
-00015320: 616e 646f 6d53 7461 7465 2829 0a0a 2020  andomState()..  
-00015330: 2020 2020 2020 7374 6174 655f 6461 7461        state_data
-00015340: 203d 2072 616e 646f 6d5f 7374 6174 655f   = random_state_
-00015350: 6461 7461 2873 656c 662e 6e70 6172 7469  data(self.nparti
-00015360: 7469 6f6e 732c 2072 616e 646f 6d5f 7374  tions, random_st
-00015370: 6174 6529 0a20 2020 2020 2020 2072 6574  ate).        ret
-00015380: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-00015390: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-000153a0: 6578 7072 2e53 616d 706c 6528 7365 6c66  expr.Sample(self
-000153b0: 2c20 7374 6174 655f 6461 7461 3d73 7461  , state_data=sta
-000153c0: 7465 5f64 6174 612c 2066 7261 633d 6672  te_data, frac=fr
-000153d0: 6163 2c20 7265 706c 6163 653d 7265 706c  ac, replace=repl
-000153e0: 6163 6529 0a20 2020 2020 2020 2029 0a0a  ace).        )..
-000153f0: 2020 2020 6465 6620 5f72 6570 725f 6461      def _repr_da
-00015400: 7461 2873 656c 6629 3a0a 2020 2020 2020  ta(self):.      
-00015410: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-00015420: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
-00015430: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00015440: 6566 205f 7265 7072 5f64 6976 6973 696f  ef _repr_divisio
-00015450: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00015460: 2020 6e61 6d65 203d 2066 226e 7061 7274    name = f"npart
-00015470: 6974 696f 6e73 3d7b 7365 6c66 2e6e 7061  itions={self.npa
-00015480: 7274 6974 696f 6e73 7d22 0a20 2020 2020  rtitions}".     
-00015490: 2020 2069 6620 7365 6c66 2e6b 6e6f 776e     if self.known
-000154a0: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
-000154b0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-000154c0: 7320 3d20 7064 2e49 6e64 6578 2873 656c  s = pd.Index(sel
-000154d0: 662e 6469 7669 7369 6f6e 732c 206e 616d  f.divisions, nam
-000154e0: 653d 6e61 6d65 290a 2020 2020 2020 2020  e=name).        
-000154f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00015500: 2020 2320 6176 6f69 6420 746f 2062 6520    # avoid to be 
-00015510: 636f 6e76 6572 7465 6420 746f 204e 614e  converted to NaN
-00015520: 0a20 2020 2020 2020 2020 2020 2064 6976  .            div
-00015530: 6973 696f 6e73 203d 2070 642e 496e 6465  isions = pd.Inde
-00015540: 7828 5b22 225d 202a 2028 7365 6c66 2e6e  x([""] * (self.n
-00015550: 7061 7274 6974 696f 6e73 202b 2031 292c  partitions + 1),
-00015560: 206e 616d 653d 6e61 6d65 290a 2020 2020   name=name).    
-00015570: 2020 2020 7265 7475 726e 2064 6976 6973      return divis
-00015580: 696f 6e73 0a0a 0a64 6566 205f 646f 745f  ions...def _dot_
-00015590: 7365 7269 6573 282a 6172 6773 2c20 2a2a  series(*args, **
-000155a0: 6b77 6172 6773 293a 0a20 2020 2023 202e  kwargs):.    # .
-000155b0: 7375 6d28 2920 6973 2069 6e76 6f6b 6564  sum() is invoked
-000155c0: 206f 6e20 6561 6368 2070 6172 7469 7469   on each partiti
-000155d0: 6f6e 2062 6566 6f72 6520 6265 696e 6720  on before being 
-000155e0: 6170 706c 6965 6420 746f 2061 6c6c 0a20  applied to all. 
-000155f0: 2020 2023 2070 6172 7469 7469 6f6e 732e     # partitions.
-00015600: 2054 6865 2072 6574 7572 6e20 7479 7065   The return type
-00015610: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
-00015620: 6265 2061 2073 6572 6965 732c 206e 6f74  be a series, not
-00015630: 2061 206e 756d 7079 206f 626a 6563 740a   a numpy object.
-00015640: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
-00015650: 7365 7269 6573 5f63 6f6e 7374 7275 6374  series_construct
-00015660: 6f72 2861 7267 735b 305d 2928 4d2e 646f  or(args[0])(M.do
-00015670: 7428 2a61 7267 732c 202a 2a6b 7761 7267  t(*args, **kwarg
-00015680: 7329 290a 0a0a 2320 4164 6420 6f70 6572  s))...# Add oper
-00015690: 6174 6f72 2061 7474 7269 6275 7465 730a  ator attributes.
-000156a0: 666f 7220 6f70 2069 6e20 5b0a 2020 2020  for op in [.    
-000156b0: 225f 5f61 6464 5f5f 222c 0a20 2020 2022  "__add__",.    "
-000156c0: 5f5f 7261 6464 5f5f 222c 0a20 2020 2022  __radd__",.    "
-000156d0: 5f5f 7375 625f 5f22 2c0a 2020 2020 225f  __sub__",.    "_
-000156e0: 5f72 7375 625f 5f22 2c0a 2020 2020 225f  _rsub__",.    "_
-000156f0: 5f6d 756c 5f5f 222c 0a20 2020 2022 5f5f  _mul__",.    "__
-00015700: 726d 756c 5f5f 222c 0a20 2020 2022 5f5f  rmul__",.    "__
-00015710: 6d6f 645f 5f22 2c0a 2020 2020 225f 5f72  mod__",.    "__r
-00015720: 6d6f 645f 5f22 2c0a 2020 2020 225f 5f66  mod__",.    "__f
-00015730: 6c6f 6f72 6469 765f 5f22 2c0a 2020 2020  loordiv__",.    
-00015740: 225f 5f72 666c 6f6f 7264 6976 5f5f 222c  "__rfloordiv__",
-00015750: 0a20 2020 2022 5f5f 7472 7565 6469 765f  .    "__truediv_
-00015760: 5f22 2c0a 2020 2020 225f 5f72 7472 7565  _",.    "__rtrue
-00015770: 6469 765f 5f22 2c0a 2020 2020 225f 5f70  div__",.    "__p
-00015780: 6f77 5f5f 222c 0a20 2020 2022 5f5f 7270  ow__",.    "__rp
-00015790: 6f77 5f5f 222c 0a20 2020 2022 5f5f 6c74  ow__",.    "__lt
-000157a0: 5f5f 222c 0a20 2020 2022 5f5f 726c 745f  __",.    "__rlt_
-000157b0: 5f22 2c0a 2020 2020 225f 5f67 745f 5f22  _",.    "__gt__"
-000157c0: 2c0a 2020 2020 225f 5f72 6774 5f5f 222c  ,.    "__rgt__",
-000157d0: 0a20 2020 2022 5f5f 6c65 5f5f 222c 0a20  .    "__le__",. 
-000157e0: 2020 2022 5f5f 726c 655f 5f22 2c0a 2020     "__rle__",.  
-000157f0: 2020 225f 5f67 655f 5f22 2c0a 2020 2020    "__ge__",.    
-00015800: 225f 5f72 6765 5f5f 222c 0a20 2020 2022  "__rge__",.    "
-00015810: 5f5f 6571 5f5f 222c 0a20 2020 2022 5f5f  __eq__",.    "__
-00015820: 6e65 5f5f 222c 0a20 2020 2022 5f5f 616e  ne__",.    "__an
-00015830: 645f 5f22 2c0a 2020 2020 225f 5f72 616e  d__",.    "__ran
-00015840: 645f 5f22 2c0a 2020 2020 225f 5f6f 725f  d__",.    "__or_
-00015850: 5f22 2c0a 2020 2020 225f 5f72 6f72 5f5f  _",.    "__ror__
-00015860: 222c 0a20 2020 2022 5f5f 786f 725f 5f22  ",.    "__xor__"
-00015870: 2c0a 2020 2020 225f 5f72 786f 725f 5f22  ,.    "__rxor__"
-00015880: 2c0a 5d3a 0a20 2020 2073 6574 6174 7472  ,.]:.    setattr
-00015890: 2846 7261 6d65 4261 7365 2c20 6f70 2c20  (FrameBase, op, 
-000158a0: 6675 6e63 746f 6f6c 732e 7061 7274 6961  functools.partia
-000158b0: 6c6d 6574 686f 6428 5f77 7261 705f 6578  lmethod(_wrap_ex
-000158c0: 7072 5f6f 702c 206f 703d 6f70 2929 0a0a  pr_op, op=op))..
-000158d0: 666f 7220 6f70 2069 6e20 5b0a 2020 2020  for op in [.    
-000158e0: 225f 5f69 6e76 6572 745f 5f22 2c0a 2020  "__invert__",.  
-000158f0: 2020 225f 5f6e 6567 5f5f 222c 0a20 2020    "__neg__",.   
-00015900: 2022 5f5f 706f 735f 5f22 2c0a 5d3a 0a20   "__pos__",.]:. 
-00015910: 2020 2073 6574 6174 7472 2846 7261 6d65     setattr(Frame
-00015920: 4261 7365 2c20 6f70 2c20 6675 6e63 746f  Base, op, functo
-00015930: 6f6c 732e 7061 7274 6961 6c6d 6574 686f  ols.partialmetho
-00015940: 6428 5f77 7261 705f 756e 6172 795f 6578  d(_wrap_unary_ex
-00015950: 7072 5f6f 702c 206f 703d 6f70 2929 0a0a  pr_op, op=op))..
-00015960: 0a63 6c61 7373 2044 6174 6146 7261 6d65  .class DataFrame
-00015970: 2846 7261 6d65 4261 7365 293a 0a20 2020  (FrameBase):.   
-00015980: 2022 2222 4461 7461 4672 616d 652d 6c69   """DataFrame-li
-00015990: 6b65 2045 7870 7220 436f 6c6c 6563 7469  ke Expr Collecti
-000159a0: 6f6e 2222 220a 0a20 2020 205f 6163 6365  on"""..    _acce
-000159b0: 7373 6f72 733a 2043 6c61 7373 5661 725b  ssors: ClassVar[
-000159c0: 7365 745b 7374 725d 5d20 3d20 7365 7428  set[str]] = set(
-000159d0: 290a 2020 2020 5f70 6172 7469 7469 6f6e  ).    _partition
-000159e0: 5f74 7970 6520 3d20 7064 2e44 6174 6146  _type = pd.DataF
-000159f0: 7261 6d65 0a0a 2020 2020 4070 726f 7065  rame..    @prope
-00015a00: 7274 790a 2020 2020 6465 6620 7368 6170  rty.    def shap
-00015a10: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00015a20: 2072 6574 7572 6e20 7365 6c66 2e73 697a   return self.siz
-00015a30: 6520 2f20 6d61 7828 6c65 6e28 7365 6c66  e / max(len(self
-00015a40: 2e63 6f6c 756d 6e73 292c 2031 292c 206c  .columns), 1), l
-00015a50: 656e 2873 656c 662e 636f 6c75 6d6e 7329  en(self.columns)
-00015a60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00015a70: 2020 2020 6465 6620 6e64 696d 2873 656c      def ndim(sel
-00015a80: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00015a90: 6574 7572 6e20 6469 6d65 6e73 696f 6e61  eturn dimensiona
-00015aa0: 6c69 7479 2222 220a 2020 2020 2020 2020  lity""".        
-00015ab0: 7265 7475 726e 2032 0a0a 2020 2020 4070  return 2..    @p
-00015ac0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00015ad0: 656d 7074 7928 7365 6c66 293a 0a20 2020  empty(self):.   
-00015ae0: 2020 2020 2023 205f 5f67 6574 6174 7472       # __getattr
-00015af0: 5f5f 2077 696c 6c20 6265 2063 616c 6c65  __ will be calle
-00015b00: 6420 6166 7465 7220 7765 2072 6169 7365  d after we raise
-00015b10: 2074 6869 732c 2073 6f20 7765 276c 6c20   this, so we'll 
-00015b20: 7261 6973 6520 6974 2061 6761 696e 2066  raise it again f
-00015b30: 726f 6d20 7468 6572 650a 2020 2020 2020  rom there.      
-00015b40: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
-00015b50: 654e 6f74 496d 706c 656d 656e 7465 6445  eNotImplementedE
-00015b60: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00015b70: 2020 2243 6865 636b 696e 6720 7768 6574    "Checking whet
-00015b80: 6865 7220 6120 4461 736b 2044 6174 6146  her a Dask DataF
-00015b90: 7261 6d65 2068 6173 2061 6e79 2072 6f77  rame has any row
-00015ba0: 7320 6d61 7920 6265 2065 7870 656e 7369  s may be expensi
-00015bb0: 7665 2e20 220a 2020 2020 2020 2020 2020  ve. ".          
-00015bc0: 2020 2248 6f77 6576 6572 2c20 6368 6563    "However, chec
-00015bd0: 6b69 6e67 2074 6865 206e 756d 6265 7220  king the number 
-00015be0: 6f66 2063 6f6c 756d 6e73 2069 7320 6661  of columns is fa
-00015bf0: 7374 2e20 220a 2020 2020 2020 2020 2020  st. ".          
-00015c00: 2020 2244 6570 656e 6469 6e67 206f 6e20    "Depending on 
-00015c10: 7768 6963 6820 6f66 2074 6865 7365 2072  which of these r
-00015c20: 6573 756c 7473 2079 6f75 206e 6565 642c  esults you need,
-00015c30: 2075 7365 2065 6974 6865 7220 220a 2020   use either ".  
-00015c40: 2020 2020 2020 2020 2020 2260 6c65 6e28            "`len(
-00015c50: 6466 2e69 6e64 6578 2920 3d3d 2030 6020  df.index) == 0` 
-00015c60: 6f72 2060 6c65 6e28 6466 2e63 6f6c 756d  or `len(df.colum
-00015c70: 6e73 2920 3d3d 2030 6022 0a20 2020 2020  ns) == 0`".     
-00015c80: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-00015c90: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00015ca0: 7261 6d65 290a 2020 2020 6465 6620 6974  rame).    def it
-00015cb0: 656d 7328 7365 6c66 293a 0a20 2020 2020  ems(self):.     
-00015cc0: 2020 2066 6f72 2069 2c20 6e61 6d65 2069     for i, name i
-00015cd0: 6e20 656e 756d 6572 6174 6528 7365 6c66  n enumerate(self
-00015ce0: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
-00015cf0: 2020 2020 2020 2079 6965 6c64 2028 6e61         yield (na
-00015d00: 6d65 2c20 7365 6c66 2e69 6c6f 635b 3a2c  me, self.iloc[:,
-00015d10: 2069 5d29 0a0a 2020 2020 4070 726f 7065   i])..    @prope
-00015d20: 7274 790a 2020 2020 6465 6620 6178 6573  rty.    def axes
-00015d30: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00015d40: 7265 7475 726e 205b 7365 6c66 2e69 6e64  return [self.ind
-00015d50: 6578 2c20 7365 6c66 2e63 6f6c 756d 6e73  ex, self.columns
-00015d60: 5d0a 0a20 2020 2064 6566 205f 5f63 6f6e  ]..    def __con
-00015d70: 7461 696e 735f 5f28 7365 6c66 2c20 6b65  tains__(self, ke
-00015d80: 7929 3a0a 2020 2020 2020 2020 7265 7475  y):.        retu
-00015d90: 726e 206b 6579 2069 6e20 7365 6c66 2e5f  rn key in self._
-00015da0: 6d65 7461 0a0a 2020 2020 6465 6620 5f5f  meta..    def __
-00015db0: 6974 6572 5f5f 2873 656c 6629 3a0a 2020  iter__(self):.  
-00015dc0: 2020 2020 2020 7265 7475 726e 2069 7465        return ite
-00015dd0: 7228 7365 6c66 2e5f 6d65 7461 290a 0a20  r(self._meta).. 
-00015de0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00015df0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00015e00: 2020 2064 6566 2069 7465 7272 6f77 7328     def iterrows(
-00015e10: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
-00015e20: 7261 6d65 203d 2073 656c 662e 6f70 7469  rame = self.opti
-00015e30: 6d69 7a65 2829 0a20 2020 2020 2020 2066  mize().        f
-00015e40: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
-00015e50: 6c66 2e6e 7061 7274 6974 696f 6e73 293a  lf.npartitions):
-00015e60: 0a20 2020 2020 2020 2020 2020 2064 6620  .            df 
-00015e70: 3d20 6672 616d 652e 6765 745f 7061 7274  = frame.get_part
-00015e80: 6974 696f 6e28 6929 2e63 6f6d 7075 7465  ition(i).compute
-00015e90: 2829 0a20 2020 2020 2020 2020 2020 2079  ().            y
-00015ea0: 6965 6c64 2066 726f 6d20 6466 2e69 7465  ield from df.ite
-00015eb0: 7272 6f77 7328 290a 0a20 2020 2040 6465  rrows()..    @de
-00015ec0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00015ed0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00015ee0: 2069 7465 7274 7570 6c65 7328 7365 6c66   itertuples(self
-00015ef0: 2c20 696e 6465 783d 5472 7565 2c20 6e61  , index=True, na
-00015f00: 6d65 3d22 5061 6e64 6173 2229 3a0a 2020  me="Pandas"):.  
-00015f10: 2020 2020 2020 6672 616d 6520 3d20 7365        frame = se
-00015f20: 6c66 2e6f 7074 696d 697a 6528 290a 2020  lf.optimize().  
-00015f30: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00015f40: 616e 6765 2873 656c 662e 6e70 6172 7469  ange(self.nparti
-00015f50: 7469 6f6e 7329 3a0a 2020 2020 2020 2020  tions):.        
-00015f60: 2020 2020 6466 203d 2066 7261 6d65 2e67      df = frame.g
-00015f70: 6574 5f70 6172 7469 7469 6f6e 2869 292e  et_partition(i).
-00015f80: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
-00015f90: 2020 2020 2020 7969 656c 6420 6672 6f6d        yield from
-00015fa0: 2064 662e 6974 6572 7475 706c 6573 2869   df.itertuples(i
-00015fb0: 6e64 6578 3d69 6e64 6578 2c20 6e61 6d65  ndex=index, name
-00015fc0: 3d6e 616d 6529 0a0a 2020 2020 4070 726f  =name)..    @pro
-00015fd0: 7065 7274 790a 2020 2020 6465 6620 5f65  perty.    def _e
-00015fe0: 6c65 6d77 6973 6528 7365 6c66 293a 0a20  lemwise(self):. 
-00015ff0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-00016000: 656d 7769 7365 0a0a 2020 2020 6465 6620  emwise..    def 
-00016010: 5f5f 6172 7261 795f 7566 756e 635f 5f28  __array_ufunc__(
-00016020: 7365 6c66 2c20 6e75 6d70 795f 7566 756e  self, numpy_ufun
-00016030: 632c 206d 6574 686f 642c 202a 696e 7075  c, method, *inpu
-00016040: 7473 2c20 2a2a 6b77 6172 6773 293a 0a20  ts, **kwargs):. 
-00016050: 2020 2020 2020 206f 7574 203d 206b 7761         out = kwa
-00016060: 7267 732e 6765 7428 226f 7574 222c 2028  rgs.get("out", (
-00016070: 2929 0a20 2020 2020 2020 2066 6f72 2078  )).        for x
-00016080: 2069 6e20 696e 7075 7473 202b 206f 7574   in inputs + out
-00016090: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-000160a0: 7566 756e 6373 2077 6f72 6b20 7769 7468  ufuncs work with
-000160b0: 2030 2d64 696d 656e 7369 6f6e 616c 204e   0-dimensional N
-000160c0: 756d 5079 206e 6461 7272 6179 730a 2020  umPy ndarrays.  
-000160d0: 2020 2020 2020 2020 2020 2320 736f 2077            # so w
-000160e0: 6520 646f 6e27 7420 7761 6e74 2074 6f20  e don't want to 
-000160f0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00016100: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
-00016110: 2069 6620 6973 696e 7374 616e 6365 2878   if isinstance(x
-00016120: 2c20 6e70 2e6e 6461 7272 6179 2920 616e  , np.ndarray) an
-00016130: 6420 782e 7368 6170 6520 3d3d 2028 293a  d x.shape == ():
-00016140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016150: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
-00016160: 2020 2020 2020 656c 6966 206e 6f74 2069        elif not i
-00016170: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
-00016180: 2020 2020 2020 2020 2020 2078 2c20 284e             x, (N
-00016190: 756d 6265 722c 2053 6361 6c61 722c 2046  umber, Scalar, F
-000161a0: 7261 6d65 4261 7365 2c20 4172 7261 792c  rameBase, Array,
-000161b0: 2070 642e 4461 7461 4672 616d 652c 2070   pd.DataFrame, p
-000161c0: 642e 5365 7269 6573 2c20 7064 2e49 6e64  d.Series, pd.Ind
-000161d0: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
-000161e0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000161f0: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
-00016200: 6c65 6d65 6e74 6564 0a0a 2020 2020 2020  lemented..      
-00016210: 2020 6966 206d 6574 686f 6420 3d3d 2022    if method == "
-00016220: 5f5f 6361 6c6c 5f5f 223a 0a20 2020 2020  __call__":.     
-00016230: 2020 2020 2020 2069 6620 6e75 6d70 795f         if numpy_
-00016240: 7566 756e 632e 7369 676e 6174 7572 6520  ufunc.signature 
-00016250: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00016260: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00016270: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-00016280: 6564 0a20 2020 2020 2020 2020 2020 2069  ed.            i
-00016290: 6620 6e75 6d70 795f 7566 756e 632e 6e6f  f numpy_ufunc.no
-000162a0: 7574 203e 2031 3a0a 2020 2020 2020 2020  ut > 1:.        
-000162b0: 2020 2020 2020 2020 2320 7566 756e 6373          # ufuncs
-000162c0: 2077 6974 6820 6d75 6c74 6970 6c65 206f   with multiple o
-000162d0: 7574 7075 7420 7661 6c75 6573 0a20 2020  utput values.   
-000162e0: 2020 2020 2020 2020 2020 2020 2023 2061               # a
-000162f0: 7265 206e 6f74 2079 6574 2073 7570 706f  re not yet suppo
-00016300: 7274 6564 2066 6f72 2066 7261 6d65 730a  rted for frames.
-00016310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016320: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
-00016330: 656e 7465 640a 2020 2020 2020 2020 2020  ented.          
-00016340: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00016350: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00016360: 6c65 6d77 6973 6528 6e75 6d70 795f 7566  lemwise(numpy_uf
-00016370: 756e 632c 202a 696e 7075 7473 2c20 2a2a  unc, *inputs, **
-00016380: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
-00016390: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000163a0: 2020 2320 7566 756e 6320 6d65 7468 6f64    # ufunc method
-000163b0: 7320 6172 6520 6e6f 7420 7965 7420 7375  s are not yet su
-000163c0: 7070 6f72 7465 6420 666f 7220 6672 616d  pported for fram
-000163d0: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
-000163e0: 6574 7572 6e20 4e6f 7449 6d70 6c65 6d65  eturn NotImpleme
-000163f0: 6e74 6564 0a0a 2020 2020 6465 6620 5f5f  nted..    def __
-00016400: 6172 7261 795f 7772 6170 5f5f 2873 656c  array_wrap__(sel
-00016410: 662c 2061 7272 6179 2c20 636f 6e74 6578  f, array, contex
-00016420: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00016430: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
-00016440: 6f6e 7465 7874 2c20 7475 706c 6529 2061  ontext, tuple) a
-00016450: 6e64 206c 656e 2863 6f6e 7465 7874 2920  nd len(context) 
-00016460: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-00016470: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
-00016480: 6f6e 7465 7874 5b31 5d5b 305d 2c20 6e70  ontext[1][0], np
-00016490: 2e6e 6461 7272 6179 2920 616e 6420 636f  .ndarray) and co
-000164a0: 6e74 6578 745b 315d 5b30 5d2e 7368 6170  ntext[1][0].shap
-000164b0: 6520 3d3d 2028 293a 0a20 2020 2020 2020  e == ():.       
-000164c0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
-000164d0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-000164e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000164f0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-00016500: 636f 6e74 6578 745b 315d 5b30 5d2e 696e  context[1][0].in
-00016510: 6465 780a 2020 2020 2020 2020 656c 7365  dex.        else
-00016520: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
-00016530: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00016540: 2020 2069 6d70 6f72 7420 696e 7370 6563     import inspec
-00016550: 740a 0a20 2020 2020 2020 2020 2020 2020  t..             
-00016560: 2020 206d 6574 686f 645f 6e61 6d65 203d     method_name =
-00016570: 2066 2260 7b69 6e73 7065 6374 2e73 7461   f"`{inspect.sta
-00016580: 636b 2829 5b33 5d5b 335d 7d60 220a 2020  ck()[3][3]}`".  
-00016590: 2020 2020 2020 2020 2020 6578 6365 7074            except
-000165a0: 2049 6e64 6578 4572 726f 723a 0a20 2020   IndexError:.   
-000165b0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-000165c0: 686f 645f 6e61 6d65 203d 2022 5468 6973  hod_name = "This
-000165d0: 206d 6574 686f 6422 0a0a 2020 2020 2020   method"..      
-000165e0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-000165f0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-00016600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016610: 2066 227b 6d65 7468 6f64 5f6e 616d 657d   f"{method_name}
-00016620: 2069 7320 6e6f 7420 696d 706c 656d 656e   is not implemen
-00016630: 7465 6420 666f 7220 6064 6173 6b2e 6461  ted for `dask.da
-00016640: 7461 6672 616d 652e 4461 7461 4672 616d  taframe.DataFram
-00016650: 6560 2e22 0a20 2020 2020 2020 2020 2020  e`.".           
-00016660: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-00016670: 726e 206d 6574 615f 6672 616d 655f 636f  rn meta_frame_co
-00016680: 6e73 7472 7563 746f 7228 7365 6c66 2928  nstructor(self)(
-00016690: 6172 7261 792c 2069 6e64 6578 3d69 6e64  array, index=ind
-000166a0: 6578 2c20 636f 6c75 6d6e 733d 7365 6c66  ex, columns=self
-000166b0: 2e63 6f6c 756d 6e73 290a 0a20 2020 2064  .columns)..    d
-000166c0: 6566 205f 6970 7974 686f 6e5f 6b65 795f  ef _ipython_key_
-000166d0: 636f 6d70 6c65 7469 6f6e 735f 2873 656c  completions_(sel
-000166e0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-000166f0: 726e 206d 6574 686f 6473 2e74 6f6c 6973  rn methods.tolis
-00016700: 7428 7365 6c66 2e63 6f6c 756d 6e73 290a  t(self.columns).
-00016710: 0a20 2020 2064 6566 205f 7265 7072 5f68  .    def _repr_h
-00016720: 746d 6c5f 2873 656c 6629 3a0a 2020 2020  tml_(self):.    
-00016730: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00016740: 746f 5f68 746d 6c28 290a 0a20 2020 2040  to_html()..    @
-00016750: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00016760: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00016770: 6566 2061 7373 6967 6e28 7365 6c66 2c20  ef assign(self, 
-00016780: 2a2a 7061 6972 7329 3a0a 2020 2020 2020  **pairs):.      
-00016790: 2020 7265 7375 6c74 203d 2073 656c 660a    result = self.
-000167a0: 2020 2020 2020 2020 6172 6773 203d 205b          args = [
-000167b0: 5d0a 2020 2020 2020 2020 666f 7220 6b2c  ].        for k,
-000167c0: 2076 2069 6e20 7061 6972 732e 6974 656d   v in pairs.item
-000167d0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000167e0: 2076 203d 205f 6d61 7962 655f 6672 6f6d   v = _maybe_from
-000167f0: 5f70 616e 6461 7328 5b76 5d29 5b30 5d0a  _pandas([v])[0].
-00016800: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00016810: 6f74 2069 7369 6e73 7461 6e63 6528 6b2c  ot isinstance(k,
-00016820: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-00016830: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00016840: 6545 7272 6f72 2866 2243 6f6c 756d 6e20  eError(f"Column 
-00016850: 6e61 6d65 2063 616e 6e6f 7420 6265 2074  name cannot be t
-00016860: 7970 6520 7b74 7970 6528 6b29 7d22 290a  ype {type(k)}").
-00016870: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016880: 6361 6c6c 6162 6c65 2876 293a 0a20 2020  callable(v):.   
-00016890: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000168a0: 756c 7420 3d20 6e65 775f 636f 6c6c 6563  ult = new_collec
-000168b0: 7469 6f6e 2865 7870 722e 4173 7369 676e  tion(expr.Assign
-000168c0: 2872 6573 756c 742c 202a 6172 6773 2929  (result, *args))
-000168d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000168e0: 2061 7267 7320 3d20 5b5d 0a20 2020 2020   args = [].     
-000168f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00016900: 7420 3d20 6e65 775f 636f 6c6c 6563 7469  t = new_collecti
-00016910: 6f6e 2865 7870 722e 4173 7369 676e 2872  on(expr.Assign(r
-00016920: 6573 756c 742c 206b 2c20 7628 7265 7375  esult, k, v(resu
-00016930: 6c74 2929 290a 2020 2020 2020 2020 2020  lt))).          
-00016940: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
-00016950: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00016960: 2069 7369 6e73 7461 6e63 6528 762c 2028   isinstance(v, (
-00016970: 5363 616c 6172 2c20 5365 7269 6573 2929  Scalar, Series))
-00016980: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016990: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-000169a0: 762c 2053 6572 6965 7329 3a0a 2020 2020  v, Series):.    
-000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169c0: 6966 206e 6f74 2065 7870 722e 6172 655f  if not expr.are_
-000169d0: 636f 5f61 6c69 676e 6564 2872 6573 756c  co_aligned(resul
-000169e0: 742e 6578 7072 2c20 762e 6578 7072 293a  t.expr, v.expr):
-000169f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016a00: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00016a10: 6172 6773 2920 3e20 303a 0a20 2020 2020  args) > 0:.     
-00016a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a30: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00016a40: 6578 7072 2e41 7373 6967 6e28 7265 7375  expr.Assign(resu
-00016a50: 6c74 2c20 2a61 7267 7329 0a20 2020 2020  lt, *args).     
-00016a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a70: 2020 2020 2020 2061 7267 7320 3d20 5b5d         args = []
-00016a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016a90: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00016aa0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-00016ab0: 2865 7870 722e 4173 7369 676e 416c 6967  (expr.AssignAlig
-00016ac0: 6e28 7265 7375 6c74 2c20 6b2c 2076 2e65  n(result, k, v.e
-00016ad0: 7870 7229 290a 2020 2020 2020 2020 2020  xpr)).          
-00016ae0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00016af0: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
-00016b00: 2020 2020 656c 6966 206e 6f74 2069 7369      elif not isi
-00016b10: 6e73 7461 6e63 6528 762c 2046 7261 6d65  nstance(v, Frame
-00016b20: 4261 7365 2920 616e 6420 6973 696e 7374  Base) and isinst
-00016b30: 616e 6365 2876 2c20 4861 7368 6162 6c65  ance(v, Hashable
-00016b40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00016b50: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
-00016b60: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00016b70: 6e63 6528 762c 2041 7272 6179 293a 0a20  nce(v, Array):. 
-00016b80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00016b90: 6620 6c65 6e28 762e 7368 6170 6529 203e  f len(v.shape) >
-00016ba0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00016bb0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00016bc0: 6c75 6545 7272 6f72 2822 4172 7261 7920  lueError("Array 
-00016bd0: 6173 7369 676e 6d65 6e74 206f 6e6c 7920  assignment only 
-00016be0: 7375 7070 6f72 7473 2031 2d44 2061 7272  supports 1-D arr
-00016bf0: 6179 7322 290a 2020 2020 2020 2020 2020  ays").          
-00016c00: 2020 2020 2020 6966 2076 2e6e 7061 7274        if v.npart
-00016c10: 6974 696f 6e73 2021 3d20 7265 7375 6c74  itions != result
-00016c20: 2e6e 7061 7274 6974 696f 6e73 3a0a 2020  .npartitions:.  
-00016c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c40: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00016c50: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00016c60: 2020 2020 2020 2020 2020 2020 224e 756d              "Num
-00016c70: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-00016c80: 7320 646f 206e 6f74 206d 6174 6368 2022  s do not match "
-00016c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016ca0: 2020 2020 2020 2020 2066 2228 7b76 2e6e           f"({v.n
-00016cb0: 7061 7274 6974 696f 6e73 7d20 213d 207b  partitions} != {
-00016cc0: 7265 7375 6c74 2e6e 7061 7274 6974 696f  result.npartitio
-00016cd0: 6e73 7d29 220a 2020 2020 2020 2020 2020  ns})".          
-00016ce0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00016cf0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
-00016d00: 6672 6f6d 5f64 6173 6b5f 6172 7261 7928  from_dask_array(
-00016d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016d20: 2020 2020 2076 2c20 696e 6465 783d 7265       v, index=re
-00016d30: 7375 6c74 2e69 6e64 6578 2e74 6f5f 6c65  sult.index.to_le
-00016d40: 6761 6379 5f64 6174 6166 7261 6d65 2829  gacy_dataframe()
-00016d50: 2c20 6d65 7461 3d72 6573 756c 742e 5f6d  , meta=result._m
-00016d60: 6574 610a 2020 2020 2020 2020 2020 2020  eta.            
-00016d70: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00016d80: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00016d90: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00016da0: 7065 4572 726f 7228 6622 436f 6c75 6d6e  peError(f"Column
-00016db0: 2061 7373 6967 6e6d 656e 7420 646f 6573   assignment does
-00016dc0: 6e27 7420 7375 7070 6f72 7420 7479 7065  n't support type
-00016dd0: 207b 7479 7065 2876 297d 2229 0a20 2020   {type(v)}").   
-00016de0: 2020 2020 2020 2020 2061 7267 732e 6578           args.ex
-00016df0: 7465 6e64 285b 6b2c 2076 5d29 0a0a 2020  tend([k, v])..  
-00016e00: 2020 2020 2020 6966 206c 656e 2861 7267        if len(arg
-00016e10: 7329 203e 2030 3a0a 2020 2020 2020 2020  s) > 0:.        
-00016e20: 2020 2020 7265 7375 6c74 203d 206e 6577      result = new
-00016e30: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
-00016e40: 2e41 7373 6967 6e28 7265 7375 6c74 2c20  .Assign(result, 
-00016e50: 2a61 7267 7329 290a 0a20 2020 2020 2020  *args))..       
-00016e60: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
-00016e70: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00016e80: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00016e90: 2020 2020 6465 6620 636c 6970 2873 656c      def clip(sel
-00016ea0: 662c 206c 6f77 6572 3d4e 6f6e 652c 2075  f, lower=None, u
-00016eb0: 7070 6572 3d4e 6f6e 652c 2061 7869 733d  pper=None, axis=
-00016ec0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
-00016ed0: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-00016ee0: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-00016ef0: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-00016f00: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-00016f10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00016f20: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-00016f30: 6974 696f 6e73 284d 2e63 6c69 702c 206c  itions(M.clip, l
-00016f40: 6f77 6572 2c20 7570 7065 722c 2061 7869  ower, upper, axi
-00016f50: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
-00016f60: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00016f70: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
-00016f80: 636c 6970 286c 6f77 6572 2c20 7570 7065  clip(lower, uppe
-00016f90: 722c 2061 7869 7329 290a 0a20 2020 2064  r, axis))..    d
-00016fa0: 6566 206d 6572 6765 280a 2020 2020 2020  ef merge(.      
-00016fb0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00016fc0: 7269 6768 742c 0a20 2020 2020 2020 2068  right,.        h
-00016fd0: 6f77 3d22 696e 6e65 7222 2c0a 2020 2020  ow="inner",.    
-00016fe0: 2020 2020 6f6e 3d4e 6f6e 652c 0a20 2020      on=None,.   
-00016ff0: 2020 2020 206c 6566 745f 6f6e 3d4e 6f6e       left_on=Non
-00017000: 652c 0a20 2020 2020 2020 2072 6967 6874  e,.        right
-00017010: 5f6f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  _on=None,.      
-00017020: 2020 6c65 6674 5f69 6e64 6578 3d46 616c    left_index=Fal
-00017030: 7365 2c0a 2020 2020 2020 2020 7269 6768  se,.        righ
-00017040: 745f 696e 6465 783d 4661 6c73 652c 0a20  t_index=False,. 
-00017050: 2020 2020 2020 2073 7566 6669 7865 733d         suffixes=
-00017060: 2822 5f78 222c 2022 5f79 2229 2c0a 2020  ("_x", "_y"),.  
-00017070: 2020 2020 2020 696e 6469 6361 746f 723d        indicator=
-00017080: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
-00017090: 6875 6666 6c65 5f6d 6574 686f 643d 4e6f  huffle_method=No
-000170a0: 6e65 2c0a 2020 2020 2020 2020 6e70 6172  ne,.        npar
-000170b0: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
-000170c0: 2020 2020 2020 6272 6f61 6463 6173 743d        broadcast=
-000170d0: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-000170e0: 2020 2020 2022 2222 4d65 7267 6520 7468       """Merge th
-000170f0: 6520 4461 7461 4672 616d 6520 7769 7468  e DataFrame with
-00017100: 2061 6e6f 7468 6572 2044 6174 6146 7261   another DataFra
-00017110: 6d65 0a0a 2020 2020 2020 2020 5468 6973  me..        This
-00017120: 2077 696c 6c20 6d65 7267 6520 7468 6520   will merge the 
-00017130: 7477 6f20 6461 7461 7365 7473 2c20 6569  two datasets, ei
-00017140: 7468 6572 206f 6e20 7468 6520 696e 6469  ther on the indi
-00017150: 6365 732c 2061 2063 6572 7461 696e 2063  ces, a certain c
-00017160: 6f6c 756d 6e0a 2020 2020 2020 2020 696e  olumn.        in
-00017170: 2065 6163 6820 6461 7461 7365 7420 6f72   each dataset or
-00017180: 2074 6865 2069 6e64 6578 2069 6e20 6f6e   the index in on
-00017190: 6520 6461 7461 7365 7420 616e 6420 7468  e dataset and th
-000171a0: 6520 636f 6c75 6d6e 2069 6e20 616e 6f74  e column in anot
-000171b0: 6865 722e 0a0a 2020 2020 2020 2020 5061  her...        Pa
-000171c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-000171d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000171e0: 2020 2020 7269 6768 743a 2064 6173 6b2e      right: dask.
-000171f0: 6461 7461 6672 616d 652e 4461 7461 4672  dataframe.DataFr
-00017200: 616d 650a 2020 2020 2020 2020 686f 7720  ame.        how 
-00017210: 3a20 7b27 6c65 6674 272c 2027 7269 6768  : {'left', 'righ
-00017220: 7427 2c20 276f 7574 6572 272c 2027 696e  t', 'outer', 'in
-00017230: 6e65 7227 2c20 276c 6566 7473 656d 6927  ner', 'leftsemi'
-00017240: 7d2c 2064 6566 6175 6c74 3a20 2769 6e6e  }, default: 'inn
-00017250: 6572 270a 2020 2020 2020 2020 2020 2020  er'.            
-00017260: 486f 7720 746f 2068 616e 646c 6520 7468  How to handle th
-00017270: 6520 6f70 6572 6174 696f 6e20 6f66 2074  e operation of t
-00017280: 6865 2074 776f 206f 626a 6563 7473 3a0a  he two objects:.
-00017290: 0a20 2020 2020 2020 2020 2020 202d 206c  .            - l
-000172a0: 6566 743a 2075 7365 2063 616c 6c69 6e67  eft: use calling
-000172b0: 2066 7261 6d65 2773 2069 6e64 6578 2028   frame's index (
-000172c0: 6f72 2063 6f6c 756d 6e20 6966 206f 6e20  or column if on 
-000172d0: 6973 2073 7065 6369 6669 6564 290a 2020  is specified).  
-000172e0: 2020 2020 2020 2020 2020 2d20 7269 6768            - righ
-000172f0: 743a 2075 7365 206f 7468 6572 2066 7261  t: use other fra
-00017300: 6d65 2773 2069 6e64 6578 0a20 2020 2020  me's index.     
-00017310: 2020 2020 2020 202d 206f 7574 6572 3a20         - outer: 
-00017320: 666f 726d 2075 6e69 6f6e 206f 6620 6361  form union of ca
-00017330: 6c6c 696e 6720 6672 616d 6527 7320 696e  lling frame's in
-00017340: 6465 7820 286f 7220 636f 6c75 6d6e 2069  dex (or column i
-00017350: 6620 6f6e 2069 730a 2020 2020 2020 2020  f on is.        
-00017360: 2020 2020 2020 7370 6563 6966 6965 6429        specified)
-00017370: 2077 6974 6820 6f74 6865 7220 6672 616d   with other fram
-00017380: 6527 7320 696e 6465 782c 2061 6e64 2073  e's index, and s
-00017390: 6f72 7420 6974 0a20 2020 2020 2020 2020  ort it.         
-000173a0: 2020 2020 206c 6578 6963 6f67 7261 7068       lexicograph
-000173b0: 6963 616c 6c79 0a20 2020 2020 2020 2020  ically.         
-000173c0: 2020 202d 2069 6e6e 6572 3a20 666f 726d     - inner: form
-000173d0: 2069 6e74 6572 7365 6374 696f 6e20 6f66   intersection of
-000173e0: 2063 616c 6c69 6e67 2066 7261 6d65 2773   calling frame's
-000173f0: 2069 6e64 6578 2028 6f72 2063 6f6c 756d   index (or colum
-00017400: 6e20 6966 0a20 2020 2020 2020 2020 2020  n if.           
-00017410: 2020 206f 6e20 6973 2073 7065 6369 6669     on is specifi
-00017420: 6564 2920 7769 7468 206f 7468 6572 2066  ed) with other f
-00017430: 7261 6d65 2773 2069 6e64 6578 2c20 7072  rame's index, pr
-00017440: 6573 6572 7669 6e67 2074 6865 206f 7264  eserving the ord
-00017450: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
-00017460: 206f 6620 7468 6520 6361 6c6c 696e 6727   of the calling'
-00017470: 7320 6f6e 650a 2020 2020 2020 2020 2020  s one.          
-00017480: 2020 2d20 6c65 6674 7365 6d69 3a20 4368    - leftsemi: Ch
-00017490: 6f6f 7365 2061 6c6c 2072 6f77 7320 696e  oose all rows in
-000174a0: 206c 6566 7420 7768 6572 6520 7468 6520   left where the 
-000174b0: 6a6f 696e 206b 6579 7320 6361 6e20 6265  join keys can be
-000174c0: 2066 6f75 6e64 0a20 2020 2020 2020 2020   found.         
-000174d0: 2020 2020 2069 6e20 7269 6768 742e 2057       in right. W
-000174e0: 6f6e 2774 2064 7570 6c69 6361 7465 2072  on't duplicate r
-000174f0: 6f77 7320 6966 2074 6865 206b 6579 7320  ows if the keys 
-00017500: 6172 6520 6475 706c 6963 6174 6564 2069  are duplicated i
-00017510: 6e20 7269 6768 742e 0a20 2020 2020 2020  n right..       
-00017520: 2020 2020 2020 2044 726f 7073 2061 6c6c         Drops all
-00017530: 2063 6f6c 756d 6e73 2066 726f 6d20 7269   columns from ri
-00017540: 6768 742e 0a0a 2020 2020 2020 2020 6f6e  ght...        on
-00017550: 203a 206c 6162 656c 206f 7220 6c69 7374   : label or list
-00017560: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
-00017570: 756d 6e20 6f72 2069 6e64 6578 206c 6576  umn or index lev
-00017580: 656c 206e 616d 6573 2074 6f20 6a6f 696e  el names to join
-00017590: 206f 6e2e 2054 6865 7365 206d 7573 7420   on. These must 
-000175a0: 6265 2066 6f75 6e64 2069 6e20 626f 7468  be found in both
-000175b0: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
-000175c0: 6146 7261 6d65 732e 2049 6620 6f6e 2069  aFrames. If on i
-000175d0: 7320 4e6f 6e65 2061 6e64 206e 6f74 206d  s None and not m
-000175e0: 6572 6769 6e67 206f 6e20 696e 6465 7865  erging on indexe
-000175f0: 7320 7468 656e 2074 6869 730a 2020 2020  s then this.    
-00017600: 2020 2020 2020 2020 6465 6661 756c 7473          defaults
-00017610: 2074 6f20 7468 6520 696e 7465 7273 6563   to the intersec
-00017620: 7469 6f6e 206f 6620 7468 6520 636f 6c75  tion of the colu
-00017630: 6d6e 7320 696e 2062 6f74 6820 4461 7461  mns in both Data
-00017640: 4672 616d 6573 2e0a 2020 2020 2020 2020  Frames..        
-00017650: 6c65 6674 5f6f 6e20 3a20 6c61 6265 6c20  left_on : label 
-00017660: 6f72 206c 6973 742c 206f 7220 6172 7261  or list, or arra
-00017670: 792d 6c69 6b65 0a20 2020 2020 2020 2020  y-like.         
-00017680: 2020 2043 6f6c 756d 6e20 746f 206a 6f69     Column to joi
-00017690: 6e20 6f6e 2069 6e20 7468 6520 6c65 6674  n on in the left
-000176a0: 2044 6174 6146 7261 6d65 2e20 4f74 6865   DataFrame. Othe
-000176b0: 7220 7468 616e 2069 6e20 7061 6e64 6173  r than in pandas
-000176c0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000176d0: 6179 7320 616e 6420 6c69 7374 7320 6172  ays and lists ar
-000176e0: 6520 6f6e 6c79 2073 7570 706f 7274 2069  e only support i
-000176f0: 6620 7468 6569 7220 6c65 6e67 7468 2069  f their length i
-00017700: 7320 312e 0a20 2020 2020 2020 2072 6967  s 1..        rig
-00017710: 6874 5f6f 6e20 3a20 6c61 6265 6c20 6f72  ht_on : label or
-00017720: 206c 6973 742c 206f 7220 6172 7261 792d   list, or array-
-00017730: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
-00017740: 2043 6f6c 756d 6e20 746f 206a 6f69 6e20   Column to join 
-00017750: 6f6e 2069 6e20 7468 6520 7269 6768 7420  on in the right 
-00017760: 4461 7461 4672 616d 652e 204f 7468 6572  DataFrame. Other
-00017770: 2074 6861 6e20 696e 2070 616e 6461 730a   than in pandas.
-00017780: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00017790: 7973 2061 6e64 206c 6973 7473 2061 7265  ys and lists are
-000177a0: 206f 6e6c 7920 7375 7070 6f72 7420 6966   only support if
-000177b0: 2074 6865 6972 206c 656e 6774 6820 6973   their length is
-000177c0: 2031 2e0a 2020 2020 2020 2020 6c65 6674   1..        left
-000177d0: 5f69 6e64 6578 203a 2062 6f6f 6c65 616e  _index : boolean
-000177e0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-000177f0: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
-00017800: 7468 6520 696e 6465 7820 6672 6f6d 2074  the index from t
-00017810: 6865 206c 6566 7420 4461 7461 4672 616d  he left DataFram
-00017820: 6520 6173 2074 6865 206a 6f69 6e20 6b65  e as the join ke
-00017830: 792e 0a20 2020 2020 2020 2072 6967 6874  y..        right
-00017840: 5f69 6e64 6578 203a 2062 6f6f 6c65 616e  _index : boolean
-00017850: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00017860: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
-00017870: 7468 6520 696e 6465 7820 6672 6f6d 2074  the index from t
-00017880: 6865 2072 6967 6874 2044 6174 6146 7261  he right DataFra
-00017890: 6d65 2061 7320 7468 6520 6a6f 696e 206b  me as the join k
-000178a0: 6579 2e0a 2020 2020 2020 2020 7375 6666  ey..        suff
-000178b0: 6978 6573 203a 2032 2d6c 656e 6774 6820  ixes : 2-length 
-000178c0: 7365 7175 656e 6365 2028 7475 706c 652c  sequence (tuple,
-000178d0: 206c 6973 742c 202e 2e2e 290a 2020 2020   list, ...).    
-000178e0: 2020 2020 2020 2020 5375 6666 6978 2074          Suffix t
-000178f0: 6f20 6170 706c 7920 746f 206f 7665 726c  o apply to overl
-00017900: 6170 7069 6e67 2063 6f6c 756d 6e20 6e61  apping column na
-00017910: 6d65 7320 696e 2074 6865 206c 6566 7420  mes in the left 
-00017920: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-00017930: 7269 6768 7420 7369 6465 2c20 7265 7370  right side, resp
-00017940: 6563 7469 7665 6c79 0a20 2020 2020 2020  ectively.       
-00017950: 2069 6e64 6963 6174 6f72 203a 2062 6f6f   indicator : boo
-00017960: 6c65 616e 206f 7220 7374 7269 6e67 2c20  lean or string, 
-00017970: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-00017980: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-00017990: 652c 2061 6464 7320 6120 636f 6c75 6d6e  e, adds a column
-000179a0: 2074 6f20 6f75 7470 7574 2044 6174 6146   to output DataF
-000179b0: 7261 6d65 2063 616c 6c65 6420 225f 6d65  rame called "_me
-000179c0: 7267 6522 2077 6974 680a 2020 2020 2020  rge" with.      
-000179d0: 2020 2020 2020 696e 666f 726d 6174 696f        informatio
-000179e0: 6e20 6f6e 2074 6865 2073 6f75 7263 6520  n on the source 
-000179f0: 6f66 2065 6163 6820 726f 772e 2049 6620  of each row. If 
-00017a00: 7374 7269 6e67 2c20 636f 6c75 6d6e 2077  string, column w
-00017a10: 6974 680a 2020 2020 2020 2020 2020 2020  ith.            
-00017a20: 696e 666f 726d 6174 696f 6e20 6f6e 2073  information on s
-00017a30: 6f75 7263 6520 6f66 2065 6163 6820 726f  ource of each ro
-00017a40: 7720 7769 6c6c 2062 6520 6164 6465 6420  w will be added 
-00017a50: 746f 206f 7574 7075 7420 4461 7461 4672  to output DataFr
-00017a60: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00017a70: 2061 6e64 2063 6f6c 756d 6e20 7769 6c6c   and column will
-00017a80: 2062 6520 6e61 6d65 6420 7661 6c75 6520   be named value 
-00017a90: 6f66 2073 7472 696e 672e 2049 6e66 6f72  of string. Infor
-00017aa0: 6d61 7469 6f6e 2063 6f6c 756d 6e20 6973  mation column is
-00017ab0: 0a20 2020 2020 2020 2020 2020 2043 6174  .            Cat
-00017ac0: 6567 6f72 6963 616c 2d74 7970 6520 616e  egorical-type an
-00017ad0: 6420 7461 6b65 7320 6f6e 2061 2076 616c  d takes on a val
-00017ae0: 7565 206f 6620 226c 6566 745f 6f6e 6c79  ue of "left_only
-00017af0: 2220 666f 7220 6f62 7365 7276 6174 696f  " for observatio
-00017b00: 6e73 0a20 2020 2020 2020 2020 2020 2077  ns.            w
-00017b10: 686f 7365 206d 6572 6765 206b 6579 206f  hose merge key o
-00017b20: 6e6c 7920 6170 7065 6172 7320 696e 2060  nly appears in `
-00017b30: 6c65 6674 6020 4461 7461 4672 616d 652c  left` DataFrame,
-00017b40: 2022 7269 6768 745f 6f6e 6c79 2220 666f   "right_only" fo
-00017b50: 720a 2020 2020 2020 2020 2020 2020 6f62  r.            ob
-00017b60: 7365 7276 6174 696f 6e73 2077 686f 7365  servations whose
-00017b70: 206d 6572 6765 206b 6579 206f 6e6c 7920   merge key only 
-00017b80: 6170 7065 6172 7320 696e 2060 7269 6768  appears in `righ
-00017b90: 7460 2044 6174 6146 7261 6d65 2c0a 2020  t` DataFrame,.  
-00017ba0: 2020 2020 2020 2020 2020 616e 6420 2262            and "b
-00017bb0: 6f74 6822 2069 6620 7468 6520 6f62 7365  oth" if the obse
-00017bc0: 7276 6174 696f 6ee2 8099 7320 6d65 7267  rvation...s merg
-00017bd0: 6520 6b65 7920 6973 2066 6f75 6e64 2069  e key is found i
-00017be0: 6e20 626f 7468 2e0a 2020 2020 2020 2020  n both..        
-00017bf0: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
-00017c00: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
-00017c10: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-00017c20: 6865 2069 6465 616c 206e 756d 6265 7220  he ideal number 
-00017c30: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
-00017c40: 696f 6e73 2e20 5468 6973 2069 7320 6f6e  ions. This is on
-00017c50: 6c79 2075 7469 6c69 7365 6420 7768 656e  ly utilised when
-00017c60: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
-00017c70: 666f 726d 696e 6720 6120 6861 7368 5f6a  forming a hash_j
-00017c80: 6f69 6e20 286d 6572 6769 6e67 206f 6e20  oin (merging on 
-00017c90: 636f 6c75 6d6e 7320 6f6e 6c79 292e 2049  columns only). I
-00017ca0: 6620 6060 4e6f 6e65 6060 2074 6865 6e0a  f ``None`` then.
-00017cb0: 2020 2020 2020 2020 2020 2020 6060 6e70              ``np
-00017cc0: 6172 7469 7469 6f6e 7320 3d20 6d61 7828  artitions = max(
-00017cd0: 6c68 732e 6e70 6172 7469 7469 6f6e 732c  lhs.npartitions,
-00017ce0: 2072 6873 2e6e 7061 7274 6974 696f 6e73   rhs.npartitions
-00017cf0: 2960 602e 0a20 2020 2020 2020 2020 2020  )``..           
-00017d00: 2044 6566 6175 6c74 2069 7320 6060 4e6f   Default is ``No
-00017d10: 6e65 6060 2e0a 2020 2020 2020 2020 7368  ne``..        sh
-00017d20: 7566 666c 655f 6d65 7468 6f64 3a20 7b27  uffle_method: {'
-00017d30: 6469 736b 272c 2027 7461 736b 7327 2c20  disk', 'tasks', 
-00017d40: 2770 3270 277d 2c20 6f70 7469 6f6e 616c  'p2p'}, optional
-00017d50: 0a20 2020 2020 2020 2020 2020 2045 6974  .            Eit
-00017d60: 6865 7220 6060 2764 6973 6b27 6060 2066  her ``'disk'`` f
-00017d70: 6f72 2073 696e 676c 652d 6e6f 6465 206f  or single-node o
-00017d80: 7065 7261 7469 6f6e 206f 7220 6060 2774  peration or ``'t
-00017d90: 6173 6b73 2760 6020 616e 640a 2020 2020  asks'`` and.    
-00017da0: 2020 2020 2020 2020 6060 2770 3270 2760          ``'p2p'`
-00017db0: 6060 2066 6f72 2064 6973 7472 6962 7574  `` for distribut
-00017dc0: 6564 206f 7065 7261 7469 6f6e 2e20 2057  ed operation.  W
-00017dd0: 696c 6c20 6265 2069 6e66 6572 7265 6420  ill be inferred 
-00017de0: 6279 2079 6f75 720a 2020 2020 2020 2020  by your.        
-00017df0: 2020 2020 6375 7272 656e 7420 7363 6865      current sche
-00017e00: 6475 6c65 722e 0a20 2020 2020 2020 2062  duler..        b
-00017e10: 726f 6164 6361 7374 3a20 626f 6f6c 6561  roadcast: boolea
-00017e20: 6e20 6f72 2066 6c6f 6174 2c20 6f70 7469  n or float, opti
-00017e30: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00017e40: 2057 6865 7468 6572 2074 6f20 7573 6520   Whether to use 
-00017e50: 6120 6272 6f61 6463 6173 742d 6261 7365  a broadcast-base
-00017e60: 6420 6a6f 696e 2069 6e20 6c69 6575 206f  d join in lieu o
-00017e70: 6620 6120 7368 7566 666c 652d 6261 7365  f a shuffle-base
-00017e80: 640a 2020 2020 2020 2020 2020 2020 6a6f  d.            jo
-00017e90: 696e 2066 6f72 2073 7570 706f 7274 6564  in for supported
-00017ea0: 2063 6173 6573 2e20 2042 7920 6465 6661   cases.  By defa
-00017eb0: 756c 742c 2061 2073 696d 706c 6520 6865  ult, a simple he
-00017ec0: 7572 6973 7469 6320 7769 6c6c 2062 650a  uristic will be.
-00017ed0: 2020 2020 2020 2020 2020 2020 7573 6564              used
-00017ee0: 2074 6f20 7365 6c65 6374 2074 6865 2075   to select the u
-00017ef0: 6e64 6572 6c79 696e 6720 616c 676f 7269  nderlying algori
-00017f00: 7468 6d2e 2049 6620 6120 666c 6f61 7469  thm. If a floati
-00017f10: 6e67 2d70 6f69 6e74 2076 616c 7565 0a20  ng-point value. 
-00017f20: 2020 2020 2020 2020 2020 2069 7320 7370             is sp
-00017f30: 6563 6966 6965 642c 2074 6861 7420 6e75  ecified, that nu
-00017f40: 6d62 6572 2077 696c 6c20 6265 2075 7365  mber will be use
-00017f50: 6420 6173 2074 6865 2060 6062 726f 6164  d as the ``broad
-00017f60: 6361 7374 5f62 6961 7360 600a 2020 2020  cast_bias``.    
-00017f70: 2020 2020 2020 2020 7769 7468 696e 2074          within t
-00017f80: 6865 2073 696d 706c 6520 6865 7572 6973  he simple heuris
-00017f90: 7469 6320 2861 206c 6172 6765 206e 756d  tic (a large num
-00017fa0: 6265 7220 6d61 6b65 7320 4461 736b 206d  ber makes Dask m
-00017fb0: 6f72 6520 6c69 6b65 6c79 0a20 2020 2020  ore likely.     
-00017fc0: 2020 2020 2020 2074 6f20 6368 6f6f 7365         to choose
-00017fd0: 2074 6865 2060 6062 726f 6163 6173 745f   the ``broacast_
-00017fe0: 6a6f 696e 6060 2063 6f64 6520 7061 7468  join`` code path
-00017ff0: 292e 2053 6565 2060 6062 726f 6164 6361  ). See ``broadca
-00018000: 7374 5f6a 6f69 6e60 600a 2020 2020 2020  st_join``.      
-00018010: 2020 2020 2020 666f 7220 6d6f 7265 2069        for more i
-00018020: 6e66 6f72 6d61 7469 6f6e 2e0a 0a20 2020  nformation...   
-00018030: 2020 2020 204e 6f74 6573 0a20 2020 2020       Notes.     
-00018040: 2020 202d 2d2d 2d2d 0a0a 2020 2020 2020     -----..      
-00018050: 2020 5468 6572 6520 6172 6520 7468 7265    There are thre
-00018060: 6520 7761 7973 2074 6f20 6a6f 696e 2064  e ways to join d
-00018070: 6174 6166 7261 6d65 733a 0a0a 2020 2020  ataframes:..    
-00018080: 2020 2020 312e 204a 6f69 6e69 6e67 206f      1. Joining o
-00018090: 6e20 696e 6469 6365 732e 2049 6e20 7468  n indices. In th
-000180a0: 6973 2063 6173 6520 7468 6520 6469 7669  is case the divi
-000180b0: 7369 6f6e 7320 6172 650a 2020 2020 2020  sions are.      
-000180c0: 2020 2020 2061 6c69 676e 6564 2075 7369       aligned usi
-000180d0: 6e67 2074 6865 2066 756e 6374 696f 6e20  ng the function 
-000180e0: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
-000180f0: 2e6d 756c 7469 2e61 6c69 676e 5f70 6172  .multi.align_par
-00018100: 7469 7469 6f6e 7360 602e 0a20 2020 2020  titions``..     
-00018110: 2020 2020 2020 4166 7465 7277 6172 6473        Afterwards
-00018120: 2c20 6561 6368 2070 6172 7469 7469 6f6e  , each partition
-00018130: 2069 7320 6d65 7267 6564 2077 6974 6820   is merged with 
-00018140: 7468 6520 7061 6e64 6173 206d 6572 6765  the pandas merge
-00018150: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
-00018160: 2020 2020 322e 204a 6f69 6e69 6e67 206f      2. Joining o
-00018170: 6e65 206f 6e20 696e 6465 7820 616e 6420  ne on index and 
-00018180: 6f6e 6520 6f6e 2063 6f6c 756d 6e2e 2049  one on column. I
-00018190: 6e20 7468 6973 2063 6173 6520 7468 6520  n this case the 
-000181a0: 6469 7669 7369 6f6e 7320 6f66 0a20 2020  divisions of.   
-000181b0: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
-000181c0: 6520 6d65 7267 6564 2062 7920 696e 6465  e merged by inde
-000181d0: 7820 283a 6d61 7468 3a60 645f 6960 2920  x (:math:`d_i`) 
-000181e0: 6172 6520 7573 6564 2074 6f20 6469 7669  are used to divi
-000181f0: 6465 2074 6865 2063 6f6c 756d 6e0a 2020  de the column.  
-00018200: 2020 2020 2020 2020 206d 6572 6765 6420           merged 
-00018210: 6461 7461 6672 616d 6520 283a 6d61 7468  dataframe (:math
-00018220: 3a60 645f 6360 2920 6f6e 6520 7573 696e  :`d_c`) one usin
-00018230: 670a 2020 2020 2020 2020 2020 2060 6064  g.           ``d
-00018240: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-00018250: 6c74 692e 7265 6172 7261 6e67 655f 6279  lti.rearrange_by
-00018260: 5f64 6976 6973 696f 6e73 6060 2e20 496e  _divisions``. In
-00018270: 2074 6869 7320 6361 7365 2074 6865 0a20   this case the. 
-00018280: 2020 2020 2020 2020 2020 6d65 7267 6564            merged
-00018290: 2064 6174 6166 7261 6d65 2028 3a6d 6174   dataframe (:mat
-000182a0: 683a 6064 5f6d 6029 2068 6173 2074 6865  h:`d_m`) has the
-000182b0: 2065 7861 6374 2073 616d 6520 6469 7669   exact same divi
-000182c0: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
-000182d0: 2061 7320 283a 6d61 7468 3a60 645f 6960   as (:math:`d_i`
-000182e0: 292e 2054 6869 7320 6361 6e20 6c65 6164  ). This can lead
-000182f0: 2074 6f20 6973 7375 6573 2069 6620 796f   to issues if yo
-00018300: 7520 6d65 7267 6520 6d75 6c74 6970 6c65  u merge multiple
-00018310: 2072 6f77 7320 6672 6f6d 0a20 2020 2020   rows from.     
-00018320: 2020 2020 2020 283a 6d61 7468 3a60 645f        (:math:`d_
-00018330: 6360 2920 746f 206f 6e65 2072 6f77 2069  c`) to one row i
-00018340: 6e20 283a 6d61 7468 3a60 645f 6960 292e  n (:math:`d_i`).
-00018350: 0a0a 2020 2020 2020 2020 332e 204a 6f69  ..        3. Joi
-00018360: 6e69 6e67 2062 6f74 6820 6f6e 2063 6f6c  ning both on col
-00018370: 756d 6e73 2e20 496e 2074 6869 7320 6361  umns. In this ca
-00018380: 7365 2061 2068 6173 6820 6a6f 696e 2069  se a hash join i
-00018390: 7320 7065 7266 6f72 6d65 6420 7573 696e  s performed usin
-000183a0: 670a 2020 2020 2020 2020 2020 2060 6064  g.           ``d
-000183b0: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-000183c0: 6c74 692e 6861 7368 5f6a 6f69 6e60 602e  lti.hash_join``.
-000183d0: 0a0a 2020 2020 2020 2020 496e 2073 6f6d  ..        In som
-000183e0: 6520 6361 7365 732c 2079 6f75 206d 6179  e cases, you may
-000183f0: 2073 6565 2061 2060 604d 656d 6f72 7945   see a ``MemoryE
-00018400: 7272 6f72 6060 2069 6620 7468 6520 6060  rror`` if the ``
-00018410: 6d65 7267 6560 6020 6f70 6572 6174 696f  merge`` operatio
-00018420: 6e20 7265 7175 6972 6573 0a20 2020 2020  n requires.     
-00018430: 2020 2061 6e20 696e 7465 726e 616c 2060     an internal `
-00018440: 6073 6875 6666 6c65 6060 2c20 6265 6361  `shuffle``, beca
-00018450: 7573 6520 7368 7566 666c 696e 6720 706c  use shuffling pl
-00018460: 6163 6573 2061 6c6c 2072 6f77 7320 7468  aces all rows th
-00018470: 6174 2068 6176 6520 7468 6520 7361 6d65  at have the same
-00018480: 0a20 2020 2020 2020 2069 6e64 6578 2069  .        index i
-00018490: 6e20 7468 6520 7361 6d65 2070 6172 7469  n the same parti
-000184a0: 7469 6f6e 2e20 546f 2061 766f 6964 2074  tion. To avoid t
-000184b0: 6869 7320 6572 726f 722c 206d 616b 6520  his error, make 
-000184c0: 7375 7265 2061 6c6c 2072 6f77 7320 7769  sure all rows wi
-000184d0: 7468 2074 6865 0a20 2020 2020 2020 2073  th the.        s
-000184e0: 616d 6520 6060 6f6e 6060 2d63 6f6c 756d  ame ``on``-colum
-000184f0: 6e20 7661 6c75 6520 6361 6e20 6669 7420  n value can fit 
-00018500: 6f6e 2061 2073 696e 676c 6520 7061 7274  on a single part
-00018510: 6974 696f 6e2e 0a20 2020 2020 2020 2022  ition..        "
-00018520: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00018530: 6e20 6d65 7267 6528 0a20 2020 2020 2020  n merge(.       
-00018540: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00018550: 2020 2020 2020 2072 6967 6874 2c0a 2020         right,.  
-00018560: 2020 2020 2020 2020 2020 686f 772c 0a20            how,. 
-00018570: 2020 2020 2020 2020 2020 206f 6e2c 0a20             on,. 
-00018580: 2020 2020 2020 2020 2020 206c 6566 745f             left_
-00018590: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000185a0: 7269 6768 745f 6f6e 2c0a 2020 2020 2020  right_on,.      
-000185b0: 2020 2020 2020 6c65 6674 5f69 6e64 6578        left_index
-000185c0: 2c0a 2020 2020 2020 2020 2020 2020 7269  ,.            ri
-000185d0: 6768 745f 696e 6465 782c 0a20 2020 2020  ght_index,.     
-000185e0: 2020 2020 2020 2073 7566 6669 7865 732c         suffixes,
-000185f0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00018600: 6963 6174 6f72 2c0a 2020 2020 2020 2020  icator,.        
-00018610: 2020 2020 7368 7566 666c 655f 6d65 7468      shuffle_meth
-00018620: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-00018630: 6e70 6172 7469 7469 6f6e 733d 6e70 6172  npartitions=npar
-00018640: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
-00018650: 2020 2020 2062 726f 6164 6361 7374 3d62       broadcast=b
-00018660: 726f 6164 6361 7374 2c0a 2020 2020 2020  roadcast,.      
-00018670: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00018680: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00018690: 616d 6529 0a20 2020 2064 6566 206a 6f69  ame).    def joi
-000186a0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
-000186b0: 0a20 2020 2020 2020 206f 7468 6572 2c0a  .        other,.
-000186c0: 2020 2020 2020 2020 6f6e 3d4e 6f6e 652c          on=None,
-000186d0: 0a20 2020 2020 2020 2068 6f77 3d22 6c65  .        how="le
-000186e0: 6674 222c 0a20 2020 2020 2020 206c 7375  ft",.        lsu
-000186f0: 6666 6978 3d22 222c 0a20 2020 2020 2020  ffix="",.       
-00018700: 2072 7375 6666 6978 3d22 222c 0a20 2020   rsuffix="",.   
-00018710: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
-00018720: 686f 643d 4e6f 6e65 2c0a 2020 2020 2020  hod=None,.      
-00018730: 2020 6e70 6172 7469 7469 6f6e 733d 4e6f    npartitions=No
-00018740: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00018750: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00018760: 616e 6365 286f 7468 6572 2c20 6c69 7374  ance(other, list
-00018770: 2920 616e 6420 6e6f 7420 6973 5f64 6173  ) and not is_das
-00018780: 6b5f 636f 6c6c 6563 7469 6f6e 286f 7468  k_collection(oth
-00018790: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
-000187a0: 206f 7468 6572 203d 2066 726f 6d5f 7061   other = from_pa
-000187b0: 6e64 6173 286f 7468 6572 2c20 6e70 6172  ndas(other, npar
-000187c0: 7469 7469 6f6e 733d 3129 0a20 2020 2020  titions=1).     
-000187d0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-000187e0: 2020 2020 6e6f 7420 6973 696e 7374 616e      not isinstan
-000187f0: 6365 286f 7468 6572 2c20 6c69 7374 290a  ce(other, list).
-00018800: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00018810: 6e6f 7420 6973 5f64 6174 6166 7261 6d65  not is_dataframe
-00018820: 5f6c 696b 6528 6f74 6865 722e 5f6d 6574  _like(other._met
-00018830: 6129 0a20 2020 2020 2020 2020 2020 2061  a).            a
-00018840: 6e64 2068 6173 6174 7472 286f 7468 6572  nd hasattr(other
-00018850: 2e5f 6d65 7461 2c20 226e 616d 6522 290a  ._meta, "name").
-00018860: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00018870: 2020 2020 2020 206f 7468 6572 203d 206e         other = n
-00018880: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-00018890: 7072 2e54 6f46 7261 6d65 286f 7468 6572  pr.ToFrame(other
-000188a0: 2929 0a0a 2020 2020 2020 2020 6966 206e  ))..        if n
-000188b0: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
-000188c0: 6865 722c 2046 7261 6d65 4261 7365 293a  her, FrameBase):
-000188d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000188e0: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
-000188f0: 7468 6572 2c20 6c69 7374 2920 6f72 206e  ther, list) or n
-00018900: 6f74 2061 6c6c 280a 2020 2020 2020 2020  ot all(.        
-00018910: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-00018920: 6365 286f 2c20 4672 616d 6542 6173 6529  ce(o, FrameBase)
-00018930: 2066 6f72 206f 2069 6e20 6f74 6865 720a   for o in other.
-00018940: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-00018950: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00018960: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00018970: 226f 7468 6572 206d 7573 7420 6265 2044  "other must be D
-00018980: 6174 6146 7261 6d65 206f 7220 6c69 7374  ataFrame or list
-00018990: 206f 6620 4461 7461 4672 616d 6573 2229   of DataFrames")
-000189a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000189b0: 686f 7720 6e6f 7420 696e 2028 226f 7574  how not in ("out
-000189c0: 6572 222c 2022 6c65 6674 2229 3a0a 2020  er", "left"):.  
-000189d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000189e0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-000189f0: 6d65 7267 655f 6d75 6c74 6920 6f6e 6c79  merge_multi only
-00018a00: 2073 7570 706f 7274 7320 6c65 6674 206f   supports left o
-00018a10: 7220 6f75 7465 7220 6a6f 696e 7322 290a  r outer joins").
-00018a20: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-00018a30: 6572 203d 205b 0a20 2020 2020 2020 2020  er = [.         
-00018a40: 2020 2020 2020 2066 726f 6d5f 7061 6e64         from_pand
-00018a50: 6173 286f 2c20 6e70 6172 7469 7469 6f6e  as(o, npartition
-00018a60: 733d 3129 2069 6620 6e6f 7420 6973 5f64  s=1) if not is_d
-00018a70: 6173 6b5f 636f 6c6c 6563 7469 6f6e 286f  ask_collection(o
-00018a80: 2920 656c 7365 206f 0a20 2020 2020 2020  ) else o.       
-00018a90: 2020 2020 2020 2020 2066 6f72 206f 2069           for o i
-00018aa0: 6e20 6f74 6865 720a 2020 2020 2020 2020  n other.        
-00018ab0: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-00018ac0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00018ad0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-00018ae0: 2020 2020 2020 2020 2020 4a6f 696e 5265            JoinRe
-00018af0: 6375 7273 6976 6528 5b73 656c 662e 6578  cursive([self.ex
-00018b00: 7072 5d20 2b20 5b6f 2e65 7870 7220 666f  pr] + [o.expr fo
-00018b10: 7220 6f20 696e 206f 7468 6572 5d2c 2068  r o in other], h
-00018b20: 6f77 3d68 6f77 290a 2020 2020 2020 2020  ow=how).        
-00018b30: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-00018b40: 6574 7572 6e20 7365 6c66 2e6d 6572 6765  eturn self.merge
-00018b50: 280a 2020 2020 2020 2020 2020 2020 7269  (.            ri
-00018b60: 6768 743d 6f74 6865 722c 0a20 2020 2020  ght=other,.     
-00018b70: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
-00018b80: 783d 6f6e 2069 7320 4e6f 6e65 2c0a 2020  x=on is None,.  
-00018b90: 2020 2020 2020 2020 2020 7269 6768 745f            right_
-00018ba0: 696e 6465 783d 5472 7565 2c0a 2020 2020  index=True,.    
-00018bb0: 2020 2020 2020 2020 6c65 6674 5f6f 6e3d          left_on=
-00018bc0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00018bd0: 686f 773d 686f 772c 0a20 2020 2020 2020  how=how,.       
-00018be0: 2020 2020 2073 7566 6669 7865 733d 286c       suffixes=(l
-00018bf0: 7375 6666 6978 2c20 7273 7566 6669 7829  suffix, rsuffix)
-00018c00: 2c0a 2020 2020 2020 2020 2020 2020 7368  ,.            sh
-00018c10: 7566 666c 655f 6d65 7468 6f64 3d73 6875  uffle_method=shu
-00018c20: 6666 6c65 5f6d 6574 686f 642c 0a20 2020  ffle_method,.   
-00018c30: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
-00018c40: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
-00018c50: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00018c60: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00018c70: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00018c80: 2064 6566 2067 726f 7570 6279 280a 2020   def groupby(.  
-00018c90: 2020 2020 2020 7365 6c66 2c20 6279 2c20        self, by, 
-00018ca0: 6772 6f75 705f 6b65 7973 3d54 7275 652c  group_keys=True,
-00018cb0: 2073 6f72 743d 4e6f 6e65 2c20 6f62 7365   sort=None, obse
-00018cc0: 7276 6564 3d4e 6f6e 652c 2064 726f 706e  rved=None, dropn
-00018cd0: 613d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  a=None, **kwargs
-00018ce0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00018cf0: 6672 6f6d 2064 6173 6b5f 6578 7072 2e5f  from dask_expr._
-00018d00: 6772 6f75 7062 7920 696d 706f 7274 2047  groupby import G
-00018d10: 726f 7570 4279 0a0a 2020 2020 2020 2020  roupBy..        
-00018d20: 6966 2069 7369 6e73 7461 6e63 6528 6279  if isinstance(by
-00018d30: 2c20 4672 616d 6542 6173 6529 2061 6e64  , FrameBase) and
-00018d40: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00018d50: 6279 2c20 5365 7269 6573 293a 0a20 2020  by, Series):.   
-00018d60: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00018d70: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00018d80: 2020 2020 2020 2020 2020 2066 2260 6279             f"`by
-00018d90: 6020 6d75 7374 2062 6520 6120 636f 6c75  ` must be a colu
-00018da0: 6d6e 206e 616d 6520 6f72 206c 6973 7420  mn name or list 
-00018db0: 6f66 2063 6f6c 756d 6e73 2c20 676f 7420  of columns, got 
-00018dc0: 7b62 797d 2e22 0a20 2020 2020 2020 2020  {by}.".         
-00018dd0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-00018de0: 7475 726e 2047 726f 7570 4279 280a 2020  turn GroupBy(.  
-00018df0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00018e00: 2020 2020 2020 2020 2020 2020 6279 2c0a              by,.
-00018e10: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-00018e20: 705f 6b65 7973 3d67 726f 7570 5f6b 6579  p_keys=group_key
-00018e30: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-00018e40: 6f72 743d 736f 7274 2c0a 2020 2020 2020  ort=sort,.      
-00018e50: 2020 2020 2020 6f62 7365 7276 6564 3d6f        observed=o
-00018e60: 6273 6572 7665 642c 0a20 2020 2020 2020  bserved,.       
-00018e70: 2020 2020 2064 726f 706e 613d 6472 6f70       dropna=drop
-00018e80: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
-00018e90: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
-00018ea0: 2020 290a 0a20 2020 2064 6566 205f 5f73    )..    def __s
-00018eb0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
-00018ec0: 6579 2c20 7661 6c75 6529 3a0a 2020 2020  ey, value):.    
-00018ed0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00018ee0: 6528 6b65 792c 2028 7475 706c 652c 206c  e(key, (tuple, l
-00018ef0: 6973 7429 2920 616e 6420 6973 696e 7374  ist)) and isinst
-00018f00: 616e 6365 2876 616c 7565 2c20 4461 7461  ance(value, Data
-00018f10: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00018f20: 2020 2020 6f75 7420 3d20 7365 6c66 2e61      out = self.a
-00018f30: 7373 6967 6e28 2a2a 7b6b 3a20 7661 6c75  ssign(**{k: valu
-00018f40: 655b 635d 2066 6f72 206b 2c20 6320 696e  e[c] for k, c in
-00018f50: 207a 6970 286b 6579 2c20 7661 6c75 652e   zip(key, value.
-00018f60: 636f 6c75 6d6e 7329 7d29 0a0a 2020 2020  columns)})..    
-00018f70: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00018f80: 6e63 6528 6b65 792c 2070 642e 496e 6465  nce(key, pd.Inde
-00018f90: 7829 2061 6e64 206e 6f74 2069 7369 6e73  x) and not isins
-00018fa0: 7461 6e63 6528 7661 6c75 652c 2044 6174  tance(value, Dat
-00018fb0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-00018fc0: 2020 2020 206f 7574 203d 2073 656c 662e       out = self.
-00018fd0: 6173 7369 676e 282a 2a7b 6b3a 2076 616c  assign(**{k: val
-00018fe0: 7565 2066 6f72 206b 2069 6e20 6c69 7374  ue for k in list
-00018ff0: 286b 6579 297d 290a 2020 2020 2020 2020  (key)}).        
-00019000: 656c 6966 2028 0a20 2020 2020 2020 2020  elif (.         
-00019010: 2020 2069 735f 6461 7461 6672 616d 655f     is_dataframe_
-00019020: 6c69 6b65 286b 6579 290a 2020 2020 2020  like(key).      
-00019030: 2020 2020 2020 6f72 2069 735f 7365 7269        or is_seri
-00019040: 6573 5f6c 696b 6528 6b65 7929 0a20 2020  es_like(key).   
-00019050: 2020 2020 2020 2020 206f 7220 6973 696e           or isin
-00019060: 7374 616e 6365 286b 6579 2c20 2844 6174  stance(key, (Dat
-00019070: 6146 7261 6d65 2c20 5365 7269 6573 2929  aFrame, Series))
-00019080: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-00019090: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
-000190a0: 6c66 2e77 6865 7265 287e 6b65 792c 2076  lf.where(~key, v
-000190b0: 616c 7565 290a 2020 2020 2020 2020 656c  alue).        el
-000190c0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-000190d0: 6528 6b65 792c 2073 7472 293a 0a20 2020  e(key, str):.   
-000190e0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-000190f0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00019100: 6f72 2866 2249 7465 6d20 6173 7369 676e  or(f"Item assign
-00019110: 6d65 6e74 2077 6974 6820 7b74 7970 6528  ment with {type(
-00019120: 6b65 7929 7d20 6e6f 7420 7375 7070 6f72  key)} not suppor
-00019130: 7465 6422 290a 2020 2020 2020 2020 656c  ted").        el
-00019140: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00019150: 6f75 7420 3d20 7365 6c66 2e61 7373 6967  out = self.assig
-00019160: 6e28 2a2a 7b6b 6579 3a20 7661 6c75 657d  n(**{key: value}
-00019170: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00019180: 6578 7072 203d 206f 7574 2e5f 6578 7072  expr = out._expr
-00019190: 0a0a 2020 2020 6465 6620 5f5f 6465 6c69  ..    def __deli
-000191a0: 7465 6d5f 5f28 7365 6c66 2c20 6b65 7929  tem__(self, key)
-000191b0: 3a0a 2020 2020 2020 2020 636f 6c75 6d6e  :.        column
-000191c0: 7320 3d20 5b63 2066 6f72 2063 2069 6e20  s = [c for c in 
-000191d0: 7365 6c66 2e63 6f6c 756d 6e73 2069 6620  self.columns if 
-000191e0: 6320 213d 206b 6579 5d0a 2020 2020 2020  c != key].      
-000191f0: 2020 6f75 7420 3d20 7365 6c66 5b63 6f6c    out = self[col
-00019200: 756d 6e73 5d0a 2020 2020 2020 2020 7365  umns].        se
-00019210: 6c66 2e5f 6578 7072 203d 206f 7574 2e5f  lf._expr = out._
-00019220: 6578 7072 0a0a 2020 2020 6465 6620 5f5f  expr..    def __
-00019230: 6765 7461 7474 725f 5f28 7365 6c66 2c20  getattr__(self, 
-00019240: 6b65 7929 3a0a 2020 2020 2020 2020 7472  key):.        tr
-00019250: 793a 0a20 2020 2020 2020 2020 2020 2023  y:.            #
-00019260: 2050 7269 6f72 6974 697a 6520 6044 6174   Prioritize `Dat
-00019270: 6146 7261 6d65 6020 6174 7472 6962 7574  aFrame` attribut
-00019280: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
-00019290: 6574 7572 6e20 6f62 6a65 6374 2e5f 5f67  eturn object.__g
-000192a0: 6574 6174 7472 6962 7574 655f 5f28 7365  etattribute__(se
-000192b0: 6c66 2c20 6b65 7929 0a20 2020 2020 2020  lf, key).       
-000192c0: 2065 7863 6570 7420 4174 7472 6962 7574   except Attribut
-000192d0: 6545 7272 6f72 2061 7320 6572 723a 0a20  eError as err:. 
-000192e0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-000192f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019300: 2320 4368 6563 6b20 6966 206b 6579 2069  # Check if key i
-00019310: 7320 696e 2063 6f6c 756d 6e73 2069 6620  s in columns if 
-00019320: 6b65 790a 2020 2020 2020 2020 2020 2020  key.            
-00019330: 2020 2020 2320 6973 206e 6f74 2061 206e      # is not a n
-00019340: 6f72 6d61 6c20 6174 7472 6962 7574 650a  ormal attribute.
-00019350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019360: 6966 206b 6579 2069 6e20 7365 6c66 2e65  if key in self.e
-00019370: 7870 722e 5f6d 6574 612e 636f 6c75 6d6e  xpr._meta.column
-00019380: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00019390: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000193a0: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
-000193b0: 662e 6578 7072 5b6b 6579 5d29 0a20 2020  f.expr[key]).   
-000193c0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000193d0: 7365 2065 7272 0a20 2020 2020 2020 2020  se err.         
-000193e0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-000193f0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
-00019400: 2020 2020 2020 2020 2020 2320 4661 6c6c            # Fall
-00019410: 2062 6163 6b20 746f 2060 4261 7365 4672   back to `BaseFr
-00019420: 616d 652e 5f5f 6765 7461 7474 725f 5f60  ame.__getattr__`
-00019430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019440: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
-00019450: 5f5f 6765 7461 7474 725f 5f28 6b65 7929  __getattr__(key)
-00019460: 0a0a 2020 2020 6465 6620 5f5f 6469 725f  ..    def __dir_
-00019470: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00019480: 206f 203d 2073 6574 2864 6972 2874 7970   o = set(dir(typ
-00019490: 6528 7365 6c66 2929 290a 2020 2020 2020  e(self))).      
-000194a0: 2020 6f2e 7570 6461 7465 2873 656c 662e    o.update(self.
-000194b0: 5f5f 6469 6374 5f5f 290a 2020 2020 2020  __dict__).      
-000194c0: 2020 6f2e 7570 6461 7465 2873 6574 2864    o.update(set(d
-000194d0: 6972 2865 7870 722e 4578 7072 2929 290a  ir(expr.Expr))).
-000194e0: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
-000194f0: 2863 2066 6f72 2063 2069 6e20 7365 6c66  (c for c in self
-00019500: 2e63 6f6c 756d 6e73 2069 6620 2869 7369  .columns if (isi
-00019510: 6e73 7461 6e63 6528 632c 2073 7472 2920  nstance(c, str) 
-00019520: 616e 6420 632e 6973 6964 656e 7469 6669  and c.isidentifi
-00019530: 6572 2829 2929 0a20 2020 2020 2020 2072  er())).        r
-00019540: 6574 7572 6e20 6c69 7374 286f 290a 0a20  eturn list(o).. 
-00019550: 2020 2064 6566 206d 6170 2873 656c 662c     def map(self,
-00019560: 2066 756e 632c 206e 615f 6163 7469 6f6e   func, na_action
-00019570: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
-00019580: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-00019590: 7420 5041 4e44 4153 5f47 455f 3231 303a  t PANDAS_GE_210:
-000195a0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000195b0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-000195c0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-000195d0: 2020 2020 2020 2020 6622 4461 7461 4672          f"DataFr
-000195e0: 616d 652e 6d61 7020 7265 7175 6972 6573  ame.map requires
-000195f0: 2070 616e 6461 733e 3d32 2e31 2e30 2c20   pandas>=2.1.0, 
-00019600: 6275 7420 7061 6e64 6173 3d7b 5041 4e44  but pandas={PAND
-00019610: 4153 5f56 4552 5349 4f4e 7d20 6973 2022  AS_VERSION} is "
-00019620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019630: 2022 696e 7374 616c 6c65 642e 220a 2020   "installed.".  
-00019640: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00019650: 2020 2020 6966 206d 6574 6120 6973 204e      if meta is N
-00019660: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00019670: 206d 6574 6120 3d20 6578 7072 2e5f 656d   meta = expr._em
-00019680: 756c 6174 6528 4d2e 6d61 702c 2073 656c  ulate(M.map, sel
-00019690: 662c 2066 756e 632c 206e 615f 6163 7469  f, func, na_acti
-000196a0: 6f6e 3d6e 615f 6163 7469 6f6e 2c20 7564  on=na_action, ud
-000196b0: 663d 5472 7565 290a 2020 2020 2020 2020  f=True).        
-000196c0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-000196d0: 6e28 6d65 7461 5f77 6172 6e69 6e67 286d  n(meta_warning(m
-000196e0: 6574 6129 290a 2020 2020 2020 2020 7265  eta)).        re
-000196f0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00019700: 696f 6e28 6578 7072 2e4d 6170 2873 656c  ion(expr.Map(sel
-00019710: 662c 2061 7267 3d66 756e 632c 206e 615f  f, arg=func, na_
-00019720: 6163 7469 6f6e 3d6e 615f 6163 7469 6f6e  action=na_action
-00019730: 2c20 6d65 7461 3d6d 6574 6129 290a 0a20  , meta=meta)).. 
-00019740: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00019750: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00019760: 2020 2064 6566 206e 6c61 7267 6573 7428     def nlargest(
-00019770: 7365 6c66 2c20 6e3d 352c 2063 6f6c 756d  self, n=5, colum
-00019780: 6e73 3d4e 6f6e 652c 2073 706c 6974 5f65  ns=None, split_e
-00019790: 7665 7279 3d4e 6f6e 6529 3a0a 2020 2020  very=None):.    
-000197a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-000197b0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-000197c0: 2020 2020 2020 204e 4c61 7267 6573 7428         NLargest(
-000197d0: 7365 6c66 2c20 6e3d 6e2c 205f 636f 6c75  self, n=n, _colu
-000197e0: 6d6e 733d 636f 6c75 6d6e 732c 2073 706c  mns=columns, spl
-000197f0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00019800: 7665 7279 290a 2020 2020 2020 2020 290a  very).        ).
-00019810: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00019820: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00019830: 0a20 2020 2064 6566 206e 736d 616c 6c65  .    def nsmalle
-00019840: 7374 2873 656c 662c 206e 3d35 2c20 636f  st(self, n=5, co
-00019850: 6c75 6d6e 733d 4e6f 6e65 2c20 7370 6c69  lumns=None, spli
-00019860: 745f 6576 6572 793d 4e6f 6e65 293a 0a20  t_every=None):. 
-00019870: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00019880: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-00019890: 2020 2020 2020 2020 2020 4e53 6d61 6c6c            NSmall
-000198a0: 6573 7428 7365 6c66 2c20 6e3d 6e2c 205f  est(self, n=n, _
-000198b0: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
-000198c0: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-000198d0: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-000198e0: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-000198f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00019900: 616d 6529 0a20 2020 2064 6566 206d 656d  ame).    def mem
-00019910: 6f72 795f 7573 6167 6528 7365 6c66 2c20  ory_usage(self, 
-00019920: 6465 6570 3d46 616c 7365 2c20 696e 6465  deep=False, inde
-00019930: 783d 5472 7565 293a 0a20 2020 2020 2020  x=True):.       
-00019940: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00019950: 6563 7469 6f6e 284d 656d 6f72 7955 7361  ection(MemoryUsa
-00019960: 6765 4672 616d 6528 7365 6c66 2c20 6465  geFrame(self, de
-00019970: 6570 3d64 6565 702c 205f 696e 6465 783d  ep=deep, _index=
-00019980: 696e 6465 7829 290a 0a20 2020 2040 6465  index))..    @de
-00019990: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-000199a0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-000199b0: 2063 6f6d 6269 6e65 2873 656c 662c 206f   combine(self, o
-000199c0: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
-000199d0: 5f76 616c 7565 3d4e 6f6e 652c 206f 7665  _value=None, ove
-000199e0: 7277 7269 7465 3d54 7275 6529 3a0a 2020  rwrite=True):.  
-000199f0: 2020 2020 2020 6f74 6865 7220 3d20 7365        other = se
-00019a00: 6c66 2e5f 6372 6561 7465 5f61 6c69 676e  lf._create_align
-00019a10: 6162 6c65 5f66 7261 6d65 286f 7468 6572  able_frame(other
-00019a20: 2c20 226f 7574 6572 2229 0a20 2020 2020  , "outer").     
-00019a30: 2020 2069 6620 6e6f 7420 6578 7072 2e61     if not expr.a
-00019a40: 7265 5f63 6f5f 616c 6967 6e65 6428 7365  re_co_aligned(se
-00019a50: 6c66 2e65 7870 722c 206f 7468 6572 2e65  lf.expr, other.e
-00019a60: 7870 7229 3a0a 2020 2020 2020 2020 2020  xpr):.          
-00019a70: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00019a80: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-00019a90: 2020 2020 2020 2020 2065 7870 722e 436f           expr.Co
-00019aa0: 6d62 696e 6546 7261 6d65 416c 6967 6e28  mbineFrameAlign(
-00019ab0: 7365 6c66 2c20 6f74 6865 722c 2066 756e  self, other, fun
-00019ac0: 632c 2066 696c 6c5f 7661 6c75 652c 206f  c, fill_value, o
-00019ad0: 7665 7277 7269 7465 290a 2020 2020 2020  verwrite).      
-00019ae0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019af0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00019b00: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-00019b10: 2020 2065 7870 722e 436f 6d62 696e 6546     expr.CombineF
-00019b20: 7261 6d65 2873 656c 662c 206f 7468 6572  rame(self, other
-00019b30: 2c20 6675 6e63 2c20 6669 6c6c 5f76 616c  , func, fill_val
-00019b40: 7565 2c20 6f76 6572 7772 6974 6529 0a20  ue, overwrite). 
-00019b50: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-00019b60: 6572 6976 6564 5f66 726f 6d28 0a20 2020  erived_from(.   
-00019b70: 2020 2020 2070 642e 4461 7461 4672 616d       pd.DataFram
-00019b80: 652c 0a20 2020 2020 2020 2069 6e63 6f6e  e,.        incon
-00019b90: 7369 7374 656e 6369 6573 3d22 6b65 6570  sistencies="keep
-00019ba0: 3d46 616c 7365 2077 696c 6c20 7261 6973  =False will rais
-00019bb0: 6520 6120 6060 4e6f 7449 6d70 6c65 6d65  e a ``NotImpleme
-00019bc0: 6e74 6564 4572 726f 7260 6022 2c0a 2020  ntedError``",.  
-00019bd0: 2020 290a 2020 2020 6465 6620 6472 6f70    ).    def drop
-00019be0: 5f64 7570 6c69 6361 7465 7328 0a20 2020  _duplicates(.   
-00019bf0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00019c00: 2020 2073 7562 7365 743d 4e6f 6e65 2c0a     subset=None,.
-00019c10: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00019c20: 6572 793d 4e6f 6e65 2c0a 2020 2020 2020  ery=None,.      
-00019c30: 2020 7370 6c69 745f 6f75 743d 5472 7565    split_out=True
-00019c40: 2c0a 2020 2020 2020 2020 7368 7566 666c  ,.        shuffl
-00019c50: 655f 6d65 7468 6f64 3d4e 6f6e 652c 0a20  e_method=None,. 
-00019c60: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
-00019c70: 6465 783d 4661 6c73 652c 0a20 2020 2020  dex=False,.     
-00019c80: 2020 206b 6565 703d 2266 6972 7374 222c     keep="first",
-00019c90: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00019ca0: 7368 7566 666c 655f 6d65 7468 6f64 203d  shuffle_method =
-00019cb0: 205f 6765 745f 7368 7566 666c 655f 7072   _get_shuffle_pr
-00019cc0: 6566 6572 7269 6e67 5f6f 7264 6572 2873  eferring_order(s
-00019cd0: 6875 6666 6c65 5f6d 6574 686f 6429 0a20  huffle_method). 
-00019ce0: 2020 2020 2020 2069 6620 6b65 6570 2069         if keep i
-00019cf0: 7320 4661 6c73 653a 0a20 2020 2020 2020  s False:.       
-00019d00: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00019d10: 706c 656d 656e 7465 6445 7272 6f72 2822  plementedError("
-00019d20: 6472 6f70 5f64 7570 6c69 6361 7465 7320  drop_duplicates 
-00019d30: 7769 7468 206b 6565 703d 4661 6c73 6522  with keep=False"
-00019d40: 290a 2020 2020 2020 2020 2320 4661 696c  ).        # Fail
-00019d50: 2065 6172 6c79 2069 6620 7375 6273 6574   early if subset
-00019d60: 2069 7320 6e6f 7420 7661 6c69 642c 2065   is not valid, e
-00019d70: 2e67 2e20 6d69 7373 696e 6720 636f 6c75  .g. missing colu
-00019d80: 6d6e 730a 2020 2020 2020 2020 7375 6273  mns.        subs
-00019d90: 6574 203d 205f 636f 6e76 6572 745f 746f  et = _convert_to
-00019da0: 5f6c 6973 7428 7375 6273 6574 290a 2020  _list(subset).  
-00019db0: 2020 2020 2020 6d65 7461 5f6e 6f6e 656d        meta_nonem
-00019dc0: 7074 7928 7365 6c66 2e5f 6d65 7461 292e  pty(self._meta).
-00019dd0: 6472 6f70 5f64 7570 6c69 6361 7465 7328  drop_duplicates(
-00019de0: 7375 6273 6574 3d73 7562 7365 742c 206b  subset=subset, k
-00019df0: 6565 703d 6b65 6570 290a 2020 2020 2020  eep=keep).      
-00019e00: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00019e10: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-00019e20: 2020 2020 2044 726f 7044 7570 6c69 6361       DropDuplica
-00019e30: 7465 7328 0a20 2020 2020 2020 2020 2020  tes(.           
-00019e40: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00019e50: 2020 2020 2020 2020 2020 2073 7562 7365             subse
-00019e60: 743d 7375 6273 6574 2c0a 2020 2020 2020  t=subset,.      
-00019e70: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
-00019e80: 5f69 6e64 6578 3d69 676e 6f72 655f 696e  _index=ignore_in
-00019e90: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-00019ea0: 2020 2020 2073 706c 6974 5f6f 7574 3d73       split_out=s
-00019eb0: 706c 6974 5f6f 7574 2c0a 2020 2020 2020  plit_out,.      
-00019ec0: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00019ed0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00019ee0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00019ef0: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
-00019f00: 643d 7368 7566 666c 655f 6d65 7468 6f64  d=shuffle_method
-00019f10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019f20: 2020 6b65 6570 3d6b 6565 702c 0a20 2020    keep=keep,.   
-00019f30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00019f40: 2020 2029 0a0a 2020 2020 4069 6e73 6572     )..    @inser
-00019f50: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
-00019f60: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
-00019f70: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
-00019f80: 656c 662c 2066 756e 6374 696f 6e2c 202a  elf, function, *
-00019f90: 6172 6773 2c20 6d65 7461 3d6e 6f5f 6465  args, meta=no_de
-00019fa0: 6661 756c 742c 2061 7869 733d 302c 202a  fault, axis=0, *
-00019fb0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00019fc0: 2020 2222 2250 6172 616c 6c65 6c20 7665    """Parallel ve
-00019fd0: 7273 696f 6e20 6f66 2070 616e 6461 732e  rsion of pandas.
-00019fe0: 4461 7461 4672 616d 652e 6170 706c 790a  DataFrame.apply.
-00019ff0: 0a20 2020 2020 2020 2054 6869 7320 6d69  .        This mi
-0001a000: 6d69 6373 2074 6865 2070 616e 6461 7320  mics the pandas 
-0001a010: 7665 7273 696f 6e20 6578 6365 7074 2066  version except f
-0001a020: 6f72 2074 6865 2066 6f6c 6c6f 7769 6e67  or the following
-0001a030: 3a0a 0a20 2020 2020 2020 2031 2e20 204f  :..        1.  O
-0001a040: 6e6c 7920 6060 6178 6973 3d31 6060 2069  nly ``axis=1`` i
-0001a050: 7320 7375 7070 6f72 7465 6420 2861 6e64  s supported (and
-0001a060: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
-0001a070: 6564 2065 7870 6c69 6369 746c 7929 2e0a  ed explicitly)..
-0001a080: 2020 2020 2020 2020 322e 2020 5468 6520          2.  The 
-0001a090: 7573 6572 2073 686f 756c 6420 7072 6f76  user should prov
-0001a0a0: 6964 6520 6f75 7470 7574 206d 6574 6164  ide output metad
-0001a0b0: 6174 6120 7669 6120 7468 6520 606d 6574  ata via the `met
-0001a0c0: 6160 206b 6579 776f 7264 2e0a 0a20 2020  a` keyword...   
-0001a0d0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0001a0e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001a0f0: 2d2d 0a20 2020 2020 2020 2066 756e 6320  --.        func 
-0001a100: 3a20 6675 6e63 7469 6f6e 0a20 2020 2020  : function.     
-0001a110: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-0001a120: 746f 2061 7070 6c79 2074 6f20 6561 6368  to apply to each
-0001a130: 2063 6f6c 756d 6e2f 726f 770a 2020 2020   column/row.    
-0001a140: 2020 2020 6178 6973 203a 207b 3020 6f72      axis : {0 or
-0001a150: 2027 696e 6465 7827 2c20 3120 6f72 2027   'index', 1 or '
-0001a160: 636f 6c75 6d6e 7327 7d2c 2064 6566 6175  columns'}, defau
-0001a170: 6c74 2030 0a20 2020 2020 2020 2020 2020  lt 0.           
-0001a180: 202d 2030 206f 7220 2769 6e64 6578 273a   - 0 or 'index':
-0001a190: 2061 7070 6c79 2066 756e 6374 696f 6e20   apply function 
-0001a1a0: 746f 2065 6163 6820 636f 6c75 6d6e 2028  to each column (
-0001a1b0: 4e4f 5420 5355 5050 4f52 5445 4429 0a20  NOT SUPPORTED). 
-0001a1c0: 2020 2020 2020 2020 2020 202d 2031 206f             - 1 o
-0001a1d0: 7220 2763 6f6c 756d 6e73 273a 2061 7070  r 'columns': app
-0001a1e0: 6c79 2066 756e 6374 696f 6e20 746f 2065  ly function to e
-0001a1f0: 6163 6820 726f 770a 2020 2020 2020 2020  ach row.        
-0001a200: 244d 4554 410a 2020 2020 2020 2020 6172  $META.        ar
-0001a210: 6773 203a 2074 7570 6c65 0a20 2020 2020  gs : tuple.     
-0001a220: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
-0001a230: 6c20 6172 6775 6d65 6e74 7320 746f 2070  l arguments to p
-0001a240: 6173 7320 746f 2066 756e 6374 696f 6e20  ass to function 
-0001a250: 696e 2061 6464 6974 696f 6e20 746f 2074  in addition to t
-0001a260: 6865 2061 7272 6179 2f73 6572 6965 730a  he array/series.
-0001a270: 0a20 2020 2020 2020 2041 6464 6974 696f  .        Additio
-0001a280: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
-0001a290: 6d65 6e74 7320 7769 6c6c 2062 6520 7061  ments will be pa
-0001a2a0: 7373 6564 2061 7320 6b65 7977 6f72 6473  ssed as keywords
-0001a2b0: 2074 6f20 7468 6520 6675 6e63 7469 6f6e   to the function
-0001a2c0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001a2d0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0001a2e0: 2d0a 2020 2020 2020 2020 6170 706c 6965  -.        applie
-0001a2f0: 6420 3a20 5365 7269 6573 206f 7220 4461  d : Series or Da
-0001a300: 7461 4672 616d 650a 0a20 2020 2020 2020  taFrame..       
-0001a310: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-0001a320: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0001a330: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
-0001a340: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
-0001a350: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0001a360: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
-0001a370: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
-0001a380: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-0001a390: 287b 2778 273a 205b 312c 2032 2c20 332c  ({'x': [1, 2, 3,
-0001a3a0: 2034 2c20 355d 2c0a 2020 2020 2020 2020   4, 5],.        
-0001a3b0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0001a3c0: 2020 2020 2020 2027 7927 3a20 5b31 2e2c         'y': [1.,
-0001a3d0: 2032 2e2c 2033 2e2c 2034 2e2c 2035 2e5d   2., 3., 4., 5.]
-0001a3e0: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
-0001a3f0: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
-0001a400: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
-0001a410: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
-0001a420: 4170 706c 7920 6120 6675 6e63 7469 6f6e  Apply a function
-0001a430: 2074 6f20 726f 772d 7769 7365 2070 6173   to row-wise pas
-0001a440: 7369 6e67 2069 6e20 6578 7472 6120 6172  sing in extra ar
-0001a450: 6775 6d65 6e74 7320 696e 2060 6061 7267  guments in ``arg
-0001a460: 7360 6020 616e 640a 2020 2020 2020 2020  s`` and.        
-0001a470: 6060 6b77 6172 6773 6060 3a0a 0a20 2020  ``kwargs``:..   
-0001a480: 2020 2020 203e 3e3e 2064 6566 206d 7961       >>> def mya
-0001a490: 6464 2872 6f77 2c20 612c 2062 3d31 293a  dd(row, a, b=1):
-0001a4a0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0001a4b0: 2072 6574 7572 6e20 726f 772e 7375 6d28   return row.sum(
-0001a4c0: 2920 2b20 6120 2b20 620a 2020 2020 2020  ) + a + b.      
-0001a4d0: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
-0001a4e0: 6170 706c 7928 6d79 6164 642c 2061 7869  apply(myadd, axi
-0001a4f0: 733d 312c 2061 7267 733d 2832 2c29 2c20  s=1, args=(2,), 
-0001a500: 623d 312e 3529 2020 2320 646f 6374 6573  b=1.5)  # doctes
-0001a510: 743a 202b 534b 4950 0a0a 2020 2020 2020  t: +SKIP..      
-0001a520: 2020 4279 2064 6566 6175 6c74 2c20 6461    By default, da
-0001a530: 736b 2074 7269 6573 2074 6f20 696e 6665  sk tries to infe
-0001a540: 7220 7468 6520 6f75 7470 7574 206d 6574  r the output met
-0001a550: 6164 6174 6120 6279 2072 756e 6e69 6e67  adata by running
-0001a560: 2079 6f75 720a 2020 2020 2020 2020 7072   your.        pr
-0001a570: 6f76 6964 6564 2066 756e 6374 696f 6e20  ovided function 
-0001a580: 6f6e 2073 6f6d 6520 6661 6b65 2064 6174  on some fake dat
-0001a590: 612e 2054 6869 7320 776f 726b 7320 7765  a. This works we
-0001a5a0: 6c6c 2069 6e20 6d61 6e79 2063 6173 6573  ll in many cases
-0001a5b0: 2c20 6275 740a 2020 2020 2020 2020 6361  , but.        ca
-0001a5c0: 6e20 736f 6d65 7469 6d65 7320 6265 2065  n sometimes be e
-0001a5d0: 7870 656e 7369 7665 2c20 6f72 2065 7665  xpensive, or eve
-0001a5e0: 6e20 6661 696c 2e20 546f 2061 766f 6964  n fail. To avoid
-0001a5f0: 2074 6869 732c 2079 6f75 2063 616e 0a20   this, you can. 
-0001a600: 2020 2020 2020 206d 616e 7561 6c6c 7920         manually 
-0001a610: 7370 6563 6966 7920 7468 6520 6f75 7470  specify the outp
-0001a620: 7574 206d 6574 6164 6174 6120 7769 7468  ut metadata with
-0001a630: 2074 6865 2060 606d 6574 6160 6020 6b65   the ``meta`` ke
-0001a640: 7977 6f72 642e 2054 6869 730a 2020 2020  yword. This.    
-0001a650: 2020 2020 6361 6e20 6265 2073 7065 6369      can be speci
-0001a660: 6669 6564 2069 6e20 6d61 6e79 2066 6f72  fied in many for
-0001a670: 6d73 2c20 666f 7220 6d6f 7265 2069 6e66  ms, for more inf
-0001a680: 6f72 6d61 7469 6f6e 2073 6565 0a20 2020  ormation see.   
-0001a690: 2020 2020 2060 6064 6173 6b2e 6461 7461       ``dask.data
-0001a6a0: 6672 616d 652e 7574 696c 732e 6d61 6b65  frame.utils.make
-0001a6b0: 5f6d 6574 6160 602e 0a0a 2020 2020 2020  _meta``...      
-0001a6c0: 2020 4865 7265 2077 6520 7370 6563 6966    Here we specif
-0001a6d0: 7920 7468 6520 6f75 7470 7574 2069 7320  y the output is 
-0001a6e0: 6120 5365 7269 6573 2077 6974 6820 6e61  a Series with na
-0001a6f0: 6d65 2060 6027 7827 6060 2c20 616e 6420  me ``'x'``, and 
-0001a700: 6474 7970 650a 2020 2020 2020 2020 6060  dtype.        ``
-0001a710: 666c 6f61 7436 3460 603a 0a0a 2020 2020  float64``:..    
-0001a720: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-0001a730: 662e 6170 706c 7928 6d79 6164 642c 2061  f.apply(myadd, a
-0001a740: 7869 733d 312c 2061 7267 733d 2832 2c29  xis=1, args=(2,)
-0001a750: 2c20 623d 312e 352c 206d 6574 613d 2827  , b=1.5, meta=('
-0001a760: 7827 2c20 2766 3827 2929 0a0a 2020 2020  x', 'f8'))..    
-0001a770: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
-0001a780: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
-0001a790: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
-0001a7a0: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
-0001a7b0: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
-0001a7c0: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
-0001a7d0: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
-0001a7e0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-0001a7f0: 6466 2e61 7070 6c79 286c 616d 6264 6120  df.apply(lambda 
-0001a800: 726f 773a 2072 6f77 202b 2031 2c20 6178  row: row + 1, ax
-0001a810: 6973 3d31 2c20 6d65 7461 3d64 6466 290a  is=1, meta=ddf).
-0001a820: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-0001a830: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-0001a840: 2d2d 0a20 2020 2020 2020 2044 6174 6146  --.        DataF
-0001a850: 7261 6d65 2e6d 6170 5f70 6172 7469 7469  rame.map_partiti
-0001a860: 6f6e 730a 2020 2020 2020 2020 2222 220a  ons.        """.
-0001a870: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-0001a880: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-0001a890: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-0001a8a0: 2069 6620 6178 6973 203d 3d20 303a 0a20   if axis == 0:. 
-0001a8b0: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-0001a8c0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0001a8d0: 2020 2022 4461 736b 2044 6174 6146 7261     "Dask DataFra
-0001a8e0: 6d65 2e61 7070 6c79 206f 6e6c 7920 7375  me.apply only su
-0001a8f0: 7070 6f72 7473 2061 7869 733d 315c 6e22  pports axis=1\n"
-0001a900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a910: 2022 2020 5472 793a 2064 662e 6170 706c   "  Try: df.appl
-0001a920: 7928 6675 6e63 2c20 6178 6973 3d31 2922  y(func, axis=1)"
-0001a930: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001a940: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001a950: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-0001a960: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
-0001a970: 2020 6966 206d 6574 6120 6973 206e 6f5f    if meta is no_
-0001a980: 6465 6661 756c 743a 0a20 2020 2020 2020  default:.       
-0001a990: 2020 2020 206d 6574 6120 3d20 6578 7072       meta = expr
-0001a9a0: 2e5f 656d 756c 6174 6528 0a20 2020 2020  ._emulate(.     
-0001a9b0: 2020 2020 2020 2020 2020 204d 2e61 7070             M.app
-0001a9c0: 6c79 2c20 7365 6c66 2c20 6675 6e63 7469  ly, self, functi
-0001a9d0: 6f6e 2c20 6172 6773 3d61 7267 732c 2075  on, args=args, u
-0001a9e0: 6466 3d54 7275 652c 2061 7869 733d 6178  df=True, axis=ax
-0001a9f0: 6973 2c20 2a2a 6b77 6172 6773 0a20 2020  is, **kwargs.   
-0001aa00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001aa10: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-0001aa20: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
-0001aa30: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
-0001aa40: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0001aa50: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-0001aa60: 2020 2020 7365 6c66 2e65 7870 722e 6170      self.expr.ap
-0001aa70: 706c 7928 6675 6e63 7469 6f6e 2c20 2a61  ply(function, *a
-0001aa80: 7267 732c 206d 6574 613d 6d65 7461 2c20  rgs, meta=meta, 
-0001aa90: 6178 6973 3d61 7869 732c 202a 2a6b 7761  axis=axis, **kwa
-0001aaa0: 7267 7329 0a20 2020 2020 2020 2029 0a0a  rgs).        )..
-0001aab0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001aac0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001aad0: 2020 2020 6465 6620 6472 6f70 6e61 2873      def dropna(s
-0001aae0: 656c 662c 2068 6f77 3d6e 6f5f 6465 6661  elf, how=no_defa
-0001aaf0: 756c 742c 2073 7562 7365 743d 4e6f 6e65  ult, subset=None
-0001ab00: 2c20 7468 7265 7368 3d6e 6f5f 6465 6661  , thresh=no_defa
-0001ab10: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
-0001ab20: 2068 6f77 2069 7320 6e6f 7420 6e6f 5f64   how is not no_d
-0001ab30: 6566 6175 6c74 2061 6e64 2074 6872 6573  efault and thres
-0001ab40: 6820 6973 206e 6f74 206e 6f5f 6465 6661  h is not no_defa
-0001ab50: 756c 743a 0a20 2020 2020 2020 2020 2020  ult:.           
-0001ab60: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0001ab70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001ab80: 2020 2259 6f75 2063 616e 6e6f 7420 7365    "You cannot se
-0001ab90: 7420 626f 7468 2074 6865 2068 6f77 2061  t both the how a
-0001aba0: 6e64 2074 6872 6573 6820 6172 6775 6d65  nd thresh argume
-0001abb0: 6e74 7320 6174 2074 6865 2073 616d 6520  nts at the same 
-0001abc0: 7469 6d65 2e22 0a20 2020 2020 2020 2020  time.".         
-0001abd0: 2020 2029 0a20 2020 2020 2020 2073 7562     ).        sub
-0001abe0: 7365 7420 3d20 5f63 6f6e 7665 7274 5f74  set = _convert_t
-0001abf0: 6f5f 6c69 7374 2873 7562 7365 7429 0a20  o_list(subset). 
-0001ac00: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0001ac10: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-0001ac20: 2020 2020 2020 2020 2020 6578 7072 2e44            expr.D
-0001ac30: 726f 706e 6146 7261 6d65 2873 656c 662c  ropnaFrame(self,
-0001ac40: 2068 6f77 3d68 6f77 2c20 7375 6273 6574   how=how, subset
-0001ac50: 3d73 7562 7365 742c 2074 6872 6573 683d  =subset, thresh=
-0001ac60: 7468 7265 7368 290a 2020 2020 2020 2020  thresh).        
-0001ac70: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
-0001ac80: 686f 640a 2020 2020 6465 6620 5f76 616c  hod.    def _val
-0001ac90: 6964 6174 655f 6178 6973 2863 6c73 2c20  idate_axis(cls, 
-0001aca0: 6178 6973 3d30 2c20 6e75 6d65 7269 635f  axis=0, numeric_
-0001acb0: 6178 6973 3a20 626f 6f6c 203d 2054 7275  axis: bool = Tru
-0001acc0: 6529 202d 3e20 4e6f 6e65 207c 204c 6974  e) -> None | Lit
-0001acd0: 6572 616c 5b30 2c20 315d 3a0a 2020 2020  eral[0, 1]:.    
-0001ace0: 2020 2020 6966 2061 7869 7320 6e6f 7420      if axis not 
-0001acf0: 696e 2028 302c 2031 2c20 2269 6e64 6578  in (0, 1, "index
-0001ad00: 222c 2022 636f 6c75 6d6e 7322 2c20 4e6f  ", "columns", No
-0001ad10: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-0001ad20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001ad30: 7228 6622 4e6f 2061 7869 7320 6e61 6d65  r(f"No axis name
-0001ad40: 6420 7b61 7869 737d 2229 0a20 2020 2020  d {axis}").     
-0001ad50: 2020 2069 6620 6e75 6d65 7269 635f 6178     if numeric_ax
-0001ad60: 6973 3a0a 2020 2020 2020 2020 2020 2020  is:.            
-0001ad70: 6e75 6d5f 6178 6973 3a20 6469 6374 5b73  num_axis: dict[s
-0001ad80: 7472 207c 204e 6f6e 652c 204c 6974 6572  tr | None, Liter
-0001ad90: 616c 5b30 2c20 315d 5d20 3d20 7b22 696e  al[0, 1]] = {"in
-0001ada0: 6465 7822 3a20 302c 2022 636f 6c75 6d6e  dex": 0, "column
-0001adb0: 7322 3a20 317d 0a20 2020 2020 2020 2020  s": 1}.         
-0001adc0: 2020 2072 6574 7572 6e20 6e75 6d5f 6178     return num_ax
-0001add0: 6973 2e67 6574 2861 7869 732c 2061 7869  is.get(axis, axi
-0001ade0: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
-0001adf0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001ae00: 7572 6e20 6178 6973 0a0a 2020 2020 4064  urn axis..    @d
-0001ae10: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001ae20: 6174 6146 7261 6d65 2c20 7561 5f61 7267  ataFrame, ua_arg
-0001ae30: 733d 5b22 696e 6465 7822 5d29 0a20 2020  s=["index"]).   
-0001ae40: 2064 6566 2072 656e 616d 6528 7365 6c66   def rename(self
-0001ae50: 2c20 696e 6465 783d 4e6f 6e65 2c20 636f  , index=None, co
-0001ae60: 6c75 6d6e 733d 4e6f 6e65 293a 0a20 2020  lumns=None):.   
-0001ae70: 2020 2020 2069 6620 696e 6465 7820 6973       if index is
-0001ae80: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0001ae90: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001aea0: 7565 4572 726f 7228 2243 616e 6e6f 7420  ueError("Cannot 
-0001aeb0: 7265 6e61 6d65 2069 6e64 6578 2e22 290a  rename index.").
-0001aec0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0001aed0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-0001aee0: 7072 2e52 656e 616d 6546 7261 6d65 2873  pr.RenameFrame(s
-0001aef0: 656c 662c 2063 6f6c 756d 6e73 3d63 6f6c  elf, columns=col
-0001af00: 756d 6e73 2929 0a0a 2020 2020 4064 6572  umns))..    @der
-0001af10: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0001af20: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0001af30: 7371 7565 657a 6528 7365 6c66 2c20 6178  squeeze(self, ax
-0001af40: 6973 3d4e 6f6e 6529 3a0a 2020 2020 2020  is=None):.      
-0001af50: 2020 6966 2061 7869 7320 696e 205b 4e6f    if axis in [No
-0001af60: 6e65 2c20 315d 3a0a 2020 2020 2020 2020  ne, 1]:.        
-0001af70: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-0001af80: 636f 6c75 6d6e 7329 203d 3d20 313a 0a20  columns) == 1:. 
-0001af90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001afa0: 6574 7572 6e20 7365 6c66 5b73 656c 662e  eturn self[self.
-0001afb0: 636f 6c75 6d6e 735b 305d 5d0a 2020 2020  columns[0]].    
-0001afc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001afd0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001afe0: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
-0001aff0: 2020 2065 6c69 6620 6178 6973 203d 3d20     elif axis == 
-0001b000: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-0001b010: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0001b020: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-0001b030: 2020 2020 2020 2020 2020 6622 7b74 7970            f"{typ
-0001b040: 6528 7365 6c66 297d 2064 6f65 7320 6e6f  e(self)} does no
-0001b050: 7420 7375 7070 6f72 7420 7371 7565 657a  t support squeez
-0001b060: 6520 616c 6f6e 6720 6178 6973 2030 220a  e along axis 0".
-0001b070: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001b080: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001b090: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001b0a0: 616c 7565 4572 726f 7228 6622 4e6f 2061  alueError(f"No a
-0001b0b0: 7869 7320 7b61 7869 737d 2066 6f72 206f  xis {axis} for o
-0001b0c0: 626a 6563 7420 7479 7065 207b 7479 7065  bject type {type
-0001b0d0: 2873 656c 6629 7d22 290a 0a20 2020 2040  (self)}")..    @
-0001b0e0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001b0f0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001b100: 6566 2065 7870 6c6f 6465 2873 656c 662c  ef explode(self,
-0001b110: 2063 6f6c 756d 6e29 3a0a 2020 2020 2020   column):.      
-0001b120: 2020 636f 6c75 6d6e 203d 205f 636f 6e76    column = _conv
-0001b130: 6572 745f 746f 5f6c 6973 7428 636f 6c75  ert_to_list(colu
-0001b140: 6d6e 290a 2020 2020 2020 2020 7265 7475  mn).        retu
-0001b150: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0001b160: 6e28 6578 7072 2e45 7870 6c6f 6465 4672  n(expr.ExplodeFr
-0001b170: 616d 6528 7365 6c66 2c20 636f 6c75 6d6e  ame(self, column
-0001b180: 3d63 6f6c 756d 6e29 290a 0a20 2020 2040  =column))..    @
-0001b190: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001b1a0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001b1b0: 6566 2064 726f 7028 7365 6c66 2c20 6c61  ef drop(self, la
-0001b1c0: 6265 6c73 3d4e 6f6e 652c 2061 7869 733d  bels=None, axis=
-0001b1d0: 302c 2063 6f6c 756d 6e73 3d4e 6f6e 652c  0, columns=None,
-0001b1e0: 2065 7272 6f72 733d 2272 6169 7365 2229   errors="raise")
-0001b1f0: 3a0a 2020 2020 2020 2020 6966 2063 6f6c  :.        if col
-0001b200: 756d 6e73 2069 7320 4e6f 6e65 2061 6e64  umns is None and
-0001b210: 206c 6162 656c 7320 6973 204e 6f6e 653a   labels is None:
-0001b220: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001b230: 7365 2054 7970 6545 7272 6f72 2822 6d75  se TypeError("mu
-0001b240: 7374 2065 6974 6865 7220 7370 6563 6966  st either specif
-0001b250: 7920 2763 6f6c 756d 6e73 2720 6f72 2027  y 'columns' or '
-0001b260: 6c61 6265 6c73 2722 290a 0a20 2020 2020  labels'")..     
-0001b270: 2020 2061 7869 7320 3d20 5f76 616c 6964     axis = _valid
-0001b280: 6174 655f 6178 6973 2861 7869 7329 0a0a  ate_axis(axis)..
-0001b290: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-0001b2a0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0001b2b0: 2020 636f 6c75 6d6e 7320 3d20 6c61 6265    columns = labe
-0001b2c0: 6c73 206f 7220 636f 6c75 6d6e 730a 2020  ls or columns.  
-0001b2d0: 2020 2020 2020 656c 6966 2061 7869 7320        elif axis 
-0001b2e0: 3d3d 2030 2061 6e64 2063 6f6c 756d 6e73  == 0 and columns
-0001b2f0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0001b300: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-0001b310: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-0001b320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b330: 2022 4472 6f70 2063 7572 7265 6e74 6c79   "Drop currently
-0001b340: 206f 6e6c 7920 776f 726b 7320 666f 7220   only works for 
-0001b350: 6178 6973 3d31 206f 7220 7768 656e 2063  axis=1 or when c
-0001b360: 6f6c 756d 6e73 2069 7320 6e6f 7420 4e6f  olumns is not No
-0001b370: 6e65 220a 2020 2020 2020 2020 2020 2020  ne".            
-0001b380: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001b390: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0001b3a0: 6578 7072 2e44 726f 7028 7365 6c66 2c20  expr.Drop(self, 
-0001b3b0: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
-0001b3c0: 2065 7272 6f72 733d 6572 726f 7273 2929   errors=errors))
-0001b3d0: 0a0a 2020 2020 6465 6620 746f 5f70 6172  ..    def to_par
-0001b3e0: 7175 6574 2873 656c 662c 2070 6174 682c  quet(self, path,
-0001b3f0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-0001b400: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
-0001b410: 7072 2e69 6f2e 7061 7271 7565 7420 696d  pr.io.parquet im
-0001b420: 706f 7274 2074 6f5f 7061 7271 7565 740a  port to_parquet.
-0001b430: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001b440: 746f 5f70 6172 7175 6574 2873 656c 662c  to_parquet(self,
-0001b450: 2070 6174 682c 202a 2a6b 7761 7267 7329   path, **kwargs)
-0001b460: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001b470: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0001b480: 290a 2020 2020 6465 6620 7365 6c65 6374  ).    def select
-0001b490: 5f64 7479 7065 7328 7365 6c66 2c20 696e  _dtypes(self, in
-0001b4a0: 636c 7564 653d 4e6f 6e65 2c20 6578 636c  clude=None, excl
-0001b4b0: 7564 653d 4e6f 6e65 293a 0a20 2020 2020  ude=None):.     
-0001b4c0: 2020 2063 6f6c 756d 6e73 203d 206c 6973     columns = lis
-0001b4d0: 7428 0a20 2020 2020 2020 2020 2020 2073  t(.            s
-0001b4e0: 656c 662e 5f6d 6574 612e 7365 6c65 6374  elf._meta.select
-0001b4f0: 5f64 7479 7065 7328 696e 636c 7564 653d  _dtypes(include=
-0001b500: 696e 636c 7564 652c 2065 7863 6c75 6465  include, exclude
-0001b510: 3d65 7863 6c75 6465 292e 636f 6c75 6d6e  =exclude).column
-0001b520: 730a 2020 2020 2020 2020 290a 2020 2020  s.        ).    
-0001b530: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0001b540: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
-0001b550: 7870 725b 636f 6c75 6d6e 735d 290a 0a20  xpr[columns]).. 
-0001b560: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0001b570: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0001b580: 2020 2064 6566 2065 7661 6c28 7365 6c66     def eval(self
-0001b590: 2c20 6578 7072 2c20 2a2a 6b77 6172 6773  , expr, **kwargs
-0001b5a0: 293a 0a20 2020 2020 2020 2069 6620 2269  ):.        if "i
-0001b5b0: 6e70 6c61 6365 2220 696e 206b 7761 7267  nplace" in kwarg
-0001b5c0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0001b5d0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0001b5e0: 7465 6445 7272 6f72 2822 696e 706c 6163  tedError("inplac
-0001b5f0: 6520 6973 206e 6f74 2073 7570 706f 7274  e is not support
-0001b600: 6564 2066 6f72 2065 7661 6c22 290a 2020  ed for eval").  
-0001b610: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001b620: 5f63 6f6c 6c65 6374 696f 6e28 4576 616c  _collection(Eval
-0001b630: 2873 656c 662c 205f 6578 7072 3d65 7870  (self, _expr=exp
-0001b640: 722c 2065 7870 725f 6b77 6172 6773 3d6b  r, expr_kwargs=k
-0001b650: 7761 7267 7329 290a 0a20 2020 2064 6566  wargs))..    def
-0001b660: 2073 6574 5f69 6e64 6578 280a 2020 2020   set_index(.    
-0001b670: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0001b680: 2020 6f74 6865 722c 0a20 2020 2020 2020    other,.       
-0001b690: 2064 726f 703d 5472 7565 2c0a 2020 2020   drop=True,.    
-0001b6a0: 2020 2020 736f 7274 6564 3d46 616c 7365      sorted=False
-0001b6b0: 2c0a 2020 2020 2020 2020 6e70 6172 7469  ,.        nparti
-0001b6c0: 7469 6f6e 733a 2069 6e74 207c 204e 6f6e  tions: int | Non
-0001b6d0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0001b6e0: 2020 6469 7669 7369 6f6e 733d 4e6f 6e65    divisions=None
-0001b6f0: 2c0a 2020 2020 2020 2020 736f 7274 3a20  ,.        sort: 
-0001b700: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-0001b710: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
-0001b720: 686f 643d 4e6f 6e65 2c0a 2020 2020 2020  hod=None,.      
-0001b730: 2020 7570 7361 6d70 6c65 3a20 666c 6f61    upsample: floa
-0001b740: 7420 3d20 312e 302c 0a20 2020 2020 2020  t = 1.0,.       
-0001b750: 2070 6172 7469 7469 6f6e 5f73 697a 653a   partition_size:
-0001b760: 2066 6c6f 6174 203d 2031 3238 6536 2c0a   float = 128e6,.
-0001b770: 2020 2020 2020 2020 6170 7065 6e64 3a20          append: 
-0001b780: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0001b790: 2020 2020 2020 2a2a 6f70 7469 6f6e 732c        **options,
-0001b7a0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001b7b0: 2222 2253 6574 2074 6865 2044 6174 6146  """Set the DataF
-0001b7c0: 7261 6d65 2069 6e64 6578 2028 726f 7720  rame index (row 
-0001b7d0: 6c61 6265 6c73 2920 7573 696e 6720 616e  labels) using an
-0001b7e0: 2065 7869 7374 696e 6720 636f 6c75 6d6e   existing column
-0001b7f0: 2e0a 0a20 2020 2020 2020 2049 6620 6060  ...        If ``
-0001b800: 736f 7274 3d46 616c 7365 6060 2c20 7468  sort=False``, th
-0001b810: 6973 2066 756e 6374 696f 6e20 6f70 6572  is function oper
-0001b820: 6174 6573 2065 7861 6374 6c79 206c 696b  ates exactly lik
-0001b830: 6520 6060 7061 6e64 6173 2e73 6574 5f69  e ``pandas.set_i
-0001b840: 6e64 6578 6060 0a20 2020 2020 2020 2061  ndex``.        a
-0001b850: 6e64 2073 6574 7320 7468 6520 696e 6465  nd sets the inde
-0001b860: 7820 6f6e 2074 6865 2044 6174 6146 7261  x on the DataFra
-0001b870: 6d65 2e20 4966 2060 6073 6f72 743d 5472  me. If ``sort=Tr
-0001b880: 7565 6060 2028 6465 6661 756c 7429 2c0a  ue`` (default),.
-0001b890: 2020 2020 2020 2020 7468 6973 2066 756e          this fun
-0001b8a0: 6374 696f 6e20 616c 736f 2073 6f72 7473  ction also sorts
-0001b8b0: 2074 6865 2044 6174 6146 7261 6d65 2062   the DataFrame b
-0001b8c0: 7920 7468 6520 6e65 7720 696e 6465 782e  y the new index.
-0001b8d0: 2054 6869 7320 6361 6e20 6861 7665 2061   This can have a
-0001b8e0: 0a20 2020 2020 2020 2073 6967 6e69 6669  .        signifi
-0001b8f0: 6361 6e74 2069 6d70 6163 7420 6f6e 2070  cant impact on p
-0001b900: 6572 666f 726d 616e 6365 2c20 6265 6361  erformance, beca
-0001b910: 7573 6520 6a6f 696e 732c 2067 726f 7570  use joins, group
-0001b920: 6279 732c 206c 6f6f 6b75 7073 2c20 6574  bys, lookups, et
-0001b930: 632e 0a20 2020 2020 2020 2061 7265 2061  c..        are a
-0001b940: 6c6c 206d 7563 6820 6661 7374 6572 206f  ll much faster o
-0001b950: 6e20 7468 6174 2063 6f6c 756d 6e2e 2048  n that column. H
-0001b960: 6f77 6576 6572 2c20 7468 6973 2070 6572  owever, this per
-0001b970: 666f 726d 616e 6365 2069 6e63 7265 6173  formance increas
-0001b980: 650a 2020 2020 2020 2020 636f 6d65 7320  e.        comes 
-0001b990: 7769 7468 2061 2063 6f73 742c 2073 6f72  with a cost, sor
-0001b9a0: 7469 6e67 2061 2070 6172 616c 6c65 6c20  ting a parallel 
-0001b9b0: 6461 7461 7365 7420 7265 7175 6972 6573  dataset requires
-0001b9c0: 2065 7870 656e 7369 7665 2073 6875 6666   expensive shuff
-0001b9d0: 6c65 732e 0a20 2020 2020 2020 204f 6674  les..        Oft
-0001b9e0: 656e 2077 6520 6060 7365 745f 696e 6465  en we ``set_inde
-0001b9f0: 7860 6020 6f6e 6365 2064 6972 6563 746c  x`` once directl
-0001ba00: 7920 6166 7465 7220 6461 7461 2069 6e67  y after data ing
-0001ba10: 6573 7420 616e 6420 6669 6c74 6572 696e  est and filterin
-0001ba20: 6720 616e 640a 2020 2020 2020 2020 7468  g and.        th
-0001ba30: 656e 2070 6572 666f 726d 206d 616e 7920  en perform many 
-0001ba40: 6368 6561 7020 636f 6d70 7574 6174 696f  cheap computatio
-0001ba50: 6e73 206f 6666 206f 6620 7468 6520 736f  ns off of the so
-0001ba60: 7274 6564 2064 6174 6173 6574 2e0a 0a20  rted dataset... 
-0001ba70: 2020 2020 2020 2057 6974 6820 6060 736f         With ``so
-0001ba80: 7274 3d54 7275 6560 602c 2074 6869 7320  rt=True``, this 
-0001ba90: 6675 6e63 7469 6f6e 2069 7320 6d75 6368  function is much
-0001baa0: 206d 6f72 6520 6578 7065 6e73 6976 652e   more expensive.
-0001bab0: 2055 6e64 6572 206e 6f72 6d61 6c0a 2020   Under normal.  
-0001bac0: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
-0001bad0: 7468 6973 2066 756e 6374 696f 6e20 646f  this function do
-0001bae0: 6573 2061 6e20 696e 6974 6961 6c20 7061  es an initial pa
-0001baf0: 7373 206f 7665 7220 7468 6520 696e 6465  ss over the inde
-0001bb00: 7820 636f 6c75 6d6e 2074 6f0a 2020 2020  x column to.    
-0001bb10: 2020 2020 636f 6d70 7574 6520 6170 7072      compute appr
-0001bb20: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
-0001bb30: 7320 746f 2073 6572 7665 2061 7320 6675  s to serve as fu
-0001bb40: 7475 7265 2064 6976 6973 696f 6e73 2e20  ture divisions. 
-0001bb50: 4974 2074 6865 6e20 7061 7373 6573 0a20  It then passes. 
-0001bb60: 2020 2020 2020 206f 7665 7220 7468 6520         over the 
-0001bb70: 6461 7461 2061 2073 6563 6f6e 6420 7469  data a second ti
-0001bb80: 6d65 2c20 7370 6c69 7474 696e 6720 7570  me, splitting up
-0001bb90: 2065 6163 6820 696e 7075 7420 7061 7274   each input part
-0001bba0: 6974 696f 6e20 696e 746f 2073 6576 6572  ition into sever
-0001bbb0: 616c 0a20 2020 2020 2020 2070 6965 6365  al.        piece
-0001bbc0: 7320 616e 6420 7368 6172 696e 6720 7468  s and sharing th
-0001bbd0: 6f73 6520 7069 6563 6573 2074 6f20 616c  ose pieces to al
-0001bbe0: 6c20 6f66 2074 6865 206f 7574 7075 7420  l of the output 
-0001bbf0: 7061 7274 6974 696f 6e73 206e 6f77 2069  partitions now i
-0001bc00: 6e0a 2020 2020 2020 2020 736f 7274 6564  n.        sorted
-0001bc10: 206f 7264 6572 2e0a 0a20 2020 2020 2020   order...       
-0001bc20: 2049 6e20 736f 6d65 2063 6173 6573 2077   In some cases w
-0001bc30: 6520 6361 6e20 616c 6c65 7669 6174 6520  e can alleviate 
-0001bc40: 7468 6f73 6520 636f 7374 732c 2066 6f72  those costs, for
-0001bc50: 2065 7861 6d70 6c65 2069 6620 796f 7572   example if your
-0001bc60: 2064 6174 6173 6574 2069 730a 2020 2020   dataset is.    
-0001bc70: 2020 2020 736f 7274 6564 2061 6c72 6561      sorted alrea
-0001bc80: 6479 2074 6865 6e20 7765 2063 616e 2061  dy then we can a
-0001bc90: 766f 6964 206d 616b 696e 6720 6d61 6e79  void making many
-0001bca0: 2073 6d61 6c6c 2070 6965 6365 7320 6f72   small pieces or
-0001bcb0: 2069 6620 796f 7520 6b6e 6f77 0a20 2020   if you know.   
-0001bcc0: 2020 2020 2067 6f6f 6420 7661 6c75 6573       good values
-0001bcd0: 2074 6f20 7370 6c69 7420 7468 6520 6e65   to split the ne
-0001bce0: 7720 696e 6465 7820 636f 6c75 6d6e 2074  w index column t
-0001bcf0: 6865 6e20 7765 2063 616e 2061 766f 6964  hen we can avoid
-0001bd00: 2074 6865 2069 6e69 7469 616c 0a20 2020   the initial.   
-0001bd10: 2020 2020 2070 6173 7320 6f76 6572 2074       pass over t
-0001bd20: 6865 2064 6174 612e 2046 6f72 2065 7861  he data. For exa
-0001bd30: 6d70 6c65 2069 6620 796f 7572 206e 6577  mple if your new
-0001bd40: 2069 6e64 6578 2069 7320 6120 6461 7465   index is a date
-0001bd50: 7469 6d65 2069 6e64 6578 2061 6e64 0a20  time index and. 
-0001bd60: 2020 2020 2020 2079 6f75 7220 6461 7461         your data
-0001bd70: 2069 7320 616c 7265 6164 7920 736f 7274   is already sort
-0001bd80: 6564 2062 7920 6461 7920 7468 656e 2074  ed by day then t
-0001bd90: 6869 7320 656e 7469 7265 206f 7065 7261  his entire opera
-0001bda0: 7469 6f6e 2063 616e 2062 6520 646f 6e65  tion can be done
-0001bdb0: 0a20 2020 2020 2020 2066 6f72 2066 7265  .        for fre
-0001bdc0: 652e 2059 6f75 2063 616e 2063 6f6e 7472  e. You can contr
-0001bdd0: 6f6c 2074 6865 7365 206f 7074 696f 6e73  ol these options
-0001bde0: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
-0001bdf0: 696e 6720 7061 7261 6d65 7465 7273 2e0a  ing parameters..
-0001be00: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001be10: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0001be20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
-0001be30: 7468 6572 3a20 7374 7269 6e67 206f 7220  ther: string or 
-0001be40: 4461 736b 2053 6572 6965 730a 2020 2020  Dask Series.    
-0001be50: 2020 2020 2020 2020 436f 6c75 6d6e 2074          Column t
-0001be60: 6f20 7573 6520 6173 2069 6e64 6578 2e0a  o use as index..
-0001be70: 2020 2020 2020 2020 6472 6f70 3a20 626f          drop: bo
-0001be80: 6f6c 6561 6e2c 2064 6566 6175 6c74 2054  olean, default T
-0001be90: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0001bea0: 4465 6c65 7465 2063 6f6c 756d 6e20 746f  Delete column to
-0001beb0: 2062 6520 7573 6564 2061 7320 7468 6520   be used as the 
-0001bec0: 6e65 7720 696e 6465 782e 0a20 2020 2020  new index..     
-0001bed0: 2020 2073 6f72 7465 643a 2062 6f6f 6c2c     sorted: bool,
-0001bee0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0001bef0: 2020 2020 2020 4966 2074 6865 2069 6e64        If the ind
-0001bf00: 6578 2063 6f6c 756d 6e20 6973 2061 6c72  ex column is alr
-0001bf10: 6561 6479 2073 6f72 7465 6420 696e 2069  eady sorted in i
-0001bf20: 6e63 7265 6173 696e 6720 6f72 6465 722e  ncreasing order.
-0001bf30: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
-0001bf40: 6175 6c74 7320 746f 2046 616c 7365 0a20  aults to False. 
-0001bf50: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0001bf60: 6e73 3a20 696e 742c 204e 6f6e 652c 206f  ns: int, None, o
-0001bf70: 7220 2761 7574 6f27 0a20 2020 2020 2020  r 'auto'.       
-0001bf80: 2020 2020 2054 6865 2069 6465 616c 206e       The ideal n
-0001bf90: 756d 6265 7220 6f66 206f 7574 7075 7420  umber of output 
-0001bfa0: 7061 7274 6974 696f 6e73 2e20 4966 204e  partitions. If N
-0001bfb0: 6f6e 652c 2075 7365 2074 6865 2073 616d  one, use the sam
-0001bfc0: 6520 6173 0a20 2020 2020 2020 2020 2020  e as.           
-0001bfd0: 2074 6865 2069 6e70 7574 2e20 4966 2027   the input. If '
-0001bfe0: 6175 746f 2720 7468 656e 2064 6563 6964  auto' then decid
-0001bff0: 6520 6279 206d 656d 6f72 7920 7573 652e  e by memory use.
-0001c000: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
-0001c010: 7920 7573 6564 2077 6865 6e20 6060 6469  y used when ``di
-0001c020: 7669 7369 6f6e 7360 6020 6973 206e 6f74  visions`` is not
-0001c030: 2067 6976 656e 2e20 4966 2060 6064 6976   given. If ``div
-0001c040: 6973 696f 6e73 6060 2069 7320 6769 7665  isions`` is give
-0001c050: 6e2c 0a20 2020 2020 2020 2020 2020 2074  n,.            t
-0001c060: 6865 206e 756d 6265 7220 6f66 206f 7574  he number of out
-0001c070: 7075 7420 7061 7274 6974 696f 6e73 2077  put partitions w
-0001c080: 696c 6c20 6265 2060 606c 656e 2864 6976  ill be ``len(div
-0001c090: 6973 696f 6e73 2920 2d20 3160 602e 0a20  isions) - 1``.. 
-0001c0a0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-0001c0b0: 3a20 6c69 7374 2c20 6f70 7469 6f6e 616c  : list, optional
-0001c0c0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-0001c0d0: 2022 6469 7669 6469 6e67 206c 696e 6573   "dividing lines
-0001c0e0: 2220 7573 6564 2074 6f20 7370 6c69 7420  " used to split 
-0001c0f0: 7468 6520 6e65 7720 696e 6465 7820 696e  the new index in
-0001c100: 746f 2070 6172 7469 7469 6f6e 732e 0a20  to partitions.. 
-0001c110: 2020 2020 2020 2020 2020 2046 6f72 2060             For `
-0001c120: 6064 6976 6973 696f 6e73 3d5b 302c 2031  `divisions=[0, 1
-0001c130: 302c 2035 302c 2031 3030 5d60 602c 2074  0, 50, 100]``, t
-0001c140: 6865 7265 2077 6f75 6c64 2062 6520 7468  here would be th
-0001c150: 7265 6520 6f75 7470 7574 2070 6172 7469  ree output parti
-0001c160: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
-0001c170: 2020 2077 6865 7265 2074 6865 206e 6577     where the new
-0001c180: 2069 6e64 6578 2063 6f6e 7461 696e 6564   index contained
-0001c190: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
-0001c1a0: 3029 2c20 616e 6420 5b35 302c 2031 3030  0), and [50, 100
-0001c1b0: 292c 2072 6573 7065 6374 6976 656c 792e  ), respectively.
-0001c1c0: 0a20 2020 2020 2020 2020 2020 2053 6565  .            See
-0001c1d0: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
-0001c1e0: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
-0001c1f0: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
-0001c200: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
-0001c210: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
-0001c220: 6620 6e6f 7420 6769 7665 6e20 2864 6566  f not given (def
-0001c230: 6175 6c74 292c 2067 6f6f 6420 6469 7669  ault), good divi
-0001c240: 7369 6f6e 7320 6172 6520 6361 6c63 756c  sions are calcul
-0001c250: 6174 6564 2062 7920 696d 6d65 6469 6174  ated by immediat
-0001c260: 656c 7920 636f 6d70 7574 696e 670a 2020  ely computing.  
-0001c270: 2020 2020 2020 2020 2020 7468 6520 6461            the da
-0001c280: 7461 2061 6e64 206c 6f6f 6b69 6e67 2061  ta and looking a
-0001c290: 7420 7468 6520 6469 7374 7269 6275 7469  t the distributi
-0001c2a0: 6f6e 206f 6620 6974 7320 7661 6c75 6573  on of its values
-0001c2b0: 2e20 466f 7220 6c61 7267 6520 6461 7461  . For large data
-0001c2c0: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
-0001c2d0: 2020 7468 6973 2063 616e 2062 6520 6578    this can be ex
-0001c2e0: 7065 6e73 6976 652e 0a20 2020 2020 2020  pensive..       
-0001c2f0: 2020 2020 204e 6f74 6520 7468 6174 2069       Note that i
-0001c300: 6620 6060 736f 7274 6564 3d54 7275 6560  f ``sorted=True`
-0001c310: 602c 2073 7065 6369 6669 6564 2064 6976  `, specified div
-0001c320: 6973 696f 6e73 2061 7265 2061 7373 756d  isions are assum
-0001c330: 6564 2074 6f20 6d61 7463 680a 2020 2020  ed to match.    
-0001c340: 2020 2020 2020 2020 7468 6520 6578 6973          the exis
-0001c350: 7469 6e67 2070 6172 7469 7469 6f6e 7320  ting partitions 
-0001c360: 696e 2074 6865 2064 6174 613b 2069 6620  in the data; if 
-0001c370: 7468 6973 2069 7320 756e 7472 7565 2079  this is untrue y
-0001c380: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
-0001c390: 2020 2020 2020 6c65 6176 6520 6469 7669        leave divi
-0001c3a0: 7369 6f6e 7320 656d 7074 7920 616e 6420  sions empty and 
-0001c3b0: 6361 6c6c 2060 6072 6570 6172 7469 7469  call ``repartiti
-0001c3c0: 6f6e 6060 2061 6674 6572 2060 6073 6574  on`` after ``set
-0001c3d0: 5f69 6e64 6578 6060 2e0a 2020 2020 2020  _index``..      
-0001c3e0: 2020 696e 706c 6163 653a 2062 6f6f 6c2c    inplace: bool,
-0001c3f0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0001c400: 2020 2020 2020 4d6f 6469 6679 696e 6720        Modifying 
-0001c410: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
-0001c420: 2070 6c61 6365 2069 7320 6e6f 7420 7375   place is not su
-0001c430: 7070 6f72 7465 6420 6279 2044 6173 6b2e  pported by Dask.
-0001c440: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
-0001c450: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
-0001c460: 2020 2020 2020 2020 736f 7274 3a20 626f          sort: bo
-0001c470: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0001c480: 2020 2020 2020 2020 2049 6620 6060 5472           If ``Tr
-0001c490: 7565 6060 2c20 736f 7274 2074 6865 2044  ue``, sort the D
-0001c4a0: 6174 6146 7261 6d65 2062 7920 7468 6520  ataFrame by the 
-0001c4b0: 6e65 7720 696e 6465 782e 204f 7468 6572  new index. Other
-0001c4c0: 7769 7365 0a20 2020 2020 2020 2020 2020  wise.           
-0001c4d0: 2073 6574 2074 6865 2069 6e64 6578 206f   set the index o
-0001c4e0: 6e20 7468 6520 696e 6469 7669 6475 616c  n the individual
-0001c4f0: 2065 7869 7374 696e 6720 7061 7274 6974   existing partit
-0001c500: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
-0001c510: 2020 4465 6661 756c 7473 2074 6f20 6060    Defaults to ``
-0001c520: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
-0001c530: 7368 7566 666c 655f 6d65 7468 6f64 3a20  shuffle_method: 
-0001c540: 7b27 6469 736b 272c 2027 7461 736b 7327  {'disk', 'tasks'
-0001c550: 2c20 2770 3270 277d 2c20 6f70 7469 6f6e  , 'p2p'}, option
-0001c560: 616c 0a20 2020 2020 2020 2020 2020 2045  al.            E
-0001c570: 6974 6865 7220 6060 2764 6973 6b27 6060  ither ``'disk'``
-0001c580: 2066 6f72 2073 696e 676c 652d 6e6f 6465   for single-node
-0001c590: 206f 7065 7261 7469 6f6e 206f 7220 6060   operation or ``
-0001c5a0: 2774 6173 6b73 2760 6020 616e 640a 2020  'tasks'`` and.  
-0001c5b0: 2020 2020 2020 2020 2020 6060 2770 3270            ``'p2p
-0001c5c0: 2760 6020 666f 7220 6469 7374 7269 6275  '`` for distribu
-0001c5d0: 7465 6420 6f70 6572 6174 696f 6e2e 2020  ted operation.  
-0001c5e0: 5769 6c6c 2062 6520 696e 6665 7272 6564  Will be inferred
-0001c5f0: 2062 7920 796f 7572 0a20 2020 2020 2020   by your.       
-0001c600: 2020 2020 2063 7572 7265 6e74 2073 6368       current sch
-0001c610: 6564 756c 6572 2e0a 2020 2020 2020 2020  eduler..        
-0001c620: 636f 6d70 7574 653a 2062 6f6f 6c2c 2064  compute: bool, d
-0001c630: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-0001c640: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-0001c650: 206f 7220 6e6f 7420 746f 2074 7269 6767   or not to trigg
-0001c660: 6572 2061 6e20 696d 6d65 6469 6174 6520  er an immediate 
-0001c670: 636f 6d70 7574 6174 696f 6e2e 2044 6566  computation. Def
-0001c680: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
-0001c690: 2020 2020 2020 2020 2020 2020 4e6f 7465              Note
-0001c6a0: 2c20 7468 6174 2065 7665 6e20 6966 2079  , that even if y
-0001c6b0: 6f75 2073 6574 2060 6063 6f6d 7075 7465  ou set ``compute
-0001c6c0: 3d46 616c 7365 6060 2c20 616e 2069 6d6d  =False``, an imm
-0001c6d0: 6564 6961 7465 2063 6f6d 7075 7461 7469  ediate computati
-0001c6e0: 6f6e 0a20 2020 2020 2020 2020 2020 2077  on.            w
-0001c6f0: 696c 6c20 7374 696c 6c20 6265 2074 7269  ill still be tri
-0001c700: 6767 6572 6564 2069 6620 6060 6469 7669  ggered if ``divi
-0001c710: 7369 6f6e 7360 6020 6973 2060 604e 6f6e  sions`` is ``Non
-0001c720: 6560 602e 0a20 2020 2020 2020 2070 6172  e``..        par
-0001c730: 7469 7469 6f6e 5f73 697a 653a 2069 6e74  tition_size: int
-0001c740: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0001c750: 2020 2020 2020 2044 6573 6972 6564 2073         Desired s
-0001c760: 697a 6520 6f66 2065 6163 6820 7061 7274  ize of each part
-0001c770: 6974 696f 6e73 2069 6e20 6279 7465 732e  itions in bytes.
-0001c780: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
-0001c790: 7920 7573 6564 2077 6865 6e20 6060 6e70  y used when ``np
-0001c7a0: 6172 7469 7469 6f6e 733d 2761 7574 6f27  artitions='auto'
-0001c7b0: 6060 0a0a 2020 2020 2020 2020 4578 616d  ``..        Exam
-0001c7c0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0001c7d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-0001c7e0: 3e20 696d 706f 7274 2064 6173 6b0a 2020  > import dask.  
-0001c7f0: 2020 2020 2020 3e3e 3e20 6464 6620 3d20        >>> ddf = 
-0001c800: 6461 736b 2e64 6174 6173 6574 732e 7469  dask.datasets.ti
-0001c810: 6d65 7365 7269 6573 2873 7461 7274 3d22  meseries(start="
-0001c820: 3230 3231 2d30 312d 3031 222c 2065 6e64  2021-01-01", end
-0001c830: 3d22 3230 3231 2d30 312d 3037 222c 2066  ="2021-01-07", f
-0001c840: 7265 713d 2231 6822 292e 7265 7365 745f  req="1h").reset_
-0001c850: 696e 6465 7828 290a 2020 2020 2020 2020  index().        
-0001c860: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
-0001c870: 6574 5f69 6e64 6578 2822 7822 290a 2020  et_index("x").  
-0001c880: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
-0001c890: 2064 6466 2e73 6574 5f69 6e64 6578 2864   ddf.set_index(d
-0001c8a0: 6466 2e78 290a 2020 2020 2020 2020 3e3e  df.x).        >>
-0001c8b0: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
-0001c8c0: 5f69 6e64 6578 2864 6466 2e74 696d 6573  _index(ddf.times
-0001c8d0: 7461 6d70 2c20 736f 7274 6564 3d54 7275  tamp, sorted=Tru
-0001c8e0: 6529 0a0a 2020 2020 2020 2020 4120 636f  e)..        A co
-0001c8f0: 6d6d 6f6e 2063 6173 6520 6973 2077 6865  mmon case is whe
-0001c900: 6e20 7765 2068 6176 6520 6120 6461 7465  n we have a date
-0001c910: 7469 6d65 2063 6f6c 756d 6e20 7468 6174  time column that
-0001c920: 2077 6520 6b6e 6f77 2074 6f20 6265 0a20   we know to be. 
-0001c930: 2020 2020 2020 2073 6f72 7465 6420 616e         sorted an
-0001c940: 6420 6973 2063 6c65 616e 6c79 2064 6976  d is cleanly div
-0001c950: 6964 6564 2062 7920 6461 792e 2020 5765  ided by day.  We
-0001c960: 2063 616e 2073 6574 2074 6869 7320 696e   can set this in
-0001c970: 6465 7820 666f 7220 6672 6565 0a20 2020  dex for free.   
-0001c980: 2020 2020 2062 7920 7370 6563 6966 7969       by specifyi
-0001c990: 6e67 2062 6f74 6820 7468 6174 2074 6865  ng both that the
-0001c9a0: 2063 6f6c 756d 6e20 6973 2070 7265 2d73   column is pre-s
-0001c9b0: 6f72 7465 6420 616e 6420 7468 6520 7061  orted and the pa
-0001c9c0: 7274 6963 756c 6172 0a20 2020 2020 2020  rticular.       
-0001c9d0: 2064 6976 6973 696f 6e73 2061 6c6f 6e67   divisions along
-0001c9e0: 2077 6869 6368 2069 7320 6973 2073 6570   which is is sep
-0001c9f0: 6172 6174 6564 0a0a 2020 2020 2020 2020  arated..        
-0001ca00: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
-0001ca10: 7320 6173 2070 640a 2020 2020 2020 2020  s as pd.        
-0001ca20: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
-0001ca30: 7064 2e64 6174 655f 7261 6e67 6528 7374  pd.date_range(st
-0001ca40: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
-0001ca50: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
-0001ca60: 3722 2c20 6672 6571 3d27 3144 2729 0a20  7", freq='1D'). 
-0001ca70: 2020 2020 2020 203e 3e3e 2064 6976 6973         >>> divis
-0001ca80: 696f 6e73 0a20 2020 2020 2020 2044 6174  ions.        Dat
-0001ca90: 6574 696d 6549 6e64 6578 285b 2732 3032  etimeIndex(['202
-0001caa0: 312d 3031 2d30 3127 2c20 2732 3032 312d  1-01-01', '2021-
-0001cab0: 3031 2d30 3227 2c20 2732 3032 312d 3031  01-02', '2021-01
-0001cac0: 2d30 3327 2c20 2732 3032 312d 3031 2d30  -03', '2021-01-0
-0001cad0: 3427 2c0a 2020 2020 2020 2020 2020 2020  4',.            
-0001cae0: 2020 2020 2020 2020 2020 2027 3230 3231             '2021
-0001caf0: 2d30 312d 3035 272c 2027 3230 3231 2d30  -01-05', '2021-0
-0001cb00: 312d 3036 272c 2027 3230 3231 2d30 312d  1-06', '2021-01-
-0001cb10: 3037 275d 2c0a 2020 2020 2020 2020 2020  07'],.          
-0001cb20: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-0001cb30: 653d 2764 6174 6574 696d 6536 345b 6e73  e='datetime64[ns
-0001cb40: 5d27 2c20 6672 6571 3d27 4427 290a 0a20  ]', freq='D').. 
-0001cb50: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-0001cb60: 2060 606c 656e 2864 6976 6973 6f6e 7329   ``len(divisons)
-0001cb70: 6060 2069 7320 6571 7561 6c20 746f 2060  `` is equal to `
-0001cb80: 606e 7061 7274 6974 696f 6e73 202b 2031  `npartitions + 1
-0001cb90: 6060 2e20 5468 6973 2069 7320 6265 6361  ``. This is beca
-0001cba0: 7573 6520 6060 6469 7669 7369 6f6e 7360  use ``divisions`
-0001cbb0: 600a 2020 2020 2020 2020 7265 7072 6573  `.        repres
-0001cbc0: 656e 7473 2074 6865 2075 7070 6572 2061  ents the upper a
-0001cbd0: 6e64 206c 6f77 6572 2062 6f75 6e64 7320  nd lower bounds 
-0001cbe0: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
-0001cbf0: 6e2e 2054 6865 2066 6972 7374 2069 7465  n. The first ite
-0001cc00: 6d20 6973 2074 6865 0a20 2020 2020 2020  m is the.       
-0001cc10: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
-0001cc20: 7468 6520 6669 7273 7420 7061 7274 6974  the first partit
-0001cc30: 696f 6e2c 2074 6865 2073 6563 6f6e 6420  ion, the second 
-0001cc40: 6974 656d 2069 7320 7468 6520 6c6f 7765  item is the lowe
-0001cc50: 7220 626f 756e 6420 6f66 2074 6865 0a20  r bound of the. 
-0001cc60: 2020 2020 2020 2073 6563 6f6e 6420 7061         second pa
-0001cc70: 7274 6974 696f 6e20 616e 6420 7468 6520  rtition and the 
-0001cc80: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
-0001cc90: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
-0001cca0: 6f6e 2c20 616e 6420 736f 206f 6e2e 0a20  on, and so on.. 
-0001ccb0: 2020 2020 2020 2054 6865 2073 6563 6f6e         The secon
-0001ccc0: 642d 746f 2d6c 6173 7420 6974 656d 2069  d-to-last item i
-0001ccd0: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
-0001cce0: 6420 6f66 2074 6865 206c 6173 7420 7061  d of the last pa
-0001ccf0: 7274 6974 696f 6e2c 2061 6e64 2074 6865  rtition, and the
-0001cd00: 206c 6173 740a 2020 2020 2020 2020 2865   last.        (e
-0001cd10: 7874 7261 2920 6974 656d 2069 7320 7468  xtra) item is th
-0001cd20: 6520 7570 7065 7220 626f 756e 6420 6f66  e upper bound of
-0001cd30: 2074 6865 206c 6173 7420 7061 7274 6974   the last partit
-0001cd40: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
-0001cd50: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
-0001cd60: 5f69 6e64 6578 2822 7469 6d65 7374 616d  _index("timestam
-0001cd70: 7022 2c20 736f 7274 6564 3d54 7275 652c  p", sorted=True,
-0001cd80: 2064 6976 6973 696f 6e73 3d64 6976 6973   divisions=divis
-0001cd90: 696f 6e73 2e74 6f6c 6973 7428 2929 0a0a  ions.tolist())..
-0001cda0: 2020 2020 2020 2020 4966 2079 6f75 276c          If you'l
-0001cdb0: 6c20 6265 2072 756e 6e69 6e67 2060 7365  l be running `se
-0001cdc0: 745f 696e 6465 7860 206f 6e20 7468 6520  t_index` on the 
-0001cdd0: 7361 6d65 2028 6f72 2073 696d 696c 6172  same (or similar
-0001cde0: 2920 6461 7461 7365 7473 2072 6570 6561  ) datasets repea
-0001cdf0: 7465 646c 792c 0a20 2020 2020 2020 2079  tedly,.        y
-0001ce00: 6f75 2063 6f75 6c64 2073 6176 6520 7469  ou could save ti
-0001ce10: 6d65 2062 7920 6c65 7474 696e 6720 4461  me by letting Da
-0001ce20: 736b 2063 616c 6375 6c61 7465 2067 6f6f  sk calculate goo
-0001ce30: 6420 6469 7669 7369 6f6e 7320 6f6e 6365  d divisions once
-0001ce40: 2c20 7468 656e 2063 6f70 792d 7061 7374  , then copy-past
-0001ce50: 696e 670a 2020 2020 2020 2020 7468 656d  ing.        them
-0001ce60: 2074 6f20 7265 7573 652e 2054 6869 7320   to reuse. This 
-0001ce70: 6973 2065 7370 6563 6961 6c6c 7920 6865  is especially he
-0001ce80: 6c70 6675 6c20 7275 6e6e 696e 6720 696e  lpful running in
-0001ce90: 2061 204a 7570 7974 6572 206e 6f74 6562   a Jupyter noteb
-0001cea0: 6f6f 6b3a 0a0a 2020 2020 2020 2020 3e3e  ook:..        >>
-0001ceb0: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
-0001cec0: 5f69 6e64 6578 2822 6e61 6d65 2229 2020  _index("name")  
-0001ced0: 2320 736c 6f77 2c20 6361 6c63 756c 6174  # slow, calculat
-0001cee0: 6573 2064 6174 6120 6469 7374 7269 6275  es data distribu
-0001cef0: 7469 6f6e 0a20 2020 2020 2020 203e 3e3e  tion.        >>>
-0001cf00: 2064 6466 322e 6469 7669 7369 6f6e 7320   ddf2.divisions 
-0001cf10: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0001cf20: 500a 2020 2020 2020 2020 5b22 416c 6963  P.        ["Alic
-0001cf30: 6522 2c20 224c 6175 7261 222c 2022 5572  e", "Laura", "Ur
-0001cf40: 7375 6c61 222c 2022 5a65 6c64 6122 5d0a  sula", "Zelda"].
-0001cf50: 2020 2020 2020 2020 3e3e 3e20 2320 5e20          >>> # ^ 
-0001cf60: 4e6f 7720 636f 7079 2d70 6173 7465 2074  Now copy-paste t
-0001cf70: 6869 7320 616e 6420 6564 6974 2074 6865  his and edit the
-0001cf80: 206c 696e 6520 6162 6f76 6520 746f 3a0a   line above to:.
-0001cf90: 2020 2020 2020 2020 3e3e 3e20 2320 6464          >>> # dd
-0001cfa0: 6632 203d 2064 6466 2e73 6574 5f69 6e64  f2 = ddf.set_ind
-0001cfb0: 6578 2822 6e61 6d65 222c 2064 6976 6973  ex("name", divis
-0001cfc0: 696f 6e73 3d5b 2241 6c69 6365 222c 2022  ions=["Alice", "
-0001cfd0: 4c61 7572 6122 2c20 2255 7273 756c 6122  Laura", "Ursula"
-0001cfe0: 2c20 225a 656c 6461 225d 290a 2020 2020  , "Zelda"]).    
-0001cff0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001d000: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-0001d010: 6865 722c 206c 6973 7429 2061 6e64 206c  her, list) and l
-0001d020: 656e 286f 7468 6572 2920 3d3d 2031 3a0a  en(other) == 1:.
-0001d030: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-0001d040: 7220 3d20 6f74 6865 725b 305d 0a20 2020  r = other[0].   
-0001d050: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0001d060: 6365 286f 7468 6572 2c20 6c69 7374 293a  ce(other, list):
-0001d070: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001d080: 616e 7928 5b69 7369 6e73 7461 6e63 6528  any([isinstance(
-0001d090: 632c 2046 7261 6d65 4261 7365 2920 666f  c, FrameBase) fo
-0001d0a0: 7220 6320 696e 206f 7468 6572 5d29 3a0a  r c in other]):.
-0001d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0c0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0001d0d0: 224c 6973 745b 4672 616d 6542 6173 655d  "List[FrameBase]
-0001d0e0: 206e 6f74 2073 7570 706f 7274 6564 2062   not supported b
-0001d0f0: 7920 7365 745f 696e 6465 7822 290a 2020  y set_index").  
-0001d100: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d120: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0001d130: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-0001d140: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001d150: 4461 736b 2064 6174 6166 7261 6d65 2064  Dask dataframe d
-0001d160: 6f65 7320 6e6f 7420 7965 7420 7375 7070  oes not yet supp
-0001d170: 6f72 7420 6d75 6c74 692d 696e 6465 7865  ort multi-indexe
-0001d180: 732e 5c6e 220a 2020 2020 2020 2020 2020  s.\n".          
-0001d190: 2020 2020 2020 2020 2020 6622 596f 7520            f"You 
-0001d1a0: 7472 6965 6420 746f 2069 6e64 6578 2077  tried to index w
-0001d1b0: 6974 6820 7468 6973 2069 6e64 6578 3a20  ith this index: 
-0001d1c0: 7b6f 7468 6572 7d5c 6e22 0a20 2020 2020  {other}\n".     
-0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001d1e0: 496e 6465 7865 7320 6d75 7374 2062 6520  Indexes must be 
-0001d1f0: 7369 6e67 6c65 2063 6f6c 756d 6e73 206f  single columns o
-0001d200: 6e6c 792e 220a 2020 2020 2020 2020 2020  nly.".          
-0001d210: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001d220: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-0001d230: 6865 722c 2044 6174 6146 7261 6d65 293a  her, DataFrame):
-0001d240: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001d250: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0001d260: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-0001d270: 2020 2020 2020 2020 2244 6173 6b20 6461          "Dask da
-0001d280: 7461 6672 616d 6520 646f 6573 206e 6f74  taframe does not
-0001d290: 2079 6574 2073 7570 706f 7274 206d 756c   yet support mul
-0001d2a0: 7469 2d69 6e64 6578 6573 2e5c 6e22 0a20  ti-indexes.\n". 
-0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001d2c0: 2259 6f75 2074 7269 6564 2074 6f20 696e  "You tried to in
-0001d2d0: 6465 7820 7769 7468 2061 2066 7261 6d65  dex with a frame
-0001d2e0: 2077 6974 6820 7468 6573 6520 636f 6c75   with these colu
-0001d2f0: 6d6e 733a 207b 6c69 7374 286f 7468 6572  mns: {list(other
-0001d300: 2e63 6f6c 756d 6e73 297d 5c6e 220a 2020  .columns)}\n".  
-0001d310: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-0001d320: 6e64 6578 6573 206d 7573 7420 6265 2073  ndexes must be s
-0001d330: 696e 676c 6520 636f 6c75 6d6e 7320 6f6e  ingle columns on
-0001d340: 6c79 2e22 0a20 2020 2020 2020 2020 2020  ly.".           
-0001d350: 2029 0a20 2020 2020 2020 2069 6620 6973   ).        if is
-0001d360: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
-0001d370: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
-0001d380: 2020 2020 2069 6620 6f74 6865 722e 5f6e       if other._n
-0001d390: 616d 6520 3d3d 2073 656c 662e 696e 6465  ame == self.inde
-0001d3a0: 782e 5f6e 616d 653a 0a20 2020 2020 2020  x._name:.       
-0001d3b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001d3c0: 7365 6c66 0a20 2020 2020 2020 2065 6c69  self.        eli
-0001d3d0: 6620 6f74 6865 7220 3d3d 2073 656c 662e  f other == self.
-0001d3e0: 696e 6465 782e 6e61 6d65 3a0a 2020 2020  index.name:.    
-0001d3f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001d400: 656c 660a 0a20 2020 2020 2020 2069 6620  elf..        if 
-0001d410: 6469 7669 7369 6f6e 7320 6973 206e 6f74  divisions is not
-0001d420: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001d430: 2020 2063 6865 636b 5f64 6976 6973 696f     check_divisio
-0001d440: 6e73 2864 6976 6973 696f 6e73 290a 0a20  ns(divisions).. 
-0001d450: 2020 2020 2020 2069 6620 2873 6f72 7465         if (sorte
-0001d460: 6420 6f72 206e 6f74 2073 6f72 7429 2061  d or not sort) a
-0001d470: 6e64 206e 7061 7274 6974 696f 6e73 2069  nd npartitions i
-0001d480: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0001d490: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001d4a0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0001d4b0: 2020 2020 2020 2020 2020 2253 7065 6369            "Speci
-0001d4c0: 6679 696e 6720 6e70 6172 7469 7469 6f6e  fying npartition
-0001d4d0: 7320 7769 7468 2073 6f72 743d 4661 6c73  s with sort=Fals
-0001d4e0: 6520 6f72 2073 6f72 7465 643d 5472 7565  e or sorted=True
-0001d4f0: 2069 7320 6e6f 7420 220a 2020 2020 2020   is not ".      
-0001d500: 2020 2020 2020 2020 2020 2273 7570 706f            "suppo
-0001d510: 7274 6564 2e20 4361 6c6c 2060 7265 7061  rted. Call `repa
-0001d520: 7274 6974 696f 6e60 2061 6674 6572 7761  rtition` afterwa
-0001d530: 7264 732e 220a 2020 2020 2020 2020 2020  rds.".          
-0001d540: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0001d550: 736f 7274 6564 3a0a 2020 2020 2020 2020  sorted:.        
-0001d560: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
-0001d570: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-0001d580: 206c 656e 2864 6976 6973 696f 6e73 2920   len(divisions) 
-0001d590: 2d20 3120 213d 2073 656c 662e 6e70 6172  - 1 != self.npar
-0001d5a0: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
-0001d5b0: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
-0001d5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d5d0: 2020 2020 2022 5768 656e 2064 6f69 6e67       "When doing
-0001d5e0: 2060 6466 2e73 6574 5f69 6e64 6578 2863   `df.set_index(c
-0001d5f0: 6f6c 2c20 736f 7274 6564 3d54 7275 652c  ol, sorted=True,
-0001d600: 2064 6976 6973 696f 6e73 3d2e 2e2e 2960   divisions=...)`
-0001d610: 2c20 220a 2020 2020 2020 2020 2020 2020  , ".            
-0001d620: 2020 2020 2020 2020 2264 6976 6973 696f          "divisio
-0001d630: 6e73 2069 6e64 6963 6174 6573 206b 6e6f  ns indicates kno
-0001d640: 776e 2073 706c 6974 7320 696e 2074 6865  wn splits in the
-0001d650: 2069 6e64 6578 2063 6f6c 756d 6e2e 2049   index column. I
-0001d660: 6e20 7468 6973 2022 0a20 2020 2020 2020  n this ".       
-0001d670: 2020 2020 2020 2020 2020 2020 2022 6361               "ca
-0001d680: 7365 2064 6976 6973 696f 6e73 206d 7573  se divisions mus
-0001d690: 7420 6265 2074 6865 2073 616d 6520 6c65  t be the same le
-0001d6a0: 6e67 7468 2061 7320 7468 6520 6578 6973  ngth as the exis
-0001d6b0: 7469 6e67 2022 0a20 2020 2020 2020 2020  ting ".         
-0001d6c0: 2020 2020 2020 2020 2020 2022 6469 7669             "divi
-0001d6d0: 7369 6f6e 7320 696e 2060 6466 605c 6e5c  sions in `df`\n\
-0001d6e0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0001d6f0: 2020 2020 2020 2022 4966 2074 6865 2069         "If the i
-0001d700: 6e74 656e 7420 6973 2074 6f20 7265 7061  ntent is to repa
-0001d710: 7274 6974 696f 6e20 696e 746f 206e 6577  rtition into new
-0001d720: 2064 6976 6973 696f 6e73 2061 6674 6572   divisions after
-0001d730: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0001d740: 2020 2020 2020 2022 7365 7474 696e 6720         "setting 
-0001d750: 7468 6520 696e 6465 782c 2079 6f75 2070  the index, you p
-0001d760: 726f 6261 626c 7920 7761 6e74 3a5c 6e5c  robably want:\n\
-0001d770: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-0001d780: 2020 2020 2020 2022 6064 662e 7365 745f         "`df.set_
-0001d790: 696e 6465 7828 636f 6c2c 2073 6f72 7465  index(col, sorte
-0001d7a0: 643d 5472 7565 292e 7265 7061 7274 6974  d=True).repartit
-0001d7b0: 696f 6e28 6469 7669 7369 6f6e 733d 6469  ion(divisions=di
-0001d7c0: 7669 7369 6f6e 7329 6022 0a20 2020 2020  visions)`".     
-0001d7d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001d7e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001d7f0: 7365 2056 616c 7565 4572 726f 7228 6d73  se ValueError(ms
-0001d800: 6729 0a20 2020 2020 2020 2020 2020 2072  g).            r
-0001d810: 6573 756c 7420 3d20 6e65 775f 636f 6c6c  esult = new_coll
-0001d820: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-0001d830: 2020 2020 2020 2020 5365 7449 6e64 6578          SetIndex
-0001d840: 426c 6f63 6b77 6973 6528 0a20 2020 2020  Blockwise(.     
-0001d850: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001d860: 656c 662c 206f 7468 6572 2c20 6472 6f70  elf, other, drop
-0001d870: 2c20 6e65 775f 6469 7669 7369 6f6e 733d  , new_divisions=
-0001d880: 6469 7669 7369 6f6e 732c 2061 7070 656e  divisions, appen
-0001d890: 643d 6170 7065 6e64 0a20 2020 2020 2020  d=append.       
-0001d8a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001d8b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001d8c0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-0001d8d0: 6c74 2e63 6f6d 7075 7465 5f63 7572 7265  lt.compute_curre
-0001d8e0: 6e74 5f64 6976 6973 696f 6e73 2873 6574  nt_divisions(set
-0001d8f0: 5f64 6976 6973 696f 6e73 3d54 7275 6529  _divisions=True)
-0001d900: 0a20 2020 2020 2020 2065 6c69 6620 6e6f  .        elif no
-0001d910: 7420 736f 7274 3a0a 2020 2020 2020 2020  t sort:.        
-0001d920: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0001d930: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-0001d940: 2020 2020 2020 2020 2020 2053 6574 496e             SetIn
-0001d950: 6465 7842 6c6f 636b 7769 7365 2873 656c  dexBlockwise(sel
-0001d960: 662c 206f 7468 6572 2c20 6472 6f70 2c20  f, other, drop, 
-0001d970: 4e6f 6e65 2c20 6170 7065 6e64 3d61 7070  None, append=app
-0001d980: 656e 6429 0a20 2020 2020 2020 2020 2020  end).           
-0001d990: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-0001d9a0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0001d9b0: 6e28 0a20 2020 2020 2020 2020 2020 2053  n(.            S
-0001d9c0: 6574 496e 6465 7828 0a20 2020 2020 2020  etIndex(.       
-0001d9d0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-0001d9e0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0001d9f0: 7468 6572 2c0a 2020 2020 2020 2020 2020  ther,.          
-0001da00: 2020 2020 2020 6472 6f70 2c0a 2020 2020        drop,.    
-0001da10: 2020 2020 2020 2020 2020 2020 7573 6572              user
-0001da20: 5f64 6976 6973 696f 6e73 3d64 6976 6973  _divisions=divis
-0001da30: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-0001da40: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
-0001da50: 733d 6e70 6172 7469 7469 6f6e 732c 0a20  s=npartitions,. 
-0001da60: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0001da70: 7073 616d 706c 653d 7570 7361 6d70 6c65  psample=upsample
-0001da80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001da90: 2020 7061 7274 6974 696f 6e5f 7369 7a65    partition_size
-0001daa0: 3d70 6172 7469 7469 6f6e 5f73 697a 652c  =partition_size,
-0001dab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dac0: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
-0001dad0: 6765 745f 7370 6563 6966 6965 645f 7368  get_specified_sh
-0001dae0: 7566 666c 6528 7368 7566 666c 655f 6d65  uffle(shuffle_me
-0001daf0: 7468 6f64 292c 0a20 2020 2020 2020 2020  thod),.         
-0001db00: 2020 2020 2020 2061 7070 656e 643d 6170         append=ap
-0001db10: 7065 6e64 2c0a 2020 2020 2020 2020 2020  pend,.          
-0001db20: 2020 2020 2020 6f70 7469 6f6e 733d 6f70        options=op
-0001db30: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
-0001db40: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
-0001db50: 2020 2020 6465 6620 736f 7274 5f76 616c      def sort_val
-0001db60: 7565 7328 0a20 2020 2020 2020 2073 656c  ues(.        sel
-0001db70: 662c 0a20 2020 2020 2020 2062 793a 2073  f,.        by: s
-0001db80: 7472 207c 206c 6973 745b 7374 725d 2c0a  tr | list[str],.
-0001db90: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0001dba0: 6f6e 733a 2069 6e74 207c 204e 6f6e 6520  ons: int | None 
-0001dbb0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001dbc0: 6173 6365 6e64 696e 673a 2062 6f6f 6c20  ascending: bool 
-0001dbd0: 7c20 6c69 7374 5b62 6f6f 6c5d 203d 2054  | list[bool] = T
-0001dbe0: 7275 652c 0a20 2020 2020 2020 206e 615f  rue,.        na_
-0001dbf0: 706f 7369 7469 6f6e 3a20 4c69 7465 7261  position: Litera
-0001dc00: 6c5b 2266 6972 7374 225d 207c 204c 6974  l["first"] | Lit
-0001dc10: 6572 616c 5b22 6c61 7374 225d 203d 2022  eral["last"] = "
-0001dc20: 6c61 7374 222c 0a20 2020 2020 2020 2070  last",.        p
-0001dc30: 6172 7469 7469 6f6e 5f73 697a 653a 2066  artition_size: f
-0001dc40: 6c6f 6174 203d 2031 3238 6536 2c0a 2020  loat = 128e6,.  
-0001dc50: 2020 2020 2020 736f 7274 5f66 756e 6374        sort_funct
-0001dc60: 696f 6e3a 2043 616c 6c61 626c 655b 5b70  ion: Callable[[p
-0001dc70: 642e 4461 7461 4672 616d 655d 2c20 7064  d.DataFrame], pd
-0001dc80: 2e44 6174 6146 7261 6d65 5d20 7c20 4e6f  .DataFrame] | No
-0001dc90: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-0001dca0: 2020 2073 6f72 745f 6675 6e63 7469 6f6e     sort_function
-0001dcb0: 5f6b 7761 7267 733a 204d 6170 7069 6e67  _kwargs: Mapping
-0001dcc0: 5b73 7472 2c20 416e 795d 207c 204e 6f6e  [str, Any] | Non
-0001dcd0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0001dce0: 2020 7570 7361 6d70 6c65 3a20 666c 6f61    upsample: floa
-0001dcf0: 7420 3d20 312e 302c 0a20 2020 2020 2020  t = 1.0,.       
-0001dd00: 2069 676e 6f72 655f 696e 6465 783a 2062   ignore_index: b
-0001dd10: 6f6f 6c20 7c20 4e6f 6e65 203d 2046 616c  ool | None = Fal
-0001dd20: 7365 2c0a 2020 2020 2020 2020 7368 7566  se,.        shuf
-0001dd30: 666c 655f 6d65 7468 6f64 3a20 7374 7220  fle_method: str 
-0001dd40: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-0001dd50: 2020 2020 2020 202a 2a6f 7074 696f 6e73         **options
-0001dd60: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001dd70: 2022 2222 536f 7274 2074 6865 2064 6174   """Sort the dat
-0001dd80: 6173 6574 2062 7920 6120 7369 6e67 6c65  aset by a single
-0001dd90: 2063 6f6c 756d 6e2e 0a0a 2020 2020 2020   column...      
-0001dda0: 2020 536f 7274 696e 6720 6120 7061 7261    Sorting a para
-0001ddb0: 6c6c 656c 2064 6174 6173 6574 2072 6571  llel dataset req
-0001ddc0: 7569 7265 7320 6578 7065 6e73 6976 6520  uires expensive 
-0001ddd0: 7368 7566 666c 6573 2061 6e64 2069 7320  shuffles and is 
-0001dde0: 6765 6e65 7261 6c6c 790a 2020 2020 2020  generally.      
-0001ddf0: 2020 6e6f 7420 7265 636f 6d6d 656e 6465    not recommende
-0001de00: 642e 2053 6565 2060 6073 6574 5f69 6e64  d. See ``set_ind
-0001de10: 6578 6060 2066 6f72 2069 6d70 6c65 6d65  ex`` for impleme
-0001de20: 6e74 6174 696f 6e20 6465 7461 696c 732e  ntation details.
-0001de30: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0001de40: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-0001de50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001de60: 6279 3a20 7374 7220 6f72 206c 6973 745b  by: str or list[
-0001de70: 7374 725d 0a20 2020 2020 2020 2020 2020  str].           
-0001de80: 2043 6f6c 756d 6e28 7329 2074 6f20 736f   Column(s) to so
-0001de90: 7274 2062 792e 0a20 2020 2020 2020 206e  rt by..        n
-0001dea0: 7061 7274 6974 696f 6e73 3a20 696e 742c  partitions: int,
-0001deb0: 204e 6f6e 652c 206f 7220 2761 7574 6f27   None, or 'auto'
-0001dec0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-0001ded0: 2069 6465 616c 206e 756d 6265 7220 6f66   ideal number of
-0001dee0: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
-0001def0: 6e73 2e20 4966 204e 6f6e 652c 2075 7365  ns. If None, use
-0001df00: 2074 6865 2073 616d 6520 6173 0a20 2020   the same as.   
-0001df10: 2020 2020 2020 2020 2074 6865 2069 6e70           the inp
-0001df20: 7574 2e20 4966 2027 6175 746f 2720 7468  ut. If 'auto' th
-0001df30: 656e 2064 6563 6964 6520 6279 206d 656d  en decide by mem
-0001df40: 6f72 7920 7573 652e 0a20 2020 2020 2020  ory use..       
-0001df50: 2061 7363 656e 6469 6e67 3a20 626f 6f6c   ascending: bool
-0001df60: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0001df70: 2020 2020 2020 2053 6f72 7420 6173 6365         Sort asce
-0001df80: 6e64 696e 6720 7673 2e20 6465 7363 656e  nding vs. descen
-0001df90: 6469 6e67 2e0a 2020 2020 2020 2020 2020  ding..          
-0001dfa0: 2020 4465 6661 756c 7473 2074 6f20 5472    Defaults to Tr
-0001dfb0: 7565 2e0a 2020 2020 2020 2020 6e61 5f70  ue..        na_p
-0001dfc0: 6f73 6974 696f 6e3a 207b 276c 6173 7427  osition: {'last'
-0001dfd0: 2c20 2766 6972 7374 277d 2c20 6f70 7469  , 'first'}, opti
-0001dfe0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0001dff0: 2050 7574 7320 4e61 4e73 2061 7420 7468   Puts NaNs at th
-0001e000: 6520 6265 6769 6e6e 696e 6720 6966 2027  e beginning if '
-0001e010: 6669 7273 7427 2c20 7075 7473 204e 614e  first', puts NaN
-0001e020: 2061 7420 7468 6520 656e 6420 6966 2027   at the end if '
-0001e030: 6c61 7374 272e 0a20 2020 2020 2020 2020  last'..         
-0001e040: 2020 2044 6566 6175 6c74 7320 746f 2027     Defaults to '
-0001e050: 6c61 7374 272e 0a20 2020 2020 2020 2073  last'..        s
-0001e060: 6f72 745f 6675 6e63 7469 6f6e 3a20 6675  ort_function: fu
-0001e070: 6e63 7469 6f6e 2c20 6f70 7469 6f6e 616c  nction, optional
-0001e080: 0a20 2020 2020 2020 2020 2020 2053 6f72  .            Sor
-0001e090: 7469 6e67 2066 756e 6374 696f 6e20 746f  ting function to
-0001e0a0: 2075 7365 2077 6865 6e20 736f 7274 696e   use when sortin
-0001e0b0: 6720 756e 6465 726c 7969 6e67 2070 6172  g underlying par
-0001e0c0: 7469 7469 6f6e 732e 0a20 2020 2020 2020  titions..       
-0001e0d0: 2020 2020 2049 6620 4e6f 6e65 2c20 6465       If None, de
-0001e0e0: 6661 756c 7473 2074 6f20 6060 4d2e 736f  faults to ``M.so
-0001e0f0: 7274 5f76 616c 7565 7360 6020 2874 6865  rt_values`` (the
-0001e100: 2070 6172 7469 7469 6f6e 206c 6962 7261   partition libra
-0001e110: 7279 2773 0a20 2020 2020 2020 2020 2020  ry's.           
-0001e120: 2069 6d70 6c65 6d65 6e74 6174 696f 6e20   implementation 
-0001e130: 6f66 2060 6073 6f72 745f 7661 6c75 6573  of ``sort_values
-0001e140: 6060 292e 0a20 2020 2020 2020 2073 6f72  ``)..        sor
-0001e150: 745f 6675 6e63 7469 6f6e 5f6b 7761 7267  t_function_kwarg
-0001e160: 733a 2064 6963 742c 206f 7074 696f 6e61  s: dict, optiona
-0001e170: 6c0a 2020 2020 2020 2020 2020 2020 4164  l.            Ad
-0001e180: 6469 7469 6f6e 616c 206b 6579 776f 7264  ditional keyword
-0001e190: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
-0001e1a0: 7373 2074 6f20 7468 6520 7061 7274 6974  ss to the partit
-0001e1b0: 696f 6e20 736f 7274 696e 6720 6675 6e63  ion sorting func
-0001e1c0: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-0001e1d0: 2020 4279 2064 6566 6175 6c74 2c20 6060    By default, ``
-0001e1e0: 6279 6060 2c20 6060 6173 6365 6e64 696e  by``, ``ascendin
-0001e1f0: 6760 602c 2061 6e64 2060 606e 615f 706f  g``, and ``na_po
-0001e200: 7369 7469 6f6e 6060 2061 7265 2070 726f  sition`` are pro
-0001e210: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
-0001e220: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-0001e230: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-0001e240: 2020 3e3e 3e20 6466 3220 3d20 6466 2e73    >>> df2 = df.s
-0001e250: 6f72 745f 7661 6c75 6573 2827 7827 2920  ort_values('x') 
-0001e260: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0001e270: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
-0001e280: 2020 2020 2020 6966 206e 615f 706f 7369        if na_posi
-0001e290: 7469 6f6e 206e 6f74 2069 6e20 2822 6669  tion not in ("fi
-0001e2a0: 7273 7422 2c20 226c 6173 7422 293a 0a20  rst", "last"):. 
-0001e2b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001e2c0: 2056 616c 7565 4572 726f 7228 226e 615f   ValueError("na_
-0001e2d0: 706f 7369 7469 6f6e 206d 7573 7420 6265  position must be
-0001e2e0: 2065 6974 6865 7220 2766 6972 7374 2720   either 'first' 
-0001e2f0: 6f72 2027 6c61 7374 2722 290a 2020 2020  or 'last'").    
-0001e300: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0001e310: 7461 6e63 6528 6279 2c20 6c69 7374 293a  tance(by, list):
-0001e320: 0a20 2020 2020 2020 2020 2020 2062 7920  .            by 
-0001e330: 3d20 5b62 795d 0a20 2020 2020 2020 2069  = [by].        i
-0001e340: 6620 616e 7928 6e6f 7420 6973 696e 7374  f any(not isinst
-0001e350: 616e 6365 2862 2c20 7374 7229 2066 6f72  ance(b, str) for
-0001e360: 2062 2069 6e20 6279 293a 0a20 2020 2020   b in by):.     
-0001e370: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0001e380: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0001e390: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001e3a0: 2020 2244 6174 6166 7261 6d65 7320 6f6e    "Dataframes on
-0001e3b0: 6c79 2073 7570 706f 7274 2073 6f72 7469  ly support sorti
-0001e3c0: 6e67 2062 7920 6e61 6d65 6420 636f 6c75  ng by named colu
-0001e3d0: 6d6e 7320 7768 6963 6820 6d75 7374 2062  mns which must b
-0001e3e0: 6520 7061 7373 6564 2061 7320 6120 220a  e passed as a ".
-0001e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e400: 2273 7472 696e 6720 6f72 2061 206c 6973  "string or a lis
-0001e410: 7420 6f66 2073 7472 696e 6773 2e5c 6e22  t of strings.\n"
-0001e420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e430: 2022 596f 7520 7061 7373 6564 2025 7322   "You passed %s"
-0001e440: 2025 2073 7472 2862 7929 0a20 2020 2020   % str(by).     
-0001e450: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0001e460: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0001e470: 6e63 6528 6173 6365 6e64 696e 672c 2062  nce(ascending, b
-0001e480: 6f6f 6c29 2061 6e64 206e 6f74 206c 656e  ool) and not len
-0001e490: 2861 7363 656e 6469 6e67 2920 3d3d 206c  (ascending) == l
-0001e4a0: 656e 2862 7929 3a0a 2020 2020 2020 2020  en(by):.        
-0001e4b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001e4c0: 7272 6f72 2866 224c 656e 6774 6820 6f66  rror(f"Length of
-0001e4d0: 207b 6173 6365 6e64 696e 673d 7d20 213d   {ascending=} !=
-0001e4e0: 206c 656e 6774 6820 6f66 207b 6279 3d7d   length of {by=}
-0001e4f0: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
-0001e500: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0001e510: 6e28 0a20 2020 2020 2020 2020 2020 2053  n(.            S
-0001e520: 6f72 7456 616c 7565 7328 0a20 2020 2020  ortValues(.     
-0001e530: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0001e540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e550: 2062 792c 0a20 2020 2020 2020 2020 2020   by,.           
-0001e560: 2020 2020 2061 7363 656e 6469 6e67 2c0a       ascending,.
-0001e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e580: 6e61 5f70 6f73 6974 696f 6e2c 0a20 2020  na_position,.   
-0001e590: 2020 2020 2020 2020 2020 2020 206e 7061               npa
-0001e5a0: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
-0001e5b0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-0001e5c0: 696f 6e5f 7369 7a65 2c0a 2020 2020 2020  ion_size,.      
-0001e5d0: 2020 2020 2020 2020 2020 736f 7274 5f66            sort_f
-0001e5e0: 756e 6374 696f 6e2c 0a20 2020 2020 2020  unction,.       
-0001e5f0: 2020 2020 2020 2020 2073 6f72 745f 6675           sort_fu
-0001e600: 6e63 7469 6f6e 5f6b 7761 7267 732c 0a20  nction_kwargs,. 
-0001e610: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0001e620: 7073 616d 706c 652c 0a20 2020 2020 2020  psample,.       
-0001e630: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
-0001e640: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-0001e650: 2020 2020 2020 2067 6574 5f73 7065 6369         get_speci
-0001e660: 6669 6564 5f73 6875 6666 6c65 2873 6875  fied_shuffle(shu
-0001e670: 6666 6c65 5f6d 6574 686f 6429 2c0a 2020  ffle_method),.  
-0001e680: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-0001e690: 7469 6f6e 733d 6f70 7469 6f6e 732c 0a20  tions=options,. 
-0001e6a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001e6b0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0001e6c0: 7175 6572 7928 7365 6c66 2c20 6578 7072  query(self, expr
-0001e6d0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-0001e6e0: 2020 2020 2022 2222 4669 6c74 6572 2064       """Filter d
-0001e6f0: 6174 6166 7261 6d65 2077 6974 6820 636f  ataframe with co
-0001e700: 6d70 6c65 7820 6578 7072 6573 7369 6f6e  mplex expression
-0001e710: 0a0a 2020 2020 2020 2020 426c 6f63 6b65  ..        Blocke
-0001e720: 6420 7665 7273 696f 6e20 6f66 2070 642e  d version of pd.
-0001e730: 4461 7461 4672 616d 652e 7175 6572 790a  DataFrame.query.
-0001e740: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001e750: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0001e760: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2065  ------.        e
-0001e770: 7870 723a 2073 7472 0a20 2020 2020 2020  xpr: str.       
-0001e780: 2020 2020 2054 6865 2071 7565 7279 2073       The query s
-0001e790: 7472 696e 6720 746f 2065 7661 6c75 6174  tring to evaluat
-0001e7a0: 652e 0a20 2020 2020 2020 2020 2020 2059  e..            Y
-0001e7b0: 6f75 2063 616e 2072 6566 6572 2074 6f20  ou can refer to 
-0001e7c0: 636f 6c75 6d6e 206e 616d 6573 2074 6861  column names tha
-0001e7d0: 7420 6172 6520 6e6f 7420 7661 6c69 6420  t are not valid 
-0001e7e0: 5079 7468 6f6e 2076 6172 6961 626c 6520  Python variable 
-0001e7f0: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
-0001e800: 2020 6279 2073 7572 726f 756e 6469 6e67    by surrounding
-0001e810: 2074 6865 6d20 696e 2062 6163 6b74 6963   them in backtic
-0001e820: 6b73 2e0a 2020 2020 2020 2020 2020 2020  ks..            
-0001e830: 4461 736b 2064 6f65 7320 6e6f 7420 6675  Dask does not fu
-0001e840: 6c6c 7920 7375 7070 6f72 7420 7265 6665  lly support refe
-0001e850: 7272 696e 6720 746f 2076 6172 6961 626c  rring to variabl
-0001e860: 6573 2075 7369 6e67 2074 6865 2027 4027  es using the '@'
-0001e870: 2063 6861 7261 6374 6572 2c0a 2020 2020   character,.    
-0001e880: 2020 2020 2020 2020 7573 6520 662d 7374          use f-st
-0001e890: 7269 6e67 7320 6f72 2074 6865 2060 606c  rings or the ``l
-0001e8a0: 6f63 616c 5f64 6963 7460 6020 6b65 7977  ocal_dict`` keyw
-0001e8b0: 6f72 6420 6172 6775 6d65 6e74 2069 6e73  ord argument ins
-0001e8c0: 7465 6164 2e0a 0a20 2020 2020 2020 204e  tead...        N
-0001e8d0: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
-0001e8e0: 2d2d 0a20 2020 2020 2020 2054 6869 7320  --.        This 
-0001e8f0: 6973 206c 696b 6520 7468 6520 7365 7175  is like the sequ
-0001e900: 656e 7469 616c 2076 6572 7369 6f6e 2065  ential version e
-0001e910: 7863 6570 7420 7468 6174 2074 6869 7320  xcept that this 
-0001e920: 7769 6c6c 2061 6c73 6f20 6861 7070 656e  will also happen
-0001e930: 0a20 2020 2020 2020 2069 6e20 6d61 6e79  .        in many
-0001e940: 2074 6872 6561 6473 2e20 2054 6869 7320   threads.  This 
-0001e950: 6d61 7920 636f 6e66 6c69 6374 2077 6974  may conflict wit
-0001e960: 6820 6060 6e75 6d65 7870 7260 6020 7768  h ``numexpr`` wh
-0001e970: 6963 6820 7769 6c6c 2075 7365 0a20 2020  ich will use.   
-0001e980: 2020 2020 206d 756c 7469 706c 6520 7468       multiple th
-0001e990: 7265 6164 7320 6974 7365 6c66 2e20 2057  reads itself.  W
-0001e9a0: 6520 7265 636f 6d6d 656e 6420 7468 6174  e recommend that
-0001e9b0: 2079 6f75 2073 6574 2060 606e 756d 6578   you set ``numex
-0001e9c0: 7072 6060 2074 6f20 7573 6520 610a 2020  pr`` to use a.  
-0001e9d0: 2020 2020 2020 7369 6e67 6c65 2074 6872        single thr
-0001e9e0: 6561 643a 0a0a 2020 2020 2020 2020 2e2e  ead:..        ..
-0001e9f0: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
-0001ea00: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
-0001ea10: 2020 696d 706f 7274 206e 756d 6578 7072    import numexpr
-0001ea20: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-0001ea30: 6578 7072 2e73 6574 5f6e 756d 5f74 6872  expr.set_num_thr
-0001ea40: 6561 6473 2831 290a 0a20 2020 2020 2020  eads(1)..       
-0001ea50: 2053 6565 2061 6c73 6f0a 2020 2020 2020   See also.      
-0001ea60: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0001ea70: 2020 2070 616e 6461 732e 4461 7461 4672     pandas.DataFr
-0001ea80: 616d 652e 7175 6572 790a 2020 2020 2020  ame.query.      
-0001ea90: 2020 7061 6e64 6173 2e65 7661 6c0a 0a20    pandas.eval.. 
-0001eaa0: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
-0001eab0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001eac0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0001ead0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-0001eae0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-0001eaf0: 6f72 7420 6461 736b 5f65 7870 7220 6173  ort dask_expr as
-0001eb00: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
-0001eb10: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-0001eb20: 6528 7b27 7827 3a20 5b31 2c20 322c 2031  e({'x': [1, 2, 1
-0001eb30: 2c20 325d 2c0a 2020 2020 2020 2020 2e2e  , 2],.        ..
-0001eb40: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-0001eb50: 2020 2020 2027 7927 3a20 5b31 2c20 322c       'y': [1, 2,
-0001eb60: 2033 2c20 345d 2c0a 2020 2020 2020 2020   3, 4],.        
-0001eb70: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0001eb80: 2020 2020 2020 2027 7a20 7a27 3a20 5b34         'z z': [4
-0001eb90: 2c20 332c 2032 2c20 315d 7d29 0a20 2020  , 3, 2, 1]}).   
-0001eba0: 2020 2020 203e 3e3e 2064 6466 203d 2064       >>> ddf = d
-0001ebb0: 642e 6672 6f6d 5f70 616e 6461 7328 6466  d.from_pandas(df
-0001ebc0: 2c20 6e70 6172 7469 7469 6f6e 733d 3229  , npartitions=2)
-0001ebd0: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
-0001ebe0: 746f 2063 6f6c 756d 6e20 6e61 6d65 7320  to column names 
-0001ebf0: 6469 7265 6374 6c79 3a0a 0a20 2020 2020  directly:..     
-0001ec00: 2020 203e 3e3e 2064 6466 2e71 7565 7279     >>> ddf.query
-0001ec10: 2827 7920 3e20 7827 292e 636f 6d70 7574  ('y > x').comput
-0001ec20: 6528 290a 2020 2020 2020 2020 2020 2078  e().           x
-0001ec30: 2020 7920 207a 207a 0a20 2020 2020 2020    y  z z.       
-0001ec40: 2032 2020 3120 2033 2020 2020 320a 2020   2  1  3    2.  
-0001ec50: 2020 2020 2020 3320 2032 2020 3420 2020        3  2  4   
-0001ec60: 2031 0a0a 2020 2020 2020 2020 5265 6665   1..        Refe
-0001ec70: 7220 746f 2063 6f6c 756d 6e20 6e61 6d65  r to column name
-0001ec80: 2075 7369 6e67 2062 6163 6b74 6963 6b73   using backticks
-0001ec90: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-0001eca0: 6466 2e71 7565 7279 2827 607a 207a 6020  df.query('`z z` 
-0001ecb0: 3e20 7827 292e 636f 6d70 7574 6528 290a  > x').compute().
-0001ecc0: 2020 2020 2020 2020 2020 2078 2020 7920             x  y 
-0001ecd0: 207a 207a 0a20 2020 2020 2020 2030 2020   z z.        0  
-0001ece0: 3120 2031 2020 2020 340a 2020 2020 2020  1  1    4.      
-0001ecf0: 2020 3120 2032 2020 3220 2020 2033 0a20    1  2  2    3. 
-0001ed00: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
-0001ed10: 2020 320a 0a20 2020 2020 2020 2052 6566    2..        Ref
-0001ed20: 6572 2074 6f20 7661 7269 6162 6c65 206e  er to variable n
-0001ed30: 616d 6520 7573 696e 6720 662d 7374 7269  ame using f-stri
-0001ed40: 6e67 733a 0a0a 2020 2020 2020 2020 3e3e  ngs:..        >>
-0001ed50: 3e20 7661 6c75 6520 3d20 310a 2020 2020  > value = 1.    
-0001ed60: 2020 2020 3e3e 3e20 6464 662e 7175 6572      >>> ddf.quer
-0001ed70: 7928 6627 7820 3d3d 207b 7661 6c75 657d  y(f'x == {value}
-0001ed80: 2729 2e63 6f6d 7075 7465 2829 0a20 2020  ').compute().   
-0001ed90: 2020 2020 2020 2020 7820 2079 2020 7a20          x  y  z 
-0001eda0: 7a0a 2020 2020 2020 2020 3020 2031 2020  z.        0  1  
-0001edb0: 3120 2020 2034 0a20 2020 2020 2020 2032  1    4.        2
-0001edc0: 2020 3120 2033 2020 2020 320a 0a20 2020    1  3    2..   
-0001edd0: 2020 2020 2052 6566 6572 2074 6f20 7661       Refer to va
-0001ede0: 7269 6162 6c65 206e 616d 6520 7573 696e  riable name usin
-0001edf0: 6720 6060 6c6f 6361 6c5f 6469 6374 6060  g ``local_dict``
-0001ee00: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
-0001ee10: 6466 2e71 7565 7279 2827 7820 3d3d 2040  df.query('x == @
-0001ee20: 7661 6c75 6527 2c20 6c6f 6361 6c5f 6469  value', local_di
-0001ee30: 6374 3d7b 2276 616c 7565 223a 2076 616c  ct={"value": val
-0001ee40: 7565 7d29 2e63 6f6d 7075 7465 2829 0a20  ue}).compute(). 
-0001ee50: 2020 2020 2020 2020 2020 7820 2079 2020            x  y  
-0001ee60: 7a20 7a0a 2020 2020 2020 2020 3020 2031  z z.        0  1
-0001ee70: 2020 3120 2020 2034 0a20 2020 2020 2020    1    4.       
-0001ee80: 2032 2020 3120 2033 2020 2020 320a 2020   2  1  3    2.  
-0001ee90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001eea0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-0001eeb0: 6c65 6374 696f 6e28 5175 6572 7928 7365  lection(Query(se
-0001eec0: 6c66 2c20 6578 7072 2c20 6b77 6172 6773  lf, expr, kwargs
-0001eed0: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
-0001eee0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0001eef0: 6d65 290a 2020 2020 6465 6620 6d6f 6465  me).    def mode
-0001ef00: 2873 656c 662c 2064 726f 706e 613d 5472  (self, dropna=Tr
-0001ef10: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
-0001ef20: 4661 6c73 652c 206e 756d 6572 6963 5f6f  False, numeric_o
-0001ef30: 6e6c 793d 4661 6c73 6529 3a0a 2020 2020  nly=False):.    
-0001ef40: 2020 2020 6d6f 6465 7320 3d20 5b5d 0a20      modes = []. 
-0001ef50: 2020 2020 2020 2066 6f72 205f 2c20 636f         for _, co
-0001ef60: 6c20 696e 2073 656c 662e 6974 656d 7328  l in self.items(
-0001ef70: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0001ef80: 6620 6e75 6d65 7269 635f 6f6e 6c79 2061  f numeric_only a
-0001ef90: 6e64 206e 6f74 2070 642e 6170 692e 7479  nd not pd.api.ty
-0001efa0: 7065 732e 6973 5f6e 756d 6572 6963 5f64  pes.is_numeric_d
-0001efb0: 7479 7065 2863 6f6c 2e64 7479 7065 293a  type(col.dtype):
-0001efc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001efd0: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
-0001efe0: 2020 2020 2020 6d6f 6465 732e 6170 7065        modes.appe
-0001eff0: 6e64 2863 6f6c 2e6d 6f64 6528 6472 6f70  nd(col.mode(drop
-0001f000: 6e61 3d64 726f 706e 612c 2073 706c 6974  na=dropna, split
-0001f010: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0001f020: 7279 2929 0a20 2020 2020 2020 2072 6574  ry)).        ret
-0001f030: 7572 6e20 636f 6e63 6174 286d 6f64 6573  urn concat(modes
-0001f040: 2c20 6178 6973 3d31 290a 0a20 2020 2040  , axis=1)..    @
-0001f050: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001f060: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001f070: 6566 2061 6464 5f70 7265 6669 7828 7365  ef add_prefix(se
-0001f080: 6c66 2c20 7072 6566 6978 293a 0a20 2020  lf, prefix):.   
-0001f090: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-0001f0a0: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
-0001f0b0: 4164 6450 7265 6669 7828 7365 6c66 2c20  AddPrefix(self, 
-0001f0c0: 7072 6566 6978 2929 0a0a 2020 2020 4064  prefix))..    @d
-0001f0d0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001f0e0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001f0f0: 6620 6164 645f 7375 6666 6978 2873 656c  f add_suffix(sel
-0001f100: 662c 2073 7566 6669 7829 3a0a 2020 2020  f, suffix):.    
-0001f110: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-0001f120: 6f6c 6c65 6374 696f 6e28 6578 7072 2e41  ollection(expr.A
-0001f130: 6464 5375 6666 6978 2873 656c 662c 2073  ddSuffix(self, s
-0001f140: 7566 6669 7829 290a 0a20 2020 2064 6566  uffix))..    def
-0001f150: 2070 6976 6f74 5f74 6162 6c65 2873 656c   pivot_table(sel
-0001f160: 662c 2069 6e64 6578 2c20 636f 6c75 6d6e  f, index, column
-0001f170: 732c 2076 616c 7565 732c 2061 6767 6675  s, values, aggfu
-0001f180: 6e63 3d22 6d65 616e 2229 3a0a 2020 2020  nc="mean"):.    
-0001f190: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f1a0: 4372 6561 7465 2061 2073 7072 6561 6473  Create a spreads
-0001f1b0: 6865 6574 2d73 7479 6c65 2070 6976 6f74  heet-style pivot
-0001f1c0: 2074 6162 6c65 2061 7320 6120 4461 7461   table as a Data
-0001f1d0: 4672 616d 652e 2054 6172 6765 7420 6060  Frame. Target ``
-0001f1e0: 636f 6c75 6d6e 7360 600a 2020 2020 2020  columns``.      
-0001f1f0: 2020 6d75 7374 2068 6176 6520 6361 7465    must have cate
-0001f200: 676f 7279 2064 7479 7065 2074 6f20 696e  gory dtype to in
-0001f210: 6665 7220 7265 7375 6c74 2773 2060 6063  fer result's ``c
-0001f220: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
-0001f230: 2020 6060 696e 6465 7860 602c 2060 6063    ``index``, ``c
-0001f240: 6f6c 756d 6e73 6060 2c20 6060 7661 6c75  olumns``, ``valu
-0001f250: 6573 6060 2061 6e64 2060 6061 6767 6675  es`` and ``aggfu
-0001f260: 6e63 6060 206d 7573 7420 6265 2061 6c6c  nc`` must be all
-0001f270: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
-0001f280: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0001f290: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0001f2a0: 2020 2020 2020 2020 7661 6c75 6573 203a          values :
-0001f2b0: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
-0001f2c0: 2020 2020 636f 6c75 6d6e 2074 6f20 6167      column to ag
-0001f2d0: 6772 6567 6174 650a 2020 2020 2020 2020  gregate.        
-0001f2e0: 696e 6465 7820 3a20 7363 616c 6172 0a20  index : scalar. 
-0001f2f0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0001f300: 6e20 746f 2062 6520 696e 6465 780a 2020  n to be index.  
-0001f310: 2020 2020 2020 636f 6c75 6d6e 7320 3a20        columns : 
-0001f320: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
-0001f330: 2020 2063 6f6c 756d 6e20 746f 2062 6520     column to be 
-0001f340: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-0001f350: 6167 6766 756e 6320 3a20 7b27 6d65 616e  aggfunc : {'mean
-0001f360: 272c 2027 7375 6d27 2c20 2763 6f75 6e74  ', 'sum', 'count
-0001f370: 277d 2c20 6465 6661 756c 7420 276d 6561  '}, default 'mea
-0001f380: 6e27 0a0a 2020 2020 2020 2020 5265 7475  n'..        Retu
-0001f390: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0001f3a0: 2d2d 2d0a 2020 2020 2020 2020 7461 626c  ---.        tabl
-0001f3b0: 6520 3a20 4461 7461 4672 616d 650a 2020  e : DataFrame.  
-0001f3c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001f3d0: 2020 7265 7475 726e 2070 6976 6f74 5f74    return pivot_t
-0001f3e0: 6162 6c65 2873 656c 662c 2069 6e64 6578  able(self, index
-0001f3f0: 2c20 636f 6c75 6d6e 732c 2076 616c 7565  , columns, value
-0001f400: 732c 2061 6767 6675 6e63 290a 0a20 2020  s, aggfunc)..   
-0001f410: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0001f420: 6566 2069 6c6f 6328 7365 6c66 293a 0a20  ef iloc(self):. 
-0001f430: 2020 2020 2020 2022 2222 5075 7265 6c79         """Purely
-0001f440: 2069 6e74 6567 6572 2d6c 6f63 6174 696f   integer-locatio
-0001f450: 6e20 6261 7365 6420 696e 6465 7869 6e67  n based indexing
-0001f460: 2066 6f72 2073 656c 6563 7469 6f6e 2062   for selection b
-0001f470: 7920 706f 7369 7469 6f6e 2e0a 0a20 2020  y position...   
-0001f480: 2020 2020 204f 6e6c 7920 696e 6465 7869       Only indexi
-0001f490: 6e67 2074 6865 2063 6f6c 756d 6e20 706f  ng the column po
-0001f4a0: 7369 7469 6f6e 7320 6973 2073 7570 706f  sitions is suppo
-0001f4b0: 7274 6564 2e20 5472 7969 6e67 2074 6f20  rted. Trying to 
-0001f4c0: 7365 6c65 6374 0a20 2020 2020 2020 2072  select.        r
-0001f4d0: 6f77 2070 6f73 6974 696f 6e73 2077 696c  ow positions wil
-0001f4e0: 6c20 7261 6973 6520 6120 5661 6c75 6545  l raise a ValueE
-0001f4f0: 7272 6f72 2e0a 0a20 2020 2020 2020 2053  rror...        S
-0001f500: 6565 203a 7265 663a 6064 6174 6166 7261  ee :ref:`datafra
-0001f510: 6d65 2e69 6e64 6578 696e 6760 2066 6f72  me.indexing` for
-0001f520: 206d 6f72 652e 0a0a 2020 2020 2020 2020   more...        
-0001f530: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-0001f540: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-0001f550: 2020 3e3e 3e20 6466 2e69 6c6f 635b 3a2c    >>> df.iloc[:,
-0001f560: 205b 322c 2030 2c20 315d 5d20 2023 2064   [2, 0, 1]]  # d
-0001f570: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0001f580: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001f590: 2020 6672 6f6d 2064 6173 6b5f 6578 7072    from dask_expr
-0001f5a0: 2e5f 696e 6465 7869 6e67 2069 6d70 6f72  ._indexing impor
-0001f5b0: 7420 494c 6f63 496e 6465 7865 720a 0a20  t ILocIndexer.. 
-0001f5c0: 2020 2020 2020 2072 6574 7572 6e20 494c         return IL
-0001f5d0: 6f63 496e 6465 7865 7228 7365 6c66 290a  ocIndexer(self).
-0001f5e0: 0a20 2020 2064 6566 205f 636f 6d70 6172  .    def _compar
-0001f5f0: 6973 6f6e 5f6f 7028 7365 6c66 2c20 6578  ison_op(self, ex
-0001f600: 7072 5f63 6c73 2c20 6f74 6865 722c 206c  pr_cls, other, l
-0001f610: 6576 656c 2c20 6178 6973 293a 0a20 2020  evel, axis):.   
-0001f620: 2020 2020 2069 6620 6c65 7665 6c20 6973       if level is
-0001f630: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0001f640: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0001f650: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0001f660: 2822 6c65 7665 6c20 6d75 7374 2062 6520  ("level must be 
-0001f670: 4e6f 6e65 2229 0a20 2020 2020 2020 2061  None").        a
-0001f680: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-0001f690: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-0001f6a0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0001f6b0: 6577 5f63 6f6c 6c65 6374 696f 6e28 6578  ew_collection(ex
-0001f6c0: 7072 5f63 6c73 2873 656c 662c 206f 7468  pr_cls(self, oth
-0001f6d0: 6572 2c20 6178 6973 2929 0a0a 2020 2020  er, axis))..    
-0001f6e0: 6465 6620 6c74 2873 656c 662c 206f 7468  def lt(self, oth
-0001f6f0: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
-0001f700: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
-0001f710: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
-0001f720: 6d70 6172 6973 6f6e 5f6f 7028 6578 7072  mparison_op(expr
-0001f730: 2e4c 5446 7261 6d65 2c20 6f74 6865 722c  .LTFrame, other,
-0001f740: 206c 6576 656c 2c20 6178 6973 290a 0a20   level, axis).. 
-0001f750: 2020 2064 6566 206c 6528 7365 6c66 2c20     def le(self, 
-0001f760: 6f74 6865 722c 206c 6576 656c 3d4e 6f6e  other, level=Non
-0001f770: 652c 2061 7869 733d 3029 3a0a 2020 2020  e, axis=0):.    
-0001f780: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001f790: 5f63 6f6d 7061 7269 736f 6e5f 6f70 2865  _comparison_op(e
-0001f7a0: 7870 722e 4c45 4672 616d 652c 206f 7468  xpr.LEFrame, oth
-0001f7b0: 6572 2c20 6c65 7665 6c2c 2061 7869 7329  er, level, axis)
-0001f7c0: 0a0a 2020 2020 6465 6620 6774 2873 656c  ..    def gt(sel
-0001f7d0: 662c 206f 7468 6572 2c20 6c65 7665 6c3d  f, other, level=
-0001f7e0: 4e6f 6e65 2c20 6178 6973 3d30 293a 0a20  None, axis=0):. 
-0001f7f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001f800: 6c66 2e5f 636f 6d70 6172 6973 6f6e 5f6f  lf._comparison_o
-0001f810: 7028 6578 7072 2e47 5446 7261 6d65 2c20  p(expr.GTFrame, 
-0001f820: 6f74 6865 722c 206c 6576 656c 2c20 6178  other, level, ax
-0001f830: 6973 290a 0a20 2020 2064 6566 2067 6528  is)..    def ge(
-0001f840: 7365 6c66 2c20 6f74 6865 722c 206c 6576  self, other, lev
-0001f850: 656c 3d4e 6f6e 652c 2061 7869 733d 3029  el=None, axis=0)
-0001f860: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001f870: 2073 656c 662e 5f63 6f6d 7061 7269 736f   self._compariso
-0001f880: 6e5f 6f70 2865 7870 722e 4745 4672 616d  n_op(expr.GEFram
-0001f890: 652c 206f 7468 6572 2c20 6c65 7665 6c2c  e, other, level,
-0001f8a0: 2061 7869 7329 0a0a 2020 2020 6465 6620   axis)..    def 
-0001f8b0: 6e65 2873 656c 662c 206f 7468 6572 2c20  ne(self, other, 
-0001f8c0: 6c65 7665 6c3d 4e6f 6e65 2c20 6178 6973  level=None, axis
-0001f8d0: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
-0001f8e0: 7572 6e20 7365 6c66 2e5f 636f 6d70 6172  urn self._compar
-0001f8f0: 6973 6f6e 5f6f 7028 6578 7072 2e4e 4546  ison_op(expr.NEF
-0001f900: 7261 6d65 2c20 6f74 6865 722c 206c 6576  rame, other, lev
-0001f910: 656c 2c20 6178 6973 290a 0a20 2020 2064  el, axis)..    d
-0001f920: 6566 2065 7128 7365 6c66 2c20 6f74 6865  ef eq(self, othe
-0001f930: 722c 206c 6576 656c 3d4e 6f6e 652c 2061  r, level=None, a
-0001f940: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
-0001f950: 7265 7475 726e 2073 656c 662e 5f63 6f6d  return self._com
-0001f960: 7061 7269 736f 6e5f 6f70 2865 7870 722e  parison_op(expr.
-0001f970: 4551 4672 616d 652c 206f 7468 6572 2c20  EQFrame, other, 
-0001f980: 6c65 7665 6c2c 2061 7869 7329 0a0a 2020  level, axis)..  
-0001f990: 2020 6465 6620 6361 7465 676f 7269 7a65    def categorize
-0001f9a0: 2873 656c 662c 2063 6f6c 756d 6e73 3d4e  (self, columns=N
-0001f9b0: 6f6e 652c 2069 6e64 6578 3d4e 6f6e 652c  one, index=None,
-0001f9c0: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
-0001f9d0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
-0001f9e0: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
-0001f9f0: 2063 6f6c 756d 6e73 206f 6620 7468 6520   columns of the 
-0001fa00: 4461 7461 4672 616d 6520 746f 2063 6174  DataFrame to cat
-0001fa10: 6567 6f72 7920 6474 7970 652e 0a0a 2020  egory dtype...  
-0001fa20: 2020 2020 2020 2e2e 2077 6172 6e69 6e67        .. warning
-0001fa30: 3a3a 2054 6869 7320 6d65 7468 6f64 2065  :: This method e
-0001fa40: 6167 6572 6c79 2063 6f6d 7075 7465 7320  agerly computes 
-0001fa50: 7468 6520 6361 7465 676f 7269 6573 206f  the categories o
-0001fa60: 6620 7468 6520 6368 6f73 656e 2063 6f6c  f the chosen col
-0001fa70: 756d 6e73 2e0a 0a20 2020 2020 2020 2050  umns...        P
-0001fa80: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0001fa90: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0001faa0: 2020 2020 2063 6f6c 756d 6e73 203a 206c       columns : l
-0001fab0: 6973 742c 206f 7074 696f 6e61 6c0a 2020  ist, optional.  
-0001fac0: 2020 2020 2020 2020 2020 4120 6c69 7374            A list
-0001fad0: 206f 6620 636f 6c75 6d6e 206e 616d 6573   of column names
-0001fae0: 2074 6f20 636f 6e76 6572 7420 746f 2063   to convert to c
-0001faf0: 6174 6567 6f72 6963 616c 732e 2042 7920  ategoricals. By 
-0001fb00: 6465 6661 756c 7420 616e 790a 2020 2020  default any.    
-0001fb10: 2020 2020 2020 2020 636f 6c75 6d6e 2077          column w
-0001fb20: 6974 6820 616e 206f 626a 6563 7420 6474  ith an object dt
-0001fb30: 7970 6520 6973 2063 6f6e 7665 7274 6564  ype is converted
-0001fb40: 2074 6f20 6120 6361 7465 676f 7269 6361   to a categorica
-0001fb50: 6c2c 2061 6e64 2061 6e79 0a20 2020 2020  l, and any.     
-0001fb60: 2020 2020 2020 2075 6e6b 6e6f 776e 2063         unknown c
-0001fb70: 6174 6567 6f72 6963 616c 7320 6172 6520  ategoricals are 
-0001fb80: 6d61 6465 206b 6e6f 776e 2e0a 2020 2020  made known..    
-0001fb90: 2020 2020 696e 6465 7820 3a20 626f 6f6c      index : bool
-0001fba0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0001fbb0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-0001fbc0: 6f20 6361 7465 676f 7269 7a65 2074 6865  o categorize the
-0001fbd0: 2069 6e64 6578 2e20 4279 2064 6566 6175   index. By defau
-0001fbe0: 6c74 2c20 6f62 6a65 6374 2069 6e64 6963  lt, object indic
-0001fbf0: 6573 2061 7265 0a20 2020 2020 2020 2020  es are.         
-0001fc00: 2020 2063 6f6e 7665 7274 6564 2074 6f20     converted to 
-0001fc10: 6361 7465 676f 7269 6361 6c2c 2061 6e64  categorical, and
-0001fc20: 2075 6e6b 6e6f 776e 2063 6174 6567 6f72   unknown categor
-0001fc30: 6963 616c 2069 6e64 6963 6573 2061 7265  ical indices are
-0001fc40: 206d 6164 650a 2020 2020 2020 2020 2020   made.          
-0001fc50: 2020 6b6e 6f77 6e2e 2053 6574 2054 7275    known. Set Tru
-0001fc60: 6520 746f 2061 6c77 6179 7320 6361 7465  e to always cate
-0001fc70: 676f 7269 7a65 2074 6865 2069 6e64 6578  gorize the index
-0001fc80: 2c20 4661 6c73 6520 746f 206e 6576 6572  , False to never
-0001fc90: 2e0a 2020 2020 2020 2020 7370 6c69 745f  ..        split_
-0001fca0: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
-0001fcb0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0001fcc0: 2020 4772 6f75 7020 7061 7274 6974 696f    Group partitio
-0001fcd0: 6e73 2069 6e74 6f20 6772 6f75 7073 206f  ns into groups o
-0001fce0: 6620 7468 6973 2073 697a 6520 7768 696c  f this size whil
-0001fcf0: 6520 7065 7266 6f72 6d69 6e67 2061 0a20  e performing a. 
-0001fd00: 2020 2020 2020 2020 2020 2074 7265 652d             tree-
-0001fd10: 7265 6475 6374 696f 6e2e 2049 6620 7365  reduction. If se
-0001fd20: 7420 746f 2046 616c 7365 2c20 6e6f 2074  t to False, no t
-0001fd30: 7265 652d 7265 6475 6374 696f 6e20 7769  ree-reduction wi
-0001fd40: 6c6c 2062 6520 7573 6564 2e0a 2020 2020  ll be used..    
-0001fd50: 2020 2020 6b77 6172 6773 0a20 2020 2020      kwargs.     
-0001fd60: 2020 2020 2020 204b 6579 776f 7264 2061         Keyword a
-0001fd70: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
-0001fd80: 7365 6420 6f6e 2074 6f20 636f 6d70 7574  sed on to comput
-0001fd90: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-0001fda0: 2020 2020 2020 2064 6620 3d20 7365 6c66         df = self
-0001fdb0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0001fdc0: 6466 2e5f 6d65 7461 0a20 2020 2020 2020  df._meta.       
-0001fdd0: 2069 6620 636f 6c75 6d6e 7320 6973 204e   if columns is N
-0001fde0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001fdf0: 2063 6f6c 756d 6e73 203d 206c 6973 7428   columns = list(
-0001fe00: 6d65 7461 2e73 656c 6563 745f 6474 7970  meta.select_dtyp
-0001fe10: 6573 285b 226f 626a 6563 7422 2c20 2273  es(["object", "s
-0001fe20: 7472 696e 6722 2c20 2263 6174 6567 6f72  tring", "categor
-0001fe30: 7922 5d29 2e63 6f6c 756d 6e73 290a 2020  y"]).columns).  
-0001fe40: 2020 2020 2020 656c 6966 2069 735f 7363        elif is_sc
-0001fe50: 616c 6172 2863 6f6c 756d 6e73 293a 0a20  alar(columns):. 
-0001fe60: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0001fe70: 6e73 203d 205b 636f 6c75 6d6e 735d 0a0a  ns = [columns]..
-0001fe80: 2020 2020 2020 2020 2320 4669 6c74 6572          # Filter
-0001fe90: 206f 7574 206b 6e6f 776e 2063 6174 6567   out known categ
-0001fea0: 6f72 6963 616c 2063 6f6c 756d 6e73 0a20  orical columns. 
-0001feb0: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-0001fec0: 205b 0a20 2020 2020 2020 2020 2020 2063   [.            c
-0001fed0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0001fee0: 2063 2069 6e20 636f 6c75 6d6e 730a 2020   c in columns.  
-0001fef0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001ff00: 2028 6973 5f63 6174 6567 6f72 6963 616c   (is_categorical
-0001ff10: 5f64 7479 7065 286d 6574 615b 635d 2920  _dtype(meta[c]) 
-0001ff20: 616e 6420 6861 735f 6b6e 6f77 6e5f 6361  and has_known_ca
-0001ff30: 7465 676f 7269 6573 286d 6574 615b 635d  tegories(meta[c]
-0001ff40: 2929 0a20 2020 2020 2020 205d 0a0a 2020  )).        ]..  
-0001ff50: 2020 2020 2020 6966 2069 6e64 6578 2069        if index i
-0001ff60: 7320 6e6f 7420 4661 6c73 653a 0a20 2020  s not False:.   
-0001ff70: 2020 2020 2020 2020 2069 6620 6973 5f63           if is_c
-0001ff80: 6174 6567 6f72 6963 616c 5f64 7479 7065  ategorical_dtype
-0001ff90: 286d 6574 612e 696e 6465 7829 3a0a 2020  (meta.index):.  
-0001ffa0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001ffb0: 6465 7820 3d20 6e6f 7420 6861 735f 6b6e  dex = not has_kn
-0001ffc0: 6f77 6e5f 6361 7465 676f 7269 6573 286d  own_categories(m
-0001ffd0: 6574 612e 696e 6465 7829 0a20 2020 2020  eta.index).     
-0001ffe0: 2020 2020 2020 2065 6c69 6620 696e 6465         elif inde
-0001fff0: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
-00020000: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00020010: 203d 2073 7472 286d 6574 612e 696e 6465   = str(meta.inde
-00020020: 782e 6474 7970 6529 2069 6e20 2822 6f62  x.dtype) in ("ob
-00020030: 6a65 6374 222c 2022 7374 7269 6e67 2229  ject", "string")
-00020040: 0a0a 2020 2020 2020 2020 2320 4e6f 7468  ..        # Noth
-00020050: 696e 6720 746f 2064 6f0a 2020 2020 2020  ing to do.      
-00020060: 2020 6966 206e 6f74 206c 656e 2863 6f6c    if not len(col
-00020070: 756d 6e73 2920 616e 6420 696e 6465 7820  umns) and index 
-00020080: 6973 2046 616c 7365 3a0a 2020 2020 2020  is False:.      
-00020090: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
-000200a0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-000200b0: 736b 5f65 7870 722e 5f63 6f6c 6c65 6374  sk_expr._collect
-000200c0: 696f 6e20 696d 706f 7274 206e 6577 5f63  ion import new_c
-000200d0: 6f6c 6c65 6374 696f 6e0a 0a20 2020 2020  ollection..     
-000200e0: 2020 2023 2045 6167 6572 6c79 2063 6f6d     # Eagerly com
-000200f0: 7075 7465 2074 6865 2063 6174 6567 6f72  pute the categor
-00020100: 6965 730a 2020 2020 2020 2020 6361 7465  ies.        cate
-00020110: 676f 7269 6573 2c20 696e 6465 7820 3d20  gories, index = 
-00020120: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-00020130: 2020 2020 2020 2020 2020 2020 4765 7443              GetC
-00020140: 6174 6567 6f72 6965 7328 7365 6c66 2c20  ategories(self, 
-00020150: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
-00020160: 2069 6e64 6578 3d69 6e64 6578 2c20 7370   index=index, sp
-00020170: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00020180: 6576 6572 7929 0a20 2020 2020 2020 2029  every).        )
-00020190: 2e63 6f6d 7075 7465 2829 0a0a 2020 2020  .compute()..    
-000201a0: 2020 2020 2320 536f 6d65 206f 7065 7261      # Some opera
-000201b0: 7469 6f6e 7320 6c69 6b65 2067 6574 5f64  tions like get_d
-000201c0: 756d 6d69 6573 2829 2072 656c 7920 6f6e  ummies() rely on
-000201d0: 2074 6865 206f 7264 6572 206f 6620 6361   the order of ca
-000201e0: 7465 676f 7269 6573 0a20 2020 2020 2020  tegories.       
-000201f0: 2063 6174 6567 6f72 6965 7320 3d20 7b6b   categories = {k
-00020200: 3a20 762e 736f 7274 5f76 616c 7565 7328  : v.sort_values(
-00020210: 2920 666f 7220 6b2c 2076 2069 6e20 6361  ) for k, v in ca
-00020220: 7465 676f 7269 6573 2e69 7465 6d73 2829  tegories.items()
-00020230: 7d0a 0a20 2020 2020 2020 2023 2043 6174  }..        # Cat
-00020240: 6567 6f72 697a 6520 6561 6368 2070 6172  egorize each par
-00020250: 7469 7469 6f6e 0a20 2020 2020 2020 2072  tition.        r
-00020260: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00020270: 7469 6f6e 2843 6174 6567 6f72 697a 6528  tion(Categorize(
-00020280: 7365 6c66 2c20 6361 7465 676f 7269 6573  self, categories
-00020290: 2c20 696e 6465 7829 290a 0a20 2020 2040  , index))..    @
-000202a0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-000202b0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-000202c0: 6566 206e 756e 6971 7565 2873 656c 662c  ef nunique(self,
-000202d0: 2061 7869 733d 302c 2064 726f 706e 613d   axis=0, dropna=
-000202e0: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-000202f0: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00020300: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-00020310: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00020320: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00020330: 6e28 6578 7072 2e4e 556e 6971 7565 436f  n(expr.NUniqueCo
-00020340: 6c75 6d6e 7328 7365 6c66 2c20 6178 6973  lumns(self, axis
-00020350: 3d61 7869 732c 2064 726f 706e 613d 6472  =axis, dropna=dr
-00020360: 6f70 6e61 2929 0a20 2020 2020 2020 2065  opna)).        e
-00020370: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00020380: 2072 6574 7572 6e20 636f 6e63 6174 280a   return concat(.
-00020390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000203b0: 2020 2020 2020 636f 6c2e 6e75 6e69 7175        col.nuniqu
-000203c0: 6528 6472 6f70 6e61 3d64 726f 706e 612c  e(dropna=dropna,
-000203d0: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-000203e0: 6974 5f65 7665 7279 292e 746f 5f73 6572  it_every).to_ser
-000203f0: 6965 7328 6e61 6d65 290a 2020 2020 2020  ies(name).      
-00020400: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00020410: 7220 6e61 6d65 2c20 636f 6c20 696e 2073  r name, col in s
-00020420: 656c 662e 6974 656d 7328 290a 2020 2020  elf.items().    
-00020430: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00020440: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00020450: 2064 6566 2071 7561 6e74 696c 6528 7365   def quantile(se
-00020460: 6c66 2c20 713d 302e 352c 2061 7869 733d  lf, q=0.5, axis=
-00020470: 302c 206e 756d 6572 6963 5f6f 6e6c 793d  0, numeric_only=
-00020480: 4661 6c73 652c 206d 6574 686f 643d 2264  False, method="d
-00020490: 6566 6175 6c74 2229 3a0a 2020 2020 2020  efault"):.      
-000204a0: 2020 2222 2241 7070 726f 7869 6d61 7465    """Approximate
-000204b0: 2072 6f77 2d77 6973 6520 616e 6420 7072   row-wise and pr
-000204c0: 6563 6973 6520 636f 6c75 6d6e 2d77 6973  ecise column-wis
-000204d0: 6520 7175 616e 7469 6c65 7320 6f66 2044  e quantiles of D
-000204e0: 6174 6146 7261 6d65 0a0a 2020 2020 2020  ataFrame..      
-000204f0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00020500: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00020510: 2020 2020 2020 2020 7120 3a20 6c69 7374          q : list
-00020520: 2f61 7272 6179 206f 6620 666c 6f61 7473  /array of floats
-00020530: 2c20 6465 6661 756c 7420 302e 3520 2835  , default 0.5 (5
-00020540: 3025 290a 2020 2020 2020 2020 2020 2020  0%).            
-00020550: 4974 6572 6162 6c65 206f 6620 6e75 6d62  Iterable of numb
-00020560: 6572 7320 7261 6e67 696e 6720 6672 6f6d  ers ranging from
-00020570: 2030 2074 6f20 3120 666f 7220 7468 6520   0 to 1 for the 
-00020580: 6465 7369 7265 6420 7175 616e 7469 6c65  desired quantile
-00020590: 730a 2020 2020 2020 2020 6178 6973 203a  s.        axis :
-000205a0: 207b 302c 2031 2c20 2769 6e64 6578 272c   {0, 1, 'index',
-000205b0: 2027 636f 6c75 6d6e 7327 7d20 2864 6566   'columns'} (def
-000205c0: 6175 6c74 2030 290a 2020 2020 2020 2020  ault 0).        
-000205d0: 2020 2020 3020 6f72 2027 696e 6465 7827      0 or 'index'
-000205e0: 2066 6f72 2072 6f77 2d77 6973 652c 2031   for row-wise, 1
-000205f0: 206f 7220 2763 6f6c 756d 6e73 2720 666f   or 'columns' fo
-00020600: 7220 636f 6c75 6d6e 2d77 6973 650a 2020  r column-wise.  
-00020610: 2020 2020 2020 6d65 7468 6f64 203a 207b        method : {
-00020620: 2764 6566 6175 6c74 272c 2027 7464 6967  'default', 'tdig
-00020630: 6573 7427 2c20 2764 6173 6b27 7d2c 206f  est', 'dask'}, o
-00020640: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00020650: 2020 2020 5768 6174 206d 6574 686f 6420      What method 
-00020660: 746f 2075 7365 2e20 4279 2064 6566 6175  to use. By defau
-00020670: 6c74 2077 696c 6c20 7573 6520 6461 736b  lt will use dask
-00020680: 2773 2069 6e74 6572 6e61 6c20 6375 7374  's internal cust
-00020690: 6f6d 0a20 2020 2020 2020 2020 2020 2061  om.            a
-000206a0: 6c67 6f72 6974 686d 2028 6060 2764 6173  lgorithm (``'das
-000206b0: 6b27 6060 292e 2020 4966 2073 6574 2074  k'``).  If set t
-000206c0: 6f20 6060 2774 6469 6765 7374 2760 6020  o ``'tdigest'`` 
-000206d0: 7769 6c6c 2075 7365 2074 6469 6765 7374  will use tdigest
-000206e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000206f0: 2066 6c6f 6174 7320 616e 6420 696e 7473   floats and ints
-00020700: 2061 6e64 2066 616c 6c62 6163 6b20 746f   and fallback to
-00020710: 2074 6865 2060 6027 6461 736b 2760 6020   the ``'dask'`` 
-00020720: 6f74 6865 7277 6973 652e 0a20 2020 2020  otherwise..     
-00020730: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
-00020740: 6c6c 6f77 6564 5f6d 6574 686f 6473 203d  llowed_methods =
-00020750: 205b 2264 6566 6175 6c74 222c 2022 6461   ["default", "da
-00020760: 736b 222c 2022 7464 6967 6573 7422 5d0a  sk", "tdigest"].
-00020770: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
-00020780: 6420 6e6f 7420 696e 2061 6c6c 6f77 6564  d not in allowed
-00020790: 5f6d 6574 686f 6473 3a0a 2020 2020 2020  _methods:.      
-000207a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-000207b0: 6545 7272 6f72 2822 6d65 7468 6f64 2063  eError("method c
-000207c0: 616e 206f 6e6c 7920 6265 2027 6465 6661  an only be 'defa
-000207d0: 756c 7427 2c20 2764 6173 6b27 206f 7220  ult', 'dask' or 
-000207e0: 2774 6469 6765 7374 2722 290a 2020 2020  'tdigest'").    
-000207f0: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-00020800: 6d65 7461 280a 2020 2020 2020 2020 2020  meta(.          
-00020810: 2020 6d65 7461 5f6e 6f6e 656d 7074 7928    meta_nonempty(
-00020820: 7365 6c66 2e5f 6d65 7461 292e 7175 616e  self._meta).quan
-00020830: 7469 6c65 280a 2020 2020 2020 2020 2020  tile(.          
-00020840: 2020 2020 2020 713d 712c 206e 756d 6572        q=q, numer
-00020850: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
-00020860: 6f6e 6c79 2c20 6178 6973 3d61 7869 730a  only, axis=axis.
-00020870: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00020880: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00020890: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
-000208a0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-000208b0: 696e 7374 616e 6365 2871 2c20 6c69 7374  instance(q, list
-000208c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000208d0: 2020 2023 204e 6f74 2073 7570 706f 7274     # Not support
-000208e0: 6564 2c20 7468 6520 7265 7375 6c74 2077  ed, the result w
-000208f0: 696c 6c20 6861 7665 2063 7572 7265 6e74  ill have current
-00020900: 2069 6e64 6578 2061 7320 636f 6c75 6d6e   index as column
-00020910: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00020920: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00020930: 6f72 2822 2771 2720 6d75 7374 2062 6520  or("'q' must be 
-00020940: 7363 616c 6172 2077 6865 6e20 6178 6973  scalar when axis
-00020950: 3d31 2069 7320 7370 6563 6966 6965 6422  =1 is specified"
-00020960: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-00020970: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-00020980: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00020990: 2020 2020 2020 2020 2020 204d 2e71 7561             M.qua
-000209a0: 6e74 696c 652c 0a20 2020 2020 2020 2020  ntile,.         
-000209b0: 2020 2020 2020 2071 2c0a 2020 2020 2020         q,.      
-000209c0: 2020 2020 2020 2020 2020 6178 6973 2c0a            axis,.
-000209d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000209e0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-000209f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00020a00: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-00020a10: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00020a20: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
-00020a30: 6e75 6d65 7269 635f 6f6e 6c79 2c0a 2020  numeric_only,.  
-00020a40: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00020a50: 2020 2020 2069 6620 6e75 6d65 7269 635f       if numeric_
-00020a60: 6f6e 6c79 3a0a 2020 2020 2020 2020 2020  only:.          
-00020a70: 2020 6672 616d 6520 3d20 7365 6c66 2e73    frame = self.s
-00020a80: 656c 6563 745f 6474 7970 6573 280a 2020  elect_dtypes(.  
-00020a90: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00020aa0: 756d 6265 7222 2c20 6578 636c 7564 653d  umber", exclude=
-00020ab0: 5b6e 702e 7469 6d65 6465 6c74 6136 342c  [np.timedelta64,
-00020ac0: 206e 702e 6461 7465 7469 6d65 3634 5d0a   np.datetime64].
-00020ad0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00020ae0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00020af0: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
-00020b00: 7365 6c66 0a0a 2020 2020 2020 2020 636f  self..        co
-00020b10: 6c6c 6563 7469 6f6e 7320 3d20 5b5d 0a20  llections = []. 
-00020b20: 2020 2020 2020 2066 6f72 205f 2c20 636f         for _, co
-00020b30: 6c20 696e 2066 7261 6d65 2e69 7465 6d73  l in frame.items
-00020b40: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00020b50: 636f 6c6c 6563 7469 6f6e 732e 6170 7065  collections.appe
-00020b60: 6e64 2863 6f6c 2e71 7561 6e74 696c 6528  nd(col.quantile(
-00020b70: 713d 712c 206d 6574 686f 643d 6d65 7468  q=q, method=meth
-00020b80: 6f64 2929 0a0a 2020 2020 2020 2020 6966  od))..        if
-00020b90: 206c 656e 2863 6f6c 6c65 6374 696f 6e73   len(collections
-00020ba0: 2920 3e20 3020 616e 6420 6973 696e 7374  ) > 0 and isinst
-00020bb0: 616e 6365 2863 6f6c 6c65 6374 696f 6e73  ance(collections
-00020bc0: 5b30 5d2c 2053 6361 6c61 7229 3a0a 2020  [0], Scalar):.  
-00020bd0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00020be0: 205f 6672 6f6d 5f73 6361 6c61 7273 2863   _from_scalars(c
-00020bf0: 6f6c 6c65 6374 696f 6e73 2c20 6d65 7461  ollections, meta
-00020c00: 2c20 6672 616d 652e 6578 7072 2e63 6f6c  , frame.expr.col
-00020c10: 756d 6e73 290a 0a20 2020 2020 2020 2072  umns)..        r
-00020c20: 6574 7572 6e20 636f 6e63 6174 2863 6f6c  eturn concat(col
-00020c30: 6c65 6374 696f 6e73 2c20 6178 6973 3d31  lections, axis=1
-00020c40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00020c50: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00020c60: 6529 0a20 2020 2064 6566 206d 6564 6961  e).    def media
-00020c70: 6e28 7365 6c66 2c20 6178 6973 3d30 2c20  n(self, axis=0, 
-00020c80: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
-00020c90: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
-00020ca0: 6178 6973 203d 3d20 3120 6f72 2073 656c  axis == 1 or sel
-00020cb0: 662e 6e70 6172 7469 7469 6f6e 7320 3d3d  f.npartitions ==
-00020cc0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00020cd0: 7265 7475 726e 2073 656c 662e 6d65 6469  return self.medi
-00020ce0: 616e 5f61 7070 726f 7869 6d61 7465 2861  an_approximate(a
-00020cf0: 7869 733d 6178 6973 2c20 6e75 6d65 7269  xis=axis, numeri
-00020d00: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
-00020d10: 6e6c 7929 0a20 2020 2020 2020 2072 6169  nly).        rai
-00020d20: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00020d30: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-00020d40: 2020 2020 2244 6173 6b20 646f 6573 6e27      "Dask doesn'
-00020d50: 7420 696d 706c 656d 656e 7420 616e 2065  t implement an e
-00020d60: 7861 6374 206d 6564 6961 6e20 696e 2061  xact median in a
-00020d70: 6c6c 2063 6173 6573 2061 7320 7468 6973  ll cases as this
-00020d80: 2069 7320 6861 7264 2074 6f20 646f 2069   is hard to do i
-00020d90: 6e20 7061 7261 6c6c 656c 2e20 220a 2020  n parallel. ".  
-00020da0: 2020 2020 2020 2020 2020 2253 6565 2074            "See t
-00020db0: 6865 2060 6d65 6469 616e 5f61 7070 726f  he `median_appro
-00020dc0: 7869 6d61 7465 6020 6d65 7468 6f64 2069  ximate` method i
-00020dd0: 6e73 7465 6164 2c20 7768 6963 6820 7573  nstead, which us
-00020de0: 6573 2061 6e20 6170 7072 6f78 696d 6174  es an approximat
-00020df0: 6520 616c 676f 7269 7468 6d2e 220a 2020  e algorithm.".  
-00020e00: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00020e10: 206d 6564 6961 6e5f 6170 7072 6f78 696d   median_approxim
-00020e20: 6174 6528 7365 6c66 2c20 6178 6973 3d30  ate(self, axis=0
-00020e30: 2c20 6d65 7468 6f64 3d22 6465 6661 756c  , method="defaul
-00020e40: 7422 2c20 6e75 6d65 7269 635f 6f6e 6c79  t", numeric_only
-00020e50: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-00020e60: 2022 2222 5265 7475 726e 2074 6865 2061   """Return the a
-00020e70: 7070 726f 7869 6d61 7465 206d 6564 6961  pproximate media
-00020e80: 6e20 6f66 2074 6865 2076 616c 7565 7320  n of the values 
-00020e90: 6f76 6572 2074 6865 2072 6571 7565 7374  over the request
-00020ea0: 6564 2061 7869 732e 0a0a 2020 2020 2020  ed axis...      
-00020eb0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00020ec0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00020ed0: 2020 2020 2020 2020 6178 6973 203a 207b          axis : {
-00020ee0: 302c 2031 2c20 2269 6e64 6578 222c 2022  0, 1, "index", "
-00020ef0: 636f 6c75 6d6e 7322 7d20 2864 6566 6175  columns"} (defau
-00020f00: 6c74 2030 290a 2020 2020 2020 2020 2020  lt 0).          
-00020f10: 2020 3020 6f72 2060 6022 696e 6465 7822    0 or ``"index"
-00020f20: 6060 2066 6f72 2072 6f77 2d77 6973 652c  `` for row-wise,
-00020f30: 2031 206f 7220 6060 2263 6f6c 756d 6e73   1 or ``"columns
-00020f40: 2260 6020 666f 7220 636f 6c75 6d6e 2d77  "`` for column-w
-00020f50: 6973 650a 2020 2020 2020 2020 6d65 7468  ise.        meth
-00020f60: 6f64 203a 207b 2764 6566 6175 6c74 272c  od : {'default',
-00020f70: 2027 7464 6967 6573 7427 2c20 2764 6173   'tdigest', 'das
-00020f80: 6b27 7d2c 206f 7074 696f 6e61 6c0a 2020  k'}, optional.  
-00020f90: 2020 2020 2020 2020 2020 5768 6174 206d            What m
-00020fa0: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
-00020fb0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
-00020fc0: 6520 4461 736b 2773 2069 6e74 6572 6e61  e Dask's interna
-00020fd0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
-00020fe0: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
-00020ff0: 6060 2264 6173 6b22 6060 292e 2020 4966  ``"dask"``).  If
-00021000: 2073 6574 2074 6f20 6060 2274 6469 6765   set to ``"tdige
-00021010: 7374 2260 6020 7769 6c6c 2075 7365 2074  st"`` will use t
-00021020: 6469 6765 7374 0a20 2020 2020 2020 2020  digest.         
-00021030: 2020 2066 6f72 2066 6c6f 6174 7320 616e     for floats an
-00021040: 6420 696e 7473 2061 6e64 2066 616c 6c62  d ints and fallb
-00021050: 6163 6b20 746f 2074 6865 2060 6022 6461  ack to the ``"da
-00021060: 736b 2260 6020 6f74 6865 7277 6973 652e  sk"`` otherwise.
-00021070: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00021080: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00021090: 2e71 7561 6e74 696c 6528 0a20 2020 2020  .quantile(.     
-000210a0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-000210b0: 2c20 6d65 7468 6f64 3d6d 6574 686f 642c  , method=method,
-000210c0: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-000210d0: 6d65 7269 635f 6f6e 6c79 0a20 2020 2020  meric_only.     
-000210e0: 2020 2029 2e72 656e 616d 6528 4e6f 6e65     ).rename(None
-000210f0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00021100: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00021110: 6529 0a20 2020 2064 6566 2064 6573 6372  e).    def descr
-00021120: 6962 6528 0a20 2020 2020 2020 2073 656c  ibe(.        sel
-00021130: 662c 0a20 2020 2020 2020 2073 706c 6974  f,.        split
-00021140: 5f65 7665 7279 3d46 616c 7365 2c0a 2020  _every=False,.  
-00021150: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-00021160: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
-00021170: 7065 7263 656e 7469 6c65 735f 6d65 7468  percentiles_meth
-00021180: 6f64 3d22 6465 6661 756c 7422 2c0a 2020  od="default",.  
-00021190: 2020 2020 2020 696e 636c 7564 653d 4e6f        include=No
-000211a0: 6e65 2c0a 2020 2020 2020 2020 6578 636c  ne,.        excl
-000211b0: 7564 653d 4e6f 6e65 2c0a 2020 2020 293a  ude=None,.    ):
-000211c0: 0a20 2020 2020 2020 2023 2054 4f44 4f3a  .        # TODO:
-000211d0: 2064 7570 6c69 6361 7465 6420 636f 6c75   duplicated colu
-000211e0: 6d6e 730a 2020 2020 2020 2020 6966 2069  mns.        if i
-000211f0: 6e63 6c75 6465 2069 7320 4e6f 6e65 2061  nclude is None a
-00021200: 6e64 2065 7863 6c75 6465 2069 7320 4e6f  nd exclude is No
-00021210: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00021220: 5f69 6e63 6c75 6465 203d 205b 6e70 2e6e  _include = [np.n
-00021230: 756d 6265 722c 206e 702e 7469 6d65 6465  umber, np.timede
-00021240: 6c74 6136 342c 206e 702e 6461 7465 7469  lta64, np.dateti
-00021250: 6d65 3634 5d0a 2020 2020 2020 2020 2020  me64].          
-00021260: 2020 636f 6c75 6d6e 7320 3d20 7365 6c66    columns = self
-00021270: 2e5f 6d65 7461 2e73 656c 6563 745f 6474  ._meta.select_dt
-00021280: 7970 6573 2869 6e63 6c75 6465 3d5f 696e  ypes(include=_in
-00021290: 636c 7564 6529 2e63 6f6c 756d 6e73 0a20  clude).columns. 
-000212a0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-000212b0: 6e28 636f 6c75 6d6e 7329 203d 3d20 303a  n(columns) == 0:
-000212c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000212d0: 2063 6f6c 756d 6e73 203d 2073 656c 662e   columns = self.
-000212e0: 5f6d 6574 612e 636f 6c75 6d6e 730a 2020  _meta.columns.  
-000212f0: 2020 2020 2020 656c 6966 2069 6e63 6c75        elif inclu
-00021300: 6465 203d 3d20 2261 6c6c 223a 0a20 2020  de == "all":.   
-00021310: 2020 2020 2020 2020 2069 6620 6578 636c           if excl
-00021320: 7564 6520 6973 206e 6f74 204e 6f6e 653a  ude is not None:
-00021330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021340: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00021350: 7228 2265 7863 6c75 6465 206d 7573 7420  r("exclude must 
-00021360: 6265 204e 6f6e 6520 7768 656e 2069 6e63  be None when inc
-00021370: 6c75 6465 2069 7320 2761 6c6c 2722 290a  lude is 'all'").
-00021380: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00021390: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
-000213a0: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
-000213b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000213c0: 2020 2063 6f6c 756d 6e73 203d 2073 656c     columns = sel
-000213d0: 662e 5f6d 6574 612e 7365 6c65 6374 5f64  f._meta.select_d
-000213e0: 7479 7065 7328 696e 636c 7564 653d 696e  types(include=in
-000213f0: 636c 7564 652c 2065 7863 6c75 6465 3d65  clude, exclude=e
-00021400: 7863 6c75 6465 292e 636f 6c75 6d6e 730a  xclude).columns.
-00021410: 0a20 2020 2020 2020 2073 7461 7473 203d  .        stats =
-00021420: 205b 0a20 2020 2020 2020 2020 2020 2073   [.            s
-00021430: 656c 665b 636f 6c5d 2e64 6573 6372 6962  elf[col].describ
-00021440: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00021450: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
-00021460: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-00021470: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-00021480: 656e 7469 6c65 733d 7065 7263 656e 7469  entiles=percenti
-00021490: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
-000214a0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
-000214b0: 5f6d 6574 686f 643d 7065 7263 656e 7469  _method=percenti
-000214c0: 6c65 735f 6d65 7468 6f64 2c0a 2020 2020  les_method,.    
-000214d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000214e0: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
-000214f0: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
-00021500: 205d 0a20 2020 2020 2020 2072 6574 7572   ].        retur
-00021510: 6e20 636f 6e63 6174 2873 7461 7473 2c20  n concat(stats, 
-00021520: 6178 6973 3d31 290a 0a20 2020 2040 6465  axis=1)..    @de
-00021530: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00021540: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00021550: 2070 6f70 2873 656c 662c 2069 7465 6d29   pop(self, item)
-00021560: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
-00021570: 7365 6c66 5b69 7465 6d5d 0a20 2020 2020  self[item].     
-00021580: 2020 2073 656c 662e 5f65 7870 7220 3d20     self._expr = 
-00021590: 6578 7072 2e44 726f 7028 7365 6c66 2c20  expr.Drop(self, 
-000215a0: 636f 6c75 6d6e 733d 5b69 7465 6d5d 290a  columns=[item]).
-000215b0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
-000215c0: 7574 0a0a 2020 2020 6465 6620 696e 666f  ut..    def info
-000215d0: 2873 656c 662c 2062 7566 3d4e 6f6e 652c  (self, buf=None,
-000215e0: 2076 6572 626f 7365 3d46 616c 7365 2c20   verbose=False, 
-000215f0: 6d65 6d6f 7279 5f75 7361 6765 3d46 616c  memory_usage=Fal
-00021600: 7365 293a 0a20 2020 2020 2020 2022 2222  se):.        """
-00021610: 0a20 2020 2020 2020 2043 6f6e 6369 7365  .        Concise
-00021620: 2073 756d 6d61 7279 206f 6620 6120 4461   summary of a Da
-00021630: 736b 2044 6174 6146 7261 6d65 0a20 2020  sk DataFrame.   
-00021640: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00021650: 2069 6620 6275 6620 6973 204e 6f6e 653a   if buf is None:
-00021660: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-00021670: 6f72 7420 7379 730a 0a20 2020 2020 2020  ort sys..       
-00021680: 2020 2020 2062 7566 203d 2073 7973 2e73       buf = sys.s
-00021690: 7464 6f75 740a 2020 2020 2020 2020 6c69  tdout.        li
-000216a0: 6e65 7320 3d20 5b73 7472 2874 7970 6528  nes = [str(type(
-000216b0: 7365 6c66 2929 2e72 6570 6c61 6365 2822  self)).replace("
-000216c0: 2e5f 636f 6c6c 6563 7469 6f6e 222c 2022  ._collection", "
-000216d0: 2229 5d0a 0a20 2020 2020 2020 2069 6620  ")]..        if 
-000216e0: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
-000216f0: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-00021700: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
-00021710: 2866 227b 7479 7065 2873 656c 662e 696e  (f"{type(self.in
-00021720: 6465 782e 5f6d 6574 6129 2e5f 5f6e 616d  dex._meta).__nam
-00021730: 655f 5f7d 3a20 3020 656e 7472 6965 7322  e__}: 0 entries"
-00021740: 290a 2020 2020 2020 2020 2020 2020 6c69  ).            li
-00021750: 6e65 732e 6170 7065 6e64 2866 2245 6d70  nes.append(f"Emp
-00021760: 7479 207b 7479 7065 2873 656c 6629 2e5f  ty {type(self)._
-00021770: 5f6e 616d 655f 5f7d 2229 0a20 2020 2020  _name__}").     
-00021780: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
-00021790: 2862 7566 2c20 6c69 6e65 7329 0a20 2020  (buf, lines).   
-000217a0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-000217b0: 0a20 2020 2020 2020 2023 2047 726f 7570  .        # Group
-000217c0: 2061 6e64 2065 7865 6375 7465 2074 6865   and execute the
-000217d0: 2072 6571 7569 7265 6420 636f 6d70 7574   required comput
-000217e0: 6174 696f 6e73 0a20 2020 2020 2020 2063  ations.        c
-000217f0: 6f6d 7075 7461 7469 6f6e 7320 3d20 7b7d  omputations = {}
-00021800: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
-00021810: 6f73 653a 0a20 2020 2020 2020 2020 2020  ose:.           
-00021820: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
-00021830: 6461 7465 287b 2269 6e64 6578 223a 2073  date({"index": s
-00021840: 656c 662e 696e 6465 782c 2022 636f 756e  elf.index, "coun
-00021850: 7422 3a20 7365 6c66 2e63 6f75 6e74 2829  t": self.count()
-00021860: 7d29 0a20 2020 2020 2020 2069 6620 6d65  }).        if me
-00021870: 6d6f 7279 5f75 7361 6765 3a0a 2020 2020  mory_usage:.    
-00021880: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
-00021890: 696f 6e73 5b22 6d65 6d6f 7279 5f75 7361  ions["memory_usa
-000218a0: 6765 225d 203d 2073 656c 662e 6d65 6d6f  ge"] = self.memo
-000218b0: 7279 5f75 7361 6765 2864 6565 703d 5472  ry_usage(deep=Tr
-000218c0: 7565 2c20 696e 6465 783d 5472 7565 290a  ue, index=True).
-000218d0: 0a20 2020 2020 2020 2063 6f6d 7075 7461  .        computa
-000218e0: 7469 6f6e 7320 3d20 6469 6374 287a 6970  tions = dict(zip
-000218f0: 2863 6f6d 7075 7461 7469 6f6e 732e 6b65  (computations.ke
-00021900: 7973 2829 2c20 636f 6d70 7574 6528 2a63  ys(), compute(*c
-00021910: 6f6d 7075 7461 7469 6f6e 732e 7661 6c75  omputations.valu
-00021920: 6573 2829 2929 290a 0a20 2020 2020 2020  es())))..       
-00021930: 2069 6620 7665 7262 6f73 653a 0a20 2020   if verbose:.   
-00021940: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
-00021950: 7465 7874 7772 6170 0a0a 2020 2020 2020  textwrap..      
-00021960: 2020 2020 2020 696e 6465 7820 3d20 636f        index = co
-00021970: 6d70 7574 6174 696f 6e73 5b22 696e 6465  mputations["inde
-00021980: 7822 5d0a 2020 2020 2020 2020 2020 2020  x"].            
-00021990: 636f 756e 7473 203d 2063 6f6d 7075 7461  counts = computa
-000219a0: 7469 6f6e 735b 2263 6f75 6e74 225d 0a20  tions["count"]. 
-000219b0: 2020 2020 2020 2020 2020 206c 696e 6573             lines
-000219c0: 2e61 7070 656e 6428 696e 6465 785f 7375  .append(index_su
-000219d0: 6d6d 6172 7928 696e 6465 7829 290a 2020  mmary(index)).  
-000219e0: 2020 2020 2020 2020 2020 6c69 6e65 732e            lines.
-000219f0: 6170 7065 6e64 2866 2244 6174 6120 636f  append(f"Data co
-00021a00: 6c75 6d6e 7320 2874 6f74 616c 207b 6c65  lumns (total {le
-00021a10: 6e28 7365 6c66 2e63 6f6c 756d 6e73 297d  n(self.columns)}
-00021a20: 2063 6f6c 756d 6e73 293a 2229 0a0a 2020   columns):")..  
-00021a30: 2020 2020 2020 2020 2020 6672 6f6d 2070            from p
-00021a40: 616e 6461 732e 696f 2e66 6f72 6d61 7473  andas.io.formats
-00021a50: 2e70 7269 6e74 696e 6720 696d 706f 7274  .printing import
-00021a60: 2070 7072 696e 745f 7468 696e 670a 0a20   pprint_thing.. 
-00021a70: 2020 2020 2020 2020 2020 2073 7061 6365             space
-00021a80: 203d 206d 6178 286c 656e 2870 7072 696e   = max(len(pprin
-00021a90: 745f 7468 696e 6728 6b29 2920 666f 7220  t_thing(k)) for 
-00021aa0: 6b20 696e 2073 656c 662e 636f 6c75 6d6e  k in self.column
-00021ab0: 7329 202b 2031 0a20 2020 2020 2020 2020  s) + 1.         
-00021ac0: 2020 2063 6f6c 756d 6e5f 7769 6474 6820     column_width 
-00021ad0: 3d20 6d61 7828 7370 6163 652c 2037 290a  = max(space, 7).
-00021ae0: 0a20 2020 2020 2020 2020 2020 2068 6561  .            hea
-00021af0: 6465 7220 3d20 280a 2020 2020 2020 2020  der = (.        
-00021b00: 2020 2020 2020 2020 7465 7874 7772 6170          textwrap
-00021b10: 2e64 6564 656e 7428 0a20 2020 2020 2020  .dedent(.       
-00021b20: 2020 2020 2020 2020 2020 2020 2022 2222               """
-00021b30: 5c0a 2020 2020 2020 2020 2020 2020 2023  \.             #
-00021b40: 2020 207b 7b63 6f6c 756d 6e3a 3c7b 636f     {{column:<{co
-00021b50: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 4e6f  lumn_width}}} No
-00021b60: 6e2d 4e75 6c6c 2043 6f75 6e74 2020 4474  n-Null Count  Dt
-00021b70: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-00021b80: 2d2d 2d20 207b 7b75 6e64 6572 6c3a 3c7b  ---  {{underl:<{
-00021b90: 636f 6c75 6d6e 5f77 6964 7468 7d7d 7d20  column_width}}} 
-00021ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020  --------------  
-00021bb0: 2d2d 2d2d 2d22 2222 0a20 2020 2020 2020  -----""".       
-00021bc0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00021bd0: 2020 2020 2020 2020 2020 202e 666f 726d             .form
-00021be0: 6174 2863 6f6c 756d 6e5f 7769 6474 683d  at(column_width=
-00021bf0: 636f 6c75 6d6e 5f77 6964 7468 290a 2020  column_width).  
-00021c00: 2020 2020 2020 2020 2020 2020 2020 2e66                .f
-00021c10: 6f72 6d61 7428 636f 6c75 6d6e 3d22 436f  ormat(column="Co
-00021c20: 6c75 6d6e 222c 2075 6e64 6572 6c3d 222d  lumn", underl="-
-00021c30: 2d2d 2d2d 2d22 290a 2020 2020 2020 2020  -----").        
-00021c40: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00021c50: 2020 636f 6c75 6d6e 5f74 656d 706c 6174    column_templat
-00021c60: 6520 3d20 7465 7874 7772 6170 2e64 6564  e = textwrap.ded
-00021c70: 656e 7428 0a20 2020 2020 2020 2020 2020  ent(.           
-00021c80: 2020 2020 2022 2222 5c0a 2020 2020 2020       """\.      
-00021c90: 2020 2020 2020 7b7b 693a 5e33 7d7d 2020        {{i:^3}}  
-00021ca0: 7b7b 6e61 6d65 3a3c 7b63 6f6c 756d 6e5f  {{name:<{column_
-00021cb0: 7769 6474 687d 7d7d 207b 7b63 6f75 6e74  width}}} {{count
-00021cc0: 7d7d 206e 6f6e 2d6e 756c 6c20 2020 2020  }} non-null     
-00021cd0: 207b 7b64 7479 7065 7d7d 2222 222e 666f   {{dtype}}""".fo
-00021ce0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00021cf0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00021d00: 5f77 6964 7468 3d63 6f6c 756d 6e5f 7769  _width=column_wi
-00021d10: 6474 680a 2020 2020 2020 2020 2020 2020  dth.            
-00021d20: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00021d30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00021d40: 636f 6c75 6d6e 5f69 6e66 6f20 3d20 5b0a  column_info = [.
-00021d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d60: 636f 6c75 6d6e 5f74 656d 706c 6174 652e  column_template.
-00021d70: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
-00021d80: 2020 2020 2020 2020 2020 2020 693d 7070              i=pp
-00021d90: 7269 6e74 5f74 6869 6e67 2869 292c 0a20  rint_thing(i),. 
-00021da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021db0: 2020 206e 616d 653d 7070 7269 6e74 5f74     name=pprint_t
-00021dc0: 6869 6e67 286e 616d 6529 2c0a 2020 2020  hing(name),.    
-00021dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021de0: 636f 756e 743d 7070 7269 6e74 5f74 6869  count=pprint_thi
-00021df0: 6e67 2863 6f75 6e74 292c 0a20 2020 2020  ng(count),.     
-00021e00: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00021e10: 7479 7065 3d70 7072 696e 745f 7468 696e  type=pprint_thin
-00021e20: 6728 6474 7970 6529 2c0a 2020 2020 2020  g(dtype),.      
-00021e30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021e40: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00021e50: 692c 2028 6e61 6d65 2c20 636f 756e 742c  i, (name, count,
-00021e60: 2064 7479 7065 2920 696e 2065 6e75 6d65   dtype) in enume
-00021e70: 7261 7465 280a 2020 2020 2020 2020 2020  rate(.          
-00021e80: 2020 2020 2020 2020 2020 2320 4e4f 5445            # NOTE
-00021e90: 3a20 5573 6520 6063 6f75 6e74 732e 7661  : Use `counts.va
-00021ea0: 6c75 6573 6020 666f 7220 6375 6466 2073  lues` for cudf s
-00021eb0: 7570 706f 7274 0a20 2020 2020 2020 2020  upport.         
-00021ec0: 2020 2020 2020 2020 2020 207a 6970 2873             zip(s
-00021ed0: 656c 662e 636f 6c75 6d6e 732c 2063 6f75  elf.columns, cou
-00021ee0: 6e74 732e 7661 6c75 6573 2c20 7365 6c66  nts.values, self
-00021ef0: 2e64 7479 7065 7329 0a20 2020 2020 2020  .dtypes).       
-00021f00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00021f10: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00021f20: 2020 2020 206c 696e 6573 2e65 7874 656e       lines.exten
-00021f30: 6428 6865 6164 6572 2e73 706c 6974 2822  d(header.split("
-00021f40: 5c6e 2229 290a 2020 2020 2020 2020 656c  \n")).        el
-00021f50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00021f60: 636f 6c75 6d6e 5f69 6e66 6f20 3d20 5b69  column_info = [i
-00021f70: 6e64 6578 5f73 756d 6d61 7279 2873 656c  ndex_summary(sel
-00021f80: 662e 636f 6c75 6d6e 732c 206e 616d 653d  f.columns, name=
-00021f90: 2243 6f6c 756d 6e73 2229 5d0a 0a20 2020  "Columns")]..   
-00021fa0: 2020 2020 206c 696e 6573 2e65 7874 656e       lines.exten
-00021fb0: 6428 636f 6c75 6d6e 5f69 6e66 6f29 0a20  d(column_info). 
-00021fc0: 2020 2020 2020 2064 7479 7065 5f63 6f75         dtype_cou
-00021fd0: 6e74 7320 3d20 5b0a 2020 2020 2020 2020  nts = [.        
-00021fe0: 2020 2020 2225 7328 2564 2922 2025 206b      "%s(%d)" % k
-00021ff0: 2066 6f72 206b 2069 6e20 736f 7274 6564   for k in sorted
-00022000: 2873 656c 662e 6474 7970 6573 2e76 616c  (self.dtypes.val
-00022010: 7565 5f63 6f75 6e74 7328 292e 6974 656d  ue_counts().item
-00022020: 7328 292c 206b 6579 3d73 7472 290a 2020  s(), key=str).  
-00022030: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00022040: 6c69 6e65 732e 6170 7065 6e64 2822 6474  lines.append("dt
-00022050: 7970 6573 3a20 7b7d 222e 666f 726d 6174  ypes: {}".format
-00022060: 2822 2c20 222e 6a6f 696e 2864 7479 7065  (", ".join(dtype
-00022070: 5f63 6f75 6e74 7329 2929 0a0a 2020 2020  _counts)))..    
-00022080: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
-00022090: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
-000220a0: 206d 656d 6f72 795f 696e 7420 3d20 636f   memory_int = co
-000220b0: 6d70 7574 6174 696f 6e73 5b22 6d65 6d6f  mputations["memo
-000220c0: 7279 5f75 7361 6765 225d 2e73 756d 2829  ry_usage"].sum()
-000220d0: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-000220e0: 6573 2e61 7070 656e 6428 6622 6d65 6d6f  es.append(f"memo
-000220f0: 7279 2075 7361 6765 3a20 7b6d 656d 6f72  ry usage: {memor
-00022100: 795f 7265 7072 286d 656d 6f72 795f 696e  y_repr(memory_in
-00022110: 7429 7d5c 6e22 290a 0a20 2020 2020 2020  t)}\n")..       
-00022120: 2070 7574 5f6c 696e 6573 2862 7566 2c20   put_lines(buf, 
-00022130: 6c69 6e65 7329 0a0a 2020 2020 4064 6572  lines)..    @der
-00022140: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00022150: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00022160: 636f 7628 7365 6c66 2c20 6d69 6e5f 7065  cov(self, min_pe
-00022170: 7269 6f64 733d 4e6f 6e65 2c20 6e75 6d65  riods=None, nume
-00022180: 7269 635f 6f6e 6c79 3d46 616c 7365 2c20  ric_only=False, 
-00022190: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-000221a0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-000221b0: 726e 2073 656c 662e 5f63 6f76 286d 696e  rn self._cov(min
-000221c0: 5f70 6572 696f 6473 2c20 6e75 6d65 7269  _periods, numeri
-000221d0: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
-000221e0: 6572 7929 0a0a 2020 2020 4064 6572 6976  ery)..    @deriv
-000221f0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00022200: 7261 6d65 290a 2020 2020 6465 6620 636f  rame).    def co
-00022210: 7272 280a 2020 2020 2020 2020 7365 6c66  rr(.        self
-00022220: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
-00022230: 3d22 7065 6172 736f 6e22 2c0a 2020 2020  ="pearson",.    
-00022240: 2020 2020 6d69 6e5f 7065 7269 6f64 733d      min_periods=
-00022250: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e75  None,.        nu
-00022260: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-00022270: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
-00022280: 6576 6572 793d 4661 6c73 652c 0a20 2020  every=False,.   
-00022290: 2029 3a0a 2020 2020 2020 2020 7265 7475   ):.        retu
-000222a0: 726e 2073 656c 662e 5f63 6f72 7228 6d65  rn self._corr(me
-000222b0: 7468 6f64 2c20 6d69 6e5f 7065 7269 6f64  thod, min_period
-000222c0: 732c 206e 756d 6572 6963 5f6f 6e6c 792c  s, numeric_only,
-000222d0: 2073 706c 6974 5f65 7665 7279 290a 0a20   split_every).. 
-000222e0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000222f0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00022300: 2020 2064 6566 2074 6f5f 7374 7269 6e67     def to_string
-00022310: 2873 656c 662c 206d 6178 5f72 6f77 733d  (self, max_rows=
-00022320: 3529 3a0a 2020 2020 2020 2020 2320 6f70  5):.        # op
-00022330: 7469 6f6e 5f63 6f6e 7465 7874 2064 6f65  tion_context doe
-00022340: 736e 2774 2061 6666 6563 740a 2020 2020  sn't affect.    
-00022350: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00022360: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
-00022370: 7374 7269 6e67 286d 6178 5f72 6f77 733d  string(max_rows=
-00022380: 6d61 785f 726f 7773 2c20 7368 6f77 5f64  max_rows, show_d
-00022390: 696d 656e 7369 6f6e 733d 4661 6c73 6529  imensions=False)
-000223a0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000223b0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-000223c0: 290a 2020 2020 6465 6620 746f 5f68 746d  ).    def to_htm
-000223d0: 6c28 7365 6c66 2c20 6d61 785f 726f 7773  l(self, max_rows
-000223e0: 3d35 293a 0a20 2020 2020 2020 2023 2070  =5):.        # p
-000223f0: 642e 5365 7269 6573 2064 6f65 736e 2774  d.Series doesn't
-00022400: 2068 6176 6520 6874 6d6c 2072 6570 720a   have html repr.
-00022410: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
-00022420: 656c 662e 5f72 6570 725f 6461 7461 2829  elf._repr_data()
-00022430: 2e74 6f5f 6874 6d6c 286d 6178 5f72 6f77  .to_html(max_row
-00022440: 733d 6d61 785f 726f 7773 2c20 7368 6f77  s=max_rows, show
-00022450: 5f64 696d 656e 7369 6f6e 733d 4661 6c73  _dimensions=Fals
-00022460: 6529 0a20 2020 2020 2020 206e 5f65 7870  e).        n_exp
-00022470: 7220 3d20 6c65 6e28 7b65 2e5f 6e61 6d65  r = len({e._name
-00022480: 2066 6f72 2065 2069 6e20 7365 6c66 2e77   for e in self.w
-00022490: 616c 6b28 297d 290a 2020 2020 2020 2020  alk()}).        
-000224a0: 7265 7475 726e 2067 6574 5f74 656d 706c  return get_templ
-000224b0: 6174 6528 2264 6174 6166 7261 6d65 2e68  ate("dataframe.h
-000224c0: 746d 6c2e 6a32 2229 2e72 656e 6465 7228  tml.j2").render(
-000224d0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000224e0: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
-000224f0: 2020 2020 6e61 6d65 3d73 656c 662e 5f6e      name=self._n
-00022500: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00022510: 206c 6179 6572 733d 6d61 7962 655f 706c   layers=maybe_pl
-00022520: 7572 616c 697a 6528 6e5f 6578 7072 2c20  uralize(n_expr, 
-00022530: 2265 7870 7265 7373 696f 6e22 292c 0a20  "expression"),. 
-00022540: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00022550: 6620 5f72 6570 725f 6461 7461 2873 656c  f _repr_data(sel
-00022560: 6629 3a0a 2020 2020 2020 2020 6d65 7461  f):.        meta
-00022570: 203d 2073 656c 662e 5f6d 6574 610a 2020   = self._meta.  
-00022580: 2020 2020 2020 696e 6465 7820 3d20 7365        index = se
-00022590: 6c66 2e5f 7265 7072 5f64 6976 6973 696f  lf._repr_divisio
-000225a0: 6e73 0a20 2020 2020 2020 2063 6f6c 7320  ns.        cols 
-000225b0: 3d20 6d65 7461 2e63 6f6c 756d 6e73 0a20  = meta.columns. 
-000225c0: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
-000225d0: 6c73 2920 3d3d 2030 3a0a 2020 2020 2020  ls) == 0:.      
-000225e0: 2020 2020 2020 7365 7269 6573 5f64 6620        series_df 
-000225f0: 3d20 7064 2e44 6174 6146 7261 6d65 285b  = pd.DataFrame([
-00022600: 5b5d 5d20 2a20 6c65 6e28 696e 6465 7829  []] * len(index)
-00022610: 2c20 636f 6c75 6d6e 733d 636f 6c73 2c20  , columns=cols, 
-00022620: 696e 6465 783d 696e 6465 7829 0a20 2020  index=index).   
-00022630: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00022640: 2020 2020 2020 2073 6572 6965 735f 6466         series_df
-00022650: 203d 2070 642e 636f 6e63 6174 280a 2020   = pd.concat(.  
-00022660: 2020 2020 2020 2020 2020 2020 2020 5b5f                [_
-00022670: 7265 7072 5f64 6174 615f 7365 7269 6573  repr_data_series
-00022680: 2873 2c20 696e 6465 783d 696e 6465 7829  (s, index=index)
-00022690: 2066 6f72 205f 2c20 7320 696e 206d 6574   for _, s in met
-000226a0: 612e 6974 656d 7328 295d 2c20 6178 6973  a.items()], axis
-000226b0: 3d31 0a20 2020 2020 2020 2020 2020 2029  =1.            )
-000226c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000226d0: 7365 7269 6573 5f64 660a 0a0a 636c 6173  series_df...clas
-000226e0: 7320 5365 7269 6573 2846 7261 6d65 4261  s Series(FrameBa
-000226f0: 7365 293a 0a20 2020 2022 2222 5365 7269  se):.    """Seri
-00022700: 6573 2d6c 696b 6520 4578 7072 2043 6f6c  es-like Expr Col
-00022710: 6c65 6374 696f 6e22 2222 0a0a 2020 2020  lection"""..    
-00022720: 5f61 6363 6573 736f 7273 3a20 436c 6173  _accessors: Clas
-00022730: 7356 6172 5b73 6574 5b73 7472 5d5d 203d  sVar[set[str]] =
-00022740: 2073 6574 2829 0a20 2020 205f 7061 7274   set().    _part
-00022750: 6974 696f 6e5f 7479 7065 203d 2070 642e  ition_type = pd.
-00022760: 5365 7269 6573 0a0a 2020 2020 4070 726f  Series..    @pro
-00022770: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
-00022780: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
-00022790: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-000227a0: 6574 7572 6e20 6120 7475 706c 6520 7265  eturn a tuple re
-000227b0: 7072 6573 656e 7469 6e67 2074 6865 2064  presenting the d
-000227c0: 696d 656e 7369 6f6e 616c 6974 7920 6f66  imensionality of
-000227d0: 2074 6865 2044 6174 6146 7261 6d65 2e0a   the DataFrame..
-000227e0: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
-000227f0: 6265 7220 6f66 2072 6f77 7320 6973 2061  ber of rows is a
-00022800: 2044 656c 6179 6564 2072 6573 756c 742e   Delayed result.
-00022810: 2054 6865 206e 756d 6265 7220 6f66 2063   The number of c
-00022820: 6f6c 756d 6e73 0a20 2020 2020 2020 2069  olumns.        i
-00022830: 7320 6120 636f 6e63 7265 7465 2069 6e74  s a concrete int
-00022840: 6567 6572 2e0a 2020 2020 2020 2020 2222  eger..        ""
-00022850: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00022860: 2028 7365 6c66 2e73 697a 652c 290a 0a20   (self.size,).. 
-00022870: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00022880: 2064 6566 2061 7865 7328 7365 6c66 293a   def axes(self):
-00022890: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000228a0: 5b73 656c 662e 696e 6465 785d 0a0a 2020  [self.index]..  
-000228b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000228c0: 6465 6620 6e64 696d 2873 656c 6629 3a0a  def ndim(self):.
-000228d0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000228e0: 6e20 6469 6d65 6e73 696f 6e61 6c69 7479  n dimensionality
-000228f0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00022900: 726e 2031 0a0a 2020 2020 4070 726f 7065  rn 1..    @prope
-00022910: 7274 790a 2020 2020 6465 6620 5f65 6c65  rty.    def _ele
-00022920: 6d77 6973 6528 7365 6c66 293a 0a20 2020  mwise(self):.   
-00022930: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00022940: 7769 7365 0a0a 2020 2020 6465 6620 5f5f  wise..    def __
-00022950: 6469 725f 5f28 7365 6c66 293a 0a20 2020  dir__(self):.   
-00022960: 2020 2020 206f 203d 2073 6574 2864 6972       o = set(dir
-00022970: 2874 7970 6528 7365 6c66 2929 290a 2020  (type(self))).  
-00022980: 2020 2020 2020 6f2e 7570 6461 7465 2873        o.update(s
-00022990: 656c 662e 5f5f 6469 6374 5f5f 290a 2020  elf.__dict__).  
-000229a0: 2020 2020 2020 6f2e 7570 6461 7465 2873        o.update(s
-000229b0: 6574 2864 6972 2865 7870 722e 4578 7072  et(dir(expr.Expr
-000229c0: 2929 290a 2020 2020 2020 2020 666f 7220  ))).        for 
-000229d0: 6163 6365 7373 6f72 2069 6e20 5b22 6361  accessor in ["ca
-000229e0: 7422 2c20 2273 7472 225d 3a0a 2020 2020  t", "str"]:.    
-000229f0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
-00022a00: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
-00022a10: 612c 2061 6363 6573 736f 7229 3a0a 2020  a, accessor):.  
-00022a20: 2020 2020 2020 2020 2020 2020 2020 6f2e                o.
-00022a30: 7265 6d6f 7665 2861 6363 6573 736f 7229  remove(accessor)
-00022a40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00022a50: 6c69 7374 286f 290a 0a20 2020 2064 6566  list(o)..    def
-00022a60: 205f 5f63 6f6e 7461 696e 735f 5f28 7365   __contains__(se
-00022a70: 6c66 2c20 6974 656d 293a 0a20 2020 2020  lf, item):.     
-00022a80: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00022a90: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00022aa0: 2020 2020 2020 2020 2020 2255 7369 6e67            "Using
-00022ab0: 2027 696e 2720 746f 2074 6573 7420 666f   'in' to test fo
-00022ac0: 7220 6d65 6d62 6572 7368 6970 2069 7320  r membership is 
-00022ad0: 6e6f 7420 7375 7070 6f72 7465 642e 2055  not supported. U
-00022ae0: 7365 2074 6865 2076 616c 7565 7320 696e  se the values in
-00022af0: 7374 6561 6422 0a20 2020 2020 2020 2029  stead".        )
-00022b00: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00022b10: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00022b20: 2020 2064 6566 205f 5f69 7465 725f 5f28     def __iter__(
-00022b30: 7365 6c66 293a 0a20 2020 2020 2020 2066  self):.        f
-00022b40: 7261 6d65 203d 2073 656c 662e 6f70 7469  rame = self.opti
-00022b50: 6d69 7a65 2829 0a20 2020 2020 2020 2066  mize().        f
-00022b60: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
-00022b70: 6c66 2e6e 7061 7274 6974 696f 6e73 293a  lf.npartitions):
-00022b80: 0a20 2020 2020 2020 2020 2020 2073 203d  .            s =
-00022b90: 2066 7261 6d65 2e67 6574 5f70 6172 7469   frame.get_parti
-00022ba0: 7469 6f6e 2869 292e 636f 6d70 7574 6528  tion(i).compute(
-00022bb0: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
-00022bc0: 656c 6420 6672 6f6d 2073 0a0a 2020 2020  eld from s..    
-00022bd0: 6465 6620 5f5f 6765 7469 7465 6d5f 5f28  def __getitem__(
-00022be0: 7365 6c66 2c20 6b65 7929 3a0a 2020 2020  self, key):.    
-00022bf0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00022c00: 6528 6b65 792c 2053 6572 6965 7329 206f  e(key, Series) o
-00022c10: 7220 7365 6c66 2e6e 7061 7274 6974 696f  r self.npartitio
-00022c20: 6e73 203d 3d20 313a 0a20 2020 2020 2020  ns == 1:.       
-00022c30: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00022c40: 7228 292e 5f5f 6765 7469 7465 6d5f 5f28  r().__getitem__(
-00022c50: 6b65 7929 0a20 2020 2020 2020 2072 6574  key).        ret
-00022c60: 7572 6e20 7365 6c66 2e6c 6f63 5b6b 6579  urn self.loc[key
-00022c70: 5d0a 0a20 2020 2040 7072 6f70 6572 7479  ]..    @property
-00022c80: 0a20 2020 2064 6566 206e 616d 6528 7365  .    def name(se
-00022c90: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00022ca0: 7572 6e20 7365 6c66 2e65 7870 722e 5f6d  urn self.expr._m
-00022cb0: 6574 612e 6e61 6d65 0a0a 2020 2020 406e  eta.name..    @n
-00022cc0: 616d 652e 7365 7474 6572 0a20 2020 2064  ame.setter.    d
-00022cd0: 6566 206e 616d 6528 7365 6c66 2c20 6e61  ef name(self, na
-00022ce0: 6d65 293a 0a20 2020 2020 2020 2073 656c  me):.        sel
-00022cf0: 662e 5f65 7870 7220 3d20 7365 6c66 2e72  f._expr = self.r
-00022d00: 656e 616d 6528 696e 6465 783d 6e61 6d65  ename(index=name
-00022d10: 292e 5f65 7870 720a 0a20 2020 2040 7072  )._expr..    @pr
-00022d20: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
-00022d30: 7479 7065 2873 656c 6629 3a0a 2020 2020  type(self):.    
-00022d40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00022d50: 6578 7072 2e5f 6d65 7461 2e64 7479 7065  expr._meta.dtype
-00022d60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00022d70: 2020 2020 6465 6620 6e62 7974 6573 2873      def nbytes(s
-00022d80: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00022d90: 224e 756d 6265 7220 6f66 2062 7974 6573  "Number of bytes
-00022da0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00022db0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00022dc0: 6e28 7365 6c66 2e65 7870 722e 6e62 7974  n(self.expr.nbyt
-00022dd0: 6573 290a 0a20 2020 2064 6566 205f 5f61  es)..    def __a
-00022de0: 7272 6179 5f75 6675 6e63 5f5f 2873 656c  rray_ufunc__(sel
-00022df0: 662c 206e 756d 7079 5f75 6675 6e63 2c20  f, numpy_ufunc, 
-00022e00: 6d65 7468 6f64 2c20 2a69 6e70 7574 732c  method, *inputs,
-00022e10: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00022e20: 2020 2020 6f75 7420 3d20 6b77 6172 6773      out = kwargs
-00022e30: 2e67 6574 2822 6f75 7422 2c20 2829 290a  .get("out", ()).
-00022e40: 2020 2020 2020 2020 666f 7220 7820 696e          for x in
-00022e50: 2069 6e70 7574 7320 2b20 6f75 743a 0a20   inputs + out:. 
-00022e60: 2020 2020 2020 2020 2020 2023 2075 6675             # ufu
-00022e70: 6e63 7320 776f 726b 2077 6974 6820 302d  ncs work with 0-
-00022e80: 6469 6d65 6e73 696f 6e61 6c20 4e75 6d50  dimensional NumP
-00022e90: 7920 6e64 6172 7261 7973 0a20 2020 2020  y ndarrays.     
-00022ea0: 2020 2020 2020 2023 2073 6f20 7765 2064         # so we d
-00022eb0: 6f6e 2774 2077 616e 7420 746f 2072 6169  on't want to rai
-00022ec0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00022ed0: 640a 2020 2020 2020 2020 2020 2020 6966  d.            if
-00022ee0: 2069 7369 6e73 7461 6e63 6528 782c 206e   isinstance(x, n
-00022ef0: 702e 6e64 6172 7261 7929 2061 6e64 2078  p.ndarray) and x
-00022f00: 2e73 6861 7065 203d 3d20 2829 3a0a 2020  .shape == ():.  
-00022f10: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00022f20: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
-00022f30: 2020 2065 6c69 6620 6e6f 7420 6973 696e     elif not isin
-00022f40: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
-00022f50: 2020 2020 2020 2020 782c 2028 4e75 6d62          x, (Numb
-00022f60: 6572 2c20 5363 616c 6172 2c20 4672 616d  er, Scalar, Fram
-00022f70: 6542 6173 652c 2041 7272 6179 2c20 7064  eBase, Array, pd
-00022f80: 2e44 6174 6146 7261 6d65 2c20 7064 2e53  .DataFrame, pd.S
-00022f90: 6572 6965 732c 2070 642e 496e 6465 7829  eries, pd.Index)
-00022fa0: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
-00022fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fc0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
-00022fd0: 656e 7465 640a 0a20 2020 2020 2020 2069  ented..        i
-00022fe0: 6620 6d65 7468 6f64 203d 3d20 225f 5f63  f method == "__c
-00022ff0: 616c 6c5f 5f22 3a0a 2020 2020 2020 2020  all__":.        
-00023000: 2020 2020 6966 206e 756d 7079 5f75 6675      if numpy_ufu
-00023010: 6e63 2e73 6967 6e61 7475 7265 2069 7320  nc.signature is 
-00023020: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00023030: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00023040: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
-00023050: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00023060: 756d 7079 5f75 6675 6e63 2e6e 6f75 7420  umpy_ufunc.nout 
-00023070: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
-00023080: 2020 2020 2023 2075 6675 6e63 7320 7769       # ufuncs wi
-00023090: 7468 206d 756c 7469 706c 6520 6f75 7470  th multiple outp
-000230a0: 7574 2076 616c 7565 730a 2020 2020 2020  ut values.      
-000230b0: 2020 2020 2020 2020 2020 2320 6172 6520            # are 
-000230c0: 6e6f 7420 7965 7420 7375 7070 6f72 7465  not yet supporte
-000230d0: 6420 666f 7220 6672 616d 6573 0a20 2020  d for frames.   
-000230e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000230f0: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-00023100: 6564 0a20 2020 2020 2020 2020 2020 2065  ed.            e
-00023110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00023120: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00023130: 7769 7365 286e 756d 7079 5f75 6675 6e63  wise(numpy_ufunc
-00023140: 2c20 2a69 6e70 7574 732c 202a 2a6b 7761  , *inputs, **kwa
-00023150: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
-00023160: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-00023170: 2075 6675 6e63 206d 6574 686f 6473 2061   ufunc methods a
-00023180: 7265 206e 6f74 2079 6574 2073 7570 706f  re not yet suppo
-00023190: 7274 6564 2066 6f72 2066 7261 6d65 730a  rted for frames.
-000231a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000231b0: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
-000231c0: 640a 0a20 2020 2064 6566 205f 5f61 7272  d..    def __arr
-000231d0: 6179 5f77 7261 705f 5f28 7365 6c66 2c20  ay_wrap__(self, 
-000231e0: 6172 7261 792c 2063 6f6e 7465 7874 3d4e  array, context=N
-000231f0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-00023200: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
-00023210: 6578 742c 2074 7570 6c65 2920 616e 6420  ext, tuple) and 
-00023220: 6c65 6e28 636f 6e74 6578 7429 203e 2030  len(context) > 0
-00023230: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00023240: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
-00023250: 6578 745b 315d 5b30 5d2c 206e 702e 6e64  ext[1][0], np.nd
-00023260: 6172 7261 7929 2061 6e64 2063 6f6e 7465  array) and conte
-00023270: 7874 5b31 5d5b 305d 2e73 6861 7065 203d  xt[1][0].shape =
-00023280: 3d20 2829 3a0a 2020 2020 2020 2020 2020  = ():.          
-00023290: 2020 2020 2020 696e 6465 7820 3d20 4e6f        index = No
-000232a0: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
-000232b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000232c0: 2020 2020 2069 6e64 6578 203d 2063 6f6e       index = con
-000232d0: 7465 7874 5b31 5d5b 305d 2e69 6e64 6578  text[1][0].index
-000232e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000232f0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00023300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023310: 696d 706f 7274 2069 6e73 7065 6374 0a0a  import inspect..
-00023320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023330: 6d65 7468 6f64 5f6e 616d 6520 3d20 6622  method_name = f"
-00023340: 607b 696e 7370 6563 742e 7374 6163 6b28  `{inspect.stack(
-00023350: 295b 335d 5b33 5d7d 6022 0a20 2020 2020  )[3][3]}`".     
-00023360: 2020 2020 2020 2065 7863 6570 7420 496e         except In
-00023370: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
-00023380: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00023390: 5f6e 616d 6520 3d20 2254 6869 7320 6d65  _name = "This me
-000233a0: 7468 6f64 220a 2020 2020 2020 2020 2020  thod".          
-000233b0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-000233c0: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-000233d0: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-000233e0: 6d65 7468 6f64 5f6e 616d 657d 2069 7320  method_name} is 
-000233f0: 6e6f 7420 696d 706c 656d 656e 7465 6420  not implemented 
-00023400: 666f 7220 6064 6173 6b2e 6461 7461 6672  for `dask.datafr
-00023410: 616d 652e 5365 7269 6573 602e 220a 2020  ame.Series`.".  
-00023420: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00023430: 2020 2020 2072 6574 7572 6e20 6d65 7461       return meta
-00023440: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
-00023450: 746f 7228 7365 6c66 2928 6172 7261 792c  tor(self)(array,
-00023460: 2069 6e64 6578 3d69 6e64 6578 2c20 6e61   index=index, na
-00023470: 6d65 3d73 656c 662e 6e61 6d65 290a 0a20  me=self.name).. 
-00023480: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00023490: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-000234a0: 6465 6620 6d61 7028 7365 6c66 2c20 6172  def map(self, ar
-000234b0: 672c 206e 615f 6163 7469 6f6e 3d4e 6f6e  g, na_action=Non
-000234c0: 652c 206d 6574 613d 4e6f 6e65 293a 0a20  e, meta=None):. 
-000234d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000234e0: 616e 6365 2861 7267 2c20 5365 7269 6573  ance(arg, Series
-000234f0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00023500: 6620 6e6f 7420 6578 7072 2e61 7265 5f63  f not expr.are_c
-00023510: 6f5f 616c 6967 6e65 6428 7365 6c66 2e65  o_aligned(self.e
-00023520: 7870 722c 2061 7267 2e65 7870 7229 3a0a  xpr, arg.expr):.
-00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023540: 6966 206d 6574 6120 6973 204e 6f6e 653a  if meta is None:
-00023550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023560: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00023570: 726e 286d 6574 615f 7761 726e 696e 6728  rn(meta_warning(
-00023580: 6d65 7461 2929 0a20 2020 2020 2020 2020  meta)).         
-00023590: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000235a0: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-000235b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235c0: 2020 6578 7072 2e4d 6170 416c 6967 6e28    expr.MapAlign(
-000235d0: 7365 6c66 2c20 6172 672c 206f 703d 4e6f  self, arg, op=No
-000235e0: 6e65 2c20 6e61 5f61 6374 696f 6e3d 6e61  ne, na_action=na
-000235f0: 5f61 6374 696f 6e2c 206d 6574 613d 6d65  _action, meta=me
-00023600: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-00023610: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-00023620: 206d 6574 6120 6973 204e 6f6e 653a 0a20   meta is None:. 
-00023630: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
-00023640: 3d20 6578 7072 2e5f 656d 756c 6174 6528  = expr._emulate(
-00023650: 4d2e 6d61 702c 2073 656c 662c 2061 7267  M.map, self, arg
-00023660: 2c20 6e61 5f61 6374 696f 6e3d 6e61 5f61  , na_action=na_a
-00023670: 6374 696f 6e2c 2075 6466 3d54 7275 6529  ction, udf=True)
-00023680: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00023690: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
-000236a0: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
-000236b0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000236c0: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
-000236d0: 722e 4d61 7028 7365 6c66 2c20 6172 673d  r.Map(self, arg=
-000236e0: 6172 672c 206e 615f 6163 7469 6f6e 3d6e  arg, na_action=n
-000236f0: 615f 6163 7469 6f6e 2c20 6d65 7461 3d6d  a_action, meta=m
-00023700: 6574 6129 290a 0a20 2020 2040 6465 7269  eta))..    @deri
-00023710: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00023720: 6573 290a 2020 2020 6465 6620 636c 6970  es).    def clip
-00023730: 2873 656c 662c 206c 6f77 6572 3d4e 6f6e  (self, lower=Non
-00023740: 652c 2075 7070 6572 3d4e 6f6e 652c 2061  e, upper=None, a
-00023750: 7869 733d 4e6f 6e65 2c20 2a2a 6b77 6172  xis=None, **kwar
-00023760: 6773 293a 0a20 2020 2020 2020 2061 7869  gs):.        axi
-00023770: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-00023780: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
-00023790: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-000237a0: 5f63 6f6c 6c65 6374 696f 6e28 7365 6c66  _collection(self
-000237b0: 2e65 7870 722e 636c 6970 286c 6f77 6572  .expr.clip(lower
-000237c0: 2c20 7570 7065 722c 2061 7869 7329 290a  , upper, axis)).
-000237d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000237e0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-000237f0: 2020 6465 6620 746f 5f66 7261 6d65 2873    def to_frame(s
-00023800: 656c 662c 206e 616d 653d 6e6f 5f64 6566  elf, name=no_def
-00023810: 6175 6c74 293a 0a20 2020 2020 2020 2072  ault):.        r
-00023820: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00023830: 7469 6f6e 2865 7870 722e 546f 4672 616d  tion(expr.ToFram
-00023840: 6528 7365 6c66 2c20 6e61 6d65 3d6e 616d  e(self, name=nam
-00023850: 6529 290a 0a20 2020 2064 6566 205f 636f  e))..    def _co
-00023860: 6d70 6172 6973 6f6e 5f6f 7028 7365 6c66  mparison_op(self
-00023870: 2c20 6578 7072 5f63 6c73 2c20 6f74 6865  , expr_cls, othe
-00023880: 722c 206c 6576 656c 2c20 6669 6c6c 5f76  r, level, fill_v
-00023890: 616c 7565 2c20 6178 6973 293a 0a20 2020  alue, axis):.   
-000238a0: 2020 2020 2069 6620 6c65 7665 6c20 6973       if level is
-000238b0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-000238c0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-000238d0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-000238e0: 2822 6c65 7665 6c20 6d75 7374 2062 6520  ("level must be 
-000238f0: 4e6f 6e65 2229 0a20 2020 2020 2020 2073  None").        s
-00023900: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00023910: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00023920: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00023930: 6563 7469 6f6e 2865 7870 725f 636c 7328  ection(expr_cls(
-00023940: 7365 6c66 2c20 6f74 6865 722c 2066 696c  self, other, fil
-00023950: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
-00023960: 7565 2929 0a0a 2020 2020 6465 6620 6c74  ue))..    def lt
-00023970: 2873 656c 662c 206f 7468 6572 2c20 6c65  (self, other, le
-00023980: 7665 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76  vel=None, fill_v
-00023990: 616c 7565 3d4e 6f6e 652c 2061 7869 733d  alue=None, axis=
-000239a0: 3029 3a0a 2020 2020 2020 2020 7265 7475  0):.        retu
-000239b0: 726e 2073 656c 662e 5f63 6f6d 7061 7269  rn self._compari
-000239c0: 736f 6e5f 6f70 2865 7870 722e 4c54 5365  son_op(expr.LTSe
-000239d0: 7269 6573 2c20 6f74 6865 722c 206c 6576  ries, other, lev
-000239e0: 656c 2c20 6669 6c6c 5f76 616c 7565 2c20  el, fill_value, 
-000239f0: 6178 6973 290a 0a20 2020 2064 6566 206c  axis)..    def l
-00023a00: 6528 7365 6c66 2c20 6f74 6865 722c 206c  e(self, other, l
-00023a10: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
-00023a20: 7661 6c75 653d 4e6f 6e65 2c20 6178 6973  value=None, axis
-00023a30: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
-00023a40: 7572 6e20 7365 6c66 2e5f 636f 6d70 6172  urn self._compar
-00023a50: 6973 6f6e 5f6f 7028 6578 7072 2e4c 4553  ison_op(expr.LES
-00023a60: 6572 6965 732c 206f 7468 6572 2c20 6c65  eries, other, le
-00023a70: 7665 6c2c 2066 696c 6c5f 7661 6c75 652c  vel, fill_value,
-00023a80: 2061 7869 7329 0a0a 2020 2020 6465 6620   axis)..    def 
-00023a90: 6774 2873 656c 662c 206f 7468 6572 2c20  gt(self, other, 
-00023aa0: 6c65 7665 6c3d 4e6f 6e65 2c20 6669 6c6c  level=None, fill
-00023ab0: 5f76 616c 7565 3d4e 6f6e 652c 2061 7869  _value=None, axi
-00023ac0: 733d 3029 3a0a 2020 2020 2020 2020 7265  s=0):.        re
-00023ad0: 7475 726e 2073 656c 662e 5f63 6f6d 7061  turn self._compa
-00023ae0: 7269 736f 6e5f 6f70 2865 7870 722e 4754  rison_op(expr.GT
-00023af0: 5365 7269 6573 2c20 6f74 6865 722c 206c  Series, other, l
-00023b00: 6576 656c 2c20 6669 6c6c 5f76 616c 7565  evel, fill_value
-00023b10: 2c20 6178 6973 290a 0a20 2020 2064 6566  , axis)..    def
-00023b20: 2067 6528 7365 6c66 2c20 6f74 6865 722c   ge(self, other,
-00023b30: 206c 6576 656c 3d4e 6f6e 652c 2066 696c   level=None, fil
-00023b40: 6c5f 7661 6c75 653d 4e6f 6e65 2c20 6178  l_value=None, ax
-00023b50: 6973 3d30 293a 0a20 2020 2020 2020 2072  is=0):.        r
-00023b60: 6574 7572 6e20 7365 6c66 2e5f 636f 6d70  eturn self._comp
-00023b70: 6172 6973 6f6e 5f6f 7028 6578 7072 2e47  arison_op(expr.G
-00023b80: 4553 6572 6965 732c 206f 7468 6572 2c20  ESeries, other, 
-00023b90: 6c65 7665 6c2c 2066 696c 6c5f 7661 6c75  level, fill_valu
-00023ba0: 652c 2061 7869 7329 0a0a 2020 2020 6465  e, axis)..    de
-00023bb0: 6620 6e65 2873 656c 662c 206f 7468 6572  f ne(self, other
-00023bc0: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6669  , level=None, fi
-00023bd0: 6c6c 5f76 616c 7565 3d4e 6f6e 652c 2061  ll_value=None, a
-00023be0: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
-00023bf0: 7265 7475 726e 2073 656c 662e 5f63 6f6d  return self._com
-00023c00: 7061 7269 736f 6e5f 6f70 2865 7870 722e  parison_op(expr.
-00023c10: 4e45 5365 7269 6573 2c20 6f74 6865 722c  NESeries, other,
-00023c20: 206c 6576 656c 2c20 6669 6c6c 5f76 616c   level, fill_val
-00023c30: 7565 2c20 6178 6973 290a 0a20 2020 2064  ue, axis)..    d
-00023c40: 6566 2065 7128 7365 6c66 2c20 6f74 6865  ef eq(self, othe
-00023c50: 722c 206c 6576 656c 3d4e 6f6e 652c 2066  r, level=None, f
-00023c60: 696c 6c5f 7661 6c75 653d 4e6f 6e65 2c20  ill_value=None, 
-00023c70: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
-00023c80: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
-00023c90: 6d70 6172 6973 6f6e 5f6f 7028 6578 7072  mparison_op(expr
-00023ca0: 2e45 5153 6572 6965 732c 206f 7468 6572  .EQSeries, other
-00023cb0: 2c20 6c65 7665 6c2c 2066 696c 6c5f 7661  , level, fill_va
-00023cc0: 6c75 652c 2061 7869 7329 0a0a 2020 2020  lue, axis)..    
-00023cd0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00023ce0: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00023cf0: 2076 616c 7565 5f63 6f75 6e74 7328 0a20   value_counts(. 
-00023d00: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00023d10: 2020 2020 2073 6f72 743d 4e6f 6e65 2c0a       sort=None,.
-00023d20: 2020 2020 2020 2020 6173 6365 6e64 696e          ascendin
-00023d30: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
-00023d40: 2064 726f 706e 613d 5472 7565 2c0a 2020   dropna=True,.  
-00023d50: 2020 2020 2020 6e6f 726d 616c 697a 653d        normalize=
-00023d60: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
-00023d70: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
-00023d80: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
-00023d90: 7574 3d6e 6f5f 6465 6661 756c 742c 0a20  ut=no_default,. 
-00023da0: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-00023db0: 2073 706c 6974 5f6f 7574 2069 7320 6e6f   split_out is no
-00023dc0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-00023dd0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00023de0: 6e63 6528 7365 6c66 2e64 7479 7065 2c20  nce(self.dtype, 
-00023df0: 4361 7465 676f 7269 6361 6c44 7479 7065  CategoricalDtype
-00023e00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00023e10: 2020 2023 2075 6e6f 6273 6572 7665 6420     # unobserved 
-00023e20: 6361 7465 676f 7269 6573 2061 7265 2061  categories are a
-00023e30: 2070 6169 6e0a 2020 2020 2020 2020 2020   pain.          
-00023e40: 2020 2020 2020 7370 6c69 745f 6f75 7420        split_out 
-00023e50: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00023e60: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00023e70: 2020 2020 2020 7370 6c69 745f 6f75 7420        split_out 
-00023e80: 3d20 5472 7565 0a20 2020 2020 2020 2069  = True.        i
-00023e90: 6620 7370 6c69 745f 6f75 7420 3d3d 2031  f split_out == 1
-00023ea0: 2061 6e64 2073 706c 6974 5f6f 7574 2069   and split_out i
-00023eb0: 7320 6e6f 7420 5472 7565 2061 6e64 2073  s not True and s
-00023ec0: 6f72 7420 6973 204e 6f6e 653a 0a20 2020  ort is None:.   
-00023ed0: 2020 2020 2020 2020 2073 6f72 7420 3d20           sort = 
-00023ee0: 5472 7565 0a0a 2020 2020 2020 2020 6c65  True..        le
-00023ef0: 6e67 7468 203d 204e 6f6e 650a 2020 2020  ngth = None.    
-00023f00: 2020 2020 6966 2028 7370 6c69 745f 6f75      if (split_ou
-00023f10: 7420 3e20 3120 6f72 2073 706c 6974 5f6f  t > 1 or split_o
-00023f20: 7574 2069 7320 5472 7565 2920 616e 6420  ut is True) and 
-00023f30: 6e6f 726d 616c 697a 653a 0a20 2020 2020  normalize:.     
-00023f40: 2020 2020 2020 2066 7261 6d65 203d 2073         frame = s
-00023f50: 656c 6620 6966 206e 6f74 2064 726f 706e  elf if not dropn
-00023f60: 6120 656c 7365 2073 656c 662e 6472 6f70  a else self.drop
-00023f70: 6e61 2829 0a20 2020 2020 2020 2020 2020  na().           
-00023f80: 206c 656e 6774 6820 3d20 4c65 6e28 6672   length = Len(fr
-00023f90: 616d 6529 0a0a 2020 2020 2020 2020 7265  ame)..        re
-00023fa0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00023fb0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00023fc0: 2056 616c 7565 436f 756e 7473 280a 2020   ValueCounts(.  
-00023fd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00023fe0: 6c66 2c20 736f 7274 2c20 6173 6365 6e64  lf, sort, ascend
-00023ff0: 696e 672c 2064 726f 706e 612c 206e 6f72  ing, dropna, nor
-00024000: 6d61 6c69 7a65 2c20 7370 6c69 745f 6576  malize, split_ev
-00024010: 6572 792c 2073 706c 6974 5f6f 7574 2c20  ery, split_out, 
-00024020: 6c65 6e67 7468 0a20 2020 2020 2020 2020  length.         
-00024030: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
-00024040: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00024050: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00024060: 2064 6566 206d 6f64 6528 7365 6c66 2c20   def mode(self, 
-00024070: 6472 6f70 6e61 3d54 7275 652c 2073 706c  dropna=True, spl
-00024080: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
-00024090: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000240a0: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
-000240b0: 656c 662e 6578 7072 2e6d 6f64 6528 6472  elf.expr.mode(dr
-000240c0: 6f70 6e61 2c20 7370 6c69 745f 6576 6572  opna, split_ever
-000240d0: 7929 290a 0a20 2020 2040 6465 7269 7665  y))..    @derive
-000240e0: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-000240f0: 290a 2020 2020 6465 6620 6e6c 6172 6765  ).    def nlarge
-00024100: 7374 2873 656c 662c 206e 3d35 2c20 7370  st(self, n=5, sp
-00024110: 6c69 745f 6576 6572 793d 4e6f 6e65 293a  lit_every=None):
-00024120: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00024130: 6e65 775f 636f 6c6c 6563 7469 6f6e 284e  new_collection(N
-00024140: 4c61 7267 6573 7428 7365 6c66 2c20 6e3d  Largest(self, n=
-00024150: 6e2c 2073 706c 6974 5f65 7665 7279 3d73  n, split_every=s
-00024160: 706c 6974 5f65 7665 7279 2929 0a0a 2020  plit_every))..  
-00024170: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00024180: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00024190: 6566 206e 736d 616c 6c65 7374 2873 656c  ef nsmallest(sel
-000241a0: 662c 206e 3d35 2c20 7370 6c69 745f 6576  f, n=5, split_ev
-000241b0: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
-000241c0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-000241d0: 6c6c 6563 7469 6f6e 284e 536d 616c 6c65  llection(NSmalle
-000241e0: 7374 2873 656c 662c 206e 3d6e 2c20 7370  st(self, n=n, sp
-000241f0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00024200: 6576 6572 7929 290a 0a20 2020 2040 6465  every))..    @de
-00024210: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00024220: 7269 6573 290a 2020 2020 6465 6620 6d65  ries).    def me
-00024230: 6d6f 7279 5f75 7361 6765 2873 656c 662c  mory_usage(self,
-00024240: 2064 6565 703d 4661 6c73 652c 2069 6e64   deep=False, ind
-00024250: 6578 3d54 7275 6529 3a0a 2020 2020 2020  ex=True):.      
-00024260: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-00024270: 6c65 6374 696f 6e28 4d65 6d6f 7279 5573  lection(MemoryUs
-00024280: 6167 6546 7261 6d65 2873 656c 662c 2064  ageFrame(self, d
-00024290: 6565 703d 6465 6570 2c20 5f69 6e64 6578  eep=deep, _index
-000242a0: 3d69 6e64 6578 2929 0a0a 2020 2020 6465  =index))..    de
-000242b0: 6620 756e 6971 7565 2873 656c 662c 2073  f unique(self, s
-000242c0: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
-000242d0: 2073 706c 6974 5f6f 7574 3d54 7275 652c   split_out=True,
-000242e0: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
-000242f0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00024300: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
-00024310: 6e20 5365 7269 6573 206f 6620 756e 6971  n Series of uniq
-00024320: 7565 2076 616c 7565 7320 696e 2074 6865  ue values in the
-00024330: 206f 626a 6563 742e 2049 6e63 6c75 6465   object. Include
-00024340: 7320 4e41 2076 616c 7565 732e 0a0a 2020  s NA values...  
-00024350: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00024360: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00024370: 2020 2020 2020 756e 6971 7565 7320 3a20        uniques : 
-00024380: 5365 7269 6573 0a20 2020 2020 2020 2022  Series.        "
-00024390: 2222 0a20 2020 2020 2020 2073 6875 6666  "".        shuff
-000243a0: 6c65 5f6d 6574 686f 6420 3d20 5f67 6574  le_method = _get
-000243b0: 5f73 6875 6666 6c65 5f70 7265 6665 7272  _shuffle_preferr
-000243c0: 696e 675f 6f72 6465 7228 7368 7566 666c  ing_order(shuffl
-000243d0: 655f 6d65 7468 6f64 290a 2020 2020 2020  e_method).      
-000243e0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-000243f0: 6c65 6374 696f 6e28 556e 6971 7565 2873  lection(Unique(s
-00024400: 656c 662c 2073 706c 6974 5f65 7665 7279  elf, split_every
-00024410: 2c20 7370 6c69 745f 6f75 742c 2073 6875  , split_out, shu
-00024420: 6666 6c65 5f6d 6574 686f 6429 290a 0a20  ffle_method)).. 
-00024430: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00024440: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-00024450: 6465 6620 6e75 6e69 7175 6528 7365 6c66  def nunique(self
-00024460: 2c20 6472 6f70 6e61 3d54 7275 652c 2073  , dropna=True, s
-00024470: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00024480: 2c20 7370 6c69 745f 6f75 743d 5472 7565  , split_out=True
-00024490: 293a 0a20 2020 2020 2020 2075 6e69 7173  ):.        uniqs
-000244a0: 203d 2073 656c 662e 6472 6f70 5f64 7570   = self.drop_dup
-000244b0: 6c69 6361 7465 7328 7370 6c69 745f 6576  licates(split_ev
-000244c0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-000244d0: 2073 706c 6974 5f6f 7574 3d73 706c 6974   split_out=split
-000244e0: 5f6f 7574 290a 2020 2020 2020 2020 6966  _out).        if
-000244f0: 2064 726f 706e 613a 0a20 2020 2020 2020   dropna:.       
-00024500: 2020 2020 2023 2063 6f75 6e74 206d 696d       # count mim
-00024510: 6963 7320 7061 6e64 6173 2062 6568 6176  ics pandas behav
-00024520: 696f 7220 616e 6420 6578 636c 7564 6573  ior and excludes
-00024530: 204e 4120 7661 6c75 6573 0a20 2020 2020   NA values.     
-00024540: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00024550: 616e 6365 2875 6e69 7173 2c20 496e 6465  ance(uniqs, Inde
-00024560: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-00024570: 2020 2020 756e 6971 7320 3d20 756e 6971      uniqs = uniq
-00024580: 732e 746f 5f73 6572 6965 7328 290a 2020  s.to_series().  
-00024590: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000245a0: 2075 6e69 7173 2e63 6f75 6e74 2829 0a20   uniqs.count(). 
-000245b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000245c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000245d0: 756e 6971 732e 7369 7a65 0a0a 2020 2020  uniqs.size..    
-000245e0: 6465 6620 6472 6f70 5f64 7570 6c69 6361  def drop_duplica
-000245f0: 7465 7328 0a20 2020 2020 2020 2073 656c  tes(.        sel
-00024600: 662c 0a20 2020 2020 2020 2069 676e 6f72  f,.        ignor
-00024610: 655f 696e 6465 783d 4661 6c73 652c 0a20  e_index=False,. 
-00024620: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00024630: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
-00024640: 2073 706c 6974 5f6f 7574 3d54 7275 652c   split_out=True,
-00024650: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
-00024660: 5f6d 6574 686f 643d 4e6f 6e65 2c0a 2020  _method=None,.  
-00024670: 2020 2020 2020 6b65 6570 3d22 6669 7273        keep="firs
-00024680: 7422 2c0a 2020 2020 293a 0a20 2020 2020  t",.    ):.     
-00024690: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
-000246a0: 6420 3d20 5f67 6574 5f73 6875 6666 6c65  d = _get_shuffle
-000246b0: 5f70 7265 6665 7272 696e 675f 6f72 6465  _preferring_orde
-000246c0: 7228 7368 7566 666c 655f 6d65 7468 6f64  r(shuffle_method
-000246d0: 290a 2020 2020 2020 2020 6966 206b 6565  ).        if kee
-000246e0: 7020 6973 2046 616c 7365 3a0a 2020 2020  p is False:.    
-000246f0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00024700: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00024710: 7228 2264 726f 705f 6475 706c 6963 6174  r("drop_duplicat
-00024720: 6573 2077 6974 6820 6b65 6570 3d46 616c  es with keep=Fal
-00024730: 7365 2229 0a20 2020 2020 2020 2072 6574  se").        ret
-00024740: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-00024750: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00024760: 4472 6f70 4475 706c 6963 6174 6573 280a  DropDuplicates(.
-00024770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024780: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00024790: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
-000247a0: 6578 3d69 676e 6f72 655f 696e 6465 782c  ex=ignore_index,
-000247b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000247c0: 2073 706c 6974 5f6f 7574 3d73 706c 6974   split_out=split
-000247d0: 5f6f 7574 2c0a 2020 2020 2020 2020 2020  _out,.          
-000247e0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-000247f0: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-00024800: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00024810: 6875 6666 6c65 5f6d 6574 686f 643d 7368  huffle_method=sh
-00024820: 7566 666c 655f 6d65 7468 6f64 2c0a 2020  uffle_method,.  
-00024830: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-00024840: 6570 3d6b 6565 702c 0a20 2020 2020 2020  ep=keep,.       
-00024850: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00024860: 0a0a 2020 2020 4069 6e73 6572 745f 6d65  ..    @insert_me
-00024870: 7461 5f70 6172 616d 5f64 6573 6372 6970  ta_param_descrip
-00024880: 7469 6f6e 2870 6164 3d31 3229 0a20 2020  tion(pad=12).   
-00024890: 2064 6566 2061 7070 6c79 2873 656c 662c   def apply(self,
-000248a0: 2066 756e 6374 696f 6e2c 202a 6172 6773   function, *args
-000248b0: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
-000248c0: 742c 2061 7869 733d 302c 202a 2a6b 7761  t, axis=0, **kwa
-000248d0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-000248e0: 2250 6172 616c 6c65 6c20 7665 7273 696f  "Parallel versio
-000248f0: 6e20 6f66 2070 616e 6461 732e 5365 7269  n of pandas.Seri
-00024900: 6573 2e61 7070 6c79 0a0a 2020 2020 2020  es.apply..      
-00024910: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00024920: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00024930: 2020 2020 2020 2020 6675 6e63 203a 2066          func : f
-00024940: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-00024950: 2020 2020 4675 6e63 7469 6f6e 2074 6f20      Function to 
-00024960: 6170 706c 790a 2020 2020 2020 2020 244d  apply.        $M
-00024970: 4554 410a 2020 2020 2020 2020 6172 6773  ETA.        args
-00024980: 203a 2074 7570 6c65 0a20 2020 2020 2020   : tuple.       
-00024990: 2020 2020 2050 6f73 6974 696f 6e61 6c20       Positional 
-000249a0: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
-000249b0: 7320 746f 2066 756e 6374 696f 6e20 696e  s to function in
-000249c0: 2061 6464 6974 696f 6e20 746f 2074 6865   addition to the
-000249d0: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
-000249e0: 2041 6464 6974 696f 6e61 6c20 6b65 7977   Additional keyw
-000249f0: 6f72 6420 6172 6775 6d65 6e74 7320 7769  ord arguments wi
-00024a00: 6c6c 2062 6520 7061 7373 6564 2061 7320  ll be passed as 
-00024a10: 6b65 7977 6f72 6473 2074 6f20 7468 6520  keywords to the 
-00024a20: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
-00024a30: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00024a40: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00024a50: 2020 2061 7070 6c69 6564 203a 2053 6572     applied : Ser
-00024a60: 6965 7320 6f72 2044 6174 6146 7261 6d65  ies or DataFrame
-00024a70: 2069 6620 6675 6e63 2072 6574 7572 6e73   if func returns
-00024a80: 2061 2053 6572 6965 732e 0a0a 2020 2020   a Series...    
-00024a90: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-00024aa0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00024ab0: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-00024ac0: 2064 6173 6b2e 6461 7461 6672 616d 6520   dask.dataframe 
-00024ad0: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
-00024ae0: 3e20 7320 3d20 7064 2e53 6572 6965 7328  > s = pd.Series(
-00024af0: 7261 6e67 6528 3529 2c20 6e61 6d65 3d27  range(5), name='
-00024b00: 7827 290a 2020 2020 2020 2020 3e3e 3e20  x').        >>> 
-00024b10: 6473 203d 2064 642e 6672 6f6d 5f70 616e  ds = dd.from_pan
-00024b20: 6461 7328 732c 206e 7061 7274 6974 696f  das(s, npartitio
-00024b30: 6e73 3d32 290a 0a20 2020 2020 2020 2041  ns=2)..        A
-00024b40: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
-00024b50: 656c 656d 656e 7477 6973 6520 6163 726f  elementwise acro
-00024b60: 7373 2074 6865 2053 6572 6965 732c 2070  ss the Series, p
-00024b70: 6173 7369 6e67 2069 6e20 6578 7472 610a  assing in extra.
-00024b80: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00024b90: 7320 696e 2060 6061 7267 7360 6020 616e  s in ``args`` an
-00024ba0: 6420 6060 6b77 6172 6773 6060 3a0a 0a20  d ``kwargs``:.. 
-00024bb0: 2020 2020 2020 203e 3e3e 2064 6566 206d         >>> def m
-00024bc0: 7961 6464 2878 2c20 612c 2062 3d31 293a  yadd(x, a, b=1):
-00024bd0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00024be0: 2072 6574 7572 6e20 7820 2b20 6120 2b20   return x + a + 
-00024bf0: 620a 2020 2020 2020 2020 3e3e 3e20 7265  b.        >>> re
-00024c00: 7320 3d20 6473 2e61 7070 6c79 286d 7961  s = ds.apply(mya
-00024c10: 6464 2c20 6172 6773 3d28 322c 292c 2062  dd, args=(2,), b
-00024c20: 3d31 2e35 2920 2023 2064 6f63 7465 7374  =1.5)  # doctest
-00024c30: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
-00024c40: 2042 7920 6465 6661 756c 742c 2064 6173   By default, das
-00024c50: 6b20 7472 6965 7320 746f 2069 6e66 6572  k tries to infer
-00024c60: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
-00024c70: 6461 7461 2062 7920 7275 6e6e 696e 6720  data by running 
-00024c80: 796f 7572 0a20 2020 2020 2020 2070 726f  your.        pro
-00024c90: 7669 6465 6420 6675 6e63 7469 6f6e 206f  vided function o
-00024ca0: 6e20 736f 6d65 2066 616b 6520 6461 7461  n some fake data
-00024cb0: 2e20 5468 6973 2077 6f72 6b73 2077 656c  . This works wel
-00024cc0: 6c20 696e 206d 616e 7920 6361 7365 732c  l in many cases,
-00024cd0: 2062 7574 0a20 2020 2020 2020 2063 616e   but.        can
-00024ce0: 2073 6f6d 6574 696d 6573 2062 6520 6578   sometimes be ex
-00024cf0: 7065 6e73 6976 652c 206f 7220 6576 656e  pensive, or even
-00024d00: 2066 6169 6c2e 2054 6f20 6176 6f69 6420   fail. To avoid 
-00024d10: 7468 6973 2c20 796f 7520 6361 6e0a 2020  this, you can.  
-00024d20: 2020 2020 2020 6d61 6e75 616c 6c79 2073        manually s
-00024d30: 7065 6369 6679 2074 6865 206f 7574 7075  pecify the outpu
-00024d40: 7420 6d65 7461 6461 7461 2077 6974 6820  t metadata with 
-00024d50: 7468 6520 6060 6d65 7461 6060 206b 6579  the ``meta`` key
-00024d60: 776f 7264 2e20 5468 6973 0a20 2020 2020  word. This.     
-00024d70: 2020 2063 616e 2062 6520 7370 6563 6966     can be specif
-00024d80: 6965 6420 696e 206d 616e 7920 666f 726d  ied in many form
-00024d90: 732c 2066 6f72 206d 6f72 6520 696e 666f  s, for more info
-00024da0: 726d 6174 696f 6e20 7365 650a 2020 2020  rmation see.    
-00024db0: 2020 2020 6060 6461 736b 2e64 6174 6166      ``dask.dataf
-00024dc0: 7261 6d65 2e75 7469 6c73 2e6d 616b 655f  rame.utils.make_
-00024dd0: 6d65 7461 6060 2e0a 0a20 2020 2020 2020  meta``...       
-00024de0: 2048 6572 6520 7765 2073 7065 6369 6679   Here we specify
-00024df0: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
-00024e00: 2053 6572 6965 7320 7769 7468 206e 616d   Series with nam
-00024e10: 6520 6060 2778 2760 602c 2061 6e64 2064  e ``'x'``, and d
-00024e20: 7479 7065 0a20 2020 2020 2020 2060 6066  type.        ``f
-00024e30: 6c6f 6174 3634 6060 3a0a 0a20 2020 2020  loat64``:..     
-00024e40: 2020 203e 3e3e 2072 6573 203d 2064 732e     >>> res = ds.
-00024e50: 6170 706c 7928 6d79 6164 642c 2061 7267  apply(myadd, arg
-00024e60: 733d 2832 2c29 2c20 623d 312e 352c 206d  s=(2,), b=1.5, m
-00024e70: 6574 613d 2827 7827 2c20 2766 3827 2929  eta=('x', 'f8'))
-00024e80: 0a0a 2020 2020 2020 2020 496e 2074 6865  ..        In the
-00024e90: 2063 6173 6520 7768 6572 6520 7468 6520   case where the 
-00024ea0: 6d65 7461 6461 7461 2064 6f65 736e 2774  metadata doesn't
-00024eb0: 2063 6861 6e67 652c 2079 6f75 2063 616e   change, you can
-00024ec0: 2061 6c73 6f20 7061 7373 2069 6e0a 2020   also pass in.  
-00024ed0: 2020 2020 2020 7468 6520 6f62 6a65 6374        the object
-00024ee0: 2069 7473 656c 6620 6469 7265 6374 6c79   itself directly
-00024ef0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2072  :..        >>> r
-00024f00: 6573 203d 2064 732e 6170 706c 7928 6c61  es = ds.apply(la
-00024f10: 6d62 6461 2078 3a20 7820 2b20 312c 206d  mbda x: x + 1, m
-00024f20: 6574 613d 6473 290a 0a20 2020 2020 2020  eta=ds)..       
-00024f30: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00024f40: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00024f50: 2020 2053 6572 6965 732e 6d61 705f 7061     Series.map_pa
-00024f60: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
-00024f70: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-00024f80: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00024f90: 2861 7869 7329 0a20 2020 2020 2020 2069  (axis).        i
-00024fa0: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
-00024fb0: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
-00024fc0: 2020 6d65 7461 203d 2065 7870 722e 5f65    meta = expr._e
-00024fd0: 6d75 6c61 7465 284d 2e61 7070 6c79 2c20  mulate(M.apply, 
-00024fe0: 7365 6c66 2c20 6675 6e63 7469 6f6e 2c20  self, function, 
-00024ff0: 6172 6773 3d61 7267 732c 2075 6466 3d54  args=args, udf=T
-00025000: 7275 652c 202a 2a6b 7761 7267 7329 0a20  rue, **kwargs). 
-00025010: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-00025020: 6e67 732e 7761 726e 286d 6574 615f 7761  ngs.warn(meta_wa
-00025030: 726e 696e 6728 6d65 7461 2929 0a20 2020  rning(meta)).   
-00025040: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00025050: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
-00025060: 6578 7072 2e61 7070 6c79 2866 756e 6374  expr.apply(funct
-00025070: 696f 6e2c 202a 6172 6773 2c20 6d65 7461  ion, *args, meta
-00025080: 3d6d 6574 612c 202a 2a6b 7761 7267 7329  =meta, **kwargs)
-00025090: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
-000250a0: 686f 640a 2020 2020 6465 6620 5f76 616c  hod.    def _val
-000250b0: 6964 6174 655f 6178 6973 2863 6c73 2c20  idate_axis(cls, 
-000250c0: 6178 6973 3d30 2c20 6e75 6d65 7269 635f  axis=0, numeric_
-000250d0: 6178 6973 3a20 626f 6f6c 203d 2054 7275  axis: bool = Tru
-000250e0: 6529 202d 3e20 4e6f 6e65 207c 204c 6974  e) -> None | Lit
-000250f0: 6572 616c 5b30 2c20 315d 3a0a 2020 2020  eral[0, 1]:.    
-00025100: 2020 2020 6966 2061 7869 7320 6e6f 7420      if axis not 
-00025110: 696e 2028 302c 2022 696e 6465 7822 2c20  in (0, "index", 
-00025120: 4e6f 6e65 293a 0a20 2020 2020 2020 2020  None):.         
-00025130: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00025140: 726f 7228 6622 4e6f 2061 7869 7320 6e61  ror(f"No axis na
-00025150: 6d65 6420 7b61 7869 737d 2066 6f72 2053  med {axis} for S
-00025160: 6572 6965 7322 290a 2020 2020 2020 2020  eries").        
-00025170: 6966 206e 756d 6572 6963 5f61 7869 733a  if numeric_axis:
-00025180: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-00025190: 5f61 7869 733a 2064 6963 745b 7374 7220  _axis: dict[str 
-000251a0: 7c20 4e6f 6e65 2c20 4c69 7465 7261 6c5b  | None, Literal[
-000251b0: 302c 2031 5d5d 203d 207b 2269 6e64 6578  0, 1]] = {"index
-000251c0: 223a 2030 7d0a 2020 2020 2020 2020 2020  ": 0}.          
-000251d0: 2020 7265 7475 726e 206e 756d 5f61 7869    return num_axi
-000251e0: 732e 6765 7428 6178 6973 2c20 6178 6973  s.get(axis, axis
-000251f0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00025200: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00025210: 726e 2061 7869 730a 0a20 2020 2040 6465  rn axis..    @de
-00025220: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00025230: 7269 6573 290a 2020 2020 6465 6620 7371  ries).    def sq
-00025240: 7565 657a 6528 7365 6c66 293a 0a20 2020  ueeze(self):.   
-00025250: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00025260: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00025270: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00025280: 2020 2064 6566 2064 726f 706e 6128 7365     def dropna(se
-00025290: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-000252a0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-000252b0: 6f6e 2865 7870 722e 4472 6f70 6e61 5365  on(expr.DropnaSe
-000252c0: 7269 6573 2873 656c 6629 290a 0a20 2020  ries(self))..   
-000252d0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000252e0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-000252f0: 6620 6265 7477 6565 6e28 7365 6c66 2c20  f between(self, 
-00025300: 6c65 6674 2c20 7269 6768 742c 2069 6e63  left, right, inc
-00025310: 6c75 7369 7665 3d22 626f 7468 2229 3a0a  lusive="both"):.
-00025320: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-00025330: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
-00025340: 2020 2020 2020 2020 2020 2065 7870 722e             expr.
-00025350: 4265 7477 6565 6e28 7365 6c66 2c20 6c65  Between(self, le
-00025360: 6674 3d6c 6566 742c 2072 6967 6874 3d72  ft=left, right=r
-00025370: 6967 6874 2c20 696e 636c 7573 6976 653d  ight, inclusive=
-00025380: 696e 636c 7573 6976 6529 0a20 2020 2020  inclusive).     
-00025390: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-000253a0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-000253b0: 7329 0a20 2020 2064 6566 2063 6f6d 6269  s).    def combi
-000253c0: 6e65 2873 656c 662c 206f 7468 6572 2c20  ne(self, other, 
-000253d0: 6675 6e63 2c20 6669 6c6c 5f76 616c 7565  func, fill_value
-000253e0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-000253f0: 6f74 6865 7220 3d20 7365 6c66 2e5f 6372  other = self._cr
-00025400: 6561 7465 5f61 6c69 676e 6162 6c65 5f66  eate_alignable_f
-00025410: 7261 6d65 286f 7468 6572 2c20 226f 7574  rame(other, "out
-00025420: 6572 2229 0a20 2020 2020 2020 2069 6620  er").        if 
-00025430: 6e6f 7420 6578 7072 2e61 7265 5f63 6f5f  not expr.are_co_
-00025440: 616c 6967 6e65 6428 7365 6c66 2e65 7870  aligned(self.exp
-00025450: 722c 206f 7468 6572 2e65 7870 7229 3a0a  r, other.expr):.
-00025460: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00025470: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00025480: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00025490: 2020 2065 7870 722e 436f 6d62 696e 6553     expr.CombineS
-000254a0: 6572 6965 7341 6c69 676e 2873 656c 662c  eriesAlign(self,
-000254b0: 206f 7468 6572 2c20 6675 6e63 2c20 6669   other, func, fi
-000254c0: 6c6c 5f76 616c 7565 290a 2020 2020 2020  ll_value).      
-000254d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000254e0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-000254f0: 6374 696f 6e28 6578 7072 2e43 6f6d 6269  ction(expr.Combi
-00025500: 6e65 5365 7269 6573 2873 656c 662c 206f  neSeries(self, o
-00025510: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
-00025520: 5f76 616c 7565 2929 0a0a 2020 2020 4064  _value))..    @d
-00025530: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00025540: 6572 6965 7329 0a20 2020 2064 6566 2065  eries).    def e
-00025550: 7870 6c6f 6465 2873 656c 6629 3a0a 2020  xplode(self):.  
-00025560: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00025570: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
-00025580: 2e45 7870 6c6f 6465 5365 7269 6573 2873  .ExplodeSeries(s
-00025590: 656c 6629 290a 0a20 2020 2040 6465 7269  elf))..    @deri
-000255a0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-000255b0: 6573 290a 2020 2020 6465 6620 6164 645f  es).    def add_
-000255c0: 7072 6566 6978 2873 656c 662c 2070 7265  prefix(self, pre
-000255d0: 6669 7829 3a0a 2020 2020 2020 2020 7265  fix):.        re
-000255e0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-000255f0: 696f 6e28 6578 7072 2e41 6464 5072 6566  ion(expr.AddPref
-00025600: 6978 5365 7269 6573 2873 656c 662c 2070  ixSeries(self, p
-00025610: 7265 6669 7829 290a 0a20 2020 2040 6465  refix))..    @de
-00025620: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00025630: 7269 6573 290a 2020 2020 6465 6620 6164  ries).    def ad
-00025640: 645f 7375 6666 6978 2873 656c 662c 2073  d_suffix(self, s
-00025650: 7566 6669 7829 3a0a 2020 2020 2020 2020  uffix):.        
-00025660: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00025670: 6374 696f 6e28 6578 7072 2e41 6464 5375  ction(expr.AddSu
-00025680: 6666 6978 5365 7269 6573 2873 656c 662c  ffixSeries(self,
-00025690: 2073 7566 6669 7829 290a 0a20 2020 2063   suffix))..    c
-000256a0: 6174 203d 2043 6163 6865 6441 6363 6573  at = CachedAcces
-000256b0: 736f 7228 2263 6174 222c 2043 6174 6567  sor("cat", Categ
-000256c0: 6f72 6963 616c 4163 6365 7373 6f72 290a  oricalAccessor).
-000256d0: 2020 2020 6474 203d 2043 6163 6865 6441      dt = CachedA
-000256e0: 6363 6573 736f 7228 2264 7422 2c20 4461  ccessor("dt", Da
-000256f0: 7465 7469 6d65 4163 6365 7373 6f72 290a  tetimeAccessor).
-00025700: 2020 2020 7374 7220 3d20 4361 6368 6564      str = Cached
-00025710: 4163 6365 7373 6f72 2822 7374 7222 2c20  Accessor("str", 
-00025720: 5374 7269 6e67 4163 6365 7373 6f72 290a  StringAccessor).
-00025730: 0a20 2020 2064 6566 205f 7265 7061 7274  .    def _repart
-00025740: 6974 696f 6e5f 7175 616e 7469 6c65 7328  ition_quantiles(
-00025750: 7365 6c66 2c20 6e70 6172 7469 7469 6f6e  self, npartition
-00025760: 732c 2075 7073 616d 706c 653d 312e 302c  s, upsample=1.0,
-00025770: 2072 616e 646f 6d5f 7374 6174 653d 4e6f   random_state=No
-00025780: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-00025790: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-000257a0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-000257b0: 5265 7061 7274 6974 696f 6e51 7561 6e74  RepartitionQuant
-000257c0: 696c 6573 2873 656c 662c 206e 7061 7274  iles(self, npart
-000257d0: 6974 696f 6e73 2c20 7570 7361 6d70 6c65  itions, upsample
-000257e0: 2c20 7261 6e64 6f6d 5f73 7461 7465 290a  , random_state).
-000257f0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00025800: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00025810: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00025820: 6772 6f75 7062 7928 7365 6c66 2c20 6279  groupby(self, by
-00025830: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00025840: 2020 2020 2066 726f 6d20 6461 736b 5f65       from dask_e
-00025850: 7870 722e 5f67 726f 7570 6279 2069 6d70  xpr._groupby imp
-00025860: 6f72 7420 5365 7269 6573 4772 6f75 7042  ort SeriesGroupB
-00025870: 790a 0a20 2020 2020 2020 2072 6574 7572  y..        retur
-00025880: 6e20 5365 7269 6573 4772 6f75 7042 7928  n SeriesGroupBy(
-00025890: 7365 6c66 2c20 6279 2c20 2a2a 6b77 6172  self, by, **kwar
-000258a0: 6773 290a 0a20 2020 2064 6566 2072 656e  gs)..    def ren
-000258b0: 616d 6528 7365 6c66 2c20 696e 6465 782c  ame(self, index,
-000258c0: 2073 6f72 7465 645f 696e 6465 783d 4661   sorted_index=Fa
-000258d0: 6c73 6529 3a0a 2020 2020 2020 2020 2222  lse):.        ""
-000258e0: 2241 6c74 6572 2053 6572 6965 7320 696e  "Alter Series in
-000258f0: 6465 7820 6c61 6265 6c73 206f 7220 6e61  dex labels or na
-00025900: 6d65 0a0a 2020 2020 2020 2020 4675 6e63  me..        Func
-00025910: 7469 6f6e 202f 2064 6963 7420 7661 6c75  tion / dict valu
-00025920: 6573 206d 7573 7420 6265 2075 6e69 7175  es must be uniqu
-00025930: 6520 2831 2d74 6f2d 3129 2e20 4c61 6265  e (1-to-1). Labe
-00025940: 6c73 206e 6f74 2063 6f6e 7461 696e 6564  ls not contained
-00025950: 2069 6e0a 2020 2020 2020 2020 6120 6469   in.        a di
-00025960: 6374 202f 2053 6572 6965 7320 7769 6c6c  ct / Series will
-00025970: 2062 6520 6c65 6674 2061 732d 6973 2e20   be left as-is. 
-00025980: 4578 7472 6120 6c61 6265 6c73 206c 6973  Extra labels lis
-00025990: 7465 6420 646f 6e27 7420 7468 726f 7720  ted don't throw 
-000259a0: 616e 0a20 2020 2020 2020 2065 7272 6f72  an.        error
-000259b0: 2e0a 0a20 2020 2020 2020 2041 6c74 6572  ...        Alter
-000259c0: 6e61 7469 7665 6c79 2c20 6368 616e 6765  natively, change
-000259d0: 2060 6053 6572 6965 732e 6e61 6d65 6060   ``Series.name``
-000259e0: 2077 6974 6820 6120 7363 616c 6172 2076   with a scalar v
-000259f0: 616c 7565 2e0a 0a20 2020 2020 2020 2050  alue...        P
-00025a00: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00025a10: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00025a20: 2020 2020 2069 6e64 6578 203a 2073 6361       index : sca
-00025a30: 6c61 722c 2068 6173 6861 626c 6520 7365  lar, hashable se
-00025a40: 7175 656e 6365 2c20 6469 6374 2d6c 696b  quence, dict-lik
-00025a50: 6520 6f72 2063 616c 6c61 626c 652c 206f  e or callable, o
-00025a60: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00025a70: 2020 2020 4966 2064 6963 742d 6c69 6b65      If dict-like
-00025a80: 206f 7220 6361 6c6c 6162 6c65 2c20 7468   or callable, th
-00025a90: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
-00025aa0: 2069 7320 6170 706c 6965 6420 746f 2074   is applied to t
-00025ab0: 6865 0a20 2020 2020 2020 2020 2020 2069  he.            i
-00025ac0: 6e64 6578 2e20 5363 616c 6172 206f 7220  ndex. Scalar or 
-00025ad0: 6861 7368 6162 6c65 2073 6571 7565 6e63  hashable sequenc
-00025ae0: 652d 6c69 6b65 2077 696c 6c20 616c 7465  e-like will alte
-00025af0: 7220 7468 650a 2020 2020 2020 2020 2020  r the.          
-00025b00: 2020 6060 5365 7269 6573 2e6e 616d 6560    ``Series.name`
-00025b10: 6020 6174 7472 6962 7574 652e 0a20 2020  ` attribute..   
-00025b20: 2020 2020 2069 6e70 6c61 6365 203a 2062       inplace : b
-00025b30: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
-00025b40: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00025b50: 2020 5768 6574 6865 7220 746f 2072 6574    Whether to ret
-00025b60: 7572 6e20 6120 6e65 7720 5365 7269 6573  urn a new Series
-00025b70: 206f 7220 6d6f 6469 6679 2074 6869 7320   or modify this 
-00025b80: 6f6e 6520 696e 706c 6163 652e 0a20 2020  one inplace..   
-00025b90: 2020 2020 2073 6f72 7465 645f 696e 6465       sorted_inde
-00025ba0: 7820 3a20 626f 6f6c 2c20 6465 6661 756c  x : bool, defaul
-00025bb0: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
-00025bc0: 2020 2020 4966 2074 7275 652c 2074 6865      If true, the
-00025bd0: 206f 7574 7075 7420 6060 5365 7269 6573   output ``Series
-00025be0: 6060 2077 696c 6c20 6861 7665 206b 6e6f  `` will have kno
-00025bf0: 776e 2064 6976 6973 696f 6e73 2069 6e66  wn divisions inf
-00025c00: 6572 7265 640a 2020 2020 2020 2020 2020  erred.          
-00025c10: 2020 6672 6f6d 2074 6865 2069 6e70 7574    from the input
-00025c20: 2073 6572 6965 7320 616e 6420 7468 6520   series and the 
-00025c30: 7472 616e 7366 6f72 6d61 7469 6f6e 2e20  transformation. 
-00025c40: 4967 6e6f 7265 6420 666f 720a 2020 2020  Ignored for.    
-00025c50: 2020 2020 2020 2020 6e6f 6e2d 6361 6c6c          non-call
-00025c60: 6162 6c65 2f64 6963 742d 6c69 6b65 2060  able/dict-like `
-00025c70: 6069 6e64 6578 6060 206f 7220 7768 656e  `index`` or when
-00025c80: 2074 6865 2069 6e70 7574 2073 6572 6965   the input serie
-00025c90: 7320 6861 730a 2020 2020 2020 2020 2020  s has.          
-00025ca0: 2020 756e 6b6e 6f77 6e20 6469 7669 7369    unknown divisi
-00025cb0: 6f6e 732e 204e 6f74 6520 7468 6174 2074  ons. Note that t
-00025cc0: 6869 7320 6d61 7920 6f6e 6c79 2062 6520  his may only be 
-00025cd0: 7365 7420 746f 2060 6054 7275 6560 6020  set to ``True`` 
-00025ce0: 6966 0a20 2020 2020 2020 2020 2020 2079  if.            y
-00025cf0: 6f75 206b 6e6f 7720 7468 6174 2074 6865  ou know that the
-00025d00: 2074 7261 6e73 666f 726d 6564 2069 6e64   transformed ind
-00025d10: 6578 2069 7320 6d6f 6e6f 746f 6e69 6361  ex is monotonica
-00025d20: 6c6c 7920 696e 6372 6561 7369 6e67 2e20  lly increasing. 
-00025d30: 4461 736b 0a20 2020 2020 2020 2020 2020  Dask.           
-00025d40: 2077 696c 6c20 6368 6563 6b20 7468 6174   will check that
-00025d50: 2074 7261 6e73 666f 726d 6564 2064 6976   transformed div
-00025d60: 6973 696f 6e73 2061 7265 206d 6f6e 6f74  isions are monot
-00025d70: 6f6e 6963 2c20 6275 7420 6361 6e6e 6f74  onic, but cannot
-00025d80: 0a20 2020 2020 2020 2020 2020 2063 6865  .            che
-00025d90: 636b 2061 6c6c 2074 6865 2076 616c 7565  ck all the value
-00025da0: 7320 6265 7477 6565 6e20 6469 7669 7369  s between divisi
-00025db0: 6f6e 732c 2073 6f20 696e 636f 7272 6563  ons, so incorrec
-00025dc0: 746c 7920 7365 7474 696e 6720 7468 6973  tly setting this
-00025dd0: 0a20 2020 2020 2020 2020 2020 2063 616e  .            can
-00025de0: 2072 6573 756c 7420 696e 2062 7567 732e   result in bugs.
-00025df0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00025e00: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00025e10: 2d0a 2020 2020 2020 2020 7265 6e61 6d65  -.        rename
-00025e20: 6420 3a20 5365 7269 6573 0a0a 2020 2020  d : Series..    
-00025e30: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00025e40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00025e50: 2020 2020 2020 7061 6e64 6173 2e53 6572        pandas.Ser
-00025e60: 6965 732e 7265 6e61 6d65 0a20 2020 2020  ies.rename.     
-00025e70: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00025e80: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00025e90: 7469 6f6e 2865 7870 722e 5265 6e61 6d65  tion(expr.Rename
-00025ea0: 5365 7269 6573 2873 656c 662c 2069 6e64  Series(self, ind
-00025eb0: 6578 2c20 736f 7274 6564 5f69 6e64 6578  ex, sorted_index
-00025ec0: 2929 0a0a 2020 2020 6465 6620 7175 616e  ))..    def quan
-00025ed0: 7469 6c65 2873 656c 662c 2071 3d30 2e35  tile(self, q=0.5
-00025ee0: 2c20 6d65 7468 6f64 3d22 6465 6661 756c  , method="defaul
-00025ef0: 7422 293a 0a20 2020 2020 2020 2022 2222  t"):.        """
-00025f00: 4170 7072 6f78 696d 6174 6520 7175 616e  Approximate quan
-00025f10: 7469 6c65 7320 6f66 2053 6572 6965 730a  tiles of Series.
-00025f20: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00025f30: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00025f40: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2071  ------.        q
-00025f50: 203a 206c 6973 742f 6172 7261 7920 6f66   : list/array of
-00025f60: 2066 6c6f 6174 732c 2064 6566 6175 6c74   floats, default
-00025f70: 2030 2e35 2028 3530 2529 0a20 2020 2020   0.5 (50%).     
-00025f80: 2020 2020 2020 2049 7465 7261 626c 6520         Iterable 
-00025f90: 6f66 206e 756d 6265 7273 2072 616e 6769  of numbers rangi
-00025fa0: 6e67 2066 726f 6d20 3020 746f 2031 2066  ng from 0 to 1 f
-00025fb0: 6f72 2074 6865 2064 6573 6972 6564 2071  or the desired q
-00025fc0: 7561 6e74 696c 6573 0a20 2020 2020 2020  uantiles.       
-00025fd0: 206d 6574 686f 6420 3a20 7b27 6465 6661   method : {'defa
-00025fe0: 756c 7427 2c20 2774 6469 6765 7374 272c  ult', 'tdigest',
-00025ff0: 2027 6461 736b 277d 2c20 6f70 7469 6f6e   'dask'}, option
-00026000: 616c 0a20 2020 2020 2020 2020 2020 2057  al.            W
-00026010: 6861 7420 6d65 7468 6f64 2074 6f20 7573  hat method to us
-00026020: 652e 2042 7920 6465 6661 756c 7420 7769  e. By default wi
-00026030: 6c6c 2075 7365 2064 6173 6b27 7320 696e  ll use dask's in
-00026040: 7465 726e 616c 2063 7573 746f 6d0a 2020  ternal custom.  
-00026050: 2020 2020 2020 2020 2020 616c 676f 7269            algori
-00026060: 7468 6d20 2860 6027 6461 736b 2760 6029  thm (``'dask'``)
-00026070: 2e20 2049 6620 7365 7420 746f 2060 6027  .  If set to ``'
-00026080: 7464 6967 6573 7427 6060 2077 696c 6c20  tdigest'`` will 
-00026090: 7573 6520 7464 6967 6573 740a 2020 2020  use tdigest.    
-000260a0: 2020 2020 2020 2020 666f 7220 666c 6f61          for floa
-000260b0: 7473 2061 6e64 2069 6e74 7320 616e 6420  ts and ints and 
-000260c0: 6661 6c6c 6261 636b 2074 6f20 7468 6520  fallback to the 
-000260d0: 6060 2764 6173 6b27 6060 206f 7468 6572  ``'dask'`` other
-000260e0: 7769 7365 2e0a 2020 2020 2020 2020 2222  wise..        ""
-000260f0: 220a 2020 2020 2020 2020 5f72 6169 7365  ".        _raise
-00026100: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
-00026110: 7328 7365 6c66 2c20 2271 7561 6e74 696c  s(self, "quantil
-00026120: 6522 290a 2020 2020 2020 2020 616c 6c6f  e").        allo
-00026130: 7765 645f 6d65 7468 6f64 7320 3d20 5b22  wed_methods = ["
-00026140: 6465 6661 756c 7422 2c20 2264 6173 6b22  default", "dask"
-00026150: 2c20 2274 6469 6765 7374 225d 0a20 2020  , "tdigest"].   
-00026160: 2020 2020 2069 6620 6d65 7468 6f64 206e       if method n
-00026170: 6f74 2069 6e20 616c 6c6f 7765 645f 6d65  ot in allowed_me
-00026180: 7468 6f64 733a 0a20 2020 2020 2020 2020  thods:.         
-00026190: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000261a0: 726f 7228 226d 6574 686f 6420 6361 6e20  ror("method can 
-000261b0: 6f6e 6c79 2062 6520 2764 6566 6175 6c74  only be 'default
-000261c0: 272c 2027 6461 736b 2720 6f72 2027 7464  ', 'dask' or 'td
-000261d0: 6967 6573 7427 2229 0a20 2020 2020 2020  igest'").       
-000261e0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-000261f0: 6563 7469 6f6e 2853 6572 6965 7351 7561  ection(SeriesQua
-00026200: 6e74 696c 6528 7365 6c66 2c20 712c 206d  ntile(self, q, m
-00026210: 6574 686f 6429 290a 0a20 2020 2040 6465  ethod))..    @de
-00026220: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00026230: 7269 6573 290a 2020 2020 6465 6620 6d65  ries).    def me
-00026240: 6469 616e 2873 656c 6629 3a0a 2020 2020  dian(self):.    
-00026250: 2020 2020 6966 2073 656c 662e 6e70 6172      if self.npar
-00026260: 7469 7469 6f6e 7320 3d3d 2031 3a0a 2020  titions == 1:.  
-00026270: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00026280: 2073 656c 662e 6d65 6469 616e 5f61 7070   self.median_app
-00026290: 726f 7869 6d61 7465 2829 0a20 2020 2020  roximate().     
-000262a0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-000262b0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-000262c0: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
-000262d0: 646f 6573 6e27 7420 696d 706c 656d 656e  doesn't implemen
-000262e0: 7420 616e 2065 7861 6374 206d 6564 6961  t an exact media
-000262f0: 6e20 696e 2061 6c6c 2063 6173 6573 2061  n in all cases a
-00026300: 7320 7468 6973 2069 7320 6861 7264 2074  s this is hard t
-00026310: 6f20 646f 2069 6e20 7061 7261 6c6c 656c  o do in parallel
-00026320: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00026330: 2253 6565 2074 6865 2060 6d65 6469 616e  "See the `median
-00026340: 5f61 7070 726f 7869 6d61 7465 6020 6d65  _approximate` me
-00026350: 7468 6f64 2069 6e73 7465 6164 2c20 7768  thod instead, wh
-00026360: 6963 6820 7573 6573 2061 6e20 6170 7072  ich uses an appr
-00026370: 6f78 696d 6174 6520 616c 676f 7269 7468  oximate algorith
-00026380: 6d2e 220a 2020 2020 2020 2020 290a 0a20  m.".        ).. 
-00026390: 2020 2064 6566 206d 6564 6961 6e5f 6170     def median_ap
-000263a0: 7072 6f78 696d 6174 6528 7365 6c66 2c20  proximate(self, 
-000263b0: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
-000263c0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-000263d0: 7475 726e 2074 6865 2061 7070 726f 7869  turn the approxi
-000263e0: 6d61 7465 206d 6564 6961 6e20 6f66 2074  mate median of t
-000263f0: 6865 2076 616c 7565 7320 6f76 6572 2074  he values over t
-00026400: 6865 2072 6571 7565 7374 6564 2061 7869  he requested axi
-00026410: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
-00026420: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00026430: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00026440: 2020 6d65 7468 6f64 203a 207b 2764 6566    method : {'def
-00026450: 6175 6c74 272c 2027 7464 6967 6573 7427  ault', 'tdigest'
-00026460: 2c20 2764 6173 6b27 7d2c 206f 7074 696f  , 'dask'}, optio
-00026470: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00026480: 5768 6174 206d 6574 686f 6420 746f 2075  What method to u
-00026490: 7365 2e20 4279 2064 6566 6175 6c74 2077  se. By default w
-000264a0: 696c 6c20 7573 6520 4461 736b 2773 2069  ill use Dask's i
-000264b0: 6e74 6572 6e61 6c20 6375 7374 6f6d 0a20  nternal custom. 
-000264c0: 2020 2020 2020 2020 2020 2061 6c67 6f72             algor
-000264d0: 6974 686d 2028 6060 2264 6173 6b22 6060  ithm (``"dask"``
-000264e0: 292e 2020 4966 2073 6574 2074 6f20 6060  ).  If set to ``
-000264f0: 2274 6469 6765 7374 2260 6020 7769 6c6c  "tdigest"`` will
-00026500: 2075 7365 2074 6469 6765 7374 0a20 2020   use tdigest.   
-00026510: 2020 2020 2020 2020 2066 6f72 2066 6c6f           for flo
-00026520: 6174 7320 616e 6420 696e 7473 2061 6e64  ats and ints and
-00026530: 2066 616c 6c62 6163 6b20 746f 2074 6865   fallback to the
-00026540: 2060 6022 6461 736b 2260 6020 6f74 6865   ``"dask"`` othe
-00026550: 7277 6973 652e 0a20 2020 2020 2020 2022  rwise..        "
-00026560: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00026570: 6e20 7365 6c66 2e71 7561 6e74 696c 6528  n self.quantile(
-00026580: 6d65 7468 6f64 3d6d 6574 686f 6429 0a0a  method=method)..
-00026590: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000265a0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-000265b0: 2064 6566 2063 6f76 2873 656c 662c 206f   def cov(self, o
-000265c0: 7468 6572 2c20 6d69 6e5f 7065 7269 6f64  ther, min_period
-000265d0: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
-000265e0: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
-000265f0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00026600: 7461 6e63 6528 6f74 6865 722c 2053 6572  tance(other, Ser
-00026610: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
-00026620: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00026630: 7228 226f 7468 6572 206d 7573 7420 6265  r("other must be
-00026640: 2061 2064 6173 6b2e 6461 7461 6672 616d   a dask.datafram
-00026650: 652e 5365 7269 6573 2229 0a20 2020 2020  e.Series").     
-00026660: 2020 2064 6620 3d20 636f 6e63 6174 285b     df = concat([
-00026670: 7365 6c66 2c20 6f74 6865 725d 2c20 6178  self, other], ax
-00026680: 6973 3d31 290a 2020 2020 2020 2020 7265  is=1).        re
-00026690: 7475 726e 2064 662e 5f63 6f76 286d 696e  turn df._cov(min
-000266a0: 5f70 6572 696f 6473 2c20 5472 7565 2c20  _periods, True, 
-000266b0: 7370 6c69 745f 6576 6572 792c 2073 6361  split_every, sca
-000266c0: 6c61 723d 5472 7565 290a 0a20 2020 2040  lar=True)..    @
-000266d0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-000266e0: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-000266f0: 636f 7272 2873 656c 662c 206f 7468 6572  corr(self, other
-00026700: 2c20 6d65 7468 6f64 3d22 7065 6172 736f  , method="pearso
-00026710: 6e22 2c20 6d69 6e5f 7065 7269 6f64 733d  n", min_periods=
-00026720: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
-00026730: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00026740: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00026750: 6e63 6528 6f74 6865 722c 2053 6572 6965  nce(other, Serie
-00026760: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00026770: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00026780: 226f 7468 6572 206d 7573 7420 6265 2061  "other must be a
-00026790: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-000267a0: 5365 7269 6573 2229 0a20 2020 2020 2020  Series").       
-000267b0: 2064 6620 3d20 636f 6e63 6174 285b 7365   df = concat([se
-000267c0: 6c66 2c20 6f74 6865 725d 2c20 6178 6973  lf, other], axis
-000267d0: 3d31 290a 2020 2020 2020 2020 7265 7475  =1).        retu
-000267e0: 726e 2064 662e 5f63 6f72 7228 6d65 7468  rn df._corr(meth
-000267f0: 6f64 2c20 6d69 6e5f 7065 7269 6f64 732c  od, min_periods,
-00026800: 2054 7275 652c 2073 706c 6974 5f65 7665   True, split_eve
-00026810: 7279 2c20 7363 616c 6172 3d54 7275 6529  ry, scalar=True)
-00026820: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00026830: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026840: 2020 2064 6566 2061 7574 6f63 6f72 7228     def autocorr(
-00026850: 7365 6c66 2c20 6c61 673d 312c 2073 706c  self, lag=1, spl
-00026860: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
-00026870: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00026880: 6973 696e 7374 616e 6365 286c 6167 2c20  isinstance(lag, 
-00026890: 496e 7465 6772 616c 293a 0a20 2020 2020  Integral):.     
-000268a0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-000268b0: 6545 7272 6f72 2822 6c61 6720 6d75 7374  eError("lag must
-000268c0: 2062 6520 616e 2069 6e74 6567 6572 2229   be an integer")
-000268d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000268e0: 7365 6c66 2e63 6f72 7228 7365 6c66 2069  self.corr(self i
-000268f0: 6620 6c61 6720 3d3d 2030 2065 6c73 6520  f lag == 0 else 
-00026900: 7365 6c66 2e73 6869 6674 286c 6167 292c  self.shift(lag),
-00026910: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00026920: 6974 5f65 7665 7279 290a 0a20 2020 2040  it_every)..    @
-00026930: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00026940: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00026950: 6465 7363 7269 6265 280a 2020 2020 2020  describe(.      
-00026960: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00026970: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-00026980: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
-00026990: 6e74 696c 6573 3d4e 6f6e 652c 0a20 2020  ntiles=None,.   
-000269a0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
-000269b0: 5f6d 6574 686f 643d 2264 6566 6175 6c74  _method="default
-000269c0: 222c 0a20 2020 2020 2020 2069 6e63 6c75  ",.        inclu
-000269d0: 6465 3d4e 6f6e 652c 0a20 2020 2020 2020  de=None,.       
-000269e0: 2065 7863 6c75 6465 3d4e 6f6e 652c 0a20   exclude=None,. 
-000269f0: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-00026a00: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
-00026a10: 735f 6e75 6d65 7269 635f 6474 7970 6528  s_numeric_dtype(
-00026a20: 7365 6c66 2e64 7479 7065 290a 2020 2020  self.dtype).    
-00026a30: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
-00026a40: 6973 5f62 6f6f 6c5f 6474 7970 6528 7365  is_bool_dtype(se
-00026a50: 6c66 2e64 7479 7065 290a 2020 2020 2020  lf.dtype).      
-00026a60: 2020 2020 2020 6f72 2069 735f 7469 6d65        or is_time
-00026a70: 6465 6c74 6136 345f 6474 7970 6528 7365  delta64_dtype(se
-00026a80: 6c66 2e64 7479 7065 290a 2020 2020 2020  lf.dtype).      
-00026a90: 2020 2020 2020 6f72 2069 735f 6461 7465        or is_date
-00026aa0: 7469 6d65 3634 5f61 6e79 5f64 7479 7065  time64_any_dtype
-00026ab0: 2873 656c 662e 6474 7970 6529 0a20 2020  (self.dtype).   
-00026ac0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00026ad0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-00026ae0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
-00026af0: 2020 2020 2020 2020 2020 2044 6573 6372             Descr
-00026b00: 6962 654e 756d 6572 6963 2873 656c 662c  ibeNumeric(self,
-00026b10: 2073 706c 6974 5f65 7665 7279 2c20 7065   split_every, pe
-00026b20: 7263 656e 7469 6c65 732c 2070 6572 6365  rcentiles, perce
-00026b30: 6e74 696c 6573 5f6d 6574 686f 6429 0a20  ntiles_method). 
-00026b40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00026b50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00026b60: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00026b70: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-00026b80: 2020 2020 2020 2020 2020 2020 2020 4465                De
-00026b90: 7363 7269 6265 4e6f 6e4e 756d 6572 6963  scribeNonNumeric
-00026ba0: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
-00026bb0: 7279 2c20 7065 7263 656e 7469 6c65 732c  ry, percentiles,
-00026bc0: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
-00026bd0: 686f 6429 0a20 2020 2020 2020 2020 2020  hod).           
-00026be0: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
-00026bf0: 790a 2020 2020 4064 6572 6976 6564 5f66  y.    @derived_f
-00026c00: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026c10: 2020 2064 6566 2069 735f 6d6f 6e6f 746f     def is_monoto
-00026c20: 6e69 635f 696e 6372 6561 7369 6e67 2873  nic_increasing(s
-00026c30: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00026c40: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
-00026c50: 696f 6e28 4973 4d6f 6e6f 746f 6e69 6349  ion(IsMonotonicI
-00026c60: 6e63 7265 6173 696e 6728 7365 6c66 2929  ncreasing(self))
-00026c70: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00026c80: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00026c90: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00026ca0: 2064 6566 2069 735f 6d6f 6e6f 746f 6e69   def is_monotoni
-00026cb0: 635f 6465 6372 6561 7369 6e67 2873 656c  c_decreasing(sel
-00026cc0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00026cd0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-00026ce0: 6e28 4973 4d6f 6e6f 746f 6e69 6344 6563  n(IsMonotonicDec
-00026cf0: 7265 6173 696e 6728 7365 6c66 2929 0a0a  reasing(self))..
-00026d00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00026d10: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00026d20: 2064 6566 2074 6f5f 7374 7269 6e67 2873   def to_string(s
-00026d30: 656c 662c 206d 6178 5f72 6f77 733d 3529  elf, max_rows=5)
-00026d40: 3a0a 2020 2020 2020 2020 2320 6f70 7469  :.        # opti
-00026d50: 6f6e 5f63 6f6e 7465 7874 2064 6f65 736e  on_context doesn
-00026d60: 2774 2061 6666 6563 740a 2020 2020 2020  't affect.      
-00026d70: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00026d80: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
-00026d90: 7269 6e67 286d 6178 5f72 6f77 733d 6d61  ring(max_rows=ma
-00026da0: 785f 726f 7773 290a 0a20 2020 2064 6566  x_rows)..    def
-00026db0: 205f 7265 7072 5f64 6174 6128 7365 6c66   _repr_data(self
-00026dc0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00026dd0: 6e20 5f72 6570 725f 6461 7461 5f73 6572  n _repr_data_ser
-00026de0: 6965 7328 7365 6c66 2e5f 6d65 7461 2c20  ies(self._meta, 
-00026df0: 7365 6c66 2e5f 7265 7072 5f64 6976 6973  self._repr_divis
-00026e00: 696f 6e73 290a 0a20 2020 2069 6620 5041  ions)..    if PA
-00026e10: 4e44 4153 5f47 455f 3232 303a 0a0a 2020  NDAS_GE_220:..  
-00026e20: 2020 2020 2020 4064 6572 6976 6564 5f66        @derived_f
-00026e30: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026e40: 2020 2020 2020 2064 6566 2063 6173 655f         def case_
-00026e50: 7768 656e 2873 656c 662c 2063 6173 656c  when(self, casel
-00026e60: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
-00026e70: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00026e80: 6e63 6528 6361 7365 6c69 7374 2c20 6c69  nce(caselist, li
-00026e90: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
-00026ea0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00026eb0: 7272 6f72 2822 5468 6520 6361 7365 6c69  rror("The caseli
-00026ec0: 7374 2061 7267 756d 656e 7420 7368 6f75  st argument shou
-00026ed0: 6c64 2062 6520 6120 6c69 7374 2229 0a20  ld be a list"). 
-00026ee0: 2020 2020 2020 2020 2020 2063 6173 656c             casel
-00026ef0: 6973 7420 3d20 6c69 7374 2866 6c61 7474  ist = list(flatt
-00026f00: 656e 285b 5b63 2c20 765d 2066 6f72 2063  en([[c, v] for c
-00026f10: 2c20 7620 696e 2063 6173 656c 6973 745d  , v in caselist]
-00026f20: 2c20 636f 6e74 6169 6e65 723d 6c69 7374  , container=list
-00026f30: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-00026f40: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-00026f50: 7469 6f6e 2865 7870 722e 4361 7365 5768  tion(expr.CaseWh
-00026f60: 656e 2873 656c 662c 202a 6361 7365 6c69  en(self, *caseli
-00026f70: 7374 2929 0a0a 0a66 6f72 206e 616d 6520  st))...for name 
-00026f80: 696e 205b 0a20 2020 2022 6164 6422 2c0a  in [.    "add",.
-00026f90: 2020 2020 2273 7562 222c 0a20 2020 2022      "sub",.    "
-00026fa0: 6d75 6c22 2c0a 2020 2020 2264 6976 222c  mul",.    "div",
-00026fb0: 0a20 2020 2022 6469 7669 6465 222c 0a20  .    "divide",. 
-00026fc0: 2020 2022 7472 7565 6469 7622 2c0a 2020     "truediv",.  
-00026fd0: 2020 2266 6c6f 6f72 6469 7622 2c0a 2020    "floordiv",.  
-00026fe0: 2020 226d 6f64 222c 0a20 2020 2022 706f    "mod",.    "po
-00026ff0: 7722 2c0a 2020 2020 2272 6164 6422 2c0a  w",.    "radd",.
-00027000: 2020 2020 2272 7375 6222 2c0a 2020 2020      "rsub",.    
-00027010: 2272 6d75 6c22 2c0a 2020 2020 2272 6469  "rmul",.    "rdi
-00027020: 7622 2c0a 2020 2020 2272 7472 7565 6469  v",.    "rtruedi
-00027030: 7622 2c0a 2020 2020 2272 666c 6f6f 7264  v",.    "rfloord
-00027040: 6976 222c 0a20 2020 2022 726d 6f64 222c  iv",.    "rmod",
-00027050: 0a20 2020 2022 7270 6f77 222c 0a5d 3a0a  .    "rpow",.]:.
-00027060: 2020 2020 6173 7365 7274 206e 6f74 2068      assert not h
-00027070: 6173 6174 7472 2844 6174 6146 7261 6d65  asattr(DataFrame
-00027080: 2c20 6e61 6d65 292c 206e 616d 650a 2020  , name), name.  
-00027090: 2020 7365 7461 7474 7228 4461 7461 4672    setattr(DataFr
-000270a0: 616d 652c 206e 616d 652c 205f 7772 6170  ame, name, _wrap
-000270b0: 5f65 7870 725f 6d65 7468 6f64 5f6f 7065  _expr_method_ope
-000270c0: 7261 746f 7228 6e61 6d65 2c20 4461 7461  rator(name, Data
-000270d0: 4672 616d 6529 290a 0a20 2020 2061 7373  Frame))..    ass
-000270e0: 6572 7420 6e6f 7420 6861 7361 7474 7228  ert not hasattr(
-000270f0: 5365 7269 6573 2c20 6e61 6d65 292c 206e  Series, name), n
-00027100: 616d 650a 2020 2020 7365 7461 7474 7228  ame.    setattr(
-00027110: 5365 7269 6573 2c20 6e61 6d65 2c20 5f77  Series, name, _w
-00027120: 7261 705f 6578 7072 5f6d 6574 686f 645f  rap_expr_method_
-00027130: 6f70 6572 6174 6f72 286e 616d 652c 2053  operator(name, S
-00027140: 6572 6965 7329 290a 0a0a 636c 6173 7320  eries))...class 
-00027150: 496e 6465 7828 5365 7269 6573 293a 0a20  Index(Series):. 
-00027160: 2020 2022 2222 496e 6465 782d 6c69 6b65     """Index-like
-00027170: 2045 7870 7220 436f 6c6c 6563 7469 6f6e   Expr Collection
-00027180: 2222 220a 0a20 2020 205f 6163 6365 7373  """..    _access
-00027190: 6f72 733a 2043 6c61 7373 5661 725b 7365  ors: ClassVar[se
-000271a0: 745b 7374 725d 5d20 3d20 7365 7428 290a  t[str]] = set().
-000271b0: 2020 2020 5f70 6172 7469 7469 6f6e 5f74      _partition_t
-000271c0: 7970 6520 3d20 7064 2e49 6e64 6578 0a0a  ype = pd.Index..
-000271d0: 2020 2020 5f64 745f 6174 7472 6962 7574      _dt_attribut
-000271e0: 6573 203d 207b 0a20 2020 2020 2020 2022  es = {.        "
-000271f0: 6e61 6e6f 7365 636f 6e64 222c 0a20 2020  nanosecond",.   
-00027200: 2020 2020 2022 6d69 6372 6f73 6563 6f6e       "microsecon
-00027210: 6422 2c0a 2020 2020 2020 2020 226d 696c  d",.        "mil
-00027220: 6c69 7365 636f 6e64 222c 0a20 2020 2020  lisecond",.     
-00027230: 2020 2022 6461 796f 6679 6561 7222 2c0a     "dayofyear",.
-00027240: 2020 2020 2020 2020 226d 696e 7574 6522          "minute"
-00027250: 2c0a 2020 2020 2020 2020 2268 6f75 7222  ,.        "hour"
-00027260: 2c0a 2020 2020 2020 2020 2264 6179 222c  ,.        "day",
-00027270: 0a20 2020 2020 2020 2022 6461 796f 6677  .        "dayofw
-00027280: 6565 6b22 2c0a 2020 2020 2020 2020 2273  eek",.        "s
-00027290: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
-000272a0: 2277 6565 6b22 2c0a 2020 2020 2020 2020  "week",.        
-000272b0: 2277 6565 6b64 6179 222c 0a20 2020 2020  "weekday",.     
-000272c0: 2020 2022 7765 656b 6f66 7965 6172 222c     "weekofyear",
-000272d0: 0a20 2020 2020 2020 2022 6d6f 6e74 6822  .        "month"
-000272e0: 2c0a 2020 2020 2020 2020 2271 7561 7274  ,.        "quart
-000272f0: 6572 222c 0a20 2020 2020 2020 2022 7965  er",.        "ye
-00027300: 6172 222c 0a20 2020 207d 0a0a 2020 2020  ar",.    }..    
-00027310: 5f63 6174 5f61 7474 7269 6275 7465 7320  _cat_attributes 
-00027320: 3d20 7b0a 2020 2020 2020 2020 226b 6e6f  = {.        "kno
-00027330: 776e 222c 0a20 2020 2020 2020 2022 6173  wn",.        "as
-00027340: 5f6b 6e6f 776e 222c 0a20 2020 2020 2020  _known",.       
-00027350: 2022 6173 5f75 6e6b 6e6f 776e 222c 0a20   "as_unknown",. 
-00027360: 2020 2020 2020 2022 6164 645f 6361 7465         "add_cate
-00027370: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
-00027380: 2022 6361 7465 676f 7269 6573 222c 0a20   "categories",. 
-00027390: 2020 2020 2020 2022 7265 6d6f 7665 5f63         "remove_c
-000273a0: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-000273b0: 2020 2020 2272 656f 7264 6572 5f63 6174      "reorder_cat
-000273c0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
-000273d0: 2020 2261 735f 6f72 6465 7265 6422 2c0a    "as_ordered",.
-000273e0: 2020 2020 2020 2020 2263 6f64 6573 222c          "codes",
-000273f0: 0a20 2020 2020 2020 2022 7265 6d6f 7665  .        "remove
-00027400: 5f75 6e75 7365 645f 6361 7465 676f 7269  _unused_categori
-00027410: 6573 222c 0a20 2020 2020 2020 2022 7365  es",.        "se
-00027420: 745f 6361 7465 676f 7269 6573 222c 0a20  t_categories",. 
-00027430: 2020 2020 2020 2022 6173 5f75 6e6f 7264         "as_unord
-00027440: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
-00027450: 6f72 6465 7265 6422 2c0a 2020 2020 2020  ordered",.      
-00027460: 2020 2272 656e 616d 655f 6361 7465 676f    "rename_catego
-00027470: 7269 6573 222c 0a20 2020 207d 0a0a 2020  ries",.    }..  
-00027480: 2020 6465 6620 5f5f 6765 7461 7474 725f    def __getattr_
-00027490: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
-000274a0: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-000274b0: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-000274c0: 6528 7365 6c66 2e5f 6d65 7461 2e64 7479  e(self._meta.dty
-000274d0: 7065 2c20 7064 2e43 6174 6567 6f72 6963  pe, pd.Categoric
-000274e0: 616c 4474 7970 6529 0a20 2020 2020 2020  alDtype).       
-000274f0: 2020 2020 2061 6e64 206b 6579 2069 6e20       and key in 
-00027500: 7365 6c66 2e5f 6361 745f 6174 7472 6962  self._cat_attrib
-00027510: 7574 6573 0a20 2020 2020 2020 2029 3a0a  utes.        ):.
-00027520: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00027530: 726e 2067 6574 6174 7472 2873 656c 662e  rn getattr(self.
-00027540: 6361 742c 206b 6579 290a 2020 2020 2020  cat, key).      
-00027550: 2020 656c 6966 206b 6579 2069 6e20 7365    elif key in se
-00027560: 6c66 2e5f 6474 5f61 7474 7269 6275 7465  lf._dt_attribute
-00027570: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-00027580: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
-00027590: 6c66 2e64 742c 206b 6579 290a 0a20 2020  lf.dt, key)..   
-000275a0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
-000275b0: 7375 7065 7228 292c 206b 6579 293a 2020  super(), key):  
-000275c0: 2320 446f 6573 6e27 7420 7472 6967 6765  # Doesn't trigge
-000275d0: 7220 7375 7065 7228 292e 5f5f 6765 7461  r super().__geta
-000275e0: 7474 725f 5f0a 2020 2020 2020 2020 2020  ttr__.          
-000275f0: 2020 2320 4e6f 7420 6120 6d61 6769 6320    # Not a magic 
-00027600: 6174 7472 6962 7574 652e 2054 6869 7320  attribute. This 
-00027610: 6973 2061 2072 6561 6c20 6d65 7468 6f64  is a real method
-00027620: 206f 7220 7072 6f70 6572 7479 206f 6620   or property of 
-00027630: 5365 7269 6573 2074 6861 740a 2020 2020  Series that.    
-00027640: 2020 2020 2020 2020 2320 6861 7320 6265          # has be
-00027650: 656e 206f 7665 7272 6964 6465 6e20 6279  en overridden by
-00027660: 2052 6169 7365 4174 7472 6962 7574 6545   RaiseAttributeE
-00027670: 7272 6f72 2829 2e0a 2020 2020 2020 2020  rror()..        
-00027680: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
-00027690: 7574 6545 7272 6f72 280a 2020 2020 2020  uteError(.      
-000276a0: 2020 2020 2020 2020 2020 6622 7b73 656c            f"{sel
-000276b0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-000276c0: 6d65 5f5f 2172 7d20 6f62 6a65 6374 2068  me__!r} object h
-000276d0: 6173 206e 6f20 6174 7472 6962 7574 6520  as no attribute 
-000276e0: 7b6b 6579 2172 7d22 0a20 2020 2020 2020  {key!r}".       
-000276f0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00027700: 6574 7572 6e20 7375 7065 7228 292e 5f5f  eturn super().__
-00027710: 6765 7461 7474 725f 5f28 6b65 7929 0a0a  getattr__(key)..
-00027720: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
-00027730: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00027740: 7265 7475 726e 2066 223c 6461 736b 5f65  return f"<dask_e
-00027750: 7870 722e 6578 7072 2e49 6e64 6578 3a20  xpr.expr.Index: 
-00027760: 6578 7072 3d7b 7365 6c66 2e65 7870 727d  expr={self.expr}
-00027770: 3e22 0a0a 2020 2020 6465 6620 5f5f 6172  >"..    def __ar
-00027780: 7261 795f 7772 6170 5f5f 2873 656c 662c  ray_wrap__(self,
-00027790: 2061 7272 6179 2c20 636f 6e74 6578 743d   array, context=
-000277a0: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
-000277b0: 6574 7572 6e20 7064 2e49 6e64 6578 2861  eturn pd.Index(a
-000277c0: 7272 6179 2c20 6e61 6d65 3d73 656c 662e  rray, name=self.
-000277d0: 6e61 6d65 290a 0a20 2020 2040 6465 7269  name)..    @deri
-000277e0: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
-000277f0: 7829 0a20 2020 2064 6566 2074 6f5f 7365  x).    def to_se
-00027800: 7269 6573 2873 656c 662c 2069 6e64 6578  ries(self, index
-00027810: 3d4e 6f6e 652c 206e 616d 653d 6e6f 5f64  =None, name=no_d
-00027820: 6566 6175 6c74 293a 0a20 2020 2020 2020  efault):.       
-00027830: 2069 6620 696e 6465 7820 6973 206e 6f74   if index is not
-00027840: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00027850: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00027860: 656d 656e 7465 6445 7272 6f72 0a20 2020  ementedError.   
-00027870: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00027880: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
-00027890: 546f 5365 7269 6573 496e 6465 7828 7365  ToSeriesIndex(se
-000278a0: 6c66 2c20 696e 6465 783d 696e 6465 782c  lf, index=index,
-000278b0: 206e 616d 653d 6e61 6d65 2929 0a0a 2020   name=name))..  
-000278c0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000278d0: 7064 2e49 6e64 6578 2c20 7561 5f61 7267  pd.Index, ua_arg
-000278e0: 733d 5b22 696e 6465 7822 5d29 0a20 2020  s=["index"]).   
-000278f0: 2064 6566 2074 6f5f 6672 616d 6528 7365   def to_frame(se
-00027900: 6c66 2c20 696e 6465 783d 5472 7565 2c20  lf, index=True, 
-00027910: 6e61 6d65 3d6e 6f5f 6465 6661 756c 7429  name=no_default)
-00027920: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-00027930: 2069 6e64 6578 3a0a 2020 2020 2020 2020   index:.        
-00027940: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-00027950: 6c65 6d65 6e74 6564 4572 726f 720a 2020  lementedError.  
-00027960: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00027970: 5f63 6f6c 6c65 6374 696f 6e28 6578 7072  _collection(expr
-00027980: 2e54 6f46 7261 6d65 496e 6465 7828 7365  .ToFrameIndex(se
-00027990: 6c66 2c20 696e 6465 783d 696e 6465 782c  lf, index=index,
-000279a0: 206e 616d 653d 6e61 6d65 2929 0a0a 2020   name=name))..  
-000279b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000279c0: 7064 2e49 6e64 6578 290a 2020 2020 6465  pd.Index).    de
-000279d0: 6620 6d65 6d6f 7279 5f75 7361 6765 2873  f memory_usage(s
-000279e0: 656c 662c 2064 6565 703d 4661 6c73 6529  elf, deep=False)
-000279f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00027a00: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-00027a10: 4d65 6d6f 7279 5573 6167 6549 6e64 6578  MemoryUsageIndex
-00027a20: 2873 656c 662c 2064 6565 703d 6465 6570  (self, deep=deep
-00027a30: 2929 0a0a 2020 2020 6465 6620 7368 6966  ))..    def shif
-00027a40: 7428 7365 6c66 2c20 7065 7269 6f64 733d  t(self, periods=
-00027a50: 312c 2066 7265 713d 4e6f 6e65 293a 0a20  1, freq=None):. 
-00027a60: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00027a70: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
-00027a80: 722e 5368 6966 7449 6e64 6578 2873 656c  r.ShiftIndex(sel
-00027a90: 662c 2070 6572 696f 6473 2c20 6672 6571  f, periods, freq
-00027aa0: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
-00027ab0: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
-00027ac0: 2020 2020 6465 6620 6d61 7028 7365 6c66      def map(self
-00027ad0: 2c20 6172 672c 206e 615f 6163 7469 6f6e  , arg, na_action
-00027ae0: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
-00027af0: 2c20 6973 5f6d 6f6e 6f74 6f6e 6963 3d46  , is_monotonic=F
-00027b00: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00027b10: 2222 0a20 2020 2020 2020 204e 6f74 6520  "".        Note 
-00027b20: 7468 6174 2074 6869 7320 6d65 7468 6f64  that this method
-00027b30: 2063 6c65 6172 7320 616e 7920 6b6e 6f77   clears any know
-00027b40: 6e20 6469 7669 7369 6f6e 732e 0a0a 2020  n divisions...  
-00027b50: 2020 2020 2020 4966 2079 6f75 7220 6d61        If your ma
-00027b60: 7070 696e 6720 6675 6e63 7469 6f6e 2069  pping function i
-00027b70: 7320 6d6f 6e6f 746f 6e69 6361 6c6c 7920  s monotonically 
-00027b80: 696e 6372 6561 7369 6e67 2074 6865 6e20  increasing then 
-00027b90: 7573 6520 6069 735f 6d6f 6e6f 746f 6e69  use `is_monotoni
-00027ba0: 6360 0a20 2020 2020 2020 2074 6f20 6170  c`.        to ap
-00027bb0: 706c 7920 7468 6520 6d61 7069 6e67 2066  ply the maping f
-00027bc0: 756e 6374 696f 6e20 746f 2074 6865 206f  unction to the o
-00027bd0: 6c64 2064 6976 6973 696f 6e73 2061 6e64  ld divisions and
-00027be0: 2061 7373 6967 6e20 7468 6520 6e65 770a   assign the new.
-00027bf0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-00027c00: 7320 746f 2074 6865 206f 7574 7075 742e  s to the output.
-00027c10: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00027c20: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00027c30: 6e63 6528 6172 672c 2053 6572 6965 7329  nce(arg, Series)
-00027c40: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00027c50: 206e 6f74 2065 7870 722e 6172 655f 636f   not expr.are_co
-00027c60: 5f61 6c69 676e 6564 2873 656c 662e 6578  _aligned(self.ex
-00027c70: 7072 2c20 6172 672e 6578 7072 293a 0a20  pr, arg.expr):. 
-00027c80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00027c90: 6620 6d65 7461 2069 7320 4e6f 6e65 3a0a  f meta is None:.
-00027ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027cb0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00027cc0: 6e28 6d65 7461 5f77 6172 6e69 6e67 286d  n(meta_warning(m
-00027cd0: 6574 6129 290a 2020 2020 2020 2020 2020  eta)).          
-00027ce0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-00027cf0: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
-00027d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027d10: 2065 7870 722e 4d61 7049 6e64 6578 416c   expr.MapIndexAl
-00027d20: 6967 6e28 7365 6c66 2c20 6172 672c 206e  ign(self, arg, n
-00027d30: 615f 6163 7469 6f6e 2c20 6d65 7461 2c20  a_action, meta, 
-00027d40: 6973 5f6d 6f6e 6f74 6f6e 6963 290a 2020  is_monotonic).  
-00027d50: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00027d60: 2020 2020 2020 2020 6966 206d 6574 6120          if meta 
-00027d70: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00027d80: 2020 2020 206d 6574 6120 3d20 6578 7072       meta = expr
-00027d90: 2e5f 656d 756c 6174 6528 4d2e 6d61 702c  ._emulate(M.map,
-00027da0: 2073 656c 662c 2061 7267 2c20 6e61 5f61   self, arg, na_a
-00027db0: 6374 696f 6e3d 6e61 5f61 6374 696f 6e2c  ction=na_action,
-00027dc0: 2075 6466 3d54 7275 6529 0a20 2020 2020   udf=True).     
-00027dd0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00027de0: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
-00027df0: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
-00027e00: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00027e10: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-00027e20: 2020 2020 6578 7072 2e4d 6170 280a 2020      expr.Map(.  
-00027e30: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00027e40: 6c66 2c20 6172 673d 6172 672c 206e 615f  lf, arg=arg, na_
-00027e50: 6163 7469 6f6e 3d6e 615f 6163 7469 6f6e  action=na_action
-00027e60: 2c20 6d65 7461 3d6d 6574 612c 2069 735f  , meta=meta, is_
-00027e70: 6d6f 6e6f 746f 6e69 633d 6973 5f6d 6f6e  monotonic=is_mon
-00027e80: 6f74 6f6e 6963 0a20 2020 2020 2020 2020  otonic.         
-00027e90: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
-00027ea0: 2020 2020 6465 6620 5f5f 6469 725f 5f28      def __dir__(
-00027eb0: 7365 6c66 293a 0a20 2020 2020 2020 206f  self):.        o
-00027ec0: 203d 2073 6574 2864 6972 2874 7970 6528   = set(dir(type(
-00027ed0: 7365 6c66 2929 290a 2020 2020 2020 2020  self))).        
-00027ee0: 6f2e 7570 6461 7465 2873 656c 662e 5f5f  o.update(self.__
-00027ef0: 6469 6374 5f5f 290a 2020 2020 2020 2020  dict__).        
-00027f00: 6f2e 7570 6461 7465 2873 6574 2864 6972  o.update(set(dir
-00027f10: 2865 7870 722e 4578 7072 2929 290a 2020  (expr.Expr))).  
-00027f20: 2020 2020 2020 6f2e 7570 6461 7465 2873        o.update(s
-00027f30: 656c 662e 5f64 745f 6174 7472 6962 7574  elf._dt_attribut
-00027f40: 6573 290a 2020 2020 2020 2020 6966 2069  es).        if i
-00027f50: 7369 6e73 7461 6e63 6528 7365 6c66 2e64  sinstance(self.d
-00027f60: 7479 7065 2c20 7064 2e43 6174 6567 6f72  type, pd.Categor
-00027f70: 6963 616c 4474 7970 6529 3a0a 2020 2020  icalDtype):.    
-00027f80: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
-00027f90: 2873 656c 662e 5f63 6174 5f61 7474 7269  (self._cat_attri
-00027fa0: 6275 7465 7329 0a20 2020 2020 2020 2072  butes).        r
-00027fb0: 6574 7572 6e20 6c69 7374 286f 290a 0a20  eturn list(o).. 
-00027fc0: 2020 2023 204d 6574 686f 6473 2061 6e64     # Methods and
-00027fd0: 2070 726f 7065 7274 6965 7320 6f66 2053   properties of S
-00027fe0: 6572 6965 7320 7468 6174 2061 7265 206e  eries that are n
-00027ff0: 6f74 2069 6d70 6c65 6d65 6e74 6564 206f  ot implemented o
-00028000: 6e20 496e 6465 780a 0a20 2020 2064 6566  n Index..    def
-00028010: 2063 6f75 6e74 2873 656c 662c 2073 706c   count(self, spl
-00028020: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
-00028030: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00028040: 6e65 775f 636f 6c6c 6563 7469 6f6e 2849  new_collection(I
-00028050: 6e64 6578 436f 756e 7428 7365 6c66 2c20  ndexCount(self, 
-00028060: 7370 6c69 745f 6576 6572 7929 290a 0a20  split_every)).. 
-00028070: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00028080: 2064 6566 2069 6e64 6578 2873 656c 6629   def index(self)
-00028090: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-000280a0: 4174 7472 6962 7574 6545 7272 6f72 2822  AttributeError("
-000280b0: 2749 6e64 6578 2720 6f62 6a65 6374 2068  'Index' object h
-000280c0: 6173 206e 6f20 6174 7472 6962 7574 6520  as no attribute 
-000280d0: 2769 6e64 6578 2722 290a 0a20 2020 2064  'index'")..    d
-000280e0: 6566 2073 756d 2873 656c 662c 202a 6172  ef sum(self, *ar
-000280f0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-00028100: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-00028110: 7269 6275 7465 4572 726f 7228 2227 496e  ributeError("'In
-00028120: 6465 7827 206f 626a 6563 7420 6861 7320  dex' object has 
-00028130: 6e6f 2061 7474 7269 6275 7465 2027 7375  no attribute 'su
-00028140: 6d27 2229 0a0a 2020 2020 6465 6620 7072  m'")..    def pr
-00028150: 6f64 2873 656c 662c 202a 6172 6773 2c20  od(self, *args, 
-00028160: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-00028170: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
-00028180: 7465 4572 726f 7228 2227 496e 6465 7827  teError("'Index'
-00028190: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
-000281a0: 7474 7269 6275 7465 2027 7072 6f64 2722  ttribute 'prod'"
-000281b0: 290a 0a20 2020 2064 6566 206d 6561 6e28  )..    def mean(
-000281c0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-000281d0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-000281e0: 7261 6973 6520 4174 7472 6962 7574 6545  raise AttributeE
-000281f0: 7272 6f72 2822 2749 6e64 6578 2720 6f62  rror("'Index' ob
-00028200: 6a65 6374 2068 6173 206e 6f20 6174 7472  ject has no attr
-00028210: 6962 7574 6520 276d 6561 6e27 2229 0a0a  ibute 'mean'")..
-00028220: 2020 2020 6465 6620 7374 6428 7365 6c66      def std(self
-00028230: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00028240: 7329 3a0a 2020 2020 2020 2020 7261 6973  s):.        rais
-00028250: 6520 4174 7472 6962 7574 6545 7272 6f72  e AttributeError
-00028260: 2822 2749 6e64 6578 2720 6f62 6a65 6374  ("'Index' object
-00028270: 2068 6173 206e 6f20 6174 7472 6962 7574   has no attribut
-00028280: 6520 2773 7464 2722 290a 0a20 2020 2064  e 'std'")..    d
-00028290: 6566 2076 6172 2873 656c 662c 202a 6172  ef var(self, *ar
-000282a0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
-000282b0: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-000282c0: 7269 6275 7465 4572 726f 7228 2227 496e  ributeError("'In
-000282d0: 6465 7827 206f 626a 6563 7420 6861 7320  dex' object has 
-000282e0: 6e6f 2061 7474 7269 6275 7465 2027 7661  no attribute 'va
-000282f0: 7227 2229 0a0a 2020 2020 6465 6620 6964  r'")..    def id
-00028300: 786d 6178 2873 656c 662c 202a 6172 6773  xmax(self, *args
-00028310: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00028320: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
-00028330: 6275 7465 4572 726f 7228 2227 496e 6465  buteError("'Inde
-00028340: 7827 206f 626a 6563 7420 6861 7320 6e6f  x' object has no
-00028350: 2061 7474 7269 6275 7465 2027 6964 786d   attribute 'idxm
-00028360: 6178 2722 290a 0a20 2020 2064 6566 2069  ax'")..    def i
-00028370: 6478 6d69 6e28 7365 6c66 2c20 2a61 7267  dxmin(self, *arg
-00028380: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
-00028390: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
-000283a0: 6962 7574 6545 7272 6f72 2822 2749 6e64  ibuteError("'Ind
-000283b0: 6578 2720 6f62 6a65 6374 2068 6173 206e  ex' object has n
-000283c0: 6f20 6174 7472 6962 7574 6520 2769 6478  o attribute 'idx
-000283d0: 6d69 6e27 2229 0a0a 0a63 6c61 7373 2053  min'")...class S
-000283e0: 6361 6c61 7228 4672 616d 6542 6173 6529  calar(FrameBase)
-000283f0: 3a0a 2020 2020 2222 2253 6361 6c61 7220  :.    """Scalar 
-00028400: 4578 7072 2043 6f6c 6c65 6374 696f 6e22  Expr Collection"
-00028410: 2222 0a0a 2020 2020 6465 6620 5f5f 7265  ""..    def __re
-00028420: 7072 5f5f 2873 656c 6629 3a0a 2020 2020  pr__(self):.    
-00028430: 2020 2020 7265 7475 726e 2066 223c 6461      return f"<da
-00028440: 736b 5f65 7870 722e 6578 7072 2e53 6361  sk_expr.expr.Sca
-00028450: 6c61 723a 2065 7870 723d 7b73 656c 662e  lar: expr={self.
-00028460: 6578 7072 7d2c 2064 7479 7065 3d7b 7365  expr}, dtype={se
-00028470: 6c66 2e64 7479 7065 7d3e 220a 0a20 2020  lf.dtype}>"..   
-00028480: 2064 6566 205f 5f62 6f6f 6c5f 5f28 7365   def __bool__(se
-00028490: 6c66 293a 0a20 2020 2020 2020 2072 6169  lf):.        rai
-000284a0: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-000284b0: 2020 2020 2020 2020 2020 6622 5472 7969            f"Tryi
-000284c0: 6e67 2074 6f20 636f 6e76 6572 7420 7b73  ng to convert {s
-000284d0: 656c 667d 2074 6f20 6120 626f 6f6c 6561  elf} to a boolea
-000284e0: 6e20 7661 6c75 652e 2042 6563 6175 7365  n value. Because
-000284f0: 2044 6173 6b20 6f62 6a65 6374 7320 6172   Dask objects ar
-00028500: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
-00028510: 226c 617a 696c 7920 6576 616c 7561 7465  "lazily evaluate
-00028520: 642c 2074 6865 7920 6361 6e6e 6f74 2062  d, they cannot b
-00028530: 6520 636f 6e76 6572 7465 6420 746f 2061  e converted to a
-00028540: 2062 6f6f 6c65 616e 2076 616c 7565 206f   boolean value o
-00028550: 7220 7573 6564 2022 0a20 2020 2020 2020  r used ".       
-00028560: 2020 2020 2022 696e 2062 6f6f 6c65 616e       "in boolean
-00028570: 2063 6f6e 6469 7469 6f6e 7320 6c69 6b65   conditions like
-00028580: 2069 6620 7374 6174 656d 656e 7473 2e20   if statements. 
-00028590: 5472 7920 6361 6c6c 696e 6720 2e63 6f6d  Try calling .com
-000285a0: 7075 7465 2829 2074 6f20 220a 2020 2020  pute() to ".    
-000285b0: 2020 2020 2020 2020 2266 6f72 6365 2063          "force c
-000285c0: 6f6d 7075 7461 7469 6f6e 2070 7269 6f72  omputation prior
-000285d0: 2074 6f20 636f 6e76 6572 7469 6e67 2074   to converting t
-000285e0: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
-000285f0: 6520 6f72 2075 7369 6e67 2069 6e20 220a  e or using in ".
-00028600: 2020 2020 2020 2020 2020 2020 2261 2063              "a c
-00028610: 6f6e 6469 7469 6f6e 616c 2073 7461 7465  onditional state
-00028620: 6d65 6e74 2e22 0a20 2020 2020 2020 2029  ment.".        )
-00028630: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
-00028640: 5f70 6f73 7463 6f6d 7075 7465 5f5f 2873  _postcompute__(s
-00028650: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00028660: 7475 726e 2066 6972 7374 2c20 2829 0a0a  turn first, ()..
-00028670: 2020 2020 6465 6620 746f 5f73 6572 6965      def to_serie
-00028680: 7328 7365 6c66 2c20 696e 6465 783d 3029  s(self, index=0)
-00028690: 202d 3e20 5365 7269 6573 3a0a 2020 2020   -> Series:.    
-000286a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
-000286b0: 6f6c 6c65 6374 696f 6e28 6578 7072 2e53  ollection(expr.S
-000286c0: 6361 6c61 7254 6f53 6572 6965 7328 7365  calarToSeries(se
-000286d0: 6c66 2c20 696e 6465 783d 696e 6465 7829  lf, index=index)
-000286e0: 290a 0a20 2020 2064 6566 205f 5f61 7272  )..    def __arr
-000286f0: 6179 5f5f 2873 656c 6629 3a0a 2020 2020  ay__(self):.    
-00028700: 2020 2020 2320 6172 7261 7920 696e 7465      # array inte
-00028710: 7266 6163 6520 6973 2072 6571 7569 7265  rface is require
-00028720: 6420 746f 2073 7570 706f 7274 2070 616e  d to support pan
-00028730: 6461 7320 696e 7374 616e 6365 202b 2053  das instance + S
-00028740: 6361 6c61 720a 2020 2020 2020 2020 2320  calar.        # 
-00028750: 4f74 6865 7277 6973 652c 2061 626f 7665  Otherwise, above
-00028760: 206f 7020 7265 7375 6c74 7320 696e 2070   op results in p
-00028770: 642e 5365 7269 6573 206f 6620 5363 616c  d.Series of Scal
-00028780: 6172 2028 6f62 6a65 6374 2064 7479 7065  ar (object dtype
-00028790: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000287a0: 206e 702e 6173 6172 7261 7928 7365 6c66   np.asarray(self
-000287b0: 2e63 6f6d 7075 7465 2829 290a 0a20 2020  .compute())..   
-000287c0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000287d0: 6566 2064 7479 7065 2873 656c 6629 3a0a  ef dtype(self):.
-000287e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000287f0: 656c 662e 5f6d 6574 612e 6474 7970 650a  elf._meta.dtype.
-00028800: 0a0a 6465 6620 6e65 775f 636f 6c6c 6563  ..def new_collec
-00028810: 7469 6f6e 2865 7870 7229 3a0a 2020 2020  tion(expr):.    
-00028820: 2222 2243 7265 6174 6520 6e65 7720 636f  """Create new co
-00028830: 6c6c 6563 7469 6f6e 2066 726f 6d20 616e  llection from an
-00028840: 2065 7870 7222 2222 0a20 2020 206d 6574   expr""".    met
-00028850: 6120 3d20 6578 7072 2e5f 6d65 7461 0a20  a = expr._meta. 
-00028860: 2020 2065 7870 722e 5f6e 616d 6520 2023     expr._name  #
-00028870: 2045 6e73 7572 6520 6261 636b 656e 6420   Ensure backend 
-00028880: 6973 2069 6d70 6f72 7465 640a 2020 2020  is imported.    
-00028890: 7265 7475 726e 2067 6574 5f63 6f6c 6c65  return get_colle
-000288a0: 6374 696f 6e5f 7479 7065 286d 6574 6129  ction_type(meta)
-000288b0: 2865 7870 7229 0a0a 0a64 6566 206f 7074  (expr)...def opt
-000288c0: 696d 697a 6528 636f 6c6c 6563 7469 6f6e  imize(collection
-000288d0: 2c20 6675 7365 3d54 7275 6529 3a0a 2020  , fuse=True):.  
-000288e0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-000288f0: 6c65 6374 696f 6e28 6578 7072 2e6f 7074  lection(expr.opt
-00028900: 696d 697a 6528 636f 6c6c 6563 7469 6f6e  imize(collection
-00028910: 2e65 7870 722c 2066 7573 653d 6675 7365  .expr, fuse=fuse
-00028920: 2929 0a0a 0a64 6566 2066 726f 6d5f 7061  ))...def from_pa
-00028930: 6e64 6173 2864 6174 612c 206e 7061 7274  ndas(data, npart
-00028940: 6974 696f 6e73 3d4e 6f6e 652c 2073 6f72  itions=None, sor
-00028950: 743d 5472 7565 2c20 6368 756e 6b73 697a  t=True, chunksiz
-00028960: 653d 4e6f 6e65 293a 0a20 2020 2069 6620  e=None):.    if 
-00028970: 6368 756e 6b73 697a 6520 6973 206e 6f74  chunksize is not
-00028980: 204e 6f6e 6520 616e 6420 6e70 6172 7469   None and nparti
-00028990: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
-000289a0: 653a 0a20 2020 2020 2020 2072 6169 7365  e:.        raise
-000289b0: 2056 616c 7565 4572 726f 7228 2245 7861   ValueError("Exa
-000289c0: 6374 6c79 206f 6e65 206f 6620 6e70 6172  ctly one of npar
-000289d0: 7469 7469 6f6e 7320 616e 6420 6368 756e  titions and chun
-000289e0: 6b73 697a 6520 6d75 7374 2062 6520 7370  ksize must be sp
-000289f0: 6563 6966 6965 642e 2229 0a20 2020 2065  ecified.").    e
-00028a00: 6c69 6620 6368 756e 6b73 697a 6520 6973  lif chunksize is
-00028a10: 204e 6f6e 6520 616e 6420 6e70 6172 7469   None and nparti
-00028a20: 7469 6f6e 7320 6973 204e 6f6e 653a 0a20  tions is None:. 
-00028a30: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-00028a40: 6e73 203d 2031 0a0a 2020 2020 6966 206e  ns = 1..    if n
-00028a50: 6f74 2068 6173 5f70 6172 616c 6c65 6c5f  ot has_parallel_
-00028a60: 7479 7065 2864 6174 6129 3a0a 2020 2020  type(data):.    
-00028a70: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00028a80: 726f 7228 2249 6e70 7574 206d 7573 7420  ror("Input must 
-00028a90: 6265 2061 2070 616e 6461 7320 4461 7461  be a pandas Data
-00028aa0: 4672 616d 6520 6f72 2053 6572 6965 732e  Frame or Series.
-00028ab0: 2229 0a0a 2020 2020 6966 2064 6174 612e  ")..    if data.
-00028ac0: 696e 6465 782e 6973 6e61 2829 2e61 6e79  index.isna().any
-00028ad0: 2829 2061 6e64 206e 6f74 205f 6973 5f61  () and not _is_a
-00028ae0: 6e79 5f72 6561 6c5f 6e75 6d65 7269 635f  ny_real_numeric_
-00028af0: 6474 7970 6528 6461 7461 2e69 6e64 6578  dtype(data.index
-00028b00: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-00028b10: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00028b20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00028b30: 2020 2249 6e64 6578 2069 6e20 7061 7373    "Index in pass
-00028b40: 6564 2064 6174 6120 6973 206e 6f6e 2d6e  ed data is non-n
-00028b50: 756d 6572 6963 2061 6e64 2063 6f6e 7461  umeric and conta
-00028b60: 696e 7320 6e75 6c6c 732c 2077 6869 6368  ins nulls, which
-00028b70: 2044 6173 6b20 646f 6573 206e 6f74 2065   Dask does not e
-00028b80: 6e74 6972 656c 7920 7375 7070 6f72 742e  ntirely support.
-00028b90: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
-00028ba0: 2243 6f6e 7369 6465 7220 7061 7373 696e  "Consider passin
-00028bb0: 6720 6064 6174 612e 6c6f 635b 7e64 6174  g `data.loc[~dat
-00028bc0: 612e 6973 6e61 2829 5d60 2069 6e73 7465  a.isna()]` inste
-00028bd0: 6164 2e22 0a20 2020 2020 2020 2029 0a0a  ad.".        )..
-00028be0: 2020 2020 6966 206e 7061 7274 6974 696f      if npartitio
-00028bf0: 6e73 2069 7320 6e6f 7420 4e6f 6e65 2061  ns is not None a
-00028c00: 6e64 206e 6f74 2069 7369 6e73 7461 6e63  nd not isinstanc
-00028c10: 6528 6e70 6172 7469 7469 6f6e 732c 2069  e(npartitions, i
-00028c20: 6e74 293a 0a20 2020 2020 2020 2072 6169  nt):.        rai
-00028c30: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00028c40: 2020 2020 2020 2020 2020 2250 6c65 6173            "Pleas
-00028c50: 6520 7072 6f76 6964 6520 6e70 6172 7469  e provide nparti
-00028c60: 7469 6f6e 7320 6173 2061 6e20 696e 742c  tions as an int,
-00028c70: 206f 7220 706f 7373 6962 6c79 2061 7320   or possibly as 
-00028c80: 4e6f 6e65 2069 6620 796f 7520 7370 6563  None if you spec
-00028c90: 6966 7920 6368 756e 6b73 697a 652e 220a  ify chunksize.".
-00028ca0: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
-00028cb0: 6966 2063 6875 6e6b 7369 7a65 2069 7320  if chunksize is 
-00028cc0: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
-00028cd0: 2069 7369 6e73 7461 6e63 6528 6368 756e   isinstance(chun
-00028ce0: 6b73 697a 652c 2069 6e74 293a 0a20 2020  ksize, int):.   
-00028cf0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00028d00: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00028d10: 2020 2250 6c65 6173 6520 7072 6f76 6964    "Please provid
-00028d20: 6520 6368 756e 6b73 697a 6520 6173 2061  e chunksize as a
-00028d30: 6e20 696e 742c 206f 7220 706f 7373 6962  n int, or possib
-00028d40: 6c79 2061 7320 4e6f 6e65 2069 6620 796f  ly as None if yo
-00028d50: 7520 7370 6563 6966 7920 6e70 6172 7469  u specify nparti
-00028d60: 7469 6f6e 732e 220a 2020 2020 2020 2020  tions.".        
-00028d70: 290a 0a20 2020 2066 726f 6d20 6461 736b  )..    from dask
-00028d80: 5f65 7870 722e 696f 2e69 6f20 696d 706f  _expr.io.io impo
-00028d90: 7274 2046 726f 6d50 616e 6461 730a 0a20  rt FromPandas.. 
-00028da0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
-00028db0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
-00028dc0: 2020 4672 6f6d 5061 6e64 6173 280a 2020    FromPandas(.  
-00028dd0: 2020 2020 2020 2020 2020 5f42 6163 6b65            _Backe
-00028de0: 6e64 4461 7461 2864 6174 612e 636f 7079  ndData(data.copy
-00028df0: 2829 292c 0a20 2020 2020 2020 2020 2020  ()),.           
-00028e00: 206e 7061 7274 6974 696f 6e73 3d6e 7061   npartitions=npa
-00028e10: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
-00028e20: 2020 2020 2020 736f 7274 3d73 6f72 742c        sort=sort,
-00028e30: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00028e40: 6e6b 7369 7a65 3d63 6875 6e6b 7369 7a65  nksize=chunksize
-00028e50: 2c0a 2020 2020 2020 2020 2020 2020 7079  ,.            py
-00028e60: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
-00028e70: 6162 6c65 643d 7079 6172 726f 775f 7374  abled=pyarrow_st
-00028e80: 7269 6e67 735f 656e 6162 6c65 6428 292c  rings_enabled(),
-00028e90: 0a20 2020 2020 2020 2029 0a20 2020 2029  .        ).    )
-00028ea0: 0a0a 0a64 6566 2066 726f 6d5f 6172 7261  ...def from_arra
-00028eb0: 7928 6172 722c 2063 6875 6e6b 7369 7a65  y(arr, chunksize
-00028ec0: 3d35 305f 3030 302c 2063 6f6c 756d 6e73  =50_000, columns
-00028ed0: 3d4e 6f6e 652c 206d 6574 613d 4e6f 6e65  =None, meta=None
-00028ee0: 293a 0a20 2020 2069 6d70 6f72 7420 6461  ):.    import da
-00028ef0: 736b 2e61 7272 6179 2061 7320 6461 0a0a  sk.array as da..
-00028f00: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00028f10: 6528 6172 722c 2064 612e 4172 7261 7929  e(arr, da.Array)
-00028f20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00028f30: 2066 726f 6d5f 6461 736b 5f61 7272 6179   from_dask_array
-00028f40: 2861 7272 2c20 636f 6c75 6d6e 733d 636f  (arr, columns=co
-00028f50: 6c75 6d6e 732c 206d 6574 613d 6d65 7461  lumns, meta=meta
-00028f60: 290a 0a20 2020 2066 726f 6d20 6461 736b  )..    from dask
-00028f70: 5f65 7870 722e 696f 2e69 6f20 696d 706f  _expr.io.io impo
-00028f80: 7274 2046 726f 6d41 7272 6179 0a0a 2020  rt FromArray..  
-00028f90: 2020 7265 7375 6c74 203d 2046 726f 6d41    result = FromA
-00028fa0: 7272 6179 280a 2020 2020 2020 2020 6172  rray(.        ar
-00028fb0: 722c 0a20 2020 2020 2020 2063 6875 6e6b  r,.        chunk
-00028fc0: 7369 7a65 3d63 6875 6e6b 7369 7a65 2c0a  size=chunksize,.
-00028fd0: 2020 2020 2020 2020 6f72 6967 696e 616c          original
-00028fe0: 5f63 6f6c 756d 6e73 3d63 6f6c 756d 6e73  _columns=columns
-00028ff0: 2c0a 2020 2020 2020 2020 6d65 7461 3d6d  ,.        meta=m
-00029000: 6574 612c 0a20 2020 2029 0a20 2020 2069  eta,.    ).    i
-00029010: 6620 7079 6172 726f 775f 7374 7269 6e67  f pyarrow_string
-00029020: 735f 656e 6162 6c65 6428 2920 616e 6420  s_enabled() and 
-00029030: 6172 722e 6474 7970 652e 6b69 6e64 2069  arr.dtype.kind i
-00029040: 6e20 224f 5522 3a0a 2020 2020 2020 2020  n "OU":.        
-00029050: 7265 7375 6c74 203d 2065 7870 722e 4172  result = expr.Ar
-00029060: 726f 7753 7472 696e 6743 6f6e 7665 7273  rowStringConvers
-00029070: 696f 6e28 7265 7375 6c74 290a 2020 2020  ion(result).    
-00029080: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00029090: 6374 696f 6e28 7265 7375 6c74 290a 0a0a  ction(result)...
-000290a0: 6465 6620 6672 6f6d 5f67 7261 7068 282a  def from_graph(*
-000290b0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-000290c0: 0a20 2020 2066 726f 6d20 6461 736b 5f65  .    from dask_e
-000290d0: 7870 722e 696f 2e69 6f20 696d 706f 7274  xpr.io.io import
-000290e0: 2046 726f 6d47 7261 7068 0a0a 2020 2020   FromGraph..    
-000290f0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
-00029100: 6374 696f 6e28 4672 6f6d 4772 6170 6828  ction(FromGraph(
-00029110: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00029120: 290a 0a0a 4064 6174 6166 7261 6d65 5f63  )...@dataframe_c
-00029130: 7265 6174 696f 6e5f 6469 7370 6174 6368  reation_dispatch
-00029140: 2e72 6567 6973 7465 725f 696e 706c 6163  .register_inplac
-00029150: 6528 2270 616e 6461 7322 290a 6465 6620  e("pandas").def 
-00029160: 6672 6f6d 5f64 6963 7428 0a20 2020 2064  from_dict(.    d
-00029170: 6174 612c 0a20 2020 206e 7061 7274 6974  ata,.    npartit
-00029180: 696f 6e73 2c0a 2020 2020 6f72 6965 6e74  ions,.    orient
-00029190: 3d22 636f 6c75 6d6e 7322 2c0a 2020 2020  ="columns",.    
-000291a0: 6474 7970 653d 4e6f 6e65 2c0a 2020 2020  dtype=None,.    
-000291b0: 636f 6c75 6d6e 733d 4e6f 6e65 2c0a 2020  columns=None,.  
-000291c0: 2020 636f 6e73 7472 7563 746f 723d 7064    constructor=pd
-000291d0: 2e44 6174 6146 7261 6d65 2c0a 293a 0a20  .DataFrame,.):. 
-000291e0: 2020 2022 2222 0a20 2020 2043 6f6e 7374     """.    Const
-000291f0: 7275 6374 2061 2044 6173 6b20 4461 7461  ruct a Dask Data
-00029200: 4672 616d 6520 6672 6f6d 2061 2050 7974  Frame from a Pyt
-00029210: 686f 6e20 4469 6374 696f 6e61 7279 0a0a  hon Dictionary..
-00029220: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00029230: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00029240: 2020 6461 7461 203a 2064 6963 740a 2020    data : dict.  
-00029250: 2020 2020 2020 4f66 2074 6865 2066 6f72        Of the for
-00029260: 6d20 7b66 6965 6c64 203a 2061 7272 6179  m {field : array
-00029270: 2d6c 696b 657d 206f 7220 7b66 6965 6c64  -like} or {field
-00029280: 203a 2064 6963 747d 2e0a 2020 2020 6e70   : dict}..    np
-00029290: 6172 7469 7469 6f6e 7320 3a20 696e 740a  artitions : int.
-000292a0: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
-000292b0: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-000292c0: 206f 6620 7468 6520 696e 6465 7820 746f   of the index to
-000292d0: 2063 7265 6174 652e 204e 6f74 6520 7468   create. Note th
-000292e0: 6174 2064 6570 656e 6469 6e67 206f 6e0a  at depending on.
-000292f0: 2020 2020 2020 2020 7468 6520 7369 7a65          the size
-00029300: 2061 6e64 2069 6e64 6578 206f 6620 7468   and index of th
-00029310: 6520 6461 7461 6672 616d 652c 2074 6865  e dataframe, the
-00029320: 206f 7574 7075 7420 6d61 7920 6861 7665   output may have
-00029330: 2066 6577 6572 0a20 2020 2020 2020 2070   fewer.        p
-00029340: 6172 7469 7469 6f6e 7320 7468 616e 2072  artitions than r
-00029350: 6571 7565 7374 6564 2e0a 2020 2020 6f72  equested..    or
-00029360: 6965 6e74 203a 207b 2763 6f6c 756d 6e73  ient : {'columns
-00029370: 272c 2027 696e 6465 7827 2c20 2774 6967  ', 'index', 'tig
-00029380: 6874 277d 2c20 6465 6661 756c 7420 2763  ht'}, default 'c
-00029390: 6f6c 756d 6e73 270a 2020 2020 2020 2020  olumns'.        
-000293a0: 5468 6520 226f 7269 656e 7461 7469 6f6e  The "orientation
-000293b0: 2220 6f66 2074 6865 2064 6174 612e 2049  " of the data. I
-000293c0: 6620 7468 6520 6b65 7973 206f 6620 7468  f the keys of th
-000293d0: 6520 7061 7373 6564 2064 6963 740a 2020  e passed dict.  
-000293e0: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
-000293f0: 7468 6520 636f 6c75 6d6e 7320 6f66 2074  the columns of t
-00029400: 6865 2072 6573 756c 7469 6e67 2044 6174  he resulting Dat
-00029410: 6146 7261 6d65 2c20 7061 7373 2027 636f  aFrame, pass 'co
-00029420: 6c75 6d6e 7327 0a20 2020 2020 2020 2028  lumns'.        (
-00029430: 6465 6661 756c 7429 2e20 4f74 6865 7277  default). Otherw
-00029440: 6973 6520 6966 2074 6865 206b 6579 7320  ise if the keys 
-00029450: 7368 6f75 6c64 2062 6520 726f 7773 2c20  should be rows, 
-00029460: 7061 7373 2027 696e 6465 7827 2e0a 2020  pass 'index'..  
-00029470: 2020 2020 2020 4966 2027 7469 6768 7427        If 'tight'
-00029480: 2c20 6173 7375 6d65 2061 2064 6963 7420  , assume a dict 
-00029490: 7769 7468 206b 6579 730a 2020 2020 2020  with keys.      
-000294a0: 2020 5b27 696e 6465 7827 2c20 2763 6f6c    ['index', 'col
-000294b0: 756d 6e73 272c 2027 6461 7461 272c 2027  umns', 'data', '
-000294c0: 696e 6465 785f 6e61 6d65 7327 2c20 2763  index_names', 'c
-000294d0: 6f6c 756d 6e5f 6e61 6d65 7327 5d2e 0a20  olumn_names'].. 
-000294e0: 2020 2064 7479 7065 3a20 626f 6f6c 0a20     dtype: bool. 
-000294f0: 2020 2020 2020 2044 6174 6120 7479 7065         Data type
-00029500: 2074 6f20 666f 7263 652c 206f 7468 6572   to force, other
-00029510: 7769 7365 2069 6e66 6572 2e0a 2020 2020  wise infer..    
-00029520: 636f 6c75 6d6e 733a 2073 7472 696e 672c  columns: string,
-00029530: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00029540: 2020 436f 6c75 6d6e 206c 6162 656c 7320    Column labels 
-00029550: 746f 2075 7365 2077 6865 6e20 6060 6f72  to use when ``or
-00029560: 6965 6e74 3d27 696e 6465 7827 6060 2e20  ient='index'``. 
-00029570: 5261 6973 6573 2061 2056 616c 7565 4572  Raises a ValueEr
-00029580: 726f 720a 2020 2020 2020 2020 6966 2075  ror.        if u
-00029590: 7365 6420 7769 7468 2060 606f 7269 656e  sed with ``orien
-000295a0: 743d 2763 6f6c 756d 6e73 2760 6020 6f72  t='columns'`` or
-000295b0: 2060 606f 7269 656e 743d 2774 6967 6874   ``orient='tight
-000295c0: 2760 602e 0a20 2020 2063 6f6e 7374 7275  '``..    constru
-000295d0: 6374 6f72 3a20 636c 6173 732c 2064 6566  ctor: class, def
-000295e0: 6175 6c74 2070 642e 4461 7461 4672 616d  ault pd.DataFram
-000295f0: 650a 2020 2020 2020 2020 436c 6173 7320  e.        Class 
-00029600: 7769 7468 2077 6869 6368 2060 6066 726f  with which ``fro
-00029610: 6d5f 6469 6374 6060 2073 686f 756c 6420  m_dict`` should 
-00029620: 6265 2063 616c 6c65 6420 7769 7468 2e0a  be called with..
-00029630: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-00029640: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
-00029650: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
-00029660: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
-00029670: 2020 203e 3e3e 2064 6466 203d 2064 642e     >>> ddf = dd.
-00029680: 6672 6f6d 5f64 6963 7428 7b22 6e75 6d31  from_dict({"num1
-00029690: 223a 205b 312c 2032 2c20 332c 2034 5d2c  ": [1, 2, 3, 4],
-000296a0: 2022 6e75 6d32 223a 205b 372c 2038 2c20   "num2": [7, 8, 
-000296b0: 392c 2031 305d 7d2c 206e 7061 7274 6974  9, 10]}, npartit
-000296c0: 696f 6e73 3d32 290a 2020 2020 2222 220a  ions=2).    """.
-000296d0: 0a20 2020 2063 6f6c 6c65 6374 696f 6e5f  .    collection_
-000296e0: 7479 7065 7320 3d20 7b74 7970 6528 7629  types = {type(v)
-000296f0: 2066 6f72 2076 2069 6e20 6461 7461 2e76   for v in data.v
-00029700: 616c 7565 7328 2920 6966 2069 735f 6461  alues() if is_da
-00029710: 736b 5f63 6f6c 6c65 6374 696f 6e28 7629  sk_collection(v)
-00029720: 7d0a 2020 2020 6966 2063 6f6c 6c65 6374  }.    if collect
-00029730: 696f 6e5f 7479 7065 733a 0a20 2020 2020  ion_types:.     
-00029740: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00029750: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00029760: 2020 2020 2020 2020 2020 2266 726f 6d5f            "from_
-00029770: 6469 6374 2064 6f65 736e 2774 2063 7572  dict doesn't cur
-00029780: 7265 6e74 6c79 2073 7570 706f 7274 2044  rently support D
-00029790: 6173 6b20 636f 6c6c 6563 7469 6f6e 7320  ask collections 
-000297a0: 6173 2069 6e70 7574 732e 2022 0a20 2020  as inputs. ".   
-000297b0: 2020 2020 2020 2020 2066 224f 626a 6563           f"Objec
-000297c0: 7473 206f 6620 7479 7065 207b 636f 6c6c  ts of type {coll
-000297d0: 6563 7469 6f6e 5f74 7970 6573 7d20 7765  ection_types} we
-000297e0: 7265 2067 6976 656e 2069 6e20 7468 6520  re given in the 
-000297f0: 696e 7075 7420 6469 6374 2e22 0a20 2020  input dict.".   
-00029800: 2020 2020 2029 0a0a 2020 2020 7265 7475       )..    retu
-00029810: 726e 2066 726f 6d5f 7061 6e64 6173 280a  rn from_pandas(.
-00029820: 2020 2020 2020 2020 636f 6e73 7472 7563          construc
-00029830: 746f 722e 6672 6f6d 5f64 6963 7428 6461  tor.from_dict(da
-00029840: 7461 2c20 6f72 6965 6e74 2c20 6474 7970  ta, orient, dtyp
-00029850: 652c 2063 6f6c 756d 6e73 292c 0a20 2020  e, columns),.   
-00029860: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-00029870: 2c0a 2020 2020 290a 0a0a 6465 6620 6672  ,.    )...def fr
-00029880: 6f6d 5f64 6173 6b5f 6461 7461 6672 616d  om_dask_datafram
-00029890: 6528 2a61 7267 732c 202a 2a6b 7761 7267  e(*args, **kwarg
-000298a0: 7329 202d 3e20 4672 616d 6542 6173 653a  s) -> FrameBase:
-000298b0: 0a20 2020 2022 2222 4372 6561 7465 2061  .    """Create a
-000298c0: 2064 6173 6b2d 6578 7072 2063 6f6c 6c65   dask-expr colle
-000298d0: 6374 696f 6e20 6672 6f6d 2061 206c 6567  ction from a leg
-000298e0: 6163 7920 6461 736b 2d64 6174 6166 7261  acy dask-datafra
-000298f0: 6d65 2063 6f6c 6c65 6374 696f 6e0a 0a20  me collection.. 
-00029900: 2020 2057 4152 4e49 4e47 3a20 5468 6973     WARNING: This
-00029910: 2041 5049 2069 7320 6465 7072 6563 6174   API is deprecat
-00029920: 6564 2e20 506c 6561 7365 2075 7365 2060  ed. Please use `
-00029930: 6672 6f6d 5f6c 6567 6163 795f 6461 7461  from_legacy_data
-00029940: 6672 616d 6560 2e0a 0a20 2020 2050 6172  frame`...    Par
-00029950: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00029960: 2d2d 2d2d 2d2d 0a20 2020 206f 7074 696d  ------.    optim
-00029970: 697a 650a 2020 2020 2020 2020 5768 6574  ize.        Whet
-00029980: 6865 7220 746f 206f 7074 696d 697a 6520  her to optimize 
-00029990: 7468 6520 6772 6170 6820 6265 666f 7265  the graph before
-000299a0: 2063 6f6e 7665 7273 696f 6e2e 0a20 2020   conversion..   
-000299b0: 2022 2222 0a20 2020 2023 2054 4f44 4f3a   """.    # TODO:
-000299c0: 2044 6570 7265 6361 7465 2060 6672 6f6d   Deprecate `from
-000299d0: 5f64 6173 6b5f 6461 7461 6672 616d 6560  _dask_dataframe`
-000299e0: 0a20 2020 2023 2053 6565 3a20 6874 7470  .    # See: http
-000299f0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
-00029a00: 6173 6b2f 6461 736b 2d65 7870 722f 6973  ask/dask-expr/is
-00029a10: 7375 6573 2f39 3035 0a20 2020 2072 6574  sues/905.    ret
-00029a20: 7572 6e20 6672 6f6d 5f6c 6567 6163 795f  urn from_legacy_
-00029a30: 6461 7461 6672 616d 6528 2a61 7267 732c  dataframe(*args,
-00029a40: 202a 2a6b 7761 7267 7329 0a0a 0a64 6566   **kwargs)...def
-00029a50: 2066 726f 6d5f 6c65 6761 6379 5f64 6174   from_legacy_dat
-00029a60: 6166 7261 6d65 2864 6466 3a20 5f46 7261  aframe(ddf: _Fra
-00029a70: 6d65 2c20 6f70 7469 6d69 7a65 3a20 626f  me, optimize: bo
-00029a80: 6f6c 203d 2054 7275 6529 202d 3e20 4672  ol = True) -> Fr
-00029a90: 616d 6542 6173 653a 0a20 2020 2022 2222  ameBase:.    """
-00029aa0: 4372 6561 7465 2061 2064 6173 6b2d 6578  Create a dask-ex
-00029ab0: 7072 2063 6f6c 6c65 6374 696f 6e20 6672  pr collection fr
-00029ac0: 6f6d 2061 206c 6567 6163 7920 6461 736b  om a legacy dask
-00029ad0: 2d64 6174 6166 7261 6d65 2063 6f6c 6c65  -dataframe colle
-00029ae0: 6374 696f 6e0a 0a20 2020 2050 6172 616d  ction..    Param
-00029af0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00029b00: 2d2d 2d2d 0a20 2020 206f 7074 696d 697a  ----.    optimiz
-00029b10: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
-00029b20: 7220 746f 206f 7074 696d 697a 6520 7468  r to optimize th
-00029b30: 6520 6772 6170 6820 6265 666f 7265 2063  e graph before c
-00029b40: 6f6e 7665 7273 696f 6e2e 0a20 2020 2022  onversion..    "
-00029b50: 2222 0a20 2020 2067 7261 7068 203d 2064  "".    graph = d
-00029b60: 6466 2e64 6173 6b0a 2020 2020 6966 206f  df.dask.    if o
-00029b70: 7074 696d 697a 653a 0a20 2020 2020 2020  ptimize:.       
-00029b80: 2067 7261 7068 203d 2064 6466 2e5f 5f64   graph = ddf.__d
-00029b90: 6173 6b5f 6f70 7469 6d69 7a65 5f5f 2867  ask_optimize__(g
-00029ba0: 7261 7068 2c20 6464 662e 5f5f 6461 736b  raph, ddf.__dask
-00029bb0: 5f6b 6579 735f 5f28 2929 0a20 2020 2072  _keys__()).    r
-00029bc0: 6574 7572 6e20 6672 6f6d 5f67 7261 7068  eturn from_graph
-00029bd0: 280a 2020 2020 2020 2020 6772 6170 682c  (.        graph,
-00029be0: 2064 6466 2e5f 6d65 7461 2c20 6464 662e   ddf._meta, ddf.
-00029bf0: 6469 7669 7369 6f6e 732c 2064 6466 2e5f  divisions, ddf._
-00029c00: 5f64 6173 6b5f 6b65 7973 5f5f 2829 2c20  _dask_keys__(), 
-00029c10: 6b65 795f 7370 6c69 7428 6464 662e 5f6e  key_split(ddf._n
-00029c20: 616d 6529 0a20 2020 2029 0a0a 0a64 6566  ame).    )...def
-00029c30: 2066 726f 6d5f 6461 736b 5f61 7272 6179   from_dask_array
-00029c40: 2878 2c20 636f 6c75 6d6e 733d 4e6f 6e65  (x, columns=None
-00029c50: 2c20 696e 6465 783d 4e6f 6e65 2c20 6d65  , index=None, me
-00029c60: 7461 3d4e 6f6e 6529 3a0a 2020 2020 6672  ta=None):.    fr
-00029c70: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-00029c80: 652e 696f 2069 6d70 6f72 7420 6672 6f6d  e.io import from
-00029c90: 5f64 6173 6b5f 6172 7261 790a 0a20 2020  _dask_array..   
-00029ca0: 2069 6620 6973 696e 7374 616e 6365 2869   if isinstance(i
-00029cb0: 6e64 6578 2c20 4672 616d 6542 6173 6529  ndex, FrameBase)
-00029cc0: 3a0a 2020 2020 2020 2020 696e 6465 7820  :.        index 
-00029cd0: 3d20 696e 6465 782e 746f 5f6c 6567 6163  = index.to_legac
-00029ce0: 795f 6461 7461 6672 616d 6528 290a 2020  y_dataframe().  
-00029cf0: 2020 6966 2063 6f6c 756d 6e73 2069 7320    if columns is 
-00029d00: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
-00029d10: 206c 656e 2863 6f6c 756d 6e73 293a 0a20   len(columns):. 
-00029d20: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-00029d30: 204e 6f6e 650a 2020 2020 6466 203d 2066   None.    df = f
-00029d40: 726f 6d5f 6461 736b 5f61 7272 6179 2878  rom_dask_array(x
-00029d50: 2c20 636f 6c75 6d6e 733d 636f 6c75 6d6e  , columns=column
-00029d60: 732c 2069 6e64 6578 3d69 6e64 6578 2c20  s, index=index, 
-00029d70: 6d65 7461 3d6d 6574 6129 0a20 2020 2072  meta=meta).    r
-00029d80: 6574 7572 6e20 6672 6f6d 5f6c 6567 6163  eturn from_legac
-00029d90: 795f 6461 7461 6672 616d 6528 6466 2c20  y_dataframe(df, 
-00029da0: 6f70 7469 6d69 7a65 3d54 7275 6529 0a0a  optimize=True)..
-00029db0: 0a64 6566 2072 6561 645f 6373 7628 0a20  .def read_csv(. 
-00029dc0: 2020 2070 6174 682c 0a20 2020 202a 6172     path,.    *ar
-00029dd0: 6773 2c0a 2020 2020 6865 6164 6572 3d22  gs,.    header="
-00029de0: 696e 6665 7222 2c0a 2020 2020 7573 6563  infer",.    usec
-00029df0: 6f6c 733d 4e6f 6e65 2c0a 2020 2020 6474  ols=None,.    dt
-00029e00: 7970 655f 6261 636b 656e 643d 4e6f 6e65  ype_backend=None
-00029e10: 2c0a 2020 2020 7374 6f72 6167 655f 6f70  ,.    storage_op
-00029e20: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
-00029e30: 2a2a 6b77 6172 6773 2c0a 293a 0a20 2020  **kwargs,.):.   
-00029e40: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
-00029e50: 696f 2e63 7376 2069 6d70 6f72 7420 5265  io.csv import Re
-00029e60: 6164 4353 560a 0a20 2020 2069 6620 6e6f  adCSV..    if no
-00029e70: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
-00029e80: 682c 2073 7472 293a 0a20 2020 2020 2020  h, str):.       
-00029e90: 2070 6174 6820 3d20 7374 7269 6e67 6966   path = stringif
-00029ea0: 795f 7061 7468 2870 6174 6829 0a20 2020  y_path(path).   
-00029eb0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-00029ec0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-00029ed0: 5265 6164 4353 5628 0a20 2020 2020 2020  ReadCSV(.       
-00029ee0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-00029ef0: 2020 2020 2020 2063 6f6c 756d 6e73 3d75         columns=u
-00029f00: 7365 636f 6c73 2c0a 2020 2020 2020 2020  secols,.        
-00029f10: 2020 2020 6474 7970 655f 6261 636b 656e      dtype_backen
-00029f20: 643d 6474 7970 655f 6261 636b 656e 642c  d=dtype_backend,
-00029f30: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
-00029f40: 7261 6765 5f6f 7074 696f 6e73 3d73 746f  rage_options=sto
-00029f50: 7261 6765 5f6f 7074 696f 6e73 2c0a 2020  rage_options,.  
-00029f60: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-00029f70: 3d6b 7761 7267 732c 0a20 2020 2020 2020  =kwargs,.       
-00029f80: 2020 2020 2068 6561 6465 723d 6865 6164       header=head
-00029f90: 6572 2c0a 2020 2020 2020 2020 290a 2020  er,.        ).  
-00029fa0: 2020 290a 0a0a 6465 6620 7265 6164 5f74    )...def read_t
-00029fb0: 6162 6c65 280a 2020 2020 7061 7468 2c0a  able(.    path,.
-00029fc0: 2020 2020 2a61 7267 732c 0a20 2020 2068      *args,.    h
-00029fd0: 6561 6465 723d 2269 6e66 6572 222c 0a20  eader="infer",. 
-00029fe0: 2020 2075 7365 636f 6c73 3d4e 6f6e 652c     usecols=None,
-00029ff0: 0a20 2020 2064 7479 7065 5f62 6163 6b65  .    dtype_backe
-0002a000: 6e64 3d4e 6f6e 652c 0a20 2020 2073 746f  nd=None,.    sto
-0002a010: 7261 6765 5f6f 7074 696f 6e73 3d4e 6f6e  rage_options=Non
-0002a020: 652c 0a20 2020 202a 2a6b 7761 7267 732c  e,.    **kwargs,
-0002a030: 0a29 3a0a 2020 2020 6672 6f6d 2064 6173  .):.    from das
-0002a040: 6b5f 6578 7072 2e69 6f2e 6373 7620 696d  k_expr.io.csv im
-0002a050: 706f 7274 2052 6561 6454 6162 6c65 0a0a  port ReadTable..
-0002a060: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0002a070: 7461 6e63 6528 7061 7468 2c20 7374 7229  tance(path, str)
-0002a080: 3a0a 2020 2020 2020 2020 7061 7468 203d  :.        path =
-0002a090: 2073 7472 696e 6769 6679 5f70 6174 6828   stringify_path(
-0002a0a0: 7061 7468 290a 2020 2020 7265 7475 726e  path).    return
-0002a0b0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0002a0c0: 0a20 2020 2020 2020 2052 6561 6454 6162  .        ReadTab
-0002a0d0: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
-0002a0e0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-0002a0f0: 2020 636f 6c75 6d6e 733d 7573 6563 6f6c    columns=usecol
-0002a100: 732c 0a20 2020 2020 2020 2020 2020 2064  s,.            d
-0002a110: 7479 7065 5f62 6163 6b65 6e64 3d64 7479  type_backend=dty
-0002a120: 7065 5f62 6163 6b65 6e64 2c0a 2020 2020  pe_backend,.    
-0002a130: 2020 2020 2020 2020 7374 6f72 6167 655f          storage_
-0002a140: 6f70 7469 6f6e 733d 7374 6f72 6167 655f  options=storage_
-0002a150: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
-0002a160: 2020 2020 206b 7761 7267 733d 6b77 6172       kwargs=kwar
-0002a170: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-0002a180: 6865 6164 6572 3d68 6561 6465 722c 0a20  header=header,. 
-0002a190: 2020 2020 2020 2029 0a20 2020 2029 0a0a         ).    )..
-0002a1a0: 0a64 6566 2072 6561 645f 6677 6628 0a20  .def read_fwf(. 
-0002a1b0: 2020 2070 6174 682c 0a20 2020 202a 6172     path,.    *ar
-0002a1c0: 6773 2c0a 2020 2020 6865 6164 6572 3d22  gs,.    header="
-0002a1d0: 696e 6665 7222 2c0a 2020 2020 7573 6563  infer",.    usec
-0002a1e0: 6f6c 733d 4e6f 6e65 2c0a 2020 2020 6474  ols=None,.    dt
-0002a1f0: 7970 655f 6261 636b 656e 643d 4e6f 6e65  ype_backend=None
-0002a200: 2c0a 2020 2020 7374 6f72 6167 655f 6f70  ,.    storage_op
-0002a210: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
-0002a220: 2a2a 6b77 6172 6773 2c0a 293a 0a20 2020  **kwargs,.):.   
-0002a230: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
-0002a240: 696f 2e63 7376 2069 6d70 6f72 7420 5265  io.csv import Re
-0002a250: 6164 4677 660a 0a20 2020 2069 6620 6e6f  adFwf..    if no
-0002a260: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
-0002a270: 682c 2073 7472 293a 0a20 2020 2020 2020  h, str):.       
-0002a280: 2070 6174 6820 3d20 7374 7269 6e67 6966   path = stringif
-0002a290: 795f 7061 7468 2870 6174 6829 0a20 2020  y_path(path).   
-0002a2a0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
-0002a2b0: 6563 7469 6f6e 280a 2020 2020 2020 2020  ection(.        
-0002a2c0: 5265 6164 4677 6628 0a20 2020 2020 2020  ReadFwf(.       
-0002a2d0: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-0002a2e0: 2020 2020 2020 2063 6f6c 756d 6e73 3d75         columns=u
-0002a2f0: 7365 636f 6c73 2c0a 2020 2020 2020 2020  secols,.        
-0002a300: 2020 2020 6474 7970 655f 6261 636b 656e      dtype_backen
-0002a310: 643d 6474 7970 655f 6261 636b 656e 642c  d=dtype_backend,
-0002a320: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
-0002a330: 7261 6765 5f6f 7074 696f 6e73 3d73 746f  rage_options=sto
-0002a340: 7261 6765 5f6f 7074 696f 6e73 2c0a 2020  rage_options,.  
-0002a350: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0002a360: 3d6b 7761 7267 732c 0a20 2020 2020 2020  =kwargs,.       
-0002a370: 2020 2020 2068 6561 6465 723d 6865 6164       header=head
-0002a380: 6572 2c0a 2020 2020 2020 2020 290a 2020  er,.        ).  
-0002a390: 2020 290a 0a0a 6465 6620 7265 6164 5f70    )...def read_p
-0002a3a0: 6172 7175 6574 280a 2020 2020 7061 7468  arquet(.    path
-0002a3b0: 3d4e 6f6e 652c 0a20 2020 2063 6f6c 756d  =None,.    colum
-0002a3c0: 6e73 3d4e 6f6e 652c 0a20 2020 2066 696c  ns=None,.    fil
-0002a3d0: 7465 7273 3d4e 6f6e 652c 0a20 2020 2063  ters=None,.    c
-0002a3e0: 6174 6567 6f72 6965 733d 4e6f 6e65 2c0a  ategories=None,.
-0002a3f0: 2020 2020 696e 6465 783d 4e6f 6e65 2c0a      index=None,.
-0002a400: 2020 2020 7374 6f72 6167 655f 6f70 7469      storage_opti
-0002a410: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 6474  ons=None,.    dt
-0002a420: 7970 655f 6261 636b 656e 643d 4e6f 6e65  ype_backend=None
-0002a430: 2c0a 2020 2020 6361 6c63 756c 6174 655f  ,.    calculate_
-0002a440: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
-0002a450: 0a20 2020 2069 676e 6f72 655f 6d65 7461  .    ignore_meta
-0002a460: 6461 7461 5f66 696c 653d 4661 6c73 652c  data_file=False,
-0002a470: 0a20 2020 206d 6574 6164 6174 615f 7461  .    metadata_ta
-0002a480: 736b 5f73 697a 653d 4e6f 6e65 2c0a 2020  sk_size=None,.  
-0002a490: 2020 7370 6c69 745f 726f 775f 6772 6f75    split_row_grou
-0002a4a0: 7073 3d22 696e 6665 7222 2c0a 2020 2020  ps="infer",.    
-0002a4b0: 626c 6f63 6b73 697a 653d 2264 6566 6175  blocksize="defau
-0002a4c0: 6c74 222c 0a20 2020 2061 6767 7265 6761  lt",.    aggrega
-0002a4d0: 7465 5f66 696c 6573 3d4e 6f6e 652c 0a20  te_files=None,. 
-0002a4e0: 2020 2070 6172 7175 6574 5f66 696c 655f     parquet_file_
-0002a4f0: 6578 7465 6e73 696f 6e3d 2822 2e70 6172  extension=(".par
-0002a500: 7122 2c20 222e 7061 7271 7565 7422 2c20  q", ".parquet", 
-0002a510: 222e 7071 2229 2c0a 2020 2020 6669 6c65  ".pq"),.    file
-0002a520: 7379 7374 656d 3d22 6673 7370 6563 222c  system="fsspec",
-0002a530: 0a20 2020 2065 6e67 696e 653d 4e6f 6e65  .    engine=None
-0002a540: 2c0a 2020 2020 6172 726f 775f 746f 5f70  ,.    arrow_to_p
-0002a550: 616e 6461 733d 4e6f 6e65 2c0a 2020 2020  andas=None,.    
-0002a560: 2a2a 6b77 6172 6773 2c0a 293a 0a20 2020  **kwargs,.):.   
-0002a570: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
-0002a580: 696f 2e70 6172 7175 6574 2069 6d70 6f72  io.parquet impor
-0002a590: 7420 280a 2020 2020 2020 2020 5265 6164  t (.        Read
-0002a5a0: 5061 7271 7565 7446 5353 7065 632c 0a20  ParquetFSSpec,. 
-0002a5b0: 2020 2020 2020 2052 6561 6450 6172 7175         ReadParqu
-0002a5c0: 6574 5079 6172 726f 7746 532c 0a20 2020  etPyarrowFS,.   
-0002a5d0: 2020 2020 205f 7365 745f 7061 7271 7565       _set_parque
-0002a5e0: 745f 656e 6769 6e65 2c0a 2020 2020 290a  t_engine,.    ).
-0002a5f0: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
-0002a600: 7374 616e 6365 2870 6174 682c 2073 7472  stance(path, str
-0002a610: 293a 0a20 2020 2020 2020 2070 6174 6820  ):.        path 
-0002a620: 3d20 7374 7269 6e67 6966 795f 7061 7468  = stringify_path
-0002a630: 2870 6174 6829 0a0a 2020 2020 6b77 6172  (path)..    kwar
-0002a640: 6773 5b22 6474 7970 655f 6261 636b 656e  gs["dtype_backen
-0002a650: 6422 5d20 3d20 6474 7970 655f 6261 636b  d"] = dtype_back
-0002a660: 656e 640a 2020 2020 6966 2061 7272 6f77  end.    if arrow
-0002a670: 5f74 6f5f 7061 6e64 6173 3a0a 2020 2020  _to_pandas:.    
-0002a680: 2020 2020 6b77 6172 6773 5b22 6172 726f      kwargs["arro
-0002a690: 775f 746f 5f70 616e 6461 7322 5d20 3d20  w_to_pandas"] = 
-0002a6a0: 6172 726f 775f 746f 5f70 616e 6461 730a  arrow_to_pandas.
-0002a6b0: 0a20 2020 2069 6620 6669 6c74 6572 7320  .    if filters 
-0002a6c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0002a6d0: 2020 2020 2066 6f72 2066 696c 7465 7220       for filter 
-0002a6e0: 696e 2066 6c61 7474 656e 2866 696c 7465  in flatten(filte
-0002a6f0: 7273 2c20 636f 6e74 6169 6e65 723d 6c69  rs, container=li
-0002a700: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
-0002a710: 2063 6f6c 2c20 6f70 2c20 7661 6c20 3d20   col, op, val = 
-0002a720: 6669 6c74 6572 0a20 2020 2020 2020 2020  filter.         
-0002a730: 2020 2069 6620 6f70 203d 3d20 2269 6e22     if op == "in"
-0002a740: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-0002a750: 6e63 6528 7661 6c2c 2028 7365 742c 206c  nce(val, (set, l
-0002a760: 6973 742c 2074 7570 6c65 2929 3a0a 2020  ist, tuple)):.  
-0002a770: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002a780: 6973 6520 5479 7065 4572 726f 7228 2256  ise TypeError("V
-0002a790: 616c 7565 206f 6620 2769 6e27 2066 696c  alue of 'in' fil
-0002a7a0: 7465 7220 6d75 7374 2062 6520 6120 6c69  ter must be a li
-0002a7b0: 7374 2c20 7365 7420 6f72 2074 7570 6c65  st, set or tuple
-0002a7c0: 2e22 290a 0a20 2020 2069 6620 280a 2020  .")..    if (.  
-0002a7d0: 2020 2020 2020 6973 696e 7374 616e 6365        isinstance
-0002a7e0: 2866 696c 6573 7973 7465 6d2c 2070 615f  (filesystem, pa_
-0002a7f0: 6673 2e46 696c 6553 7973 7465 6d29 0a20  fs.FileSystem). 
-0002a800: 2020 2020 2020 206f 7220 6973 696e 7374         or isinst
-0002a810: 616e 6365 2866 696c 6573 7973 7465 6d2c  ance(filesystem,
-0002a820: 2073 7472 290a 2020 2020 2020 2020 616e   str).        an
-0002a830: 6420 6669 6c65 7379 7374 656d 2e6c 6f77  d filesystem.low
-0002a840: 6572 2829 2069 6e20 2822 6172 726f 7722  er() in ("arrow"
-0002a850: 2c20 2270 7961 7272 6f77 2229 0a20 2020  , "pyarrow").   
-0002a860: 2029 3a0a 2020 2020 2020 2020 6966 2070   ):.        if p
-0002a870: 6172 7365 5f76 6572 7369 6f6e 2870 612e  arse_version(pa.
-0002a880: 5f5f 7665 7273 696f 6e5f 5f29 203c 2070  __version__) < p
-0002a890: 6172 7365 5f76 6572 7369 6f6e 2822 3135  arse_version("15
-0002a8a0: 2e30 2e30 2229 3a0a 2020 2020 2020 2020  .0.0"):.        
-0002a8b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002a8c0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002a8d0: 2020 2020 2020 2270 7961 7272 6f77 3e3d        "pyarrow>=
-0002a8e0: 3135 2e30 2e30 2069 7320 7265 7175 6972  15.0.0 is requir
-0002a8f0: 6564 2074 6f20 7573 6520 7468 6520 7079  ed to use the py
-0002a900: 6172 726f 7720 6669 6c65 7379 7374 656d  arrow filesystem
-0002a910: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-0002a920: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
-0002a930: 6461 7461 5f74 6173 6b5f 7369 7a65 2069  data_task_size i
-0002a940: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002a950: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-0002a960: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-0002a970: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002a980: 2020 2022 6d65 7461 6461 7461 5f74 6173     "metadata_tas
-0002a990: 6b5f 7369 7a65 2069 7320 6e6f 7420 7375  k_size is not su
-0002a9a0: 7070 6f72 7465 6420 7768 656e 2075 7369  pported when usi
-0002a9b0: 6e67 2074 6865 2070 7961 7272 6f77 2066  ng the pyarrow f
-0002a9c0: 696c 6573 7973 7465 6d2e 220a 2020 2020  ilesystem.".    
-0002a9d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002a9e0: 2020 6966 2073 706c 6974 5f72 6f77 5f67    if split_row_g
-0002a9f0: 726f 7570 7320 213d 2022 696e 6665 7222  roups != "infer"
-0002aa00: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002aa10: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0002aa20: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-0002aa30: 2020 2020 2020 2020 2022 7370 6c69 745f           "split_
-0002aa40: 726f 775f 6772 6f75 7073 2069 7320 6e6f  row_groups is no
-0002aa50: 7420 7375 7070 6f72 7465 6420 7768 656e  t supported when
-0002aa60: 2075 7369 6e67 2074 6865 2070 7961 7272   using the pyarr
-0002aa70: 6f77 2066 696c 6573 7973 7465 6d2e 220a  ow filesystem.".
-0002aa80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002aa90: 2020 2020 2020 6966 2062 6c6f 636b 7369        if blocksi
-0002aaa0: 7a65 2069 7320 6e6f 7420 4e6f 6e65 2061  ze is not None a
-0002aab0: 6e64 2062 6c6f 636b 7369 7a65 2021 3d20  nd blocksize != 
-0002aac0: 2264 6566 6175 6c74 223a 0a20 2020 2020  "default":.     
-0002aad0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0002aae0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0002aaf0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002ab00: 2020 2262 6c6f 636b 7369 7a65 2069 7320    "blocksize is 
-0002ab10: 6e6f 7420 7375 7070 6f72 7465 6420 7768  not supported wh
-0002ab20: 656e 2075 7369 6e67 2074 6865 2070 7961  en using the pya
-0002ab30: 7272 6f77 2066 696c 6573 7973 7465 6d2e  rrow filesystem.
-0002ab40: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0002ab50: 2020 2020 2020 2020 6966 2061 6767 7265          if aggre
-0002ab60: 6761 7465 5f66 696c 6573 2069 7320 6e6f  gate_files is no
-0002ab70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0002ab80: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0002ab90: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-0002aba0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002abb0: 6167 6772 6567 6174 655f 6669 6c65 7320  aggregate_files 
-0002abc0: 6973 206e 6f74 2073 7570 706f 7274 6564  is not supported
-0002abd0: 2077 6865 6e20 7573 696e 6720 7468 6520   when using the 
-0002abe0: 7079 6172 726f 7720 6669 6c65 7379 7374  pyarrow filesyst
-0002abf0: 656d 2e22 0a20 2020 2020 2020 2020 2020  em.".           
-0002ac00: 2029 0a20 2020 2020 2020 2069 6620 7061   ).        if pa
-0002ac10: 7271 7565 745f 6669 6c65 5f65 7874 656e  rquet_file_exten
-0002ac20: 7369 6f6e 2021 3d20 2822 2e70 6172 7122  sion != (".parq"
-0002ac30: 2c20 222e 7061 7271 7565 7422 2c20 222e  , ".parquet", ".
-0002ac40: 7071 2229 3a0a 2020 2020 2020 2020 2020  pq"):.          
-0002ac50: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0002ac60: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
-0002ac70: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
-0002ac80: 7271 7565 745f 6669 6c65 5f65 7874 656e  rquet_file_exten
-0002ac90: 7369 6f6e 2069 7320 6e6f 7420 7375 7070  sion is not supp
-0002aca0: 6f72 7465 6420 7768 656e 2075 7369 6e67  orted when using
-0002acb0: 2074 6865 2070 7961 7272 6f77 2066 696c   the pyarrow fil
-0002acc0: 6573 7973 7465 6d2e 220a 2020 2020 2020  esystem.".      
-0002acd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002ace0: 6966 2065 6e67 696e 6520 6973 206e 6f74  if engine is not
-0002acf0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0002ad00: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0002ad10: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-0002ad20: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-0002ad30: 6e67 696e 6520 6973 206e 6f74 2073 7570  ngine is not sup
-0002ad40: 706f 7274 6564 2077 6865 6e20 7573 696e  ported when usin
-0002ad50: 6720 7468 6520 7079 6172 726f 7720 6669  g the pyarrow fi
-0002ad60: 6c65 7379 7374 656d 2e22 0a20 2020 2020  lesystem.".     
-0002ad70: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002ad80: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-0002ad90: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-0002ada0: 2020 2020 2052 6561 6450 6172 7175 6574       ReadParquet
-0002adb0: 5079 6172 726f 7746 5328 0a20 2020 2020  PyarrowFS(.     
-0002adc0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
-0002add0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ade0: 2063 6f6c 756d 6e73 3d5f 636f 6e76 6572   columns=_conver
-0002adf0: 745f 746f 5f6c 6973 7428 636f 6c75 6d6e  t_to_list(column
-0002ae00: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
-0002ae10: 2020 2020 6669 6c74 6572 733d 6669 6c74      filters=filt
-0002ae20: 6572 732c 0a20 2020 2020 2020 2020 2020  ers,.           
-0002ae30: 2020 2020 2063 6174 6567 6f72 6965 733d       categories=
-0002ae40: 6361 7465 676f 7269 6573 2c0a 2020 2020  categories,.    
-0002ae50: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-0002ae60: 783d 696e 6465 782c 0a20 2020 2020 2020  x=index,.       
-0002ae70: 2020 2020 2020 2020 2063 616c 6375 6c61           calcula
-0002ae80: 7465 5f64 6976 6973 696f 6e73 3d63 616c  te_divisions=cal
-0002ae90: 6375 6c61 7465 5f64 6976 6973 696f 6e73  culate_divisions
-0002aea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002aeb0: 2020 7374 6f72 6167 655f 6f70 7469 6f6e    storage_option
-0002aec0: 733d 7374 6f72 6167 655f 6f70 7469 6f6e  s=storage_option
-0002aed0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0002aee0: 2020 2066 696c 6573 7973 7465 6d3d 6669     filesystem=fi
-0002aef0: 6c65 7379 7374 656d 2c0a 2020 2020 2020  lesystem,.      
-0002af00: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
-0002af10: 5f6d 6574 6164 6174 615f 6669 6c65 3d69  _metadata_file=i
-0002af20: 676e 6f72 655f 6d65 7461 6461 7461 5f66  gnore_metadata_f
-0002af30: 696c 652c 0a20 2020 2020 2020 2020 2020  ile,.           
-0002af40: 2020 2020 2061 7272 6f77 5f74 6f5f 7061       arrow_to_pa
-0002af50: 6e64 6173 3d61 7272 6f77 5f74 6f5f 7061  ndas=arrow_to_pa
-0002af60: 6e64 6173 2c0a 2020 2020 2020 2020 2020  ndas,.          
-0002af70: 2020 2020 2020 7079 6172 726f 775f 7374        pyarrow_st
-0002af80: 7269 6e67 735f 656e 6162 6c65 643d 7079  rings_enabled=py
-0002af90: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
-0002afa0: 6162 6c65 6428 292c 0a20 2020 2020 2020  abled(),.       
-0002afb0: 2020 2020 2020 2020 206b 7761 7267 733d           kwargs=
-0002afc0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-0002afd0: 2020 2020 2020 2020 5f73 6572 6965 733d          _series=
-0002afe0: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
-0002aff0: 6e73 2c20 7374 7229 2c0a 2020 2020 2020  ns, str),.      
-0002b000: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002b010: 290a 0a20 2020 2072 6574 7572 6e20 6e65  )..    return ne
-0002b020: 775f 636f 6c6c 6563 7469 6f6e 280a 2020  w_collection(.  
-0002b030: 2020 2020 2020 5265 6164 5061 7271 7565        ReadParque
-0002b040: 7446 5353 7065 6328 0a20 2020 2020 2020  tFSSpec(.       
-0002b050: 2020 2020 2070 6174 682c 0a20 2020 2020       path,.     
-0002b060: 2020 2020 2020 2063 6f6c 756d 6e73 3d5f         columns=_
-0002b070: 636f 6e76 6572 745f 746f 5f6c 6973 7428  convert_to_list(
-0002b080: 636f 6c75 6d6e 7329 2c0a 2020 2020 2020  columns),.      
-0002b090: 2020 2020 2020 6669 6c74 6572 733d 6669        filters=fi
-0002b0a0: 6c74 6572 732c 0a20 2020 2020 2020 2020  lters,.         
-0002b0b0: 2020 2063 6174 6567 6f72 6965 733d 6361     categories=ca
-0002b0c0: 7465 676f 7269 6573 2c0a 2020 2020 2020  tegories,.      
-0002b0d0: 2020 2020 2020 696e 6465 783d 696e 6465        index=inde
-0002b0e0: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
-0002b0f0: 746f 7261 6765 5f6f 7074 696f 6e73 3d73  torage_options=s
-0002b100: 746f 7261 6765 5f6f 7074 696f 6e73 2c0a  torage_options,.
-0002b110: 2020 2020 2020 2020 2020 2020 6361 6c63              calc
-0002b120: 756c 6174 655f 6469 7669 7369 6f6e 733d  ulate_divisions=
-0002b130: 6361 6c63 756c 6174 655f 6469 7669 7369  calculate_divisi
-0002b140: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-0002b150: 2069 676e 6f72 655f 6d65 7461 6461 7461   ignore_metadata
-0002b160: 5f66 696c 653d 6967 6e6f 7265 5f6d 6574  _file=ignore_met
-0002b170: 6164 6174 615f 6669 6c65 2c0a 2020 2020  adata_file,.    
-0002b180: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0002b190: 5f74 6173 6b5f 7369 7a65 3d6d 6574 6164  _task_size=metad
-0002b1a0: 6174 615f 7461 736b 5f73 697a 652c 0a20  ata_task_size,. 
-0002b1b0: 2020 2020 2020 2020 2020 2073 706c 6974             split
-0002b1c0: 5f72 6f77 5f67 726f 7570 733d 7370 6c69  _row_groups=spli
-0002b1d0: 745f 726f 775f 6772 6f75 7073 2c0a 2020  t_row_groups,.  
-0002b1e0: 2020 2020 2020 2020 2020 626c 6f63 6b73            blocks
-0002b1f0: 697a 653d 626c 6f63 6b73 697a 652c 0a20  ize=blocksize,. 
-0002b200: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-0002b210: 6761 7465 5f66 696c 6573 3d61 6767 7265  gate_files=aggre
-0002b220: 6761 7465 5f66 696c 6573 2c0a 2020 2020  gate_files,.    
-0002b230: 2020 2020 2020 2020 7061 7271 7565 745f          parquet_
-0002b240: 6669 6c65 5f65 7874 656e 7369 6f6e 3d70  file_extension=p
-0002b250: 6172 7175 6574 5f66 696c 655f 6578 7465  arquet_file_exte
-0002b260: 6e73 696f 6e2c 0a20 2020 2020 2020 2020  nsion,.         
-0002b270: 2020 2066 696c 6573 7973 7465 6d3d 6669     filesystem=fi
-0002b280: 6c65 7379 7374 656d 2c0a 2020 2020 2020  lesystem,.      
-0002b290: 2020 2020 2020 656e 6769 6e65 3d5f 7365        engine=_se
-0002b2a0: 745f 7061 7271 7565 745f 656e 6769 6e65  t_parquet_engine
-0002b2b0: 2865 6e67 696e 6529 2c0a 2020 2020 2020  (engine),.      
-0002b2c0: 2020 2020 2020 6b77 6172 6773 3d6b 7761        kwargs=kwa
-0002b2d0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0002b2e0: 205f 7365 7269 6573 3d69 7369 6e73 7461   _series=isinsta
-0002b2f0: 6e63 6528 636f 6c75 6d6e 732c 2073 7472  nce(columns, str
-0002b300: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-0002b310: 2029 0a0a 0a64 6566 2063 6f6e 6361 7428   )...def concat(
-0002b320: 0a20 2020 2064 6673 2c0a 2020 2020 6178  .    dfs,.    ax
-0002b330: 6973 3d30 2c0a 2020 2020 6a6f 696e 3d22  is=0,.    join="
-0002b340: 6f75 7465 7222 2c0a 2020 2020 6967 6e6f  outer",.    igno
-0002b350: 7265 5f75 6e6b 6e6f 776e 5f64 6976 6973  re_unknown_divis
-0002b360: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
-0002b370: 6967 6e6f 7265 5f6f 7264 6572 3d46 616c  ignore_order=Fal
-0002b380: 7365 2c0a 2020 2020 696e 7465 726c 6561  se,.    interlea
-0002b390: 7665 5f70 6172 7469 7469 6f6e 733d 4661  ve_partitions=Fa
-0002b3a0: 6c73 652c 0a20 2020 202a 2a6b 7761 7267  lse,.    **kwarg
-0002b3b0: 732c 0a29 3a0a 2020 2020 6966 206e 6f74  s,.):.    if not
-0002b3c0: 2069 7369 6e73 7461 6e63 6528 6466 732c   isinstance(dfs,
-0002b3d0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-0002b3e0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0002b3f0: 2264 6673 206d 7573 7420 6265 2061 206c  "dfs must be a l
-0002b400: 6973 7420 6f66 2044 6174 6146 7261 6d65  ist of DataFrame
-0002b410: 732f 5365 7269 6573 206f 626a 6563 7473  s/Series objects
-0002b420: 2229 0a20 2020 2069 6620 6c65 6e28 6466  ").    if len(df
-0002b430: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
-0002b440: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002b450: 7228 224e 6f20 6f62 6a65 6374 7320 746f  r("No objects to
-0002b460: 2063 6f6e 6361 7465 6e61 7465 2229 0a20   concatenate"). 
-0002b470: 2020 2069 6620 6c65 6e28 6466 7329 203d     if len(dfs) =
-0002b480: 3d20 313a 0a20 2020 2020 2020 2069 6620  = 1:.        if 
-0002b490: 6178 6973 203d 3d20 3120 616e 6420 6973  axis == 1 and is
-0002b4a0: 696e 7374 616e 6365 2864 6673 5b30 5d2c  instance(dfs[0],
-0002b4b0: 2053 6572 6965 7329 3a0a 2020 2020 2020   Series):.      
-0002b4c0: 2020 2020 2020 7265 7475 726e 2064 6673        return dfs
-0002b4d0: 5b30 5d2e 746f 5f66 7261 6d65 2829 0a20  [0].to_frame(). 
-0002b4e0: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
-0002b4f0: 735b 305d 0a0a 2020 2020 6966 206a 6f69  s[0]..    if joi
-0002b500: 6e20 6e6f 7420 696e 2028 2269 6e6e 6572  n not in ("inner
-0002b510: 222c 2022 6f75 7465 7222 293a 0a20 2020  ", "outer"):.   
-0002b520: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002b530: 4572 726f 7228 2227 6a6f 696e 2720 6d75  Error("'join' mu
-0002b540: 7374 2062 6520 2769 6e6e 6572 2720 6f72  st be 'inner' or
-0002b550: 2027 6f75 7465 7227 2229 0a0a 2020 2020   'outer'")..    
-0002b560: 6466 7320 3d20 5b66 726f 6d5f 7061 6e64  dfs = [from_pand
-0002b570: 6173 2864 6629 2069 6620 6e6f 7420 6973  as(df) if not is
-0002b580: 696e 7374 616e 6365 2864 662c 2046 7261  instance(df, Fra
-0002b590: 6d65 4261 7365 2920 656c 7365 2064 6620  meBase) else df 
-0002b5a0: 666f 7220 6466 2069 6e20 6466 735d 0a0a  for df in dfs]..
-0002b5b0: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-0002b5c0: 3a0a 2020 2020 2020 2020 6466 7320 3d20  :.        dfs = 
-0002b5d0: 5b64 6620 666f 7220 6466 2069 6e20 6466  [df for df in df
-0002b5e0: 7320 6966 206c 656e 2864 662e 636f 6c75  s if len(df.colu
-0002b5f0: 6d6e 7329 203e 2030 206f 7220 6973 696e  mns) > 0 or isin
-0002b600: 7374 616e 6365 2864 662c 2053 6572 6965  stance(df, Serie
-0002b610: 7329 5d0a 0a20 2020 2072 6574 7572 6e20  s)]..    return 
-0002b620: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
-0002b630: 2020 2020 2020 2020 436f 6e63 6174 280a          Concat(.
-0002b640: 2020 2020 2020 2020 2020 2020 6a6f 696e              join
-0002b650: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
-0002b660: 6e6f 7265 5f6f 7264 6572 2c0a 2020 2020  nore_order,.    
-0002b670: 2020 2020 2020 2020 6b77 6172 6773 2c0a          kwargs,.
-0002b680: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-0002b690: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
-0002b6a0: 6e6f 7265 5f75 6e6b 6e6f 776e 5f64 6976  nore_unknown_div
-0002b6b0: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
-0002b6c0: 2020 2020 696e 7465 726c 6561 7665 5f70      interleave_p
-0002b6d0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0002b6e0: 2020 2020 2020 202a 6466 732c 0a20 2020         *dfs,.   
-0002b6f0: 2020 2020 2029 0a20 2020 2029 0a0a 0a64       ).    )...d
-0002b700: 6566 206d 6572 6765 280a 2020 2020 6c65  ef merge(.    le
-0002b710: 6674 2c0a 2020 2020 7269 6768 742c 0a20  ft,.    right,. 
-0002b720: 2020 2068 6f77 3d22 696e 6e65 7222 2c0a     how="inner",.
-0002b730: 2020 2020 6f6e 3d4e 6f6e 652c 0a20 2020      on=None,.   
-0002b740: 206c 6566 745f 6f6e 3d4e 6f6e 652c 0a20   left_on=None,. 
-0002b750: 2020 2072 6967 6874 5f6f 6e3d 4e6f 6e65     right_on=None
-0002b760: 2c0a 2020 2020 6c65 6674 5f69 6e64 6578  ,.    left_index
-0002b770: 3d46 616c 7365 2c0a 2020 2020 7269 6768  =False,.    righ
-0002b780: 745f 696e 6465 783d 4661 6c73 652c 0a20  t_index=False,. 
-0002b790: 2020 2073 7566 6669 7865 733d 2822 5f78     suffixes=("_x
-0002b7a0: 222c 2022 5f79 2229 2c0a 2020 2020 696e  ", "_y"),.    in
-0002b7b0: 6469 6361 746f 723d 4661 6c73 652c 0a20  dicator=False,. 
-0002b7c0: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
-0002b7d0: 643d 4e6f 6e65 2c0a 2020 2020 6e70 6172  d=None,.    npar
-0002b7e0: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
-0002b7f0: 2020 6272 6f61 6463 6173 743d 4e6f 6e65    broadcast=None
-0002b800: 2c0a 293a 0a20 2020 2066 6f72 206f 2069  ,.):.    for o i
-0002b810: 6e20 5b6f 6e2c 206c 6566 745f 6f6e 2c20  n [on, left_on, 
-0002b820: 7269 6768 745f 6f6e 5d3a 0a20 2020 2020  right_on]:.     
-0002b830: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002b840: 286f 2c20 4672 616d 6542 6173 6529 3a0a  (o, FrameBase):.
-0002b850: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002b860: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0002b870: 4572 726f 7228 290a 2020 2020 6966 206e  Error().    if n
-0002b880: 6f74 206f 6e20 616e 6420 6e6f 7420 6c65  ot on and not le
-0002b890: 6674 5f6f 6e20 616e 6420 6e6f 7420 7269  ft_on and not ri
-0002b8a0: 6768 745f 6f6e 2061 6e64 206e 6f74 206c  ght_on and not l
-0002b8b0: 6566 745f 696e 6465 7820 616e 6420 6e6f  eft_index and no
-0002b8c0: 7420 7269 6768 745f 696e 6465 783a 0a20  t right_index:. 
-0002b8d0: 2020 2020 2020 206f 6e20 3d20 5b63 2066         on = [c f
-0002b8e0: 6f72 2063 2069 6e20 6c65 6674 2e63 6f6c  or c in left.col
-0002b8f0: 756d 6e73 2069 6620 6320 696e 2072 6967  umns if c in rig
-0002b900: 6874 2e63 6f6c 756d 6e73 5d0a 2020 2020  ht.columns].    
-0002b910: 2020 2020 6966 206e 6f74 206f 6e3a 0a20      if not on:. 
-0002b920: 2020 2020 2020 2020 2020 206c 6566 745f             left_
-0002b930: 696e 6465 7820 3d20 7269 6768 745f 696e  index = right_in
-0002b940: 6465 7820 3d20 5472 7565 0a0a 2020 2020  dex = True..    
-0002b950: 6966 206f 6e20 616e 6420 6e6f 7420 6c65  if on and not le
-0002b960: 6674 5f6f 6e20 616e 6420 6e6f 7420 7269  ft_on and not ri
-0002b970: 6768 745f 6f6e 3a0a 2020 2020 2020 2020  ght_on:.        
-0002b980: 6c65 6674 5f6f 6e20 3d20 7269 6768 745f  left_on = right_
-0002b990: 6f6e 203d 206f 6e0a 0a20 2020 2073 7570  on = on..    sup
-0002b9a0: 706f 7274 6564 5f68 6f77 203d 2028 226c  ported_how = ("l
-0002b9b0: 6566 7422 2c20 2272 6967 6874 222c 2022  eft", "right", "
-0002b9c0: 6f75 7465 7222 2c20 2269 6e6e 6572 222c  outer", "inner",
-0002b9d0: 2022 6c65 6674 7365 6d69 2229 0a20 2020   "leftsemi").   
-0002b9e0: 2069 6620 686f 7720 6e6f 7420 696e 2073   if how not in s
-0002b9f0: 7570 706f 7274 6564 5f68 6f77 3a0a 2020  upported_how:.  
-0002ba00: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002ba10: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0002ba20: 2020 2020 6622 6461 736b 2e64 6174 6166      f"dask.dataf
-0002ba30: 7261 6d65 2e6d 6572 6765 2064 6f65 7320  rame.merge does 
-0002ba40: 6e6f 7420 7375 7070 6f72 7420 686f 773d  not support how=
-0002ba50: 277b 686f 777d 272e 220a 2020 2020 2020  '{how}'.".      
-0002ba60: 2020 2020 2020 6622 4f70 7469 6f6e 7320        f"Options 
-0002ba70: 6172 653a 207b 7375 7070 6f72 7465 645f  are: {supported_
-0002ba80: 686f 777d 2e22 0a20 2020 2020 2020 2029  how}.".        )
-0002ba90: 0a0a 2020 2020 6966 2068 6f77 203d 3d20  ..    if how == 
-0002baa0: 226c 6566 7473 656d 6922 3a0a 2020 2020  "leftsemi":.    
-0002bab0: 2020 2020 6966 2072 6967 6874 5f69 6e64      if right_ind
-0002bac0: 6578 206f 7220 616e 7928 0a20 2020 2020  ex or any(.     
-0002bad0: 2020 2020 2020 206f 206e 6f74 2069 6e20         o not in 
-0002bae0: 7269 6768 742e 636f 6c75 6d6e 7320 666f  right.columns fo
-0002baf0: 7220 6f20 696e 205f 636f 6e76 6572 745f  r o in _convert_
-0002bb00: 746f 5f6c 6973 7428 7269 6768 745f 6f6e  to_list(right_on
-0002bb10: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-0002bb20: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0002bb30: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002bb40: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002bb50: 2020 2020 2268 6f77 3d27 6c65 6674 7365      "how='leftse
-0002bb60: 6d69 2720 646f 6573 206e 6f74 2073 7570  mi' does not sup
-0002bb70: 706f 7274 2072 6967 6874 5f69 6e64 6578  port right_index
-0002bb80: 3d54 7275 6520 6f72 206f 6e20 636f 6c75  =True or on colu
-0002bb90: 6d6e 7320 6672 6f6d 2074 6865 2069 6e64  mns from the ind
-0002bba0: 6578 220a 2020 2020 2020 2020 2020 2020  ex".            
-0002bbb0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0002bbc0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-0002bbd0: 7420 3d20 7269 6768 745b 5f63 6f6e 7665  t = right[_conve
-0002bbe0: 7274 5f74 6f5f 6c69 7374 2872 6967 6874  rt_to_list(right
-0002bbf0: 5f6f 6e29 5d2e 7265 6e61 6d65 280a 2020  _on)].rename(.  
-0002bc00: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0002bc10: 6c75 6d6e 733d 6469 6374 287a 6970 285f  lumns=dict(zip(_
-0002bc20: 636f 6e76 6572 745f 746f 5f6c 6973 7428  convert_to_list(
-0002bc30: 7269 6768 745f 6f6e 292c 205f 636f 6e76  right_on), _conv
-0002bc40: 6572 745f 746f 5f6c 6973 7428 6c65 6674  ert_to_list(left
-0002bc50: 5f6f 6e29 2929 0a20 2020 2020 2020 2020  _on))).         
-0002bc60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0002bc70: 2072 6967 6874 5f6f 6e20 3d20 6c65 6674   right_on = left
-0002bc80: 5f6f 6e0a 0a20 2020 2023 2054 7261 6e73  _on..    # Trans
-0002bc90: 666f 726d 2070 616e 6461 7320 6f62 6a65  form pandas obje
-0002bca0: 6374 7320 696e 746f 2064 6173 6b2e 6461  cts into dask.da
-0002bcb0: 7461 6672 616d 6520 6f62 6a65 6374 730a  taframe objects.
-0002bcc0: 2020 2020 6966 206e 6f74 2069 735f 6461      if not is_da
-0002bcd0: 736b 5f63 6f6c 6c65 6374 696f 6e28 6c65  sk_collection(le
-0002bce0: 6674 293a 0a20 2020 2020 2020 2069 6620  ft):.        if 
-0002bcf0: 7269 6768 745f 696e 6465 7820 616e 6420  right_index and 
-0002bd00: 6c65 6674 5f6f 6e3a 2020 2320 6368 616e  left_on:  # chan
-0002bd10: 6765 2074 6f20 6a6f 696e 206f 6e20 696e  ge to join on in
-0002bd20: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
-0002bd30: 6c65 6674 203d 206c 6566 742e 7365 745f  left = left.set_
-0002bd40: 696e 6465 7828 6c65 6674 5b6c 6566 745f  index(left[left_
-0002bd50: 6f6e 5d29 0a20 2020 2020 2020 2020 2020  on]).           
-0002bd60: 206c 6566 745f 6f6e 203d 204e 6f6e 650a   left_on = None.
-0002bd70: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-0002bd80: 5f69 6e64 6578 203d 2054 7275 650a 2020  _index = True.  
-0002bd90: 2020 2020 2020 6c65 6674 203d 2066 726f        left = fro
-0002bda0: 6d5f 7061 6e64 6173 286c 6566 742c 206e  m_pandas(left, n
-0002bdb0: 7061 7274 6974 696f 6e73 3d31 290a 0a20  partitions=1).. 
-0002bdc0: 2020 2069 6620 6e6f 7420 6973 5f64 6173     if not is_das
-0002bdd0: 6b5f 636f 6c6c 6563 7469 6f6e 2872 6967  k_collection(rig
-0002bde0: 6874 293a 0a20 2020 2020 2020 2069 6620  ht):.        if 
-0002bdf0: 6c65 6674 5f69 6e64 6578 2061 6e64 2072  left_index and r
-0002be00: 6967 6874 5f6f 6e3a 2020 2320 6368 616e  ight_on:  # chan
-0002be10: 6765 2074 6f20 6a6f 696e 206f 6e20 696e  ge to join on in
-0002be20: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
-0002be30: 7269 6768 7420 3d20 7269 6768 742e 7365  right = right.se
-0002be40: 745f 696e 6465 7828 7269 6768 745b 7269  t_index(right[ri
-0002be50: 6768 745f 6f6e 5d29 0a20 2020 2020 2020  ght_on]).       
-0002be60: 2020 2020 2072 6967 6874 5f6f 6e20 3d20       right_on = 
-0002be70: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-0002be80: 2072 6967 6874 5f69 6e64 6578 203d 2054   right_index = T
-0002be90: 7275 650a 2020 2020 2020 2020 7269 6768  rue.        righ
-0002bea0: 7420 3d20 6672 6f6d 5f70 616e 6461 7328  t = from_pandas(
-0002beb0: 7269 6768 742c 206e 7061 7274 6974 696f  right, npartitio
-0002bec0: 6e73 3d31 290a 0a20 2020 2061 7373 6572  ns=1)..    asser
-0002bed0: 7420 6973 5f64 6174 6166 7261 6d65 5f6c  t is_dataframe_l
-0002bee0: 696b 6528 7269 6768 742e 5f6d 6574 6129  ike(right._meta)
-0002bef0: 0a20 2020 2069 6620 6c65 6674 5f6f 6e20  .    if left_on 
-0002bf00: 616e 6420 7269 6768 745f 6f6e 3a0a 2020  and right_on:.  
-0002bf10: 2020 2020 2020 7761 726e 5f64 7479 7065        warn_dtype
-0002bf20: 5f6d 6973 6d61 7463 6828 6c65 6674 2c20  _mismatch(left, 
-0002bf30: 7269 6768 742c 206c 6566 745f 6f6e 2c20  right, left_on, 
-0002bf40: 7269 6768 745f 6f6e 290a 0a20 2020 2072  right_on)..    r
-0002bf50: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0002bf60: 7469 6f6e 280a 2020 2020 2020 2020 4d65  tion(.        Me
-0002bf70: 7267 6528 0a20 2020 2020 2020 2020 2020  rge(.           
-0002bf80: 206c 6566 742c 0a20 2020 2020 2020 2020   left,.         
-0002bf90: 2020 2072 6967 6874 2c0a 2020 2020 2020     right,.      
-0002bfa0: 2020 2020 2020 686f 773d 686f 772c 0a20        how=how,. 
-0002bfb0: 2020 2020 2020 2020 2020 206c 6566 745f             left_
-0002bfc0: 6f6e 3d6c 6566 745f 6f6e 2c0a 2020 2020  on=left_on,.    
-0002bfd0: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
-0002bfe0: 3d72 6967 6874 5f6f 6e2c 0a20 2020 2020  =right_on,.     
-0002bff0: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
-0002c000: 783d 6c65 6674 5f69 6e64 6578 2c0a 2020  x=left_index,.  
-0002c010: 2020 2020 2020 2020 2020 7269 6768 745f            right_
-0002c020: 696e 6465 783d 7269 6768 745f 696e 6465  index=right_inde
-0002c030: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
-0002c040: 7566 6669 7865 733d 7375 6666 6978 6573  uffixes=suffixes
-0002c050: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-0002c060: 6469 6361 746f 723d 696e 6469 6361 746f  dicator=indicato
-0002c070: 722c 0a20 2020 2020 2020 2020 2020 2073  r,.            s
-0002c080: 6875 6666 6c65 5f6d 6574 686f 643d 6765  huffle_method=ge
-0002c090: 745f 7370 6563 6966 6965 645f 7368 7566  t_specified_shuf
-0002c0a0: 666c 6528 7368 7566 666c 655f 6d65 7468  fle(shuffle_meth
-0002c0b0: 6f64 292c 0a20 2020 2020 2020 2020 2020  od),.           
-0002c0c0: 205f 6e70 6172 7469 7469 6f6e 733d 6e70   _npartitions=np
-0002c0d0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0002c0e0: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
-0002c0f0: 3d62 726f 6164 6361 7374 2c0a 2020 2020  =broadcast,.    
-0002c100: 2020 2020 290a 2020 2020 290a 0a0a 6465      ).    )...de
-0002c110: 6620 6d65 7267 655f 6173 6f66 280a 2020  f merge_asof(.  
-0002c120: 2020 6c65 6674 2c0a 2020 2020 7269 6768    left,.    righ
-0002c130: 742c 0a20 2020 206f 6e3d 4e6f 6e65 2c0a  t,.    on=None,.
-0002c140: 2020 2020 6c65 6674 5f6f 6e3d 4e6f 6e65      left_on=None
-0002c150: 2c0a 2020 2020 7269 6768 745f 6f6e 3d4e  ,.    right_on=N
-0002c160: 6f6e 652c 0a20 2020 206c 6566 745f 696e  one,.    left_in
-0002c170: 6465 783d 4661 6c73 652c 0a20 2020 2072  dex=False,.    r
-0002c180: 6967 6874 5f69 6e64 6578 3d46 616c 7365  ight_index=False
-0002c190: 2c0a 2020 2020 6279 3d4e 6f6e 652c 0a20  ,.    by=None,. 
-0002c1a0: 2020 206c 6566 745f 6279 3d4e 6f6e 652c     left_by=None,
-0002c1b0: 0a20 2020 2072 6967 6874 5f62 793d 4e6f  .    right_by=No
-0002c1c0: 6e65 2c0a 2020 2020 7375 6666 6978 6573  ne,.    suffixes
-0002c1d0: 3d28 225f 7822 2c20 225f 7922 292c 0a20  =("_x", "_y"),. 
-0002c1e0: 2020 2074 6f6c 6572 616e 6365 3d4e 6f6e     tolerance=Non
-0002c1f0: 652c 0a20 2020 2061 6c6c 6f77 5f65 7861  e,.    allow_exa
-0002c200: 6374 5f6d 6174 6368 6573 3d54 7275 652c  ct_matches=True,
-0002c210: 0a20 2020 2064 6972 6563 7469 6f6e 3d22  .    direction="
-0002c220: 6261 636b 7761 7264 222c 0a29 3a0a 2020  backward",.):.  
-0002c230: 2020 6966 2064 6972 6563 7469 6f6e 206e    if direction n
-0002c240: 6f74 2069 6e20 5b22 6261 636b 7761 7264  ot in ["backward
-0002c250: 222c 2022 666f 7277 6172 6422 2c20 226e  ", "forward", "n
-0002c260: 6561 7265 7374 225d 3a0a 2020 2020 2020  earest"]:.      
-0002c270: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002c280: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0002c290: 2249 6e76 616c 6964 206d 6572 6765 5f61  "Invalid merge_a
-0002c2a0: 736f 6620 6469 7265 6374 696f 6e2e 2043  sof direction. C
-0002c2b0: 686f 6f73 6520 6672 6f6d 2027 6261 636b  hoose from 'back
-0002c2c0: 7761 7264 2722 0a20 2020 2020 2020 2020  ward'".         
-0002c2d0: 2020 2022 2027 666f 7277 6172 6427 2c20     " 'forward', 
-0002c2e0: 6f72 2027 6e65 6172 6573 7427 220a 2020  or 'nearest'".  
-0002c2f0: 2020 2020 2020 290a 0a20 2020 206b 7761        )..    kwa
-0002c300: 7267 7320 3d20 7b0a 2020 2020 2020 2020  rgs = {.        
-0002c310: 226f 6e22 3a20 6f6e 2c0a 2020 2020 2020  "on": on,.      
-0002c320: 2020 226c 6566 745f 6f6e 223a 206c 6566    "left_on": lef
-0002c330: 745f 6f6e 2c0a 2020 2020 2020 2020 2272  t_on,.        "r
-0002c340: 6967 6874 5f6f 6e22 3a20 7269 6768 745f  ight_on": right_
-0002c350: 6f6e 2c0a 2020 2020 2020 2020 226c 6566  on,.        "lef
-0002c360: 745f 696e 6465 7822 3a20 6c65 6674 5f69  t_index": left_i
-0002c370: 6e64 6578 2c0a 2020 2020 2020 2020 2272  ndex,.        "r
-0002c380: 6967 6874 5f69 6e64 6578 223a 2072 6967  ight_index": rig
-0002c390: 6874 5f69 6e64 6578 2c0a 2020 2020 2020  ht_index,.      
-0002c3a0: 2020 2262 7922 3a20 6279 2c0a 2020 2020    "by": by,.    
-0002c3b0: 2020 2020 226c 6566 745f 6279 223a 206c      "left_by": l
-0002c3c0: 6566 745f 6279 2c0a 2020 2020 2020 2020  eft_by,.        
-0002c3d0: 2272 6967 6874 5f62 7922 3a20 7269 6768  "right_by": righ
-0002c3e0: 745f 6279 2c0a 2020 2020 2020 2020 2273  t_by,.        "s
-0002c3f0: 7566 6669 7865 7322 3a20 7375 6666 6978  uffixes": suffix
-0002c400: 6573 2c0a 2020 2020 2020 2020 2274 6f6c  es,.        "tol
-0002c410: 6572 616e 6365 223a 2074 6f6c 6572 616e  erance": toleran
-0002c420: 6365 2c0a 2020 2020 2020 2020 2261 6c6c  ce,.        "all
-0002c430: 6f77 5f65 7861 6374 5f6d 6174 6368 6573  ow_exact_matches
-0002c440: 223a 2061 6c6c 6f77 5f65 7861 6374 5f6d  ": allow_exact_m
-0002c450: 6174 6368 6573 2c0a 2020 2020 2020 2020  atches,.        
-0002c460: 2264 6972 6563 7469 6f6e 223a 2064 6972  "direction": dir
-0002c470: 6563 7469 6f6e 2c0a 2020 2020 7d0a 0a20  ection,.    }.. 
-0002c480: 2020 2069 6620 6c65 6674 2069 7320 4e6f     if left is No
-0002c490: 6e65 206f 7220 7269 6768 7420 6973 204e  ne or right is N
-0002c4a0: 6f6e 653a 0a20 2020 2020 2020 2072 6169  one:.        rai
-0002c4b0: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
-0002c4c0: 616e 6e6f 7420 6d65 7267 655f 6173 6f66  annot merge_asof
-0002c4d0: 206f 6e20 4e6f 6e65 2229 0a0a 2020 2020   on None")..    
-0002c4e0: 2320 6966 2069 735f 6461 7461 6672 616d  # if is_datafram
-0002c4f0: 655f 6c69 6b65 286c 6566 7429 2061 6e64  e_like(left) and
-0002c500: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-0002c510: 6b65 2872 6967 6874 293a 0a20 2020 2069  ke(right):.    i
-0002c520: 6620 6973 696e 7374 616e 6365 286c 6566  f isinstance(lef
-0002c530: 742c 2070 642e 4461 7461 4672 616d 6529  t, pd.DataFrame)
-0002c540: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-0002c550: 7269 6768 742c 2070 642e 4461 7461 4672  right, pd.DataFr
-0002c560: 616d 6529 3a0a 2020 2020 2020 2020 7265  ame):.        re
-0002c570: 7475 726e 2070 642e 6d65 7267 655f 6173  turn pd.merge_as
-0002c580: 6f66 286c 6566 742c 2072 6967 6874 2c20  of(left, right, 
-0002c590: 2a2a 6b77 6172 6773 290a 0a20 2020 2069  **kwargs)..    i
-0002c5a0: 6620 6f6e 2069 7320 6e6f 7420 4e6f 6e65  f on is not None
-0002c5b0: 3a0a 2020 2020 2020 2020 6966 206c 6566  :.        if lef
-0002c5c0: 745f 6f6e 2069 7320 6e6f 7420 4e6f 6e65  t_on is not None
-0002c5d0: 206f 7220 7269 6768 745f 6f6e 2069 7320   or right_on is 
-0002c5e0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0002c5f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002c600: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0002c610: 2020 2020 2020 2020 2243 616e 206f 6e6c          "Can onl
-0002c620: 7920 7061 7373 2061 7267 756d 656e 7420  y pass argument 
-0002c630: 276f 6e27 204f 5220 276c 6566 745f 6f6e  'on' OR 'left_on
-0002c640: 2720 616e 6420 2772 6967 6874 5f6f 6e27  ' and 'right_on'
-0002c650: 2c20 6e6f 7420 6120 220a 2020 2020 2020  , not a ".      
-0002c660: 2020 2020 2020 2020 2020 2263 6f6d 6269            "combi
-0002c670: 6e61 7469 6f6e 206f 6620 626f 7468 2e22  nation of both."
-0002c680: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0002c690: 2020 2020 2020 206c 6566 745f 6f6e 203d         left_on =
-0002c6a0: 2072 6967 6874 5f6f 6e20 3d20 6f6e 0a20   right_on = on. 
-0002c6b0: 2020 2020 2020 206b 7761 7267 735b 226c         kwargs["l
-0002c6c0: 6566 745f 6f6e 225d 203d 206c 6566 745f  eft_on"] = left_
-0002c6d0: 6f6e 0a20 2020 2020 2020 206b 7761 7267  on.        kwarg
-0002c6e0: 735b 2272 6967 6874 5f6f 6e22 5d20 3d20  s["right_on"] = 
-0002c6f0: 7269 6768 745f 6f6e 0a20 2020 2064 656c  right_on.    del
-0002c700: 206b 7761 7267 735b 226f 6e22 5d0a 0a20   kwargs["on"].. 
-0002c710: 2020 2066 6f72 206f 2069 6e20 5b6c 6566     for o in [lef
-0002c720: 745f 6f6e 2c20 7269 6768 745f 6f6e 5d3a  t_on, right_on]:
-0002c730: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0002c740: 7374 616e 6365 286f 2c20 5f46 7261 6d65  stance(o, _Frame
-0002c750: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0002c760: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-0002c770: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-0002c780: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
-0002c790: 636f 6c6c 6563 7469 6f6e 7320 6e6f 7420  collections not 
-0002c7a0: 6375 7272 656e 746c 7920 616c 6c6f 7765  currently allowe
-0002c7b0: 6420 696e 206d 6572 6765 2063 6f6c 756d  d in merge colum
-0002c7c0: 6e73 220a 2020 2020 2020 2020 2020 2020  ns".            
-0002c7d0: 290a 0a20 2020 2069 6620 6e6f 7420 6973  )..    if not is
-0002c7e0: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
-0002c7f0: 286c 6566 7429 3a0a 2020 2020 2020 2020  (left):.        
-0002c800: 6c65 6674 203d 2066 726f 6d5f 7061 6e64  left = from_pand
-0002c810: 6173 286c 6566 742c 206e 7061 7274 6974  as(left, npartit
-0002c820: 696f 6e73 3d31 290a 0a20 2020 2069 6620  ions=1)..    if 
-0002c830: 6e6f 7420 6973 5f64 6173 6b5f 636f 6c6c  not is_dask_coll
-0002c840: 6563 7469 6f6e 2872 6967 6874 293a 0a20  ection(right):. 
-0002c850: 2020 2020 2020 2072 6967 6874 203d 2066         right = f
-0002c860: 726f 6d5f 7061 6e64 6173 2872 6967 6874  rom_pandas(right
-0002c870: 2c20 6e70 6172 7469 7469 6f6e 733d 3129  , npartitions=1)
-0002c880: 0a0a 2020 2020 6966 2062 7920 6973 206e  ..    if by is n
-0002c890: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0002c8a0: 2069 6620 6c65 6674 5f62 7920 6973 206e   if left_by is n
-0002c8b0: 6f74 204e 6f6e 6520 6f72 2072 6967 6874  ot None or right
-0002c8c0: 5f62 7920 6973 206e 6f74 204e 6f6e 653a  _by is not None:
-0002c8d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002c8e0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0002c8f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002c900: 4361 6e20 6f6e 6c79 2070 6173 7320 6172  Can only pass ar
-0002c910: 6775 6d65 6e74 2027 6279 2720 4f52 2027  gument 'by' OR '
-0002c920: 6c65 6674 5f62 7927 2061 6e64 2027 7269  left_by' and 'ri
-0002c930: 6768 745f 6279 272c 206e 6f74 2061 2063  ght_by', not a c
-0002c940: 6f6d 6269 6e61 7469 6f6e 206f 6620 626f  ombination of bo
-0002c950: 7468 2e22 0a20 2020 2020 2020 2020 2020  th.".           
-0002c960: 2029 0a20 2020 2020 2020 206b 7761 7267   ).        kwarg
-0002c970: 735b 226c 6566 745f 6279 225d 203d 206b  s["left_by"] = k
-0002c980: 7761 7267 735b 2272 6967 6874 5f62 7922  wargs["right_by"
-0002c990: 5d20 3d20 6279 0a20 2020 2064 656c 206b  ] = by.    del k
-0002c9a0: 7761 7267 735b 2262 7922 5d0a 0a20 2020  wargs["by"]..   
-0002c9b0: 2069 6620 6c65 6674 5f62 7920 6973 204e   if left_by is N
-0002c9c0: 6f6e 6520 616e 6420 7269 6768 745f 6279  one and right_by
-0002c9d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0002c9e0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002c9f0: 6545 7272 6f72 2822 4d75 7374 2073 7065  eError("Must spe
-0002ca00: 6369 6679 2062 6f74 6820 6c65 6674 5f6f  cify both left_o
-0002ca10: 6e20 616e 6420 7269 6768 745f 6f6e 2069  n and right_on i
-0002ca20: 6620 6f6e 6520 6973 2073 7065 6369 6669  f one is specifi
-0002ca30: 6564 2e22 290a 2020 2020 6966 206c 6566  ed.").    if lef
-0002ca40: 745f 6279 2069 7320 6e6f 7420 4e6f 6e65  t_by is not None
-0002ca50: 2061 6e64 2072 6967 6874 5f62 7920 6973   and right_by is
-0002ca60: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
-0002ca70: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002ca80: 224d 7573 7420 7370 6563 6966 7920 626f  "Must specify bo
-0002ca90: 7468 206c 6566 745f 6f6e 2061 6e64 2072  th left_on and r
-0002caa0: 6967 6874 5f6f 6e20 6966 206f 6e65 2069  ight_on if one i
-0002cab0: 7320 7370 6563 6966 6965 642e 2229 0a0a  s specified.")..
-0002cac0: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
-0002cad0: 7072 2e5f 6d65 7267 655f 6173 6f66 2069  pr._merge_asof i
-0002cae0: 6d70 6f72 7420 4d65 7267 6541 736f 660a  mport MergeAsof.
-0002caf0: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
-0002cb00: 636f 6c6c 6563 7469 6f6e 284d 6572 6765  collection(Merge
-0002cb10: 4173 6f66 286c 6566 742c 2072 6967 6874  Asof(left, right
-0002cb20: 2c20 2a2a 6b77 6172 6773 2929 0a0a 0a64  , **kwargs))...d
-0002cb30: 6566 2066 726f 6d5f 6d61 7028 0a20 2020  ef from_map(.   
-0002cb40: 2066 756e 632c 0a20 2020 202a 6974 6572   func,.    *iter
-0002cb50: 6162 6c65 732c 0a20 2020 2061 7267 733d  ables,.    args=
-0002cb60: 4e6f 6e65 2c0a 2020 2020 6d65 7461 3d6e  None,.    meta=n
-0002cb70: 6f5f 6465 6661 756c 742c 0a20 2020 2064  o_default,.    d
-0002cb80: 6976 6973 696f 6e73 3d4e 6f6e 652c 0a20  ivisions=None,. 
-0002cb90: 2020 206c 6162 656c 3d4e 6f6e 652c 0a20     label=None,. 
-0002cba0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-0002cbb0: 6174 613d 4661 6c73 652c 0a20 2020 202a  ata=False,.    *
-0002cbc0: 2a6b 7761 7267 732c 0a29 3a0a 2020 2020  *kwargs,.):.    
-0002cbd0: 2222 2243 7265 6174 6520 6120 6461 736b  """Create a dask
-0002cbe0: 2d65 7870 7220 636f 6c6c 6563 7469 6f6e  -expr collection
-0002cbf0: 2066 726f 6d20 6120 6375 7374 6f6d 2066   from a custom f
-0002cc00: 756e 6374 696f 6e20 6d61 700a 0a20 2020  unction map..   
-0002cc10: 204e 4f54 453a 2054 6865 2075 6e64 6572   NOTE: The under
-0002cc20: 6c79 696e 6720 6060 4578 7072 6060 206f  lying ``Expr`` o
-0002cc30: 626a 6563 7420 7072 6f64 7563 6564 2062  bject produced b
-0002cc40: 7920 7468 6973 2041 5049 0a20 2020 2077  y this API.    w
-0002cc50: 696c 6c20 7375 7070 6f72 7420 636f 6c75  ill support colu
-0002cc60: 6d6e 2070 726f 6a65 6374 696f 6e20 2876  mn projection (v
-0002cc70: 6961 2060 6073 696d 706c 6966 7960 6029  ia ``simplify``)
-0002cc80: 2069 660a 2020 2020 7468 6520 6060 6675   if.    the ``fu
-0002cc90: 6e63 6060 2061 7267 756d 656e 7420 6861  nc`` argument ha
-0002cca0: 7320 2263 6f6c 756d 6e73 2220 696e 2069  s "columns" in i
-0002ccb0: 7473 2073 6967 6e61 7475 7265 2e0a 0a20  ts signature... 
-0002ccc0: 2020 2022 2222 0a20 2020 2066 726f 6d20     """.    from 
-0002ccd0: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
-0002cce0: 6f2e 7574 696c 7320 696d 706f 7274 2044  o.utils import D
-0002ccf0: 6174 6146 7261 6d65 494f 4675 6e63 7469  ataFrameIOFuncti
-0002cd00: 6f6e 0a0a 2020 2020 6672 6f6d 2064 6173  on..    from das
-0002cd10: 6b5f 6578 7072 2e69 6f20 696d 706f 7274  k_expr.io import
-0002cd20: 2046 726f 6d4d 6170 2c20 4672 6f6d 4d61   FromMap, FromMa
-0002cd30: 7050 726f 6a65 6374 6162 6c65 0a0a 2020  pProjectable..  
-0002cd40: 2020 6966 2022 746f 6b65 6e22 2069 6e20    if "token" in 
-0002cd50: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
-0002cd60: 2320 5468 6973 206f 7074 696f 6e20 646f  # This option do
-0002cd70: 6573 6e27 7420 7265 616c 6c79 206d 616b  esn't really mak
-0002cd80: 6520 7365 6e73 6520 696e 2064 6173 6b2d  e sense in dask-
-0002cd90: 6578 7072 0a20 2020 2020 2020 2072 6169  expr.        rai
-0002cda0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0002cdb0: 6445 7272 6f72 2822 6461 736b 5f65 7870  dError("dask_exp
-0002cdc0: 7220 646f 6573 206e 6f74 2073 7570 706f  r does not suppo
-0002cdd0: 7274 2061 2074 6f6b 656e 2061 7267 756d  rt a token argum
-0002cde0: 656e 742e 2229 0a0a 2020 2020 6c65 6e67  ent.")..    leng
-0002cdf0: 7468 7320 3d20 7365 7428 290a 2020 2020  ths = set().    
-0002ce00: 6974 6572 6162 6c65 7320 3d20 6c69 7374  iterables = list
-0002ce10: 2869 7465 7261 626c 6573 290a 2020 2020  (iterables).    
-0002ce20: 666f 7220 692c 2069 7465 7261 626c 6520  for i, iterable 
-0002ce30: 696e 2065 6e75 6d65 7261 7465 2869 7465  in enumerate(ite
-0002ce40: 7261 626c 6573 293a 0a20 2020 2020 2020  rables):.       
-0002ce50: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0002ce60: 6365 2869 7465 7261 626c 652c 2049 7465  ce(iterable, Ite
-0002ce70: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
-0002ce80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002ce90: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002cea0: 2020 2020 2020 6622 416c 6c20 656c 656d        f"All elem
-0002ceb0: 656e 7473 206f 6620 6069 7465 7261 626c  ents of `iterabl
-0002cec0: 6573 6020 6d75 7374 2062 6520 4974 6572  es` must be Iter
-0002ced0: 6162 6c65 2c20 676f 7420 7b74 7970 6528  able, got {type(
-0002cee0: 6974 6572 6162 6c65 297d 220a 2020 2020  iterable)}".    
-0002cef0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002cf00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0002cf10: 2020 206c 656e 6774 6873 2e61 6464 286c     lengths.add(l
-0002cf20: 656e 2869 7465 7261 626c 6529 290a 2020  en(iterable)).  
-0002cf30: 2020 2020 2020 6578 6365 7074 2028 4174        except (At
-0002cf40: 7472 6962 7574 6545 7272 6f72 2c20 5479  tributeError, Ty
-0002cf50: 7065 4572 726f 7229 3a0a 2020 2020 2020  peError):.      
-0002cf60: 2020 2020 2020 6974 6572 6162 6c65 735b        iterables[
-0002cf70: 695d 203d 206c 6973 7428 6974 6572 6162  i] = list(iterab
-0002cf80: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-0002cf90: 6c65 6e67 7468 732e 6164 6428 6c65 6e28  lengths.add(len(
-0002cfa0: 6974 6572 6162 6c65 735b 695d 2929 0a20  iterables[i])). 
-0002cfb0: 2020 2069 6620 6c65 6e28 6c65 6e67 7468     if len(length
-0002cfc0: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
-0002cfd0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002cfe0: 7228 2260 6672 6f6d 5f6d 6170 6020 7265  r("`from_map` re
-0002cff0: 7175 6972 6573 2061 7420 6c65 6173 7420  quires at least 
-0002d000: 6f6e 6520 4974 6572 6162 6c65 2069 6e70  one Iterable inp
-0002d010: 7574 2229 0a20 2020 2065 6c69 6620 6c65  ut").    elif le
-0002d020: 6e28 6c65 6e67 7468 7329 203e 2031 3a0a  n(lengths) > 1:.
-0002d030: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002d040: 6c75 6545 7272 6f72 2822 416c 6c20 6069  lueError("All `i
-0002d050: 7465 7261 626c 6573 6020 6d75 7374 2068  terables` must h
-0002d060: 6176 6520 7468 6520 7361 6d65 206c 656e  ave the same len
-0002d070: 6774 6822 290a 2020 2020 6966 206c 656e  gth").    if len
-0002d080: 6774 6873 203d 3d20 7b30 7d3a 0a20 2020  gths == {0}:.   
-0002d090: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002d0a0: 4572 726f 7228 2241 6c6c 2060 6974 6572  Error("All `iter
-0002d0b0: 6162 6c65 7360 206d 7573 7420 6861 7665  ables` must have
-0002d0c0: 2061 206e 6f6e 2d7a 6572 6f20 6c65 6e67   a non-zero leng
-0002d0d0: 7468 2229 0a0a 2020 2020 2320 4368 6563  th")..    # Chec
-0002d0e0: 6b20 6966 2060 6675 6e63 6020 7375 7070  k if `func` supp
-0002d0f0: 6f72 7473 2063 6f6c 756d 6e20 7072 6f6a  orts column proj
-0002d100: 6563 7469 6f6e 0a20 2020 2061 6c6c 6f77  ection.    allow
-0002d110: 5f70 726f 6a65 6374 696f 6e20 3d20 4661  _projection = Fa
-0002d120: 6c73 650a 2020 2020 636f 6c75 6d6e 735f  lse.    columns_
-0002d130: 6172 675f 7265 7175 6972 6564 203d 2046  arg_required = F
-0002d140: 616c 7365 0a20 2020 2069 6620 7061 7261  alse.    if para
-0002d150: 6d20 3a3d 2069 6e73 7065 6374 2e73 6967  m := inspect.sig
-0002d160: 6e61 7475 7265 2866 756e 6329 2e70 6172  nature(func).par
-0002d170: 616d 6574 6572 732e 6765 7428 2263 6f6c  ameters.get("col
-0002d180: 756d 6e73 222c 204e 6f6e 6529 3a0a 2020  umns", None):.  
-0002d190: 2020 2020 2020 616c 6c6f 775f 7072 6f6a        allow_proj
-0002d1a0: 6563 7469 6f6e 203d 2054 7275 650a 2020  ection = True.  
-0002d1b0: 2020 2020 2020 636f 6c75 6d6e 735f 6172        columns_ar
-0002d1c0: 675f 7265 7175 6972 6564 203d 2070 6172  g_required = par
-0002d1d0: 616d 2e64 6566 6175 6c74 2069 7320 7061  am.default is pa
-0002d1e0: 7261 6d2e 656d 7074 790a 2020 2020 2020  ram.empty.      
-0002d1f0: 2020 6966 206d 6574 6120 6973 206e 6f5f    if meta is no_
-0002d200: 6465 6661 756c 7420 616e 6420 636f 6c75  default and colu
-0002d210: 6d6e 735f 6172 675f 7265 7175 6972 6564  mns_arg_required
-0002d220: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002d230: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
-0002d240: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002d250: 4172 6775 6d65 6e74 2060 6675 6e63 6020  Argument `func` 
-0002d260: 6f66 2060 6672 6f6d 5f6d 6170 6020 6861  of `from_map` ha
-0002d270: 7320 6120 7265 7175 6972 6564 2060 636f  s a required `co
-0002d280: 6c75 6d6e 7360 2022 0a20 2020 2020 2020  lumns` ".       
-0002d290: 2020 2020 2020 2020 2022 2070 6172 616d           " param
-0002d2a0: 6574 6572 2061 6e64 206e 6f74 2060 6d65  eter and not `me
-0002d2b0: 7461 6020 7072 6f76 6964 6564 2e22 0a20  ta` provided.". 
-0002d2c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002d2d0: 4569 7468 6572 2070 726f 7669 6465 2060  Either provide `
-0002d2e0: 6d65 7461 6020 796f 7572 7365 6c66 206f  meta` yourself o
-0002d2f0: 7220 6d61 6b65 2060 636f 6c75 6d6e 7360  r make `columns`
-0002d300: 2061 6e20 6f70 7469 6f6e 616c 2061 7267   an optional arg
-0002d310: 756d 656e 742e 220a 2020 2020 2020 2020  ument.".        
-0002d320: 2020 2020 290a 2020 2020 656c 6966 2069      ).    elif i
-0002d330: 7369 6e73 7461 6e63 6528 6675 6e63 2c20  sinstance(func, 
-0002d340: 4461 7461 4672 616d 6549 4f46 756e 6374  DataFrameIOFunct
-0002d350: 696f 6e29 3a0a 2020 2020 2020 2020 7761  ion):.        wa
-0002d360: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-0002d370: 2020 2020 2020 2020 2022 6461 736b 5f65           "dask_e
-0002d380: 7870 7220 646f 6573 206e 6f74 2073 7570  xpr does not sup
-0002d390: 706f 7274 2074 6865 2044 6174 6146 7261  port the DataFra
-0002d3a0: 6d65 494f 4675 6e63 7469 6f6e 2022 0a20  meIOFunction ". 
-0002d3b0: 2020 2020 2020 2020 2020 2022 7072 6f74             "prot
-0002d3c0: 6f63 6f6c 2066 6f72 2063 6f6c 756d 6e20  ocol for column 
-0002d3d0: 7072 6f6a 6563 7469 6f6e 2e20 546f 2065  projection. To e
-0002d3e0: 6e61 626c 6520 636f 6c75 6d6e 2022 0a20  nable column ". 
-0002d3f0: 2020 2020 2020 2020 2020 2022 7072 6f6a             "proj
-0002d400: 6563 7469 6f6e 2c20 706c 6561 7365 2065  ection, please e
-0002d410: 6e73 7572 6520 7468 6174 2074 6865 2073  nsure that the s
-0002d420: 6967 6e61 7475 7265 206f 6620 6066 756e  ignature of `fun
-0002d430: 6360 2022 0a20 2020 2020 2020 2020 2020  c` ".           
-0002d440: 2022 696e 636c 7564 6573 2061 2060 636f   "includes a `co
-0002d450: 6c75 6d6e 733d 6020 6b65 7977 6f72 6420  lumns=` keyword 
-0002d460: 6172 6775 6d65 6e74 2069 6e73 7465 6164  argument instead
-0002d470: 2e22 0a20 2020 2020 2020 2029 0a20 2020  .".        ).   
-0002d480: 2065 6c73 653a 0a20 2020 2020 2020 2061   else:.        a
-0002d490: 6c6c 6f77 5f70 726f 6a65 6374 696f 6e20  llow_projection 
-0002d4a0: 3d20 4661 6c73 650a 0a20 2020 2061 7267  = False..    arg
-0002d4b0: 7320 3d20 5b5d 2069 6620 6172 6773 2069  s = [] if args i
-0002d4c0: 7320 4e6f 6e65 2065 6c73 6520 6172 6773  s None else args
-0002d4d0: 0a20 2020 206b 7761 7267 7320 3d20 7b7d  .    kwargs = {}
-0002d4e0: 2069 6620 6b77 6172 6773 2069 7320 4e6f   if kwargs is No
-0002d4f0: 6e65 2065 6c73 6520 6b77 6172 6773 0a20  ne else kwargs. 
-0002d500: 2020 2069 6620 616c 6c6f 775f 7072 6f6a     if allow_proj
-0002d510: 6563 7469 6f6e 3a0a 2020 2020 2020 2020  ection:.        
-0002d520: 636f 6c75 6d6e 7320 3d20 6b77 6172 6773  columns = kwargs
-0002d530: 2e70 6f70 2822 636f 6c75 6d6e 7322 2c20  .pop("columns", 
-0002d540: 4e6f 6e65 290a 2020 2020 2020 2020 7265  None).        re
-0002d550: 7375 6c74 203d 206e 6577 5f63 6f6c 6c65  sult = new_colle
-0002d560: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-0002d570: 2020 2046 726f 6d4d 6170 5072 6f6a 6563     FromMapProjec
-0002d580: 7461 626c 6528 0a20 2020 2020 2020 2020  table(.         
-0002d590: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-0002d5a0: 2020 2020 2020 2020 2020 2020 2069 7465               ite
-0002d5b0: 7261 626c 6573 2c0a 2020 2020 2020 2020  rables,.        
-0002d5c0: 2020 2020 2020 2020 636f 6c75 6d6e 732c          columns,
-0002d5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d5e0: 2061 7267 732c 0a20 2020 2020 2020 2020   args,.         
-0002d5f0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
-0002d600: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0002d610: 6f6c 756d 6e73 5f61 7267 5f72 6571 7569  olumns_arg_requi
-0002d620: 7265 642c 0a20 2020 2020 2020 2020 2020  red,.           
-0002d630: 2020 2020 206d 6574 612c 0a20 2020 2020       meta,.     
-0002d640: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-0002d650: 6365 5f6d 6574 6164 6174 612c 0a20 2020  ce_metadata,.   
-0002d660: 2020 2020 2020 2020 2020 2020 2064 6976               div
-0002d670: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
-0002d680: 2020 2020 2020 2020 6c61 6265 6c2c 0a20          label,. 
-0002d690: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0002d6a0: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
-0002d6b0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-0002d6c0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-0002d6d0: 280a 2020 2020 2020 2020 2020 2020 4672  (.            Fr
-0002d6e0: 6f6d 4d61 7028 0a20 2020 2020 2020 2020  omMap(.         
-0002d6f0: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
-0002d700: 2020 2020 2020 2020 2020 2020 2069 7465               ite
-0002d710: 7261 626c 6573 2c0a 2020 2020 2020 2020  rables,.        
-0002d720: 2020 2020 2020 2020 6172 6773 2c0a 2020          args,.  
-0002d730: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
-0002d740: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
-0002d750: 2020 2020 2020 6d65 7461 2c0a 2020 2020        meta,.    
-0002d760: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-0002d770: 7263 655f 6d65 7461 6461 7461 2c0a 2020  rce_metadata,.  
-0002d780: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0002d790: 7669 7369 6f6e 732c 0a20 2020 2020 2020  visions,.       
-0002d7a0: 2020 2020 2020 2020 206c 6162 656c 2c0a           label,.
-0002d7b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002d7c0: 2020 2020 2020 290a 2020 2020 6966 2070        ).    if p
-0002d7d0: 7961 7272 6f77 5f73 7472 696e 6773 5f65  yarrow_strings_e
-0002d7e0: 6e61 626c 6564 2829 3a0a 2020 2020 2020  nabled():.      
-0002d7f0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-0002d800: 6c65 6374 696f 6e28 6578 7072 2e41 7272  lection(expr.Arr
-0002d810: 6f77 5374 7269 6e67 436f 6e76 6572 7369  owStringConversi
-0002d820: 6f6e 2872 6573 756c 7429 290a 2020 2020  on(result)).    
-0002d830: 7265 7475 726e 2072 6573 756c 740a 0a0a  return result...
-0002d840: 6465 6620 7265 7061 7274 6974 696f 6e28  def repartition(
-0002d850: 6466 2c20 6469 7669 7369 6f6e 732c 2066  df, divisions, f
-0002d860: 6f72 6365 3d46 616c 7365 293a 0a20 2020  orce=False):.   
-0002d870: 2022 2222 5265 7061 7274 6974 696f 6e20   """Repartition 
-0002d880: 6461 7461 6672 616d 6520 616c 6f6e 6720  dataframe along 
-0002d890: 6e65 7720 6469 7669 7369 6f6e 730a 0a20  new divisions.. 
-0002d8a0: 2020 2044 6173 6b2e 4461 7461 4672 616d     Dask.DataFram
-0002d8b0: 6520 6f62 6a65 6374 7320 6172 6520 7061  e objects are pa
-0002d8c0: 7274 6974 696f 6e65 6420 616c 6f6e 6720  rtitioned along 
-0002d8d0: 7468 6569 7220 696e 6465 782e 2020 4f66  their index.  Of
-0002d8e0: 7465 6e20 7768 656e 0a20 2020 206d 756c  ten when.    mul
-0002d8f0: 7469 706c 6520 6461 7461 6672 616d 6573  tiple dataframes
-0002d900: 2069 6e74 6572 6163 7420 7765 206e 6565   interact we nee
-0002d910: 6420 746f 2061 6c69 676e 2074 6865 7365  d to align these
-0002d920: 2070 6172 7469 7469 6f6e 696e 6773 2e20   partitionings. 
-0002d930: 2054 6865 0a20 2020 2060 6072 6570 6172   The.    ``repar
-0002d940: 7469 7469 6f6e 6060 2066 756e 6374 696f  tition`` functio
-0002d950: 6e20 636f 6e73 7472 7563 7473 2061 206e  n constructs a n
-0002d960: 6577 2044 6174 6146 7261 6d65 206f 626a  ew DataFrame obj
-0002d970: 6563 7420 686f 6c64 696e 6720 7468 6520  ect holding the 
-0002d980: 7361 6d65 0a20 2020 2064 6174 6120 6275  same.    data bu
-0002d990: 7420 7061 7274 6974 696f 6e65 6420 6f6e  t partitioned on
-0002d9a0: 2064 6966 6665 7265 6e74 2076 616c 7565   different value
-0002d9b0: 732e 2020 4974 2064 6f65 7320 7468 6973  s.  It does this
-0002d9c0: 2062 7920 7065 7266 6f72 6d69 6e67 2061   by performing a
-0002d9d0: 0a20 2020 2073 6571 7565 6e63 6520 6f66  .    sequence of
-0002d9e0: 2060 606c 6f63 6060 2061 6e64 2060 6063   ``loc`` and ``c
-0002d9f0: 6f6e 6361 7460 6020 6361 6c6c 7320 746f  oncat`` calls to
-0002da00: 2073 706c 6974 2061 6e64 206d 6572 6765   split and merge
-0002da10: 2074 6865 2070 7265 7669 6f75 730a 2020   the previous.  
-0002da20: 2020 6765 6e65 7261 7469 6f6e 206f 6620    generation of 
-0002da30: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
-0002da40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0002da50: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
-0002da60: 6469 7669 7369 6f6e 7320 3a20 6c69 7374  divisions : list
-0002da70: 0a20 2020 2020 2020 204c 6973 7420 6f66  .        List of
-0002da80: 2070 6172 7469 7469 6f6e 7320 746f 2062   partitions to b
-0002da90: 6520 7573 6564 0a20 2020 2066 6f72 6365  e used.    force
-0002daa0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0002dab0: 2046 616c 7365 0a20 2020 2020 2020 2041   False.        A
-0002dac0: 6c6c 6f77 7320 7468 6520 6578 7061 6e73  llows the expans
-0002dad0: 696f 6e20 6f66 2074 6865 2065 7869 7374  ion of the exist
-0002dae0: 696e 6720 6469 7669 7369 6f6e 732e 0a20  ing divisions.. 
-0002daf0: 2020 2020 2020 2049 6620 4661 6c73 6520         If False 
-0002db00: 7468 656e 2074 6865 206e 6577 2064 6976  then the new div
-0002db10: 6973 696f 6e73 206c 6f77 6572 2061 6e64  isions lower and
-0002db20: 2075 7070 6572 2062 6f75 6e64 7320 6d75   upper bounds mu
-0002db30: 7374 2062 650a 2020 2020 2020 2020 7468  st be.        th
-0002db40: 6520 7361 6d65 2061 7320 7468 6520 6f6c  e same as the ol
-0002db50: 6420 6469 7669 7369 6f6e 732e 0a0a 2020  d divisions...  
-0002db60: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-0002db70: 2d2d 2d2d 2d2d 2d0a 0a20 2020 203e 3e3e  -------..    >>>
-0002db80: 2064 6620 3d20 6466 2e72 6570 6172 7469   df = df.reparti
-0002db90: 7469 6f6e 285b 302c 2035 2c20 3130 2c20  tion([0, 5, 10, 
-0002dba0: 3230 5d29 2020 2320 646f 6374 6573 743a  20])  # doctest:
-0002dbb0: 202b 534b 4950 0a0a 2020 2020 416c 736f   +SKIP..    Also
-0002dbc0: 2077 6f72 6b73 206f 6e20 5061 6e64 6173   works on Pandas
-0002dbd0: 206f 626a 6563 7473 0a0a 2020 2020 3e3e   objects..    >>
-0002dbe0: 3e20 6464 6620 3d20 6464 2e72 6570 6172  > ddf = dd.repar
-0002dbf0: 7469 7469 6f6e 2864 662c 205b 302c 2035  tition(df, [0, 5
-0002dc00: 2c20 3130 2c20 3230 5d29 2020 2320 646f  , 10, 20])  # do
-0002dc10: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-0002dc20: 2022 2222 0a20 2020 2069 6620 6973 696e   """.    if isin
-0002dc30: 7374 616e 6365 2864 662c 2046 7261 6d65  stance(df, Frame
-0002dc40: 4261 7365 293a 0a20 2020 2020 2020 2072  Base):.        r
-0002dc50: 6574 7572 6e20 6466 2e72 6570 6172 7469  eturn df.reparti
-0002dc60: 7469 6f6e 2864 6976 6973 696f 6e73 3d64  tion(divisions=d
-0002dc70: 6976 6973 696f 6e73 2c20 666f 7263 653d  ivisions, force=
-0002dc80: 666f 7263 6529 0a20 2020 2065 6c69 6620  force).    elif 
-0002dc90: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0002dca0: 6528 6466 2920 6f72 2069 735f 7365 7269  e(df) or is_seri
-0002dcb0: 6573 5f6c 696b 6528 6466 293a 0a20 2020  es_like(df):.   
-0002dcc0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-0002dcd0: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
-0002dce0: 2020 2020 2020 2020 4672 6f6d 5061 6e64          FromPand
-0002dcf0: 6173 4469 7669 7369 6f6e 7328 0a20 2020  asDivisions(.   
-0002dd00: 2020 2020 2020 2020 2020 2020 205f 4261               _Ba
-0002dd10: 636b 656e 6444 6174 6128 6466 292c 0a20  ckendData(df),. 
-0002dd20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0002dd30: 6976 6973 696f 6e73 3d64 6976 6973 696f  ivisions=divisio
-0002dd40: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-0002dd50: 2020 2020 7079 6172 726f 775f 7374 7269      pyarrow_stri
-0002dd60: 6e67 735f 656e 6162 6c65 643d 7079 6172  ngs_enabled=pyar
-0002dd70: 726f 775f 7374 7269 6e67 735f 656e 6162  row_strings_enab
-0002dd80: 6c65 6428 292c 0a20 2020 2020 2020 2020  led(),.         
-0002dd90: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-0002dda0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002ddb0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0002ddc0: 656e 7465 6445 7272 6f72 2866 2272 6570  entedError(f"rep
-0002ddd0: 6172 7469 7469 6f6e 2069 7320 6e6f 7420  artition is not 
-0002dde0: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
-0002ddf0: 7b74 7970 6528 6466 297d 2e22 290a 0a0a  {type(df)}.")...
-0002de00: 6465 6620 7069 766f 745f 7461 626c 6528  def pivot_table(
-0002de10: 6466 2c20 696e 6465 782c 2063 6f6c 756d  df, index, colum
-0002de20: 6e73 2c20 7661 6c75 6573 2c20 6167 6766  ns, values, aggf
-0002de30: 756e 633d 226d 6561 6e22 293a 0a20 2020  unc="mean"):.   
-0002de40: 2069 6620 6e6f 7420 6973 5f73 6361 6c61   if not is_scala
-0002de50: 7228 696e 6465 7829 206f 7220 696e 6465  r(index) or inde
-0002de60: 7820 6e6f 7420 696e 2064 662e 5f6d 6574  x not in df._met
-0002de70: 612e 636f 6c75 6d6e 733a 0a20 2020 2020  a.columns:.     
-0002de80: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0002de90: 726f 7228 2227 696e 6465 7827 206d 7573  ror("'index' mus
-0002dea0: 7420 6265 2074 6865 206e 616d 6520 6f66  t be the name of
-0002deb0: 2061 6e20 6578 6973 7469 6e67 2063 6f6c   an existing col
-0002dec0: 756d 6e22 290a 2020 2020 6966 206e 6f74  umn").    if not
-0002ded0: 2069 735f 7363 616c 6172 2863 6f6c 756d   is_scalar(colum
-0002dee0: 6e73 2920 6f72 2063 6f6c 756d 6e73 206e  ns) or columns n
-0002def0: 6f74 2069 6e20 6466 2e5f 6d65 7461 2e63  ot in df._meta.c
-0002df00: 6f6c 756d 6e73 3a0a 2020 2020 2020 2020  olumns:.        
-0002df10: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0002df20: 2822 2763 6f6c 756d 6e73 2720 6d75 7374  ("'columns' must
-0002df30: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
-0002df40: 616e 2065 7869 7374 696e 6720 636f 6c75  an existing colu
-0002df50: 6d6e 2229 0a20 2020 2069 6620 6e6f 7420  mn").    if not 
-0002df60: 6d65 7468 6f64 732e 6973 5f63 6174 6567  methods.is_categ
-0002df70: 6f72 6963 616c 5f64 7479 7065 2864 662e  orical_dtype(df.
-0002df80: 5f6d 6574 615b 636f 6c75 6d6e 735d 293a  _meta[columns]):
-0002df90: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-0002dfa0: 616c 7565 4572 726f 7228 2227 636f 6c75  alueError("'colu
-0002dfb0: 6d6e 7327 206d 7573 7420 6265 2063 6174  mns' must be cat
-0002dfc0: 6567 6f72 7920 6474 7970 6522 290a 2020  egory dtype").  
-0002dfd0: 2020 6966 206e 6f74 2068 6173 5f6b 6e6f    if not has_kno
-0002dfe0: 776e 5f63 6174 6567 6f72 6965 7328 6466  wn_categories(df
-0002dff0: 2e5f 6d65 7461 5b63 6f6c 756d 6e73 5d29  ._meta[columns])
-0002e000: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0002e010: 5661 6c75 6545 7272 6f72 2822 2763 6f6c  ValueError("'col
-0002e020: 756d 6e73 2720 6d75 7374 2068 6176 6520  umns' must have 
-0002e030: 6b6e 6f77 6e20 6361 7465 676f 7269 6573  known categories
-0002e040: 2229 0a0a 2020 2020 6966 206e 6f74 2028  ")..    if not (
-0002e050: 0a20 2020 2020 2020 2069 735f 7363 616c  .        is_scal
-0002e060: 6172 2876 616c 7565 7329 0a20 2020 2020  ar(values).     
-0002e070: 2020 2061 6e64 2076 616c 7565 7320 696e     and values in
-0002e080: 2064 662e 5f6d 6574 612e 636f 6c75 6d6e   df._meta.column
-0002e090: 730a 2020 2020 2020 2020 6f72 206e 6f74  s.        or not
-0002e0a0: 2069 735f 7363 616c 6172 2876 616c 7565   is_scalar(value
-0002e0b0: 7329 0a20 2020 2020 2020 2061 6e64 2061  s).        and a
-0002e0c0: 6c6c 2869 735f 7363 616c 6172 2878 2920  ll(is_scalar(x) 
-0002e0d0: 616e 6420 7820 696e 2064 662e 5f6d 6574  and x in df._met
-0002e0e0: 612e 636f 6c75 6d6e 7320 666f 7220 7820  a.columns for x 
-0002e0f0: 696e 2076 616c 7565 7329 0a20 2020 2029  in values).    )
-0002e100: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0002e110: 5661 6c75 6545 7272 6f72 2822 2776 616c  ValueError("'val
-0002e120: 7565 7327 206d 7573 7420 7265 6665 7220  ues' must refer 
-0002e130: 746f 2061 6e20 6578 6973 7469 6e67 2063  to an existing c
-0002e140: 6f6c 756d 6e20 6f72 2063 6f6c 756d 6e73  olumn or columns
-0002e150: 2229 0a0a 2020 2020 6176 6169 6c61 626c  ")..    availabl
-0002e160: 655f 6167 6766 756e 6373 203d 205b 226d  e_aggfuncs = ["m
-0002e170: 6561 6e22 2c20 2273 756d 222c 2022 636f  ean", "sum", "co
-0002e180: 756e 7422 2c20 2266 6972 7374 222c 2022  unt", "first", "
-0002e190: 6c61 7374 225d 0a0a 2020 2020 6966 206e  last"]..    if n
-0002e1a0: 6f74 2069 735f 7363 616c 6172 2861 6767  ot is_scalar(agg
-0002e1b0: 6675 6e63 2920 6f72 2061 6767 6675 6e63  func) or aggfunc
-0002e1c0: 206e 6f74 2069 6e20 6176 6169 6c61 626c   not in availabl
-0002e1d0: 655f 6167 6766 756e 6373 3a0a 2020 2020  e_aggfuncs:.    
-0002e1e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002e1f0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002e200: 2020 2261 6767 6675 6e63 206d 7573 7420    "aggfunc must 
-0002e210: 6265 2065 6974 6865 7220 2220 2b20 222c  be either " + ",
-0002e220: 2022 2e6a 6f69 6e28 6622 277b 787d 2722   ".join(f"'{x}'"
-0002e230: 2066 6f72 2078 2069 6e20 6176 6169 6c61   for x in availa
-0002e240: 626c 655f 6167 6766 756e 6373 290a 2020  ble_aggfuncs).  
-0002e250: 2020 2020 2020 290a 0a20 2020 2072 6574        )..    ret
-0002e260: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
-0002e270: 6f6e 280a 2020 2020 2020 2020 5069 766f  on(.        Pivo
-0002e280: 7454 6162 6c65 2864 662c 2069 6e64 6578  tTable(df, index
-0002e290: 3d69 6e64 6578 2c20 636f 6c75 6d6e 733d  =index, columns=
-0002e2a0: 636f 6c75 6d6e 732c 2076 616c 7565 733d  columns, values=
-0002e2b0: 7661 6c75 6573 2c20 6167 6766 756e 633d  values, aggfunc=
-0002e2c0: 6167 6766 756e 6329 0a20 2020 2029 0a0a  aggfunc).    )..
-0002e2d0: 0a64 6566 2074 6f5f 6e75 6d65 7269 6328  .def to_numeric(
-0002e2e0: 6172 672c 2065 7272 6f72 733d 2272 6169  arg, errors="rai
-0002e2f0: 7365 222c 2064 6f77 6e63 6173 743d 4e6f  se", downcast=No
-0002e300: 6e65 2c20 6d65 7461 3d4e 6f6e 6529 3a0a  ne, meta=None):.
-0002e310: 2020 2020 2222 220a 2020 2020 5265 7475      """.    Retu
-0002e320: 726e 2074 7970 6520 6465 7065 6e64 7320  rn type depends 
-0002e330: 6f6e 2069 6e70 7574 2e20 4465 6c61 7965  on input. Delaye
-0002e340: 6420 6966 2073 6361 6c61 722c 206f 7468  d if scalar, oth
-0002e350: 6572 7769 7365 2073 616d 6520 6173 2069  erwise same as i
-0002e360: 6e70 7574 2e0a 2020 2020 466f 7220 6572  nput..    For er
-0002e370: 726f 7273 2c20 6f6e 6c79 2022 7261 6973  rors, only "rais
-0002e380: 6522 2061 6e64 2022 636f 6572 6365 2220  e" and "coerce" 
-0002e390: 6172 6520 616c 6c6f 7765 642e 0a20 2020  are allowed..   
-0002e3a0: 2022 2222 0a20 2020 2069 6620 6572 726f   """.    if erro
-0002e3b0: 7273 206e 6f74 2069 6e20 2822 7261 6973  rs not in ("rais
-0002e3c0: 6522 2c20 2263 6f65 7263 6522 293a 0a20  e", "coerce"):. 
-0002e3d0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002e3e0: 7565 4572 726f 7228 2269 6e76 616c 6964  ueError("invalid
-0002e3f0: 2065 7272 6f72 2076 616c 7565 2073 7065   error value spe
-0002e400: 6369 6669 6564 2229 0a0a 2020 2020 6966  cified")..    if
-0002e410: 2070 645f 6973 5f73 6361 6c61 7228 6172   pd_is_scalar(ar
-0002e420: 6729 3a0a 2020 2020 2020 2020 6966 206d  g):.        if m
-0002e430: 6574 6120 6973 206e 6f74 204e 6f6e 653a  eta is not None:
-0002e440: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002e450: 7365 204b 6579 4572 726f 7228 2260 606d  se KeyError("``m
-0002e460: 6574 6160 6020 6973 206e 6f74 2061 6c6c  eta`` is not all
-0002e470: 6f77 6564 2077 6865 6e20 696e 7075 7420  owed when input 
-0002e480: 6973 2061 2073 6361 6c61 722e 2229 0a20  is a scalar."). 
-0002e490: 2020 2020 2020 2072 6574 7572 6e20 6465         return de
-0002e4a0: 6c61 7965 6428 7064 2e74 6f5f 6e75 6d65  layed(pd.to_nume
-0002e4b0: 7269 632c 2070 7572 653d 5472 7565 2928  ric, pure=True)(
-0002e4c0: 6172 672c 2065 7272 6f72 733d 6572 726f  arg, errors=erro
-0002e4d0: 7273 2c20 646f 776e 6361 7374 3d64 6f77  rs, downcast=dow
-0002e4e0: 6e63 6173 7429 0a0a 2020 2020 6966 2069  ncast)..    if i
-0002e4f0: 735f 6172 7261 796c 696b 6528 6172 6729  s_arraylike(arg)
-0002e500: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0002e510: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
-0002e520: 0a20 2020 2020 2020 2020 2020 2054 6f4e  .            ToN
-0002e530: 756d 6572 6963 280a 2020 2020 2020 2020  umeric(.        
-0002e540: 2020 2020 2020 2020 6672 6f6d 5f61 7272          from_arr
-0002e550: 6179 2861 7267 292e 6173 7479 7065 2861  ay(arg).astype(a
-0002e560: 7267 2e64 7479 7065 292c 2065 7272 6f72  rg.dtype), error
-0002e570: 733d 6572 726f 7273 2c20 646f 776e 6361  s=errors, downca
-0002e580: 7374 3d64 6f77 6e63 6173 740a 2020 2020  st=downcast.    
-0002e590: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002e5a0: 2020 292e 746f 5f64 6173 6b5f 6172 7261    ).to_dask_arra
-0002e5b0: 7928 6d65 7461 3d6d 6574 6129 0a0a 2020  y(meta=meta)..  
-0002e5c0: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-0002e5d0: 696b 6528 6172 6729 3a0a 2020 2020 2020  ike(arg):.      
-0002e5e0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
-0002e5f0: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
-0002e600: 2020 2020 2054 6f4e 756d 6572 6963 2866       ToNumeric(f
-0002e610: 7261 6d65 3d61 7267 2c20 6572 726f 7273  rame=arg, errors
-0002e620: 3d65 7272 6f72 732c 2064 6f77 6e63 6173  =errors, downcas
-0002e630: 743d 646f 776e 6361 7374 2c20 6d65 7461  t=downcast, meta
-0002e640: 3d6d 6574 6129 0a20 2020 2020 2020 2029  =meta).        )
-0002e650: 0a0a 2020 2020 7261 6973 6520 5479 7065  ..    raise Type
-0002e660: 4572 726f 7228 0a20 2020 2020 2020 2022  Error(.        "
-0002e670: 6172 6720 6d75 7374 2062 6520 6120 6c69  arg must be a li
-0002e680: 7374 2c20 7475 706c 652c 2064 6173 6b2e  st, tuple, dask.
-0002e690: 6172 7261 792e 4172 7261 792c 206f 7220  array.Array, or 
-0002e6a0: 6461 736b 2e64 6174 6166 7261 6d65 2e53  dask.dataframe.S
-0002e6b0: 6572 6965 7322 0a20 2020 2029 0a0a 0a64  eries".    )...d
-0002e6c0: 6566 2074 6f5f 6461 7465 7469 6d65 2861  ef to_datetime(a
-0002e6d0: 7267 2c20 6d65 7461 3d4e 6f6e 652c 202a  rg, meta=None, *
-0002e6e0: 2a6b 7761 7267 7329 3a0a 2020 2020 747a  *kwargs):.    tz
-0002e6f0: 5f6b 7761 7267 203d 207b 2274 7a22 3a20  _kwarg = {"tz": 
-0002e700: 2275 7463 227d 2069 6620 6b77 6172 6773  "utc"} if kwargs
-0002e710: 2e67 6574 2822 7574 6322 2920 656c 7365  .get("utc") else
-0002e720: 207b 7d0a 0a20 2020 2028 6172 672c 2920   {}..    (arg,) 
-0002e730: 3d20 5f6d 6179 6265 5f66 726f 6d5f 7061  = _maybe_from_pa
-0002e740: 6e64 6173 285b 6172 675d 290a 0a20 2020  ndas([arg])..   
-0002e750: 2069 6620 6d65 7461 2069 7320 4e6f 6e65   if meta is None
-0002e760: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-0002e770: 6e73 7461 6e63 6528 6172 672c 2049 6e64  nstance(arg, Ind
-0002e780: 6578 293a 0a20 2020 2020 2020 2020 2020  ex):.           
-0002e790: 206d 6574 6120 3d20 6765 745f 6d65 7461   meta = get_meta
-0002e7a0: 5f6c 6962 7261 7279 2861 7267 292e 4461  _library(arg).Da
-0002e7b0: 7465 7469 6d65 496e 6465 7828 5b5d 2c20  tetimeIndex([], 
-0002e7c0: 2a2a 747a 5f6b 7761 7267 290a 2020 2020  **tz_kwarg).    
-0002e7d0: 2020 2020 2020 2020 6d65 7461 2e6e 616d          meta.nam
-0002e7e0: 6520 3d20 6172 672e 6e61 6d65 0a20 2020  e = arg.name.   
-0002e7f0: 2020 2020 2065 6c69 6620 6e6f 7420 2869       elif not (i
-0002e800: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
-0002e810: 2861 7267 2920 6f72 2069 735f 7365 7269  (arg) or is_seri
-0002e820: 6573 5f6c 696b 6528 6172 6729 293a 0a20  es_like(arg)):. 
-0002e830: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002e840: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-0002e850: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002e860: 2020 2020 2020 2264 6173 6b2e 6461 7461        "dask.data
-0002e870: 6672 616d 652e 746f 5f64 6174 6574 696d  frame.to_datetim
-0002e880: 6520 646f 6573 206e 6f74 2073 7570 706f  e does not suppo
-0002e890: 7274 2022 0a20 2020 2020 2020 2020 2020  rt ".           
-0002e8a0: 2020 2020 2022 6e6f 6e2d 696e 6465 782d       "non-index-
-0002e8b0: 6162 6c65 2061 7267 756d 656e 7473 2028  able arguments (
-0002e8c0: 6c69 6b65 2073 6361 6c61 7273 2922 0a20  like scalars)". 
-0002e8d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0002e8e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002e8f0: 2020 2020 2020 206d 6574 6120 3d20 6d65         meta = me
-0002e900: 7461 5f73 6572 6965 735f 636f 6e73 7472  ta_series_constr
-0002e910: 7563 746f 7228 6172 6729 285b 7064 2e54  uctor(arg)([pd.T
-0002e920: 696d 6573 7461 6d70 2822 3230 3030 222c  imestamp("2000",
-0002e930: 202a 2a74 7a5f 6b77 6172 6729 5d29 0a20   **tz_kwarg)]). 
-0002e940: 2020 2020 2020 2020 2020 206d 6574 612e             meta.
-0002e950: 696e 6465 7820 3d20 6d65 7461 2e69 6e64  index = meta.ind
-0002e960: 6578 2e61 7374 7970 6528 6172 672e 696e  ex.astype(arg.in
-0002e970: 6465 782e 6474 7970 6529 0a20 2020 2020  dex.dtype).     
-0002e980: 2020 2020 2020 206d 6574 612e 696e 6465         meta.inde
-0002e990: 782e 6e61 6d65 203d 2061 7267 2e69 6e64  x.name = arg.ind
-0002e9a0: 6578 2e6e 616d 650a 0a20 2020 206b 7761  ex.name..    kwa
-0002e9b0: 7267 732e 706f 7028 2269 6e66 6572 5f64  rgs.pop("infer_d
-0002e9c0: 6174 6574 696d 655f 666f 726d 6174 222c  atetime_format",
-0002e9d0: 204e 6f6e 6529 0a0a 2020 2020 7265 7475   None)..    retu
-0002e9e0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
-0002e9f0: 6e28 546f 4461 7465 7469 6d65 2866 7261  n(ToDatetime(fra
-0002ea00: 6d65 3d61 7267 2c20 6b77 6172 6773 3d6b  me=arg, kwargs=k
-0002ea10: 7761 7267 732c 206d 6574 613d 6d65 7461  wargs, meta=meta
-0002ea20: 2929 0a0a 0a64 6566 2074 6f5f 7469 6d65  ))...def to_time
-0002ea30: 6465 6c74 6128 6172 672c 2075 6e69 743d  delta(arg, unit=
-0002ea40: 4e6f 6e65 2c20 6572 726f 7273 3d22 7261  None, errors="ra
-0002ea50: 6973 6522 293a 0a20 2020 2069 6620 6e6f  ise"):.    if no
-0002ea60: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
-0002ea70: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
-0002ea80: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0002ea90: 6f72 2822 6172 6720 6d75 7374 2062 6520  or("arg must be 
-0002eaa0: 6120 5365 7269 6573 2229 0a20 2020 2072  a Series").    r
-0002eab0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
-0002eac0: 7469 6f6e 2854 6f54 696d 6564 656c 7461  tion(ToTimedelta
-0002ead0: 2866 7261 6d65 3d61 7267 2c20 756e 6974  (frame=arg, unit
-0002eae0: 3d75 6e69 742c 2065 7272 6f72 733d 6572  =unit, errors=er
-0002eaf0: 726f 7273 2929 0a0a 0a64 6566 205f 6672  rors))...def _fr
-0002eb00: 6f6d 5f73 6361 6c61 7273 2873 6361 6c61  om_scalars(scala
-0002eb10: 7273 2c20 6d65 7461 2c20 6e61 6d65 7329  rs, meta, names)
-0002eb20: 3a0a 2020 2020 7265 7475 726e 206e 6577  :.    return new
-0002eb30: 5f63 6f6c 6c65 6374 696f 6e28 4672 6f6d  _collection(From
-0002eb40: 5363 616c 6172 7328 6d65 7461 2c20 6e61  Scalars(meta, na
-0002eb50: 6d65 732c 202a 7363 616c 6172 7329 290a  mes, *scalars)).
-0002eb60: 0a0a 4069 6e73 6572 745f 6d65 7461 5f70  ..@insert_meta_p
-0002eb70: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
-0002eb80: 0a64 6566 206d 6170 5f70 6172 7469 7469  .def map_partiti
-0002eb90: 6f6e 7328 0a20 2020 2066 756e 632c 0a20  ons(.    func,. 
-0002eba0: 2020 202a 6172 6773 2c0a 2020 2020 6d65     *args,.    me
-0002ebb0: 7461 3d6e 6f5f 6465 6661 756c 742c 0a20  ta=no_default,. 
-0002ebc0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-0002ebd0: 6174 613d 5472 7565 2c0a 2020 2020 7472  ata=True,.    tr
-0002ebe0: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
-0002ebf0: 733d 5472 7565 2c0a 2020 2020 636c 6561  s=True,.    clea
-0002ec00: 725f 6469 7669 7369 6f6e 733d 4661 6c73  r_divisions=Fals
-0002ec10: 652c 0a20 2020 2061 6c69 676e 5f64 6174  e,.    align_dat
-0002ec20: 6166 7261 6d65 733d 4661 6c73 652c 0a20  aframes=False,. 
-0002ec30: 2020 2070 6172 656e 745f 6d65 7461 3d4e     parent_meta=N
-0002ec40: 6f6e 652c 0a20 2020 202a 2a6b 7761 7267  one,.    **kwarg
-0002ec50: 732c 0a29 3a0a 2020 2020 2222 2241 7070  s,.):.    """App
-0002ec60: 6c79 2050 7974 686f 6e20 6675 6e63 7469  ly Python functi
-0002ec70: 6f6e 206f 6e20 6561 6368 2044 6174 6146  on on each DataF
-0002ec80: 7261 6d65 2070 6172 7469 7469 6f6e 2e0a  rame partition..
-0002ec90: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-0002eca0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0002ecb0: 2020 2066 756e 6320 3a20 6675 6e63 7469     func : functi
-0002ecc0: 6f6e 0a20 2020 2020 2020 2046 756e 6374  on.        Funct
-0002ecd0: 696f 6e20 6170 706c 6965 6420 746f 2065  ion applied to e
-0002ece0: 6163 6820 7061 7274 6974 696f 6e2e 0a20  ach partition.. 
-0002ecf0: 2020 2061 7267 732c 206b 7761 7267 7320     args, kwargs 
-0002ed00: 3a0a 2020 2020 2020 2020 4172 6775 6d65  :.        Argume
-0002ed10: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
-0002ed20: 2074 6f20 7061 7373 2074 6f20 7468 6520   to pass to the 
-0002ed30: 6675 6e63 7469 6f6e 2e20 2041 7420 6c65  function.  At le
-0002ed40: 6173 7420 6f6e 6520 6f66 2074 6865 0a20  ast one of the. 
-0002ed50: 2020 2020 2020 2061 7267 7320 7368 6f75         args shou
-0002ed60: 6c64 2062 6520 6120 4461 736b 2e64 6174  ld be a Dask.dat
-0002ed70: 6166 7261 6d65 2e20 4172 6775 6d65 6e74  aframe. Argument
-0002ed80: 7320 616e 6420 6b65 7977 6f72 6473 206d  s and keywords m
-0002ed90: 6179 2063 6f6e 7461 696e 0a20 2020 2020  ay contain.     
-0002eda0: 2020 2060 6053 6361 6c61 7260 602c 2060     ``Scalar``, `
-0002edb0: 6044 656c 6179 6564 6060 206f 7220 7265  `Delayed`` or re
-0002edc0: 6775 6c61 7220 7079 7468 6f6e 206f 626a  gular python obj
-0002edd0: 6563 7473 2e20 4461 7461 4672 616d 652d  ects. DataFrame-
-0002ede0: 6c69 6b65 2061 7267 730a 2020 2020 2020  like args.      
-0002edf0: 2020 2862 6f74 6820 6461 736b 2061 6e64    (both dask and
-0002ee00: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
-0002ee10: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
-0002ee20: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
-0002ee30: 7373 6172 7929 0a20 2020 2020 2020 2062  ssary).        b
-0002ee40: 6566 6f72 6520 6170 706c 7969 6e67 2074  efore applying t
-0002ee50: 6865 2066 756e 6374 696f 6e20 2873 6565  he function (see
-0002ee60: 2060 6061 6c69 676e 5f64 6174 6166 7261   ``align_datafra
-0002ee70: 6d65 7360 6020 746f 2063 6f6e 7472 6f6c  mes`` to control
-0002ee80: 292e 0a20 2020 2065 6e66 6f72 6365 5f6d  )..    enforce_m
-0002ee90: 6574 6164 6174 6120 3a20 626f 6f6c 2c20  etadata : bool, 
-0002eea0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
-0002eeb0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-0002eec0: 656e 666f 7263 6520 6174 2072 756e 7469  enforce at runti
-0002eed0: 6d65 2074 6861 7420 7468 6520 7374 7275  me that the stru
-0002eee0: 6374 7572 6520 6f66 2074 6865 2044 6174  cture of the Dat
-0002eef0: 6146 7261 6d65 0a20 2020 2020 2020 2070  aFrame.        p
-0002ef00: 726f 6475 6365 6420 6279 2060 6066 756e  roduced by ``fun
-0002ef10: 6360 6020 6163 7475 616c 6c79 206d 6174  c`` actually mat
-0002ef20: 6368 6573 2074 6865 2073 7472 7563 7475  ches the structu
-0002ef30: 7265 206f 6620 6060 6d65 7461 6060 2e0a  re of ``meta``..
-0002ef40: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
-0002ef50: 6c20 7265 6e61 6d65 2061 6e64 2072 656f  l rename and reo
-0002ef60: 7264 6572 2063 6f6c 756d 6e73 2066 6f72  rder columns for
-0002ef70: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
-0002ef80: 0a20 2020 2020 2020 2061 6e64 2077 696c  .        and wil
-0002ef90: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
-0002efa0: 2069 6620 7468 6973 2064 6f65 736e 2774   if this doesn't
-0002efb0: 2077 6f72 6b2c 0a20 2020 2020 2020 2062   work,.        b
-0002efc0: 7574 2069 7420 776f 6e27 7420 7261 6973  ut it won't rais
-0002efd0: 6520 6966 2064 7479 7065 7320 646f 6e27  e if dtypes don'
-0002efe0: 7420 6d61 7463 682e 0a20 2020 2074 7261  t match..    tra
-0002eff0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-0002f000: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0002f010: 2054 7275 650a 2020 2020 2020 2020 5768   True.        Wh
-0002f020: 6574 6865 7220 746f 2061 7070 6c79 2074  ether to apply t
-0002f030: 6865 2066 756e 6374 696f 6e20 6f6e 746f  he function onto
-0002f040: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
-0002f050: 6e64 2061 7070 6c79 2074 686f 7365 0a20  nd apply those. 
-0002f060: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-0002f070: 6564 2064 6976 6973 696f 6e73 2074 6f20  ed divisions to 
-0002f080: 7468 6520 6f75 7470 7574 2e0a 2020 2020  the output..    
-0002f090: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
-0002f0a0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0002f0b0: 2054 7275 650a 2020 2020 2020 2020 5768   True.        Wh
-0002f0c0: 6574 6865 7220 746f 2072 6570 6172 7469  ether to reparti
-0002f0d0: 7469 6f6e 2044 6174 6146 7261 6d65 2d20  tion DataFrame- 
-0002f0e0: 6f72 2053 6572 6965 732d 6c69 6b65 2061  or Series-like a
-0002f0f0: 7267 730a 2020 2020 2020 2020 2862 6f74  rgs.        (bot
-0002f100: 6820 6461 736b 2061 6e64 2070 616e 6461  h dask and panda
-0002f110: 7329 2073 6f20 7468 6569 7220 6469 7669  s) so their divi
-0002f120: 7369 6f6e 7320 616c 6967 6e20 6265 666f  sions align befo
-0002f130: 7265 2061 7070 6c79 696e 670a 2020 2020  re applying.    
-0002f140: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
-0002f150: 2e20 5468 6973 2072 6571 7569 7265 7320  . This requires 
-0002f160: 616c 6c20 696e 7075 7473 2074 6f20 6861  all inputs to ha
-0002f170: 7665 206b 6e6f 776e 2064 6976 6973 696f  ve known divisio
-0002f180: 6e73 2e0a 2020 2020 2020 2020 5369 6e67  ns..        Sing
-0002f190: 6c65 2d70 6172 7469 7469 6f6e 2069 6e70  le-partition inp
-0002f1a0: 7574 7320 7769 6c6c 2062 6520 7370 6c69  uts will be spli
-0002f1b0: 7420 696e 746f 206d 756c 7469 706c 6520  t into multiple 
-0002f1c0: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
-0002f1d0: 2020 2020 2049 6620 4661 6c73 652c 2061       If False, a
-0002f1e0: 6c6c 2069 6e70 7574 7320 6d75 7374 2068  ll inputs must h
-0002f1f0: 6176 6520 6569 7468 6572 2074 6865 2073  ave either the s
-0002f200: 616d 6520 6e75 6d62 6572 206f 6620 7061  ame number of pa
-0002f210: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
-0002f220: 206f 7220 6120 7369 6e67 6c65 2070 6172   or a single par
-0002f230: 7469 7469 6f6e 2e20 5369 6e67 6c65 2d70  tition. Single-p
-0002f240: 6172 7469 7469 6f6e 2069 6e70 7574 7320  artition inputs 
-0002f250: 7769 6c6c 2062 6520 6272 6f61 6463 6173  will be broadcas
-0002f260: 7420 746f 0a20 2020 2020 2020 2065 7665  t to.        eve
-0002f270: 7279 2070 6172 7469 7469 6f6e 206f 6620  ry partition of 
-0002f280: 6d75 6c74 692d 7061 7274 6974 696f 6e20  multi-partition 
-0002f290: 696e 7075 7473 2e0a 2020 2020 244d 4554  inputs..    $MET
-0002f2a0: 410a 2020 2020 2222 220a 2020 2020 6966  A.    """.    if
-0002f2b0: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
-0002f2c0: 733a 0a20 2020 2020 2020 2023 2054 4f44  s:.        # TOD
-0002f2d0: 4f3a 2048 616e 646c 6520 616c 6967 6e6d  O: Handle alignm
-0002f2e0: 656e 743f 0a20 2020 2020 2020 2023 2050  ent?.        # P
-0002f2f0: 6572 6861 7073 2077 6520 6f6e 6c79 2068  erhaps we only h
-0002f300: 616e 646c 6520 7468 6520 6361 7365 2074  andle the case t
-0002f310: 6861 7420 616c 6c20 6045 7870 7260 206f  hat all `Expr` o
-0002f320: 7065 7261 6e64 730a 2020 2020 2020 2020  perands.        
-0002f330: 2320 6861 7665 2074 6865 2073 616d 6520  # have the same 
-0002f340: 6e75 6d62 6572 206f 6620 7061 7274 6974  number of partit
-0002f350: 696f 6e73 206f 7220 6361 6e20 6265 2062  ions or can be b
-0002f360: 726f 6164 6361 7374 6564 0a20 2020 2020  roadcasted.     
-0002f370: 2020 2023 2077 6974 6869 6e20 604d 6170     # within `Map
-0002f380: 5061 7274 6974 696f 6e73 602e 2049 6620  Partitions`. If 
-0002f390: 736f 2c20 7468 6520 606d 6170 5f70 6172  so, the `map_par
-0002f3a0: 7469 7469 6f6e 7360 2041 5049 0a20 2020  titions` API.   
-0002f3b0: 2020 2020 2023 2077 696c 6c20 6e65 6564       # will need
-0002f3c0: 2074 6f20 6361 6c6c 2060 5265 7061 7274   to call `Repart
-0002f3d0: 6974 696f 6e60 206f 6e20 6f70 6572 616e  ition` on operan
-0002f3e0: 6473 2074 6861 7420 6172 6520 6e6f 740a  ds that are not.
-0002f3f0: 2020 2020 2020 2020 2320 616c 6967 6e65          # aligne
-0002f400: 6420 7769 7468 2060 7365 6c66 2e65 7870  d with `self.exp
-0002f410: 7260 2e0a 2020 2020 2020 2020 7261 6973  r`..        rais
-0002f420: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0002f430: 4572 726f 7228 290a 2020 2020 6e65 775f  Error().    new_
-0002f440: 6578 7072 203d 2065 7870 722e 4d61 7050  expr = expr.MapP
-0002f450: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0002f460: 2020 2061 7267 735b 305d 2c0a 2020 2020     args[0],.    
-0002f470: 2020 2020 6675 6e63 2c0a 2020 2020 2020      func,.      
-0002f480: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
-0002f490: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0002f4a0: 2c0a 2020 2020 2020 2020 7472 616e 7366  ,.        transf
-0002f4b0: 6f72 6d5f 6469 7669 7369 6f6e 732c 0a20  orm_divisions,. 
-0002f4c0: 2020 2020 2020 2063 6c65 6172 5f64 6976         clear_div
-0002f4d0: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
-0002f4e0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
-0002f4f0: 2c0a 2020 2020 2020 2020 7061 7265 6e74  ,.        parent
-0002f500: 5f6d 6574 612c 0a20 2020 2020 2020 206b  _meta,.        k
-0002f510: 7761 7267 732e 706f 7028 2274 6f6b 656e  wargs.pop("token
-0002f520: 222c 204e 6f6e 6529 2c0a 2020 2020 2020  ", None),.      
-0002f530: 2020 6b77 6172 6773 2c0a 2020 2020 2020    kwargs,.      
-0002f540: 2020 2a61 7267 735b 313a 5d2c 0a20 2020    *args[1:],.   
-0002f550: 2029 0a20 2020 2072 6574 7572 6e20 6e65   ).    return ne
-0002f560: 775f 636f 6c6c 6563 7469 6f6e 286e 6577  w_collection(new
-0002f570: 5f65 7870 7229 0a0a 0a64 6566 206d 6170  _expr)...def map
-0002f580: 5f6f 7665 726c 6170 280a 2020 2020 6675  _overlap(.    fu
-0002f590: 6e63 2c0a 2020 2020 6466 2c0a 2020 2020  nc,.    df,.    
-0002f5a0: 6265 666f 7265 2c0a 2020 2020 6166 7465  before,.    afte
-0002f5b0: 722c 0a20 2020 202a 6172 6773 2c0a 2020  r,.    *args,.  
-0002f5c0: 2020 6d65 7461 3d6e 6f5f 6465 6661 756c    meta=no_defaul
-0002f5d0: 742c 0a20 2020 2065 6e66 6f72 6365 5f6d  t,.    enforce_m
-0002f5e0: 6574 6164 6174 613d 5472 7565 2c0a 2020  etadata=True,.  
-0002f5f0: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
-0002f600: 7369 6f6e 733d 5472 7565 2c0a 2020 2020  sions=True,.    
-0002f610: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
-0002f620: 4661 6c73 652c 0a20 2020 2061 6c69 676e  False,.    align
-0002f630: 5f64 6174 6166 7261 6d65 733d 4661 6c73  _dataframes=Fals
-0002f640: 652c 0a20 2020 202a 2a6b 7761 7267 732c  e,.    **kwargs,
-0002f650: 0a29 3a0a 2020 2020 6966 2069 7369 6e73  .):.    if isins
-0002f660: 7461 6e63 6528 6265 666f 7265 2c20 7374  tance(before, st
-0002f670: 7229 3a0a 2020 2020 2020 2020 6265 666f  r):.        befo
-0002f680: 7265 203d 2070 642e 746f 5f74 696d 6564  re = pd.to_timed
-0002f690: 656c 7461 2862 6566 6f72 6529 0a20 2020  elta(before).   
-0002f6a0: 2069 6620 6973 696e 7374 616e 6365 2861   if isinstance(a
-0002f6b0: 6674 6572 2c20 7374 7229 3a0a 2020 2020  fter, str):.    
-0002f6c0: 2020 2020 6166 7465 7220 3d20 7064 2e74      after = pd.t
-0002f6d0: 6f5f 7469 6d65 6465 6c74 6128 6166 7465  o_timedelta(afte
-0002f6e0: 7229 0a0a 2020 2020 6966 2069 7369 6e73  r)..    if isins
-0002f6f0: 7461 6e63 6528 6265 666f 7265 2c20 6461  tance(before, da
-0002f700: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
-0002f710: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
-0002f720: 6166 7465 722c 2064 6174 6574 696d 652e  after, datetime.
-0002f730: 7469 6d65 6465 6c74 6129 3a0a 2020 2020  timedelta):.    
-0002f740: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0002f750: 6528 6466 2c20 4672 616d 6542 6173 6529  e(df, FrameBase)
-0002f760: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-0002f770: 6665 7272 6564 5f74 7970 6520 3d20 6466  ferred_type = df
-0002f780: 2e69 6e64 6578 2e5f 6d65 7461 5f6e 6f6e  .index._meta_non
-0002f790: 656d 7074 792e 696e 6665 7272 6564 5f74  empty.inferred_t
-0002f7a0: 7970 650a 2020 2020 2020 2020 656c 7365  ype.        else
-0002f7b0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-0002f7c0: 6665 7272 6564 5f74 7970 6520 3d20 6466  ferred_type = df
-0002f7d0: 2e69 6e64 6578 2e69 6e66 6572 7265 645f  .index.inferred_
-0002f7e0: 7479 7065 0a0a 2020 2020 2020 2020 6966  type..        if
-0002f7f0: 206e 6f74 2069 735f 6461 7465 7469 6d65   not is_datetime
-0002f800: 3634 5f61 6e79 5f64 7479 7065 2869 6e66  64_any_dtype(inf
-0002f810: 6572 7265 645f 7479 7065 293a 0a20 2020  erred_type):.   
-0002f820: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0002f830: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-0002f840: 2020 2020 2020 2020 2020 224d 7573 7420            "Must 
-0002f850: 6861 7665 2061 2060 4461 7465 7469 6d65  have a `Datetime
-0002f860: 496e 6465 7860 2077 6865 6e20 7573 696e  Index` when usin
-0002f870: 6720 7374 7269 6e67 206f 6666 7365 7420  g string offset 
-0002f880: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002f890: 2020 2266 6f72 2060 6265 666f 7265 6020    "for `before` 
-0002f8a0: 616e 6420 6061 6674 6572 6022 0a20 2020  and `after`".   
-0002f8b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0002f8c0: 656c 6966 206e 6f74 2028 0a20 2020 2020  elif not (.     
-0002f8d0: 2020 2069 7369 6e73 7461 6e63 6528 6265     isinstance(be
-0002f8e0: 666f 7265 2c20 496e 7465 6772 616c 290a  fore, Integral).
-0002f8f0: 2020 2020 2020 2020 616e 6420 6265 666f          and befo
-0002f900: 7265 203e 3d20 300a 2020 2020 2020 2020  re >= 0.        
-0002f910: 616e 6420 6973 696e 7374 616e 6365 2861  and isinstance(a
-0002f920: 6674 6572 2c20 496e 7465 6772 616c 290a  fter, Integral).
-0002f930: 2020 2020 2020 2020 616e 6420 6166 7465          and afte
-0002f940: 7220 3e3d 2030 0a20 2020 2029 3a0a 2020  r >= 0.    ):.  
-0002f950: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002f960: 6545 7272 6f72 2822 6265 666f 7265 2061  eError("before a
-0002f970: 6e64 2061 6674 6572 206d 7573 7420 6265  nd after must be
-0002f980: 2070 6f73 6974 6976 6520 696e 7465 6765   positive intege
-0002f990: 7273 2229 0a0a 2020 2020 6466 203d 205f  rs")..    df = _
-0002f9a0: 6d61 7962 655f 6672 6f6d 5f70 616e 6461  maybe_from_panda
-0002f9b0: 7328 5b64 665d 295b 305d 0a20 2020 2061  s([df])[0].    a
-0002f9c0: 7267 7320 3d20 5f6d 6179 6265 5f66 726f  rgs = _maybe_fro
-0002f9d0: 6d5f 7061 6e64 6173 2861 7267 7329 0a0a  m_pandas(args)..
-0002f9e0: 2020 2020 6966 2061 6c69 676e 5f64 6174      if align_dat
-0002f9f0: 6166 7261 6d65 733a 0a20 2020 2020 2020  aframes:.       
-0002fa00: 2064 6673 203d 205b 6466 5d20 2b20 6172   dfs = [df] + ar
-0002fa10: 6773 0a20 2020 2020 2020 2064 6673 203d  gs.        dfs =
-0002fa20: 205b 6466 2066 6f72 2064 6620 696e 2064   [df for df in d
-0002fa30: 6673 2069 6620 6973 696e 7374 616e 6365  fs if isinstance
-0002fa40: 2864 662c 2046 7261 6d65 4261 7365 295d  (df, FrameBase)]
-0002fa50: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0002fa60: 6466 7329 203e 2031 2061 6e64 206e 6f74  dfs) > 1 and not
-0002fa70: 2065 7870 722e 6172 655f 636f 5f61 6c69   expr.are_co_ali
-0002fa80: 676e 6564 282a 6466 7329 3a0a 2020 2020  gned(*dfs):.    
-0002fa90: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0002faa0: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
-0002fab0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002fac0: 7870 722e 4d61 704f 7665 726c 6170 416c  xpr.MapOverlapAl
-0002fad0: 6967 6e28 0a20 2020 2020 2020 2020 2020  ign(.           
-0002fae0: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
-0002faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb00: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
-0002fb10: 2020 2020 2020 2020 2020 2062 6566 6f72             befor
-0002fb20: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0002fb30: 2020 2020 2020 2061 6674 6572 2c0a 2020         after,.  
-0002fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb50: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
-0002fb60: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-0002fb70: 7263 655f 6d65 7461 6461 7461 2c0a 2020  rce_metadata,.  
-0002fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb90: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
-0002fba0: 7369 6f6e 732c 0a20 2020 2020 2020 2020  sions,.         
-0002fbb0: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
-0002fbc0: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
-0002fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fbe0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
-0002fbf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002fc00: 2020 2020 2020 6b77 6172 6773 2e70 6f70        kwargs.pop
-0002fc10: 2822 746f 6b65 6e22 2c20 4e6f 6e65 292c  ("token", None),
-0002fc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002fc30: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
-0002fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc50: 202a 6172 6773 2c0a 2020 2020 2020 2020   *args,.        
-0002fc60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002fc70: 2020 2020 2020 290a 0a20 2020 206e 6577        )..    new
-0002fc80: 5f65 7870 7220 3d20 6578 7072 2e4d 6170  _expr = expr.Map
-0002fc90: 4f76 6572 6c61 7028 0a20 2020 2020 2020  Overlap(.       
-0002fca0: 2064 662c 0a20 2020 2020 2020 2066 756e   df,.        fun
-0002fcb0: 632c 0a20 2020 2020 2020 2062 6566 6f72  c,.        befor
-0002fcc0: 652c 0a20 2020 2020 2020 2061 6674 6572  e,.        after
-0002fcd0: 2c0a 2020 2020 2020 2020 6d65 7461 2c0a  ,.        meta,.
-0002fce0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-0002fcf0: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
-0002fd00: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
-0002fd10: 7369 6f6e 732c 0a20 2020 2020 2020 2063  sions,.        c
-0002fd20: 6c65 6172 5f64 6976 6973 696f 6e73 2c0a  lear_divisions,.
-0002fd30: 2020 2020 2020 2020 616c 6967 6e5f 6461          align_da
-0002fd40: 7461 6672 616d 6573 2c0a 2020 2020 2020  taframes,.      
-0002fd50: 2020 6b77 6172 6773 2e70 6f70 2822 746f    kwargs.pop("to
-0002fd60: 6b65 6e22 2c20 4e6f 6e65 292c 0a20 2020  ken", None),.   
-0002fd70: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
-0002fd80: 2020 2020 202a 6172 6773 2c0a 2020 2020       *args,.    
-0002fd90: 290a 2020 2020 7265 7475 726e 206e 6577  ).    return new
-0002fda0: 5f63 6f6c 6c65 6374 696f 6e28 6e65 775f  _collection(new_
-0002fdb0: 6578 7072 290a 0a0a 6465 6620 6973 6e61  expr)...def isna
-0002fdc0: 2861 7267 293a 0a20 2020 2069 6620 6973  (arg):.    if is
-0002fdd0: 696e 7374 616e 6365 2861 7267 2c20 4672  instance(arg, Fr
-0002fde0: 616d 6542 6173 6529 3a0a 2020 2020 2020  ameBase):.      
-0002fdf0: 2020 7265 7475 726e 2061 7267 2e69 736e    return arg.isn
-0002fe00: 6128 290a 2020 2020 656c 7365 3a0a 2020  a().    else:.  
-0002fe10: 2020 2020 2020 7265 7475 726e 2066 726f        return fro
-0002fe20: 6d5f 7061 6e64 6173 2861 7267 292e 6973  m_pandas(arg).is
-0002fe30: 6e61 2829 0a0a 0a64 6566 2065 6c65 6d77  na()...def elemw
-0002fe40: 6973 6528 6f70 2c20 2a61 7267 732c 206d  ise(op, *args, m
-0002fe50: 6574 613d 6e6f 5f64 6566 6175 6c74 2c20  eta=no_default, 
-0002fe60: 6f75 743d 4e6f 6e65 2c20 7472 616e 7366  out=None, transf
-0002fe70: 6f72 6d5f 6469 7669 7369 6f6e 733d 5472  orm_divisions=Tr
-0002fe80: 7565 2c20 2a2a 6b77 6172 6773 293a 0a20  ue, **kwargs):. 
-0002fe90: 2020 2022 2222 456c 656d 656e 7477 6973     """Elementwis
-0002fea0: 6520 6f70 6572 6174 696f 6e20 666f 7220  e operation for 
-0002feb0: 4461 736b 2064 6174 6166 7261 6d65 730a  Dask dataframes.
-0002fec0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-0002fed0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0002fee0: 2020 206f 703a 2063 616c 6c61 626c 650a     op: callable.
-0002fef0: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-0002ff00: 2074 6f20 6170 706c 7920 6163 726f 7373   to apply across
-0002ff10: 2069 6e70 7574 2064 6174 6166 7261 6d65   input dataframe
-0002ff20: 730a 2020 2020 2a61 7267 733a 2044 6174  s.    *args: Dat
-0002ff30: 6146 7261 6d65 732c 2053 6572 6965 732c  aFrames, Series,
-0002ff40: 2053 6361 6c61 7273 2c20 4172 7261 7973   Scalars, Arrays
-0002ff50: 2c0a 2020 2020 2020 2020 5468 6520 6172  ,.        The ar
-0002ff60: 6775 6d65 6e74 7320 6f66 2074 6865 206f  guments of the o
-0002ff70: 7065 7261 7469 6f6e 0a20 2020 206d 6574  peration.    met
-0002ff80: 613a 2070 642e 4461 7461 4672 616d 652c  a: pd.DataFrame,
-0002ff90: 2070 642e 5365 7269 6573 2028 6f70 7469   pd.Series (opti
-0002ffa0: 6f6e 616c 290a 2020 2020 2020 2020 5661  onal).        Va
-0002ffb0: 6c69 6420 6d65 7461 6461 7461 2066 6f72  lid metadata for
-0002ffc0: 2074 6865 206f 7065 7261 7469 6f6e 2e20   the operation. 
-0002ffd0: 2057 696c 6c20 6576 616c 7561 7465 206f   Will evaluate o
-0002ffe0: 6e20 6120 736d 616c 6c20 7069 6563 6520  n a small piece 
-0002fff0: 6f66 0a20 2020 2020 2020 2064 6174 6120  of.        data 
-00030000: 6966 206e 6f74 2070 726f 7669 6465 642e  if not provided.
-00030010: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
-00030020: 6976 6973 696f 6e73 3a20 626f 6f6c 6561  ivisions: boolea
-00030030: 6e0a 2020 2020 2020 2020 4966 2074 6865  n.        If the
-00030040: 2069 6e70 7574 2069 7320 6120 6060 6461   input is a ``da
-00030050: 736b 2e64 6174 6166 7261 6d65 2e49 6e64  sk.dataframe.Ind
-00030060: 6578 6060 2077 6520 6e6f 726d 616c 6c79  ex`` we normally
-00030070: 2077 696c 6c20 616c 736f 2061 7070 6c79   will also apply
-00030080: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
-00030090: 6374 696f 6e20 6f6e 746f 2074 6865 2064  ction onto the d
-000300a0: 6976 6973 696f 6e73 2061 6e64 2061 7070  ivisions and app
-000300b0: 6c79 2074 686f 7365 2074 7261 6e73 666f  ly those transfo
-000300c0: 726d 6564 2064 6976 6973 696f 6e73 0a20  rmed divisions. 
-000300d0: 2020 2020 2020 2074 6f20 7468 6520 6f75         to the ou
-000300e0: 7470 7574 2e20 2059 6f75 2063 616e 2070  tput.  You can p
-000300f0: 6173 7320 6060 7472 616e 7366 6f72 6d5f  ass ``transform_
-00030100: 6469 7669 7369 6f6e 733d 4661 6c73 6560  divisions=False`
-00030110: 6020 746f 206f 7665 7272 6964 650a 2020  ` to override.  
-00030120: 2020 2020 2020 7468 6973 2062 6568 6176        this behav
-00030130: 696f 720a 2020 2020 6f75 7420 3a20 6060  ior.    out : ``
-00030140: 6461 736b 2e61 7272 6179 6060 206f 7220  dask.array`` or 
-00030150: 6060 4e6f 6e65 6060 0a20 2020 2020 2020  ``None``.       
-00030160: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
-00030170: 6b2e 4461 7461 4672 616d 652c 2064 6173  k.DataFrame, das
-00030180: 6b2e 5365 7269 6573 206f 7220 6461 736b  k.Series or dask
-00030190: 2e53 6361 6c61 7220 7468 656e 0a20 2020  .Scalar then.   
-000301a0: 2020 2020 2074 6869 7320 6f76 6572 7772       this overwr
-000301b0: 6974 6573 2074 6865 2063 6f6e 7465 6e74  ites the content
-000301c0: 7320 6f66 2069 7420 7769 7468 2074 6865  s of it with the
-000301d0: 2072 6573 756c 740a 2020 2020 2a2a 6b77   result.    **kw
-000301e0: 6172 6773 3a20 7363 616c 6172 730a 0a20  args: scalars.. 
-000301f0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00030200: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
-00030210: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
-00030220: 6f72 2e61 6464 2c20 6466 2e78 2c20 6466  or.add, df.x, df
-00030230: 2e79 2920 2023 2064 6f63 7465 7374 3a20  .y)  # doctest: 
-00030240: 2b53 4b49 500a 2020 2020 2222 220a 0a20  +SKIP.    """.. 
-00030250: 2020 2061 7267 7320 3d20 5f6d 6179 6265     args = _maybe
-00030260: 5f66 726f 6d5f 7061 6e64 6173 2861 7267  _from_pandas(arg
-00030270: 7329 0a20 2020 2064 6673 203d 205b 6466  s).    dfs = [df
-00030280: 2066 6f72 2064 6620 696e 2061 7267 7320   for df in args 
-00030290: 6966 2069 7369 6e73 7461 6e63 6528 6466  if isinstance(df
-000302a0: 2c20 4672 616d 6542 6173 6529 5d0a 2020  , FrameBase)].  
-000302b0: 2020 6966 206c 656e 2864 6673 2920 3c3d    if len(dfs) <=
-000302c0: 2031 206f 7220 6578 7072 2e61 7265 5f63   1 or expr.are_c
-000302d0: 6f5f 616c 6967 6e65 6428 2a64 6673 293a  o_aligned(*dfs):
-000302e0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-000302f0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
-00030300: 280a 2020 2020 2020 2020 2020 2020 6578  (.            ex
-00030310: 7072 2e55 4675 6e63 456c 656d 7769 7365  pr.UFuncElemwise
-00030320: 2864 6673 5b30 5d2c 206f 702c 206d 6574  (dfs[0], op, met
-00030330: 612c 2074 7261 6e73 666f 726d 5f64 6976  a, transform_div
-00030340: 6973 696f 6e73 2c20 6b77 6172 6773 2c20  isions, kwargs, 
-00030350: 2a61 7267 7329 0a20 2020 2020 2020 2029  *args).        )
-00030360: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00030370: 2020 2072 6573 756c 7420 3d20 6e65 775f     result = new_
-00030380: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
-00030390: 5546 756e 6341 6c69 676e 2864 6673 5b30  UFuncAlign(dfs[0
-000303a0: 5d2c 206f 702c 206d 6574 612c 206b 7761  ], op, meta, kwa
-000303b0: 7267 732c 202a 6172 6773 2929 0a20 2020  rgs, *args)).   
-000303c0: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
-000303d0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
-000303e0: 0a0a 6465 6620 6861 6e64 6c65 5f6f 7574  ..def handle_out
-000303f0: 286f 7574 2c20 7265 7375 6c74 293a 0a20  (out, result):. 
-00030400: 2020 2022 2222 4861 6e64 6c65 206f 7574     """Handle out
-00030410: 2070 6172 616d 6574 6572 730a 0a20 2020   parameters..   
-00030420: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
-00030430: 6b2e 4461 7461 4672 616d 652c 2064 6173  k.DataFrame, das
-00030440: 6b2e 5365 7269 6573 206f 7220 6461 736b  k.Series or dask
-00030450: 2e53 6361 6c61 7220 7468 656e 0a20 2020  .Scalar then.   
-00030460: 2074 6869 7320 6f76 6572 7772 6974 6573   this overwrites
-00030470: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
-00030480: 2069 7420 7769 7468 2074 6865 2072 6573   it with the res
-00030490: 756c 742e 2054 6865 206d 6574 686f 640a  ult. The method.
-000304a0: 2020 2020 7265 706c 6163 6573 2074 6865      replaces the
-000304b0: 2065 7870 7265 7373 696f 6e20 6f66 2074   expression of t
-000304c0: 6865 206f 7574 2070 6172 616d 6574 6572  he out parameter
-000304d0: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
-000304e0: 0a20 2020 2066 726f 6d20 7468 6973 206f  .    from this o
-000304f0: 7065 7261 7469 6f6e 2074 6f20 7065 7266  peration to perf
-00030500: 6f72 6d20 736f 6d65 7468 696e 6720 616b  orm something ak
-00030510: 696e 2074 6f20 616e 2069 6e70 6c61 6365  in to an inplace
-00030520: 0a20 2020 206d 6f64 6966 6963 6174 696f  .    modificatio
-00030530: 6e2e 0a20 2020 2022 2222 0a20 2020 2069  n..    """.    i
-00030540: 6620 6973 696e 7374 616e 6365 286f 7574  f isinstance(out
-00030550: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
-00030560: 2020 6966 206c 656e 286f 7574 2920 3d3d    if len(out) ==
-00030570: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00030580: 6f75 7420 3d20 6f75 745b 305d 0a20 2020  out = out[0].   
-00030590: 2020 2020 2065 6c69 6620 6c65 6e28 6f75       elif len(ou
-000305a0: 7429 203e 2031 3a0a 2020 2020 2020 2020  t) > 1:.        
-000305b0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-000305c0: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-000305d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000305e0: 5468 6520 606f 7574 6020 7061 7261 6d65  The `out` parame
-000305f0: 7465 7220 7769 7468 206c 656e 6774 6820  ter with length 
-00030600: 3e20 3120 6973 206e 6f74 2073 7570 706f  > 1 is not suppo
-00030610: 7274 6564 220a 2020 2020 2020 2020 2020  rted".          
-00030620: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-00030630: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
-00030640: 7420 3d20 4e6f 6e65 0a0a 2020 2020 6966  t = None..    if
-00030650: 206f 7574 2069 7320 6e6f 7420 4e6f 6e65   out is not None
-00030660: 2061 6e64 206f 7574 2e5f 5f63 6c61 7373   and out.__class
-00030670: 5f5f 2021 3d20 7265 7375 6c74 2e5f 5f63  __ != result.__c
-00030680: 6c61 7373 5f5f 3a0a 2020 2020 2020 2020  lass__:.        
-00030690: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-000306a0: 0a20 2020 2020 2020 2020 2020 2022 4d69  .            "Mi
-000306b0: 736d 6174 6368 6564 2074 7970 6573 2062  smatched types b
-000306c0: 6574 7765 656e 2072 6573 756c 7420 616e  etween result an
-000306d0: 6420 6f75 7420 7061 7261 6d65 7465 722e  d out parameter.
-000306e0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-000306f0: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
-00030700: 7322 2025 2028 7374 7228 7479 7065 286f  s" % (str(type(o
-00030710: 7574 2929 2c20 7374 7228 7479 7065 2872  ut)), str(type(r
-00030720: 6573 756c 7429 2929 0a20 2020 2020 2020  esult))).       
-00030730: 2029 0a0a 2020 2020 6966 2069 7369 6e73   )..    if isins
-00030740: 7461 6e63 6528 6f75 742c 2044 6174 6146  tance(out, DataF
-00030750: 7261 6d65 293a 0a20 2020 2020 2020 2069  rame):.        i
-00030760: 6620 6c65 6e28 6f75 742e 636f 6c75 6d6e  f len(out.column
-00030770: 7329 2021 3d20 6c65 6e28 7265 7375 6c74  s) != len(result
-00030780: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
-00030790: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000307a0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-000307b0: 2020 2020 2020 2020 2022 4d69 736d 6174           "Mismat
-000307c0: 6368 6564 2063 6f6c 756d 6e73 2063 6f75  ched columns cou
-000307d0: 6e74 2062 6574 7765 656e 2072 6573 756c  nt between resul
-000307e0: 7420 616e 6420 6f75 7420 7061 7261 6d65  t and out parame
-000307f0: 7465 722e 2022 0a20 2020 2020 2020 2020  ter. ".         
-00030800: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
-00030810: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
-00030820: 7228 6c65 6e28 6f75 742e 636f 6c75 6d6e  r(len(out.column
-00030830: 7329 292c 2073 7472 286c 656e 2872 6573  s)), str(len(res
-00030840: 756c 742e 636f 6c75 6d6e 7329 2929 0a20  ult.columns))). 
-00030850: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00030860: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00030870: 6f75 742c 2028 5365 7269 6573 2c20 4461  out, (Series, Da
-00030880: 7461 4672 616d 652c 2053 6361 6c61 7229  taFrame, Scalar)
-00030890: 293a 0a20 2020 2020 2020 206f 7574 2e5f  ):.        out._
-000308a0: 6578 7072 203d 2072 6573 756c 742e 5f65  expr = result._e
-000308b0: 7870 720a 2020 2020 656c 6966 206f 7574  xpr.    elif out
-000308c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000308d0: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
-000308e0: 2020 2020 2020 2020 2020 2254 6865 206f            "The o
-000308f0: 7574 2070 6172 616d 6574 6572 2069 7320  ut parameter is 
-00030900: 6e6f 7420 6675 6c6c 7920 7375 7070 6f72  not fully suppor
-00030910: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
-00030920: 2020 2220 5265 6365 6976 6564 2074 7970    " Received typ
-00030930: 6520 2573 2c20 6578 7065 6374 6564 2025  e %s, expected %
-00030940: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
-00030950: 2520 280a 2020 2020 2020 2020 2020 2020  % (.            
-00030960: 2020 2020 7479 7065 6e61 6d65 2874 7970      typename(typ
-00030970: 6528 6f75 7429 292c 0a20 2020 2020 2020  e(out)),.       
-00030980: 2020 2020 2020 2020 2074 7970 656e 616d           typenam
-00030990: 6528 7479 7065 2872 6573 756c 7429 292c  e(type(result)),
-000309a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000309b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000309c0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-000309d0: 656e 7465 6445 7272 6f72 286d 7367 290a  entedError(msg).
-000309e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000309f0: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
-00030a00: 0a0a 6465 6620 5f63 6f6d 7075 7465 5f70  ..def _compute_p
-00030a10: 6172 7469 7469 6f6e 5f73 7461 7473 280a  artition_stats(.
-00030a20: 2020 2020 636f 6c75 6d6e 3a20 5365 7269      column: Seri
-00030a30: 6573 2c20 616c 6c6f 775f 6f76 6572 6c61  es, allow_overla
-00030a40: 703a 2062 6f6f 6c20 3d20 4661 6c73 650a  p: bool = False.
-00030a50: 2920 2d3e 2074 7570 6c65 5b6c 6973 742c  ) -> tuple[list,
-00030a60: 206c 6973 742c 206c 6973 745b 696e 745d   list, list[int]
-00030a70: 5d3a 0a20 2020 2022 2222 466f 7220 6120  ]:.    """For a 
-00030a80: 6769 7665 6e20 636f 6c75 6d6e 2c20 636f  given column, co
-00030a90: 6d70 7574 6520 7468 6520 6d69 6e2c 206d  mpute the min, m
-00030aa0: 6178 2c20 616e 6420 6c65 6e20 6f66 2065  ax, and len of e
-00030ab0: 6163 6820 7061 7274 6974 696f 6e2e 0a0a  ach partition...
-00030ac0: 2020 2020 416e 6420 6d61 6b65 2073 7572      And make sur
-00030ad0: 6520 7468 6174 2074 6865 2070 6172 7469  e that the parti
-00030ae0: 7469 6f6e 7320 6172 6520 736f 7274 6564  tions are sorted
-00030af0: 2072 656c 6174 6976 6520 746f 2065 6163   relative to eac
-00030b00: 6820 6f74 6865 722e 0a20 2020 204e 4f54  h other..    NOT
-00030b10: 453a 2074 6869 7320 646f 6573 206e 6f74  E: this does not
-00030b20: 2067 7561 7261 6e74 6565 2074 6861 7420   guarantee that 
-00030b30: 6576 6572 7920 7061 7274 6974 696f 6e20  every partition 
-00030b40: 6973 2069 6e74 6572 6e61 6c6c 7920 736f  is internally so
-00030b50: 7274 6564 2e0a 2020 2020 2222 220a 2020  rted..    """.  
-00030b60: 2020 6d69 6e73 203d 2063 6f6c 756d 6e2e    mins = column.
-00030b70: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
-00030b80: 2e6d 696e 2c20 6d65 7461 3d63 6f6c 756d  .min, meta=colum
-00030b90: 6e29 0a20 2020 206d 6178 6573 203d 2063  n).    maxes = c
-00030ba0: 6f6c 756d 6e2e 6d61 705f 7061 7274 6974  olumn.map_partit
-00030bb0: 696f 6e73 284d 2e6d 6178 2c20 6d65 7461  ions(M.max, meta
-00030bc0: 3d63 6f6c 756d 6e29 0a20 2020 206c 656e  =column).    len
-00030bd0: 7320 3d20 636f 6c75 6d6e 2e6d 6170 5f70  s = column.map_p
-00030be0: 6172 7469 7469 6f6e 7328 6c65 6e2c 206d  artitions(len, m
-00030bf0: 6574 613d 636f 6c75 6d6e 290a 2020 2020  eta=column).    
-00030c00: 6d69 6e73 2c20 6d61 7865 732c 206c 656e  mins, maxes, len
-00030c10: 7320 3d20 636f 6d70 7574 6528 6d69 6e73  s = compute(mins
-00030c20: 2c20 6d61 7865 732c 206c 656e 7329 0a20  , maxes, lens). 
-00030c30: 2020 206d 696e 7320 3d20 6d69 6e73 2e62     mins = mins.b
-00030c40: 6669 6c6c 2829 2e74 6f6c 6973 7428 290a  fill().tolist().
-00030c50: 2020 2020 6d61 7865 7320 3d20 6d61 7865      maxes = maxe
-00030c60: 732e 6266 696c 6c28 292e 746f 6c69 7374  s.bfill().tolist
-00030c70: 2829 0a20 2020 206e 6f6e 5f65 6d70 7479  ().    non_empty
-00030c80: 5f6d 696e 7320 3d20 5b6d 2066 6f72 206d  _mins = [m for m
-00030c90: 2c20 6c65 6e67 7468 2069 6e20 7a69 7028  , length in zip(
-00030ca0: 6d69 6e73 2c20 6c65 6e73 2920 6966 206c  mins, lens) if l
-00030cb0: 656e 6774 6820 213d 2030 5d0a 2020 2020  ength != 0].    
-00030cc0: 6e6f 6e5f 656d 7074 795f 6d61 7865 7320  non_empty_maxes 
-00030cd0: 3d20 5b6d 2066 6f72 206d 2c20 6c65 6e67  = [m for m, leng
-00030ce0: 7468 2069 6e20 7a69 7028 6d61 7865 732c  th in zip(maxes,
-00030cf0: 206c 656e 7329 2069 6620 6c65 6e67 7468   lens) if length
-00030d00: 2021 3d20 305d 0a20 2020 2069 6620 280a   != 0].    if (.
-00030d10: 2020 2020 2020 2020 736f 7274 6564 286e          sorted(n
-00030d20: 6f6e 5f65 6d70 7479 5f6d 696e 7329 2021  on_empty_mins) !
-00030d30: 3d20 6e6f 6e5f 656d 7074 795f 6d69 6e73  = non_empty_mins
-00030d40: 0a20 2020 2020 2020 206f 7220 736f 7274  .        or sort
-00030d50: 6564 286e 6f6e 5f65 6d70 7479 5f6d 6178  ed(non_empty_max
-00030d60: 6573 2920 213d 206e 6f6e 5f65 6d70 7479  es) != non_empty
-00030d70: 5f6d 6178 6573 0a20 2020 2029 3a0a 2020  _maxes.    ):.  
-00030d80: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00030d90: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00030da0: 2020 2020 6622 5061 7274 6974 696f 6e73      f"Partitions
-00030db0: 2061 7265 206e 6f74 2073 6f72 7465 6420   are not sorted 
-00030dc0: 6173 6365 6e64 696e 6720 6279 207b 636f  ascending by {co
-00030dd0: 6c75 6d6e 2e6e 616d 6520 6f72 2027 7468  lumn.name or 'th
-00030de0: 6520 696e 6465 7827 7d2e 2022 2c0a 2020  e index'}. ",.  
-00030df0: 2020 2020 2020 2020 2020 6622 496e 2079            f"In y
-00030e00: 6f75 7220 6461 7461 7365 7420 7468 6520  our dataset the 
-00030e10: 286d 696e 2c20 6d61 782c 206c 656e 2920  (min, max, len) 
-00030e20: 7661 6c75 6573 206f 6620 7b63 6f6c 756d  values of {colum
-00030e30: 6e2e 6e61 6d65 206f 7220 2774 6865 2069  n.name or 'the i
-00030e40: 6e64 6578 277d 2022 0a20 2020 2020 2020  ndex'} ".       
-00030e50: 2020 2020 2066 2266 6f72 2065 6163 6820       f"for each 
-00030e60: 7061 7274 6974 696f 6e20 6172 653a 207b  partition are: {
-00030e70: 6c69 7374 287a 6970 286d 696e 732c 206d  list(zip(mins, m
-00030e80: 6178 6573 2c20 6c65 6e73 2929 7d22 2c0a  axes, lens))}",.
-00030e90: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
-00030ea0: 206e 6f74 2061 6c6c 6f77 5f6f 7665 726c   not allow_overl
-00030eb0: 6170 2061 6e64 2061 6e79 280a 2020 2020  ap and any(.    
-00030ec0: 2020 2020 6120 3c3d 2062 2066 6f72 2061      a <= b for a
-00030ed0: 2c20 6220 696e 207a 6970 286e 6f6e 5f65  , b in zip(non_e
-00030ee0: 6d70 7479 5f6d 696e 735b 313a 5d2c 206e  mpty_mins[1:], n
-00030ef0: 6f6e 5f65 6d70 7479 5f6d 6178 6573 5b3a  on_empty_maxes[:
-00030f00: 2d31 5d29 0a20 2020 2029 3a0a 2020 2020  -1]).    ):.    
-00030f10: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00030f20: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
-00030f30: 5061 7274 6974 696f 6e73 2068 6176 6520  Partitions have 
-00030f40: 6f76 6572 6c61 7070 696e 6720 7661 6c75  overlapping valu
-00030f50: 6573 2c20 736f 2064 6976 6973 696f 6e73  es, so divisions
-00030f60: 2061 7265 206e 6f6e 2d75 6e69 7175 652e   are non-unique.
-00030f70: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-00030f80: 5573 6520 6073 6574 5f69 6e64 6578 2873  Use `set_index(s
-00030f90: 6f72 7465 643d 5472 7565 2960 2077 6974  orted=True)` wit
-00030fa0: 6820 6e6f 2060 6469 7669 7369 6f6e 7360  h no `divisions`
-00030fb0: 2074 6f20 616c 6c6f 7720 6461 736b 2074   to allow dask t
-00030fc0: 6f20 6669 7820 7468 6520 6f76 6572 6c61  o fix the overla
-00030fd0: 702e 2022 0a20 2020 2020 2020 2020 2020  p. ".           
-00030fe0: 2066 2249 6e20 796f 7572 2064 6174 6173   f"In your datas
-00030ff0: 6574 2074 6865 2028 6d69 6e2c 206d 6178  et the (min, max
-00031000: 2c20 6c65 6e29 2076 616c 7565 7320 6f66  , len) values of
-00031010: 207b 636f 6c75 6d6e 2e6e 616d 6520 6f72   {column.name or
-00031020: 2027 7468 6520 696e 6465 7827 7d20 220a   'the index'} ".
-00031030: 2020 2020 2020 2020 2020 2020 6622 666f              f"fo
-00031040: 7220 6561 6368 2070 6172 7469 7469 6f6e  r each partition
-00031050: 2061 7265 203a 207b 6c69 7374 287a 6970   are : {list(zip
-00031060: 286d 696e 732c 206d 6178 6573 2c20 6c65  (mins, maxes, le
-00031070: 6e73 2929 7d22 2c0a 2020 2020 2020 2020  ns))}",.        
-00031080: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
-00031090: 0a20 2020 2020 2020 2029 0a20 2020 206c  .        ).    l
-000310a0: 656e 7320 3d20 6d65 7468 6f64 732e 746f  ens = methods.to
-000310b0: 6c69 7374 286c 656e 7329 0a20 2020 2069  list(lens).    i
-000310c0: 6620 6e6f 7420 616c 6c6f 775f 6f76 6572  f not allow_over
-000310d0: 6c61 703a 0a20 2020 2020 2020 2072 6574  lap:.        ret
-000310e0: 7572 6e20 286d 696e 732c 206d 6178 6573  urn (mins, maxes
-000310f0: 2c20 6c65 6e73 290a 2020 2020 656c 7365  , lens).    else
-00031100: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00031110: 2028 6e6f 6e5f 656d 7074 795f 6d69 6e73   (non_empty_mins
-00031120: 2c20 6e6f 6e5f 656d 7074 795f 6d61 7865  , non_empty_maxe
-00031130: 732c 206c 656e 7329 0a                   s, lens).
+00001d30: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+00001d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001d50: 2020 2020 2020 2020 6c65 7665 6c3d 6c65          level=le
+00001d60: 7665 6c2c 0a20 2020 2020 2020 2020 2020  vel,.           
+00001d70: 2020 2020 2020 2020 2020 2020 2066 696c               fil
+00001d80: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+00001d90: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00001da0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00001db0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00001dc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00001dd0: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
+00001de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001df0: 6578 7072 2e4d 6574 686f 644f 7065 7261  expr.MethodOpera
+00001e00: 746f 7228 0a20 2020 2020 2020 2020 2020  tor(.           
+00001e10: 2020 2020 2020 2020 206e 616d 653d 6e61           name=na
+00001e20: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00001e30: 2020 2020 2020 2020 6c65 6674 3d66 7261          left=fra
+00001e40: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00001e50: 2020 2020 2020 2020 7269 6768 743d 6f74          right=ot
+00001e60: 6865 722c 0a20 2020 2020 2020 2020 2020  her,.           
+00001e70: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
+00001e80: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
+00001e90: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
+00001ea0: 7565 3d66 696c 6c5f 7661 6c75 652c 0a20  ue=fill_value,. 
+00001eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ec0: 2020 206c 6576 656c 3d6c 6576 656c 2c0a     level=level,.
+00001ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ee0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00001ef0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00001f00: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00001f10: 656d 656e 7465 6445 7272 6f72 2866 2243  ementedError(f"C
+00001f20: 616e 6e6f 7420 6372 6561 7465 206d 6574  annot create met
+00001f30: 686f 6420 6f70 6572 6174 6f72 2066 6f72  hod operator for
+00001f40: 207b 636c 6173 735f 3d7d 2229 0a0a 2020   {class_=}")..  
+00001f50: 2020 6d65 7468 6f64 2e5f 5f6e 616d 655f    method.__name_
+00001f60: 5f20 3d20 6e61 6d65 0a20 2020 2072 6574  _ = name.    ret
+00001f70: 7572 6e20 6d65 7468 6f64 0a0a 0a64 6566  urn method...def
+00001f80: 205f 7772 6170 5f75 6e61 7279 5f65 7870   _wrap_unary_exp
+00001f90: 725f 6f70 2873 656c 662c 206f 703d 4e6f  r_op(self, op=No
+00001fa0: 6e65 293a 0a20 2020 2023 2057 7261 7020  ne):.    # Wrap 
+00001fb0: 6578 7072 206f 7065 7261 746f 720a 2020  expr operator.  
+00001fc0: 2020 6173 7365 7274 206f 7020 6973 206e    assert op is n
+00001fd0: 6f74 204e 6f6e 650a 2020 2020 7265 7475  ot None.    retu
+00001fe0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00001ff0: 6e28 6765 7461 7474 7228 7365 6c66 2e65  n(getattr(self.e
+00002000: 7870 722c 206f 7029 2829 290a 0a0a 5f57  xpr, op)())..._W
+00002010: 4152 4e5f 414e 4e4f 5441 5449 4f4e 5320  ARN_ANNOTATIONS 
+00002020: 3d20 5472 7565 0a23 0a23 2043 6f6c 6c65  = True.#.# Colle
+00002030: 6374 696f 6e20 636c 6173 7365 730a 230a  ction classes.#.
+00002040: 0a0a 636c 6173 7320 4672 616d 6542 6173  ..class FrameBas
+00002050: 6528 4461 736b 4d65 7468 6f64 734d 6978  e(DaskMethodsMix
+00002060: 696e 293a 0a20 2020 2022 2222 4261 7365  in):.    """Base
+00002070: 2063 6c61 7373 2066 6f72 2045 7870 722d   class for Expr-
+00002080: 6261 636b 6564 2043 6f6c 6c65 6374 696f  backed Collectio
+00002090: 6e73 2222 220a 0a20 2020 205f 5f64 6173  ns"""..    __das
+000020a0: 6b5f 7363 6865 6475 6c65 725f 5f20 3d20  k_scheduler__ = 
+000020b0: 7374 6174 6963 6d65 7468 6f64 280a 2020  staticmethod(.  
+000020c0: 2020 2020 2020 6e61 6d65 645f 7363 6865        named_sche
+000020d0: 6475 6c65 7273 2e67 6574 2822 7468 7265  dulers.get("thre
+000020e0: 6164 7322 2c20 6e61 6d65 645f 7363 6865  ads", named_sche
+000020f0: 6475 6c65 7273 5b22 7379 6e63 225d 290a  dulers["sync"]).
+00002100: 2020 2020 290a 2020 2020 5f5f 6461 736b      ).    __dask
+00002110: 5f6f 7074 696d 697a 655f 5f20 3d20 7374  _optimize__ = st
+00002120: 6174 6963 6d65 7468 6f64 286c 616d 6264  aticmethod(lambd
+00002130: 6120 6473 6b2c 206b 6579 732c 202a 2a6b  a dsk, keys, **k
+00002140: 7761 7267 733a 2064 736b 290a 0a20 2020  wargs: dsk)..   
+00002150: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00002160: 6c66 2c20 6578 7072 293a 0a20 2020 2020  lf, expr):.     
+00002170: 2020 2067 6c6f 6261 6c20 5f57 4152 4e5f     global _WARN_
+00002180: 414e 4e4f 5441 5449 4f4e 530a 2020 2020  ANNOTATIONS.    
+00002190: 2020 2020 6966 205f 5741 524e 5f41 4e4e      if _WARN_ANN
+000021a0: 4f54 4154 494f 4e53 2061 6e64 2028 616e  OTATIONS and (an
+000021b0: 6e6f 7420 3a3d 2067 6574 5f61 6e6e 6f74  not := get_annot
+000021c0: 6174 696f 6e73 2829 293a 0a20 2020 2020  ations()):.     
+000021d0: 2020 2020 2020 205f 5741 524e 5f41 4e4e         _WARN_ANN
+000021e0: 4f54 4154 494f 4e53 203d 2046 616c 7365  OTATIONS = False
+000021f0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00002200: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00002210: 2020 2020 2020 2020 2020 2020 6622 4461              f"Da
+00002220: 736b 2061 6e6e 6f74 6174 696f 6e73 207b  sk annotations {
+00002230: 616e 6e6f 747d 2064 6574 6563 7465 642e  annot} detected.
+00002240: 2041 6e6e 6f74 6174 696f 6e73 2077 696c   Annotations wil
+00002250: 6c20 6265 2069 676e 6f72 6564 2077 6865  l be ignored whe
+00002260: 6e20 7573 696e 6720 7175 6572 792d 706c  n using query-pl
+00002270: 616e 6e69 6e67 2e22 0a20 2020 2020 2020  anning.".       
+00002280: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00002290: 656c 662e 5f65 7870 7220 3d20 6578 7072  elf._expr = expr
+000022a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+000022b0: 2020 2020 6465 6620 6578 7072 2873 656c      def expr(sel
+000022c0: 6629 202d 3e20 6578 7072 2e45 7870 723a  f) -> expr.Expr:
+000022d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000022e0: 7365 6c66 2e5f 6578 7072 0a0a 2020 2020  self._expr..    
+000022f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00002300: 6620 5f6d 6574 6128 7365 6c66 293a 0a20  f _meta(self):. 
+00002310: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00002320: 6c66 2e65 7870 722e 5f6d 6574 610a 0a20  lf.expr._meta.. 
+00002330: 2020 2040 6675 6e63 746f 6f6c 732e 6361     @functools.ca
+00002340: 6368 6564 5f70 726f 7065 7274 790a 2020  ched_property.  
+00002350: 2020 6465 6620 5f6d 6574 615f 6e6f 6e65    def _meta_none
+00002360: 6d70 7479 2873 656c 6629 3a0a 2020 2020  mpty(self):.    
+00002370: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
+00002380: 6e6f 6e65 6d70 7479 2873 656c 662e 5f6d  nonempty(self._m
+00002390: 6574 6129 0a0a 2020 2020 4070 726f 7065  eta)..    @prope
+000023a0: 7274 790a 2020 2020 6465 6620 6469 7669  rty.    def divi
+000023b0: 7369 6f6e 7328 7365 6c66 293a 0a20 2020  sions(self):.   
+000023c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000023d0: 2054 7570 6c65 206f 6620 6060 6e70 6172   Tuple of ``npar
+000023e0: 7469 7469 6f6e 7320 2b20 3160 6020 7661  titions + 1`` va
+000023f0: 6c75 6573 2c20 696e 2061 7363 656e 6469  lues, in ascendi
+00002400: 6e67 206f 7264 6572 2c20 6d61 726b 696e  ng order, markin
+00002410: 6720 7468 650a 2020 2020 2020 2020 6c6f  g the.        lo
+00002420: 7765 722f 7570 7065 7220 626f 756e 6473  wer/upper bounds
+00002430: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
+00002440: 6f6e 2773 2069 6e64 6578 2e20 4469 7669  on's index. Divi
+00002450: 7369 6f6e 7320 616c 6c6f 7720 4461 736b  sions allow Dask
+00002460: 0a20 2020 2020 2020 2074 6f20 6b6e 6f77  .        to know
+00002470: 2077 6869 6368 2070 6172 7469 7469 6f6e   which partition
+00002480: 2077 696c 6c20 636f 6e74 6169 6e20 6120   will contain a 
+00002490: 6769 7665 6e20 7661 6c75 652c 2073 6967  given value, sig
+000024a0: 6e69 6669 6361 6e74 6c79 0a20 2020 2020  nificantly.     
+000024b0: 2020 2073 7065 6564 696e 6720 7570 206f     speeding up o
+000024c0: 7065 7261 7469 6f6e 7320 6c69 6b65 2060  perations like `
+000024d0: 6c6f 6360 2c20 606d 6572 6765 602c 2061  loc`, `merge`, a
+000024e0: 6e64 2060 6772 6f75 7062 7960 2062 7920  nd `groupby` by 
+000024f0: 6e6f 740a 2020 2020 2020 2020 6861 7669  not.        havi
+00002500: 6e67 2074 6f20 7365 6172 6368 2074 6865  ng to search the
+00002510: 2066 756c 6c20 6461 7461 7365 742e 0a0a   full dataset...
+00002520: 2020 2020 2020 2020 4578 616d 706c 653a          Example:
+00002530: 2066 6f72 2060 6064 6976 6973 696f 6e73   for ``divisions
+00002540: 203d 2028 302c 2031 302c 2035 302c 2031   = (0, 10, 50, 1
+00002550: 3030 2960 602c 2074 6865 7265 2061 7265  00)``, there are
+00002560: 2074 6872 6565 2070 6172 7469 7469 6f6e   three partition
+00002570: 732c 0a20 2020 2020 2020 2077 6865 7265  s,.        where
+00002580: 2074 6865 2069 6e64 6578 2069 6e20 6561   the index in ea
+00002590: 6368 2070 6172 7469 7469 6f6e 2063 6f6e  ch partition con
+000025a0: 7461 696e 7320 7661 6c75 6573 205b 302c  tains values [0,
+000025b0: 2031 3029 2c20 5b31 302c 2035 3029 2c0a   10), [10, 50),.
+000025c0: 2020 2020 2020 2020 616e 6420 5b35 302c          and [50,
+000025d0: 2031 3030 5d2c 2072 6573 7065 6374 6976   100], respectiv
+000025e0: 656c 792e 2044 6173 6b20 7468 6572 6566  ely. Dask theref
+000025f0: 6f72 6520 6b6e 6f77 7320 6060 6466 2e6c  ore knows ``df.l
+00002600: 6f63 5b34 355d 6060 0a20 2020 2020 2020  oc[45]``.       
+00002610: 2077 696c 6c20 6265 2069 6e20 7468 6520   will be in the 
+00002620: 7365 636f 6e64 2070 6172 7469 7469 6f6e  second partition
+00002630: 2e0a 0a20 2020 2020 2020 2057 6865 6e20  ...        When 
+00002640: 6576 6572 7920 6974 656d 2069 6e20 6060  every item in ``
+00002650: 6469 7669 7369 6f6e 7360 6020 6973 2060  divisions`` is `
+00002660: 604e 6f6e 6560 602c 2074 6865 2064 6976  `None``, the div
+00002670: 6973 696f 6e73 2061 7265 2075 6e6b 6e6f  isions are unkno
+00002680: 776e 2e0a 2020 2020 2020 2020 4d6f 7374  wn..        Most
+00002690: 206f 7065 7261 7469 6f6e 7320 6361 6e20   operations can 
+000026a0: 7374 696c 6c20 6265 2070 6572 666f 726d  still be perform
+000026b0: 6564 2c20 6275 7420 736f 6d65 2077 696c  ed, but some wil
+000026c0: 6c20 6265 206d 7563 6820 736c 6f77 6572  l be much slower
+000026d0: 2c0a 2020 2020 2020 2020 616e 6420 6120  ,.        and a 
+000026e0: 6665 7720 6d61 7920 6661 696c 2e0a 0a20  few may fail... 
+000026f0: 2020 2020 2020 2049 7420 6973 206e 6f74         It is not
+00002700: 2073 7570 706f 7274 6564 2074 6f20 7365   supported to se
+00002710: 7420 6060 6469 7669 7369 6f6e 7360 6020  t ``divisions`` 
+00002720: 6469 7265 6374 6c79 2e20 496e 7374 6561  directly. Instea
+00002730: 642c 2075 7365 2060 6073 6574 5f69 6e64  d, use ``set_ind
+00002740: 6578 6060 2c0a 2020 2020 2020 2020 7768  ex``,.        wh
+00002750: 6963 6820 736f 7274 7320 616e 6420 7370  ich sorts and sp
+00002760: 6c69 7473 2074 6865 2064 6174 6120 6173  lits the data as
+00002770: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
+00002780: 2053 6565 2068 7474 7073 3a2f 2f64 6f63   See https://doc
+00002790: 732e 6461 736b 2e6f 7267 2f65 6e2f 6c61  s.dask.org/en/la
+000027a0: 7465 7374 2f64 6174 6166 7261 6d65 2d64  test/dataframe-d
+000027b0: 6573 6967 6e2e 6874 6d6c 2370 6172 7469  esign.html#parti
+000027c0: 7469 6f6e 732e 0a20 2020 2020 2020 2022  tions..        "
+000027d0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000027e0: 6e20 7365 6c66 2e65 7870 722e 6469 7669  n self.expr.divi
+000027f0: 7369 6f6e 730a 0a20 2020 2040 7072 6f70  sions..    @prop
+00002800: 6572 7479 0a20 2020 2064 6566 206e 7061  erty.    def npa
+00002810: 7274 6974 696f 6e73 2873 656c 6629 3a0a  rtitions(self):.
+00002820: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00002830: 6e20 6e75 6d62 6572 206f 6620 7061 7274  n number of part
+00002840: 6974 696f 6e73 2222 220a 2020 2020 2020  itions""".      
+00002850: 2020 7265 7475 726e 2073 656c 662e 6578    return self.ex
+00002860: 7072 2e6e 7061 7274 6974 696f 6e73 0a0a  pr.npartitions..
+00002870: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00002880: 2020 6465 6620 6474 7970 6573 2873 656c    def dtypes(sel
+00002890: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+000028a0: 6574 7572 6e20 6461 7461 2074 7970 6573  eturn data types
+000028b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000028c0: 726e 2073 656c 662e 6578 7072 2e5f 6d65  rn self.expr._me
+000028d0: 7461 2e64 7479 7065 730a 0a20 2020 2040  ta.dtypes..    @
+000028e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+000028f0: 2073 697a 6528 7365 6c66 293a 0a20 2020   size(self):.   
+00002900: 2020 2020 2022 2222 5369 7a65 206f 6620       """Size of 
+00002910: 7468 6520 5365 7269 6573 206f 7220 4461  the Series or Da
+00002920: 7461 4672 616d 6520 6173 2061 2044 656c  taFrame as a Del
+00002930: 6179 6564 206f 626a 6563 742e 0a0a 2020  ayed object...  
+00002940: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+00002950: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00002960: 2020 2020 2020 2020 3e3e 3e20 7365 7269          >>> seri
+00002970: 6573 2e73 697a 6520 2023 2064 6f63 7465  es.size  # docte
+00002980: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+00002990: 2020 3c64 6173 6b5f 6578 7072 2e65 7870    <dask_expr.exp
+000029a0: 722e 5363 616c 6172 3a20 6578 7072 3d64  r.Scalar: expr=d
+000029b0: 662e 7369 7a65 2829 2c20 6474 7970 653d  f.size(), dtype=
+000029c0: 696e 7436 343e 0a20 2020 2020 2020 2022  int64>.        "
+000029d0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000029e0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+000029f0: 2873 656c 662e 6578 7072 2e73 697a 6529  (self.expr.size)
+00002a00: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00002a10: 2020 2020 6465 6620 636f 6c75 6d6e 7328      def columns(
+00002a20: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00002a30: 6574 7572 6e20 7365 6c66 2e5f 6d65 7461  eturn self._meta
+00002a40: 2e63 6f6c 756d 6e73 0a0a 2020 2020 4063  .columns..    @c
+00002a50: 6f6c 756d 6e73 2e73 6574 7465 720a 2020  olumns.setter.  
+00002a60: 2020 6465 6620 636f 6c75 6d6e 7328 7365    def columns(se
+00002a70: 6c66 2c20 636f 6c75 6d6e 7329 3a0a 2020  lf, columns):.  
+00002a80: 2020 2020 2020 6966 206c 656e 2863 6f6c        if len(col
+00002a90: 756d 6e73 2920 213d 206c 656e 2873 656c  umns) != len(sel
+00002aa0: 662e 636f 6c75 6d6e 7329 3a0a 2020 2020  f.columns):.    
+00002ab0: 2020 2020 2020 2020 2320 7375 7266 6163          # surfac
+00002ac0: 6520 7061 6e64 6173 2065 7272 6f72 0a20  e pandas error. 
+00002ad0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00002ae0: 5f65 7870 722e 5f6d 6574 612e 636f 6c75  _expr._meta.colu
+00002af0: 6d6e 7320 3d20 636f 6c75 6d6e 730a 2020  mns = columns.  
+00002b00: 2020 2020 2020 7365 6c66 2e5f 6578 7072        self._expr
+00002b10: 203d 2065 7870 722e 436f 6c75 6d6e 7353   = expr.ColumnsS
+00002b20: 6574 7465 7228 7365 6c66 2c20 636f 6c75  etter(self, colu
+00002b30: 6d6e 7329 0a0a 2020 2020 6465 6620 636c  mns)..    def cl
+00002b40: 6561 725f 6469 7669 7369 6f6e 7328 7365  ear_divisions(se
+00002b50: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00002b60: 466f 7267 6574 2064 6976 6973 696f 6e20  Forget division 
+00002b70: 696e 666f 726d 6174 696f 6e2e 0a0a 2020  information...  
+00002b80: 2020 2020 2020 5468 6973 2069 7320 7573        This is us
+00002b90: 6566 756c 2069 6620 7468 6520 6469 7669  eful if the divi
+00002ba0: 7369 6f6e 7320 6172 6520 6e6f 206c 6f6e  sions are no lon
+00002bb0: 6765 7220 6d65 616e 696e 6766 756c 2e0a  ger meaningful..
+00002bc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00002bd0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00002be0: 6f6c 6c65 6374 696f 6e28 6578 7072 2e43  ollection(expr.C
+00002bf0: 6c65 6172 4469 7669 7369 6f6e 7328 7365  learDivisions(se
+00002c00: 6c66 2929 0a0a 2020 2020 6465 6620 5f5f  lf))..    def __
+00002c10: 6c65 6e5f 5f28 7365 6c66 293a 0a20 2020  len__(self):.   
+00002c20: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00002c30: 636f 6c6c 6563 7469 6f6e 284c 656e 2873  collection(Len(s
+00002c40: 656c 6629 292e 636f 6d70 7574 6528 290a  elf)).compute().
+00002c50: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00002c60: 2020 2064 6566 206e 6279 7465 7328 7365     def nbytes(se
+00002c70: 6c66 293a 0a20 2020 2020 2020 2072 6169  lf):.        rai
+00002c80: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00002c90: 6445 7272 6f72 2822 6e62 7974 6573 2069  dError("nbytes i
+00002ca0: 7320 6e6f 7420 696d 706c 656d 656e 7465  s not implemente
+00002cb0: 6420 6f6e 2044 6174 6146 7261 6d65 2229  d on DataFrame")
+00002cc0: 0a0a 2020 2020 6465 6620 5f5f 7265 6475  ..    def __redu
+00002cd0: 6365 5f5f 2873 656c 6629 3a0a 2020 2020  ce__(self):.    
+00002ce0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00002cf0: 6f6c 6c65 6374 696f 6e2c 2028 7365 6c66  ollection, (self
+00002d00: 2e5f 6578 7072 2c29 0a0a 2020 2020 6465  ._expr,)..    de
+00002d10: 6620 5f5f 6765 7469 7465 6d5f 5f28 7365  f __getitem__(se
+00002d20: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00002d30: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00002d40: 6528 6f74 6865 722c 2046 7261 6d65 4261  e(other, FrameBa
+00002d50: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
+00002d60: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00002d70: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
+00002d80: 2e5f 5f67 6574 6974 656d 5f5f 286f 7468  .__getitem__(oth
+00002d90: 6572 2e65 7870 7229 290a 2020 2020 2020  er.expr)).      
+00002da0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00002db0: 6528 6f74 6865 722c 2073 6c69 6365 293a  e(other, slice):
+00002dc0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+00002dd0: 6d20 7061 6e64 6173 2e61 7069 2e74 7970  m pandas.api.typ
+00002de0: 6573 2069 6d70 6f72 7420 6973 5f66 6c6f  es import is_flo
+00002df0: 6174 5f64 7479 7065 0a0a 2020 2020 2020  at_dtype..      
+00002e00: 2020 2020 2020 6973 5f69 6e74 6567 6572        is_integer
+00002e10: 5f73 6c69 6365 203d 2061 6e79 280a 2020  _slice = any(.  
+00002e20: 2020 2020 2020 2020 2020 2020 2020 6973                is
+00002e30: 696e 7374 616e 6365 2869 2c20 496e 7465  instance(i, Inte
+00002e40: 6772 616c 2920 666f 7220 6920 696e 2028  gral) for i in (
+00002e50: 6f74 6865 722e 7374 6172 742c 206f 7468  other.start, oth
+00002e60: 6572 2e73 7465 702c 206f 7468 6572 2e73  er.step, other.s
+00002e70: 746f 7029 0a20 2020 2020 2020 2020 2020  top).           
+00002e80: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
+00002e90: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00002ea0: 2020 2020 7365 6c66 2e6e 6469 6d20 3d3d      self.ndim ==
+00002eb0: 2032 0a20 2020 2020 2020 2020 2020 2020   2.             
+00002ec0: 2020 2061 6e64 2069 735f 696e 7465 6765     and is_intege
+00002ed0: 725f 736c 6963 650a 2020 2020 2020 2020  r_slice.        
+00002ee0: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
+00002ef0: 6973 5f66 6c6f 6174 5f64 7479 7065 2873  is_float_dtype(s
+00002f00: 656c 662e 696e 6465 782e 6474 7970 6529  elf.index.dtype)
+00002f10: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
+00002f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002f30: 7265 7475 726e 2073 656c 662e 696c 6f63  return self.iloc
+00002f40: 5b6f 7468 6572 5d0a 2020 2020 2020 2020  [other].        
+00002f50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00002f60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002f70: 2073 656c 662e 6c6f 635b 6f74 6865 725d   self.loc[other]
+00002f80: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00002f90: 7374 616e 6365 286f 7468 6572 2c20 6e70  stance(other, np
+00002fa0: 2e6e 6461 7272 6179 2920 6f72 2069 735f  .ndarray) or is_
+00002fb0: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
+00002fc0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00002fd0: 6f74 6865 7220 3d20 6c69 7374 286f 7468  other = list(oth
+00002fe0: 6572 290a 2020 2020 2020 2020 656c 6966  er).        elif
+00002ff0: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+00003000: 722c 206c 6973 7429 3a0a 2020 2020 2020  r, list):.      
+00003010: 2020 2020 2020 6f74 6865 7220 3d20 6f74        other = ot
+00003020: 6865 722e 636f 7079 2829 0a20 2020 2020  her.copy().     
+00003030: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00003040: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
+00003050: 7072 2e5f 5f67 6574 6974 656d 5f5f 286f  pr.__getitem__(o
+00003060: 7468 6572 2929 0a0a 2020 2020 6465 6620  ther))..    def 
+00003070: 5f5f 6461 736b 5f74 6f6b 656e 697a 655f  __dask_tokenize_
+00003080: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00003090: 2072 6574 7572 6e20 7479 7065 2873 656c   return type(sel
+000030a0: 6629 2e5f 5f6e 616d 655f 5f2c 2073 656c  f).__name__, sel
+000030b0: 662e 5f65 7870 722e 5f6e 616d 650a 0a20  f._expr._name.. 
+000030c0: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
+000030d0: 7365 6c66 293a 0a20 2020 2020 2020 2064  self):.        d
+000030e0: 6174 6120 3d20 7365 6c66 2e5f 7265 7072  ata = self._repr
+000030f0: 5f64 6174 6128 292e 746f 5f73 7472 696e  _data().to_strin
+00003100: 6728 6d61 785f 726f 7773 3d35 290a 2020  g(max_rows=5).  
+00003110: 2020 2020 2020 5f73 7472 5f66 6d74 203d        _str_fmt =
+00003120: 2022 2222 4461 736b 207b 6b6c 6173 737d   """Dask {klass}
+00003130: 2053 7472 7563 7475 7265 3a0a 7b64 6174   Structure:.{dat
+00003140: 617d 0a44 6173 6b20 4e61 6d65 3a20 7b6e  a}.Dask Name: {n
+00003150: 616d 657d 2c20 7b6e 5f65 7870 727d 0a45  ame}, {n_expr}.E
+00003160: 7870 723d 7b65 7870 727d 2222 220a 2020  xpr={expr}""".  
+00003170: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00003180: 6e73 7461 6e63 6528 7365 6c66 2c20 5365  nstance(self, Se
+00003190: 7269 6573 2920 616e 6420 6e6f 7420 6c65  ries) and not le
+000031a0: 6e28 7365 6c66 2e63 6f6c 756d 6e73 293a  n(self.columns):
+000031b0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+000031c0: 6120 3d20 6461 7461 2e70 6172 7469 7469  a = data.partiti
+000031d0: 6f6e 2822 5c6e 2229 5b2d 315d 2e72 6570  on("\n")[-1].rep
+000031e0: 6c61 6365 2822 496e 6465 7822 2c20 2244  lace("Index", "D
+000031f0: 6976 6973 696f 6e73 2229 0a20 2020 2020  ivisions").     
+00003200: 2020 2020 2020 205f 7374 725f 666d 7420         _str_fmt 
+00003210: 3d20 6622 456d 7074 7920 7b5f 7374 725f  = f"Empty {_str_
+00003220: 666d 747d 220a 2020 2020 2020 2020 6e5f  fmt}".        n_
+00003230: 6578 7072 203d 206c 656e 287b 652e 5f6e  expr = len({e._n
+00003240: 616d 6520 666f 7220 6520 696e 2073 656c  ame for e in sel
+00003250: 662e 6578 7072 2e77 616c 6b28 297d 290a  f.expr.walk()}).
+00003260: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003270: 5f73 7472 5f66 6d74 2e66 6f72 6d61 7428  _str_fmt.format(
+00003280: 0a20 2020 2020 2020 2020 2020 206b 6c61  .            kla
+00003290: 7373 3d73 656c 662e 5f5f 636c 6173 735f  ss=self.__class_
+000032a0: 5f2e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  _.__name__,.    
+000032b0: 2020 2020 2020 2020 6461 7461 3d64 6174          data=dat
+000032c0: 612c 0a20 2020 2020 2020 2020 2020 206e  a,.            n
+000032d0: 616d 653d 6b65 795f 7370 6c69 7428 7365  ame=key_split(se
+000032e0: 6c66 2e5f 6e61 6d65 292c 0a20 2020 2020  lf._name),.     
+000032f0: 2020 2020 2020 206e 5f65 7870 723d 6d61         n_expr=ma
+00003300: 7962 655f 706c 7572 616c 697a 6528 6e5f  ybe_pluralize(n_
+00003310: 6578 7072 2c20 2265 7870 7265 7373 696f  expr, "expressio
+00003320: 6e22 292c 0a20 2020 2020 2020 2020 2020  n"),.           
+00003330: 2065 7870 723d 7365 6c66 2e65 7870 722c   expr=self.expr,
+00003340: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00003350: 6465 6620 5f5f 626f 6f6c 5f5f 2873 656c  def __bool__(sel
+00003360: 6629 3a0a 2020 2020 2020 2020 7261 6973  f):.        rais
+00003370: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00003380: 2020 2020 2020 2020 2020 6622 5468 6520            f"The 
+00003390: 7472 7574 6820 7661 6c75 6520 6f66 2061  truth value of a
+000033a0: 207b 7365 6c66 2e5f 5f63 6c61 7373 5f5f   {self.__class__
+000033b0: 2e5f 5f6e 616d 655f 5f7d 2069 7320 616d  .__name__} is am
+000033c0: 6269 6775 6f75 732e 2022 0a20 2020 2020  biguous. ".     
+000033d0: 2020 2020 2020 2022 5573 6520 612e 616e         "Use a.an
+000033e0: 7928 2920 6f72 2061 2e61 6c6c 2829 2e22  y() or a.all()."
+000033f0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00003400: 6465 6620 5f5f 6172 7261 795f 5f28 7365  def __array__(se
+00003410: 6c66 2c20 6474 7970 653d 4e6f 6e65 2c20  lf, dtype=None, 
+00003420: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00003430: 2020 2072 6574 7572 6e20 6e70 2e61 7272     return np.arr
+00003440: 6179 2873 656c 662e 636f 6d70 7574 6528  ay(self.compute(
+00003450: 2929 0a0a 2020 2020 6465 6620 7065 7273  ))..    def pers
+00003460: 6973 7428 7365 6c66 2c20 6675 7365 3d54  ist(self, fuse=T
+00003470: 7275 652c 202a 2a6b 7761 7267 7329 3a0a  rue, **kwargs):.
+00003480: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
+00003490: 6c66 2e6f 7074 696d 697a 6528 6675 7365  lf.optimize(fuse
+000034a0: 3d66 7573 6529 0a20 2020 2020 2020 2072  =fuse).        r
+000034b0: 6574 7572 6e20 4461 736b 4d65 7468 6f64  eturn DaskMethod
+000034c0: 734d 6978 696e 2e70 6572 7369 7374 286f  sMixin.persist(o
+000034d0: 7574 2c20 2a2a 6b77 6172 6773 290a 0a20  ut, **kwargs).. 
+000034e0: 2020 2064 6566 2063 6f6d 7075 7465 2873     def compute(s
+000034f0: 656c 662c 2066 7573 653d 5472 7565 2c20  elf, fuse=True, 
+00003500: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00003510: 2020 2022 2222 436f 6d70 7574 6520 7468     """Compute th
+00003520: 6973 2044 6174 6146 7261 6d65 2e0a 0a20  is DataFrame... 
+00003530: 2020 2020 2020 2054 6869 7320 7475 726e         This turn
+00003540: 7320 6120 6c61 7a79 2044 6173 6b20 4461  s a lazy Dask Da
+00003550: 7461 4672 616d 6520 696e 746f 2061 6e20  taFrame into an 
+00003560: 696e 2d6d 656d 6f72 7920 7061 6e64 6173  in-memory pandas
+00003570: 2044 6174 6146 7261 6d65 2e0a 2020 2020   DataFrame..    
+00003580: 2020 2020 5468 6520 656e 7469 7265 2064      The entire d
+00003590: 6174 6173 6574 206d 7573 7420 6669 7420  ataset must fit 
+000035a0: 696e 746f 206d 656d 6f72 7920 6265 666f  into memory befo
+000035b0: 7265 2063 616c 6c69 6e67 2074 6869 7320  re calling this 
+000035c0: 6f70 6572 6174 696f 6e2e 0a0a 2020 2020  operation...    
+000035d0: 2020 2020 5468 6520 6f70 7469 6d69 7a65      The optimize
+000035e0: 7220 7275 6e73 206f 7665 7220 7468 6520  r runs over the 
+000035f0: 4461 7461 4672 616d 6520 6265 666f 7265  DataFrame before
+00003600: 2074 7269 6767 6572 696e 6720 7468 6520   triggering the 
+00003610: 636f 6d70 7574 6174 696f 6e2e 0a20 2020  computation..   
+00003620: 2020 2020 2054 6865 206f 7074 696d 697a       The optimiz
+00003630: 6572 2069 6e6a 6563 7473 2061 2072 6570  er injects a rep
+00003640: 6172 7469 7469 6f6e 206f 7065 7261 7469  artition operati
+00003650: 6f6e 2074 6861 7420 7265 6475 6365 7320  on that reduces 
+00003660: 7468 6520 7061 7274 6974 696f 6e0a 2020  the partition.  
+00003670: 2020 2020 2020 636f 756e 7420 746f 2031        count to 1
+00003680: 2074 6f20 656e 6162 6c65 2062 6574 7465   to enable bette
+00003690: 7220 6f70 7469 6d69 7a61 7469 6f6e 2073  r optimization s
+000036a0: 7472 6174 6567 6965 732e 0a0a 2020 2020  trategies...    
+000036b0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000036c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000036d0: 2d0a 2020 2020 2020 2020 6675 7365 203a  -.        fuse :
+000036e0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
+000036f0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00003700: 5768 6574 6865 7220 746f 2066 7573 6520  Whether to fuse 
+00003710: 7468 6520 6578 7072 6573 7369 6f6e 2074  the expression t
+00003720: 7265 6520 6265 666f 7265 2063 6f6d 7075  ree before compu
+00003730: 7469 6e67 2e20 4675 7369 6e67 2073 6967  ting. Fusing sig
+00003740: 6e69 6669 6361 6e74 6c79 0a20 2020 2020  nificantly.     
+00003750: 2020 2020 2020 2072 6564 7563 6573 2074         reduces t
+00003760: 6865 206e 756d 6265 7220 6f66 2074 6173  he number of tas
+00003770: 6b73 2061 6e64 2069 6d70 726f 7665 7320  ks and improves 
+00003780: 7065 7266 6f72 6d61 6e63 652e 2049 7420  performance. It 
+00003790: 7368 6f75 6c64 6e27 7420 6265 0a20 2020  shouldn't be.   
+000037a0: 2020 2020 2020 2020 2064 6973 6162 6c65           disable
+000037b0: 6420 756e 6c65 7373 2061 6273 6f6c 7574  d unless absolut
+000037c0: 656c 7920 6e65 6365 7373 6172 792e 0a20  ely necessary.. 
+000037d0: 2020 2020 2020 206b 7761 7267 730a 2020         kwargs.  
+000037e0: 2020 2020 2020 2020 2020 4578 7472 6120            Extra 
+000037f0: 6b65 7977 6f72 6473 2074 6f20 666f 7277  keywords to forw
+00003800: 6172 6420 746f 2074 6865 2062 6173 6520  ard to the base 
+00003810: 636f 6d70 7574 6520 6675 6e63 7469 6f6e  compute function
+00003820: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+00003830: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00003840: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+00003850: 6b2e 636f 6d70 7574 650a 2020 2020 2020  k.compute.      
+00003860: 2020 2222 220a 2020 2020 2020 2020 6f75    """.        ou
+00003870: 7420 3d20 7365 6c66 0a20 2020 2020 2020  t = self.       
+00003880: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00003890: 6365 286f 7574 2c20 5363 616c 6172 293a  ce(out, Scalar):
+000038a0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+000038b0: 203d 206f 7574 2e72 6570 6172 7469 7469   = out.repartiti
+000038c0: 6f6e 286e 7061 7274 6974 696f 6e73 3d31  on(npartitions=1
+000038d0: 290a 2020 2020 2020 2020 6f75 7420 3d20  ).        out = 
+000038e0: 6f75 742e 6f70 7469 6d69 7a65 2866 7573  out.optimize(fus
+000038f0: 653d 6675 7365 290a 2020 2020 2020 2020  e=fuse).        
+00003900: 7265 7475 726e 2044 6173 6b4d 6574 686f  return DaskMetho
+00003910: 6473 4d69 7869 6e2e 636f 6d70 7574 6528  dsMixin.compute(
+00003920: 6f75 742c 202a 2a6b 7761 7267 7329 0a0a  out, **kwargs)..
+00003930: 2020 2020 6465 6620 616e 616c 797a 6528      def analyze(
+00003940: 7365 6c66 2c20 6669 6c65 6e61 6d65 3a20  self, filename: 
+00003950: 7374 7220 7c20 4e6f 6e65 203d 204e 6f6e  str | None = Non
+00003960: 652c 2066 6f72 6d61 743a 2073 7472 207c  e, format: str |
+00003970: 204e 6f6e 6520 3d20 4e6f 6e65 2920 2d3e   None = None) ->
+00003980: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00003990: 2222 4f75 7470 7574 7320 7374 6174 6973  ""Outputs statis
+000039a0: 7469 6373 2061 626f 7574 2065 7665 7279  tics about every
+000039b0: 206e 6f64 6520 696e 2074 6865 2065 7870   node in the exp
+000039c0: 7265 7373 696f 6e2e 0a0a 2020 2020 2020  ression...      
+000039d0: 2020 616e 616c 797a 6520 6f70 7469 6d69    analyze optimi
+000039e0: 7a65 7320 7468 6520 6578 7072 6573 7369  zes the expressi
+000039f0: 6f6e 2061 6e64 2074 7269 6767 6572 7320  on and triggers 
+00003a00: 6120 636f 6d70 7574 6174 696f 6e2e 2049  a computation. I
+00003a10: 7420 7265 636f 7264 7320 7374 6174 6973  t records statis
+00003a20: 7469 6373 0a20 2020 2020 2020 206c 696b  tics.        lik
+00003a30: 6520 6d65 6d6f 7279 2075 7361 6765 2070  e memory usage p
+00003a40: 6572 2070 6172 7469 7469 6f6e 2074 6f20  er partition to 
+00003a50: 616e 616c 797a 6520 686f 7720 6461 7461  analyze how data
+00003a60: 2066 6c6f 7720 7468 726f 7567 6820 7468   flow through th
+00003a70: 6520 6772 6170 682e 0a0a 2020 2020 2020  e graph...      
+00003a80: 2020 2e2e 2077 6172 6e69 6e67 3a3a 0a20    .. warning::. 
+00003a90: 2020 2020 2020 2020 2020 2061 6e61 6c79             analy
+00003aa0: 7a65 2061 6464 7320 706c 7567 696e 7320  ze adds plugins 
+00003ab0: 746f 2074 6865 2073 6368 6564 756c 6572  to the scheduler
+00003ac0: 2061 6e64 2074 6865 2077 6f72 6b65 7273   and the workers
+00003ad0: 2074 6861 7420 6861 7665 2061 206e 6f6e   that have a non
+00003ae0: 2d74 7269 7669 616c 0a20 2020 2020 2020  -trivial.       
+00003af0: 2020 2020 2063 6f73 742e 2054 6869 7320       cost. This 
+00003b00: 6d65 7468 6f64 2073 686f 756c 6420 6e6f  method should no
+00003b10: 7420 6265 2075 7365 6420 696e 2070 726f  t be used in pro
+00003b20: 6475 6374 696f 6e20 776f 726b 666c 6f77  duction workflow
+00003b30: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+00003b40: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00003b50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00003b60: 2020 6669 6c65 6e61 6d65 3a20 7374 722c    filename: str,
+00003b70: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00003b80: 2020 4669 6c65 2074 6f20 7374 6f72 6520    File to store 
+00003b90: 7468 6520 6772 6170 6820 7265 7072 6573  the graph repres
+00003ba0: 656e 7461 7469 6f6e 2e0a 2020 2020 2020  entation..      
+00003bb0: 2020 666f 726d 6174 3a20 7374 722c 2064    format: str, d
+00003bc0: 6566 6175 6c74 2069 7320 706e 670a 2020  efault is png.  
+00003bd0: 2020 2020 2020 2020 2020 4669 6c65 2066            File f
+00003be0: 6f72 6d61 7420 666f 7220 7468 6520 6772  ormat for the gr
+00003bf0: 6170 6820 7265 7072 6573 656e 7461 7469  aph representati
+00003c00: 6f6e 2e0a 0a20 2020 2020 2020 2052 6574  on...        Ret
+00003c10: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00003c20: 2d2d 2d2d 0a20 2020 2020 2020 2020 2020  ----.           
+00003c30: 204e 6f6e 652c 2062 7574 2077 7269 7465   None, but write
+00003c40: 7320 6120 6772 6170 6820 7265 7072 6573  s a graph repres
+00003c50: 656e 7461 7469 6f6e 206f 6620 7468 6520  entation of the 
+00003c60: 6578 7072 6573 7369 6f6e 2065 6e72 6963  expression enric
+00003c70: 6865 6420 7769 7468 0a20 2020 2020 2020  hed with.       
+00003c80: 2020 2020 2073 7461 7469 7374 6963 7320       statistics 
+00003c90: 746f 2064 6973 6b2e 0a20 2020 2020 2020  to disk..       
+00003ca0: 2022 2222 0a20 2020 2020 2020 206f 7574   """.        out
+00003cb0: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
+00003cc0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00003cd0: 6528 6f75 742c 2053 6361 6c61 7229 3a0a  e(out, Scalar):.
+00003ce0: 2020 2020 2020 2020 2020 2020 6f75 7420              out 
+00003cf0: 3d20 6f75 742e 7265 7061 7274 6974 696f  = out.repartitio
+00003d00: 6e28 6e70 6172 7469 7469 6f6e 733d 3129  n(npartitions=1)
+00003d10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003d20: 6f75 742e 6578 7072 2e61 6e61 6c79 7a65  out.expr.analyze
+00003d30: 2866 696c 656e 616d 653d 6669 6c65 6e61  (filename=filena
+00003d40: 6d65 2c20 666f 726d 6174 3d66 6f72 6d61  me, format=forma
+00003d50: 7429 0a0a 2020 2020 6465 6620 6578 706c  t)..    def expl
+00003d60: 6169 6e28 7365 6c66 2c20 7374 6167 653a  ain(self, stage:
+00003d70: 204f 7074 696d 697a 6572 5374 6167 6520   OptimizerStage 
+00003d80: 3d20 2266 7573 6564 222c 2066 6f72 6d61  = "fused", forma
+00003d90: 743a 2073 7472 207c 204e 6f6e 6520 3d20  t: str | None = 
+00003da0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00003db0: 2222 4372 6561 7465 2061 2067 7261 7068  ""Create a graph
+00003dc0: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
+00003dd0: 6f66 2074 6865 2045 7870 7265 7373 696f  of the Expressio
+00003de0: 6e2e 0a0a 2020 2020 2020 2020 6578 706c  n...        expl
+00003df0: 6169 6e20 7275 6e73 2074 6865 206f 7074  ain runs the opt
+00003e00: 696d 697a 6572 2061 6e64 2063 7265 6174  imizer and creat
+00003e10: 6573 2061 2067 7261 7068 206f 6620 7468  es a graph of th
+00003e20: 6520 6f70 7469 6d69 7a65 6420 6578 7072  e optimized expr
+00003e30: 6573 7369 6f6e 0a20 2020 2020 2020 2077  ession.        w
+00003e40: 6974 6820 6772 6170 6876 697a 2e20 4e6f  ith graphviz. No
+00003e50: 2063 6f6d 7075 7461 7469 6f6e 2069 7320   computation is 
+00003e60: 7472 6967 6765 7265 642e 0a0a 2020 2020  triggered...    
+00003e70: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00003e80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00003e90: 2d0a 2020 2020 2020 2020 7374 6167 653a  -.        stage:
+00003ea0: 207b 226c 6f67 6963 616c 222c 2022 7369   {"logical", "si
+00003eb0: 6d70 6c69 6669 6564 2d6c 6f67 6963 616c  mplified-logical
+00003ec0: 222c 2022 7475 6e65 642d 6c6f 6769 6361  ", "tuned-logica
+00003ed0: 6c22 2c20 2270 6879 7369 6361 6c22 2c20  l", "physical", 
+00003ee0: 2273 696d 706c 6966 6965 642d 7068 7973  "simplified-phys
+00003ef0: 6963 616c 222c 2022 6675 7365 6422 7d0a  ical", "fused"}.
+00003f00: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00003f10: 6f70 7469 6d69 7a65 7220 7374 6167 6520  optimizer stage 
+00003f20: 7468 6174 2069 7320 7265 7475 726e 6564  that is returned
+00003f30: 2e20 4465 6661 756c 7420 6973 2022 6675  . Default is "fu
+00003f40: 7365 6422 2e0a 0a20 2020 2020 2020 2020  sed"...         
+00003f50: 2020 202d 206c 6f67 6963 616c 3a20 6f75     - logical: ou
+00003f60: 7470 7574 7320 7468 6520 6578 7072 6573  tputs the expres
+00003f70: 7369 6f6e 2061 7320 6973 0a20 2020 2020  sion as is.     
+00003f80: 2020 2020 2020 202d 2073 696d 706c 6966         - simplif
+00003f90: 6965 642d 6c6f 6769 6361 6c3a 2073 696d  ied-logical: sim
+00003fa0: 706c 6966 6965 7320 7468 6520 6578 7072  plifies the expr
+00003fb0: 6573 7369 6f6e 2077 6869 6368 2069 6e63  ession which inc
+00003fc0: 6c75 6465 7320 7072 6564 6963 6174 650a  ludes predicate.
+00003fd0: 2020 2020 2020 2020 2020 2020 2020 7075                pu
+00003fe0: 7368 646f 776e 2061 6e64 2063 6f6c 756d  shdown and colum
+00003ff0: 6e20 7072 6f6a 6563 7469 6f6e 2e0a 2020  n projection..  
+00004000: 2020 2020 2020 2020 2020 2d20 7475 6e65            - tune
+00004010: 642d 6c6f 6769 6361 6c3a 2061 7070 6c69  d-logical: appli
+00004020: 6573 2061 6464 6974 696f 6e61 6c20 6f70  es additional op
+00004030: 7469 6d69 7a61 7469 6f6e 7320 6c69 6b65  timizations like
+00004040: 2070 6172 7469 7469 6f6e 2073 7175 6173   partition squas
+00004050: 6869 6e67 0a20 2020 2020 2020 2020 2020  hing.           
+00004060: 202d 2070 6879 7369 6361 6c3a 206f 7574   - physical: out
+00004070: 7075 7473 2074 6865 2070 6879 7369 6361  puts the physica
+00004080: 6c20 6578 7072 6573 7369 6f6e 3b20 7468  l expression; th
+00004090: 6973 2065 7870 7265 7373 696f 6e20 6361  is expression ca
+000040a0: 6e20 6163 7475 616c 6c79 0a20 2020 2020  n actually.     
+000040b0: 2020 2020 2020 2020 2062 6520 636f 6d70           be comp
+000040c0: 7574 6564 0a20 2020 2020 2020 2020 2020  uted.           
+000040d0: 202d 2073 696d 706c 6966 6965 642d 7068   - simplified-ph
+000040e0: 7973 6963 616c 3a20 7275 6e73 2061 6e6f  ysical: runs ano
+000040f0: 7468 6572 2073 696d 706c 6966 6963 6174  ther simplificat
+00004100: 696f 6e20 6166 7465 7220 7468 6520 7068  ion after the ph
+00004110: 7973 6963 616c 0a20 2020 2020 2020 2020  ysical.         
+00004120: 2020 2020 2070 6c61 6e20 6973 2067 656e       plan is gen
+00004130: 6572 6174 6564 0a20 2020 2020 2020 2020  erated.         
+00004140: 2020 202d 2066 7573 6564 3a20 6675 7365     - fused: fuse
+00004150: 7320 7468 6520 7068 7973 6963 616c 2065  s the physical e
+00004160: 7870 7265 7373 696f 6e20 746f 2072 6564  xpression to red
+00004170: 7563 6520 7468 6520 6e6f 6465 7320 696e  uce the nodes in
+00004180: 2074 6872 2067 7261 7068 2e0a 0a20 2020   thr graph...   
+00004190: 2020 2020 2020 2020 202e 2e20 7761 726e           .. warn
+000041a0: 696e 673a 3a0a 2020 2020 2020 2020 2020  ing::.          
+000041b0: 2020 2020 2020 5468 6520 6f70 7469 6d69        The optimi
+000041c0: 7a65 7220 7374 6167 6573 2061 7265 2073  zer stages are s
+000041d0: 7562 6a65 6374 2074 6f20 6368 616e 6765  ubject to change
+000041e0: 2e0a 2020 2020 2020 2020 666f 726d 6174  ..        format
+000041f0: 3a20 7374 722c 2064 6566 6175 6c74 204e  : str, default N
+00004200: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00004210: 5468 6520 666f 726d 6174 206f 6620 7468  The format of th
+00004220: 6520 6f75 7470 7574 2e20 4465 6661 756c  e output. Defaul
+00004230: 7420 6973 2022 706e 6722 2e0a 0a20 2020  t is "png"...   
+00004240: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00004250: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00004260: 2020 2020 2020 2020 204e 6f6e 652c 2062           None, b
+00004270: 7574 206f 7065 6e73 2061 206e 6577 2077  ut opens a new w
+00004280: 696e 646f 7720 7769 7468 2074 6865 2067  indow with the g
+00004290: 7261 7068 2076 6973 7561 6c69 7a61 7469  raph visualizati
+000042a0: 6f6e 2061 6e64 206f 7574 7075 7473 0a20  on and outputs. 
+000042b0: 2020 2020 2020 2020 2020 2061 2066 696c             a fil
+000042c0: 6520 7769 7468 2074 6865 2067 7261 7068  e with the graph
+000042d0: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
+000042e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000042f0: 2020 2020 206f 7574 203d 2073 656c 660a       out = self.
+00004300: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00004310: 7369 6e73 7461 6e63 6528 6f75 742c 2053  sinstance(out, S
+00004320: 6361 6c61 7229 3a0a 2020 2020 2020 2020  calar):.        
+00004330: 2020 2020 6f75 7420 3d20 6f75 742e 7265      out = out.re
+00004340: 7061 7274 6974 696f 6e28 6e70 6172 7469  partition(nparti
+00004350: 7469 6f6e 733d 3129 0a20 2020 2020 2020  tions=1).       
+00004360: 2072 6574 7572 6e20 6f75 742e 6578 7072   return out.expr
+00004370: 2e65 7870 6c61 696e 2873 7461 6765 2c20  .explain(stage, 
+00004380: 666f 726d 6174 290a 0a20 2020 2064 6566  format)..    def
+00004390: 2070 7072 696e 7428 7365 6c66 293a 0a20   pprint(self):. 
+000043a0: 2020 2020 2020 2022 2222 4f75 7470 7574         """Output
+000043b0: 7320 6120 7374 7269 6e67 2072 6570 7265  s a string repre
+000043c0: 7365 6e74 6174 696f 6e20 6f66 2074 6865  sentation of the
+000043d0: 2044 6174 6146 7261 6d65 2e0a 0a20 2020   DataFrame...   
+000043e0: 2020 2020 2054 6865 2065 7870 7265 7373       The express
+000043f0: 696f 6e20 6973 2072 6574 7572 6e65 6420  ion is returned 
+00004400: 6173 2069 732e 2050 6c65 6173 6520 7275  as is. Please ru
+00004410: 6e20 6f70 7469 6d69 7a65 206d 616e 7561  n optimize manua
+00004420: 6c6c 7920 6966 206e 6563 6573 7361 7279  lly if necessary
+00004430: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00004440: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+00004450: 2d2d 0a20 2020 2020 2020 2020 2020 204e  --.            N
+00004460: 6f6e 652c 2074 6865 2072 6570 7265 7365  one, the represe
+00004470: 6e74 6174 696f 6e20 6973 2070 7574 2069  ntation is put i
+00004480: 6e74 6f20 7374 646f 7574 2e0a 2020 2020  nto stdout..    
+00004490: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000044a0: 7265 7475 726e 2073 656c 662e 6578 7072  return self.expr
+000044b0: 2e70 7072 696e 7428 290a 0a20 2020 2040  .pprint()..    @
+000044c0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+000044d0: 2064 6173 6b28 7365 6c66 293a 0a20 2020   dask(self):.   
+000044e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000044f0: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
+00004500: 290a 0a20 2020 2064 6566 205f 5f64 6173  )..    def __das
+00004510: 6b5f 6772 6170 685f 5f28 7365 6c66 293a  k_graph__(self):
+00004520: 0a20 2020 2020 2020 206f 7574 203d 2073  .        out = s
+00004530: 656c 662e 6578 7072 0a20 2020 2020 2020  elf.expr.       
+00004540: 206f 7574 203d 206f 7574 2e6c 6f77 6572   out = out.lower
+00004550: 5f63 6f6d 706c 6574 656c 7928 290a 2020  _completely().  
+00004560: 2020 2020 2020 7265 7475 726e 206f 7574        return out
+00004570: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
+00004580: 290a 0a20 2020 2064 6566 205f 5f64 6173  )..    def __das
+00004590: 6b5f 6b65 7973 5f5f 2873 656c 6629 3a0a  k_keys__(self):.
+000045a0: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
+000045b0: 6c66 2e65 7870 720a 2020 2020 2020 2020  lf.expr.        
+000045c0: 6f75 7420 3d20 6f75 742e 6c6f 7765 725f  out = out.lower_
+000045d0: 636f 6d70 6c65 7465 6c79 2829 0a20 2020  completely().   
+000045e0: 2020 2020 2072 6574 7572 6e20 6f75 742e       return out.
+000045f0: 5f5f 6461 736b 5f6b 6579 735f 5f28 290a  __dask_keys__().
+00004600: 0a20 2020 2064 6566 2073 696d 706c 6966  .    def simplif
+00004610: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+00004620: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00004630: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
+00004640: 2e73 696d 706c 6966 7928 2929 0a0a 2020  .simplify())..  
+00004650: 2020 6465 6620 6c6f 7765 725f 6f6e 6365    def lower_once
+00004660: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00004670: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00004680: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+00004690: 6c6f 7765 725f 6f6e 6365 2829 290a 0a20  lower_once()).. 
+000046a0: 2020 2064 6566 206f 7074 696d 697a 6528     def optimize(
+000046b0: 7365 6c66 2c20 6675 7365 3a20 626f 6f6c  self, fuse: bool
+000046c0: 203d 2054 7275 6529 3a0a 2020 2020 2020   = True):.      
+000046d0: 2020 2222 224f 7074 696d 697a 6573 2074    """Optimizes t
+000046e0: 6865 2044 6174 6146 7261 6d65 2e0a 0a20  he DataFrame... 
+000046f0: 2020 2020 2020 2052 756e 7320 7468 6520         Runs the 
+00004700: 6f70 7469 6d69 7a65 7220 7769 7468 2061  optimizer with a
+00004710: 6c6c 2073 7465 7073 206f 7665 7220 7468  ll steps over th
+00004720: 6520 4461 7461 4672 616d 6520 616e 6420  e DataFrame and 
+00004730: 7772 6170 7320 7468 6520 7265 7375 6c74  wraps the result
+00004740: 2069 6e20 610a 2020 2020 2020 2020 6e65   in a.        ne
+00004750: 7720 4461 7461 4672 616d 6520 636f 6c6c  w DataFrame coll
+00004760: 6563 7469 6f6e 2e20 4f6e 6c79 2075 7365  ection. Only use
+00004770: 2074 6869 7320 6d65 7468 6f64 2069 6620   this method if 
+00004780: 796f 7520 7761 6e74 2074 6f20 616e 616c  you want to anal
+00004790: 797a 6520 7468 650a 2020 2020 2020 2020  yze the.        
+000047a0: 6f70 7469 6d69 7a65 6420 6578 7072 6573  optimized expres
+000047b0: 7369 6f6e 2e0a 0a20 2020 2020 2020 2050  sion...        P
+000047c0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+000047d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000047e0: 2020 2020 2066 7573 653a 2062 6f6f 6c2c       fuse: bool,
+000047f0: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00004800: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00004810: 7220 746f 2066 7573 6520 7468 6520 6578  r to fuse the ex
+00004820: 7072 6573 7369 6f6e 2074 7265 6520 6166  pression tree af
+00004830: 7465 7220 7275 6e6e 696e 6720 7468 6520  ter running the 
+00004840: 6f70 7469 6d69 7a65 722e 0a20 2020 2020  optimizer..     
+00004850: 2020 2020 2020 2049 7420 6973 206f 6674         It is oft
+00004860: 656e 2065 6173 6965 7220 746f 206c 6f6f  en easier to loo
+00004870: 6b20 6174 2074 6865 206e 6f6e 2d66 7573  k at the non-fus
+00004880: 6564 2065 7870 7265 7373 696f 6e20 7768  ed expression wh
+00004890: 656e 2061 6e61 6c79 7a69 6e67 0a20 2020  en analyzing.   
+000048a0: 2020 2020 2020 2020 2074 6865 2072 6573           the res
+000048b0: 756c 742e 0a0a 2020 2020 2020 2020 5265  ult...        Re
+000048c0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+000048d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2020  -----.          
+000048e0: 2020 5468 6520 6f70 7469 6d69 7a65 6420    The optimized 
+000048f0: 4461 736b 2044 6174 6166 7261 6d65 0a20  Dask Dataframe. 
+00004900: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00004910: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00004920: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
+00004930: 7072 2e6f 7074 696d 697a 6528 6675 7365  pr.optimize(fuse
+00004940: 3d66 7573 6529 290a 0a20 2020 2040 7072  =fuse))..    @pr
+00004950: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
+00004960: 6173 6b28 7365 6c66 293a 0a20 2020 2020  ask(self):.     
+00004970: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00004980: 5f64 6173 6b5f 6772 6170 685f 5f28 290a  _dask_graph__().
+00004990: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
+000049a0: 706f 7374 636f 6d70 7574 655f 5f28 7365  postcompute__(se
+000049b0: 6c66 293a 0a20 2020 2020 2020 2073 7461  lf):.        sta
+000049c0: 7465 203d 206e 6577 5f63 6f6c 6c65 6374  te = new_collect
+000049d0: 696f 6e28 7365 6c66 2e65 7870 722e 6c6f  ion(self.expr.lo
+000049e0: 7765 725f 636f 6d70 6c65 7465 6c79 2829  wer_completely()
+000049f0: 290a 2020 2020 2020 2020 6966 2074 7970  ).        if typ
+00004a00: 6528 7365 6c66 2920 213d 2074 7970 6528  e(self) != type(
+00004a10: 7374 6174 6529 3a0a 2020 2020 2020 2020  state):.        
+00004a20: 2020 2020 7265 7475 726e 2073 7461 7465      return state
+00004a30: 2e5f 5f64 6173 6b5f 706f 7374 636f 6d70  .__dask_postcomp
+00004a40: 7574 655f 5f28 290a 2020 2020 2020 2020  ute__().        
+00004a50: 7265 7475 726e 205f 636f 6e63 6174 2c20  return _concat, 
+00004a60: 2829 0a0a 2020 2020 6465 6620 5f5f 6461  ()..    def __da
+00004a70: 736b 5f70 6f73 7470 6572 7369 7374 5f5f  sk_postpersist__
+00004a80: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00004a90: 7374 6174 6520 3d20 6e65 775f 636f 6c6c  state = new_coll
+00004aa0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
+00004ab0: 2e6c 6f77 6572 5f63 6f6d 706c 6574 656c  .lower_completel
+00004ac0: 7928 2929 0a20 2020 2020 2020 2072 6574  y()).        ret
+00004ad0: 7572 6e20 6672 6f6d 5f67 7261 7068 2c20  urn from_graph, 
+00004ae0: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+00004af0: 6174 652e 5f6d 6574 612c 0a20 2020 2020  ate._meta,.     
+00004b00: 2020 2020 2020 2073 7461 7465 2e64 6976         state.div
+00004b10: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
+00004b20: 2020 2020 7374 6174 652e 5f5f 6461 736b      state.__dask
+00004b30: 5f6b 6579 735f 5f28 292c 0a20 2020 2020  _keys__(),.     
+00004b40: 2020 2020 2020 206b 6579 5f73 706c 6974         key_split
+00004b50: 2873 7461 7465 2e5f 6e61 6d65 292c 0a20  (state._name),. 
+00004b60: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00004b70: 6620 5f5f 6765 7461 7474 725f 5f28 7365  f __getattr__(se
+00004b80: 6c66 2c20 6b65 7929 3a0a 2020 2020 2020  lf, key):.      
+00004b90: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00004ba0: 2020 2023 2050 7269 6f72 6974 697a 6520     # Prioritize 
+00004bb0: 6046 7261 6d65 4261 7365 6020 6174 7472  `FrameBase` attr
+00004bc0: 6962 7574 6573 0a20 2020 2020 2020 2020  ibutes.         
+00004bd0: 2020 2072 6574 7572 6e20 6f62 6a65 6374     return object
+00004be0: 2e5f 5f67 6574 6174 7472 6962 7574 655f  .__getattribute_
+00004bf0: 5f28 7365 6c66 2c20 6b65 7929 0a20 2020  _(self, key).   
+00004c00: 2020 2020 2065 7863 6570 7420 4174 7472       except Attr
+00004c10: 6962 7574 6545 7272 6f72 2061 7320 6572  ibuteError as er
+00004c20: 723a 0a20 2020 2020 2020 2020 2020 2074  r:.            t
+00004c30: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00004c40: 2020 2020 2320 4661 6c6c 2062 6163 6b20      # Fall back 
+00004c50: 746f 2060 6578 7072 6020 4150 490a 2020  to `expr` API.  
+00004c60: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00004c70: 284d 616b 696e 6720 7375 7265 2074 6f20  (Making sure to 
+00004c80: 636f 6e76 6572 7420 746f 2f66 726f 6d20  convert to/from 
+00004c90: 4578 7072 290a 2020 2020 2020 2020 2020  Expr).          
+00004ca0: 2020 2020 2020 7661 6c20 3d20 6765 7461        val = geta
+00004cb0: 7474 7228 7365 6c66 2e65 7870 722c 206b  ttr(self.expr, k
+00004cc0: 6579 290a 2020 2020 2020 2020 2020 2020  ey).            
+00004cd0: 2020 2020 6966 2063 616c 6c61 626c 6528      if callable(
+00004ce0: 7661 6c29 3a0a 2020 2020 2020 2020 2020  val):.          
+00004cf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004d00: 2066 756e 6374 6f6f 6c73 2e70 6172 7469   functools.parti
+00004d10: 616c 285f 7772 6170 5f65 7870 725f 6170  al(_wrap_expr_ap
+00004d20: 692c 2077 7261 705f 6170 693d 7661 6c29  i, wrap_api=val)
+00004d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004d40: 2072 6574 7572 6e20 7661 6c0a 2020 2020   return val.    
+00004d50: 2020 2020 2020 2020 6578 6365 7074 2041          except A
+00004d60: 7474 7269 6275 7465 4572 726f 723a 0a20  ttributeError:. 
+00004d70: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00004d80: 2052 6169 7365 206f 7269 6769 6e61 6c20   Raise original 
+00004d90: 6572 726f 720a 2020 2020 2020 2020 2020  error.          
+00004da0: 2020 2020 2020 7261 6973 6520 6572 720a        raise err.
+00004db0: 0a20 2020 2064 6566 2076 6973 7561 6c69  .    def visuali
+00004dc0: 7a65 2873 656c 662c 2074 6173 6b73 3a20  ze(self, tasks: 
+00004dd0: 626f 6f6c 203d 2046 616c 7365 2c20 2a2a  bool = False, **
+00004de0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00004df0: 2022 2222 5669 7375 616c 697a 6520 7468   """Visualize th
+00004e00: 6520 6578 7072 6573 7369 6f6e 206f 7220  e expression or 
+00004e10: 7461 736b 2067 7261 7068 0a0a 2020 2020  task graph..    
+00004e20: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00004e30: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00004e40: 2d0a 2020 2020 2020 2020 7461 736b 733a  -.        tasks:
+00004e50: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+00004e60: 7468 6572 2074 6f20 7669 7375 616c 697a  ther to visualiz
+00004e70: 6520 7468 6520 7461 736b 2067 7261 7068  e the task graph
+00004e80: 2e20 4279 2064 6566 6175 6c74 0a20 2020  . By default.   
+00004e90: 2020 2020 2020 2020 2074 6865 2065 7870           the exp
+00004ea0: 7265 7373 696f 6e20 6772 6170 6820 7769  ression graph wi
+00004eb0: 6c6c 2062 6520 7669 7375 616c 697a 6564  ll be visualized
+00004ec0: 2069 6e73 7465 6164 2e0a 2020 2020 2020   instead..      
+00004ed0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00004ee0: 2074 6173 6b73 3a0a 2020 2020 2020 2020   tasks:.        
+00004ef0: 2020 2020 7265 7475 726e 2073 7570 6572      return super
+00004f00: 2829 2e76 6973 7561 6c69 7a65 282a 2a6b  ().visualize(**k
+00004f10: 7761 7267 7329 0a20 2020 2020 2020 2072  wargs).        r
+00004f20: 6574 7572 6e20 7365 6c66 2e65 7870 722e  eturn self.expr.
+00004f30: 7669 7375 616c 697a 6528 2a2a 6b77 6172  visualize(**kwar
+00004f40: 6773 290a 0a20 2020 2040 7072 6f70 6572  gs)..    @proper
+00004f50: 7479 0a20 2020 2064 6566 206b 6e6f 776e  ty.    def known
+00004f60: 5f64 6976 6973 696f 6e73 2873 656c 6629  _divisions(self)
+00004f70: 3a0a 2020 2020 2020 2020 2222 2257 6865  :.        """Whe
+00004f80: 7468 6572 2074 6865 2064 6976 6973 696f  ther the divisio
+00004f90: 6e73 2061 7265 206b 6e6f 776e 2e0a 0a20  ns are known... 
+00004fa0: 2020 2020 2020 2054 6869 7320 6368 6563         This chec
+00004fb0: 6b20 6361 6e20 6265 2065 7870 656e 7369  k can be expensi
+00004fc0: 7665 2069 6620 7468 6520 6469 7669 7369  ve if the divisi
+00004fd0: 6f6e 2063 616c 6375 6c61 7469 6f6e 2069  on calculation i
+00004fe0: 7320 6578 7065 6e73 6976 652e 0a20 2020  s expensive..   
+00004ff0: 2020 2020 2044 6174 6146 7261 6d65 2e73       DataFrame.s
+00005000: 6574 5f69 6e64 6578 2069 7320 6120 676f  et_index is a go
+00005010: 6f64 2065 7861 6d70 6c65 2077 6865 7265  od example where
+00005020: 2074 6865 2063 616c 6375 6c61 7469 6f6e   the calculation
+00005030: 206e 6565 6473 2061 6e0a 2020 2020 2020   needs an.      
+00005040: 2020 696e 7370 6563 7469 6f6e 206f 6620    inspection of 
+00005050: 7468 6520 6461 7461 2e0a 2020 2020 2020  the data..      
+00005060: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00005070: 7475 726e 2073 656c 662e 6578 7072 2e6b  turn self.expr.k
+00005080: 6e6f 776e 5f64 6976 6973 696f 6e73 0a0a  nown_divisions..
+00005090: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+000050a0: 2020 6465 6620 696e 6465 7828 7365 6c66    def index(self
+000050b0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000050c0: 7475 726e 2064 6173 6b20 496e 6465 7820  turn dask Index 
+000050d0: 696e 7374 616e 6365 2222 220a 2020 2020  instance""".    
+000050e0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000050f0: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
+00005100: 7870 722e 696e 6465 7829 0a0a 2020 2020  xpr.index)..    
+00005110: 4069 6e64 6578 2e73 6574 7465 720a 2020  @index.setter.  
+00005120: 2020 6465 6620 696e 6465 7828 7365 6c66    def index(self
+00005130: 2c20 7661 6c75 6529 3a0a 2020 2020 2020  , value):.      
+00005140: 2020 6173 7365 7274 2065 7870 722e 6172    assert expr.ar
+00005150: 655f 636f 5f61 6c69 676e 6564 280a 2020  e_co_aligned(.  
+00005160: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00005170: 7870 722c 2076 616c 7565 2e65 7870 720a  xpr, value.expr.
+00005180: 2020 2020 2020 2020 292c 2022 7661 6c75          ), "valu
+00005190: 6520 6e65 6564 7320 746f 2062 6520 616c  e needs to be al
+000051a0: 6967 6e65 6420 7769 7468 2074 6865 2069  igned with the i
+000051b0: 6e64 6578 220a 2020 2020 2020 2020 5f65  ndex".        _e
+000051c0: 7870 7220 3d20 6578 7072 2e41 7373 6967  xpr = expr.Assig
+000051d0: 6e49 6e64 6578 2873 656c 662c 2076 616c  nIndex(self, val
+000051e0: 7565 290a 2020 2020 2020 2020 7365 6c66  ue).        self
+000051f0: 2e5f 6578 7072 203d 205f 6578 7072 0a0a  ._expr = _expr..
+00005200: 2020 2020 6465 6620 7265 7365 745f 696e      def reset_in
+00005210: 6465 7828 7365 6c66 2c20 6472 6f70 3a20  dex(self, drop: 
+00005220: 626f 6f6c 203d 2046 616c 7365 293a 0a20  bool = False):. 
+00005230: 2020 2020 2020 2022 2222 5265 7365 7420         """Reset 
+00005240: 7468 6520 696e 6465 7820 746f 2074 6865  the index to the
+00005250: 2064 6566 6175 6c74 2069 6e64 6578 2e0a   default index..
+00005260: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
+00005270: 6174 2075 6e6c 696b 6520 696e 2060 6070  at unlike in ``p
+00005280: 616e 6461 7360 602c 2074 6865 2072 6573  andas``, the res
+00005290: 6574 2069 6e64 6578 2066 6f72 2061 2044  et index for a D
+000052a0: 6173 6b20 4461 7461 4672 616d 6520 7769  ask DataFrame wi
+000052b0: 6c6c 0a20 2020 2020 2020 206e 6f74 2062  ll.        not b
+000052c0: 6520 6d6f 6e6f 746f 6e69 6361 6c6c 7920  e monotonically 
+000052d0: 696e 6372 6561 7369 6e67 2066 726f 6d20  increasing from 
+000052e0: 302e 2049 6e73 7465 6164 2c20 6974 2077  0. Instead, it w
+000052f0: 696c 6c20 7265 7374 6172 7420 6174 2030  ill restart at 0
+00005300: 0a20 2020 2020 2020 2066 6f72 2065 6163  .        for eac
+00005310: 6820 7061 7274 6974 696f 6e20 2865 2e67  h partition (e.g
+00005320: 2e20 6060 696e 6465 7831 203d 205b 302c  . ``index1 = [0,
+00005330: 202e 2e2e 2c20 3130 5d2c 2069 6e64 6578   ..., 10], index
+00005340: 3220 3d20 5b30 2c20 2e2e 2e5d 6060 292e  2 = [0, ...]``).
+00005350: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
+00005360: 2064 7565 2074 6f20 7468 6520 696e 6162   due to the inab
+00005370: 696c 6974 7920 746f 2073 7461 7469 6361  ility to statica
+00005380: 6c6c 7920 6b6e 6f77 2074 6865 2066 756c  lly know the ful
+00005390: 6c20 6c65 6e67 7468 206f 6620 7468 650a  l length of the.
+000053a0: 2020 2020 2020 2020 696e 6465 782e 0a0a          index...
+000053b0: 2020 2020 2020 2020 466f 7220 4461 7461          For Data
+000053c0: 4672 616d 6520 7769 7468 206d 756c 7469  Frame with multi
+000053d0: 2d6c 6576 656c 2069 6e64 6578 2c20 7265  -level index, re
+000053e0: 7475 726e 7320 6120 6e65 7720 4461 7461  turns a new Data
+000053f0: 4672 616d 6520 7769 7468 0a20 2020 2020  Frame with.     
+00005400: 2020 206c 6162 656c 696e 6720 696e 666f     labeling info
+00005410: 726d 6174 696f 6e20 696e 2074 6865 2063  rmation in the c
+00005420: 6f6c 756d 6e73 2075 6e64 6572 2074 6865  olumns under the
+00005430: 2069 6e64 6578 206e 616d 6573 2c20 6465   index names, de
+00005440: 6661 756c 7469 6e67 0a20 2020 2020 2020  faulting.       
+00005450: 2074 6f20 276c 6576 656c 5f30 272c 2027   to 'level_0', '
+00005460: 6c65 7665 6c5f 3127 2c20 6574 632e 2069  level_1', etc. i
+00005470: 6620 616e 7920 6172 6520 4e6f 6e65 2e20  f any are None. 
+00005480: 466f 7220 6120 7374 616e 6461 7264 2069  For a standard i
+00005490: 6e64 6578 2c0a 2020 2020 2020 2020 7468  ndex,.        th
+000054a0: 6520 696e 6465 7820 6e61 6d65 2077 696c  e index name wil
+000054b0: 6c20 6265 2075 7365 6420 2869 6620 7365  l be used (if se
+000054c0: 7429 2c20 6f74 6865 7277 6973 6520 6120  t), otherwise a 
+000054d0: 6465 6661 756c 7420 2769 6e64 6578 2720  default 'index' 
+000054e0: 6f72 0a20 2020 2020 2020 2027 6c65 7665  or.        'leve
+000054f0: 6c5f 3027 2028 6966 2027 696e 6465 7827  l_0' (if 'index'
+00005500: 2069 7320 616c 7265 6164 7920 7461 6b65   is already take
+00005510: 6e29 2077 696c 6c20 6265 2075 7365 642e  n) will be used.
+00005520: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00005530: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00005540: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00005550: 6472 6f70 203a 2062 6f6f 6c65 616e 2c20  drop : boolean, 
+00005560: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+00005570: 2020 2020 2020 2020 2020 446f 206e 6f74            Do not
+00005580: 2074 7279 2074 6f20 696e 7365 7274 2069   try to insert i
+00005590: 6e64 6578 2069 6e74 6f20 6461 7461 6672  ndex into datafr
+000055a0: 616d 6520 636f 6c75 6d6e 732e 0a20 2020  ame columns..   
+000055b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000055c0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+000055d0: 6563 7469 6f6e 2865 7870 722e 5265 7365  ection(expr.Rese
+000055e0: 7449 6e64 6578 2873 656c 662c 2064 726f  tIndex(self, dro
+000055f0: 7029 290a 0a20 2020 2064 6566 2068 6561  p))..    def hea
+00005600: 6428 7365 6c66 2c20 6e3a 2069 6e74 203d  d(self, n: int =
+00005610: 2035 2c20 6e70 6172 7469 7469 6f6e 733d   5, npartitions=
+00005620: 312c 2063 6f6d 7075 7465 3a20 626f 6f6c  1, compute: bool
+00005630: 203d 2054 7275 6529 3a0a 2020 2020 2020   = True):.      
+00005640: 2020 2222 2246 6972 7374 206e 2072 6f77    """First n row
+00005650: 7320 6f66 2074 6865 2064 6174 6173 6574  s of the dataset
+00005660: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00005670: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00005680: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00005690: 6e20 3a20 696e 742c 206f 7074 696f 6e61  n : int, optiona
+000056a0: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
+000056b0: 6520 6e75 6d62 6572 206f 6620 726f 7773  e number of rows
+000056c0: 2074 6f20 7265 7475 726e 2e20 4465 6661   to return. Defa
+000056d0: 756c 7420 6973 2035 2e0a 2020 2020 2020  ult is 5..      
+000056e0: 2020 6e70 6172 7469 7469 6f6e 7320 3a20    npartitions : 
+000056f0: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
+00005700: 2020 2020 2020 2020 2020 456c 656d 656e            Elemen
+00005710: 7473 2061 7265 206f 6e6c 7920 7461 6b65  ts are only take
+00005720: 6e20 6672 6f6d 2074 6865 2066 6972 7374  n from the first
+00005730: 2060 606e 7061 7274 6974 696f 6e73 6060   ``npartitions``
+00005740: 2c20 7769 7468 2061 0a20 2020 2020 2020  , with a.       
+00005750: 2020 2020 2064 6566 6175 6c74 206f 6620       default of 
+00005760: 312e 2049 6620 7468 6572 6520 6172 6520  1. If there are 
+00005770: 6665 7765 7220 7468 616e 2060 606e 6060  fewer than ``n``
+00005780: 2072 6f77 7320 696e 2074 6865 2066 6972   rows in the fir
+00005790: 7374 0a20 2020 2020 2020 2020 2020 2060  st.            `
+000057a0: 606e 7061 7274 6974 696f 6e73 6060 2061  `npartitions`` a
+000057b0: 2077 6172 6e69 6e67 2077 696c 6c20 6265   warning will be
+000057c0: 2072 6169 7365 6420 616e 6420 616e 7920   raised and any 
+000057d0: 666f 756e 6420 726f 7773 0a20 2020 2020  found rows.     
+000057e0: 2020 2020 2020 2072 6574 7572 6e65 642e         returned.
+000057f0: 2050 6173 7320 2d31 2074 6f20 7573 6520   Pass -1 to use 
+00005800: 616c 6c20 7061 7274 6974 696f 6e73 2e0a  all partitions..
+00005810: 2020 2020 2020 2020 636f 6d70 7574 6520          compute 
+00005820: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+00005830: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+00005840: 7468 6572 2074 6f20 636f 6d70 7574 6520  ther to compute 
+00005850: 7468 6520 7265 7375 6c74 2c20 6465 6661  the result, defa
+00005860: 756c 7420 6973 2054 7275 652e 0a20 2020  ult is True..   
+00005870: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00005880: 206f 7574 203d 206e 6577 5f63 6f6c 6c65   out = new_colle
+00005890: 6374 696f 6e28 6578 7072 2e48 6561 6428  ction(expr.Head(
+000058a0: 7365 6c66 2c20 6e3d 6e2c 206e 7061 7274  self, n=n, npart
+000058b0: 6974 696f 6e73 3d6e 7061 7274 6974 696f  itions=npartitio
+000058c0: 6e73 2929 0a20 2020 2020 2020 2069 6620  ns)).        if 
+000058d0: 636f 6d70 7574 653a 0a20 2020 2020 2020  compute:.       
+000058e0: 2020 2020 206f 7574 203d 206f 7574 2e63       out = out.c
+000058f0: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
+00005900: 2072 6574 7572 6e20 6f75 740a 0a20 2020   return out..   
+00005910: 2064 6566 2074 6169 6c28 7365 6c66 2c20   def tail(self, 
+00005920: 6e3a 2069 6e74 203d 2035 2c20 636f 6d70  n: int = 5, comp
+00005930: 7574 653a 2062 6f6f 6c20 3d20 5472 7565  ute: bool = True
+00005940: 293a 0a20 2020 2020 2020 2022 2222 4c61  ):.        """La
+00005950: 7374 206e 2072 6f77 7320 6f66 2074 6865  st n rows of the
+00005960: 2064 6174 6173 6574 0a0a 2020 2020 2020   dataset..      
+00005970: 2020 4361 7665 6174 2c20 7468 6520 6f6e    Caveat, the on
+00005980: 6c79 2063 6865 636b 7320 7468 6520 6c61  ly checks the la
+00005990: 7374 206e 2072 6f77 7320 6f66 2074 6865  st n rows of the
+000059a0: 206c 6173 7420 7061 7274 6974 696f 6e2e   last partition.
+000059b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000059c0: 2020 2020 206f 7574 203d 206e 6577 5f63       out = new_c
+000059d0: 6f6c 6c65 6374 696f 6e28 6578 7072 2e54  ollection(expr.T
+000059e0: 6169 6c28 7365 6c66 2c20 6e3d 6e29 290a  ail(self, n=n)).
+000059f0: 2020 2020 2020 2020 6966 2063 6f6d 7075          if compu
+00005a00: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+00005a10: 6f75 7420 3d20 6f75 742e 636f 6d70 7574  out = out.comput
+00005a20: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
+00005a30: 726e 206f 7574 0a0a 2020 2020 6465 6620  rn out..    def 
+00005a40: 636f 7079 2873 656c 662c 2064 6565 703a  copy(self, deep:
+00005a50: 2062 6f6f 6c20 3d20 4661 6c73 6529 3a0a   bool = False):.
+00005a60: 2020 2020 2020 2020 2222 224d 616b 6520          """Make 
+00005a70: 6120 636f 7079 206f 6620 7468 6520 6461  a copy of the da
+00005a80: 7461 6672 616d 650a 0a20 2020 2020 2020  taframe..       
+00005a90: 2054 6869 7320 6973 2073 7472 6963 746c   This is strictl
+00005aa0: 7920 6120 7368 616c 6c6f 7720 636f 7079  y a shallow copy
+00005ab0: 206f 6620 7468 6520 756e 6465 726c 7969   of the underlyi
+00005ac0: 6e67 2063 6f6d 7075 7461 7469 6f6e 616c  ng computational
+00005ad0: 2067 7261 7068 2e0a 2020 2020 2020 2020   graph..        
+00005ae0: 4974 2064 6f65 7320 6e6f 7420 6166 6665  It does not affe
+00005af0: 6374 2074 6865 2075 6e64 6572 6c79 696e  ct the underlyin
+00005b00: 6720 6461 7461 0a0a 2020 2020 2020 2020  g data..        
+00005b10: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00005b20: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00005b30: 2020 2020 2020 6465 6570 203a 2062 6f6f        deep : boo
+00005b40: 6c65 616e 2c20 6465 6661 756c 7420 4661  lean, default Fa
+00005b50: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00005b60: 5468 6520 6465 6570 2076 616c 7565 206d  The deep value m
+00005b70: 7573 7420 6265 2060 4661 6c73 6560 2061  ust be `False` a
+00005b80: 6e64 2069 7420 6973 2064 6563 6c61 7265  nd it is declare
+00005b90: 6420 6173 2061 2070 6172 616d 6574 6572  d as a parameter
+00005ba0: 206a 7573 7420 666f 720a 2020 2020 2020   just for.      
+00005bb0: 2020 2020 2020 636f 6d70 6174 6962 696c        compatibil
+00005bc0: 6974 7920 7769 7468 2074 6869 7264 2d70  ity with third-p
+00005bd0: 6172 7479 206c 6962 7261 7269 6573 206c  arty libraries l
+00005be0: 696b 6520 6375 4446 2061 6e64 2070 616e  ike cuDF and pan
+00005bf0: 6461 730a 2020 2020 2020 2020 2222 220a  das.        """.
+00005c00: 2020 2020 2020 2020 6966 2064 6565 7020          if deep 
+00005c10: 6973 206e 6f74 2046 616c 7365 3a0a 2020  is not False:.  
+00005c20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00005c30: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00005c40: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+00005c50: 2060 6465 6570 6020 7661 6c75 6520 6d75   `deep` value mu
+00005c60: 7374 2062 6520 4661 6c73 652e 2054 6869  st be False. Thi
+00005c70: 7320 6973 2073 7472 6963 746c 7920 6120  s is strictly a 
+00005c80: 7368 616c 6c6f 7720 636f 7079 2022 0a20  shallow copy ". 
+00005c90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00005ca0: 6f66 2074 6865 2075 6e64 6572 6c79 696e  of the underlyin
+00005cb0: 6720 636f 6d70 7574 6174 696f 6e61 6c20  g computational 
+00005cc0: 6772 6170 682e 220a 2020 2020 2020 2020  graph.".        
+00005cd0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00005ce0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00005cf0: 696f 6e28 7365 6c66 2e65 7870 7229 0a0a  ion(self.expr)..
+00005d00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00005d10: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00005d20: 2020 2020 6465 6620 6973 696e 2873 656c      def isin(sel
+00005d30: 662c 2076 616c 7565 7329 3a0a 2020 2020  f, values):.    
+00005d40: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00005d50: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
+00005d60: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00005d70: 2320 4461 7461 4672 616d 652e 6973 696e  # DataFrame.isin
+00005d80: 2064 6f65 7320 7765 6972 6420 616c 6967   does weird alig
+00005d90: 6e6d 656e 7420 7374 7566 660a 2020 2020  nment stuff.    
+00005da0: 2020 2020 2020 2020 6261 645f 7479 7065          bad_type
+00005db0: 7320 3d20 2846 7261 6d65 4261 7365 2c20  s = (FrameBase, 
+00005dc0: 7064 2e53 6572 6965 732c 2070 642e 4461  pd.Series, pd.Da
+00005dd0: 7461 4672 616d 6529 0a20 2020 2020 2020  taFrame).       
+00005de0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00005df0: 2020 2062 6164 5f74 7970 6573 203d 2028     bad_types = (
+00005e00: 4672 616d 6542 6173 652c 290a 2020 2020  FrameBase,).    
+00005e10: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00005e20: 6528 7661 6c75 6573 2c20 6261 645f 7479  e(values, bad_ty
+00005e30: 7065 7329 3a0a 2020 2020 2020 2020 2020  pes):.          
+00005e40: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+00005e50: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
+00005e60: 6528 7661 6c75 6573 2c20 4672 616d 6542  e(values, FrameB
+00005e70: 6173 6529 0a20 2020 2020 2020 2020 2020  ase).           
+00005e80: 2020 2020 2061 6e64 2076 616c 7565 732e       and values.
+00005e90: 6e64 696d 203d 3d20 310a 2020 2020 2020  ndim == 1.      
+00005ea0: 2020 2020 2020 2020 2020 616e 6420 7661            and va
+00005eb0: 6c75 6573 2e6e 7061 7274 6974 696f 6e73  lues.npartitions
+00005ec0: 203d 3d20 310a 2020 2020 2020 2020 2020   == 1.          
+00005ed0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00005ee0: 2020 2020 2023 2043 616e 2062 726f 6164       # Can broad
+00005ef0: 6361 7374 0a20 2020 2020 2020 2020 2020  cast.           
+00005f00: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00005f10: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+00005f20: 4973 696e 2873 656c 662c 2076 616c 7565  Isin(self, value
+00005f30: 733d 7661 6c75 6573 2929 0a20 2020 2020  s=values)).     
+00005f40: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00005f50: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00005f60: 2822 5061 7373 696e 6720 6120 2572 2074  ("Passing a %r t
+00005f70: 6f20 6069 7369 6e60 2220 2520 7479 7065  o `isin`" % type
+00005f80: 6e61 6d65 2874 7970 6528 7661 6c75 6573  name(type(values
+00005f90: 2929 290a 0a20 2020 2020 2020 2023 2057  )))..        # W
+00005fa0: 6520 7772 6170 2076 616c 7565 7320 696e  e wrap values in
+00005fb0: 2061 2064 656c 6179 6564 2066 6f72 2074   a delayed for t
+00005fc0: 776f 2072 6561 736f 6e73 3a0a 2020 2020  wo reasons:.    
+00005fd0: 2020 2020 2320 2d20 6176 6f69 6420 7365      # - avoid se
+00005fe0: 7269 616c 697a 696e 6720 6461 7461 2069  rializing data i
+00005ff0: 6e20 6576 6572 7920 7461 736b 0a20 2020  n every task.   
+00006000: 2020 2020 2023 202d 2061 766f 6964 2063       # - avoid c
+00006010: 6f73 7420 6f66 2074 7261 7665 7273 616c  ost of traversal
+00006020: 206f 6620 6c61 7267 6520 6c69 7374 2069   of large list i
+00006030: 6e20 6f70 7469 6d69 7a61 7469 6f6e 730a  n optimizations.
+00006040: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00006050: 7461 6e63 6528 7661 6c75 6573 2c20 6c69  tance(values, li
+00006060: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+00006070: 2023 204d 6f74 6976 6174 6564 2062 7920   # Motivated by 
+00006080: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00006090: 6f6d 2f64 6173 6b2f 6461 736b 2f69 7373  om/dask/dask/iss
+000060a0: 7565 732f 3934 3131 2e20 2054 6869 7320  ues/9411.  This 
+000060b0: 6170 7065 6172 7320 746f 2062 650a 2020  appears to be.  
+000060c0: 2020 2020 2020 2020 2020 2320 6361 7573            # caus
+000060d0: 6564 2062 7920 6874 7470 733a 2f2f 6769  ed by https://gi
+000060e0: 7468 7562 2e63 6f6d 2f64 6173 6b2f 6469  thub.com/dask/di
+000060f0: 7374 7269 6275 7465 642f 6973 7375 6573  stributed/issues
+00006100: 2f36 3336 382c 2061 6e64 2066 7572 7468  /6368, and furth
+00006110: 6572 0a20 2020 2020 2020 2020 2020 2023  er.            #
+00006120: 2065 7861 6365 7262 6174 6564 2062 7920   exacerbated by 
+00006130: 7468 6520 6661 6374 2074 6861 7420 7468  the fact that th
+00006140: 6520 6c69 7374 2063 6f6e 7461 696e 7320  e list contains 
+00006150: 6475 706c 6963 6174 6573 2e20 2054 6869  duplicates.  Thi
+00006160: 7320 6973 2061 2070 6174 6368 2075 6e74  s is a patch unt
+00006170: 696c 0a20 2020 2020 2020 2020 2020 2023  il.            #
+00006180: 2077 6520 6361 6e20 6372 6561 7465 2061   we can create a
+00006190: 2062 6574 7465 7220 6669 7820 666f 7220   better fix for 
+000061a0: 5365 7269 616c 697a 6174 696f 6e2e 0a20  Serialization.. 
+000061b0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+000061c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061d0: 7661 6c75 6573 203d 206c 6973 7428 7365  values = list(se
+000061e0: 7428 7661 6c75 6573 2929 0a20 2020 2020  t(values)).     
+000061f0: 2020 2020 2020 2065 7863 6570 7420 5479         except Ty
+00006200: 7065 4572 726f 723a 0a20 2020 2020 2020  peError:.       
+00006210: 2020 2020 2020 2020 2070 6173 730a 2020           pass.  
+00006220: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00006230: 2061 6e79 2869 735f 6461 736b 5f63 6f6c   any(is_dask_col
+00006240: 6c65 6374 696f 6e28 7629 2066 6f72 2076  lection(v) for v
+00006250: 2069 6e20 7661 6c75 6573 293a 0a20 2020   in values):.   
+00006260: 2020 2020 2020 2020 2020 2020 2074 7279               try
+00006270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006280: 2020 2020 2020 7661 6c75 6573 203d 206e        values = n
+00006290: 702e 6672 6f6d 6974 6572 2876 616c 7565  p.fromiter(value
+000062a0: 732c 2064 7479 7065 3d6f 626a 6563 7429  s, dtype=object)
+000062b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000062c0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+000062d0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+000062e0: 2020 2020 2020 2020 2320 4e75 6d70 7920          # Numpy 
+000062f0: 312e 3233 2073 7570 706f 7274 7320 6372  1.23 supports cr
+00006300: 6561 7469 6e67 2061 7272 6179 7320 6f66  eating arrays of
+00006310: 2069 7465 7261 626c 6573 2c20 7768 696c   iterables, whil
+00006320: 6520 6c6f 7765 720a 2020 2020 2020 2020  e lower.        
+00006330: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
+00006340: 7273 696f 6e20 312e 3231 2e78 2061 6e64  rsion 1.21.x and
+00006350: 2031 2e32 322e 7820 646f 206e 6f74 0a20   1.22.x do not. 
+00006360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006370: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
+00006380: 6672 6f6d 2064 6173 6b5f 6578 7072 2e69  from dask_expr.i
+00006390: 6f2e 5f64 656c 6179 6564 2069 6d70 6f72  o._delayed impor
+000063a0: 7420 5f44 656c 6179 6564 4578 7072 0a0a  t _DelayedExpr..
+000063b0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+000063c0: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
+000063d0: 2020 2020 2020 2020 2020 2065 7870 722e             expr.
+000063e0: 4973 696e 280a 2020 2020 2020 2020 2020  Isin(.          
+000063f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00006400: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00006410: 6573 3d5f 4465 6c61 7965 6445 7870 7228  es=_DelayedExpr(
+00006420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006430: 2020 2020 2064 656c 6179 6564 2876 616c       delayed(val
+00006440: 7565 732c 206e 616d 653d 2264 656c 6179  ues, name="delay
+00006450: 6564 2d22 202b 205f 746f 6b65 6e69 7a65  ed-" + _tokenize
+00006460: 5f64 6574 6572 6d69 6e69 7374 6963 2876  _deterministic(v
+00006470: 616c 7565 7329 290a 2020 2020 2020 2020  alues)).        
+00006480: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00006490: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000064a0: 2029 0a0a 2020 2020 6465 6620 5f70 6172   )..    def _par
+000064b0: 7469 7469 6f6e 7328 7365 6c66 2c20 696e  titions(self, in
+000064c0: 6465 7829 3a0a 2020 2020 2020 2020 2320  dex):.        # 
+000064d0: 5573 6564 2062 7920 6070 6172 7469 7469  Used by `partiti
+000064e0: 6f6e 7360 2066 6f72 2070 6172 7469 7469  ons` for partiti
+000064f0: 6f6e 2d77 6973 6520 736c 6963 696e 670a  on-wise slicing.
+00006500: 0a20 2020 2020 2020 2023 2043 6f6e 7665  .        # Conve
+00006510: 7274 2069 6e64 6578 2074 6f20 6c69 7374  rt index to list
+00006520: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00006530: 7374 616e 6365 2869 6e64 6578 2c20 696e  stance(index, in
+00006540: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00006550: 696e 6465 7820 3d20 5b69 6e64 6578 5d0a  index = [index].
+00006560: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+00006570: 6e70 2e61 7261 6e67 6528 7365 6c66 2e6e  np.arange(self.n
+00006580: 7061 7274 6974 696f 6e73 2c20 6474 7970  partitions, dtyp
+00006590: 653d 6f62 6a65 6374 295b 696e 6465 785d  e=object)[index]
+000065a0: 2e74 6f6c 6973 7428 290a 0a20 2020 2020  .tolist()..     
+000065b0: 2020 2023 2043 6865 636b 2074 6861 7420     # Check that 
+000065c0: 7365 6c65 6374 696f 6e20 6d61 6b65 7320  selection makes 
+000065d0: 7365 6e73 650a 2020 2020 2020 2020 6173  sense.        as
+000065e0: 7365 7274 2073 6574 2869 6e64 6578 292e  sert set(index).
+000065f0: 6973 7375 6273 6574 2872 616e 6765 2873  issubset(range(s
+00006600: 656c 662e 6e70 6172 7469 7469 6f6e 7329  elf.npartitions)
+00006610: 290a 0a20 2020 2020 2020 2023 2052 6574  )..        # Ret
+00006620: 7572 6e20 7365 6c65 6374 6564 2070 6172  urn selected par
+00006630: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+00006640: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00006650: 6374 696f 6e28 6578 7072 2e50 6172 7469  ction(expr.Parti
+00006660: 7469 6f6e 7328 7365 6c66 2c20 696e 6465  tions(self, inde
+00006670: 7829 290a 0a20 2020 2040 7072 6f70 6572  x))..    @proper
+00006680: 7479 0a20 2020 2064 6566 2070 6172 7469  ty.    def parti
+00006690: 7469 6f6e 7328 7365 6c66 293a 0a20 2020  tions(self):.   
+000066a0: 2020 2020 2022 2222 536c 6963 6520 6461       """Slice da
+000066b0: 7461 6672 616d 6520 6279 2070 6172 7469  taframe by parti
+000066c0: 7469 6f6e 730a 0a20 2020 2020 2020 2054  tions..        T
+000066d0: 6869 7320 616c 6c6f 7773 2070 6172 7469  his allows parti
+000066e0: 7469 6f6e 7769 7365 2073 6c69 6369 6e67  tionwise slicing
+000066f0: 206f 6620 6120 4461 736b 2044 6174 6166   of a Dask Dataf
+00006700: 7261 6d65 2e20 2059 6f75 2063 616e 2070  rame.  You can p
+00006710: 6572 666f 726d 206e 6f72 6d61 6c0a 2020  erform normal.  
+00006720: 2020 2020 2020 4e75 6d70 792d 7374 796c        Numpy-styl
+00006730: 6520 736c 6963 696e 672c 2062 7574 206e  e slicing, but n
+00006740: 6f77 2072 6174 6865 7220 7468 616e 2073  ow rather than s
+00006750: 6c69 6365 2065 6c65 6d65 6e74 7320 6f66  lice elements of
+00006760: 2074 6865 2061 7272 6179 2079 6f75 0a20   the array you. 
+00006770: 2020 2020 2020 2073 6c69 6365 2061 6c6f         slice alo
+00006780: 6e67 2070 6172 7469 7469 6f6e 7320 736f  ng partitions so
+00006790: 2c20 666f 7220 6578 616d 706c 652c 2060  , for example, `
+000067a0: 6064 662e 7061 7274 6974 696f 6e73 5b3a  `df.partitions[:
+000067b0: 355d 6060 2070 726f 6475 6365 7320 6120  5]`` produces a 
+000067c0: 6e65 770a 2020 2020 2020 2020 4461 736b  new.        Dask
+000067d0: 2044 6174 6166 7261 6d65 206f 6620 7468   Dataframe of th
+000067e0: 6520 6669 7273 7420 6669 7665 2070 6172  e first five par
+000067f0: 7469 7469 6f6e 732e 2056 616c 6964 2069  titions. Valid i
+00006800: 6e64 6578 6572 7320 6172 6520 696e 7465  ndexers are inte
+00006810: 6765 7273 2c20 7365 7175 656e 6365 730a  gers, sequences.
+00006820: 2020 2020 2020 2020 6f66 2069 6e74 6567          of integ
+00006830: 6572 732c 2073 6c69 6365 732c 206f 7220  ers, slices, or 
+00006840: 626f 6f6c 6561 6e20 6d61 736b 732e 0a0a  boolean masks...
+00006850: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00006860: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006870: 2d0a 2020 2020 2020 2020 3e3e 3e20 6466  -.        >>> df
+00006880: 2e70 6172 7469 7469 6f6e 735b 305d 2020  .partitions[0]  
+00006890: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+000068a0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000068b0: 7061 7274 6974 696f 6e73 5b3a 335d 2020  partitions[:3]  
+000068c0: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+000068d0: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
+000068e0: 7061 7274 6974 696f 6e73 5b3a 3a31 305d  partitions[::10]
+000068f0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+00006900: 4950 0a0a 2020 2020 2020 2020 5265 7475  IP..        Retu
+00006910: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00006920: 2d2d 2d0a 2020 2020 2020 2020 4120 4461  ---.        A Da
+00006930: 736b 2044 6174 6146 7261 6d65 0a20 2020  sk DataFrame.   
+00006940: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00006950: 2072 6574 7572 6e20 496e 6465 7843 616c   return IndexCal
+00006960: 6c61 626c 6528 7365 6c66 2e5f 7061 7274  lable(self._part
+00006970: 6974 696f 6e73 290a 0a20 2020 2064 6566  itions)..    def
+00006980: 2067 6574 5f70 6172 7469 7469 6f6e 2873   get_partition(s
+00006990: 656c 662c 206e 293a 0a20 2020 2020 2020  elf, n):.       
+000069a0: 2022 2222 0a20 2020 2020 2020 2047 6574   """.        Get
+000069b0: 2061 2064 6173 6b20 4461 7461 4672 616d   a dask DataFram
+000069c0: 652f 5365 7269 6573 2072 6570 7265 7365  e/Series represe
+000069d0: 6e74 696e 6720 7468 6520 606e 7468 6020  nting the `nth` 
+000069e0: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+000069f0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00006a00: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00006a10: 2d0a 2020 2020 2020 2020 6e20 3a20 696e  -.        n : in
+00006a20: 740a 2020 2020 2020 2020 2020 2020 5468  t.            Th
+00006a30: 6520 302d 696e 6465 7865 6420 7061 7274  e 0-indexed part
+00006a40: 6974 696f 6e20 6e75 6d62 6572 2074 6f20  ition number to 
+00006a50: 7365 6c65 6374 2e0a 0a20 2020 2020 2020  select...       
+00006a60: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00006a70: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00006a80: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
+00006a90: 6f72 2053 6572 6965 730a 2020 2020 2020  or Series.      
+00006aa0: 2020 2020 2020 5468 6520 7361 6d65 2074        The same t
+00006ab0: 7970 6520 6173 2074 6865 206f 7269 6769  ype as the origi
+00006ac0: 6e61 6c20 6f62 6a65 6374 2e0a 0a20 2020  nal object...   
+00006ad0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00006ae0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00006af0: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
+00006b00: 2e70 6172 7469 7469 6f6e 730a 2020 2020  .partitions.    
+00006b10: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00006b20: 6966 206e 6f74 2030 203c 3d20 6e20 3c20  if not 0 <= n < 
+00006b30: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00006b40: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
+00006b50: 6720 3d20 6622 6e20 6d75 7374 2062 6520  g = f"n must be 
+00006b60: 3020 3c3d 206e 203c 207b 7365 6c66 2e6e  0 <= n < {self.n
+00006b70: 7061 7274 6974 696f 6e73 7d22 0a20 2020  partitions}".   
+00006b80: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00006b90: 616c 7565 4572 726f 7228 6d73 6729 0a20  alueError(msg). 
+00006ba0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00006bb0: 6c66 2e70 6172 7469 7469 6f6e 735b 6e5d  lf.partitions[n]
+00006bc0: 0a0a 2020 2020 6465 6620 7368 7566 666c  ..    def shuffl
+00006bd0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+00006be0: 0a20 2020 2020 2020 206f 6e3a 2073 7472  .        on: str
+00006bf0: 207c 206c 6973 7420 7c20 6e6f 5f64 6566   | list | no_def
+00006c00: 6175 6c74 203d 206e 6f5f 6465 6661 756c  ault = no_defaul
+00006c10: 742c 0a20 2020 2020 2020 2069 676e 6f72  t,.        ignor
+00006c20: 655f 696e 6465 783a 2062 6f6f 6c20 3d20  e_index: bool = 
+00006c30: 4661 6c73 652c 0a20 2020 2020 2020 206e  False,.        n
+00006c40: 7061 7274 6974 696f 6e73 3a20 696e 7420  partitions: int 
+00006c50: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+00006c60: 2020 2020 2020 2073 6875 6666 6c65 5f6d         shuffle_m
+00006c70: 6574 686f 643a 2073 7472 207c 204e 6f6e  ethod: str | Non
+00006c80: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+00006c90: 2020 6f6e 5f69 6e64 6578 3a20 626f 6f6c    on_index: bool
+00006ca0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00006cb0: 2020 2a2a 6f70 7469 6f6e 732c 0a20 2020    **options,.   
+00006cc0: 2029 3a0a 2020 2020 2020 2020 2222 2252   ):.        """R
+00006cd0: 6561 7272 616e 6765 2044 6174 6146 7261  earrange DataFra
+00006ce0: 6d65 2069 6e74 6f20 6e65 7720 7061 7274  me into new part
+00006cf0: 6974 696f 6e73 0a0a 2020 2020 2020 2020  itions..        
+00006d00: 5573 6573 2068 6173 6869 6e67 206f 6620  Uses hashing of 
+00006d10: 606f 6e60 2074 6f20 6d61 7020 726f 7773  `on` to map rows
+00006d20: 2074 6f20 6f75 7470 7574 2070 6172 7469   to output parti
+00006d30: 7469 6f6e 732e 2041 6674 6572 2074 6869  tions. After thi
+00006d40: 730a 2020 2020 2020 2020 6f70 6572 6174  s.        operat
+00006d50: 696f 6e2c 2072 6f77 7320 7769 7468 2074  ion, rows with t
+00006d60: 6865 2073 616d 6520 7661 6c75 6520 6f66  he same value of
+00006d70: 2060 6f6e 6020 7769 6c6c 2062 6520 696e   `on` will be in
+00006d80: 2074 6865 2073 616d 650a 2020 2020 2020   the same.      
+00006d90: 2020 7061 7274 6974 696f 6e2e 0a0a 2020    partition...  
+00006da0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00006db0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006dc0: 2d2d 2d0a 2020 2020 2020 2020 6f6e 203a  ---.        on :
+00006dd0: 2073 7472 2c20 6c69 7374 206f 6620 7374   str, list of st
+00006de0: 722c 206f 7220 5365 7269 6573 2c20 496e  r, or Series, In
+00006df0: 6465 782c 206f 7220 4461 7461 4672 616d  dex, or DataFram
+00006e00: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
+00006e10: 6c75 6d6e 206e 616d 6573 2074 6f20 7368  lumn names to sh
+00006e20: 7566 666c 6520 6279 2e0a 2020 2020 2020  uffle by..      
+00006e30: 2020 6967 6e6f 7265 5f69 6e64 6578 203a    ignore_index :
+00006e40: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00006e50: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+00006e60: 2069 676e 6f72 6520 7468 6520 696e 6465   ignore the inde
+00006e70: 782e 2044 6566 6175 6c74 2069 7320 6060  x. Default is ``
+00006e80: 4661 6c73 6560 602e 0a20 2020 2020 2020  False``..       
+00006e90: 206e 7061 7274 6974 696f 6e73 203a 206f   npartitions : o
+00006ea0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00006eb0: 2020 2020 4e75 6d62 6572 206f 6620 6f75      Number of ou
+00006ec0: 7470 7574 2070 6172 7469 7469 6f6e 732e  tput partitions.
+00006ed0: 2054 6865 2070 6172 7469 7469 6f6e 2063   The partition c
+00006ee0: 6f75 6e74 2077 696c 6c0a 2020 2020 2020  ount will.      
+00006ef0: 2020 2020 2020 6265 2070 7265 7365 7276        be preserv
+00006f00: 6564 2062 7920 6465 6661 756c 742e 0a20  ed by default.. 
+00006f10: 2020 2020 2020 2073 6875 6666 6c65 5f6d         shuffle_m
+00006f20: 6574 686f 6420 3a20 6f70 7469 6f6e 616c  ethod : optional
+00006f30: 0a20 2020 2020 2020 2020 2020 2044 6573  .            Des
+00006f40: 6972 6564 2073 6875 6666 6c65 206d 6574  ired shuffle met
+00006f50: 686f 642e 2044 6566 6175 6c74 2063 686f  hod. Default cho
+00006f60: 7365 6e20 6174 206f 7074 696d 697a 6174  sen at optimizat
+00006f70: 696f 6e20 7469 6d65 2e0a 2020 2020 2020  ion time..      
+00006f80: 2020 6f6e 5f69 6e64 6578 203a 2062 6f6f    on_index : boo
+00006f90: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
+00006fa0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+00006fb0: 7468 6572 2074 6f20 7368 7566 666c 6520  ther to shuffle 
+00006fc0: 6f6e 2074 6865 2069 6e64 6578 2e20 4d75  on the index. Mu
+00006fd0: 7475 616c 6c79 2065 7863 6c75 7369 7665  tually exclusive
+00006fe0: 2077 6974 6820 276f 6e27 2e0a 2020 2020   with 'on'..    
+00006ff0: 2020 2020 2020 2020 5365 7420 7468 6973          Set this
+00007000: 2074 6f20 6060 5472 7565 6060 2069 6620   to ``True`` if 
+00007010: 276f 6e27 2069 7320 6e6f 7420 7072 6f76  'on' is not prov
+00007020: 6964 6564 2e0a 2020 2020 2020 2020 2a2a  ided..        **
+00007030: 6f70 7469 6f6e 7320 3a20 6f70 7469 6f6e  options : option
+00007040: 616c 0a20 2020 2020 2020 2020 2020 2041  al.            A
+00007050: 6c67 6f72 6974 686d 2d73 7065 6369 6669  lgorithm-specifi
+00007060: 6320 6f70 7469 6f6e 732e 0a0a 2020 2020  c options...    
+00007070: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
+00007080: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
+00007090: 5468 6973 2064 6f65 7320 6e6f 7420 7072  This does not pr
+000070a0: 6573 6572 7665 2061 206d 6561 6e69 6e67  eserve a meaning
+000070b0: 6675 6c20 696e 6465 782f 7061 7274 6974  ful index/partit
+000070c0: 696f 6e69 6e67 2073 6368 656d 652e 2054  ioning scheme. T
+000070d0: 6869 730a 2020 2020 2020 2020 6973 206e  his.        is n
+000070e0: 6f74 2064 6574 6572 6d69 6e69 7374 6963  ot deterministic
+000070f0: 2069 6620 646f 6e65 2069 6e20 7061 7261   if done in para
+00007100: 6c6c 656c 2e0a 0a20 2020 2020 2020 2045  llel...        E
+00007110: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00007120: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00007130: 203e 3e3e 2064 6620 3d20 6466 2e73 6875   >>> df = df.shu
+00007140: 6666 6c65 2864 662e 636f 6c75 6d6e 735b  ffle(df.columns[
+00007150: 305d 2920 2023 2064 6f63 7465 7374 3a20  0])  # doctest: 
+00007160: 2b53 4b49 500a 2020 2020 2020 2020 2222  +SKIP.        ""
+00007170: 220a 2020 2020 2020 2020 6966 206f 6e20  ".        if on 
+00007180: 6973 206e 6f5f 6465 6661 756c 7420 616e  is no_default an
+00007190: 6420 6e6f 7420 6f6e 5f69 6e64 6578 3a0a  d not on_index:.
+000071a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000071b0: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+000071c0: 2020 2020 2020 2020 2020 2020 2022 4d75               "Mu
+000071d0: 7374 2073 6875 6666 6c65 206f 6e20 6569  st shuffle on ei
+000071e0: 7468 6572 2063 6f6c 756d 6e73 206f 7220  ther columns or 
+000071f0: 7468 6520 696e 6465 783b 2063 7572 7265  the index; curre
+00007200: 6e74 6c79 2073 6875 6666 6c69 6e67 206f  ntly shuffling o
+00007210: 6e20 220a 2020 2020 2020 2020 2020 2020  n ".            
+00007220: 2020 2020 226e 6569 7468 6572 2e20 5061      "neither. Pa
+00007230: 7373 2063 6f6c 756d 6e28 7329 2074 6f20  ss column(s) to 
+00007240: 276f 6e27 206f 7220 7365 7420 276f 6e5f  'on' or set 'on_
+00007250: 696e 6465 7827 2074 6f20 5472 7565 2e22  index' to True."
+00007260: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00007270: 2020 2020 2020 2065 6c69 6620 6f6e 2069         elif on i
+00007280: 7320 6e6f 7420 6e6f 5f64 6566 6175 6c74  s not no_default
+00007290: 2061 6e64 206f 6e5f 696e 6465 783a 0a20   and on_index:. 
+000072a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000072b0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
+000072c0: 2020 2020 2020 2020 2020 2020 2243 616e              "Can
+000072d0: 6e6f 7420 7368 7566 666c 6520 6f6e 2062  not shuffle on b
+000072e0: 6f74 6820 636f 6c75 6d6e 7320 616e 6420  oth columns and 
+000072f0: 7468 6520 696e 6465 782e 2044 6f20 6e6f  the index. Do no
+00007300: 7420 7061 7373 2063 6f6c 756d 6e28 7329  t pass column(s)
+00007310: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00007320: 2020 2022 746f 2027 6f6e 2720 6f72 2073     "to 'on' or s
+00007330: 6574 2027 6f6e 5f69 6e64 6578 2720 746f  et 'on_index' to
+00007340: 2046 616c 7365 2e22 0a20 2020 2020 2020   False.".       
+00007350: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00007360: 2320 5072 6573 6572 7665 2070 6172 7469  # Preserve parti
+00007370: 7469 6f6e 2063 6f75 6e74 2062 7920 6465  tion count by de
+00007380: 6661 756c 740a 2020 2020 2020 2020 6e70  fault.        np
+00007390: 6172 7469 7469 6f6e 7320 3d20 6e70 6172  artitions = npar
+000073a0: 7469 7469 6f6e 7320 6f72 2073 656c 662e  titions or self.
+000073b0: 6e70 6172 7469 7469 6f6e 730a 0a20 2020  npartitions..   
+000073c0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+000073d0: 6365 286f 6e2c 2046 7261 6d65 4261 7365  ce(on, FrameBase
+000073e0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+000073f0: 6620 6e6f 7420 6578 7072 2e61 7265 5f63  f not expr.are_c
+00007400: 6f5f 616c 6967 6e65 6428 7365 6c66 2e65  o_aligned(self.e
+00007410: 7870 722c 206f 6e2e 6578 7072 293a 0a20  xpr, on.expr):. 
+00007420: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00007430: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+00007440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007450: 2020 2020 2269 6e64 6578 206d 7573 7420      "index must 
+00007460: 6265 2061 6c69 676e 6564 2077 6974 6820  be aligned with 
+00007470: 7468 6520 4461 7461 4672 616d 6520 746f  the DataFrame to
+00007480: 2075 7365 2061 7320 7368 7566 666c 6520   use as shuffle 
+00007490: 696e 6465 782e 220a 2020 2020 2020 2020  index.".        
+000074a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000074b0: 2020 656c 6966 2070 642e 6170 692e 7479    elif pd.api.ty
+000074c0: 7065 732e 6973 5f6c 6973 745f 6c69 6b65  pes.is_list_like
+000074d0: 286f 6e29 2061 6e64 206e 6f74 2069 735f  (on) and not is_
+000074e0: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
+000074f0: 6f6e 293a 0a20 2020 2020 2020 2020 2020  on):.           
+00007500: 206f 6e20 3d20 6c69 7374 286f 6e29 0a0a   on = list(on)..
+00007510: 2020 2020 2020 2020 6966 2028 7368 7566          if (shuf
+00007520: 666c 655f 6d65 7468 6f64 206f 7220 6765  fle_method or ge
+00007530: 745f 6465 6661 756c 745f 7368 7566 666c  t_default_shuffl
+00007540: 655f 6d65 7468 6f64 2829 2920 3d3d 2022  e_method()) == "
+00007550: 7032 7022 3a0a 2020 2020 2020 2020 2020  p2p":.          
+00007560: 2020 6672 6f6d 2064 6973 7472 6962 7574    from distribut
+00007570: 6564 2e73 6875 6666 6c65 2e5f 6172 726f  ed.shuffle._arro
+00007580: 7720 696d 706f 7274 2063 6865 636b 5f64  w import check_d
+00007590: 7479 7065 5f73 7570 706f 7274 0a0a 2020  type_support..  
+000075a0: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+000075b0: 6474 7970 655f 7375 7070 6f72 7428 7365  dtype_support(se
+000075c0: 6c66 2e5f 6d65 7461 290a 0a20 2020 2020  lf._meta)..     
+000075d0: 2020 2020 2020 2069 6620 616e 7928 6e6f         if any(no
+000075e0: 7420 6973 696e 7374 616e 6365 2863 2c20  t isinstance(c, 
+000075f0: 7374 7229 2066 6f72 2063 2069 6e20 7365  str) for c in se
+00007600: 6c66 2e5f 6d65 7461 2e63 6f6c 756d 6e73  lf._meta.columns
+00007610: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00007620: 2020 2075 6e73 7570 706f 7274 6564 203d     unsupported =
+00007630: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00007640: 2020 2020 2020 2063 3a20 7479 7065 2863         c: type(c
+00007650: 2920 666f 7220 6320 696e 2073 656c 662e  ) for c in self.
+00007660: 5f6d 6574 612e 636f 6c75 6d6e 7320 6966  _meta.columns if
+00007670: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00007680: 632c 2073 7472 290a 2020 2020 2020 2020  c, str).        
+00007690: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+000076a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000076b0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+000076c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000076d0: 2270 3270 2072 6571 7569 7265 7320 616c  "p2p requires al
+000076e0: 6c20 636f 6c75 6d6e 206e 616d 6573 2074  l column names t
+000076f0: 6f20 6265 2073 7472 2c20 666f 756e 643a  o be str, found:
+00007700: 207b 756e 7375 7070 6f72 7465 647d 222c   {unsupported}",
+00007710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007720: 2029 0a0a 2020 2020 2020 2020 2320 5265   )..        # Re
+00007730: 7475 726e 6564 2073 6875 6666 6c65 6420  turned shuffled 
+00007740: 7265 7375 6c74 0a20 2020 2020 2020 2072  result.        r
+00007750: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00007760: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00007770: 2020 5265 6172 7261 6e67 6542 7943 6f6c    RearrangeByCol
+00007780: 756d 6e28 0a20 2020 2020 2020 2020 2020  umn(.           
+00007790: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000077a0: 2020 2020 2020 2020 2020 206f 6e2c 0a20             on,. 
+000077b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000077c0: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+000077d0: 2020 2020 2020 2020 2020 2020 6967 6e6f              igno
+000077e0: 7265 5f69 6e64 6578 2c0a 2020 2020 2020  re_index,.      
+000077f0: 2020 2020 2020 2020 2020 6765 745f 7370            get_sp
+00007800: 6563 6966 6965 645f 7368 7566 666c 6528  ecified_shuffle(
+00007810: 7368 7566 666c 655f 6d65 7468 6f64 292c  shuffle_method),
+00007820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007830: 206f 7074 696f 6e73 2c0a 2020 2020 2020   options,.      
+00007840: 2020 2020 2020 2020 2020 696e 6465 785f            index_
+00007850: 7368 7566 666c 653d 6f6e 5f69 6e64 6578  shuffle=on_index
+00007860: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00007870: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00007880: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00007890: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000078a0: 6566 2072 6573 616d 706c 6528 7365 6c66  ef resample(self
+000078b0: 2c20 7275 6c65 2c20 636c 6f73 6564 3d4e  , rule, closed=N
+000078c0: 6f6e 652c 206c 6162 656c 3d4e 6f6e 6529  one, label=None)
+000078d0: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
+000078e0: 6173 6b5f 6578 7072 2e5f 7265 7361 6d70  ask_expr._resamp
+000078f0: 6c65 2069 6d70 6f72 7420 5265 7361 6d70  le import Resamp
+00007900: 6c65 720a 0a20 2020 2020 2020 2072 6574  ler..        ret
+00007910: 7572 6e20 5265 7361 6d70 6c65 7228 7365  urn Resampler(se
+00007920: 6c66 2c20 7275 6c65 2c20 2a2a 7b22 636c  lf, rule, **{"cl
+00007930: 6f73 6564 223a 2063 6c6f 7365 642c 2022  osed": closed, "
+00007940: 6c61 6265 6c22 3a20 6c61 6265 6c7d 290a  label": label}).
+00007950: 0a20 2020 2064 6566 2072 6f6c 6c69 6e67  .    def rolling
+00007960: 2873 656c 662c 2077 696e 646f 772c 202a  (self, window, *
+00007970: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00007980: 2020 2222 2250 726f 7669 6465 7320 726f    """Provides ro
+00007990: 6c6c 696e 6720 7472 616e 7366 6f72 6d61  lling transforma
+000079a0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+000079b0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+000079c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000079d0: 2020 2020 2020 7769 6e64 6f77 203a 2069        window : i
+000079e0: 6e74 2c20 7374 722c 206f 6666 7365 740a  nt, str, offset.
+000079f0: 2020 2020 2020 2020 2020 2053 697a 6520             Size 
+00007a00: 6f66 2074 6865 206d 6f76 696e 6720 7769  of the moving wi
+00007a10: 6e64 6f77 2e20 5468 6973 2069 7320 7468  ndow. This is th
+00007a20: 6520 6e75 6d62 6572 206f 6620 6f62 7365  e number of obse
+00007a30: 7276 6174 696f 6e73 2075 7365 640a 2020  rvations used.  
+00007a40: 2020 2020 2020 2020 2066 6f72 2063 616c           for cal
+00007a50: 6375 6c61 7469 6e67 2074 6865 2073 7461  culating the sta
+00007a60: 7469 7374 6963 2e20 5768 656e 206e 6f74  tistic. When not
+00007a70: 2075 7369 6e67 2061 2060 6044 6174 6574   using a ``Datet
+00007a80: 696d 6549 6e64 6578 6060 2c0a 2020 2020  imeIndex``,.    
+00007a90: 2020 2020 2020 2074 6865 2077 696e 646f         the windo
+00007aa0: 7720 7369 7a65 206d 7573 7420 6e6f 7420  w size must not 
+00007ab0: 6265 2073 6f20 6c61 7267 6520 6173 2074  be so large as t
+00007ac0: 6f20 7370 616e 206d 6f72 6520 7468 616e  o span more than
+00007ad0: 206f 6e65 0a20 2020 2020 2020 2020 2020   one.           
+00007ae0: 6164 6a61 6365 6e74 2070 6172 7469 7469  adjacent partiti
+00007af0: 6f6e 2e20 4966 2075 7369 6e67 2061 6e20  on. If using an 
+00007b00: 6f66 6673 6574 206f 7220 6f66 6673 6574  offset or offset
+00007b10: 2061 6c69 6173 206c 696b 6520 2735 4427   alias like '5D'
+00007b20: 2c0a 2020 2020 2020 2020 2020 2074 6865  ,.           the
+00007b30: 2064 6174 6120 6d75 7374 2068 6176 6520   data must have 
+00007b40: 6120 6060 4461 7465 7469 6d65 496e 6465  a ``DatetimeInde
+00007b50: 7860 600a 2020 2020 2020 2020 6d69 6e5f  x``.        min_
+00007b60: 7065 7269 6f64 7320 3a20 696e 742c 2064  periods : int, d
+00007b70: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
+00007b80: 2020 2020 2020 2020 4d69 6e69 6d75 6d20          Minimum 
+00007b90: 6e75 6d62 6572 206f 6620 6f62 7365 7276  number of observ
+00007ba0: 6174 696f 6e73 2069 6e20 7769 6e64 6f77  ations in window
+00007bb0: 2072 6571 7569 7265 6420 746f 2068 6176   required to hav
+00007bc0: 6520 6120 7661 6c75 650a 2020 2020 2020  e a value.      
+00007bd0: 2020 2020 2020 286f 7468 6572 7769 7365        (otherwise
+00007be0: 2072 6573 756c 7420 6973 204e 4129 2e0a   result is NA)..
+00007bf0: 2020 2020 2020 2020 6365 6e74 6572 203a          center :
+00007c00: 2062 6f6f 6c65 616e 2c20 6465 6661 756c   boolean, defaul
+00007c10: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
+00007c20: 2020 2020 5365 7420 7468 6520 6c61 6265      Set the labe
+00007c30: 6c73 2061 7420 7468 6520 6365 6e74 6572  ls at the center
+00007c40: 206f 6620 7468 6520 7769 6e64 6f77 2e0a   of the window..
+00007c50: 2020 2020 2020 2020 7769 6e5f 7479 7065          win_type
+00007c60: 203a 2073 7472 696e 672c 2064 6566 6175   : string, defau
+00007c70: 6c74 204e 6f6e 650a 2020 2020 2020 2020  lt None.        
+00007c80: 2020 2020 5072 6f76 6964 6520 6120 7769      Provide a wi
+00007c90: 6e64 6f77 2074 7970 652e 2054 6865 2072  ndow type. The r
+00007ca0: 6563 6f67 6e69 7a65 6420 7769 6e64 6f77  ecognized window
+00007cb0: 2074 7970 6573 2061 7265 2069 6465 6e74   types are ident
+00007cc0: 6963 616c 0a20 2020 2020 2020 2020 2020  ical.           
+00007cd0: 2074 6f20 7061 6e64 6173 2e0a 2020 2020   to pandas..    
+00007ce0: 2020 2020 6178 6973 203a 2069 6e74 2c20      axis : int, 
+00007cf0: 7374 722c 204e 6f6e 652c 2064 6566 6175  str, None, defau
+00007d00: 6c74 2030 0a20 2020 2020 2020 2020 2020  lt 0.           
+00007d10: 2054 6869 7320 7061 7261 6d65 7465 7220   This parameter 
+00007d20: 6973 2064 6570 7265 6361 7465 6420 7769  is deprecated wi
+00007d30: 7468 2060 6070 616e 6461 733e 3d32 2e31  th ``pandas>=2.1
+00007d40: 6060 2e0a 0a20 2020 2020 2020 2052 6574  ``...        Ret
+00007d50: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00007d60: 2d2d 2d2d 0a20 2020 2020 2020 2061 2052  ----.        a R
+00007d70: 6f6c 6c69 6e67 206f 626a 6563 7420 6f6e  olling object on
+00007d80: 2077 6869 6368 2074 6f20 6361 6c6c 2061   which to call a
+00007d90: 206d 6574 686f 6420 746f 2063 6f6d 7075   method to compu
+00007da0: 7465 2061 2073 7461 7469 7374 6963 0a20  te a statistic. 
+00007db0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00007dc0: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
+00007dd0: 722e 5f72 6f6c 6c69 6e67 2069 6d70 6f72  r._rolling impor
+00007de0: 7420 526f 6c6c 696e 670a 0a20 2020 2020  t Rolling..     
+00007df0: 2020 2072 6574 7572 6e20 526f 6c6c 696e     return Rollin
+00007e00: 6728 7365 6c66 2c20 7769 6e64 6f77 2c20  g(self, window, 
+00007e10: 2a2a 6b77 6172 6773 290a 0a20 2020 2040  **kwargs)..    @
+00007e20: 696e 7365 7274 5f6d 6574 615f 7061 7261  insert_meta_para
+00007e30: 6d5f 6465 7363 7269 7074 696f 6e28 7061  m_description(pa
+00007e40: 643d 3132 290a 2020 2020 6465 6620 6d61  d=12).    def ma
+00007e50: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+00007e60: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00007e70: 2020 2020 6675 6e63 2c0a 2020 2020 2020      func,.      
+00007e80: 2020 2a61 7267 732c 0a20 2020 2020 2020    *args,.       
+00007e90: 206d 6574 613d 6e6f 5f64 6566 6175 6c74   meta=no_default
+00007ea0: 2c0a 2020 2020 2020 2020 656e 666f 7263  ,.        enforc
+00007eb0: 655f 6d65 7461 6461 7461 3d54 7275 652c  e_metadata=True,
+00007ec0: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
+00007ed0: 726d 5f64 6976 6973 696f 6e73 3d54 7275  rm_divisions=Tru
+00007ee0: 652c 0a20 2020 2020 2020 2063 6c65 6172  e,.        clear
+00007ef0: 5f64 6976 6973 696f 6e73 3d46 616c 7365  _divisions=False
+00007f00: 2c0a 2020 2020 2020 2020 616c 6967 6e5f  ,.        align_
+00007f10: 6461 7461 6672 616d 6573 3d46 616c 7365  dataframes=False
+00007f20: 2c0a 2020 2020 2020 2020 7061 7265 6e74  ,.        parent
+00007f30: 5f6d 6574 613d 4e6f 6e65 2c0a 2020 2020  _meta=None,.    
+00007f40: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
+00007f50: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00007f60: 4170 706c 7920 6120 5079 7468 6f6e 2066  Apply a Python f
+00007f70: 756e 6374 696f 6e20 746f 2065 6163 6820  unction to each 
+00007f80: 7061 7274 6974 696f 6e0a 0a20 2020 2020  partition..     
+00007f90: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00007fa0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00007fb0: 0a20 2020 2020 2020 2066 756e 6320 3a20  .        func : 
+00007fc0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00007fd0: 2020 2020 2046 756e 6374 696f 6e20 6170       Function ap
+00007fe0: 706c 6965 6420 746f 2065 6163 6820 7061  plied to each pa
+00007ff0: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
+00008000: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
+00008010: 2020 2020 2020 2020 2020 2020 4172 6775              Argu
+00008020: 6d65 6e74 7320 616e 6420 6b65 7977 6f72  ments and keywor
+00008030: 6473 2074 6f20 7061 7373 2074 6f20 7468  ds to pass to th
+00008040: 6520 6675 6e63 7469 6f6e 2e20 4172 6775  e function. Argu
+00008050: 6d65 6e74 7320 616e 640a 2020 2020 2020  ments and.      
+00008060: 2020 2020 2020 6b65 7977 6f72 6473 206d        keywords m
+00008070: 6179 2063 6f6e 7461 696e 2060 6046 7261  ay contain ``Fra
+00008080: 6d65 4261 7365 6060 206f 7220 7265 6775  meBase`` or regu
+00008090: 6c61 7220 7079 7468 6f6e 206f 626a 6563  lar python objec
+000080a0: 7473 2e0a 2020 2020 2020 2020 2020 2020  ts..            
+000080b0: 4461 7461 4672 616d 652d 6c69 6b65 2061  DataFrame-like a
+000080c0: 7267 7320 2862 6f74 6820 6461 736b 2061  rgs (both dask a
+000080d0: 6e64 2070 616e 6461 7329 206d 7573 7420  nd pandas) must 
+000080e0: 6861 7665 2074 6865 2073 616d 650a 2020  have the same.  
+000080f0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
+00008100: 206f 6620 7061 7274 6974 696f 6e73 2061   of partitions a
+00008110: 7320 6060 7365 6c66 6060 206f 7220 636f  s ``self`` or co
+00008120: 6d70 7269 7365 2061 2073 696e 676c 6520  mprise a single 
+00008130: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+00008140: 2020 2020 2020 204b 6579 2d77 6f72 6420         Key-word 
+00008150: 6172 6775 6d65 6e74 732c 2053 696e 676c  arguments, Singl
+00008160: 652d 7061 7274 6974 696f 6e20 6172 6775  e-partition argu
+00008170: 6d65 6e74 732c 2061 6e64 2067 656e 6572  ments, and gener
+00008180: 616c 0a20 2020 2020 2020 2020 2020 2070  al.            p
+00008190: 7974 686f 6e2d 6f62 6a65 6374 2061 7267  ython-object arg
+000081a0: 756d 656e 7473 2077 696c 6c20 6265 2062  uments will be b
+000081b0: 726f 6164 6361 7374 6564 2074 6f20 616c  roadcasted to al
+000081c0: 6c20 7061 7274 6974 696f 6e73 2e0a 2020  l partitions..  
+000081d0: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+000081e0: 7461 6461 7461 203a 2062 6f6f 6c2c 2064  tadata : bool, d
+000081f0: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
+00008200: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
+00008210: 746f 2065 6e66 6f72 6365 2061 7420 7275  to enforce at ru
+00008220: 6e74 696d 6520 7468 6174 2074 6865 2073  ntime that the s
+00008230: 7472 7563 7475 7265 206f 6620 7468 6520  tructure of the 
+00008240: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+00008250: 2020 2020 2020 7072 6f64 7563 6564 2062        produced b
+00008260: 7920 6060 6675 6e63 6060 2061 6374 7561  y ``func`` actua
+00008270: 6c6c 7920 6d61 7463 6865 7320 7468 6520  lly matches the 
+00008280: 7374 7275 6374 7572 6520 6f66 2060 606d  structure of ``m
+00008290: 6574 6160 602e 0a20 2020 2020 2020 2020  eta``..         
+000082a0: 2020 2054 6869 7320 7769 6c6c 2072 656e     This will ren
+000082b0: 616d 6520 616e 6420 7265 6f72 6465 7220  ame and reorder 
+000082c0: 636f 6c75 6d6e 7320 666f 7220 6561 6368  columns for each
+000082d0: 2070 6172 7469 7469 6f6e 2c20 616e 6420   partition, and 
+000082e0: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+000082f0: 2072 6169 7365 2061 6e20 6572 726f 7220   raise an error 
+00008300: 6966 2074 6869 7320 646f 6573 6e27 7420  if this doesn't 
+00008310: 776f 726b 2c20 6275 7420 6974 2077 6f6e  work, but it won
+00008320: 2774 2072 6169 7365 2069 6620 6474 7970  't raise if dtyp
+00008330: 6573 0a20 2020 2020 2020 2020 2020 2064  es.            d
+00008340: 6f6e 2774 206d 6174 6368 2e0a 2020 2020  on't match..    
+00008350: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
+00008360: 7669 7369 6f6e 7320 3a20 626f 6f6c 2c20  visions : bool, 
+00008370: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
+00008380: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+00008390: 2074 6f20 6170 706c 7920 7468 6520 6675   to apply the fu
+000083a0: 6e63 7469 6f6e 206f 6e74 6f20 7468 6520  nction onto the 
+000083b0: 6469 7669 7369 6f6e 7320 616e 6420 6170  divisions and ap
+000083c0: 706c 7920 7468 6f73 650a 2020 2020 2020  ply those.      
+000083d0: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
+000083e0: 6420 6469 7669 7369 6f6e 7320 746f 2074  d divisions to t
+000083f0: 6865 206f 7574 7075 742e 0a20 2020 2020  he output..     
+00008400: 2020 2063 6c65 6172 5f64 6976 6973 696f     clear_divisio
+00008410: 6e73 203a 2062 6f6f 6c2c 2064 6566 6175  ns : bool, defau
+00008420: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
+00008430: 2020 2020 2057 6865 7468 6572 2064 6976       Whether div
+00008440: 6973 696f 6e73 2073 686f 756c 6420 6265  isions should be
+00008450: 2063 6c65 6172 6564 2e20 4966 2054 7275   cleared. If Tru
+00008460: 652c 2060 7472 616e 7366 6f72 6d5f 6469  e, `transform_di
+00008470: 7669 7369 6f6e 7360 0a20 2020 2020 2020  visions`.       
+00008480: 2020 2020 2077 696c 6c20 6265 2069 676e       will be ign
+00008490: 6f72 6564 2e0a 2020 2020 2020 2020 244d  ored..        $M
+000084a0: 4554 410a 0a20 2020 2020 2020 2045 7861  ETA..        Exa
+000084b0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+000084c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2047  ------.        G
+000084d0: 6976 656e 2061 2044 6174 6146 7261 6d65  iven a DataFrame
+000084e0: 2c20 5365 7269 6573 2c20 6f72 2049 6e64  , Series, or Ind
+000084f0: 6578 2c20 7375 6368 2061 733a 0a0a 2020  ex, such as:..  
+00008500: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00008510: 2070 616e 6461 7320 6173 2070 640a 2020   pandas as pd.  
+00008520: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00008530: 2064 6173 6b5f 6578 7072 2061 7320 6464   dask_expr as dd
+00008540: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00008550: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+00008560: 2778 273a 205b 312c 2032 2c20 332c 2034  'x': [1, 2, 3, 4
+00008570: 2c20 355d 2c0a 2020 2020 2020 2020 2e2e  , 5],.        ..
+00008580: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+00008590: 2020 2020 2027 7927 3a20 5b31 2e2c 2032       'y': [1., 2
+000085a0: 2e2c 2033 2e2c 2034 2e2c 2035 2e5d 7d29  ., 3., 4., 5.]})
+000085b0: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+000085c0: 203d 2064 642e 6672 6f6d 5f70 616e 6461   = dd.from_panda
+000085d0: 7328 6466 2c20 6e70 6172 7469 7469 6f6e  s(df, npartition
+000085e0: 733d 3229 0a0a 2020 2020 2020 2020 4f6e  s=2)..        On
+000085f0: 6520 6361 6e20 7573 6520 6060 6d61 705f  e can use ``map_
+00008600: 7061 7274 6974 696f 6e73 6060 2074 6f20  partitions`` to 
+00008610: 6170 706c 7920 6120 6675 6e63 7469 6f6e  apply a function
+00008620: 206f 6e20 6561 6368 2070 6172 7469 7469   on each partiti
+00008630: 6f6e 2e0a 2020 2020 2020 2020 4578 7472  on..        Extr
+00008640: 6120 6172 6775 6d65 6e74 7320 616e 6420  a arguments and 
+00008650: 6b65 7977 6f72 6473 2063 616e 206f 7074  keywords can opt
+00008660: 696f 6e61 6c6c 7920 6265 2070 726f 7669  ionally be provi
+00008670: 6465 642c 2061 6e64 2077 696c 6c20 6265  ded, and will be
+00008680: 0a20 2020 2020 2020 2070 6173 7365 6420  .        passed 
+00008690: 746f 2074 6865 2066 756e 6374 696f 6e20  to the function 
+000086a0: 6166 7465 7220 7468 6520 7061 7274 6974  after the partit
+000086b0: 696f 6e2e 0a0a 2020 2020 2020 2020 4865  ion...        He
+000086c0: 7265 2077 6520 6170 706c 7920 6120 6675  re we apply a fu
+000086d0: 6e63 7469 6f6e 2077 6974 6820 6172 6775  nction with argu
+000086e0: 6d65 6e74 7320 616e 6420 6b65 7977 6f72  ments and keywor
+000086f0: 6473 2074 6f20 6120 4461 7461 4672 616d  ds to a DataFram
+00008700: 652c 0a20 2020 2020 2020 2072 6573 756c  e,.        resul
+00008710: 7469 6e67 2069 6e20 6120 5365 7269 6573  ting in a Series
+00008720: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00008730: 6566 206d 7961 6464 2864 662c 2061 2c20  ef myadd(df, a, 
+00008740: 623d 3129 3a0a 2020 2020 2020 2020 2e2e  b=1):.        ..
+00008750: 2e20 2020 2020 7265 7475 726e 2064 662e  .     return df.
+00008760: 7820 2b20 6466 2e79 202b 2061 202b 2062  x + df.y + a + b
+00008770: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00008780: 203d 2064 6466 2e6d 6170 5f70 6172 7469   = ddf.map_parti
+00008790: 7469 6f6e 7328 6d79 6164 642c 2031 2c20  tions(myadd, 1, 
+000087a0: 623d 3229 0a20 2020 2020 2020 203e 3e3e  b=2).        >>>
+000087b0: 2072 6573 2e64 7479 7065 0a20 2020 2020   res.dtype.     
+000087c0: 2020 2064 7479 7065 2827 666c 6f61 7436     dtype('float6
+000087d0: 3427 290a 0a20 2020 2020 2020 2048 6572  4')..        Her
+000087e0: 6520 7765 2061 7070 6c79 2061 2066 756e  e we apply a fun
+000087f0: 6374 696f 6e20 746f 2061 2053 6572 6965  ction to a Serie
+00008800: 7320 7265 7375 6c74 696e 6720 696e 2061  s resulting in a
+00008810: 2053 6572 6965 733a 0a0a 2020 2020 2020   Series:..      
+00008820: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
+00008830: 782e 6d61 705f 7061 7274 6974 696f 6e73  x.map_partitions
+00008840: 286c 616d 6264 6120 783a 206c 656e 2878  (lambda x: len(x
+00008850: 2929 2023 2064 6466 2e78 2069 7320 6120  )) # ddf.x is a 
+00008860: 4461 736b 2053 6572 6965 7320 5374 7275  Dask Series Stru
+00008870: 6374 7572 650a 2020 2020 2020 2020 3e3e  cture.        >>
+00008880: 3e20 7265 732e 6474 7970 650a 2020 2020  > res.dtype.    
+00008890: 2020 2020 6474 7970 6528 2769 6e74 3634      dtype('int64
+000088a0: 2729 0a0a 2020 2020 2020 2020 4279 2064  ')..        By d
+000088b0: 6566 6175 6c74 2c20 6461 736b 2074 7269  efault, dask tri
+000088c0: 6573 2074 6f20 696e 6665 7220 7468 6520  es to infer the 
+000088d0: 6f75 7470 7574 206d 6574 6164 6174 6120  output metadata 
+000088e0: 6279 2072 756e 6e69 6e67 2079 6f75 720a  by running your.
+000088f0: 2020 2020 2020 2020 7072 6f76 6964 6564          provided
+00008900: 2066 756e 6374 696f 6e20 6f6e 2073 6f6d   function on som
+00008910: 6520 6661 6b65 2064 6174 612e 2054 6869  e fake data. Thi
+00008920: 7320 776f 726b 7320 7765 6c6c 2069 6e20  s works well in 
+00008930: 6d61 6e79 2063 6173 6573 2c20 6275 740a  many cases, but.
+00008940: 2020 2020 2020 2020 6361 6e20 736f 6d65          can some
+00008950: 7469 6d65 7320 6265 2065 7870 656e 7369  times be expensi
+00008960: 7665 2c20 6f72 2065 7665 6e20 6661 696c  ve, or even fail
+00008970: 2e20 546f 2061 766f 6964 2074 6869 732c  . To avoid this,
+00008980: 2079 6f75 2063 616e 0a20 2020 2020 2020   you can.       
+00008990: 206d 616e 7561 6c6c 7920 7370 6563 6966   manually specif
+000089a0: 7920 7468 6520 6f75 7470 7574 206d 6574  y the output met
+000089b0: 6164 6174 6120 7769 7468 2074 6865 2060  adata with the `
+000089c0: 606d 6574 6160 6020 6b65 7977 6f72 642e  `meta`` keyword.
+000089d0: 2054 6869 730a 2020 2020 2020 2020 6361   This.        ca
+000089e0: 6e20 6265 2073 7065 6369 6669 6564 2069  n be specified i
+000089f0: 6e20 6d61 6e79 2066 6f72 6d73 2c20 666f  n many forms, fo
+00008a00: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+00008a10: 6f6e 2073 6565 0a20 2020 2020 2020 2060  on see.        `
+00008a20: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+00008a30: 7574 696c 732e 6d61 6b65 5f6d 6574 6160  utils.make_meta`
+00008a40: 602e 0a0a 2020 2020 2020 2020 4865 7265  `...        Here
+00008a50: 2077 6520 7370 6563 6966 7920 7468 6520   we specify the 
+00008a60: 6f75 7470 7574 2069 7320 6120 5365 7269  output is a Seri
+00008a70: 6573 2077 6974 6820 6e6f 206e 616d 652c  es with no name,
+00008a80: 2061 6e64 2064 7479 7065 0a20 2020 2020   and dtype.     
+00008a90: 2020 2060 6066 6c6f 6174 3634 6060 3a0a     ``float64``:.
+00008aa0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00008ab0: 203d 2064 6466 2e6d 6170 5f70 6172 7469   = ddf.map_parti
+00008ac0: 7469 6f6e 7328 6d79 6164 642c 2031 2c20  tions(myadd, 1, 
+00008ad0: 623d 322c 206d 6574 613d 284e 6f6e 652c  b=2, meta=(None,
+00008ae0: 2027 6638 2729 290a 0a20 2020 2020 2020   'f8'))..       
+00008af0: 2048 6572 6520 7765 206d 6170 2061 2066   Here we map a f
+00008b00: 756e 6374 696f 6e20 7468 6174 2074 616b  unction that tak
+00008b10: 6573 2069 6e20 6120 4461 7461 4672 616d  es in a DataFram
+00008b20: 652c 2061 6e64 2072 6574 7572 6e73 2061  e, and returns a
+00008b30: 0a20 2020 2020 2020 2044 6174 6146 7261  .        DataFra
+00008b40: 6d65 2077 6974 6820 6120 6e65 7720 636f  me with a new co
+00008b50: 6c75 6d6e 3a0a 0a20 2020 2020 2020 203e  lumn:..        >
+00008b60: 3e3e 2072 6573 203d 2064 6466 2e6d 6170  >> res = ddf.map
+00008b70: 5f70 6172 7469 7469 6f6e 7328 6c61 6d62  _partitions(lamb
+00008b80: 6461 2064 663a 2064 662e 6173 7369 676e  da df: df.assign
+00008b90: 287a 3d64 662e 7820 2a20 6466 2e79 2929  (z=df.x * df.y))
+00008ba0: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00008bb0: 2e64 7479 7065 730a 2020 2020 2020 2020  .dtypes.        
+00008bc0: 7820 2020 2020 2069 6e74 3634 0a20 2020  x      int64.   
+00008bd0: 2020 2020 2079 2020 2020 666c 6f61 7436       y    float6
+00008be0: 340a 2020 2020 2020 2020 7a20 2020 2066  4.        z    f
+00008bf0: 6c6f 6174 3634 0a20 2020 2020 2020 2064  loat64.        d
+00008c00: 7479 7065 3a20 6f62 6a65 6374 0a0a 2020  type: object..  
+00008c10: 2020 2020 2020 4173 2062 6566 6f72 652c        As before,
+00008c20: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
+00008c30: 6461 7461 2063 616e 2061 6c73 6f20 6265  data can also be
+00008c40: 2073 7065 6369 6669 6564 206d 616e 7561   specified manua
+00008c50: 6c6c 792e 2054 6869 730a 2020 2020 2020  lly. This.      
+00008c60: 2020 7469 6d65 2077 6520 7061 7373 2069    time we pass i
+00008c70: 6e20 6120 6060 6469 6374 6060 2c20 6173  n a ``dict``, as
+00008c80: 2074 6865 206f 7574 7075 7420 6973 2061   the output is a
+00008c90: 2044 6174 6146 7261 6d65 3a0a 0a20 2020   DataFrame:..   
+00008ca0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
+00008cb0: 6466 2e6d 6170 5f70 6172 7469 7469 6f6e  df.map_partition
+00008cc0: 7328 6c61 6d62 6461 2064 663a 2064 662e  s(lambda df: df.
+00008cd0: 6173 7369 676e 287a 3d64 662e 7820 2a20  assign(z=df.x * 
+00008ce0: 6466 2e79 292c 0a20 2020 2020 2020 202e  df.y),.        .
+00008cf0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00008d00: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00008d10: 3d7b 2778 273a 2027 6938 272c 2027 7927  ={'x': 'i8', 'y'
+00008d20: 3a20 2766 3827 2c20 277a 273a 2027 6638  : 'f8', 'z': 'f8
+00008d30: 277d 290a 0a20 2020 2020 2020 2049 6e20  '})..        In 
+00008d40: 7468 6520 6361 7365 2077 6865 7265 2074  the case where t
+00008d50: 6865 206d 6574 6164 6174 6120 646f 6573  he metadata does
+00008d60: 6e27 7420 6368 616e 6765 2c20 796f 7520  n't change, you 
+00008d70: 6361 6e20 616c 736f 2070 6173 7320 696e  can also pass in
+00008d80: 0a20 2020 2020 2020 2074 6865 206f 626a  .        the obj
+00008d90: 6563 7420 6974 7365 6c66 2064 6972 6563  ect itself direc
+00008da0: 746c 793a 0a0a 2020 2020 2020 2020 3e3e  tly:..        >>
+00008db0: 3e20 7265 7320 3d20 6464 662e 6d61 705f  > res = ddf.map_
+00008dc0: 7061 7274 6974 696f 6e73 286c 616d 6264  partitions(lambd
+00008dd0: 6120 6466 3a20 6466 2e68 6561 6428 292c  a df: df.head(),
+00008de0: 206d 6574 613d 6464 6629 0a0a 2020 2020   meta=ddf)..    
+00008df0: 2020 2020 416c 736f 206e 6f74 6520 7468      Also note th
+00008e00: 6174 2074 6865 2069 6e64 6578 2061 6e64  at the index and
+00008e10: 2064 6976 6973 696f 6e73 2061 7265 2061   divisions are a
+00008e20: 7373 756d 6564 2074 6f20 7265 6d61 696e  ssumed to remain
+00008e30: 2075 6e63 6861 6e67 6564 2e0a 2020 2020   unchanged..    
+00008e40: 2020 2020 4966 2074 6865 2066 756e 6374      If the funct
+00008e50: 696f 6e20 796f 7527 7265 206d 6170 7069  ion you're mappi
+00008e60: 6e67 2063 6861 6e67 6573 2074 6865 2069  ng changes the i
+00008e70: 6e64 6578 2f64 6976 6973 696f 6e73 2c20  ndex/divisions, 
+00008e80: 796f 7527 6c6c 206e 6565 640a 2020 2020  you'll need.    
+00008e90: 2020 2020 746f 2070 6173 7320 6060 636c      to pass ``cl
+00008ea0: 6561 725f 6469 7669 7369 6f6e 733d 5472  ear_divisions=Tr
+00008eb0: 7565 6060 2e0a 0a20 2020 2020 2020 203e  ue``...        >
+00008ec0: 3e3e 2064 6466 2e6d 6170 5f70 6172 7469  >> ddf.map_parti
+00008ed0: 7469 6f6e 7328 6675 6e63 2c20 636c 6561  tions(func, clea
+00008ee0: 725f 6469 7669 7369 6f6e 733d 5472 7565  r_divisions=True
+00008ef0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00008f00: 4b49 500a 0a20 2020 2020 2020 2059 6f75  KIP..        You
+00008f10: 7220 6d61 7020 6675 6e63 7469 6f6e 2067  r map function g
+00008f20: 6574 7320 696e 666f 726d 6174 696f 6e20  ets information 
+00008f30: 6162 6f75 7420 7768 6572 6520 6974 2069  about where it i
+00008f40: 7320 696e 2074 6865 2064 6174 6166 7261  s in the datafra
+00008f50: 6d65 2062 790a 2020 2020 2020 2020 6163  me by.        ac
+00008f60: 6365 7074 696e 6720 6120 7370 6563 6961  cepting a specia
+00008f70: 6c20 6060 7061 7274 6974 696f 6e5f 696e  l ``partition_in
+00008f80: 666f 6060 206b 6579 776f 7264 2061 7267  fo`` keyword arg
+00008f90: 756d 656e 742e 0a0a 2020 2020 2020 2020  ument...        
+00008fa0: 3e3e 3e20 6465 6620 6675 6e63 2870 6172  >>> def func(par
+00008fb0: 7469 7469 6f6e 2c20 7061 7274 6974 696f  tition, partitio
+00008fc0: 6e5f 696e 666f 3d4e 6f6e 6529 3a0a 2020  n_info=None):.  
+00008fd0: 2020 2020 2020 2e2e 2e20 2020 2020 7061        ...     pa
+00008fe0: 7373 0a0a 2020 2020 2020 2020 5468 6973  ss..        This
+00008ff0: 2077 696c 6c20 7265 6365 6976 6520 7468   will receive th
+00009000: 6520 666f 6c6c 6f77 696e 6720 696e 666f  e following info
+00009010: 726d 6174 696f 6e3a 0a0a 2020 2020 2020  rmation:..      
+00009020: 2020 3e3e 3e20 7061 7274 6974 696f 6e5f    >>> partition_
+00009030: 696e 666f 2020 2320 646f 6374 6573 743a  info  # doctest:
+00009040: 202b 534b 4950 0a20 2020 2020 2020 207b   +SKIP.        {
+00009050: 276e 756d 6265 7227 3a20 312c 2027 6469  'number': 1, 'di
+00009060: 7669 7369 6f6e 273a 2033 7d0a 0a20 2020  vision': 3}..   
+00009070: 2020 2020 2046 6f72 2065 6163 6820 6172       For each ar
+00009080: 6775 6d65 6e74 2061 6e64 206b 6579 776f  gument and keywo
+00009090: 7264 2061 7267 756d 656e 7473 2074 6861  rd arguments tha
+000090a0: 7420 6172 6520 6461 736b 2064 6174 6166  t are dask dataf
+000090b0: 7261 6d65 7320 796f 7520 7769 6c6c 0a20  rames you will. 
+000090c0: 2020 2020 2020 2072 6563 6569 7665 2074         receive t
+000090d0: 6865 206e 756d 6265 7220 286e 2920 7768  he number (n) wh
+000090e0: 6963 6820 7265 7072 6573 656e 7473 2074  ich represents t
+000090f0: 6865 206e 7468 2070 6172 7469 7469 6f6e  he nth partition
+00009100: 206f 6620 7468 6520 6461 7461 6672 616d   of the datafram
+00009110: 650a 2020 2020 2020 2020 616e 6420 7468  e.        and th
+00009120: 6520 6469 7669 7369 6f6e 2028 7468 6520  e division (the 
+00009130: 6669 7273 7420 696e 6465 7820 7661 6c75  first index valu
+00009140: 6520 696e 2074 6865 2070 6172 7469 7469  e in the partiti
+00009150: 6f6e 292e 2049 6620 6469 7669 7369 6f6e  on). If division
+00009160: 730a 2020 2020 2020 2020 6172 6520 6e6f  s.        are no
+00009170: 7420 6b6e 6f77 6e20 2866 6f72 2069 6e73  t known (for ins
+00009180: 7461 6e63 6520 6966 2074 6865 2069 6e64  tance if the ind
+00009190: 6578 2069 7320 6e6f 7420 736f 7274 6564  ex is not sorted
+000091a0: 2920 7468 656e 2079 6f75 2077 696c 6c20  ) then you will 
+000091b0: 6765 740a 2020 2020 2020 2020 4e6f 6e65  get.        None
+000091c0: 2061 7320 7468 6520 6469 7669 7369 6f6e   as the division
+000091d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+000091e0: 2020 2020 2020 7265 7475 726e 206d 6170        return map
+000091f0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+00009200: 2020 2020 2020 2020 2066 756e 632c 0a20           func,. 
+00009210: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00009220: 0a20 2020 2020 2020 2020 2020 202a 6172  .            *ar
+00009230: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00009240: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+00009250: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+00009260: 6574 6164 6174 613d 656e 666f 7263 655f  etadata=enforce_
+00009270: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00009280: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00009290: 6469 7669 7369 6f6e 733d 7472 616e 7366  divisions=transf
+000092a0: 6f72 6d5f 6469 7669 7369 6f6e 732c 0a20  orm_divisions,. 
+000092b0: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
+000092c0: 5f64 6976 6973 696f 6e73 3d63 6c65 6172  _divisions=clear
+000092d0: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
+000092e0: 2020 2020 2020 2020 616c 6967 6e5f 6461          align_da
+000092f0: 7461 6672 616d 6573 3d61 6c69 676e 5f64  taframes=align_d
+00009300: 6174 6166 7261 6d65 732c 0a20 2020 2020  ataframes,.     
+00009310: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
+00009320: 7461 3d70 6172 656e 745f 6d65 7461 2c0a  ta=parent_meta,.
+00009330: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+00009340: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
+00009350: 0a20 2020 2040 696e 7365 7274 5f6d 6574  .    @insert_met
+00009360: 615f 7061 7261 6d5f 6465 7363 7269 7074  a_param_descript
+00009370: 696f 6e28 7061 643d 3132 290a 2020 2020  ion(pad=12).    
+00009380: 6465 6620 6d61 705f 6f76 6572 6c61 7028  def map_overlap(
+00009390: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000093a0: 2020 2020 2020 2066 756e 632c 0a20 2020         func,.   
+000093b0: 2020 2020 2062 6566 6f72 652c 0a20 2020       before,.   
+000093c0: 2020 2020 2061 6674 6572 2c0a 2020 2020       after,.    
+000093d0: 2020 2020 2a61 7267 732c 0a20 2020 2020      *args,.     
+000093e0: 2020 206d 6574 613d 6e6f 5f64 6566 6175     meta=no_defau
+000093f0: 6c74 2c0a 2020 2020 2020 2020 656e 666f  lt,.        enfo
+00009400: 7263 655f 6d65 7461 6461 7461 3d54 7275  rce_metadata=Tru
+00009410: 652c 0a20 2020 2020 2020 2074 7261 6e73  e,.        trans
+00009420: 666f 726d 5f64 6976 6973 696f 6e73 3d54  form_divisions=T
+00009430: 7275 652c 0a20 2020 2020 2020 2063 6c65  rue,.        cle
+00009440: 6172 5f64 6976 6973 696f 6e73 3d46 616c  ar_divisions=Fal
+00009450: 7365 2c0a 2020 2020 2020 2020 616c 6967  se,.        alig
+00009460: 6e5f 6461 7461 6672 616d 6573 3d46 616c  n_dataframes=Fal
+00009470: 7365 2c0a 2020 2020 2020 2020 2a2a 6b77  se,.        **kw
+00009480: 6172 6773 2c0a 2020 2020 293a 0a20 2020  args,.    ):.   
+00009490: 2020 2020 2022 2222 4170 706c 7920 6120       """Apply a 
+000094a0: 6675 6e63 7469 6f6e 2074 6f20 6561 6368  function to each
+000094b0: 2070 6172 7469 7469 6f6e 2c20 7368 6172   partition, shar
+000094c0: 696e 6720 726f 7773 2077 6974 6820 6164  ing rows with ad
+000094d0: 6a61 6365 6e74 2070 6172 7469 7469 6f6e  jacent partition
+000094e0: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
+000094f0: 2063 616e 2062 6520 7573 6566 756c 2066   can be useful f
+00009500: 6f72 2069 6d70 6c65 6d65 6e74 696e 6720  or implementing 
+00009510: 7769 6e64 6f77 696e 6720 6675 6e63 7469  windowing functi
+00009520: 6f6e 7320 7375 6368 2061 730a 2020 2020  ons such as.    
+00009530: 2020 2020 6060 6466 2e72 6f6c 6c69 6e67      ``df.rolling
+00009540: 282e 2e2e 292e 6d65 616e 2829 6060 206f  (...).mean()`` o
+00009550: 7220 6060 6466 2e64 6966 6628 2960 602e  r ``df.diff()``.
+00009560: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00009570: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00009580: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00009590: 6675 6e63 203a 2066 756e 6374 696f 6e0a  func : function.
+000095a0: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
+000095b0: 7469 6f6e 2061 7070 6c69 6564 2074 6f20  tion applied to 
+000095c0: 6561 6368 2070 6172 7469 7469 6f6e 2e0a  each partition..
+000095d0: 2020 2020 2020 2020 6265 666f 7265 203a          before :
+000095e0: 2069 6e74 2c20 7469 6d65 6465 6c74 6120   int, timedelta 
+000095f0: 6f72 2073 7472 696e 6720 7469 6d65 6465  or string timede
+00009600: 6c74 610a 2020 2020 2020 2020 2020 2020  lta.            
+00009610: 5468 6520 726f 7773 2074 6f20 7072 6570  The rows to prep
+00009620: 656e 6420 746f 2070 6172 7469 7469 6f6e  end to partition
+00009630: 2060 6069 6060 2066 726f 6d20 7468 6520   ``i`` from the 
+00009640: 656e 6420 6f66 0a20 2020 2020 2020 2020  end of.         
+00009650: 2020 2070 6172 7469 7469 6f6e 2060 6069     partition ``i
+00009660: 202d 2031 6060 2e0a 2020 2020 2020 2020   - 1``..        
+00009670: 6166 7465 7220 3a20 696e 742c 2074 696d  after : int, tim
+00009680: 6564 656c 7461 206f 7220 7374 7269 6e67  edelta or string
+00009690: 2074 696d 6564 656c 7461 0a20 2020 2020   timedelta.     
+000096a0: 2020 2020 2020 2054 6865 2072 6f77 7320         The rows 
+000096b0: 746f 2061 7070 656e 6420 746f 2070 6172  to append to par
+000096c0: 7469 7469 6f6e 2060 6069 6060 2066 726f  tition ``i`` fro
+000096d0: 6d20 7468 6520 6265 6769 6e6e 696e 670a  m the beginning.
+000096e0: 2020 2020 2020 2020 2020 2020 6f66 2070              of p
+000096f0: 6172 7469 7469 6f6e 2060 6069 202b 2031  artition ``i + 1
+00009700: 6060 2e0a 2020 2020 2020 2020 6172 6773  ``..        args
+00009710: 2c20 6b77 6172 6773 203a 0a20 2020 2020  , kwargs :.     
+00009720: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
+00009730: 6c20 616e 6420 6b65 7977 6f72 6420 6172  l and keyword ar
+00009740: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00009750: 746f 2074 6865 2066 756e 6374 696f 6e2e  to the function.
+00009760: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
+00009770: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+00009780: 7320 6172 6520 636f 6d70 7574 6564 206f  s are computed o
+00009790: 6e20 6120 7065 722d 7061 7274 6974 696f  n a per-partitio
+000097a0: 6e20 6261 7369 732c 2077 6869 6c65 0a20  n basis, while. 
+000097b0: 2020 2020 2020 2020 2020 206b 6579 776f             keywo
+000097c0: 7264 2061 7267 756d 656e 7473 2061 7265  rd arguments are
+000097d0: 2073 6861 7265 6420 6163 726f 7373 2061   shared across a
+000097e0: 6c6c 2070 6172 7469 7469 6f6e 732e 2054  ll partitions. T
+000097f0: 6865 2070 6172 7469 7469 6f6e 0a20 2020  he partition.   
+00009800: 2020 2020 2020 2020 2069 7473 656c 6620           itself 
+00009810: 7769 6c6c 2062 6520 7468 6520 6669 7273  will be the firs
+00009820: 7420 706f 7369 7469 6f6e 616c 2061 7267  t positional arg
+00009830: 756d 656e 742c 2077 6974 6820 616c 6c20  ument, with all 
+00009840: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
+00009850: 2020 6172 6775 6d65 6e74 7320 7061 7373    arguments pass
+00009860: 6564 202a 6166 7465 722a 2e20 4172 6775  ed *after*. Argu
+00009870: 6d65 6e74 7320 6361 6e20 6265 2060 6053  ments can be ``S
+00009880: 6361 6c61 7260 602c 2060 6044 656c 6179  calar``, ``Delay
+00009890: 6564 6060 2c0a 2020 2020 2020 2020 2020  ed``,.          
+000098a0: 2020 6f72 2072 6567 756c 6172 2050 7974    or regular Pyt
+000098b0: 686f 6e20 6f62 6a65 6374 732e 2044 6174  hon objects. Dat
+000098c0: 6146 7261 6d65 2d6c 696b 6520 6172 6773  aFrame-like args
+000098d0: 2028 626f 7468 2064 6173 6b20 616e 640a   (both dask and.
+000098e0: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
+000098f0: 6173 2920 7769 6c6c 2062 6520 7265 7061  as) will be repa
+00009900: 7274 6974 696f 6e65 6420 746f 2061 6c69  rtitioned to ali
+00009910: 676e 2028 6966 206e 6563 6573 7361 7279  gn (if necessary
+00009920: 2920 6265 666f 7265 0a20 2020 2020 2020  ) before.       
+00009930: 2020 2020 2061 7070 6c79 696e 6720 7468       applying th
+00009940: 6520 6675 6e63 7469 6f6e 3b20 7365 6520  e function; see 
+00009950: 6060 616c 6967 6e5f 6461 7461 6672 616d  ``align_datafram
+00009960: 6573 6060 2074 6f20 636f 6e74 726f 6c20  es`` to control 
+00009970: 7468 6973 0a20 2020 2020 2020 2020 2020  this.           
+00009980: 2062 6568 6176 696f 722e 0a20 2020 2020   behavior..     
+00009990: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+000099a0: 6174 6120 3a20 626f 6f6c 2c20 6465 6661  ata : bool, defa
+000099b0: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
+000099c0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+000099d0: 656e 666f 7263 6520 6174 2072 756e 7469  enforce at runti
+000099e0: 6d65 2074 6861 7420 7468 6520 7374 7275  me that the stru
+000099f0: 6374 7572 6520 6f66 2074 6865 2044 6174  cture of the Dat
+00009a00: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
+00009a10: 2020 2070 726f 6475 6365 6420 6279 2060     produced by `
+00009a20: 6066 756e 6360 6020 6163 7475 616c 6c79  `func`` actually
+00009a30: 206d 6174 6368 6573 2074 6865 2073 7472   matches the str
+00009a40: 7563 7475 7265 206f 6620 6060 6d65 7461  ucture of ``meta
+00009a50: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+00009a60: 5468 6973 2077 696c 6c20 7265 6e61 6d65  This will rename
+00009a70: 2061 6e64 2072 656f 7264 6572 2063 6f6c   and reorder col
+00009a80: 756d 6e73 2066 6f72 2065 6163 6820 7061  umns for each pa
+00009a90: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
+00009aa0: 2020 2020 2061 6e64 2077 696c 6c20 7261       and will ra
+00009ab0: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+00009ac0: 7468 6973 2064 6f65 736e 2774 2077 6f72  this doesn't wor
+00009ad0: 6b2c 0a20 2020 2020 2020 2020 2020 2062  k,.            b
+00009ae0: 7574 2069 7420 776f 6e27 7420 7261 6973  ut it won't rais
+00009af0: 6520 6966 2064 7479 7065 7320 646f 6e27  e if dtypes don'
+00009b00: 7420 6d61 7463 682e 0a20 2020 2020 2020  t match..       
+00009b10: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+00009b20: 696f 6e73 203a 2062 6f6f 6c2c 2064 6566  ions : bool, def
+00009b30: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
+00009b40: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+00009b50: 2061 7070 6c79 2074 6865 2066 756e 6374   apply the funct
+00009b60: 696f 6e20 6f6e 746f 2074 6865 2064 6976  ion onto the div
+00009b70: 6973 696f 6e73 2061 6e64 2061 7070 6c79  isions and apply
+00009b80: 2074 686f 7365 0a20 2020 2020 2020 2020   those.         
+00009b90: 2020 2074 7261 6e73 666f 726d 6564 2064     transformed d
+00009ba0: 6976 6973 696f 6e73 2074 6f20 7468 6520  ivisions to the 
+00009bb0: 6f75 7470 7574 2e0a 2020 2020 2020 2020  output..        
+00009bc0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+00009bd0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+00009be0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+00009bf0: 2020 5768 6574 6865 7220 746f 2072 6570    Whether to rep
+00009c00: 6172 7469 7469 6f6e 2044 6174 6146 7261  artition DataFra
+00009c10: 6d65 2d20 6f72 2053 6572 6965 732d 6c69  me- or Series-li
+00009c20: 6b65 2061 7267 730a 2020 2020 2020 2020  ke args.        
+00009c30: 2020 2020 2862 6f74 6820 6461 736b 2061      (both dask a
+00009c40: 6e64 2070 616e 6461 7329 2073 6f20 7468  nd pandas) so th
+00009c50: 6569 7220 6469 7669 7369 6f6e 7320 616c  eir divisions al
+00009c60: 6967 6e20 6265 666f 7265 2061 7070 6c79  ign before apply
+00009c70: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00009c80: 7468 6520 6675 6e63 7469 6f6e 2e20 5468  the function. Th
+00009c90: 6973 2072 6571 7569 7265 7320 616c 6c20  is requires all 
+00009ca0: 696e 7075 7473 2074 6f20 6861 7665 206b  inputs to have k
+00009cb0: 6e6f 776e 2064 6976 6973 696f 6e73 2e0a  nown divisions..
+00009cc0: 2020 2020 2020 2020 2020 2020 5369 6e67              Sing
+00009cd0: 6c65 2d70 6172 7469 7469 6f6e 2069 6e70  le-partition inp
+00009ce0: 7574 7320 7769 6c6c 2062 6520 7370 6c69  uts will be spli
+00009cf0: 7420 696e 746f 206d 756c 7469 706c 6520  t into multiple 
+00009d00: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
+00009d10: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
+00009d20: 652c 2061 6c6c 2069 6e70 7574 7320 6d75  e, all inputs mu
+00009d30: 7374 2068 6176 6520 6569 7468 6572 2074  st have either t
+00009d40: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
+00009d50: 6620 7061 7274 6974 696f 6e73 0a20 2020  f partitions.   
+00009d60: 2020 2020 2020 2020 206f 7220 6120 7369           or a si
+00009d70: 6e67 6c65 2070 6172 7469 7469 6f6e 2e20  ngle partition. 
+00009d80: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
+00009d90: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
+00009da0: 6272 6f61 6463 6173 7420 746f 0a20 2020  broadcast to.   
+00009db0: 2020 2020 2020 2020 2065 7665 7279 2070           every p
+00009dc0: 6172 7469 7469 6f6e 206f 6620 6d75 6c74  artition of mult
+00009dd0: 692d 7061 7274 6974 696f 6e20 696e 7075  i-partition inpu
+00009de0: 7473 2e0a 2020 2020 2020 2020 244d 4554  ts..        $MET
+00009df0: 410a 0a20 2020 2020 2020 204e 6f74 6573  A..        Notes
+00009e00: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
+00009e10: 2020 2020 2020 2047 6976 656e 2070 6f73         Given pos
+00009e20: 6974 6976 6520 696e 7465 6765 7273 2060  itive integers `
+00009e30: 6062 6566 6f72 6560 6020 616e 6420 6060  `before`` and ``
+00009e40: 6166 7465 7260 602c 2061 6e64 2061 2066  after``, and a f
+00009e50: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+00009e60: 6060 6675 6e63 6060 2c20 6060 6d61 705f  ``func``, ``map_
+00009e70: 6f76 6572 6c61 7060 6020 646f 6573 2074  overlap`` does t
+00009e80: 6865 2066 6f6c 6c6f 7769 6e67 3a0a 0a20  he following:.. 
+00009e90: 2020 2020 2020 2031 2e20 5072 6570 656e         1. Prepen
+00009ea0: 6420 6060 6265 666f 7265 6060 2072 6f77  d ``before`` row
+00009eb0: 7320 746f 2065 6163 6820 7061 7274 6974  s to each partit
+00009ec0: 696f 6e20 6060 6960 6020 6672 6f6d 2074  ion ``i`` from t
+00009ed0: 6865 2065 6e64 206f 660a 2020 2020 2020  he end of.      
+00009ee0: 2020 2020 2070 6172 7469 7469 6f6e 2060       partition `
+00009ef0: 6069 202d 2031 6060 2e20 5468 6520 6669  `i - 1``. The fi
+00009f00: 7273 7420 7061 7274 6974 696f 6e20 6861  rst partition ha
+00009f10: 7320 6e6f 2072 6f77 7320 7072 6570 656e  s no rows prepen
+00009f20: 6465 642e 0a0a 2020 2020 2020 2020 322e  ded...        2.
+00009f30: 2041 7070 656e 6420 6060 6166 7465 7260   Append ``after`
+00009f40: 6020 726f 7773 2074 6f20 6561 6368 2070  ` rows to each p
+00009f50: 6172 7469 7469 6f6e 2060 6069 6060 2066  artition ``i`` f
+00009f60: 726f 6d20 7468 6520 6265 6769 6e6e 696e  rom the beginnin
+00009f70: 6720 6f66 0a20 2020 2020 2020 2020 2020  g of.           
+00009f80: 7061 7274 6974 696f 6e20 6060 6920 2b20  partition ``i + 
+00009f90: 3160 602e 2054 6865 206c 6173 7420 7061  1``. The last pa
+00009fa0: 7274 6974 696f 6e20 6861 7320 6e6f 2072  rtition has no r
+00009fb0: 6f77 7320 6170 7065 6e64 6564 2e0a 0a20  ows appended... 
+00009fc0: 2020 2020 2020 2033 2e20 4170 706c 7920         3. Apply 
+00009fd0: 6060 6675 6e63 6060 2074 6f20 6561 6368  ``func`` to each
+00009fe0: 2070 6172 7469 7469 6f6e 2c20 7061 7373   partition, pass
+00009ff0: 696e 6720 696e 2061 6e79 2065 7874 7261  ing in any extra
+0000a000: 2060 6061 7267 7360 6020 616e 640a 2020   ``args`` and.  
+0000a010: 2020 2020 2020 2020 2060 606b 7761 7267           ``kwarg
+0000a020: 7360 6020 6966 2070 726f 7669 6465 642e  s`` if provided.
+0000a030: 0a0a 2020 2020 2020 2020 342e 2054 7269  ..        4. Tri
+0000a040: 6d20 6060 6265 666f 7265 6060 2072 6f77  m ``before`` row
+0000a050: 7320 6672 6f6d 2074 6865 2062 6567 696e  s from the begin
+0000a060: 6e69 6e67 206f 6620 616c 6c20 6275 7420  ning of all but 
+0000a070: 7468 6520 6669 7273 740a 2020 2020 2020  the first.      
+0000a080: 2020 2020 2070 6172 7469 7469 6f6e 2e0a       partition..
+0000a090: 0a20 2020 2020 2020 2035 2e20 5472 696d  .        5. Trim
+0000a0a0: 2060 6061 6674 6572 6060 2072 6f77 7320   ``after`` rows 
+0000a0b0: 6672 6f6d 2074 6865 2065 6e64 206f 6620  from the end of 
+0000a0c0: 616c 6c20 6275 7420 7468 6520 6c61 7374  all but the last
+0000a0d0: 2070 6172 7469 7469 6f6e 2e0a 0a20 2020   partition...   
+0000a0e0: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+0000a0f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0000a100: 2020 2020 2020 2047 6976 656e 2061 2044         Given a D
+0000a110: 6174 6146 7261 6d65 2c20 5365 7269 6573  ataFrame, Series
+0000a120: 2c20 6f72 2049 6e64 6578 2c20 7375 6368  , or Index, such
+0000a130: 2061 733a 0a0a 2020 2020 2020 2020 3e3e   as:..        >>
+0000a140: 3e20 696d 706f 7274 2070 616e 6461 7320  > import pandas 
+0000a150: 6173 2070 640a 2020 2020 2020 2020 3e3e  as pd.        >>
+0000a160: 3e20 696d 706f 7274 2064 6173 6b5f 6578  > import dask_ex
+0000a170: 7072 2061 7320 6464 0a20 2020 2020 2020  pr as dd.       
+0000a180: 203e 3e3e 2064 6620 3d20 7064 2e44 6174   >>> df = pd.Dat
+0000a190: 6146 7261 6d65 287b 2778 273a 205b 312c  aFrame({'x': [1,
+0000a1a0: 2032 2c20 342c 2037 2c20 3131 5d2c 0a20   2, 4, 7, 11],. 
+0000a1b0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0000a1c0: 2020 2020 2020 2020 2020 2020 2020 2779                'y
+0000a1d0: 273a 205b 312e 2c20 322e 2c20 332e 2c20  ': [1., 2., 3., 
+0000a1e0: 342e 2c20 352e 5d7d 290a 2020 2020 2020  4., 5.]}).      
+0000a1f0: 2020 3e3e 3e20 6464 6620 3d20 6464 2e66    >>> ddf = dd.f
+0000a200: 726f 6d5f 7061 6e64 6173 2864 662c 206e  rom_pandas(df, n
+0000a210: 7061 7274 6974 696f 6e73 3d32 290a 0a20  partitions=2).. 
+0000a220: 2020 2020 2020 2041 2072 6f6c 6c69 6e67         A rolling
+0000a230: 2073 756d 2077 6974 6820 6120 7472 6169   sum with a trai
+0000a240: 6c69 6e67 206d 6f76 696e 6720 7769 6e64  ling moving wind
+0000a250: 6f77 206f 6620 7369 7a65 2032 2063 616e  ow of size 2 can
+0000a260: 2062 6520 636f 6d70 7574 6564 2062 790a   be computed by.
+0000a270: 2020 2020 2020 2020 6f76 6572 6c61 7070          overlapp
+0000a280: 696e 6720 3220 726f 7773 2062 6566 6f72  ing 2 rows befor
+0000a290: 6520 6561 6368 2070 6172 7469 7469 6f6e  e each partition
+0000a2a0: 2c20 616e 6420 7468 656e 206d 6170 7069  , and then mappi
+0000a2b0: 6e67 2063 616c 6c73 2074 6f0a 2020 2020  ng calls to.    
+0000a2c0: 2020 2020 6060 6466 2e72 6f6c 6c69 6e67      ``df.rolling
+0000a2d0: 2832 292e 7375 6d28 2960 603a 0a0a 2020  (2).sum()``:..  
+0000a2e0: 2020 2020 2020 3e3e 3e20 6464 662e 636f        >>> ddf.co
+0000a2f0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+0000a300: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
+0000a310: 2020 2030 2020 2031 2020 312e 300a 2020     0   1  1.0.  
+0000a320: 2020 2020 2020 3120 2020 3220 2032 2e30        1   2  2.0
+0000a330: 0a20 2020 2020 2020 2032 2020 2034 2020  .        2   4  
+0000a340: 332e 300a 2020 2020 2020 2020 3320 2020  3.0.        3   
+0000a350: 3720 2034 2e30 0a20 2020 2020 2020 2034  7  4.0.        4
+0000a360: 2020 3131 2020 352e 300a 2020 2020 2020    11  5.0.      
+0000a370: 2020 3e3e 3e20 6464 662e 6d61 705f 6f76    >>> ddf.map_ov
+0000a380: 6572 6c61 7028 6c61 6d62 6461 2064 663a  erlap(lambda df:
+0000a390: 2064 662e 726f 6c6c 696e 6728 3229 2e73   df.rolling(2).s
+0000a3a0: 756d 2829 2c20 322c 2030 292e 636f 6d70  um(), 2, 0).comp
+0000a3b0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+0000a3c0: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
+0000a3d0: 2020 2030 2020 204e 614e 2020 4e61 4e0a     0   NaN  NaN.
+0000a3e0: 2020 2020 2020 2020 3120 2020 332e 3020          1   3.0 
+0000a3f0: 2033 2e30 0a20 2020 2020 2020 2032 2020   3.0.        2  
+0000a400: 2036 2e30 2020 352e 300a 2020 2020 2020   6.0  5.0.      
+0000a410: 2020 3320 2031 312e 3020 2037 2e30 0a20    3  11.0  7.0. 
+0000a420: 2020 2020 2020 2034 2020 3138 2e30 2020         4  18.0  
+0000a430: 392e 300a 0a20 2020 2020 2020 2054 6865  9.0..        The
+0000a440: 2070 616e 6461 7320 6060 6469 6666 6060   pandas ``diff``
+0000a450: 206d 6574 686f 6420 636f 6d70 7574 6573   method computes
+0000a460: 2061 2064 6973 6372 6574 6520 6469 6666   a discrete diff
+0000a470: 6572 656e 6365 2073 6869 6674 6564 2062  erence shifted b
+0000a480: 7920 610a 2020 2020 2020 2020 6e75 6d62  y a.        numb
+0000a490: 6572 206f 6620 7065 7269 6f64 7320 2863  er of periods (c
+0000a4a0: 616e 2062 6520 706f 7369 7469 7665 206f  an be positive o
+0000a4b0: 7220 6e65 6761 7469 7665 292e 2054 6869  r negative). Thi
+0000a4c0: 7320 6361 6e20 6265 0a20 2020 2020 2020  s can be.       
+0000a4d0: 2069 6d70 6c65 6d65 6e74 6564 2062 7920   implemented by 
+0000a4e0: 6d61 7070 696e 6720 6361 6c6c 7320 746f  mapping calls to
+0000a4f0: 2060 6064 662e 6469 6666 6060 2074 6f20   ``df.diff`` to 
+0000a500: 6561 6368 2070 6172 7469 7469 6f6e 2061  each partition a
+0000a510: 6674 6572 0a20 2020 2020 2020 2070 7265  fter.        pre
+0000a520: 7065 6e64 696e 672f 6170 7065 6e64 696e  pending/appendin
+0000a530: 6720 7468 6174 206d 616e 7920 726f 7773  g that many rows
+0000a540: 2c20 6465 7065 6e64 696e 6720 6f6e 2073  , depending on s
+0000a550: 6967 6e3a 0a0a 2020 2020 2020 2020 3e3e  ign:..        >>
+0000a560: 3e20 6465 6620 6469 6666 2864 662c 2070  > def diff(df, p
+0000a570: 6572 696f 6473 3d31 293a 0a20 2020 2020  eriods=1):.     
+0000a580: 2020 202e 2e2e 2020 2020 2062 6566 6f72     ...     befor
+0000a590: 652c 2061 6674 6572 203d 2028 7065 7269  e, after = (peri
+0000a5a0: 6f64 732c 2030 2920 6966 2070 6572 696f  ods, 0) if perio
+0000a5b0: 6473 203e 2030 2065 6c73 6520 2830 2c20  ds > 0 else (0, 
+0000a5c0: 2d70 6572 696f 6473 290a 2020 2020 2020  -periods).      
+0000a5d0: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+0000a5e0: 2064 662e 6d61 705f 6f76 6572 6c61 7028   df.map_overlap(
+0000a5f0: 6c61 6d62 6461 2064 662c 2070 6572 696f  lambda df, perio
+0000a600: 6473 3d31 3a20 6466 2e64 6966 6628 7065  ds=1: df.diff(pe
+0000a610: 7269 6f64 7329 2c0a 2020 2020 2020 2020  riods),.        
+0000a620: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+0000a630: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0000a640: 7269 6f64 732c 2030 2c20 7065 7269 6f64  riods, 0, period
+0000a650: 733d 7065 7269 6f64 7329 0a20 2020 2020  s=periods).     
+0000a660: 2020 203e 3e3e 2064 6966 6628 6464 662c     >>> diff(ddf,
+0000a670: 2031 292e 636f 6d70 7574 6528 290a 2020   1).compute().  
+0000a680: 2020 2020 2020 2020 2020 2078 2020 2020             x    
+0000a690: 790a 2020 2020 2020 2020 3020 204e 614e  y.        0  NaN
+0000a6a0: 2020 4e61 4e0a 2020 2020 2020 2020 3120    NaN.        1 
+0000a6b0: 2031 2e30 2020 312e 300a 2020 2020 2020   1.0  1.0.      
+0000a6c0: 2020 3220 2032 2e30 2020 312e 300a 2020    2  2.0  1.0.  
+0000a6d0: 2020 2020 2020 3320 2033 2e30 2020 312e        3  3.0  1.
+0000a6e0: 300a 2020 2020 2020 2020 3420 2034 2e30  0.        4  4.0
+0000a6f0: 2020 312e 300a 0a20 2020 2020 2020 2049    1.0..        I
+0000a700: 6620 796f 7520 6861 7665 2061 2060 6044  f you have a ``D
+0000a710: 6174 6574 696d 6549 6e64 6578 6060 2c20  atetimeIndex``, 
+0000a720: 796f 7520 6361 6e20 7573 6520 6120 6060  you can use a ``
+0000a730: 7064 2e54 696d 6564 656c 7461 6060 2066  pd.Timedelta`` f
+0000a740: 6f72 2074 696d 652d 0a20 2020 2020 2020  or time-.       
+0000a750: 2062 6173 6564 2077 696e 646f 7773 206f   based windows o
+0000a760: 7220 616e 7920 6060 7064 2e54 696d 6564  r any ``pd.Timed
+0000a770: 656c 7461 6060 2063 6f6e 7665 7274 6962  elta`` convertib
+0000a780: 6c65 2073 7472 696e 673a 0a0a 2020 2020  le string:..    
+0000a790: 2020 2020 3e3e 3e20 7473 203d 2070 642e      >>> ts = pd.
+0000a7a0: 5365 7269 6573 2872 616e 6765 2831 3029  Series(range(10)
+0000a7b0: 2c20 696e 6465 783d 7064 2e64 6174 655f  , index=pd.date_
+0000a7c0: 7261 6e67 6528 2732 3031 3727 2c20 7065  range('2017', pe
+0000a7d0: 7269 6f64 733d 3130 2929 0a20 2020 2020  riods=10)).     
+0000a7e0: 2020 203e 3e3e 2064 7473 203d 2064 642e     >>> dts = dd.
+0000a7f0: 6672 6f6d 5f70 616e 6461 7328 7473 2c20  from_pandas(ts, 
+0000a800: 6e70 6172 7469 7469 6f6e 733d 3229 0a20  npartitions=2). 
+0000a810: 2020 2020 2020 203e 3e3e 2064 7473 2e6d         >>> dts.m
+0000a820: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
+0000a830: 6120 6466 3a20 6466 2e72 6f6c 6c69 6e67  a df: df.rolling
+0000a840: 2827 3244 2729 2e73 756d 2829 2c0a 2020  ('2D').sum(),.  
+0000a850: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0000a860: 2020 2020 2020 2020 2020 7064 2e54 696d            pd.Tim
+0000a870: 6564 656c 7461 2827 3244 2729 2c20 3029  edelta('2D'), 0)
+0000a880: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+0000a890: 2020 2032 3031 372d 3031 2d30 3120 2020     2017-01-01   
+0000a8a0: 2020 302e 300a 2020 2020 2020 2020 3230    0.0.        20
+0000a8b0: 3137 2d30 312d 3032 2020 2020 2031 2e30  17-01-02     1.0
+0000a8c0: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
+0000a8d0: 2d30 3320 2020 2020 332e 300a 2020 2020  -03     3.0.    
+0000a8e0: 2020 2020 3230 3137 2d30 312d 3034 2020      2017-01-04  
+0000a8f0: 2020 2035 2e30 0a20 2020 2020 2020 2032     5.0.        2
+0000a900: 3031 372d 3031 2d30 3520 2020 2020 372e  017-01-05     7.
+0000a910: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
+0000a920: 312d 3036 2020 2020 2039 2e30 0a20 2020  1-06     9.0.   
+0000a930: 2020 2020 2032 3031 372d 3031 2d30 3720       2017-01-07 
+0000a940: 2020 2031 312e 300a 2020 2020 2020 2020     11.0.        
+0000a950: 3230 3137 2d30 312d 3038 2020 2020 3133  2017-01-08    13
+0000a960: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
+0000a970: 3031 2d30 3920 2020 2031 352e 300a 2020  01-09    15.0.  
+0000a980: 2020 2020 2020 3230 3137 2d30 312d 3130        2017-01-10
+0000a990: 2020 2020 3137 2e30 0a20 2020 2020 2020      17.0.       
+0000a9a0: 2046 7265 713a 2044 2c20 6474 7970 653a   Freq: D, dtype:
+0000a9b0: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
+0000a9c0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0000a9d0: 7572 6e20 6d61 705f 6f76 6572 6c61 7028  urn map_overlap(
+0000a9e0: 0a20 2020 2020 2020 2020 2020 2066 756e  .            fun
+0000a9f0: 632c 0a20 2020 2020 2020 2020 2020 2073  c,.            s
+0000aa00: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+0000aa10: 2062 6566 6f72 652c 0a20 2020 2020 2020   before,.       
+0000aa20: 2020 2020 2061 6674 6572 2c0a 2020 2020       after,.    
+0000aa30: 2020 2020 2020 2020 2a61 7267 732c 0a20          *args,. 
+0000aa40: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+0000aa50: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+0000aa60: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+0000aa70: 7461 3d65 6e66 6f72 6365 5f6d 6574 6164  ta=enforce_metad
+0000aa80: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+0000aa90: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+0000aaa0: 696f 6e73 3d74 7261 6e73 666f 726d 5f64  ions=transform_d
+0000aab0: 6976 6973 696f 6e73 2c0a 2020 2020 2020  ivisions,.      
+0000aac0: 2020 2020 2020 636c 6561 725f 6469 7669        clear_divi
+0000aad0: 7369 6f6e 733d 636c 6561 725f 6469 7669  sions=clear_divi
+0000aae0: 7369 6f6e 732c 0a20 2020 2020 2020 2020  sions,.         
+0000aaf0: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
+0000ab00: 6d65 733d 616c 6967 6e5f 6461 7461 6672  mes=align_datafr
+0000ab10: 616d 6573 2c0a 2020 2020 2020 2020 2020  ames,.          
+0000ab20: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+0000ab30: 2020 2020 290a 0a20 2020 2064 6566 2072      )..    def r
+0000ab40: 6570 6172 7469 7469 6f6e 280a 2020 2020  epartition(.    
+0000ab50: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000ab60: 2020 6469 7669 7369 6f6e 733a 2074 7570    divisions: tup
+0000ab70: 6c65 207c 204e 6f6e 6520 3d20 4e6f 6e65  le | None = None
+0000ab80: 2c0a 2020 2020 2020 2020 6e70 6172 7469  ,.        nparti
+0000ab90: 7469 6f6e 733a 2069 6e74 207c 204e 6f6e  tions: int | Non
+0000aba0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+0000abb0: 2020 7061 7274 6974 696f 6e5f 7369 7a65    partition_size
+0000abc0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+0000abd0: 2020 2020 2020 6672 6571 3d4e 6f6e 652c        freq=None,
+0000abe0: 0a20 2020 2020 2020 2066 6f72 6365 3a20  .        force: 
+0000abf0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0000ac00: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0000ac10: 5265 7061 7274 6974 696f 6e20 6120 636f  Repartition a co
+0000ac20: 6c6c 6563 7469 6f6e 0a0a 2020 2020 2020  llection..      
+0000ac30: 2020 4578 6163 746c 7920 6f6e 6520 6f66    Exactly one of
+0000ac40: 2060 6469 7669 7369 6f6e 7360 2c20 606e   `divisions`, `n
+0000ac50: 7061 7274 6974 696f 6e73 6020 6f72 2060  partitions` or `
+0000ac60: 7061 7274 6974 696f 6e5f 7369 7a65 6020  partition_size` 
+0000ac70: 7368 6f75 6c64 2062 650a 2020 2020 2020  should be.      
+0000ac80: 2020 7370 6563 6966 6965 642e 2041 2060    specified. A `
+0000ac90: 6056 616c 7565 4572 726f 7260 6020 7769  `ValueError`` wi
+0000aca0: 6c6c 2062 6520 7261 6973 6564 2077 6865  ll be raised whe
+0000acb0: 6e20 7468 6174 2069 7320 6e6f 7420 7468  n that is not th
+0000acc0: 6520 6361 7365 2e0a 0a20 2020 2020 2020  e case...       
+0000acd0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0000ace0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0000acf0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0000ad00: 203a 206c 6973 742c 206f 7074 696f 6e61   : list, optiona
+0000ad10: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
+0000ad20: 6520 2264 6976 6964 696e 6720 6c69 6e65  e "dividing line
+0000ad30: 7322 2075 7365 6420 746f 2073 706c 6974  s" used to split
+0000ad40: 2074 6865 2064 6174 6166 7261 6d65 2069   the dataframe i
+0000ad50: 6e74 6f20 7061 7274 6974 696f 6e73 2e0a  nto partitions..
+0000ad60: 2020 2020 2020 2020 2020 2020 466f 7220              For 
+0000ad70: 6060 6469 7669 7369 6f6e 733d 5b30 2c20  ``divisions=[0, 
+0000ad80: 3130 2c20 3530 2c20 3130 305d 6060 2c20  10, 50, 100]``, 
+0000ad90: 7468 6572 6520 776f 756c 6420 6265 2074  there would be t
+0000ada0: 6872 6565 206f 7574 7075 7420 7061 7274  hree output part
+0000adb0: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+0000adc0: 2020 2020 7768 6572 6520 7468 6520 6e65      where the ne
+0000add0: 7720 696e 6465 7820 636f 6e74 6169 6e65  w index containe
+0000ade0: 6420 5b30 2c20 3130 292c 205b 3130 2c20  d [0, 10), [10, 
+0000adf0: 3530 292c 2061 6e64 205b 3530 2c20 3130  50), and [50, 10
+0000ae00: 3029 2c20 7265 7370 6563 7469 7665 6c79  0), respectively
+0000ae10: 2e0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
+0000ae20: 6520 6874 7470 733a 2f2f 646f 6373 2e64  e https://docs.d
+0000ae30: 6173 6b2e 6f72 672f 656e 2f6c 6174 6573  ask.org/en/lates
+0000ae40: 742f 6461 7461 6672 616d 652d 6465 7369  t/dataframe-desi
+0000ae50: 676e 2e68 746d 6c23 7061 7274 6974 696f  gn.html#partitio
+0000ae60: 6e73 2e0a 2020 2020 2020 2020 6e70 6172  ns..        npar
+0000ae70: 7469 7469 6f6e 7320 3a20 696e 742c 2043  titions : int, C
+0000ae80: 616c 6c61 626c 652c 206f 7074 696f 6e61  allable, optiona
+0000ae90: 6c0a 2020 2020 2020 2020 2020 2020 4170  l.            Ap
+0000aea0: 7072 6f78 696d 6174 6520 6e75 6d62 6572  proximate number
+0000aeb0: 206f 6620 7061 7274 6974 696f 6e73 206f   of partitions o
+0000aec0: 6620 6f75 7470 7574 2e20 5468 6520 6e75  f output. The nu
+0000aed0: 6d62 6572 206f 660a 2020 2020 2020 2020  mber of.        
+0000aee0: 2020 2020 7061 7274 6974 696f 6e73 2075      partitions u
+0000aef0: 7365 6420 6d61 7920 6265 2073 6c69 6768  sed may be sligh
+0000af00: 746c 7920 6c6f 7765 7220 7468 616e 206e  tly lower than n
+0000af10: 7061 7274 6974 696f 6e73 2064 6570 656e  partitions depen
+0000af20: 6469 6e67 0a20 2020 2020 2020 2020 2020  ding.           
+0000af30: 206f 6e20 6461 7461 2064 6973 7472 6962   on data distrib
+0000af40: 7574 696f 6e2c 2062 7574 2077 696c 6c20  ution, but will 
+0000af50: 6e65 7665 7220 6265 2068 6967 6865 722e  never be higher.
+0000af60: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0000af70: 2043 616c 6c61 626c 6520 6765 7473 2074   Callable gets t
+0000af80: 6865 206e 756d 6265 7220 6f66 2070 6172  he number of par
+0000af90: 7469 7469 6f6e 7320 6f66 2074 6865 2069  titions of the i
+0000afa0: 6e70 7574 2061 7320 616e 2061 7267 756d  nput as an argum
+0000afb0: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+0000afc0: 616e 6420 7368 6f75 6c64 2072 6574 7572  and should retur
+0000afd0: 6e20 616e 2069 6e74 2e0a 2020 2020 2020  n an int..      
+0000afe0: 2020 7061 7274 6974 696f 6e5f 7369 7a65    partition_size
+0000aff0: 203a 2073 7472 2c20 6f70 7469 6f6e 616c   : str, optional
+0000b000: 0a20 2020 2020 2020 2020 2020 204d 6178  .            Max
+0000b010: 206e 756d 6265 7220 6f66 2062 7974 6573   number of bytes
+0000b020: 206f 6620 6d65 6d6f 7279 2066 6f72 2065   of memory for e
+0000b030: 6163 6820 7061 7274 6974 696f 6e2e 2055  ach partition. U
+0000b040: 7365 206e 756d 6265 7273 206f 7220 7374  se numbers or st
+0000b050: 7269 6e67 730a 2020 2020 2020 2020 2020  rings.          
+0000b060: 2020 6c69 6b65 2035 4d42 2e20 4966 2073    like 5MB. If s
+0000b070: 7065 6369 6669 6564 206e 7061 7274 6974  pecified npartit
+0000b080: 696f 6e73 2061 6e64 2064 6976 6973 696f  ions and divisio
+0000b090: 6e73 2077 696c 6c20 6265 2069 676e 6f72  ns will be ignor
+0000b0a0: 6564 2e20 4e6f 7465 2074 6861 740a 2020  ed. Note that.  
+0000b0b0: 2020 2020 2020 2020 2020 7468 6520 7369            the si
+0000b0c0: 7a65 2072 6566 6c65 6374 7320 7468 6520  ze reflects the 
+0000b0d0: 6e75 6d62 6572 206f 6620 6279 7465 7320  number of bytes 
+0000b0e0: 7573 6564 2061 7320 636f 6d70 7574 6564  used as computed
+0000b0f0: 2062 790a 2020 2020 2020 2020 2020 2020   by.            
+0000b100: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+0000b110: 2e6d 656d 6f72 795f 7573 6167 652c 2077  .memory_usage, w
+0000b120: 6869 6368 2077 696c 6c20 6e6f 7420 6e65  hich will not ne
+0000b130: 6365 7373 6172 696c 7920 6d61 7463 6820  cessarily match 
+0000b140: 7468 6520 7369 7a65 0a20 2020 2020 2020  the size.       
+0000b150: 2020 2020 2077 6865 6e20 7374 6f72 696e       when storin
+0000b160: 6720 746f 2064 6973 6b2e 0a0a 2020 2020  g to disk...    
+0000b170: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
+0000b180: 6e67 3a3a 0a0a 2020 2020 2020 2020 2020  ng::..          
+0000b190: 2020 2020 2054 6869 7320 6b65 7977 6f72       This keywor
+0000b1a0: 6420 6172 6775 6d65 6e74 2074 7269 6767  d argument trigg
+0000b1b0: 6572 7320 636f 6d70 7574 6174 696f 6e20  ers computation 
+0000b1c0: 746f 2064 6574 6572 6d69 6e65 0a20 2020  to determine.   
+0000b1d0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+0000b1e0: 6d65 6d6f 7279 2073 697a 6520 6f66 2065  memory size of e
+0000b1f0: 6163 6820 7061 7274 6974 696f 6e2c 2077  ach partition, w
+0000b200: 6869 6368 206d 6179 2062 6520 6578 7065  hich may be expe
+0000b210: 6e73 6976 652e 0a0a 2020 2020 2020 2020  nsive...        
+0000b220: 666f 7263 6520 3a20 626f 6f6c 2c20 6465  force : bool, de
+0000b230: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
+0000b240: 2020 2020 2020 2020 416c 6c6f 7773 2074          Allows t
+0000b250: 6865 2065 7870 616e 7369 6f6e 206f 6620  he expansion of 
+0000b260: 7468 6520 6578 6973 7469 6e67 2064 6976  the existing div
+0000b270: 6973 696f 6e73 2e0a 2020 2020 2020 2020  isions..        
+0000b280: 2020 2020 4966 2046 616c 7365 2074 6865      If False the
+0000b290: 6e20 7468 6520 6e65 7720 6469 7669 7369  n the new divisi
+0000b2a0: 6f6e 7327 206c 6f77 6572 2061 6e64 2075  ons' lower and u
+0000b2b0: 7070 6572 2062 6f75 6e64 7320 6d75 7374  pper bounds must
+0000b2c0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+0000b2d0: 7468 6520 7361 6d65 2061 7320 7468 6520  the same as the 
+0000b2e0: 6f6c 6420 6469 7669 7369 6f6e 7327 2e0a  old divisions'..
+0000b2f0: 2020 2020 2020 2020 6672 6571 203a 2073          freq : s
+0000b300: 7472 2c20 7064 2e54 696d 6564 656c 7461  tr, pd.Timedelta
+0000b310: 0a20 2020 2020 2020 2020 2020 2041 2070  .            A p
+0000b320: 6572 696f 6420 6f6e 2077 6869 6368 2074  eriod on which t
+0000b330: 6f20 7061 7274 6974 696f 6e20 7469 6d65  o partition time
+0000b340: 7365 7269 6573 2064 6174 6120 6c69 6b65  series data like
+0000b350: 2060 6027 3744 2760 6020 6f72 0a20 2020   ``'7D'`` or.   
+0000b360: 2020 2020 2020 2020 2060 6027 3132 6827           ``'12h'
+0000b370: 6060 206f 7220 6060 7064 2e54 696d 6564  `` or ``pd.Timed
+0000b380: 656c 7461 2868 6f75 7273 3d31 3229 6060  elta(hours=12)``
+0000b390: 2e20 2041 7373 756d 6573 2061 2064 6174  .  Assumes a dat
+0000b3a0: 6574 696d 6520 696e 6465 782e 0a0a 2020  etime index...  
+0000b3b0: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
+0000b3c0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
+0000b3d0: 2020 4578 6163 746c 7920 6f6e 6520 6f66    Exactly one of
+0000b3e0: 2060 6469 7669 7369 6f6e 7360 2c20 606e   `divisions`, `n
+0000b3f0: 7061 7274 6974 696f 6e73 602c 2060 7061  partitions`, `pa
+0000b400: 7274 6974 696f 6e5f 7369 7a65 602c 206f  rtition_size`, o
+0000b410: 7220 6066 7265 7160 0a20 2020 2020 2020  r `freq`.       
+0000b420: 2073 686f 756c 6420 6265 2073 7065 6369   should be speci
+0000b430: 6669 6564 2e20 4120 6060 5661 6c75 6545  fied. A ``ValueE
+0000b440: 7272 6f72 6060 2077 696c 6c20 6265 2072  rror`` will be r
+0000b450: 6169 7365 6420 7768 656e 2074 6861 7420  aised when that 
+0000b460: 6973 0a20 2020 2020 2020 206e 6f74 2074  is.        not t
+0000b470: 6865 2063 6173 652e 0a0a 2020 2020 2020  he case...      
+0000b480: 2020 416c 736f 206e 6f74 6520 7468 6174    Also note that
+0000b490: 2060 606c 656e 2864 6976 6973 6f6e 7329   ``len(divisons)
+0000b4a0: 6060 2069 7320 6571 7561 6c20 746f 2060  `` is equal to `
+0000b4b0: 606e 7061 7274 6974 696f 6e73 202b 2031  `npartitions + 1
+0000b4c0: 6060 2e20 5468 6973 2069 7320 6265 6361  ``. This is beca
+0000b4d0: 7573 6520 6060 6469 7669 7369 6f6e 7360  use ``divisions`
+0000b4e0: 600a 2020 2020 2020 2020 7265 7072 6573  `.        repres
+0000b4f0: 656e 7473 2074 6865 2075 7070 6572 2061  ents the upper a
+0000b500: 6e64 206c 6f77 6572 2062 6f75 6e64 7320  nd lower bounds 
+0000b510: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
+0000b520: 6e2e 2054 6865 2066 6972 7374 2069 7465  n. The first ite
+0000b530: 6d20 6973 2074 6865 0a20 2020 2020 2020  m is the.       
+0000b540: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
+0000b550: 7468 6520 6669 7273 7420 7061 7274 6974  the first partit
+0000b560: 696f 6e2c 2074 6865 2073 6563 6f6e 6420  ion, the second 
+0000b570: 6974 656d 2069 7320 7468 6520 6c6f 7765  item is the lowe
+0000b580: 7220 626f 756e 6420 6f66 2074 6865 0a20  r bound of the. 
+0000b590: 2020 2020 2020 2073 6563 6f6e 6420 7061         second pa
+0000b5a0: 7274 6974 696f 6e20 616e 6420 7468 6520  rtition and the 
+0000b5b0: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
+0000b5c0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
+0000b5d0: 6f6e 2c20 616e 6420 736f 206f 6e2e 0a20  on, and so on.. 
+0000b5e0: 2020 2020 2020 2054 6865 2073 6563 6f6e         The secon
+0000b5f0: 642d 746f 2d6c 6173 7420 6974 656d 2069  d-to-last item i
+0000b600: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
+0000b610: 6420 6f66 2074 6865 206c 6173 7420 7061  d of the last pa
+0000b620: 7274 6974 696f 6e2c 2061 6e64 2074 6865  rtition, and the
+0000b630: 206c 6173 740a 2020 2020 2020 2020 2865   last.        (e
+0000b640: 7874 7261 2920 6974 656d 2069 7320 7468  xtra) item is th
+0000b650: 6520 7570 7065 7220 626f 756e 6420 6f66  e upper bound of
+0000b660: 2074 6865 206c 6173 7420 7061 7274 6974   the last partit
+0000b670: 696f 6e2e 0a0a 2020 2020 2020 2020 4578  ion...        Ex
+0000b680: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+0000b690: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000b6a0: 3e3e 3e20 6466 203d 2064 662e 7265 7061  >>> df = df.repa
+0000b6b0: 7274 6974 696f 6e28 6e70 6172 7469 7469  rtition(npartiti
+0000b6c0: 6f6e 733d 3130 2920 2023 2064 6f63 7465  ons=10)  # docte
+0000b6d0: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+0000b6e0: 2020 3e3e 3e20 6466 203d 2064 662e 7265    >>> df = df.re
+0000b6f0: 7061 7274 6974 696f 6e28 6469 7669 7369  partition(divisi
+0000b700: 6f6e 733d 5b30 2c20 352c 2031 302c 2032  ons=[0, 5, 10, 2
+0000b710: 305d 2920 2023 2064 6f63 7465 7374 3a20  0])  # doctest: 
+0000b720: 2b53 4b49 500a 2020 2020 2020 2020 3e3e  +SKIP.        >>
+0000b730: 3e20 6466 203d 2064 662e 7265 7061 7274  > df = df.repart
+0000b740: 6974 696f 6e28 6672 6571 3d27 3764 2729  ition(freq='7d')
+0000b750: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0000b760: 4950 0a0a 2020 2020 2020 2020 5365 6520  IP..        See 
+0000b770: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+0000b780: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+0000b790: 7461 4672 616d 652e 6d65 6d6f 7279 5f75  taFrame.memory_u
+0000b7a0: 7361 6765 5f70 6572 5f70 6172 7469 7469  sage_per_partiti
+0000b7b0: 6f6e 0a20 2020 2020 2020 2070 616e 6461  on.        panda
+0000b7c0: 732e 4461 7461 4672 616d 652e 6d65 6d6f  s.DataFrame.memo
+0000b7d0: 7279 5f75 7361 6765 0a20 2020 2020 2020  ry_usage.       
+0000b7e0: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+0000b7f0: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
+0000b800: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
+0000b810: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0000b820: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+0000b830: 6f6e 7320 6973 206e 6f74 204e 6f6e 652c  ons is not None,
+0000b840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b850: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+0000b860: 2069 7320 6e6f 7420 4e6f 6e65 2c0a 2020   is not None,.  
+0000b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b880: 2020 7061 7274 6974 696f 6e5f 7369 7a65    partition_size
+0000b890: 2069 7320 6e6f 7420 4e6f 6e65 2c0a 2020   is not None,.  
+0000b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b8b0: 2020 6672 6571 2069 7320 6e6f 7420 4e6f    freq is not No
+0000b8c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0000b8d0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+0000b8e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000b8f0: 213d 2031 0a20 2020 2020 2020 2029 3a0a  != 1.        ):.
+0000b900: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000b910: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0000b920: 2020 2020 2020 2020 2020 2020 2020 2250                "P
+0000b930: 6c65 6173 6520 7072 6f76 6964 6520 6578  lease provide ex
+0000b940: 6163 746c 7920 6f6e 6520 6f66 2074 6865  actly one of the
+0000b950: 2060 606e 7061 7274 6974 696f 6e73 3d60   ``npartitions=`
+0000b960: 6020 6f72 2022 0a20 2020 2020 2020 2020  ` or ".         
+0000b970: 2020 2020 2020 2022 6060 6469 7669 7369         "``divisi
+0000b980: 6f6e 733d 6060 206b 6579 776f 7264 2061  ons=`` keyword a
+0000b990: 7267 756d 656e 7473 2e22 0a20 2020 2020  rguments.".     
+0000b9a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000b9b0: 2069 6620 6469 7669 7369 6f6e 7320 6973   if divisions is
+0000b9c0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0000b9d0: 2020 2020 2020 2063 6865 636b 5f64 6976         check_div
+0000b9e0: 6973 696f 6e73 2864 6976 6973 696f 6e73  isions(divisions
+0000b9f0: 290a 2020 2020 2020 2020 6966 2066 7265  ).        if fre
+0000ba00: 7120 6973 206e 6f74 204e 6f6e 653a 0a20  q is not None:. 
+0000ba10: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000ba20: 7420 6973 696e 7374 616e 6365 2873 656c  t isinstance(sel
+0000ba30: 662e 6469 7669 7369 6f6e 735b 305d 2c20  f.divisions[0], 
+0000ba40: 7064 2e54 696d 6573 7461 6d70 293a 0a20  pd.Timestamp):. 
+0000ba50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000ba60: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+0000ba70: 4361 6e20 6f6e 6c79 2072 6570 6172 7469  Can only reparti
+0000ba80: 7469 6f6e 206f 6e20 6672 6571 7565 6e63  tion on frequenc
+0000ba90: 7920 666f 7220 7469 6d65 7365 7269 6573  y for timeseries
+0000baa0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000bab0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000bac0: 7469 6f6e 2852 6570 6172 7469 7469 6f6e  tion(Repartition
+0000bad0: 4672 6571 2873 656c 662c 2066 7265 7129  Freq(self, freq)
+0000bae0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000baf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000bb00: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0000bb10: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0000bb20: 2020 2052 6570 6172 7469 7469 6f6e 2873     Repartition(s
+0000bb30: 656c 662c 206e 7061 7274 6974 696f 6e73  elf, npartitions
+0000bb40: 2c20 6469 7669 7369 6f6e 732c 2066 6f72  , divisions, for
+0000bb50: 6365 2c20 7061 7274 6974 696f 6e5f 7369  ce, partition_si
+0000bb60: 7a65 2c20 6672 6571 290a 2020 2020 2020  ze, freq).      
+0000bb70: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0000bb80: 2074 6f5f 6461 736b 5f64 6174 6166 7261   to_dask_datafra
+0000bb90: 6d65 2873 656c 662c 202a 6172 6773 2c20  me(self, *args, 
+0000bba0: 2a2a 6b77 6172 6773 2920 2d3e 205f 4672  **kwargs) -> _Fr
+0000bbb0: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
+0000bbc0: 436f 6e76 6572 7420 746f 2061 206c 6567  Convert to a leg
+0000bbd0: 6163 7920 6461 736b 2d64 6174 6166 7261  acy dask-datafra
+0000bbe0: 6d65 2063 6f6c 6c65 6374 696f 6e0a 0a20  me collection.. 
+0000bbf0: 2020 2020 2020 2057 4152 4e49 4e47 3a20         WARNING: 
+0000bc00: 5468 6973 2041 5049 2069 7320 6465 7072  This API is depr
+0000bc10: 6563 6174 6564 2e20 506c 6561 7365 2075  ecated. Please u
+0000bc20: 7365 2060 746f 5f6c 6567 6163 795f 6461  se `to_legacy_da
+0000bc30: 7461 6672 616d 6560 2e0a 0a20 2020 2020  taframe`...     
+0000bc40: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0000bc50: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000bc60: 0a20 2020 2020 2020 206f 7074 696d 697a  .        optimiz
+0000bc70: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
+0000bc80: 6574 6865 7220 746f 206f 7074 696d 697a  ether to optimiz
+0000bc90: 6520 7468 6520 756e 6465 726c 7969 6e67  e the underlying
+0000bca0: 2060 4578 7072 6020 6f62 6a65 6374 2062   `Expr` object b
+0000bcb0: 6566 6f72 6520 636f 6e76 6572 7369 6f6e  efore conversion
+0000bcc0: 2e0a 2020 2020 2020 2020 2a2a 6f70 7469  ..        **opti
+0000bcd0: 6d69 7a65 5f6b 7761 7267 730a 2020 2020  mize_kwargs.    
+0000bce0: 2020 2020 2020 2020 4b65 792d 776f 7264          Key-word
+0000bcf0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+0000bd00: 7373 2074 6872 6f75 6768 2074 6f20 606f  ss through to `o
+0000bd10: 7074 696d 697a 6560 2e0a 2020 2020 2020  ptimize`..      
+0000bd20: 2020 2222 220a 2020 2020 2020 2020 7761    """.        wa
+0000bd30: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+0000bd40: 2020 2020 2020 2020 2022 6074 6f5f 6461           "`to_da
+0000bd50: 736b 5f64 6174 6166 7261 6d65 6020 6973  sk_dataframe` is
+0000bd60: 2064 6570 7265 6361 7465 642c 2070 6c65   deprecated, ple
+0000bd70: 6173 6520 7573 6520 6074 6f5f 6c65 6761  ase use `to_lega
+0000bd80: 6379 5f64 6174 6166 7261 6d65 602e 222c  cy_dataframe`.",
+0000bd90: 0a20 2020 2020 2020 2020 2020 2046 7574  .            Fut
+0000bda0: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
+0000bdb0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0000bdc0: 7475 726e 2073 656c 662e 746f 5f6c 6567  turn self.to_leg
+0000bdd0: 6163 795f 6461 7461 6672 616d 6528 2a61  acy_dataframe(*a
+0000bde0: 7267 732c 202a 2a6b 7761 7267 7329 0a0a  rgs, **kwargs)..
+0000bdf0: 2020 2020 6465 6620 746f 5f6c 6567 6163      def to_legac
+0000be00: 795f 6461 7461 6672 616d 6528 7365 6c66  y_dataframe(self
+0000be10: 2c20 6f70 7469 6d69 7a65 3a20 626f 6f6c  , optimize: bool
+0000be20: 203d 2054 7275 652c 202a 2a6f 7074 696d   = True, **optim
+0000be30: 697a 655f 6b77 6172 6773 2920 2d3e 205f  ize_kwargs) -> _
+0000be40: 4672 616d 653a 0a20 2020 2020 2020 2022  Frame:.        "
+0000be50: 2222 436f 6e76 6572 7420 746f 2061 206c  ""Convert to a l
+0000be60: 6567 6163 7920 6461 736b 2d64 6174 6166  egacy dask-dataf
+0000be70: 7261 6d65 2063 6f6c 6c65 6374 696f 6e0a  rame collection.
+0000be80: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000be90: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000bea0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
+0000beb0: 7074 696d 697a 650a 2020 2020 2020 2020  ptimize.        
+0000bec0: 2020 2020 5768 6574 6865 7220 746f 206f      Whether to o
+0000bed0: 7074 696d 697a 6520 7468 6520 756e 6465  ptimize the unde
+0000bee0: 726c 7969 6e67 2060 4578 7072 6020 6f62  rlying `Expr` ob
+0000bef0: 6a65 6374 2062 6566 6f72 6520 636f 6e76  ject before conv
+0000bf00: 6572 7369 6f6e 2e0a 2020 2020 2020 2020  ersion..        
+0000bf10: 2a2a 6f70 7469 6d69 7a65 5f6b 7761 7267  **optimize_kwarg
+0000bf20: 730a 2020 2020 2020 2020 2020 2020 4b65  s.            Ke
+0000bf30: 792d 776f 7264 2061 7267 756d 656e 7473  y-word arguments
+0000bf40: 2074 6f20 7061 7373 2074 6872 6f75 6768   to pass through
+0000bf50: 2074 6f20 606f 7074 696d 697a 6560 2e0a   to `optimize`..
+0000bf60: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000bf70: 2020 2020 6466 203d 2073 656c 662e 6f70      df = self.op
+0000bf80: 7469 6d69 7a65 282a 2a6f 7074 696d 697a  timize(**optimiz
+0000bf90: 655f 6b77 6172 6773 2920 6966 206f 7074  e_kwargs) if opt
+0000bfa0: 696d 697a 6520 656c 7365 2073 656c 660a  imize else self.
+0000bfb0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0000bfc0: 6577 5f64 645f 6f62 6a65 6374 2864 662e  ew_dd_object(df.
+0000bfd0: 6461 736b 2c20 6466 2e5f 6e61 6d65 2c20  dask, df._name, 
+0000bfe0: 6466 2e5f 6d65 7461 2c20 6466 2e64 6976  df._meta, df.div
+0000bff0: 6973 696f 6e73 290a 0a20 2020 2064 6566  isions)..    def
+0000c000: 2074 6f5f 6461 736b 5f61 7272 6179 280a   to_dask_array(.
+0000c010: 2020 2020 2020 2020 7365 6c66 2c20 6c65          self, le
+0000c020: 6e67 7468 733d 4e6f 6e65 2c20 6d65 7461  ngths=None, meta
+0000c030: 3d4e 6f6e 652c 206f 7074 696d 697a 653a  =None, optimize:
+0000c040: 2062 6f6f 6c20 3d20 5472 7565 2c20 2a2a   bool = True, **
+0000c050: 6f70 7469 6d69 7a65 5f6b 7761 7267 730a  optimize_kwargs.
+0000c060: 2020 2020 2920 2d3e 2041 7272 6179 3a0a      ) -> Array:.
+0000c070: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
+0000c080: 7274 2061 2064 6173 6b20 4461 7461 4672  rt a dask DataFr
+0000c090: 616d 6520 746f 2061 2064 6173 6b20 6172  ame to a dask ar
+0000c0a0: 7261 792e 0a0a 2020 2020 2020 2020 5061  ray...        Pa
+0000c0b0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0000c0c0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000c0d0: 2020 2020 6c65 6e67 7468 7320 3a20 626f      lengths : bo
+0000c0e0: 6f6c 206f 7220 5365 7175 656e 6365 206f  ol or Sequence o
+0000c0f0: 6620 696e 7473 2c20 6f70 7469 6f6e 616c  f ints, optional
+0000c100: 0a20 2020 2020 2020 2020 2020 2048 6f77  .            How
+0000c110: 2074 6f20 6465 7465 726d 696e 6520 7468   to determine th
+0000c120: 6520 6368 756e 6b73 2073 697a 6573 2066  e chunks sizes f
+0000c130: 6f72 2074 6865 206f 7574 7075 7420 6172  or the output ar
+0000c140: 7261 792e 0a20 2020 2020 2020 2020 2020  ray..           
+0000c150: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
+0000c160: 206f 7574 7075 7420 6172 7261 7920 7769   output array wi
+0000c170: 6c6c 2068 6176 6520 756e 6b6e 6f77 6e20  ll have unknown 
+0000c180: 6368 756e 6b20 6c65 6e67 7468 730a 2020  chunk lengths.  
+0000c190: 2020 2020 2020 2020 2020 616c 6f6e 6720            along 
+0000c1a0: 7468 6520 6669 7273 7420 6178 6973 2c20  the first axis, 
+0000c1b0: 7768 6963 6820 6361 6e20 6361 7573 6520  which can cause 
+0000c1c0: 736f 6d65 206c 6174 6572 206f 7065 7261  some later opera
+0000c1d0: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
+0000c1e0: 2020 746f 2066 6169 6c2e 0a0a 2020 2020    to fail...    
+0000c1f0: 2020 2020 2020 2020 2a20 5472 7565 203a          * True :
+0000c200: 2069 6d6d 6564 6961 7465 6c79 2063 6f6d   immediately com
+0000c210: 7075 7465 2074 6865 206c 656e 6774 6820  pute the length 
+0000c220: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
+0000c230: 6e0a 2020 2020 2020 2020 2020 2020 2a20  n.            * 
+0000c240: 5365 7175 656e 6365 203a 2061 2073 6571  Sequence : a seq
+0000c250: 7565 6e63 6520 6f66 2069 6e74 6567 6572  uence of integer
+0000c260: 7320 746f 2075 7365 2066 6f72 2074 6865  s to use for the
+0000c270: 2063 6875 6e6b 2073 697a 6573 0a20 2020   chunk sizes.   
+0000c280: 2020 2020 2020 2020 2020 206f 6e20 7468             on th
+0000c290: 6520 6669 7273 7420 6178 6973 2e20 5468  e first axis. Th
+0000c2a0: 6573 6520 7661 6c75 6573 2061 7265 202a  ese values are *
+0000c2b0: 6e6f 742a 2076 616c 6964 6174 6564 2066  not* validated f
+0000c2c0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+0000c2d0: 2063 6f72 7265 6374 6e65 7373 2c20 6265   correctness, be
+0000c2e0: 796f 6e64 2065 6e73 7572 696e 6720 7468  yond ensuring th
+0000c2f0: 6174 2074 6865 206e 756d 6265 7220 6f66  at the number of
+0000c300: 2069 7465 6d73 0a20 2020 2020 2020 2020   items.         
+0000c310: 2020 2020 206d 6174 6368 6573 2074 6865       matches the
+0000c320: 206e 756d 6265 7220 6f66 2070 6172 7469   number of parti
+0000c330: 7469 6f6e 732e 0a20 2020 2020 2020 206d  tions..        m
+0000c340: 6574 6120 3a20 6f62 6a65 6374 2c20 6f70  eta : object, op
+0000c350: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000c360: 2020 2041 6e20 6f70 7469 6f6e 616c 2060     An optional `
+0000c370: 6d65 7461 6020 7061 7261 6d65 7465 7220  meta` parameter 
+0000c380: 6361 6e20 6265 2070 6173 7365 6420 666f  can be passed fo
+0000c390: 7220 6461 736b 2074 6f20 6f76 6572 7269  r dask to overri
+0000c3a0: 6465 2074 6865 0a20 2020 2020 2020 2020  de the.         
+0000c3b0: 2020 2064 6566 6175 6c74 206d 6574 6164     default metad
+0000c3c0: 6174 6120 6f6e 2074 6865 2075 6e64 6572  ata on the under
+0000c3d0: 6c79 696e 6720 6461 736b 2061 7272 6179  lying dask array
+0000c3e0: 2e0a 2020 2020 2020 2020 6f70 7469 6d69  ..        optimi
+0000c3f0: 7a65 203a 2062 6f6f 6c0a 2020 2020 2020  ze : bool.      
+0000c400: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+0000c410: 206f 7074 696d 697a 6520 7468 6520 6578   optimize the ex
+0000c420: 7072 6573 7369 6f6e 2062 6566 6f72 6520  pression before 
+0000c430: 636f 6e76 6572 7469 6e67 2074 6f20 616e  converting to an
+0000c440: 2041 7272 6179 2e0a 0a20 2020 2020 2020   Array...       
+0000c450: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+0000c460: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0000c470: 2041 2044 6173 6b20 4172 7261 790a 2020   A Dask Array.  
+0000c480: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000c490: 2020 7265 7475 726e 2073 656c 662e 746f    return self.to
+0000c4a0: 5f6c 6567 6163 795f 6461 7461 6672 616d  _legacy_datafram
+0000c4b0: 6528 6f70 7469 6d69 7a65 2c20 2a2a 6f70  e(optimize, **op
+0000c4c0: 7469 6d69 7a65 5f6b 7761 7267 7329 2e74  timize_kwargs).t
+0000c4d0: 6f5f 6461 736b 5f61 7272 6179 280a 2020  o_dask_array(.  
+0000c4e0: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
+0000c4f0: 733d 6c65 6e67 7468 732c 206d 6574 613d  s=lengths, meta=
+0000c500: 6d65 7461 0a20 2020 2020 2020 2029 0a0a  meta.        )..
+0000c510: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000c520: 2020 6465 6620 7661 6c75 6573 2873 656c    def values(sel
+0000c530: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+0000c540: 6574 7572 6e20 6120 6461 736b 2e61 7272  eturn a dask.arr
+0000c550: 6179 206f 6620 7468 6520 7661 6c75 6573  ay of the values
+0000c560: 206f 6620 7468 6973 2064 6174 6166 7261   of this datafra
+0000c570: 6d65 0a0a 2020 2020 2020 2020 5761 726e  me..        Warn
+0000c580: 696e 673a 2054 6869 7320 6372 6561 7465  ing: This create
+0000c590: 7320 6120 6461 736b 2e61 7272 6179 2077  s a dask.array w
+0000c5a0: 6974 686f 7574 2070 7265 6369 7365 2073  ithout precise s
+0000c5b0: 6861 7065 2069 6e66 6f72 6d61 7469 6f6e  hape information
+0000c5c0: 2e0a 2020 2020 2020 2020 4f70 6572 6174  ..        Operat
+0000c5d0: 696f 6e73 2074 6861 7420 6465 7065 6e64  ions that depend
+0000c5e0: 206f 6e20 7368 6170 6520 696e 666f 726d   on shape inform
+0000c5f0: 6174 696f 6e2c 206c 696b 6520 736c 6963  ation, like slic
+0000c600: 696e 6720 6f72 2072 6573 6861 7069 6e67  ing or reshaping
+0000c610: 2c0a 2020 2020 2020 2020 7769 6c6c 206e  ,.        will n
+0000c620: 6f74 2077 6f72 6b2e 0a20 2020 2020 2020  ot work..       
+0000c630: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0000c640: 7572 6e20 7365 6c66 2e74 6f5f 6461 736b  urn self.to_dask
+0000c650: 5f61 7272 6179 2829 0a0a 2020 2020 6465  _array()..    de
+0000c660: 6620 5f5f 6469 766d 6f64 5f5f 2873 656c  f __divmod__(sel
+0000c670: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+0000c680: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+0000c690: 2e65 7870 722e 5f5f 6469 766d 6f64 5f5f  .expr.__divmod__
+0000c6a0: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
+0000c6b0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0000c6c0: 6374 696f 6e28 7265 7375 6c74 5b30 5d29  ction(result[0])
+0000c6d0: 2c20 6e65 775f 636f 6c6c 6563 7469 6f6e  , new_collection
+0000c6e0: 2872 6573 756c 745b 315d 290a 0a20 2020  (result[1])..   
+0000c6f0: 2064 6566 205f 5f72 6469 766d 6f64 5f5f   def __rdivmod__
+0000c700: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+0000c710: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0000c720: 7365 6c66 2e65 7870 722e 5f5f 7264 6976  self.expr.__rdiv
+0000c730: 6d6f 645f 5f28 6f74 6865 7229 0a20 2020  mod__(other).   
+0000c740: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0000c750: 636f 6c6c 6563 7469 6f6e 2872 6573 756c  collection(resul
+0000c760: 745b 305d 292c 206e 6577 5f63 6f6c 6c65  t[0]), new_colle
+0000c770: 6374 696f 6e28 7265 7375 6c74 5b31 5d29  ction(result[1])
+0000c780: 0a0a 2020 2020 6465 6620 5f5f 6162 735f  ..    def __abs_
+0000c790: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+0000c7a0: 2072 6574 7572 6e20 7365 6c66 2e61 6273   return self.abs
+0000c7b0: 2829 0a0a 2020 2020 4064 6572 6976 6564  ()..    @derived
+0000c7c0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0000c7d0: 6d65 290a 2020 2020 6465 6620 7375 6d28  me).    def sum(
+0000c7e0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000c7f0: 2020 2020 2020 2061 7869 733d 302c 0a20         axis=0,. 
+0000c800: 2020 2020 2020 2073 6b69 706e 613d 5472         skipna=Tr
+0000c810: 7565 2c0a 2020 2020 2020 2020 6e75 6d65  ue,.        nume
+0000c820: 7269 635f 6f6e 6c79 3d46 616c 7365 2c0a  ric_only=False,.
+0000c830: 2020 2020 2020 2020 6d69 6e5f 636f 756e          min_coun
+0000c840: 743d 302c 0a20 2020 2020 2020 2073 706c  t=0,.        spl
+0000c850: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
+0000c860: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0000c870: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000c880: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+0000c890: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+0000c8a0: 290a 2020 2020 2020 2020 6966 2061 7869  ).        if axi
+0000c8b0: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+0000c8c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000c8d0: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0000c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8f0: 4d2e 7375 6d2c 0a20 2020 2020 2020 2020  M.sum,.         
+0000c900: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+0000c910: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+0000c920: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+0000c930: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
+0000c940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c950: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+0000c960: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+0000c970: 636f 756e 743d 6d69 6e5f 636f 756e 742c  count=min_count,
+0000c980: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000c990: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+0000c9a0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0000c9b0: 7365 6c66 2e65 7870 722e 7375 6d28 736b  self.expr.sum(sk
+0000c9c0: 6970 6e61 2c20 6e75 6d65 7269 635f 6f6e  ipna, numeric_on
+0000c9d0: 6c79 2c20 7370 6c69 745f 6576 6572 792c  ly, split_every,
+0000c9e0: 2061 7869 7329 290a 2020 2020 2020 2020   axis)).        
+0000c9f0: 7265 7475 726e 2073 656c 662e 5f61 7070  return self._app
+0000ca00: 6c79 5f6d 696e 5f63 6f75 6e74 2872 6573  ly_min_count(res
+0000ca10: 756c 742c 206d 696e 5f63 6f75 6e74 290a  ult, min_count).
+0000ca20: 0a20 2020 2064 6566 205f 6170 706c 795f  .    def _apply_
+0000ca30: 6d69 6e5f 636f 756e 7428 7365 6c66 2c20  min_count(self, 
+0000ca40: 7265 7375 6c74 2c20 6d69 6e5f 636f 756e  result, min_coun
+0000ca50: 7429 3a0a 2020 2020 2020 2020 6966 206d  t):.        if m
+0000ca60: 696e 5f63 6f75 6e74 3a0a 2020 2020 2020  in_count:.      
+0000ca70: 2020 2020 2020 636f 6e64 203d 2073 656c        cond = sel
+0000ca80: 662e 6e6f 746e 756c 6c28 292e 7375 6d28  f.notnull().sum(
+0000ca90: 2920 3e3d 206d 696e 5f63 6f75 6e74 0a20  ) >= min_count. 
+0000caa0: 2020 2020 2020 2020 2020 2063 6f6e 645f             cond_
+0000cab0: 6d65 7461 203d 2063 6f6e 642e 5f6d 6574  meta = cond._met
+0000cac0: 610a 2020 2020 2020 2020 2020 2020 6966  a.            if
+0000cad0: 206e 6f74 2069 735f 7365 7269 6573 5f6c   not is_series_l
+0000cae0: 696b 6528 636f 6e64 5f6d 6574 6129 3a0a  ike(cond_meta):.
+0000caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb00: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
+0000cb10: 746f 5f73 6572 6965 7328 290a 2020 2020  to_series().    
+0000cb20: 2020 2020 2020 2020 2020 2020 636f 6e64              cond
+0000cb30: 203d 2063 6f6e 642e 746f 5f73 6572 6965   = cond.to_serie
+0000cb40: 7328 290a 0a20 2020 2020 2020 2020 2020  s()..           
+0000cb50: 2072 6573 756c 7420 3d20 7265 7375 6c74   result = result
+0000cb60: 2e77 6865 7265 2863 6f6e 642c 206f 7468  .where(cond, oth
+0000cb70: 6572 3d6e 702e 6e61 6e29 0a20 2020 2020  er=np.nan).     
+0000cb80: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+0000cb90: 5f73 6572 6965 735f 6c69 6b65 2863 6f6e  _series_like(con
+0000cba0: 645f 6d65 7461 293a 0a20 2020 2020 2020  d_meta):.       
+0000cbb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000cbc0: 7265 7375 6c74 2e6d 696e 2829 0a20 2020  result.min().   
+0000cbd0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000cbe0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000cbf0: 6574 7572 6e20 7265 7375 6c74 0a20 2020  eturn result.   
+0000cc00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000cc10: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000cc20: 7375 6c74 0a0a 2020 2020 4064 6572 6976  sult..    @deriv
+0000cc30: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0000cc40: 7261 6d65 290a 2020 2020 6465 6620 7072  rame).    def pr
+0000cc50: 6f64 280a 2020 2020 2020 2020 7365 6c66  od(.        self
+0000cc60: 2c0a 2020 2020 2020 2020 6178 6973 3d30  ,.        axis=0
+0000cc70: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
+0000cc80: 3d54 7275 652c 0a20 2020 2020 2020 206e  =True,.        n
+0000cc90: 756d 6572 6963 5f6f 6e6c 793d 4661 6c73  umeric_only=Fals
+0000cca0: 652c 0a20 2020 2020 2020 206d 696e 5f63  e,.        min_c
+0000ccb0: 6f75 6e74 3d30 2c0a 2020 2020 2020 2020  ount=0,.        
+0000ccc0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+0000ccd0: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
+0000cce0: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
+0000ccf0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+0000cd00: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+0000cd10: 7869 7329 0a20 2020 2020 2020 2069 6620  xis).        if 
+0000cd20: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+0000cd30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000cd40: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0000cd50: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0000cd60: 2020 204d 2e70 726f 642c 0a20 2020 2020     M.prod,.     
+0000cd70: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+0000cd80: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
+0000cd90: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
+0000cda0: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
+0000cdb0: 6e6c 792c 0a20 2020 2020 2020 2020 2020  nly,.           
+0000cdc0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+0000cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cde0: 6d69 6e5f 636f 756e 743d 6d69 6e5f 636f  min_count=min_co
+0000cdf0: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+0000ce00: 2029 0a20 2020 2020 2020 2072 6573 756c   ).        resul
+0000ce10: 7420 3d20 6e65 775f 636f 6c6c 6563 7469  t = new_collecti
+0000ce20: 6f6e 2873 656c 662e 6578 7072 2e70 726f  on(self.expr.pro
+0000ce30: 6428 736b 6970 6e61 2c20 6e75 6d65 7269  d(skipna, numeri
+0000ce40: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
+0000ce50: 6572 792c 2061 7869 7329 290a 2020 2020  ery, axis)).    
+0000ce60: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000ce70: 5f61 7070 6c79 5f6d 696e 5f63 6f75 6e74  _apply_min_count
+0000ce80: 2872 6573 756c 742c 206d 696e 5f63 6f75  (result, min_cou
+0000ce90: 6e74 290a 0a20 2020 2070 726f 6475 6374  nt)..    product
+0000cea0: 203d 2070 726f 640a 0a20 2020 2040 6465   = prod..    @de
+0000ceb0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0000cec0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0000ced0: 2076 6172 280a 2020 2020 2020 2020 7365   var(.        se
+0000cee0: 6c66 2c0a 2020 2020 2020 2020 6178 6973  lf,.        axis
+0000cef0: 3d30 2c0a 2020 2020 2020 2020 736b 6970  =0,.        skip
+0000cf00: 6e61 3d54 7275 652c 0a20 2020 2020 2020  na=True,.       
+0000cf10: 2064 646f 663d 312c 0a20 2020 2020 2020   ddof=1,.       
+0000cf20: 206e 756d 6572 6963 5f6f 6e6c 793d 4661   numeric_only=Fa
+0000cf30: 6c73 652c 0a20 2020 2020 2020 2073 706c  lse,.        spl
+0000cf40: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
+0000cf50: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+0000cf60: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0000cf70: 205f 7261 6973 655f 6966 5f6f 626a 6563   _raise_if_objec
+0000cf80: 745f 7365 7269 6573 2873 656c 662c 2022  t_series(self, "
+0000cf90: 7661 7222 290a 2020 2020 2020 2020 6178  var").        ax
+0000cfa0: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+0000cfb0: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+0000cfc0: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
+0000cfd0: 612e 7661 7228 6178 6973 3d61 7869 732c  a.var(axis=axis,
+0000cfe0: 2073 6b69 706e 613d 736b 6970 6e61 2c20   skipna=skipna, 
+0000cff0: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
+0000d000: 6572 6963 5f6f 6e6c 7929 0a20 2020 2020  eric_only).     
+0000d010: 2020 2066 7261 6d65 203d 2073 656c 660a     frame = self.
+0000d020: 2020 2020 2020 2020 6966 2069 735f 6461          if is_da
+0000d030: 7461 6672 616d 655f 6c69 6b65 2873 656c  taframe_like(sel
+0000d040: 662e 5f6d 6574 6129 2061 6e64 206e 756d  f._meta) and num
+0000d050: 6572 6963 5f6f 6e6c 793a 0a20 2020 2020  eric_only:.     
+0000d060: 2020 2020 2020 2066 7261 6d65 203d 2066         frame = f
+0000d070: 7261 6d65 5b6c 6973 7428 7365 6c66 2e5f  rame[list(self._
+0000d080: 6d65 7461 2e76 6172 286e 756d 6572 6963  meta.var(numeric
+0000d090: 5f6f 6e6c 793d 5472 7565 292e 696e 6465  _only=True).inde
+0000d0a0: 7829 5d0a 2020 2020 2020 2020 7265 7475  x)].        retu
+0000d0b0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+0000d0c0: 6e28 0a20 2020 2020 2020 2020 2020 2066  n(.            f
+0000d0d0: 7261 6d65 2e65 7870 722e 7661 7228 6178  rame.expr.var(ax
+0000d0e0: 6973 2c20 736b 6970 6e61 2c20 6464 6f66  is, skipna, ddof
+0000d0f0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 2c20  , numeric_only, 
+0000d100: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0000d110: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
+0000d120: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+0000d130: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0000d140: 6d65 290a 2020 2020 6465 6620 7374 6428  me).    def std(
+0000d150: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000d160: 2020 2020 2020 2061 7869 733d 302c 0a20         axis=0,. 
+0000d170: 2020 2020 2020 2073 6b69 706e 613d 5472         skipna=Tr
+0000d180: 7565 2c0a 2020 2020 2020 2020 6464 6f66  ue,.        ddof
+0000d190: 3d31 2c0a 2020 2020 2020 2020 6e75 6d65  =1,.        nume
+0000d1a0: 7269 635f 6f6e 6c79 3d46 616c 7365 2c0a  ric_only=False,.
+0000d1b0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0000d1c0: 6572 793d 4661 6c73 652c 0a20 2020 2020  ery=False,.     
+0000d1d0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+0000d1e0: 2029 3a0a 2020 2020 2020 2020 5f72 6169   ):.        _rai
+0000d1f0: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+0000d200: 6965 7328 7365 6c66 2c20 2273 7464 2229  ies(self, "std")
+0000d210: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+0000d220: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+0000d230: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+0000d240: 2020 6e75 6d65 7269 635f 6464 203d 2073    numeric_dd = s
+0000d250: 656c 660a 2020 2020 2020 2020 6d65 7461  elf.        meta
+0000d260: 203d 206d 6574 615f 6e6f 6e65 6d70 7479   = meta_nonempty
+0000d270: 2873 656c 662e 5f6d 6574 6129 2e73 7464  (self._meta).std
+0000d280: 280a 2020 2020 2020 2020 2020 2020 6178  (.            ax
+0000d290: 6973 3d61 7869 732c 2073 6b69 706e 613d  is=axis, skipna=
+0000d2a0: 736b 6970 6e61 2c20 6464 6f66 3d64 646f  skipna, ddof=ddo
+0000d2b0: 662c 206e 756d 6572 6963 5f6f 6e6c 793d  f, numeric_only=
+0000d2c0: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
+0000d2d0: 2020 2020 2029 0a20 2020 2020 2020 206e       ).        n
+0000d2e0: 6565 6473 5f74 696d 655f 636f 6e76 6572  eeds_time_conver
+0000d2f0: 7369 6f6e 2c20 7469 6d65 5f63 6f6c 7320  sion, time_cols 
+0000d300: 3d20 4661 6c73 652c 204e 6f6e 650a 2020  = False, None.  
+0000d310: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
+0000d320: 6672 616d 655f 6c69 6b65 2873 656c 662e  frame_like(self.
+0000d330: 5f6d 6574 6129 3a0a 2020 2020 2020 2020  _meta):.        
+0000d340: 2020 2020 6966 2061 7869 7320 3d3d 2030      if axis == 0
+0000d350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000d360: 2020 6e75 6d65 7269 635f 6464 203d 206e    numeric_dd = n
+0000d370: 756d 6572 6963 5f64 645b 6c69 7374 286d  umeric_dd[list(m
+0000d380: 6574 612e 696e 6465 7829 5d0a 2020 2020  eta.index)].    
+0000d390: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000d3a0: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0000d3b0: 6d65 7269 635f 6464 203d 206e 756d 6572  meric_dd = numer
+0000d3c0: 6963 5f64 642e 636f 7079 2829 0a0a 2020  ic_dd.copy()..  
+0000d3d0: 2020 2020 2020 2020 2020 6966 206e 756d            if num
+0000d3e0: 6572 6963 5f6f 6e6c 7920 6973 2054 7275  eric_only is Tru
+0000d3f0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000d400: 2020 205f 6d65 7461 203d 206e 756d 6572     _meta = numer
+0000d410: 6963 5f64 642e 5f6d 6574 612e 7365 6c65  ic_dd._meta.sele
+0000d420: 6374 5f64 7479 7065 7328 696e 636c 7564  ct_dtypes(includ
+0000d430: 653d 5b6e 702e 6e75 6d62 6572 5d29 0a20  e=[np.number]). 
+0000d440: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000d450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d460: 205f 6d65 7461 203d 206e 756d 6572 6963   _meta = numeric
+0000d470: 5f64 642e 5f6d 6574 610a 2020 2020 2020  _dd._meta.      
+0000d480: 2020 2020 2020 7469 6d65 5f63 6f6c 7320        time_cols 
+0000d490: 3d20 5f6d 6574 612e 7365 6c65 6374 5f64  = _meta.select_d
+0000d4a0: 7479 7065 7328 696e 636c 7564 653d 5b22  types(include=["
+0000d4b0: 6461 7465 7469 6d65 222c 2022 7469 6d65  datetime", "time
+0000d4c0: 6465 6c74 6122 5d29 2e63 6f6c 756d 6e73  delta"]).columns
+0000d4d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000d4e0: 6c65 6e28 7469 6d65 5f63 6f6c 7329 203e  len(time_cols) >
+0000d4f0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0000d500: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+0000d510: 2061 6e64 206c 656e 2874 696d 655f 636f   and len(time_co
+0000d520: 6c73 2920 213d 206c 656e 2873 656c 662e  ls) != len(self.
+0000d530: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
+0000d540: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
+0000d550: 6d65 7269 635f 6464 203d 2066 726f 6d5f  meric_dd = from_
+0000d560: 7061 6e64 6173 280a 2020 2020 2020 2020  pandas(.        
+0000d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d580: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
+0000d590: 7275 6374 6f72 2873 656c 6629 280a 2020  ructor(self)(.  
+0000d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5b0: 2020 2020 2020 2020 2020 7b22 5f22 3a20            {"_": 
+0000d5c0: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
+0000d5d0: 7472 7563 746f 7228 7365 6c66 2928 5b6e  tructor(self)([n
+0000d5e0: 702e 6e61 6e5d 297d 2c0a 2020 2020 2020  p.nan])},.      
+0000d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d600: 2020 2020 2020 696e 6465 783d 7365 6c66        index=self
+0000d610: 2e69 6e64 6578 2c0a 2020 2020 2020 2020  .index,.        
+0000d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d630: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000d640: 2020 2020 2020 2020 2020 206e 7061 7274             npart
+0000d650: 6974 696f 6e73 3d73 656c 662e 6e70 6172  itions=self.npar
+0000d660: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+0000d670: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0000d680: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000d690: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000d6a0: 2020 2020 2020 2020 206e 6565 6473 5f74           needs_t
+0000d6b0: 696d 655f 636f 6e76 6572 7369 6f6e 203d  ime_conversion =
+0000d6c0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0000d6d0: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+0000d6e0: 6c20 696e 2074 696d 655f 636f 6c73 3a0a  l in time_cols:.
+0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d700: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+0000d710: 6464 5b63 6f6c 5d20 3d20 5f63 6f6e 7665  dd[col] = _conve
+0000d720: 7274 5f74 6f5f 6e75 6d65 7269 6328 6e75  rt_to_numeric(nu
+0000d730: 6d65 7269 635f 6464 5b63 6f6c 5d2c 2073  meric_dd[col], s
+0000d740: 6b69 706e 6129 0a20 2020 2020 2020 2065  kipna).        e
+0000d750: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000d760: 206e 6565 6473 5f74 696d 655f 636f 6e76   needs_time_conv
+0000d770: 6572 7369 6f6e 203d 2069 735f 6461 7465  ersion = is_date
+0000d780: 7469 6d65 3634 5f61 6e79 5f64 7479 7065  time64_any_dtype
+0000d790: 2873 656c 662e 5f6d 6574 6129 0a20 2020  (self._meta).   
+0000d7a0: 2020 2020 2020 2020 2069 6620 6e65 6564           if need
+0000d7b0: 735f 7469 6d65 5f63 6f6e 7665 7273 696f  s_time_conversio
+0000d7c0: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+0000d7d0: 2020 206e 756d 6572 6963 5f64 6420 3d20     numeric_dd = 
+0000d7e0: 5f63 6f6e 7665 7274 5f74 6f5f 6e75 6d65  _convert_to_nume
+0000d7f0: 7269 6328 7365 6c66 2c20 736b 6970 6e61  ric(self, skipna
+0000d800: 290a 0a20 2020 2020 2020 2069 6620 6178  )..        if ax
+0000d810: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+0000d820: 2020 2020 2072 6574 7572 6e20 6e75 6d65       return nume
+0000d830: 7269 635f 6464 2e6d 6170 5f70 6172 7469  ric_dd.map_parti
+0000d840: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+0000d850: 2020 2020 2020 204d 2e73 7464 2069 6620         M.std if 
+0000d860: 6e6f 7420 6e65 6564 735f 7469 6d65 5f63  not needs_time_c
+0000d870: 6f6e 7665 7273 696f 6e20 656c 7365 205f  onversion else _
+0000d880: 7371 7274 5f61 6e64 5f63 6f6e 7665 7274  sqrt_and_convert
+0000d890: 5f74 6f5f 7469 6d65 6465 6c74 612c 0a20  _to_timedelta,. 
+0000d8a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000d8b0: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+0000d8c0: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+0000d8d0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+0000d8e0: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+0000d8f0: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+0000d900: 2020 2020 6464 6f66 3d64 646f 662c 0a20      ddof=ddof,. 
+0000d910: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000d920: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+0000d930: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+0000d940: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+0000d950: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+0000d960: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0000d970: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+0000d980: 3d20 6e75 6d65 7269 635f 6464 2e76 6172  = numeric_dd.var
+0000d990: 280a 2020 2020 2020 2020 2020 2020 736b  (.            sk
+0000d9a0: 6970 6e61 3d73 6b69 706e 612c 2064 646f  ipna=skipna, ddo
+0000d9b0: 663d 6464 6f66 2c20 6e75 6d65 7269 635f  f=ddof, numeric_
+0000d9c0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
+0000d9d0: 792c 2073 706c 6974 5f65 7665 7279 3d73  y, split_every=s
+0000d9e0: 706c 6974 5f65 7665 7279 0a20 2020 2020  plit_every.     
+0000d9f0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+0000da00: 206e 6565 6473 5f74 696d 655f 636f 6e76   needs_time_conv
+0000da10: 6572 7369 6f6e 3a0a 2020 2020 2020 2020  ersion:.        
+0000da20: 2020 2020 7371 7274 5f66 756e 635f 6b77      sqrt_func_kw
+0000da30: 6172 6773 203d 207b 0a20 2020 2020 2020  args = {.       
+0000da40: 2020 2020 2020 2020 2022 6973 5f64 665f           "is_df_
+0000da50: 6c69 6b65 223a 2069 735f 6461 7461 6672  like": is_datafr
+0000da60: 616d 655f 6c69 6b65 2873 656c 662e 5f6d  ame_like(self._m
+0000da70: 6574 6129 2c0a 2020 2020 2020 2020 2020  eta),.          
+0000da80: 2020 2020 2020 2274 696d 655f 636f 6c73        "time_cols
+0000da90: 223a 2074 696d 655f 636f 6c73 2c0a 2020  ": time_cols,.  
+0000daa0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0000dab0: 7869 7322 3a20 6178 6973 2c0a 2020 2020  xis": axis,.    
+0000dac0: 2020 2020 2020 2020 2020 2020 2264 7479              "dty
+0000dad0: 7065 223a 2067 6574 6174 7472 286d 6574  pe": getattr(met
+0000dae0: 612c 2022 6474 7970 6522 2c20 4e6f 6e65  a, "dtype", None
+0000daf0: 292c 0a20 2020 2020 2020 2020 2020 207d  ),.            }
+0000db00: 0a20 2020 2020 2020 2020 2020 2073 7172  .            sqr
+0000db10: 745f 6675 6e63 203d 205f 7371 7274 5f61  t_func = _sqrt_a
+0000db20: 6e64 5f63 6f6e 7665 7274 5f74 6f5f 7469  nd_convert_to_ti
+0000db30: 6d65 6465 6c74 610a 2020 2020 2020 2020  medelta.        
+0000db40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000db50: 2020 7371 7274 5f66 756e 635f 6b77 6172    sqrt_func_kwar
+0000db60: 6773 203d 207b 7d0a 2020 2020 2020 2020  gs = {}.        
+0000db70: 2020 2020 7371 7274 5f66 756e 6320 3d20      sqrt_func = 
+0000db80: 6e70 2e73 7172 740a 0a20 2020 2020 2020  np.sqrt..       
+0000db90: 2072 6573 756c 7420 3d20 7265 7375 6c74   result = result
+0000dba0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+0000dbb0: 0a20 2020 2020 2020 2020 2020 2073 7172  .            sqr
+0000dbc0: 745f 6675 6e63 2c0a 2020 2020 2020 2020  t_func,.        
+0000dbd0: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+0000dbe0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+0000dbf0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0000dc00: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
+0000dc10: 6172 656e 745f 6d65 7461 3d73 656c 662e  arent_meta=self.
+0000dc20: 5f6d 6574 612c 0a20 2020 2020 2020 2020  _meta,.         
+0000dc30: 2020 202a 2a73 7172 745f 6675 6e63 5f6b     **sqrt_func_k
+0000dc40: 7761 7267 732c 0a20 2020 2020 2020 2029  wargs,.        )
+0000dc50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000dc60: 7265 7375 6c74 0a0a 2020 2020 6465 6620  result..    def 
+0000dc70: 656e 666f 7263 655f 7275 6e74 696d 655f  enforce_runtime_
+0000dc80: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
+0000dc90: 0a20 2020 2020 2020 2022 2222 456e 666f  .        """Enfo
+0000dca0: 7263 6520 7468 6520 6375 7272 656e 7420  rce the current 
+0000dcb0: 6469 7669 7369 6f6e 7320 6174 2072 756e  divisions at run
+0000dcc0: 7469 6d65 2e0a 0a20 2020 2020 2020 2049  time...        I
+0000dcd0: 6e6a 6563 7473 2061 206c 6179 6572 2069  njects a layer i
+0000dce0: 6e74 6f20 7468 6520 5461 736b 2047 7261  nto the Task Gra
+0000dcf0: 7068 2074 6861 7420 6368 6563 6b73 2074  ph that checks t
+0000dd00: 6861 7420 7468 6520 6375 7272 656e 7420  hat the current 
+0000dd10: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+0000dd20: 2020 6d61 7463 6820 7468 6520 6578 7065    match the expe
+0000dd30: 6374 6564 2064 6976 6973 696f 6e73 2061  cted divisions a
+0000dd40: 7420 7275 6e74 696d 652e 0a20 2020 2020  t runtime..     
+0000dd50: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000dd60: 6620 6e6f 7420 7365 6c66 2e6b 6e6f 776e  f not self.known
+0000dd70: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
+0000dd80: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000dd90: 6c75 6545 7272 6f72 2822 4e6f 206b 6e6f  lueError("No kno
+0000dda0: 776e 2064 6976 6973 696f 6e73 2074 6f20  wn divisions to 
+0000ddb0: 656e 666f 7263 6521 2229 0a20 2020 2020  enforce!").     
+0000ddc0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+0000ddd0: 6c6c 6563 7469 6f6e 2865 7870 722e 456e  llection(expr.En
+0000dde0: 666f 7263 6552 756e 7469 6d65 4469 7669  forceRuntimeDivi
+0000ddf0: 7369 6f6e 7328 7365 6c66 2929 0a0a 2020  sions(self))..  
+0000de00: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0000de10: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0000de20: 2020 6465 6620 736b 6577 280a 2020 2020    def skew(.    
+0000de30: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000de40: 2020 6178 6973 3d30 2c0a 2020 2020 2020    axis=0,.      
+0000de50: 2020 6269 6173 3d54 7275 652c 0a20 2020    bias=True,.   
+0000de60: 2020 2020 206e 616e 5f70 6f6c 6963 793d       nan_policy=
+0000de70: 2270 726f 7061 6761 7465 222c 0a20 2020  "propagate",.   
+0000de80: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+0000de90: 793d 4661 6c73 652c 0a20 2020 2029 3a0a  y=False,.    ):.
+0000dea0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000deb0: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
+0000dec0: 2020 2020 2020 2020 2020 5468 6973 2069            This i
+0000ded0: 6d70 6c65 6d65 6e74 6174 696f 6e20 666f  mplementation fo
+0000dee0: 6c6c 6f77 7320 7468 6520 6461 736b 2e61  llows the dask.a
+0000def0: 7272 6179 2e73 7461 7473 2069 6d70 6c65  rray.stats imple
+0000df00: 6d65 6e74 6174 696f 6e0a 2020 2020 2020  mentation.      
+0000df10: 2020 2020 206f 6620 736b 6577 6e65 7373       of skewness
+0000df20: 2061 6e64 2063 616c 6375 6c61 7465 7320   and calculates 
+0000df30: 736b 6577 6e65 7373 2077 6974 686f 7574  skewness without
+0000df40: 2074 616b 696e 6720 696e 746f 2061 6363   taking into acc
+0000df50: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
+0000df60: 6120 6269 6173 2074 6572 6d20 666f 7220  a bias term for 
+0000df70: 6669 6e69 7465 2073 616d 706c 6520 7369  finite sample si
+0000df80: 7a65 2c20 7768 6963 6820 636f 7272 6573  ze, which corres
+0000df90: 706f 6e64 7320 746f 2074 6865 0a20 2020  ponds to the.   
+0000dfa0: 2020 2020 2020 2020 6465 6661 756c 7420          default 
+0000dfb0: 7365 7474 696e 6773 206f 6620 7468 6520  settings of the 
+0000dfc0: 7363 6970 792e 7374 6174 7320 736b 6577  scipy.stats skew
+0000dfd0: 6e65 7373 2063 616c 6375 6c61 7469 6f6e  ness calculation
+0000dfe0: 2e20 486f 7765 7665 722c 0a20 2020 2020  . However,.     
+0000dff0: 2020 2020 2020 5061 6e64 6173 2063 6f72        Pandas cor
+0000e000: 7265 6374 7320 666f 7220 7468 6973 2c20  rects for this, 
+0000e010: 736f 2074 6865 2076 616c 7565 7320 6469  so the values di
+0000e020: 6666 6572 2062 7920 6120 6661 6374 6f72  ffer by a factor
+0000e030: 206f 660a 2020 2020 2020 2020 2020 2028   of.           (
+0000e040: 6e20 2a20 286e 202d 2031 2929 202a 2a20  n * (n - 1)) ** 
+0000e050: 302e 3520 2f20 286e 202d 2032 292c 2077  0.5 / (n - 2), w
+0000e060: 6865 7265 206e 2069 7320 7468 6520 6e75  here n is the nu
+0000e070: 6d62 6572 206f 6620 7361 6d70 6c65 732e  mber of samples.
+0000e080: 0a0a 2020 2020 2020 2020 2020 2046 7572  ..           Fur
+0000e090: 7468 6572 2c20 7468 6973 206d 6574 686f  ther, this metho
+0000e0a0: 6420 6375 7272 656e 746c 7920 646f 6573  d currently does
+0000e0b0: 206e 6f74 2073 7570 706f 7274 2066 696c   not support fil
+0000e0c0: 7465 7269 6e67 206f 7574 204e 614e 0a20  tering out NaN. 
+0000e0d0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+0000e0e0: 2c20 7768 6963 6820 6973 2061 6761 696e  , which is again
+0000e0f0: 2061 2064 6966 6665 7265 6e63 6520 746f   a difference to
+0000e100: 2050 616e 6461 732e 0a20 2020 2020 2020   Pandas..       
+0000e110: 2022 2222 0a20 2020 2020 2020 205f 7261   """.        _ra
+0000e120: 6973 655f 6966 5f6f 626a 6563 745f 7365  ise_if_object_se
+0000e130: 7269 6573 2873 656c 662c 2022 736b 6577  ries(self, "skew
+0000e140: 2229 0a20 2020 2020 2020 2069 6620 6178  ").        if ax
+0000e150: 6973 2069 7320 4e6f 6e65 3a0a 2020 2020  is is None:.    
+0000e160: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000e170: 6c75 6545 7272 6f72 2822 6061 7869 733d  lueError("`axis=
+0000e180: 4e6f 6e65 6020 6973 6e27 7420 6375 7272  None` isn't curr
+0000e190: 656e 746c 7920 7375 7070 6f72 7465 6420  ently supported 
+0000e1a0: 666f 7220 6073 6b65 7760 2229 0a20 2020  for `skew`").   
+0000e1b0: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
+0000e1c0: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
+0000e1d0: 6178 6973 290a 0a20 2020 2020 2020 2069  axis)..        i
+0000e1e0: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+0000e1f0: 696b 6528 7365 6c66 293a 0a20 2020 2020  ike(self):.     
+0000e200: 2020 2020 2020 2023 204c 6574 2070 616e         # Let pan
+0000e210: 6461 7320 7261 6973 6520 6572 726f 7273  das raise errors
+0000e220: 2069 6620 6e65 6365 7373 6172 790a 2020   if necessary.  
+0000e230: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+0000e240: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+0000e250: 6d70 7479 2e73 6b65 7728 6178 6973 3d61  mpty.skew(axis=a
+0000e260: 7869 732c 206e 756d 6572 6963 5f6f 6e6c  xis, numeric_onl
+0000e270: 793d 6e75 6d65 7269 635f 6f6e 6c79 290a  y=numeric_only).
+0000e280: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000e290: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+0000e2a0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+0000e2b0: 6d70 7479 2e73 6b65 7728 290a 0a20 2020  mpty.skew()..   
+0000e2c0: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
+0000e2d0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0000e2e0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0000e2f0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0000e300: 2020 2020 2020 2020 2020 204d 2e73 6b65             M.ske
+0000e310: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
+0000e320: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+0000e330: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0000e340: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0000e350: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+0000e360: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+0000e370: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000e380: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
+0000e390: 6961 733a 0a20 2020 2020 2020 2020 2020  ias:.           
+0000e3a0: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0000e3b0: 656e 7465 6445 7272 6f72 2822 6269 6173  entedError("bias
+0000e3c0: 3d46 616c 7365 2069 7320 6e6f 7420 696d  =False is not im
+0000e3d0: 706c 656d 656e 7465 642e 2229 0a20 2020  plemented.").   
+0000e3e0: 2020 2020 2069 6620 6e61 6e5f 706f 6c69       if nan_poli
+0000e3f0: 6379 2021 3d20 2270 726f 7061 6761 7465  cy != "propagate
+0000e400: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+0000e410: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0000e420: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0000e430: 2020 2020 2020 2020 2020 2260 6e61 6e5f            "`nan_
+0000e440: 706f 6c69 6379 6020 6f74 6865 7220 7468  policy` other th
+0000e450: 616e 2027 7072 6f70 6167 6174 6527 2068  an 'propagate' h
+0000e460: 6176 6520 6e6f 7420 6265 656e 2069 6d70  ave not been imp
+0000e470: 6c65 6d65 6e74 6564 2e22 0a20 2020 2020  lemented.".     
+0000e480: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000e490: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
+0000e4a0: 2020 2020 2020 2069 6620 6672 616d 652e         if frame.
+0000e4b0: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
+0000e4c0: 2020 2020 2020 6672 616d 6520 3d20 6672        frame = fr
+0000e4d0: 616d 652e 7365 6c65 6374 5f64 7479 7065  ame.select_dtype
+0000e4e0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0000e4f0: 2020 2069 6e63 6c75 6465 3d5b 226e 756d     include=["num
+0000e500: 6265 7222 2c20 2262 6f6f 6c22 5d2c 2065  ber", "bool"], e
+0000e510: 7863 6c75 6465 3d5b 6e70 2e74 696d 6564  xclude=[np.timed
+0000e520: 656c 7461 3634 5d0a 2020 2020 2020 2020  elta64].        
+0000e530: 2020 2020 290a 2020 2020 2020 2020 6d32      ).        m2
+0000e540: 203d 206e 6577 5f63 6f6c 6c65 6374 696f   = new_collectio
+0000e550: 6e28 4d6f 6d65 6e74 2866 7261 6d65 2c20  n(Moment(frame, 
+0000e560: 6f72 6465 723d 3229 290a 2020 2020 2020  order=2)).      
+0000e570: 2020 6d33 203d 206e 6577 5f63 6f6c 6c65    m3 = new_colle
+0000e580: 6374 696f 6e28 4d6f 6d65 6e74 2866 7261  ction(Moment(fra
+0000e590: 6d65 2c20 6f72 6465 723d 3329 290a 2020  me, order=3)).  
+0000e5a0: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
+0000e5b0: 3320 2f20 6d32 2a2a 312e 350a 2020 2020  3 / m2**1.5.    
+0000e5c0: 2020 2020 6966 2072 6573 756c 742e 6e64      if result.nd
+0000e5d0: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+0000e5e0: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
+0000e5f0: 7375 6c74 2e66 696c 6c6e 6128 302e 3029  sult.fillna(0.0)
+0000e600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000e610: 7265 7375 6c74 0a0a 2020 2020 4064 6572  result..    @der
+0000e620: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0000e630: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0000e640: 6b75 7274 6f73 6973 280a 2020 2020 2020  kurtosis(.      
+0000e650: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000e660: 6178 6973 3d30 2c0a 2020 2020 2020 2020  axis=0,.        
+0000e670: 6669 7368 6572 3d54 7275 652c 0a20 2020  fisher=True,.   
+0000e680: 2020 2020 2062 6961 733d 5472 7565 2c0a       bias=True,.
+0000e690: 2020 2020 2020 2020 6e61 6e5f 706f 6c69          nan_poli
+0000e6a0: 6379 3d22 7072 6f70 6167 6174 6522 2c0a  cy="propagate",.
+0000e6b0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+0000e6c0: 6f6e 6c79 3d46 616c 7365 2c0a 2020 2020  only=False,.    
+0000e6d0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0000e6e0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+0000e6f0: 0a0a 2020 2020 2020 2020 2020 2054 6869  ..           Thi
+0000e700: 7320 696d 706c 656d 656e 7461 7469 6f6e  s implementation
+0000e710: 2066 6f6c 6c6f 7773 2074 6865 2064 6173   follows the das
+0000e720: 6b2e 6172 7261 792e 7374 6174 7320 696d  k.array.stats im
+0000e730: 706c 656d 656e 7461 7469 6f6e 0a20 2020  plementation.   
+0000e740: 2020 2020 2020 2020 6f66 206b 7572 746f          of kurto
+0000e750: 7369 7320 616e 6420 6361 6c63 756c 6174  sis and calculat
+0000e760: 6573 206b 7572 746f 7369 7320 7769 7468  es kurtosis with
+0000e770: 6f75 7420 7461 6b69 6e67 2069 6e74 6f20  out taking into 
+0000e780: 6163 636f 756e 740a 2020 2020 2020 2020  account.        
+0000e790: 2020 2061 2062 6961 7320 7465 726d 2066     a bias term f
+0000e7a0: 6f72 2066 696e 6974 6520 7361 6d70 6c65  or finite sample
+0000e7b0: 2073 697a 652c 2077 6869 6368 2063 6f72   size, which cor
+0000e7c0: 7265 7370 6f6e 6473 2074 6f20 7468 650a  responds to the.
+0000e7d0: 2020 2020 2020 2020 2020 2064 6566 6175             defau
+0000e7e0: 6c74 2073 6574 7469 6e67 7320 6f66 2074  lt settings of t
+0000e7f0: 6865 2073 6369 7079 2e73 7461 7473 206b  he scipy.stats k
+0000e800: 7572 746f 7369 7320 6361 6c63 756c 6174  urtosis calculat
+0000e810: 696f 6e2e 2054 6869 7320 6469 6666 6572  ion. This differ
+0000e820: 730a 2020 2020 2020 2020 2020 2066 726f  s.           fro
+0000e830: 6d20 7061 6e64 6173 2e0a 0a20 2020 2020  m pandas...     
+0000e840: 2020 2020 2020 4675 7274 6865 722c 2074        Further, t
+0000e850: 6869 7320 6d65 7468 6f64 2063 7572 7265  his method curre
+0000e860: 6e74 6c79 2064 6f65 7320 6e6f 7420 7375  ntly does not su
+0000e870: 7070 6f72 7420 6669 6c74 6572 696e 6720  pport filtering 
+0000e880: 6f75 7420 4e61 4e0a 2020 2020 2020 2020  out NaN.        
+0000e890: 2020 2076 616c 7565 732c 2077 6869 6368     values, which
+0000e8a0: 2069 7320 6167 6169 6e20 6120 6469 6666   is again a diff
+0000e8b0: 6572 656e 6365 2074 6f20 5061 6e64 6173  erence to Pandas
+0000e8c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000e8d0: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
+0000e8e0: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
+0000e8f0: 6c66 2c20 226b 7572 746f 7369 7322 290a  lf, "kurtosis").
+0000e900: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+0000e910: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000e920: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000e930: 4572 726f 7228 2260 6178 6973 3d4e 6f6e  Error("`axis=Non
+0000e940: 6560 2069 736e 2774 2063 7572 7265 6e74  e` isn't current
+0000e950: 6c79 2073 7570 706f 7274 6564 2066 6f72  ly supported for
+0000e960: 2060 736b 6577 6022 290a 2020 2020 2020   `skew`").      
+0000e970: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+0000e980: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+0000e990: 7329 0a0a 2020 2020 2020 2020 6966 2069  s)..        if i
+0000e9a0: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
+0000e9b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000e9c0: 2020 2020 2320 4c65 7420 7061 6e64 6173      # Let pandas
+0000e9d0: 2072 6169 7365 2065 7272 6f72 7320 6966   raise errors if
+0000e9e0: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
+0000e9f0: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+0000ea00: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+0000ea10: 792e 6b75 7274 6f73 6973 2861 7869 733d  y.kurtosis(axis=
+0000ea20: 6178 6973 2c20 6e75 6d65 7269 635f 6f6e  axis, numeric_on
+0000ea30: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 7929  ly=numeric_only)
+0000ea40: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000ea50: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+0000ea60: 3d20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  = self._meta_non
+0000ea70: 656d 7074 792e 6b75 7274 6f73 6973 2829  empty.kurtosis()
+0000ea80: 0a0a 2020 2020 2020 2020 6966 2061 7869  ..        if axi
+0000ea90: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+0000eaa0: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+0000eab0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0000eac0: 2020 2020 2020 2020 2020 204d 2e6b 7572             M.kur
+0000ead0: 746f 7369 732c 0a20 2020 2020 2020 2020  tosis,.         
+0000eae0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0000eaf0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+0000eb00: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
+0000eb10: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
+0000eb20: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+0000eb30: 202b 2022 6b75 7274 6f73 6973 222c 0a20   + "kurtosis",. 
+0000eb40: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0000eb50: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
+0000eb60: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
+0000eb70: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0000eb80: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0000eb90: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0000eba0: 6269 6173 3a0a 2020 2020 2020 2020 2020  bias:.          
+0000ebb0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0000ebc0: 6d65 6e74 6564 4572 726f 7228 2262 6961  mentedError("bia
+0000ebd0: 733d 4661 6c73 6520 6973 206e 6f74 2069  s=False is not i
+0000ebe0: 6d70 6c65 6d65 6e74 6564 2e22 290a 2020  mplemented.").  
+0000ebf0: 2020 2020 2020 6966 206e 616e 5f70 6f6c        if nan_pol
+0000ec00: 6963 7920 213d 2022 7072 6f70 6167 6174  icy != "propagat
+0000ec10: 6522 3a0a 2020 2020 2020 2020 2020 2020  e":.            
+0000ec20: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0000ec30: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0000ec40: 2020 2020 2020 2020 2020 2022 606e 616e             "`nan
+0000ec50: 5f70 6f6c 6963 7960 206f 7468 6572 2074  _policy` other t
+0000ec60: 6861 6e20 2770 726f 7061 6761 7465 2720  han 'propagate' 
+0000ec70: 6861 7665 206e 6f74 2062 6565 6e20 696d  have not been im
+0000ec80: 706c 656d 656e 7465 642e 220a 2020 2020  plemented.".    
+0000ec90: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000eca0: 2020 2066 7261 6d65 203d 2073 656c 660a     frame = self.
+0000ecb0: 2020 2020 2020 2020 6966 2066 7261 6d65          if frame
+0000ecc0: 2e6e 6469 6d20 3e20 313a 0a20 2020 2020  .ndim > 1:.     
+0000ecd0: 2020 2020 2020 2066 7261 6d65 203d 2066         frame = f
+0000ece0: 7261 6d65 2e73 656c 6563 745f 6474 7970  rame.select_dtyp
+0000ecf0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+0000ed00: 2020 2020 696e 636c 7564 653d 5b22 6e75      include=["nu
+0000ed10: 6d62 6572 222c 2022 626f 6f6c 225d 2c20  mber", "bool"], 
+0000ed20: 6578 636c 7564 653d 5b6e 702e 7469 6d65  exclude=[np.time
+0000ed30: 6465 6c74 6136 345d 0a20 2020 2020 2020  delta64].       
+0000ed40: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
+0000ed50: 3220 3d20 6e65 775f 636f 6c6c 6563 7469  2 = new_collecti
+0000ed60: 6f6e 284d 6f6d 656e 7428 6672 616d 652c  on(Moment(frame,
+0000ed70: 206f 7264 6572 3d32 2929 0a20 2020 2020   order=2)).     
+0000ed80: 2020 206d 3420 3d20 6e65 775f 636f 6c6c     m4 = new_coll
+0000ed90: 6563 7469 6f6e 284d 6f6d 656e 7428 6672  ection(Moment(fr
+0000eda0: 616d 652c 206f 7264 6572 3d34 2929 0a20  ame, order=4)). 
+0000edb0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0000edc0: 6d34 202f 206d 322a 2a32 2e30 0a20 2020  m4 / m2**2.0.   
+0000edd0: 2020 2020 2069 6620 7265 7375 6c74 2e6e       if result.n
+0000ede0: 6469 6d20 3d3d 2031 3a0a 2020 2020 2020  dim == 1:.      
+0000edf0: 2020 2020 2020 7265 7375 6c74 203d 2072        result = r
+0000ee00: 6573 756c 742e 6669 6c6c 6e61 2830 2e30  esult.fillna(0.0
+0000ee10: 290a 2020 2020 2020 2020 6966 2066 6973  ).        if fis
+0000ee20: 6865 723a 0a20 2020 2020 2020 2020 2020  her:.           
+0000ee30: 2072 6574 7572 6e20 7265 7375 6c74 202d   return result -
+0000ee40: 2033 0a20 2020 2020 2020 2065 6c73 653a   3.        else:
+0000ee50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ee60: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
+0000ee70: 6b75 7274 203d 206b 7572 746f 7369 730a  kurt = kurtosis.
+0000ee80: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0000ee90: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0000eea0: 0a20 2020 2064 6566 2073 656d 280a 2020  .    def sem(.  
+0000eeb0: 2020 2020 2020 7365 6c66 2c20 6178 6973        self, axis
+0000eec0: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
+0000eed0: 7565 2c20 6464 6f66 3d31 2c20 7370 6c69  ue, ddof=1, spli
+0000eee0: 745f 6576 6572 793d 4661 6c73 652c 206e  t_every=False, n
+0000eef0: 756d 6572 6963 5f6f 6e6c 793d 4661 6c73  umeric_only=Fals
+0000ef00: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
+0000ef10: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+0000ef20: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+0000ef30: 290a 2020 2020 2020 2020 5f72 6169 7365  ).        _raise
+0000ef40: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
+0000ef50: 7328 7365 6c66 2c20 2273 656d 2229 0a20  s(self, "sem"). 
+0000ef60: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+0000ef70: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+0000ef80: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+0000ef90: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0000efa0: 2020 2020 2020 2020 2020 2020 204d 2e73               M.s
+0000efb0: 656d 2c0a 2020 2020 2020 2020 2020 2020  em,.            
+0000efc0: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+0000efd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000efe0: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+0000eff0: 2020 2020 2020 2020 2020 2020 2020 6464                dd
+0000f000: 6f66 3d64 646f 662c 0a20 2020 2020 2020  of=ddof,.       
+0000f010: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+0000f020: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
+0000f030: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
+0000f040: 290a 2020 2020 2020 2020 6d65 7461 203d  ).        meta =
+0000f050: 2073 656c 662e 5f6d 6574 612e 7365 6d28   self._meta.sem(
+0000f060: 736b 6970 6e61 3d73 6b69 706e 612c 2064  skipna=skipna, d
+0000f070: 646f 663d 6464 6f66 2c20 6e75 6d65 7269  dof=ddof, numeri
+0000f080: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
+0000f090: 6e6c 7929 0a20 2020 2020 2020 2066 7261  nly).        fra
+0000f0a0: 6d65 203d 2073 656c 660a 2020 2020 2020  me = self.      
+0000f0b0: 2020 6966 2073 656c 662e 6e64 696d 203d    if self.ndim =
+0000f0c0: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+0000f0d0: 2066 7261 6d65 203d 2073 656c 665b 6c69   frame = self[li
+0000f0e0: 7374 286d 6574 612e 696e 6465 7829 5d0a  st(meta.index)].
+0000f0f0: 0a20 2020 2020 2020 2076 203d 2066 7261  .        v = fra
+0000f100: 6d65 2e76 6172 2873 6b69 706e 613d 736b  me.var(skipna=sk
+0000f110: 6970 6e61 2c20 6464 6f66 3d64 646f 662c  ipna, ddof=ddof,
+0000f120: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+0000f130: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+0000f140: 2020 6e20 3d20 6672 616d 652e 636f 756e    n = frame.coun
+0000f150: 7428 7370 6c69 745f 6576 6572 793d 7370  t(split_every=sp
+0000f160: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+0000f170: 2020 2072 6573 756c 7420 3d20 6d61 705f     result = map_
+0000f180: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0000f190: 2020 2020 2020 2020 6e70 2e73 7172 742c          np.sqrt,
+0000f1a0: 0a20 2020 2020 2020 2020 2020 2076 202f  .            v /
+0000f1b0: 206e 2c0a 2020 2020 2020 2020 2020 2020   n,.            
+0000f1c0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+0000f1d0: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+0000f1e0: 6574 6164 6174 613d 4661 6c73 652c 0a20  etadata=False,. 
+0000f1f0: 2020 2020 2020 2020 2020 2070 6172 656e             paren
+0000f200: 745f 6d65 7461 3d73 656c 662e 5f6d 6574  t_meta=self._met
+0000f210: 612c 0a20 2020 2020 2020 2029 0a20 2020  a,.        ).   
+0000f220: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+0000f230: 6c74 0a0a 2020 2020 6465 6620 5f70 7265  lt..    def _pre
+0000f240: 7061 7265 5f63 6f76 5f63 6f72 7228 7365  pare_cov_corr(se
+0000f250: 6c66 2c20 6d69 6e5f 7065 7269 6f64 732c  lf, min_periods,
+0000f260: 206e 756d 6572 6963 5f6f 6e6c 7929 3a0a   numeric_only):.
+0000f270: 2020 2020 2020 2020 6966 206d 696e 5f70          if min_p
+0000f280: 6572 696f 6473 2069 7320 4e6f 6e65 3a0a  eriods is None:.
+0000f290: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+0000f2a0: 7065 7269 6f64 7320 3d20 320a 2020 2020  periods = 2.    
+0000f2b0: 2020 2020 656c 6966 206d 696e 5f70 6572      elif min_per
+0000f2c0: 696f 6473 203c 2032 3a0a 2020 2020 2020  iods < 2:.      
+0000f2d0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000f2e0: 6545 7272 6f72 2822 6d69 6e5f 7065 7269  eError("min_peri
+0000f2f0: 6f64 7320 6d75 7374 2062 6520 3e3d 2032  ods must be >= 2
+0000f300: 2229 0a0a 2020 2020 2020 2020 7365 6c66  ")..        self
+0000f310: 2e5f 6d65 7461 2e63 6f76 286e 756d 6572  ._meta.cov(numer
+0000f320: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
+0000f330: 6f6e 6c79 2c20 6d69 6e5f 7065 7269 6f64  only, min_period
+0000f340: 733d 6d69 6e5f 7065 7269 6f64 7329 0a0a  s=min_periods)..
+0000f350: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
+0000f360: 7365 6c66 0a20 2020 2020 2020 2069 6620  self.        if 
+0000f370: 6e75 6d65 7269 635f 6f6e 6c79 3a0a 2020  numeric_only:.  
+0000f380: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
+0000f390: 6373 203d 2073 656c 662e 5f6d 6574 612e  cs = self._meta.
+0000f3a0: 5f67 6574 5f6e 756d 6572 6963 5f64 6174  _get_numeric_dat
+0000f3b0: 6128 290a 2020 2020 2020 2020 2020 2020  a().            
+0000f3c0: 6966 206c 656e 286e 756d 6572 6963 732e  if len(numerics.
+0000f3d0: 636f 6c75 6d6e 7329 2021 3d20 6c65 6e28  columns) != len(
+0000f3e0: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
+0000f3f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f400: 7261 6d65 203d 2066 7261 6d65 5b6c 6973  rame = frame[lis
+0000f410: 7428 6e75 6d65 7269 6373 2e63 6f6c 756d  t(numerics.colum
+0000f420: 6e73 295d 0a20 2020 2020 2020 2072 6574  ns)].        ret
+0000f430: 7572 6e20 6672 616d 652c 206d 696e 5f70  urn frame, min_p
+0000f440: 6572 696f 6473 0a0a 2020 2020 6465 6620  eriods..    def 
+0000f450: 5f63 6f76 280a 2020 2020 2020 2020 7365  _cov(.        se
+0000f460: 6c66 2c20 6d69 6e5f 7065 7269 6f64 733d  lf, min_periods=
+0000f470: 4e6f 6e65 2c20 6e75 6d65 7269 635f 6f6e  None, numeric_on
+0000f480: 6c79 3d46 616c 7365 2c20 7370 6c69 745f  ly=False, split_
+0000f490: 6576 6572 793d 4661 6c73 652c 2073 6361  every=False, sca
+0000f4a0: 6c61 723d 4661 6c73 650a 2020 2020 293a  lar=False.    ):
+0000f4b0: 0a20 2020 2020 2020 2066 7261 6d65 2c20  .        frame, 
+0000f4c0: 6d69 6e5f 7065 7269 6f64 7320 3d20 7365  min_periods = se
+0000f4d0: 6c66 2e5f 7072 6570 6172 655f 636f 765f  lf._prepare_cov_
+0000f4e0: 636f 7272 286d 696e 5f70 6572 696f 6473  corr(min_periods
+0000f4f0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 290a  , numeric_only).
+0000f500: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0000f510: 6577 5f63 6f6c 6c65 6374 696f 6e28 436f  ew_collection(Co
+0000f520: 7628 6672 616d 652c 206d 696e 5f70 6572  v(frame, min_per
+0000f530: 696f 6473 2c20 7370 6c69 745f 6576 6572  iods, split_ever
+0000f540: 792c 2073 6361 6c61 7229 290a 0a20 2020  y, scalar))..   
+0000f550: 2064 6566 205f 636f 7272 280a 2020 2020   def _corr(.    
+0000f560: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000f570: 2020 6d65 7468 6f64 3d22 7065 6172 736f    method="pearso
+0000f580: 6e22 2c0a 2020 2020 2020 2020 6d69 6e5f  n",.        min_
+0000f590: 7065 7269 6f64 733d 4e6f 6e65 2c0a 2020  periods=None,.  
+0000f5a0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+0000f5b0: 6c79 3d46 616c 7365 2c0a 2020 2020 2020  ly=False,.      
+0000f5c0: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
+0000f5d0: 6c73 652c 0a20 2020 2020 2020 2073 6361  lse,.        sca
+0000f5e0: 6c61 723d 4661 6c73 652c 0a20 2020 2029  lar=False,.    )
+0000f5f0: 3a0a 2020 2020 2020 2020 6966 206d 6574  :.        if met
+0000f600: 686f 6420 213d 2022 7065 6172 736f 6e22  hod != "pearson"
+0000f610: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000f620: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0000f630: 6564 4572 726f 7228 224f 6e6c 7920 5065  edError("Only Pe
+0000f640: 6172 736f 6e20 636f 7272 656c 6174 696f  arson correlatio
+0000f650: 6e20 6861 7320 6265 656e 2069 6d70 6c65  n has been imple
+0000f660: 6d65 6e74 6564 2229 0a20 2020 2020 2020  mented").       
+0000f670: 2066 7261 6d65 2c20 6d69 6e5f 7065 7269   frame, min_peri
+0000f680: 6f64 7320 3d20 7365 6c66 2e5f 7072 6570  ods = self._prep
+0000f690: 6172 655f 636f 765f 636f 7272 286d 696e  are_cov_corr(min
+0000f6a0: 5f70 6572 696f 6473 2c20 6e75 6d65 7269  _periods, numeri
+0000f6b0: 635f 6f6e 6c79 290a 2020 2020 2020 2020  c_only).        
+0000f6c0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0000f6d0: 6374 696f 6e28 436f 7272 2866 7261 6d65  ction(Corr(frame
+0000f6e0: 2c20 6d69 6e5f 7065 7269 6f64 732c 2073  , min_periods, s
+0000f6f0: 706c 6974 5f65 7665 7279 2c20 7363 616c  plit_every, scal
+0000f700: 6172 2929 0a0a 2020 2020 4064 6572 6976  ar))..    @deriv
+0000f710: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0000f720: 7261 6d65 290a 2020 2020 6465 6620 6d65  rame).    def me
+0000f730: 616e 280a 2020 2020 2020 2020 7365 6c66  an(.        self
+0000f740: 2c20 6178 6973 3d30 2c20 736b 6970 6e61  , axis=0, skipna
+0000f750: 3d54 7275 652c 206e 756d 6572 6963 5f6f  =True, numeric_o
+0000f760: 6e6c 793d 4661 6c73 652c 2073 706c 6974  nly=False, split
+0000f770: 5f65 7665 7279 3d46 616c 7365 2c20 2a2a  _every=False, **
+0000f780: 6b77 6172 6773 0a20 2020 2029 3a0a 2020  kwargs.    ):.  
+0000f790: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
+0000f7a0: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
+0000f7b0: 6c66 2c20 226d 6561 6e22 290a 2020 2020  lf, "mean").    
+0000f7c0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+0000f7d0: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+0000f7e0: 7869 7329 0a20 2020 2020 2020 2069 6620  xis).        if 
+0000f7f0: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+0000f800: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000f810: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0000f820: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0000f830: 2020 204d 2e6d 6561 6e2c 2073 6b69 706e     M.mean, skipn
+0000f840: 613d 736b 6970 6e61 2c20 6e75 6d65 7269  a=skipna, numeri
+0000f850: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
+0000f860: 6e6c 792c 2061 7869 733d 6178 6973 0a20  nly, axis=axis. 
+0000f870: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000f880: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0000f890: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+0000f8a0: 2020 2020 2020 2020 7365 6c66 2e65 7870          self.exp
+0000f8b0: 722e 6d65 616e 2873 6b69 706e 612c 206e  r.mean(skipna, n
+0000f8c0: 756d 6572 6963 5f6f 6e6c 792c 2073 706c  umeric_only, spl
+0000f8d0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0000f8e0: 7665 7279 2c20 6178 6973 3d61 7869 7329  very, axis=axis)
+0000f8f0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000f900: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0000f910: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0000f920: 6465 6620 6d61 7828 7365 6c66 2c20 6178  def max(self, ax
+0000f930: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
+0000f940: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
+0000f950: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
+0000f960: 7279 3d46 616c 7365 2c20 2a2a 6b77 6172  ry=False, **kwar
+0000f970: 6773 293a 0a20 2020 2020 2020 2061 7869  gs):.        axi
+0000f980: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+0000f990: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+0000f9a0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+0000f9b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0000f9c0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+0000f9d0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0000f9e0: 2020 2020 2020 2020 2020 2020 4d2e 6d61              M.ma
+0000f9f0: 782c 2073 6b69 706e 613d 736b 6970 6e61  x, skipna=skipna
+0000fa00: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d6e  , numeric_only=n
+0000fa10: 756d 6572 6963 5f6f 6e6c 792c 2061 7869  umeric_only, axi
+0000fa20: 733d 6178 6973 0a20 2020 2020 2020 2020  s=axis.         
+0000fa30: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+0000fa40: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0000fa50: 6f6e 2873 656c 662e 6578 7072 2e6d 6178  on(self.expr.max
+0000fa60: 2873 6b69 706e 612c 206e 756d 6572 6963  (skipna, numeric
+0000fa70: 5f6f 6e6c 792c 2073 706c 6974 5f65 7665  _only, split_eve
+0000fa80: 7279 2c20 6178 6973 2929 0a0a 2020 2020  ry, axis))..    
+0000fa90: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0000faa0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0000fab0: 6465 6620 616e 7928 7365 6c66 2c20 6178  def any(self, ax
+0000fac0: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
+0000fad0: 652c 2073 706c 6974 5f65 7665 7279 3d46  e, split_every=F
+0000fae0: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
+0000faf0: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+0000fb00: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+0000fb10: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+0000fb20: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
+0000fb30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000fb40: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+0000fb50: 6974 696f 6e73 284d 2e61 6e79 2c20 736b  itions(M.any, sk
+0000fb60: 6970 6e61 3d73 6b69 706e 612c 2061 7869  ipna=skipna, axi
+0000fb70: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
+0000fb80: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0000fb90: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+0000fba0: 616e 7928 736b 6970 6e61 2c20 7370 6c69  any(skipna, spli
+0000fbb0: 745f 6576 6572 7929 290a 0a20 2020 2040  t_every))..    @
+0000fbc0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0000fbd0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0000fbe0: 6566 2061 6c6c 2873 656c 662c 2061 7869  ef all(self, axi
+0000fbf0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+0000fc00: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+0000fc10: 6c73 652c 202a 2a6b 7761 7267 7329 3a0a  lse, **kwargs):.
+0000fc20: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+0000fc30: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+0000fc40: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+0000fc50: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+0000fc60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000fc70: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+0000fc80: 7469 6f6e 7328 4d2e 616c 6c2c 2073 6b69  tions(M.all, ski
+0000fc90: 706e 613d 736b 6970 6e61 2c20 6178 6973  pna=skipna, axis
+0000fca0: 3d61 7869 7329 0a20 2020 2020 2020 2072  =axis).        r
+0000fcb0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0000fcc0: 7469 6f6e 2873 656c 662e 6578 7072 2e61  tion(self.expr.a
+0000fcd0: 6c6c 2873 6b69 706e 612c 2073 706c 6974  ll(skipna, split
+0000fce0: 5f65 7665 7279 2929 0a0a 2020 2020 4064  _every))..    @d
+0000fcf0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0000fd00: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0000fd10: 6620 6964 786d 696e 2873 656c 662c 2061  f idxmin(self, a
+0000fd20: 7869 733d 302c 2073 6b69 706e 613d 5472  xis=0, skipna=Tr
+0000fd30: 7565 2c20 6e75 6d65 7269 635f 6f6e 6c79  ue, numeric_only
+0000fd40: 3d46 616c 7365 2c20 7370 6c69 745f 6576  =False, split_ev
+0000fd50: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
+0000fd60: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
+0000fd70: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+0000fd80: 7869 7329 0a20 2020 2020 2020 2069 6620  xis).        if 
+0000fd90: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+0000fda0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000fdb0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0000fdc0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0000fdd0: 2020 204d 2e69 6478 6d69 6e2c 2073 6b69     M.idxmin, ski
+0000fde0: 706e 613d 736b 6970 6e61 2c20 6e75 6d65  pna=skipna, nume
+0000fdf0: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+0000fe00: 5f6f 6e6c 792c 2061 7869 733d 6178 6973  _only, axis=axis
+0000fe10: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000fe20: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0000fe30: 775f 636f 6c6c 6563 7469 6f6e 2873 656c  w_collection(sel
+0000fe40: 662e 6578 7072 2e69 6478 6d69 6e28 736b  f.expr.idxmin(sk
+0000fe50: 6970 6e61 2c20 6e75 6d65 7269 635f 6f6e  ipna, numeric_on
+0000fe60: 6c79 2c20 7370 6c69 745f 6576 6572 7929  ly, split_every)
+0000fe70: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0000fe80: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0000fe90: 6529 0a20 2020 2064 6566 2069 6478 6d61  e).    def idxma
+0000fea0: 7828 7365 6c66 2c20 6178 6973 3d30 2c20  x(self, axis=0, 
+0000feb0: 736b 6970 6e61 3d54 7275 652c 206e 756d  skipna=True, num
+0000fec0: 6572 6963 5f6f 6e6c 793d 4661 6c73 652c  eric_only=False,
+0000fed0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+0000fee0: 7365 293a 0a20 2020 2020 2020 2061 7869  se):.        axi
+0000fef0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+0000ff00: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+0000ff10: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+0000ff20: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0000ff30: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+0000ff40: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0000ff50: 2020 2020 2020 2020 2020 2020 4d2e 6964              M.id
+0000ff60: 786d 6178 2c20 736b 6970 6e61 3d73 6b69  xmax, skipna=ski
+0000ff70: 706e 612c 206e 756d 6572 6963 5f6f 6e6c  pna, numeric_onl
+0000ff80: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c20  y=numeric_only, 
+0000ff90: 6178 6973 3d61 7869 730a 2020 2020 2020  axis=axis.      
+0000ffa0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000ffb0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0000ffc0: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+0000ffd0: 6964 786d 6178 2873 6b69 706e 612c 206e  idxmax(skipna, n
+0000ffe0: 756d 6572 6963 5f6f 6e6c 792c 2073 706c  umeric_only, spl
+0000fff0: 6974 5f65 7665 7279 2929 0a0a 2020 2020  it_every))..    
+00010000: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00010010: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00010020: 6465 6620 6d69 6e28 7365 6c66 2c20 6178  def min(self, ax
+00010030: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
+00010040: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
+00010050: 4661 6c73 652c 2073 706c 6974 5f65 7665  False, split_eve
+00010060: 7279 3d46 616c 7365 2c20 2a2a 6b77 6172  ry=False, **kwar
+00010070: 6773 293a 0a20 2020 2020 2020 2061 7869  gs):.        axi
+00010080: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+00010090: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+000100a0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+000100b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+000100c0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+000100d0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+000100e0: 2020 2020 2020 2020 2020 2020 4d2e 6d69              M.mi
+000100f0: 6e2c 2073 6b69 706e 613d 736b 6970 6e61  n, skipna=skipna
+00010100: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d6e  , numeric_only=n
+00010110: 756d 6572 6963 5f6f 6e6c 792c 2061 7869  umeric_only, axi
+00010120: 733d 6178 6973 0a20 2020 2020 2020 2020  s=axis.         
+00010130: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00010140: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00010150: 6f6e 2873 656c 662e 6578 7072 2e6d 696e  on(self.expr.min
+00010160: 2873 6b69 706e 612c 206e 756d 6572 6963  (skipna, numeric
+00010170: 5f6f 6e6c 792c 2073 706c 6974 5f65 7665  _only, split_eve
+00010180: 7279 2c20 6178 6973 2929 0a0a 2020 2020  ry, axis))..    
+00010190: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000101a0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+000101b0: 6465 6620 636f 756e 7428 7365 6c66 2c20  def count(self, 
+000101c0: 6178 6973 3d30 2c20 6e75 6d65 7269 635f  axis=0, numeric_
+000101d0: 6f6e 6c79 3d46 616c 7365 2c20 7370 6c69  only=False, spli
+000101e0: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
+000101f0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00010200: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00010210: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00010220: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+00010230: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00010240: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+00010250: 7469 6f6e 7328 4d2e 636f 756e 742c 206e  tions(M.count, n
+00010260: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
+00010270: 7269 635f 6f6e 6c79 2c20 6178 6973 3d61  ric_only, axis=a
+00010280: 7869 7329 0a20 2020 2020 2020 2072 6574  xis).        ret
+00010290: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000102a0: 6f6e 2873 656c 662e 6578 7072 2e63 6f75  on(self.expr.cou
+000102b0: 6e74 286e 756d 6572 6963 5f6f 6e6c 792c  nt(numeric_only,
+000102c0: 2073 706c 6974 5f65 7665 7279 2929 0a0a   split_every))..
+000102d0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000102e0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+000102f0: 2020 2020 6465 6620 6162 7328 7365 6c66      def abs(self
+00010300: 293a 0a20 2020 2020 2020 2023 2052 6169  ):.        # Rai
+00010310: 7365 2070 616e 6461 7320 6572 726f 7273  se pandas errors
+00010320: 0a20 2020 2020 2020 205f 7261 6973 655f  .        _raise_
+00010330: 6966 5f6f 626a 6563 745f 7365 7269 6573  if_object_series
+00010340: 2873 656c 662c 2022 6162 7322 290a 2020  (self, "abs").  
+00010350: 2020 2020 2020 6d65 7461 5f6e 6f6e 656d        meta_nonem
+00010360: 7074 7928 7365 6c66 2e5f 6d65 7461 292e  pty(self._meta).
+00010370: 6162 7328 290a 2020 2020 2020 2020 7265  abs().        re
+00010380: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00010390: 696f 6e28 7365 6c66 2e65 7870 722e 6162  ion(self.expr.ab
+000103a0: 7328 2929 0a0a 2020 2020 4064 6572 6976  s())..    @deriv
+000103b0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+000103c0: 7261 6d65 290a 2020 2020 6465 6620 6173  rame).    def as
+000103d0: 7479 7065 2873 656c 662c 2064 7479 7065  type(self, dtype
+000103e0: 7329 3a0a 2020 2020 2020 2020 7265 7475  s):.        retu
+000103f0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00010400: 6e28 7365 6c66 2e65 7870 722e 6173 7479  n(self.expr.asty
+00010410: 7065 2864 7479 7065 7329 290a 0a20 2020  pe(dtypes))..   
+00010420: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00010430: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00010440: 2064 6566 2063 6f6d 6269 6e65 5f66 6972   def combine_fir
+00010450: 7374 2873 656c 662c 206f 7468 6572 293a  st(self, other):
+00010460: 0a20 2020 2020 2020 206f 7468 6572 203d  .        other =
+00010470: 2073 656c 662e 5f63 7265 6174 655f 616c   self._create_al
+00010480: 6967 6e61 626c 655f 6672 616d 6528 6f74  ignable_frame(ot
+00010490: 6865 722c 2022 6f75 7465 7222 292e 6578  her, "outer").ex
+000104a0: 7072 0a20 2020 2020 2020 2072 6574 7572  pr.        retur
+000104b0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+000104c0: 2873 656c 662e 6578 7072 2e63 6f6d 6269  (self.expr.combi
+000104d0: 6e65 5f66 6972 7374 286f 7468 6572 2929  ne_first(other))
+000104e0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000104f0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00010500: 290a 2020 2020 6465 6620 746f 5f74 696d  ).    def to_tim
+00010510: 6573 7461 6d70 2873 656c 662c 2066 7265  estamp(self, fre
+00010520: 713d 4e6f 6e65 2c20 686f 773d 2273 7461  q=None, how="sta
+00010530: 7274 2229 3a0a 2020 2020 2020 2020 7265  rt"):.        re
+00010540: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00010550: 696f 6e28 7365 6c66 2e65 7870 722e 746f  ion(self.expr.to
+00010560: 5f74 696d 6573 7461 6d70 2866 7265 712c  _timestamp(freq,
+00010570: 2068 6f77 2929 0a0a 2020 2020 4064 6572   how))..    @der
+00010580: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00010590: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+000105a0: 6973 6e61 2873 656c 6629 3a0a 2020 2020  isna(self):.    
+000105b0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000105c0: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
+000105d0: 7870 722e 6973 6e61 2829 290a 0a20 2020  xpr.isna())..   
+000105e0: 2064 6566 2072 616e 646f 6d5f 7370 6c69   def random_spli
+000105f0: 7428 7365 6c66 2c20 6672 6163 2c20 7261  t(self, frac, ra
+00010600: 6e64 6f6d 5f73 7461 7465 3d4e 6f6e 652c  ndom_state=None,
+00010610: 2073 6875 6666 6c65 3d46 616c 7365 293a   shuffle=False):
+00010620: 0a20 2020 2020 2020 2022 2222 5073 6575  .        """Pseu
+00010630: 646f 7261 6e64 6f6d 6c79 2073 706c 6974  dorandomly split
+00010640: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
+00010650: 6469 6666 6572 656e 7420 7069 6563 6573  different pieces
+00010660: 2072 6f77 2d77 6973 650a 0a20 2020 2020   row-wise..     
+00010670: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00010680: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00010690: 0a20 2020 2020 2020 2066 7261 6320 3a20  .        frac : 
+000106a0: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+000106b0: 204c 6973 7420 6f66 2066 6c6f 6174 7320   List of floats 
+000106c0: 7468 6174 2073 686f 756c 6420 7375 6d20  that should sum 
+000106d0: 746f 206f 6e65 2e0a 2020 2020 2020 2020  to one..        
+000106e0: 7261 6e64 6f6d 5f73 7461 7465 203a 2069  random_state : i
+000106f0: 6e74 206f 7220 6e70 2e72 616e 646f 6d2e  nt or np.random.
+00010700: 5261 6e64 6f6d 5374 6174 650a 2020 2020  RandomState.    
+00010710: 2020 2020 2020 2020 4966 2069 6e74 206f          If int o
+00010720: 7220 4e6f 6e65 2063 7265 6174 6520 6120  r None create a 
+00010730: 6e65 7720 5261 6e64 6f6d 5374 6174 6520  new RandomState 
+00010740: 7769 7468 2074 6869 7320 6173 2074 6865  with this as the
+00010750: 2073 6565 642e 0a20 2020 2020 2020 2020   seed..         
+00010760: 2020 204f 7468 6572 7769 7365 2064 7261     Otherwise dra
+00010770: 7720 6672 6f6d 2074 6865 2070 6173 7365  w from the passe
+00010780: 6420 5261 6e64 6f6d 5374 6174 652e 0a20  d RandomState.. 
+00010790: 2020 2020 2020 2073 6875 6666 6c65 203a         shuffle :
+000107a0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
+000107b0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+000107c0: 2049 6620 7365 7420 746f 2054 7275 652c   If set to True,
+000107d0: 2074 6865 2064 6174 6166 7261 6d65 2069   the dataframe i
+000107e0: 7320 7368 7566 666c 6564 2028 7769 7468  s shuffled (with
+000107f0: 696e 2070 6172 7469 7469 6f6e 290a 2020  in partition).  
+00010800: 2020 2020 2020 2020 2020 6265 666f 7265            before
+00010810: 2074 6865 2073 706c 6974 2e0a 0a20 2020   the split...   
+00010820: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+00010830: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a0a        --------..
+00010840: 2020 2020 2020 2020 3530 2f35 3020 7370          50/50 sp
+00010850: 6c69 740a 0a20 2020 2020 2020 203e 3e3e  lit..        >>>
+00010860: 2061 2c20 6220 3d20 6466 2e72 616e 646f   a, b = df.rando
+00010870: 6d5f 7370 6c69 7428 5b30 2e35 2c20 302e  m_split([0.5, 0.
+00010880: 355d 2920 2023 2064 6f63 7465 7374 3a20  5])  # doctest: 
+00010890: 2b53 4b49 500a 0a20 2020 2020 2020 2038  +SKIP..        8
+000108a0: 302f 3130 2f31 3020 7370 6c69 742c 2063  0/10/10 split, c
+000108b0: 6f6e 7369 7374 656e 7420 7261 6e64 6f6d  onsistent random
+000108c0: 5f73 7461 7465 0a0a 2020 2020 2020 2020  _state..        
+000108d0: 3e3e 3e20 612c 2062 2c20 6320 3d20 6466  >>> a, b, c = df
+000108e0: 2e72 616e 646f 6d5f 7370 6c69 7428 5b30  .random_split([0
+000108f0: 2e38 2c20 302e 312c 2030 2e31 5d2c 2072  .8, 0.1, 0.1], r
+00010900: 616e 646f 6d5f 7374 6174 653d 3132 3329  andom_state=123)
+00010910: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+00010920: 4950 0a0a 2020 2020 2020 2020 5365 6520  IP..        See 
+00010930: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00010940: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+00010950: 736b 2e44 6174 6146 7261 6d65 2e73 616d  sk.DataFrame.sam
+00010960: 706c 650a 2020 2020 2020 2020 2222 220a  ple.        """.
+00010970: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
+00010980: 702e 616c 6c63 6c6f 7365 2873 756d 2866  p.allclose(sum(f
+00010990: 7261 6329 2c20 3129 3a0a 2020 2020 2020  rac), 1):.      
+000109a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000109b0: 6545 7272 6f72 2822 6672 6163 2073 686f  eError("frac sho
+000109c0: 756c 6420 7375 6d20 746f 2031 2229 0a20  uld sum to 1"). 
+000109d0: 2020 2020 2020 2066 7261 6d65 203d 2065         frame = e
+000109e0: 7870 722e 5370 6c69 7428 7365 6c66 2c20  xpr.Split(self, 
+000109f0: 6672 6163 2c20 7261 6e64 6f6d 5f73 7461  frac, random_sta
+00010a00: 7465 2c20 7368 7566 666c 6529 0a0a 2020  te, shuffle)..  
+00010a10: 2020 2020 2020 6f75 7420 3d20 5b5d 0a20        out = []. 
+00010a20: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00010a30: 7261 6e67 6528 6c65 6e28 6672 6163 2929  range(len(frac))
+00010a40: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
+00010a50: 742e 6170 7065 6e64 286e 6577 5f63 6f6c  t.append(new_col
+00010a60: 6c65 6374 696f 6e28 6578 7072 2e53 706c  lection(expr.Spl
+00010a70: 6974 5461 6b65 2866 7261 6d65 2c20 692c  itTake(frame, i,
+00010a80: 2073 656c 662e 6e64 696d 2929 290a 2020   self.ndim))).  
+00010a90: 2020 2020 2020 7265 7475 726e 206f 7574        return out
+00010aa0: 0a0a 2020 2020 6465 6620 6973 6e75 6c6c  ..    def isnull
+00010ab0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00010ac0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00010ad0: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+00010ae0: 6973 6e75 6c6c 2829 290a 0a20 2020 2040  isnull())..    @
+00010af0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00010b00: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00010b10: 6566 2072 6f75 6e64 2873 656c 662c 2064  ef round(self, d
+00010b20: 6563 696d 616c 733d 3029 3a0a 2020 2020  ecimals=0):.    
+00010b30: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00010b40: 6f6c 6c65 6374 696f 6e28 7365 6c66 2e65  ollection(self.e
+00010b50: 7870 722e 726f 756e 6428 6465 6369 6d61  xpr.round(decima
+00010b60: 6c73 2929 0a0a 2020 2020 4064 6572 6976  ls))..    @deriv
+00010b70: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00010b80: 7261 6d65 290a 2020 2020 6465 6620 7768  rame).    def wh
+00010b90: 6572 6528 7365 6c66 2c20 636f 6e64 2c20  ere(self, cond, 
+00010ba0: 6f74 6865 723d 6e70 2e6e 616e 293a 0a20  other=np.nan):. 
+00010bb0: 2020 2020 2020 2063 6f6e 6420 3d20 7365         cond = se
+00010bc0: 6c66 2e5f 6372 6561 7465 5f61 6c69 676e  lf._create_align
+00010bd0: 6162 6c65 5f66 7261 6d65 2863 6f6e 6429  able_frame(cond)
+00010be0: 0a20 2020 2020 2020 206f 7468 6572 203d  .        other =
+00010bf0: 2073 656c 662e 5f63 7265 6174 655f 616c   self._create_al
+00010c00: 6967 6e61 626c 655f 6672 616d 6528 6f74  ignable_frame(ot
+00010c10: 6865 7229 0a20 2020 2020 2020 2063 6f6e  her).        con
+00010c20: 6420 3d20 636f 6e64 2e65 7870 7220 6966  d = cond.expr if
+00010c30: 2069 7369 6e73 7461 6e63 6528 636f 6e64   isinstance(cond
+00010c40: 2c20 4672 616d 6542 6173 6529 2065 6c73  , FrameBase) els
+00010c50: 6520 636f 6e64 0a20 2020 2020 2020 206f  e cond.        o
+00010c60: 7468 6572 203d 206f 7468 6572 2e65 7870  ther = other.exp
+00010c70: 7220 6966 2069 7369 6e73 7461 6e63 6528  r if isinstance(
+00010c80: 6f74 6865 722c 2046 7261 6d65 4261 7365  other, FrameBase
+00010c90: 2920 656c 7365 206f 7468 6572 0a20 2020  ) else other.   
+00010ca0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00010cb0: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
+00010cc0: 6578 7072 2e77 6865 7265 2863 6f6e 642c  expr.where(cond,
+00010cd0: 206f 7468 6572 2929 0a0a 2020 2020 4064   other))..    @d
+00010ce0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00010cf0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00010d00: 6620 6d61 736b 2873 656c 662c 2063 6f6e  f mask(self, con
+00010d10: 642c 206f 7468 6572 3d6e 702e 6e61 6e29  d, other=np.nan)
+00010d20: 3a0a 2020 2020 2020 2020 636f 6e64 203d  :.        cond =
+00010d30: 2073 656c 662e 5f63 7265 6174 655f 616c   self._create_al
+00010d40: 6967 6e61 626c 655f 6672 616d 6528 636f  ignable_frame(co
+00010d50: 6e64 290a 2020 2020 2020 2020 6f74 6865  nd).        othe
+00010d60: 7220 3d20 7365 6c66 2e5f 6372 6561 7465  r = self._create
+00010d70: 5f61 6c69 676e 6162 6c65 5f66 7261 6d65  _alignable_frame
+00010d80: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
+00010d90: 636f 6e64 203d 2063 6f6e 642e 6578 7072  cond = cond.expr
+00010da0: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00010db0: 6f6e 642c 2046 7261 6d65 4261 7365 2920  ond, FrameBase) 
+00010dc0: 656c 7365 2063 6f6e 640a 2020 2020 2020  else cond.      
+00010dd0: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
+00010de0: 6578 7072 2069 6620 6973 696e 7374 616e  expr if isinstan
+00010df0: 6365 286f 7468 6572 2c20 4672 616d 6542  ce(other, FrameB
+00010e00: 6173 6529 2065 6c73 6520 6f74 6865 720a  ase) else other.
+00010e10: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00010e20: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00010e30: 6c66 2e65 7870 722e 6d61 736b 2863 6f6e  lf.expr.mask(con
+00010e40: 642c 206f 7468 6572 2929 0a0a 2020 2020  d, other))..    
+00010e50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00010e60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00010e70: 6465 6620 7265 706c 6163 6528 7365 6c66  def replace(self
+00010e80: 2c20 746f 5f72 6570 6c61 6365 3d4e 6f6e  , to_replace=Non
+00010e90: 652c 2076 616c 7565 3d6e 6f5f 6465 6661  e, value=no_defa
+00010ea0: 756c 742c 2072 6567 6578 3d46 616c 7365  ult, regex=False
+00010eb0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00010ec0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00010ed0: 2873 656c 662e 6578 7072 2e72 6570 6c61  (self.expr.repla
+00010ee0: 6365 2874 6f5f 7265 706c 6163 652c 2076  ce(to_replace, v
+00010ef0: 616c 7565 2c20 7265 6765 7829 290a 0a20  alue, regex)).. 
+00010f00: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00010f10: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00010f20: 2020 2064 6566 2066 6669 6c6c 2873 656c     def ffill(sel
+00010f30: 662c 2061 7869 733d 302c 206c 696d 6974  f, axis=0, limit
+00010f40: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00010f50: 6178 6973 203d 205f 7661 6c69 6461 7465  axis = _validate
+00010f60: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+00010f70: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+00010f80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00010f90: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00010fa0: 7274 6974 696f 6e73 284d 2e66 6669 6c6c  rtitions(M.ffill
+00010fb0: 2c20 6178 6973 3d61 7869 732c 206c 696d  , axis=axis, lim
+00010fc0: 6974 3d6c 696d 6974 290a 2020 2020 2020  it=limit).      
+00010fd0: 2020 6672 616d 6520 3d20 7365 6c66 0a20    frame = self. 
+00010fe0: 2020 2020 2020 2069 6620 6c69 6d69 7420         if limit 
+00010ff0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00011000: 2020 2020 2066 7261 6d65 203d 2046 696c       frame = Fil
+00011010: 6c6e 6143 6865 636b 2873 656c 662c 2022  lnaCheck(self, "
+00011020: 6666 696c 6c22 2c20 6c61 6d62 6461 2078  ffill", lambda x
+00011030: 3a20 3029 0a20 2020 2020 2020 2072 6574  : 0).        ret
+00011040: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00011050: 6f6e 2846 4669 6c6c 2866 7261 6d65 2c20  on(FFill(frame, 
+00011060: 6c69 6d69 7429 290a 0a20 2020 2040 6465  limit))..    @de
+00011070: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00011080: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00011090: 2062 6669 6c6c 2873 656c 662c 2061 7869   bfill(self, axi
+000110a0: 733d 302c 206c 696d 6974 3d4e 6f6e 6529  s=0, limit=None)
+000110b0: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
+000110c0: 205f 7661 6c69 6461 7465 5f61 7869 7328   _validate_axis(
+000110d0: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
+000110e0: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
+000110f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00011100: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00011110: 6e73 284d 2e62 6669 6c6c 2c20 6178 6973  ns(M.bfill, axis
+00011120: 3d61 7869 732c 206c 696d 6974 3d6c 696d  =axis, limit=lim
+00011130: 6974 290a 2020 2020 2020 2020 6672 616d  it).        fram
+00011140: 6520 3d20 7365 6c66 0a20 2020 2020 2020  e = self.       
+00011150: 2069 6620 6c69 6d69 7420 6973 204e 6f6e   if limit is Non
+00011160: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
+00011170: 7261 6d65 203d 2046 696c 6c6e 6143 6865  rame = FillnaChe
+00011180: 636b 2873 656c 662c 2022 6266 696c 6c22  ck(self, "bfill"
+00011190: 2c20 6c61 6d62 6461 2078 3a20 782e 6e70  , lambda x: x.np
+000111a0: 6172 7469 7469 6f6e 7320 2d20 3129 0a20  artitions - 1). 
+000111b0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000111c0: 775f 636f 6c6c 6563 7469 6f6e 2842 4669  w_collection(BFi
+000111d0: 6c6c 2866 7261 6d65 2c20 6c69 6d69 7429  ll(frame, limit)
+000111e0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+000111f0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00011200: 6529 0a20 2020 2064 6566 2066 696c 6c6e  e).    def filln
+00011210: 6128 7365 6c66 2c20 7661 6c75 653d 4e6f  a(self, value=No
+00011220: 6e65 2c20 6178 6973 3d4e 6f6e 6529 3a0a  ne, axis=None):.
+00011230: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00011240: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00011250: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00011260: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+00011270: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00011280: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+00011290: 7469 6f6e 7328 4d2e 6669 6c6c 6e61 2c20  tions(M.fillna, 
+000112a0: 7661 6c75 652c 2061 7869 733d 6178 6973  value, axis=axis
+000112b0: 290a 2020 2020 2020 2020 6966 2069 7369  ).        if isi
+000112c0: 6e73 7461 6e63 6528 7661 6c75 652c 2046  nstance(value, F
+000112d0: 7261 6d65 4261 7365 293a 0a20 2020 2020  rameBase):.     
+000112e0: 2020 2020 2020 2076 616c 7565 203d 2076         value = v
+000112f0: 616c 7565 2e65 7870 720a 2020 2020 2020  alue.expr.      
+00011300: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00011310: 6c65 6374 696f 6e28 7365 6c66 2e65 7870  lection(self.exp
+00011320: 722e 6669 6c6c 6e61 2876 616c 7565 2929  r.fillna(value))
+00011330: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00011340: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00011350: 290a 2020 2020 6465 6620 7368 6966 7428  ).    def shift(
+00011360: 7365 6c66 2c20 7065 7269 6f64 733d 312c  self, periods=1,
+00011370: 2066 7265 713d 4e6f 6e65 2c20 6178 6973   freq=None, axis
+00011380: 3d30 293a 0a20 2020 2020 2020 2069 6620  =0):.        if 
+00011390: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
+000113a0: 6572 696f 6473 2c20 496e 7465 6772 616c  eriods, Integral
+000113b0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000113c0: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+000113d0: 7065 7269 6f64 7320 6d75 7374 2062 6520  periods must be 
+000113e0: 616e 2069 6e74 6567 6572 2229 0a0a 2020  an integer")..  
+000113f0: 2020 2020 2020 6178 6973 203d 205f 7661        axis = _va
+00011400: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+00011410: 290a 2020 2020 2020 2020 6966 2061 7869  ).        if axi
+00011420: 7320 3d3d 2030 3a0a 2020 2020 2020 2020  s == 0:.        
+00011430: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00011440: 6f6c 6c65 6374 696f 6e28 5368 6966 7428  ollection(Shift(
+00011450: 7365 6c66 2c20 7065 7269 6f64 732c 2066  self, periods, f
+00011460: 7265 7129 290a 0a20 2020 2020 2020 2072  req))..        r
+00011470: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+00011480: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00011490: 2020 2020 2020 2066 756e 633d 5368 6966         func=Shif
+000114a0: 742e 6675 6e63 2c0a 2020 2020 2020 2020  t.func,.        
+000114b0: 2020 2020 656e 666f 7263 655f 6d65 7461      enforce_meta
+000114c0: 6461 7461 3d46 616c 7365 2c0a 2020 2020  data=False,.    
+000114d0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+000114e0: 6d5f 6469 7669 7369 6f6e 733d 4661 6c73  m_divisions=Fals
+000114f0: 652c 0a20 2020 2020 2020 2020 2020 2070  e,.            p
+00011500: 6572 696f 6473 3d70 6572 696f 6473 2c0a  eriods=periods,.
+00011510: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00011520: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+00011530: 2020 2066 7265 713d 6672 6571 2c0a 2020     freq=freq,.  
+00011540: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+00011550: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00011560: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00011570: 2064 6966 6628 7365 6c66 2c20 7065 7269   diff(self, peri
+00011580: 6f64 733d 312c 2061 7869 733d 3029 3a0a  ods=1, axis=0):.
+00011590: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000115a0: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
+000115b0: 2020 2020 2020 2020 2020 5061 6e64 6173            Pandas
+000115c0: 2063 7572 7265 6e74 6c79 2075 7365 7320   currently uses 
+000115d0: 616e 2060 606f 626a 6563 7460 602d 6474  an ``object``-dt
+000115e0: 7970 6520 636f 6c75 6d6e 2074 6f20 7265  ype column to re
+000115f0: 7072 6573 656e 740a 2020 2020 2020 2020  present.        
+00011600: 2020 2062 6f6f 6c65 616e 2064 6174 6120     boolean data 
+00011610: 7769 7468 206d 6973 7369 6e67 2076 616c  with missing val
+00011620: 7565 732e 2054 6869 7320 6361 6e20 6361  ues. This can ca
+00011630: 7573 6520 6973 7375 6573 2066 6f72 0a20  use issues for. 
+00011640: 2020 2020 2020 2020 2020 626f 6f6c 6561            boolea
+00011650: 6e2d 7370 6563 6966 6963 206f 7065 7261  n-specific opera
+00011660: 7469 6f6e 732c 206c 696b 6520 6060 7c60  tions, like ``|`
+00011670: 602e 2054 6f20 656e 6162 6c65 2062 6f6f  `. To enable boo
+00011680: 6c65 616e 2d0a 2020 2020 2020 2020 2020  lean-.          
+00011690: 2073 7065 6369 6669 6320 6f70 6572 6174   specific operat
+000116a0: 696f 6e73 2c20 6174 2074 6865 2063 6f73  ions, at the cos
+000116b0: 7420 6f66 206d 6574 6164 6174 6120 7468  t of metadata th
+000116c0: 6174 2064 6f65 736e 2774 206d 6174 6368  at doesn't match
+000116d0: 0a20 2020 2020 2020 2020 2020 7061 6e64  .           pand
+000116e0: 6173 2c20 7573 6520 6060 2e61 7374 7970  as, use ``.astyp
+000116f0: 6528 626f 6f6c 2960 6020 6166 7465 7220  e(bool)`` after 
+00011700: 7468 6520 6060 7368 6966 7460 602e 0a20  the ``shift``.. 
+00011710: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00011720: 2020 2061 7869 7320 3d20 5f76 616c 6964     axis = _valid
+00011730: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+00011740: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00011750: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00011760: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00011770: 6563 7469 6f6e 2844 6966 6628 7365 6c66  ection(Diff(self
+00011780: 2c20 7065 7269 6f64 7329 290a 2020 2020  , periods)).    
+00011790: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000117a0: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+000117b0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+000117c0: 3d44 6966 662e 6675 6e63 2c0a 2020 2020  =Diff.func,.    
+000117d0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+000117e0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+000117f0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+00011800: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
+00011810: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00011820: 2020 2063 6c65 6172 5f64 6976 6973 696f     clear_divisio
+00011830: 6e73 3d46 616c 7365 2c0a 2020 2020 2020  ns=False,.      
+00011840: 2020 2020 2020 7065 7269 6f64 733d 7065        periods=pe
+00011850: 7269 6f64 732c 0a20 2020 2020 2020 2020  riods,.         
+00011860: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00011870: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+00011880: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00011890: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+000118a0: 2072 656e 616d 655f 6178 6973 280a 2020   rename_axis(.  
+000118b0: 2020 2020 2020 7365 6c66 2c20 6d61 7070        self, mapp
+000118c0: 6572 3d6e 6f5f 6465 6661 756c 742c 2069  er=no_default, i
+000118d0: 6e64 6578 3d6e 6f5f 6465 6661 756c 742c  ndex=no_default,
+000118e0: 2063 6f6c 756d 6e73 3d6e 6f5f 6465 6661   columns=no_defa
+000118f0: 756c 742c 2061 7869 733d 300a 2020 2020  ult, axis=0.    
+00011900: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00011910: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00011920: 2873 656c 662e 6578 7072 2e72 656e 616d  (self.expr.renam
+00011930: 655f 6178 6973 286d 6170 7065 722c 2069  e_axis(mapper, i
+00011940: 6e64 6578 2c20 636f 6c75 6d6e 732c 2061  ndex, columns, a
+00011950: 7869 7329 290a 0a20 2020 2064 6566 205f  xis))..    def _
+00011960: 6372 6561 7465 5f61 6c69 676e 6162 6c65  create_alignable
+00011970: 5f66 7261 6d65 2873 656c 662c 206f 7468  _frame(self, oth
+00011980: 6572 2c20 6a6f 696e 3d22 6f75 7465 7222  er, join="outer"
+00011990: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
+000119a0: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+000119b0: 7469 6f6e 286f 7468 6572 2920 616e 6420  tion(other) and 
+000119c0: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
+000119d0: 5f73 6572 6965 735f 6c69 6b65 286f 7468  _series_like(oth
+000119e0: 6572 2920 6f72 2069 735f 6461 7461 6672  er) or is_datafr
+000119f0: 616d 655f 6c69 6b65 286f 7468 6572 290a  ame_like(other).
+00011a00: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+00011a10: 2020 2020 2020 2069 6620 6a6f 696e 2069         if join i
+00011a20: 6e20 2822 696e 6e65 7222 2c20 226c 6566  n ("inner", "lef
+00011a30: 7422 293a 0a20 2020 2020 2020 2020 2020  t"):.           
+00011a40: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00011a50: 203d 2031 0a20 2020 2020 2020 2020 2020   = 1.           
+00011a60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00011a70: 2020 2020 2020 2023 2057 6520 6861 7665         # We have
+00011a80: 2074 6f20 7472 6967 6765 7220 616c 6967   to trigger alig
+00011a90: 6e6d 656e 742c 206f 7468 6572 7769 7365  nment, otherwise
+00011aa0: 2070 616e 6461 7320 7769 6c6c 2061 6464   pandas will add
+00011ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011ac0: 2023 2074 6865 2073 616d 6520 7661 6c75   # the same valu
+00011ad0: 6573 2074 6f20 6576 6572 7920 7061 7274  es to every part
+00011ae0: 6974 696f 6e0a 2020 2020 2020 2020 2020  ition.          
+00011af0: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+00011b00: 7320 3d20 320a 2020 2020 2020 2020 2020  s = 2.          
+00011b10: 2020 6f74 6865 7220 3d20 6672 6f6d 5f70    other = from_p
+00011b20: 616e 6461 7328 6f74 6865 722c 206e 7061  andas(other, npa
+00011b30: 7274 6974 696f 6e73 3d6e 7061 7274 6974  rtitions=npartit
+00011b40: 696f 6e73 290a 2020 2020 2020 2020 7265  ions).        re
+00011b50: 7475 726e 206f 7468 6572 0a0a 2020 2020  turn other..    
+00011b60: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00011b70: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00011b80: 6465 6620 616c 6967 6e28 7365 6c66 2c20  def align(self, 
+00011b90: 6f74 6865 722c 206a 6f69 6e3d 226f 7574  other, join="out
+00011ba0: 6572 222c 2061 7869 733d 4e6f 6e65 2c20  er", axis=None, 
+00011bb0: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 6529  fill_value=None)
+00011bc0: 3a0a 2020 2020 2020 2020 6f74 6865 7220  :.        other 
+00011bd0: 3d20 7365 6c66 2e5f 6372 6561 7465 5f61  = self._create_a
+00011be0: 6c69 676e 6162 6c65 5f66 7261 6d65 286f  lignable_frame(o
+00011bf0: 7468 6572 2c20 6a6f 696e 290a 2020 2020  ther, join).    
+00011c00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00011c10: 6578 7072 2e61 6c69 676e 286f 7468 6572  expr.align(other
+00011c20: 2e65 7870 722c 206a 6f69 6e2c 2061 7869  .expr, join, axi
+00011c30: 732c 2066 696c 6c5f 7661 6c75 6529 0a0a  s, fill_value)..
+00011c40: 2020 2020 6465 6620 6e75 6e69 7175 655f      def nunique_
+00011c50: 6170 7072 6f78 2873 656c 662c 2073 706c  approx(self, spl
+00011c60: 6974 5f65 7665 7279 3d4e 6f6e 6529 3a0a  it_every=None):.
+00011c70: 2020 2020 2020 2020 2222 2241 7070 726f          """Appro
+00011c80: 7869 6d61 7465 206e 756d 6265 7220 6f66  ximate number of
+00011c90: 2075 6e69 7175 6520 726f 7773 2e0a 0a20   unique rows... 
+00011ca0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
+00011cb0: 6f64 2075 7365 7320 7468 6520 4879 7065  od uses the Hype
+00011cc0: 724c 6f67 4c6f 6720 616c 676f 7269 7468  rLogLog algorith
+00011cd0: 6d20 666f 7220 6361 7264 696e 616c 6974  m for cardinalit
+00011ce0: 790a 2020 2020 2020 2020 6573 7469 6d61  y.        estima
+00011cf0: 7469 6f6e 2074 6f20 636f 6d70 7574 6520  tion to compute 
+00011d00: 7468 6520 6170 7072 6f78 696d 6174 6520  the approximate 
+00011d10: 6e75 6d62 6572 206f 6620 756e 6971 7565  number of unique
+00011d20: 2072 6f77 732e 0a20 2020 2020 2020 2054   rows..        T
+00011d30: 6865 2061 7070 726f 7869 6d61 7465 2065  he approximate e
+00011d40: 7272 6f72 2069 7320 302e 3430 3625 2e0a  rror is 0.406%..
+00011d50: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00011d60: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00011d70: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
+00011d80: 706c 6974 5f65 7665 7279 203a 2069 6e74  plit_every : int
+00011d90: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00011da0: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
+00011db0: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
+00011dc0: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
+00011dd0: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
+00011de0: 6720 610a 2020 2020 2020 2020 2020 2020  g a.            
+00011df0: 7472 6565 2d72 6564 7563 7469 6f6e 2e20  tree-reduction. 
+00011e00: 4966 2073 6574 2074 6f20 4661 6c73 652c  If set to False,
+00011e10: 206e 6f20 7472 6565 2d72 6564 7563 7469   no tree-reducti
+00011e20: 6f6e 2077 696c 6c20 6265 2075 7365 642e  on will be used.
+00011e30: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+00011e40: 6175 6c74 2069 7320 382e 0a0a 2020 2020  ault is 8...    
+00011e50: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00011e60: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00011e70: 2020 2020 6120 666c 6f61 7420 7265 7072      a float repr
+00011e80: 6573 656e 7469 6e67 2074 6865 2061 7070  esenting the app
+00011e90: 726f 7869 6d61 7465 206e 756d 6265 7220  roximate number 
+00011ea0: 6f66 2065 6c65 6d65 6e74 730a 2020 2020  of elements.    
+00011eb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011ec0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00011ed0: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+00011ee0: 6e75 6e69 7175 655f 6170 7072 6f78 2873  nunique_approx(s
+00011ef0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00011f00: 5f65 7665 7279 2929 0a0a 2020 2020 4064  _every))..    @d
+00011f10: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00011f20: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00011f30: 6620 6375 6d73 756d 2873 656c 662c 2061  f cumsum(self, a
+00011f40: 7869 733d 302c 2073 6b69 706e 613d 5472  xis=0, skipna=Tr
+00011f50: 7565 2c20 2a2a 6b77 6172 6773 293a 0a20  ue, **kwargs):. 
+00011f60: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00011f70: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00011f80: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00011f90: 5f70 6172 7469 7469 6f6e 7328 4d2e 6375  _partitions(M.cu
+00011fa0: 6d73 756d 2c20 6178 6973 3d61 7869 732c  msum, axis=axis,
+00011fb0: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
+00011fc0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00011fd0: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00011fe0: 6c66 2e65 7870 722e 6375 6d73 756d 2873  lf.expr.cumsum(s
+00011ff0: 6b69 706e 613d 736b 6970 6e61 2929 0a0a  kipna=skipna))..
+00012000: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00012010: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00012020: 2020 2020 6465 6620 6375 6d70 726f 6428      def cumprod(
+00012030: 7365 6c66 2c20 6178 6973 3d30 2c20 736b  self, axis=0, sk
+00012040: 6970 6e61 3d54 7275 652c 202a 2a6b 7761  ipna=True, **kwa
+00012050: 7267 7329 3a0a 2020 2020 2020 2020 6966  rgs):.        if
+00012060: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
+00012070: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00012080: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00012090: 6e73 284d 2e63 756d 7072 6f64 2c20 6178  ns(M.cumprod, ax
+000120a0: 6973 3d61 7869 732c 2073 6b69 706e 613d  is=axis, skipna=
+000120b0: 736b 6970 6e61 290a 2020 2020 2020 2020  skipna).        
+000120c0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+000120d0: 6374 696f 6e28 7365 6c66 2e65 7870 722e  ction(self.expr.
+000120e0: 6375 6d70 726f 6428 736b 6970 6e61 3d73  cumprod(skipna=s
+000120f0: 6b69 706e 6129 290a 0a20 2020 2040 6465  kipna))..    @de
+00012100: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00012110: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00012120: 2063 756d 6d61 7828 7365 6c66 2c20 6178   cummax(self, ax
+00012130: 6973 3d30 2c20 736b 6970 6e61 3d54 7275  is=0, skipna=Tru
+00012140: 6529 3a0a 2020 2020 2020 2020 6966 2061  e):.        if a
+00012150: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
+00012160: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00012170: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00012180: 284d 2e63 756d 6d61 782c 2061 7869 733d  (M.cummax, axis=
+00012190: 6178 6973 2c20 736b 6970 6e61 3d73 6b69  axis, skipna=ski
+000121a0: 706e 6129 0a20 2020 2020 2020 2072 6574  pna).        ret
+000121b0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000121c0: 6f6e 2873 656c 662e 6578 7072 2e63 756d  on(self.expr.cum
+000121d0: 6d61 7828 736b 6970 6e61 3d73 6b69 706e  max(skipna=skipn
+000121e0: 6129 290a 0a20 2020 2040 6465 7269 7665  a))..    @derive
+000121f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00012200: 616d 6529 0a20 2020 2064 6566 2063 756d  ame).    def cum
+00012210: 6d69 6e28 7365 6c66 2c20 6178 6973 3d30  min(self, axis=0
+00012220: 2c20 736b 6970 6e61 3d54 7275 6529 3a0a  , skipna=True):.
+00012230: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+00012240: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+00012250: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+00012260: 705f 7061 7274 6974 696f 6e73 284d 2e63  p_partitions(M.c
+00012270: 756d 6d69 6e2c 2061 7869 733d 6178 6973  ummin, axis=axis
+00012280: 2c20 736b 6970 6e61 3d73 6b69 706e 6129  , skipna=skipna)
+00012290: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000122a0: 6e65 775f 636f 6c6c 6563 7469 6f6e 2873  new_collection(s
+000122b0: 656c 662e 6578 7072 2e63 756d 6d69 6e28  elf.expr.cummin(
+000122c0: 736b 6970 6e61 3d73 6b69 706e 6129 290a  skipna=skipna)).
+000122d0: 0a20 2020 2064 6566 2072 6564 7563 7469  .    def reducti
+000122e0: 6f6e 280a 2020 2020 2020 2020 7365 6c66  on(.        self
+000122f0: 2c0a 2020 2020 2020 2020 6368 756e 6b2c  ,.        chunk,
+00012300: 0a20 2020 2020 2020 2061 6767 7265 6761  .        aggrega
+00012310: 7465 3d4e 6f6e 652c 0a20 2020 2020 2020  te=None,.       
+00012320: 2063 6f6d 6269 6e65 3d4e 6f6e 652c 0a20   combine=None,. 
+00012330: 2020 2020 2020 206d 6574 613d 6e6f 5f64         meta=no_d
+00012340: 6566 6175 6c74 2c0a 2020 2020 2020 2020  efault,.        
+00012350: 746f 6b65 6e3d 4e6f 6e65 2c0a 2020 2020  token=None,.    
+00012360: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+00012370: 4e6f 6e65 2c0a 2020 2020 2020 2020 6368  None,.        ch
+00012380: 756e 6b5f 6b77 6172 6773 3d4e 6f6e 652c  unk_kwargs=None,
+00012390: 0a20 2020 2020 2020 2061 6767 7265 6761  .        aggrega
+000123a0: 7465 5f6b 7761 7267 733d 4e6f 6e65 2c0a  te_kwargs=None,.
+000123b0: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+000123c0: 6b77 6172 6773 3d4e 6f6e 652c 0a20 2020  kwargs=None,.   
+000123d0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+000123e0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000123f0: 2247 656e 6572 6963 2072 6f77 2d77 6973  "Generic row-wis
+00012400: 6520 7265 6475 6374 696f 6e73 2e0a 0a20  e reductions... 
+00012410: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00012420: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00012430: 2d2d 2d2d 0a20 2020 2020 2020 2063 6875  ----.        chu
+00012440: 6e6b 203a 2063 616c 6c61 626c 650a 2020  nk : callable.  
+00012450: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
+00012460: 6f6e 2074 6f20 6f70 6572 6174 6520 6f6e  on to operate on
+00012470: 2065 6163 6820 7061 7274 6974 696f 6e2e   each partition.
+00012480: 2053 686f 756c 6420 7265 7475 726e 2061   Should return a
+00012490: 0a20 2020 2020 2020 2020 2020 2060 6070  .            ``p
+000124a0: 616e 6461 732e 4461 7461 4672 616d 6560  andas.DataFrame`
+000124b0: 602c 2060 6070 616e 6461 732e 5365 7269  `, ``pandas.Seri
+000124c0: 6573 6060 2c20 6f72 2061 2073 6361 6c61  es``, or a scala
+000124d0: 722e 0a20 2020 2020 2020 2061 6767 7265  r..        aggre
+000124e0: 6761 7465 203a 2063 616c 6c61 626c 652c  gate : callable,
+000124f0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00012500: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
+00012510: 6f20 6f70 6572 6174 6520 6f6e 2074 6865  o operate on the
+00012520: 2063 6f6e 6361 7465 6e61 7465 6420 7265   concatenated re
+00012530: 7375 6c74 206f 6620 6060 6368 756e 6b60  sult of ``chunk`
+00012540: 602e 2049 6620 6e6f 740a 2020 2020 2020  `. If not.      
+00012550: 2020 2020 2020 7370 6563 6966 6965 642c        specified,
+00012560: 2064 6566 6175 6c74 7320 746f 2060 6063   defaults to ``c
+00012570: 6875 6e6b 6060 2e20 5573 6564 2074 6f20  hunk``. Used to 
+00012580: 646f 2074 6865 2066 696e 616c 2061 6767  do the final agg
+00012590: 7265 6761 7469 6f6e 0a20 2020 2020 2020  regation.       
+000125a0: 2020 2020 2069 6e20 6120 7472 6565 2072       in a tree r
+000125b0: 6564 7563 7469 6f6e 2e0a 0a20 2020 2020  eduction...     
+000125c0: 2020 2020 2020 2054 6865 2069 6e70 7574         The input
+000125d0: 2074 6f20 6060 6167 6772 6567 6174 6560   to ``aggregate`
+000125e0: 6020 6465 7065 6e64 7320 6f6e 2074 6865  ` depends on the
+000125f0: 206f 7574 7075 7420 6f66 2060 6063 6875   output of ``chu
+00012600: 6e6b 6060 2e0a 2020 2020 2020 2020 2020  nk``..          
+00012610: 2020 4966 2074 6865 206f 7574 7075 7420    If the output 
+00012620: 6f66 2060 6063 6875 6e6b 6060 2069 7320  of ``chunk`` is 
+00012630: 613a 0a0a 2020 2020 2020 2020 2020 2020  a:..            
+00012640: 2d20 7363 616c 6172 3a20 496e 7075 7420  - scalar: Input 
+00012650: 6973 2061 2053 6572 6965 732c 2077 6974  is a Series, wit
+00012660: 6820 6f6e 6520 726f 7720 7065 7220 7061  h one row per pa
+00012670: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
+00012680: 2020 2020 202d 2053 6572 6965 733a 2049       - Series: I
+00012690: 6e70 7574 2069 7320 6120 4461 7461 4672  nput is a DataFr
+000126a0: 616d 652c 2077 6974 6820 6f6e 6520 726f  ame, with one ro
+000126b0: 7720 7065 7220 7061 7274 6974 696f 6e2e  w per partition.
+000126c0: 2043 6f6c 756d 6e73 0a20 2020 2020 2020   Columns.       
+000126d0: 2020 2020 2020 2061 7265 2074 6865 2072         are the r
+000126e0: 6f77 7320 696e 2074 6865 206f 7574 7075  ows in the outpu
+000126f0: 7420 7365 7269 6573 2e0a 2020 2020 2020  t series..      
+00012700: 2020 2020 2020 2d20 4461 7461 4672 616d        - DataFram
+00012710: 653a 2049 6e70 7574 2069 7320 6120 4461  e: Input is a Da
+00012720: 7461 4672 616d 652c 2077 6974 6820 6f6e  taFrame, with on
+00012730: 6520 726f 7720 7065 7220 7061 7274 6974  e row per partit
+00012740: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+00012750: 2020 2043 6f6c 756d 6e73 2061 7265 2074     Columns are t
+00012760: 6865 2063 6f6c 756d 6e73 2069 6e20 7468  he columns in th
+00012770: 6520 6f75 7470 7574 2064 6174 6166 7261  e output datafra
+00012780: 6d65 732e 0a0a 2020 2020 2020 2020 2020  mes...          
+00012790: 2020 5368 6f75 6c64 2072 6574 7572 6e20    Should return 
+000127a0: 6120 6060 7061 6e64 6173 2e44 6174 6146  a ``pandas.DataF
+000127b0: 7261 6d65 6060 2c20 6060 7061 6e64 6173  rame``, ``pandas
+000127c0: 2e53 6572 6965 7360 602c 206f 7220 610a  .Series``, or a.
+000127d0: 2020 2020 2020 2020 2020 2020 7363 616c              scal
+000127e0: 6172 2e0a 2020 2020 2020 2020 636f 6d62  ar..        comb
+000127f0: 696e 6520 3a20 6361 6c6c 6162 6c65 2c20  ine : callable, 
+00012800: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00012810: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
+00012820: 206f 7065 7261 7465 206f 6e20 696e 7465   operate on inte
+00012830: 726d 6564 6961 7465 2063 6f6e 6361 7465  rmediate concate
+00012840: 6e61 7465 6420 7265 7375 6c74 7320 6f66  nated results of
+00012850: 0a20 2020 2020 2020 2020 2020 2060 6063  .            ``c
+00012860: 6875 6e6b 6060 2069 6e20 6120 7472 6565  hunk`` in a tree
+00012870: 2d72 6564 7563 7469 6f6e 2e20 4966 206e  -reduction. If n
+00012880: 6f74 2070 726f 7669 6465 642c 2064 6566  ot provided, def
+00012890: 6175 6c74 7320 746f 0a20 2020 2020 2020  aults to.       
+000128a0: 2020 2020 2060 6061 6767 7265 6761 7465       ``aggregate
+000128b0: 6060 2e20 5468 6520 696e 7075 742f 6f75  ``. The input/ou
+000128c0: 7470 7574 2072 6571 7569 7265 6d65 6e74  tput requirement
+000128d0: 7320 7368 6f75 6c64 206d 6174 6368 2074  s should match t
+000128e0: 6861 7420 6f66 0a20 2020 2020 2020 2020  hat of.         
+000128f0: 2020 2060 6061 6767 7265 6761 7465 6060     ``aggregate``
+00012900: 2064 6573 6372 6962 6564 2061 626f 7665   described above
+00012910: 2e0a 2020 2020 2020 2020 244d 4554 410a  ..        $META.
+00012920: 2020 2020 2020 2020 746f 6b65 6e20 3a20          token : 
+00012930: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
+00012940: 2020 2020 2020 2020 2020 5468 6520 6e61            The na
+00012950: 6d65 2074 6f20 7573 6520 666f 7220 7468  me to use for th
+00012960: 6520 6f75 7470 7574 206b 6579 732e 0a20  e output keys.. 
+00012970: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00012980: 7279 203a 2069 6e74 2c20 6f70 7469 6f6e  ry : int, option
+00012990: 616c 0a20 2020 2020 2020 2020 2020 2047  al.            G
+000129a0: 726f 7570 2070 6172 7469 7469 6f6e 7320  roup partitions 
+000129b0: 696e 746f 2067 726f 7570 7320 6f66 2074  into groups of t
+000129c0: 6869 7320 7369 7a65 2077 6869 6c65 2070  his size while p
+000129d0: 6572 666f 726d 696e 6720 610a 2020 2020  erforming a.    
+000129e0: 2020 2020 2020 2020 7472 6565 2d72 6564          tree-red
+000129f0: 7563 7469 6f6e 2e20 4966 2073 6574 2074  uction. If set t
+00012a00: 6f20 4661 6c73 652c 206e 6f20 7472 6565  o False, no tree
+00012a10: 2d72 6564 7563 7469 6f6e 2077 696c 6c20  -reduction will 
+00012a20: 6265 2075 7365 642c 0a20 2020 2020 2020  be used,.       
+00012a30: 2020 2020 2061 6e64 2061 6c6c 2069 6e74       and all int
+00012a40: 6572 6d65 6469 6174 6573 2077 696c 6c20  ermediates will 
+00012a50: 6265 2063 6f6e 6361 7465 6e61 7465 6420  be concatenated 
+00012a60: 616e 6420 7061 7373 6564 2074 6f0a 2020  and passed to.  
+00012a70: 2020 2020 2020 2020 2020 6060 6167 6772            ``aggr
+00012a80: 6567 6174 6560 602e 2044 6566 6175 6c74  egate``. Default
+00012a90: 2069 7320 382e 0a20 2020 2020 2020 2063   is 8..        c
+00012aa0: 6875 6e6b 5f6b 7761 7267 7320 3a20 6469  hunk_kwargs : di
+00012ab0: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
+00012ac0: 2020 2020 2020 2020 204b 6579 776f 7264           Keyword
+00012ad0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+00012ae0: 7373 206f 6e20 746f 2060 6063 6875 6e6b  ss on to ``chunk
+00012af0: 6060 206f 6e6c 792e 0a20 2020 2020 2020  `` only..       
+00012b00: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
+00012b10: 7320 3a20 6469 6374 2c20 6f70 7469 6f6e  s : dict, option
+00012b20: 616c 0a20 2020 2020 2020 2020 2020 204b  al.            K
+00012b30: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
+00012b40: 2074 6f20 7061 7373 206f 6e20 746f 2060   to pass on to `
+00012b50: 6061 6767 7265 6761 7465 6060 206f 6e6c  `aggregate`` onl
+00012b60: 792e 0a20 2020 2020 2020 2063 6f6d 6269  y..        combi
+00012b70: 6e65 5f6b 7761 7267 7320 3a20 6469 6374  ne_kwargs : dict
+00012b80: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00012b90: 2020 2020 2020 204b 6579 776f 7264 2061         Keyword a
+00012ba0: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
+00012bb0: 206f 6e20 746f 2060 6063 6f6d 6269 6e65   on to ``combine
+00012bc0: 6060 206f 6e6c 792e 0a20 2020 2020 2020  `` only..       
+00012bd0: 206b 7761 7267 7320 3a0a 2020 2020 2020   kwargs :.      
+00012be0: 2020 2020 2020 416c 6c20 7265 6d61 696e        All remain
+00012bf0: 696e 6720 6b65 7977 6f72 6473 2077 696c  ing keywords wil
+00012c00: 6c20 6265 2070 6173 7365 6420 746f 2060  l be passed to `
+00012c10: 6063 6875 6e6b 6060 2c20 6060 636f 6d62  `chunk``, ``comb
+00012c20: 696e 6560 602c 0a20 2020 2020 2020 2020  ine``,.         
+00012c30: 2020 2061 6e64 2060 6061 6767 7265 6761     and ``aggrega
+00012c40: 7465 6060 2e0a 0a20 2020 2020 2020 2045  te``...        E
+00012c50: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00012c60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00012c70: 203e 3e3e 2069 6d70 6f72 7420 7061 6e64   >>> import pand
+00012c80: 6173 2061 7320 7064 0a20 2020 2020 2020  as as pd.       
+00012c90: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
+00012ca0: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
+00012cb0: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+00012cc0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+00012cd0: 2778 273a 2072 616e 6765 2835 3029 2c20  'x': range(50), 
+00012ce0: 2779 273a 2072 616e 6765 2835 302c 2031  'y': range(50, 1
+00012cf0: 3030 297d 290a 2020 2020 2020 2020 3e3e  00)}).        >>
+00012d00: 3e20 6464 6620 3d20 6464 2e66 726f 6d5f  > ddf = dd.from_
+00012d10: 7061 6e64 6173 2864 662c 206e 7061 7274  pandas(df, npart
+00012d20: 6974 696f 6e73 3d34 290a 0a20 2020 2020  itions=4)..     
+00012d30: 2020 2043 6f75 6e74 2074 6865 206e 756d     Count the num
+00012d40: 6265 7220 6f66 2072 6f77 7320 696e 2061  ber of rows in a
+00012d50: 2044 6174 6146 7261 6d65 2e20 546f 2064   DataFrame. To d
+00012d60: 6f20 7468 6973 2c20 636f 756e 7420 7468  o this, count th
+00012d70: 6520 6e75 6d62 6572 0a20 2020 2020 2020  e number.       
+00012d80: 206f 6620 726f 7773 2069 6e20 6561 6368   of rows in each
+00012d90: 2070 6172 7469 7469 6f6e 2c20 7468 656e   partition, then
+00012da0: 2073 756d 2074 6865 2072 6573 756c 7473   sum the results
+00012db0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2072  :..        >>> r
+00012dc0: 6573 203d 2064 6466 2e72 6564 7563 7469  es = ddf.reducti
+00012dd0: 6f6e 286c 616d 6264 6120 783a 2078 2e63  on(lambda x: x.c
+00012de0: 6f75 6e74 2829 2c0a 2020 2020 2020 2020  ount(),.        
+00012df0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00012e00: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00012e10: 653d 6c61 6d62 6461 2078 3a20 782e 7375  e=lambda x: x.su
+00012e20: 6d28 2929 0a20 2020 2020 2020 203e 3e3e  m()).        >>>
+00012e30: 2072 6573 2e63 6f6d 7075 7465 2829 0a20   res.compute(). 
+00012e40: 2020 2020 2020 2078 2020 2020 3530 0a20         x    50. 
+00012e50: 2020 2020 2020 2079 2020 2020 3530 0a20         y    50. 
+00012e60: 2020 2020 2020 2064 7479 7065 3a20 696e         dtype: in
+00012e70: 7436 340a 0a20 2020 2020 2020 2043 6f75  t64..        Cou
+00012e80: 6e74 2074 6865 206e 756d 6265 7220 6f66  nt the number of
+00012e90: 2072 6f77 7320 696e 2061 2053 6572 6965   rows in a Serie
+00012ea0: 7320 7769 7468 2065 6c65 6d65 6e74 7320  s with elements 
+00012eb0: 6772 6561 7465 7220 7468 616e 206f 720a  greater than or.
+00012ec0: 2020 2020 2020 2020 6571 7561 6c20 746f          equal to
+00012ed0: 2061 2076 616c 7565 2028 7072 6f76 6964   a value (provid
+00012ee0: 6564 2076 6961 2061 206b 6579 776f 7264  ed via a keyword
+00012ef0: 292e 0a0a 2020 2020 2020 2020 3e3e 3e20  )...        >>> 
+00012f00: 6465 6620 636f 756e 745f 6772 6561 7465  def count_greate
+00012f10: 7228 782c 2076 616c 7565 3d30 293a 0a20  r(x, value=0):. 
+00012f20: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
+00012f30: 6574 7572 6e20 2878 203e 3d20 7661 6c75  eturn (x >= valu
+00012f40: 6529 2e73 756d 2829 0a20 2020 2020 2020  e).sum().       
+00012f50: 203e 3e3e 2072 6573 203d 2064 6466 2e78   >>> res = ddf.x
+00012f60: 2e72 6564 7563 7469 6f6e 2863 6f75 6e74  .reduction(count
+00012f70: 5f67 7265 6174 6572 2c20 6167 6772 6567  _greater, aggreg
+00012f80: 6174 653d 6c61 6d62 6461 2078 3a20 782e  ate=lambda x: x.
+00012f90: 7375 6d28 292c 0a20 2020 2020 2020 202e  sum(),.        .
+00012fa0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00012fb0: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
+00012fc0: 7761 7267 733d 7b27 7661 6c75 6527 3a20  wargs={'value': 
+00012fd0: 3235 7d29 0a20 2020 2020 2020 203e 3e3e  25}).        >>>
+00012fe0: 2072 6573 2e63 6f6d 7075 7465 2829 0a20   res.compute(). 
+00012ff0: 2020 2020 2020 2032 350a 0a20 2020 2020         25..     
+00013000: 2020 2041 6767 7265 6761 7465 2062 6f74     Aggregate bot
+00013010: 6820 7468 6520 7375 6d20 616e 6420 636f  h the sum and co
+00013020: 756e 7420 6f66 2061 2053 6572 6965 7320  unt of a Series 
+00013030: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
+00013040: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00013050: 6566 2073 756d 5f61 6e64 5f63 6f75 6e74  ef sum_and_count
+00013060: 2878 293a 0a20 2020 2020 2020 202e 2e2e  (x):.        ...
+00013070: 2020 2020 2072 6574 7572 6e20 7064 2e53       return pd.S
+00013080: 6572 6965 7328 7b27 636f 756e 7427 3a20  eries({'count': 
+00013090: 782e 636f 756e 7428 292c 2027 7375 6d27  x.count(), 'sum'
+000130a0: 3a20 782e 7375 6d28 297d 2c0a 2020 2020  : x.sum()},.    
+000130b0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+000130c0: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+000130d0: 6578 3d5b 2763 6f75 6e74 272c 2027 7375  ex=['count', 'su
+000130e0: 6d27 5d29 0a20 2020 2020 2020 203e 3e3e  m']).        >>>
+000130f0: 2072 6573 203d 2064 6466 2e78 2e72 6564   res = ddf.x.red
+00013100: 7563 7469 6f6e 2873 756d 5f61 6e64 5f63  uction(sum_and_c
+00013110: 6f75 6e74 2c20 6167 6772 6567 6174 653d  ount, aggregate=
+00013120: 6c61 6d62 6461 2078 3a20 782e 7375 6d28  lambda x: x.sum(
+00013130: 2929 0a20 2020 2020 2020 203e 3e3e 2072  )).        >>> r
+00013140: 6573 2e63 6f6d 7075 7465 2829 0a20 2020  es.compute().   
+00013150: 2020 2020 2063 6f75 6e74 2020 2020 2020       count      
+00013160: 3530 0a20 2020 2020 2020 2073 756d 2020  50.        sum  
+00013170: 2020 2020 3132 3235 0a20 2020 2020 2020      1225.       
+00013180: 2064 7479 7065 3a20 696e 7436 340a 0a20   dtype: int64.. 
+00013190: 2020 2020 2020 2044 6f69 6e67 2074 6865         Doing the
+000131a0: 2073 616d 652c 2062 7574 2066 6f72 2061   same, but for a
+000131b0: 2044 6174 6146 7261 6d65 2e20 4865 7265   DataFrame. Here
+000131c0: 2060 6063 6875 6e6b 6060 2072 6574 7572   ``chunk`` retur
+000131d0: 6e73 2061 0a20 2020 2020 2020 2044 6174  ns a.        Dat
+000131e0: 6146 7261 6d65 2c20 6d65 616e 696e 6720  aFrame, meaning 
+000131f0: 7468 6520 696e 7075 7420 746f 2060 6061  the input to ``a
+00013200: 6767 7265 6761 7465 6060 2069 7320 6120  ggregate`` is a 
+00013210: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
+00013220: 6e0a 2020 2020 2020 2020 696e 6465 7820  n.        index 
+00013230: 7769 7468 206e 6f6e 2d75 6e69 7175 6520  with non-unique 
+00013240: 656e 7472 6965 7320 666f 7220 626f 7468  entries for both
+00013250: 2027 7827 2061 6e64 2027 7927 2e20 5765   'x' and 'y'. We
+00013260: 2067 726f 7570 6279 2074 6865 0a20 2020   groupby the.   
+00013270: 2020 2020 2069 6e64 6578 2c20 616e 6420       index, and 
+00013280: 7375 6d20 6561 6368 2067 726f 7570 2074  sum each group t
+00013290: 6f20 6765 7420 7468 6520 6669 6e61 6c20  o get the final 
+000132a0: 7265 7375 6c74 2e0a 0a20 2020 2020 2020  result...       
+000132b0: 203e 3e3e 2064 6566 2073 756d 5f61 6e64   >>> def sum_and
+000132c0: 5f63 6f75 6e74 2878 293a 0a20 2020 2020  _count(x):.     
+000132d0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+000132e0: 6e20 7064 2e44 6174 6146 7261 6d65 287b  n pd.DataFrame({
+000132f0: 2763 6f75 6e74 273a 2078 2e63 6f75 6e74  'count': x.count
+00013300: 2829 2c20 2773 756d 273a 2078 2e73 756d  (), 'sum': x.sum
+00013310: 2829 7d2c 0a20 2020 2020 2020 202e 2e2e  ()},.        ...
+00013320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013330: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+00013340: 3d5b 2763 6f75 6e74 272c 2027 7375 6d27  =['count', 'sum'
+00013350: 5d29 0a20 2020 2020 2020 203e 3e3e 2072  ]).        >>> r
+00013360: 6573 203d 2064 6466 2e72 6564 7563 7469  es = ddf.reducti
+00013370: 6f6e 2873 756d 5f61 6e64 5f63 6f75 6e74  on(sum_and_count
+00013380: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00013390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000133a0: 2020 6167 6772 6567 6174 653d 6c61 6d62    aggregate=lamb
+000133b0: 6461 2078 3a20 782e 6772 6f75 7062 7928  da x: x.groupby(
+000133c0: 6c65 7665 6c3d 3029 2e73 756d 2829 290a  level=0).sum()).
+000133d0: 2020 2020 2020 2020 3e3e 3e20 7265 732e          >>> res.
+000133e0: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
+000133f0: 2020 2020 2063 6f75 6e74 2020 2073 756d       count   sum
+00013400: 0a20 2020 2020 2020 2078 2020 2020 2035  .        x     5
+00013410: 3020 2031 3232 350a 2020 2020 2020 2020  0  1225.        
+00013420: 7920 2020 2020 3530 2020 3337 3235 0a20  y     50  3725. 
+00013430: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013440: 2020 2069 6620 7370 6c69 745f 6576 6572     if split_ever
+00013450: 7920 6973 206e 6f74 204e 6f6e 6520 616e  y is not None an
+00013460: 6420 7370 6c69 745f 6576 6572 7920 3c20  d split_every < 
+00013470: 3220 616e 6420 7370 6c69 745f 6576 6572  2 and split_ever
+00013480: 7920 6973 206e 6f74 2046 616c 7365 3a0a  y is not False:.
+00013490: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000134a0: 6520 5661 6c75 6545 7272 6f72 2822 7370  e ValueError("sp
+000134b0: 6c69 745f 6576 6572 7920 6d75 7374 2062  lit_every must b
+000134c0: 6520 6174 206c 6561 7374 2032 2229 0a0a  e at least 2")..
+000134d0: 2020 2020 2020 2020 6966 2063 6f6d 6269          if combi
+000134e0: 6e65 2069 7320 4e6f 6e65 3a0a 2020 2020  ne is None:.    
+000134f0: 2020 2020 2020 2020 6966 2063 6f6d 6269          if combi
+00013500: 6e65 5f6b 7761 7267 733a 0a20 2020 2020  ne_kwargs:.     
+00013510: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013520: 2056 616c 7565 4572 726f 7228 2260 636f   ValueError("`co
+00013530: 6d62 696e 655f 6b77 6172 6773 6020 7072  mbine_kwargs` pr
+00013540: 6f76 6964 6564 2077 6974 6820 6e6f 2060  ovided with no `
+00013550: 636f 6d62 696e 6560 2229 0a0a 2020 2020  combine`")..    
+00013560: 2020 2020 6368 756e 6b5f 6b77 6172 6773      chunk_kwargs
+00013570: 203d 2063 6875 6e6b 5f6b 7761 7267 732e   = chunk_kwargs.
+00013580: 636f 7079 2829 2069 6620 6368 756e 6b5f  copy() if chunk_
+00013590: 6b77 6172 6773 2065 6c73 6520 7b7d 0a20  kwargs else {}. 
+000135a0: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
+000135b0: 7267 732e 7570 6461 7465 286b 7761 7267  rgs.update(kwarg
+000135c0: 7329 0a20 2020 2020 2020 2063 6875 6e6b  s).        chunk
+000135d0: 5f6b 7761 7267 735b 2266 756e 6322 5d20  _kwargs["func"] 
+000135e0: 3d20 6368 756e 6b0a 0a20 2020 2020 2020  = chunk..       
+000135f0: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
+00013600: 3d20 636f 6d62 696e 655f 6b77 6172 6773  = combine_kwargs
+00013610: 2e63 6f70 7928 2920 6966 2063 6f6d 6269  .copy() if combi
+00013620: 6e65 5f6b 7761 7267 7320 656c 7365 207b  ne_kwargs else {
+00013630: 7d0a 2020 2020 2020 2020 636f 6d62 696e  }.        combin
+00013640: 655f 6b77 6172 6773 2e75 7064 6174 6528  e_kwargs.update(
+00013650: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00013660: 636f 6d62 696e 655f 6b77 6172 6773 5b22  combine_kwargs["
+00013670: 6675 6e63 225d 203d 2063 6f6d 6269 6e65  func"] = combine
+00013680: 206f 7220 6167 6772 6567 6174 6520 6f72   or aggregate or
+00013690: 2063 6875 6e6b 0a0a 2020 2020 2020 2020   chunk..        
+000136a0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+000136b0: 203d 2061 6767 7265 6761 7465 5f6b 7761   = aggregate_kwa
+000136c0: 7267 732e 636f 7079 2829 2069 6620 6167  rgs.copy() if ag
+000136d0: 6772 6567 6174 655f 6b77 6172 6773 2065  gregate_kwargs e
+000136e0: 6c73 6520 7b7d 0a20 2020 2020 2020 2061  lse {}.        a
+000136f0: 6767 7265 6761 7465 5f6b 7761 7267 732e  ggregate_kwargs.
+00013700: 7570 6461 7465 286b 7761 7267 7329 0a20  update(kwargs). 
+00013710: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+00013720: 5f6b 7761 7267 735b 2266 756e 6322 5d20  _kwargs["func"] 
+00013730: 3d20 6167 6772 6567 6174 6520 6f72 2063  = aggregate or c
+00013740: 6875 6e6b 0a0a 2020 2020 2020 2020 7265  hunk..        re
+00013750: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00013760: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00013770: 2043 7573 746f 6d52 6564 7563 7469 6f6e   CustomReduction
+00013780: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00013790: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000137a0: 2020 2020 2020 2020 6d65 7461 2c0a 2020          meta,.  
+000137b0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+000137c0: 756e 6b5f 6b77 6172 6773 2c0a 2020 2020  unk_kwargs,.    
+000137d0: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+000137e0: 6567 6174 655f 6b77 6172 6773 2c0a 2020  egate_kwargs,.  
+000137f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00013800: 6d62 696e 655f 6b77 6172 6773 2c0a 2020  mbine_kwargs,.  
+00013810: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+00013820: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00013830: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+00013840: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00013850: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00013860: 6566 206d 656d 6f72 795f 7573 6167 655f  ef memory_usage_
+00013870: 7065 725f 7061 7274 6974 696f 6e28 7365  per_partition(se
+00013880: 6c66 2c20 696e 6465 783a 2062 6f6f 6c20  lf, index: bool 
+00013890: 3d20 5472 7565 2c20 6465 6570 3a20 626f  = True, deep: bo
+000138a0: 6f6c 203d 2046 616c 7365 293a 0a20 2020  ol = False):.   
+000138b0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+000138c0: 6865 206d 656d 6f72 7920 7573 6167 6520  he memory usage 
+000138d0: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
+000138e0: 6e0a 0a20 2020 2020 2020 2050 6172 616d  n..        Param
+000138f0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00013900: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00013910: 2069 6e64 6578 203a 2062 6f6f 6c2c 2064   index : bool, d
+00013920: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
+00013930: 2020 2020 2020 2020 5370 6563 6966 6965          Specifie
+00013940: 7320 7768 6574 6865 7220 746f 2069 6e63  s whether to inc
+00013950: 6c75 6465 2074 6865 206d 656d 6f72 7920  lude the memory 
+00013960: 7573 6167 6520 6f66 2074 6865 2069 6e64  usage of the ind
+00013970: 6578 2069 6e0a 2020 2020 2020 2020 2020  ex in.          
+00013980: 2020 7265 7475 726e 6564 2053 6572 6965    returned Serie
+00013990: 732e 0a20 2020 2020 2020 2064 6565 7020  s..        deep 
+000139a0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+000139b0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+000139c0: 2020 4966 2054 7275 652c 2069 6e74 726f    If True, intro
+000139d0: 7370 6563 7420 7468 6520 6461 7461 2064  spect the data d
+000139e0: 6565 706c 7920 6279 2069 6e74 6572 726f  eeply by interro
+000139f0: 6761 7469 6e67 0a20 2020 2020 2020 2020  gating.         
+00013a00: 2020 2060 606f 626a 6563 7460 6020 6474     ``object`` dt
+00013a10: 7970 6573 2066 6f72 2073 7973 7465 6d2d  ypes for system-
+00013a20: 6c65 7665 6c20 6d65 6d6f 7279 2063 6f6e  level memory con
+00013a30: 7375 6d70 7469 6f6e 2c20 616e 6420 696e  sumption, and in
+00013a40: 636c 7564 650a 2020 2020 2020 2020 2020  clude.          
+00013a50: 2020 6974 2069 6e20 7468 6520 7265 7475    it in the retu
+00013a60: 726e 6564 2076 616c 7565 732e 0a0a 2020  rned values...  
+00013a70: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00013a80: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00013a90: 2020 2020 2020 5365 7269 6573 0a20 2020        Series.   
+00013aa0: 2020 2020 2020 2020 2041 2053 6572 6965           A Serie
+00013ab0: 7320 7768 6f73 6520 696e 6465 7820 6973  s whose index is
+00013ac0: 2074 6865 2070 6172 7469 7469 6f6e 206e   the partition n
+00013ad0: 756d 6265 7220 616e 6420 7768 6f73 6520  umber and whose 
+00013ae0: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
+00013af0: 2020 2061 7265 2074 6865 206d 656d 6f72     are the memor
+00013b00: 7920 7573 6167 6520 6f66 2065 6163 6820  y usage of each 
+00013b10: 7061 7274 6974 696f 6e20 696e 2062 7974  partition in byt
+00013b20: 6573 2e0a 2020 2020 2020 2020 2222 220a  es..        """.
+00013b30: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00013b40: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00013b50: 6c66 2e65 7870 722e 6d65 6d6f 7279 5f75  lf.expr.memory_u
+00013b60: 7361 6765 5f70 6572 5f70 6172 7469 7469  sage_per_partiti
+00013b70: 6f6e 2869 6e64 6578 2c20 6465 6570 2929  on(index, deep))
+00013b80: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00013b90: 2020 2020 6465 6620 6c6f 6328 7365 6c66      def loc(self
+00013ba0: 293a 0a20 2020 2020 2020 2022 2222 5075  ):.        """Pu
+00013bb0: 7265 6c79 206c 6162 656c 2d6c 6f63 6174  rely label-locat
+00013bc0: 696f 6e20 6261 7365 6420 696e 6465 7865  ion based indexe
+00013bd0: 7220 666f 7220 7365 6c65 6374 696f 6e20  r for selection 
+00013be0: 6279 206c 6162 656c 2e0a 0a20 2020 2020  by label...     
+00013bf0: 2020 203e 3e3e 2064 662e 6c6f 635b 2262     >>> df.loc["b
+00013c00: 225d 2020 2320 646f 6374 6573 743a 202b  "]  # doctest: +
+00013c10: 534b 4950 0a20 2020 2020 2020 203e 3e3e  SKIP.        >>>
+00013c20: 2064 662e 6c6f 635b 2262 223a 2264 225d   df.loc["b":"d"]
+00013c30: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+00013c40: 4950 0a20 2020 2020 2020 2022 2222 0a20  IP.        """. 
+00013c50: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00013c60: 5f65 7870 722e 5f69 6e64 6578 696e 6720  _expr._indexing 
+00013c70: 696d 706f 7274 204c 6f63 496e 6465 7865  import LocIndexe
+00013c80: 720a 0a20 2020 2020 2020 2072 6574 7572  r..        retur
+00013c90: 6e20 4c6f 6349 6e64 6578 6572 2873 656c  n LocIndexer(sel
+00013ca0: 6629 0a0a 2020 2020 4064 6572 6976 6564  f)..    @derived
+00013cb0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00013cc0: 6d65 290a 2020 2020 6465 6620 6e6f 746e  me).    def notn
+00013cd0: 756c 6c28 7365 6c66 293a 0a20 2020 2020  ull(self):.     
+00013ce0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00013cf0: 6c6c 6563 7469 6f6e 2865 7870 722e 4e6f  llection(expr.No
+00013d00: 744e 756c 6c28 7365 6c66 2929 0a0a 2020  tNull(self))..  
+00013d10: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00013d20: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00013d30: 2020 6465 6620 6973 6e75 6c6c 2873 656c    def isnull(sel
+00013d40: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00013d50: 726e 207e 7365 6c66 2e6e 6f74 6e75 6c6c  rn ~self.notnull
+00013d60: 2829 0a0a 2020 2020 6465 6620 636f 6d70  ()..    def comp
+00013d70: 7574 655f 6375 7272 656e 745f 6469 7669  ute_current_divi
+00013d80: 7369 6f6e 7328 7365 6c66 2c20 636f 6c3d  sions(self, col=
+00013d90: 4e6f 6e65 2c20 7365 745f 6469 7669 7369  None, set_divisi
+00013da0: 6f6e 733a 2062 6f6f 6c20 3d20 4661 6c73  ons: bool = Fals
+00013db0: 6529 3a0a 2020 2020 2020 2020 2222 2243  e):.        """C
+00013dc0: 6f6d 7075 7465 2074 6865 2063 7572 7265  ompute the curre
+00013dd0: 6e74 2064 6976 6973 696f 6e73 206f 6620  nt divisions of 
+00013de0: 7468 6520 4461 7461 4672 616d 652e 0a0a  the DataFrame...
+00013df0: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+00013e00: 686f 6420 7472 6967 6765 7273 2069 6d6d  hod triggers imm
+00013e10: 6564 6961 7465 2063 6f6d 7075 7461 7469  ediate computati
+00013e20: 6f6e 2e20 4966 2079 6f75 2066 696e 6420  on. If you find 
+00013e30: 796f 7572 7365 6c66 2072 756e 6e69 6e67  yourself running
+00013e40: 2074 6869 7320 636f 6d6d 616e 640a 2020   this command.  
+00013e50: 2020 2020 2020 7265 7065 6174 6564 6c79        repeatedly
+00013e60: 2066 6f72 2074 6865 2073 616d 6520 6461   for the same da
+00013e70: 7461 6672 616d 652c 2077 6520 7265 636f  taframe, we reco
+00013e80: 6d6d 656e 6420 7374 6f72 696e 6720 7468  mmend storing th
+00013e90: 6520 7265 7375 6c74 0a20 2020 2020 2020  e result.       
+00013ea0: 2073 6f20 796f 7520 646f 6e27 7420 6861   so you don't ha
+00013eb0: 7665 2074 6f20 7265 7275 6e20 6974 2e0a  ve to rerun it..
+00013ec0: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
+00013ed0: 636f 6c75 6d6e 206f 7220 696e 6465 7820  column or index 
+00013ee0: 7661 6c75 6573 206f 7665 726c 6170 2062  values overlap b
+00013ef0: 6574 7765 656e 2070 6172 7469 7469 6f6e  etween partition
+00013f00: 732c 2072 6169 7365 7320 6060 5661 6c75  s, raises ``Valu
+00013f10: 6545 7272 6f72 6060 2e0a 2020 2020 2020  eError``..      
+00013f20: 2020 546f 2070 7265 7665 6e74 2074 6869    To prevent thi
+00013f30: 732c 206d 616b 6520 7375 7265 2074 6865  s, make sure the
+00013f40: 2064 6174 6120 6172 6520 736f 7274 6564   data are sorted
+00013f50: 2062 7920 7468 6520 636f 6c75 6d6e 206f   by the column o
+00013f60: 7220 696e 6465 782e 0a0a 2020 2020 2020  r index...      
+00013f70: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00013f80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00013f90: 2020 2020 2020 2020 636f 6c20 3a20 7374          col : st
+00013fa0: 7269 6e67 2c20 6f70 7469 6f6e 616c 0a20  ring, optional. 
+00013fb0: 2020 2020 2020 2020 2020 2043 616c 6375             Calcu
+00013fc0: 6c61 7465 2074 6865 2064 6976 6973 696f  late the divisio
+00013fd0: 6e73 2066 6f72 2061 206e 6f6e 2d69 6e64  ns for a non-ind
+00013fe0: 6578 2063 6f6c 756d 6e20 6279 2070 6173  ex column by pas
+00013ff0: 7369 6e67 2069 6e20 7468 6520 6e61 6d65  sing in the name
+00014000: 206f 6620 7468 6520 636f 6c75 6d6e 2e0a   of the column..
+00014010: 2020 2020 2020 2020 2020 2020 4966 2063              If c
+00014020: 6f6c 2069 7320 6e6f 7420 7370 6563 6966  ol is not specif
+00014030: 6965 642c 2074 6865 2069 6e64 6578 2077  ied, the index w
+00014040: 696c 6c20 6265 2075 7365 6420 746f 2063  ill be used to c
+00014050: 616c 6375 6c61 7465 2064 6976 6973 696f  alculate divisio
+00014060: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+00014070: 496e 2074 6869 7320 6361 7365 2c20 6966  In this case, if
+00014080: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
+00014090: 7265 2061 6c72 6561 6479 206b 6e6f 776e  re already known
+000140a0: 2c20 7468 6579 2077 696c 6c20 6265 2072  , they will be r
+000140b0: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
+000140c0: 2020 2020 696d 6d65 6469 6174 656c 7920      immediately 
+000140d0: 7769 7468 6f75 7420 636f 6d70 7574 696e  without computin
+000140e0: 672e 0a20 2020 2020 2020 2073 6574 5f64  g..        set_d
+000140f0: 6976 6973 696f 6e73 203a 2062 6f6f 6c2c  ivisions : bool,
+00014100: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
+00014110: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00014120: 6572 2074 6f20 7365 7420 7468 6520 636f  er to set the co
+00014130: 6d70 7574 6564 2064 6976 6973 696f 6e73  mputed divisions
+00014140: 2069 6e74 6f20 7468 6520 4461 7461 4672   into the DataFr
+00014150: 616d 652e 2049 6620 4661 6c73 652c 2074  ame. If False, t
+00014160: 6865 2064 6976 6973 696f 6e73 0a20 2020  he divisions.   
+00014170: 2020 2020 2020 2020 206f 6620 7468 6520           of the 
+00014180: 4461 7461 4672 616d 6520 6172 6520 756e  DataFrame are un
+00014190: 6368 616e 6765 642e 0a0a 2020 2020 2020  changed...      
+000141a0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+000141b0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+000141c0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+000141d0: 6173 6b0a 2020 2020 2020 2020 3e3e 3e20  ask.        >>> 
+000141e0: 6464 6620 3d20 6461 736b 2e64 6174 6173  ddf = dask.datas
+000141f0: 6574 732e 7469 6d65 7365 7269 6573 2873  ets.timeseries(s
+00014200: 7461 7274 3d22 3230 3231 2d30 312d 3031  tart="2021-01-01
+00014210: 222c 2065 6e64 3d22 3230 3231 2d30 312d  ", end="2021-01-
+00014220: 3037 222c 2066 7265 713d 2231 6822 292e  07", freq="1h").
+00014230: 636c 6561 725f 6469 7669 7369 6f6e 7328  clear_divisions(
+00014240: 290a 2020 2020 2020 2020 3e3e 3e20 6469  ).        >>> di
+00014250: 7669 7369 6f6e 7320 3d20 6464 662e 636f  visions = ddf.co
+00014260: 6d70 7574 655f 6375 7272 656e 745f 6469  mpute_current_di
+00014270: 7669 7369 6f6e 7328 290a 2020 2020 2020  visions().      
+00014280: 2020 3e3e 3e20 7072 696e 7428 6469 7669    >>> print(divi
+00014290: 7369 6f6e 7329 2020 2320 646f 6374 6573  sions)  # doctes
+000142a0: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
+000142b0: 4954 4553 5041 4345 0a20 2020 2020 2020  ITESPACE.       
+000142c0: 2028 5469 6d65 7374 616d 7028 2732 3032   (Timestamp('202
+000142d0: 312d 3031 2d30 3120 3030 3a30 303a 3030  1-01-01 00:00:00
+000142e0: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
+000142f0: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
+00014300: 3032 2030 303a 3030 3a30 3027 292c 0a20  02 00:00:00'),. 
+00014310: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
+00014320: 7028 2732 3032 312d 3031 2d30 3320 3030  p('2021-01-03 00
+00014330: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
+00014340: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
+00014350: 3231 2d30 312d 3034 2030 303a 3030 3a30  21-01-04 00:00:0
+00014360: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
+00014370: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
+00014380: 2d30 3520 3030 3a30 303a 3030 2729 2c0a  -05 00:00:00'),.
+00014390: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
+000143a0: 6d70 2827 3230 3231 2d30 312d 3036 2030  mp('2021-01-06 0
+000143b0: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
+000143c0: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
+000143d0: 3032 312d 3031 2d30 3620 3233 3a30 303a  021-01-06 23:00:
+000143e0: 3030 2729 290a 0a20 2020 2020 2020 203e  00'))..        >
+000143f0: 3e3e 2064 6466 2e64 6976 6973 696f 6e73  >> ddf.divisions
+00014400: 203d 2064 6976 6973 696f 6e73 0a20 2020   = divisions.   
+00014410: 2020 2020 203e 3e3e 2064 6466 2e6b 6e6f       >>> ddf.kno
+00014420: 776e 5f64 6976 6973 696f 6e73 0a20 2020  wn_divisions.   
+00014430: 2020 2020 2054 7275 650a 0a20 2020 2020       True..     
+00014440: 2020 203e 3e3e 2064 6466 203d 2064 6466     >>> ddf = ddf
+00014450: 2e72 6573 6574 5f69 6e64 6578 2829 2e63  .reset_index().c
+00014460: 6c65 6172 5f64 6976 6973 696f 6e73 2829  lear_divisions()
+00014470: 0a20 2020 2020 2020 203e 3e3e 2064 6976  .        >>> div
+00014480: 6973 696f 6e73 203d 2064 6466 2e63 6f6d  isions = ddf.com
+00014490: 7075 7465 5f63 7572 7265 6e74 5f64 6976  pute_current_div
+000144a0: 6973 696f 6e73 2822 7469 6d65 7374 616d  isions("timestam
+000144b0: 7022 290a 2020 2020 2020 2020 3e3e 3e20  p").        >>> 
+000144c0: 7072 696e 7428 6469 7669 7369 6f6e 7329  print(divisions)
+000144d0: 2020 2320 646f 6374 6573 743a 202b 4e4f    # doctest: +NO
+000144e0: 524d 414c 495a 455f 5748 4954 4553 5041  RMALIZE_WHITESPA
+000144f0: 4345 0a20 2020 2020 2020 2028 5469 6d65  CE.        (Time
+00014500: 7374 616d 7028 2732 3032 312d 3031 2d30  stamp('2021-01-0
+00014510: 3120 3030 3a30 303a 3030 2729 2c0a 2020  1 00:00:00'),.  
+00014520: 2020 2020 2020 2054 696d 6573 7461 6d70         Timestamp
+00014530: 2827 3230 3231 2d30 312d 3032 2030 303a  ('2021-01-02 00:
+00014540: 3030 3a30 3027 292c 0a20 2020 2020 2020  00:00'),.       
+00014550: 2020 5469 6d65 7374 616d 7028 2732 3032    Timestamp('202
+00014560: 312d 3031 2d30 3320 3030 3a30 303a 3030  1-01-03 00:00:00
+00014570: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
+00014580: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
+00014590: 3034 2030 303a 3030 3a30 3027 292c 0a20  04 00:00:00'),. 
+000145a0: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
+000145b0: 7028 2732 3032 312d 3031 2d30 3520 3030  p('2021-01-05 00
+000145c0: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
+000145d0: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
+000145e0: 3231 2d30 312d 3036 2030 303a 3030 3a30  21-01-06 00:00:0
+000145f0: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
+00014600: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
+00014610: 2d30 3620 3233 3a30 303a 3030 2729 290a  -06 23:00:00')).
+00014620: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+00014630: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
+00014640: 2822 7469 6d65 7374 616d 7022 2c20 6469  ("timestamp", di
+00014650: 7669 7369 6f6e 733d 6469 7669 7369 6f6e  visions=division
+00014660: 732c 2073 6f72 7465 643d 5472 7565 290a  s, sorted=True).
+00014670: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00014680: 2020 2020 6966 2063 6f6c 2069 7320 4e6f      if col is No
+00014690: 6e65 2061 6e64 2073 656c 662e 6b6e 6f77  ne and self.know
+000146a0: 6e5f 6469 7669 7369 6f6e 733a 0a20 2020  n_divisions:.   
+000146b0: 2020 2020 2020 2020 2069 6620 7365 745f           if set_
+000146c0: 6469 7669 7369 6f6e 733a 0a20 2020 2020  divisions:.     
+000146d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000146e0: 6e20 7365 6c66 0a20 2020 2020 2020 2020  n self.         
+000146f0: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
+00014700: 6976 6973 696f 6e73 0a0a 2020 2020 2020  ivisions..      
+00014710: 2020 6966 2063 6f6c 2069 7320 6e6f 7420    if col is not 
+00014720: 4e6f 6e65 2061 6e64 2073 6574 5f64 6976  None and set_div
+00014730: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
+00014740: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00014750: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+00014760: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00014770: 4361 6e27 7420 7365 7420 6469 7669 7369  Can't set divisi
+00014780: 6f6e 7320 6f66 206e 6f6e 2d69 6e64 6578  ons of non-index
+00014790: 2c20 6361 6c6c 2073 6574 5f69 6e64 6578  , call set_index
+000147a0: 2069 6e73 7465 6164 2e22 0a20 2020 2020   instead.".     
+000147b0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000147c0: 2020 6966 2063 6f6c 2069 7320 6e6f 7420    if col is not 
+000147d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000147e0: 2020 6672 616d 6520 3d20 7365 6c66 5b63    frame = self[c
+000147f0: 6f6c 5d0a 2020 2020 2020 2020 656c 7365  ol].        else
+00014800: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
+00014810: 616d 6520 3d20 7365 6c66 2e69 6e64 6578  ame = self.index
+00014820: 0a0a 2020 2020 2020 2020 6d69 6e73 2c20  ..        mins, 
+00014830: 6d61 7865 732c 206c 656e 7320 3d20 5f63  maxes, lens = _c
+00014840: 6f6d 7075 7465 5f70 6172 7469 7469 6f6e  ompute_partition
+00014850: 5f73 7461 7473 2866 7261 6d65 2c20 616c  _stats(frame, al
+00014860: 6c6f 775f 6f76 6572 6c61 703d 7365 745f  low_overlap=set_
+00014870: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+00014880: 2020 2064 6976 6973 696f 6e73 203d 2074     divisions = t
+00014890: 7570 6c65 286d 696e 7329 202b 2028 6d61  uple(mins) + (ma
+000148a0: 7865 735b 2d31 5d2c 290a 2020 2020 2020  xes[-1],).      
+000148b0: 2020 6966 206e 6f74 2073 6574 5f64 6976    if not set_div
+000148c0: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
+000148d0: 2020 2020 7265 7475 726e 2064 6976 6973      return divis
+000148e0: 696f 6e73 0a20 2020 2020 2020 2069 6620  ions.        if 
+000148f0: 6c65 6e28 6d69 6e73 2920 3d3d 206c 656e  len(mins) == len
+00014900: 2873 656c 662e 6469 7669 7369 6f6e 7329  (self.divisions)
+00014910: 202d 2031 3a0a 2020 2020 2020 2020 2020   - 1:.          
+00014920: 2020 6966 206e 6f74 2061 6e79 286d 696e    if not any(min
+00014930: 735b 695d 203e 3d20 6d61 7865 735b 6920  s[i] >= maxes[i 
+00014940: 2d20 315d 2066 6f72 2069 2069 6e20 7261  - 1] for i in ra
+00014950: 6e67 6528 312c 206c 656e 286d 696e 7329  nge(1, len(mins)
+00014960: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00014970: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+00014980: 6f6c 6c65 6374 696f 6e28 6578 7072 2e53  ollection(expr.S
+00014990: 6574 4469 7669 7369 6f6e 7328 7365 6c66  etDivisions(self
+000149a0: 2c20 6469 7669 7369 6f6e 7329 290a 0a20  , divisions)).. 
+000149b0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000149c0: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
+000149d0: 722e 5265 736f 6c76 654f 7665 726c 6170  r.ResolveOverlap
+000149e0: 7069 6e67 4469 7669 7369 6f6e 7328 7365  pingDivisions(se
+000149f0: 6c66 2c20 6d69 6e73 2c20 6d61 7865 732c  lf, mins, maxes,
+00014a00: 206c 656e 7329 290a 0a20 2020 2040 636c   lens))..    @cl
+00014a10: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+00014a20: 6620 6672 6f6d 5f64 6963 7428 0a20 2020  f from_dict(.   
+00014a30: 2020 2020 2063 6c73 2c20 6461 7461 2c20       cls, data, 
+00014a40: 2a2c 206e 7061 7274 6974 696f 6e73 3d31  *, npartitions=1
+00014a50: 2c20 6f72 6965 6e74 3d22 636f 6c75 6d6e  , orient="column
+00014a60: 7322 2c20 6474 7970 653d 4e6f 6e65 2c20  s", dtype=None, 
+00014a70: 636f 6c75 6d6e 733d 4e6f 6e65 0a20 2020  columns=None.   
+00014a80: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+00014a90: 2020 2020 2020 2020 436f 6e73 7472 7563          Construc
+00014aa0: 7420 6120 4461 736b 2044 6174 6146 7261  t a Dask DataFra
+00014ab0: 6d65 2066 726f 6d20 6120 5079 7468 6f6e  me from a Python
+00014ac0: 2044 6963 7469 6f6e 6172 790a 0a20 2020   Dictionary..   
+00014ad0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00014ae0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00014af0: 2020 2020 2020 2064 6173 6b2e 6461 7461         dask.data
+00014b00: 6672 616d 652e 6672 6f6d 5f64 6963 740a  frame.from_dict.
+00014b10: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00014b20: 2020 2020 7265 7475 726e 2066 726f 6d5f      return from_
+00014b30: 6469 6374 2864 6174 612c 206e 7061 7274  dict(data, npart
+00014b40: 6974 696f 6e73 2c20 6f72 6965 6e74 2c20  itions, orient, 
+00014b50: 6474 7970 653d 6474 7970 652c 2063 6f6c  dtype=dtype, col
+00014b60: 756d 6e73 3d63 6f6c 756d 6e73 290a 0a20  umns=columns).. 
+00014b70: 2020 2064 6566 2074 6f5f 6a73 6f6e 2873     def to_json(s
+00014b80: 656c 662c 2066 696c 656e 616d 652c 202a  elf, filename, *
+00014b90: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00014ba0: 0a20 2020 2020 2020 2022 2222 5365 6520  .        """See 
+00014bb0: 6464 2e74 6f5f 6a73 6f6e 2064 6f63 7374  dd.to_json docst
+00014bc0: 7269 6e67 2066 6f72 206d 6f72 6520 696e  ring for more in
+00014bd0: 666f 726d 6174 696f 6e22 2222 0a20 2020  formation""".   
+00014be0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+00014bf0: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
+00014c00: 7274 2074 6f5f 6a73 6f6e 0a0a 2020 2020  rt to_json..    
+00014c10: 2020 2020 7265 7475 726e 2074 6f5f 6a73      return to_js
+00014c20: 6f6e 2873 656c 662c 2066 696c 656e 616d  on(self, filenam
+00014c30: 652c 202a 6172 6773 2c20 2a2a 6b77 6172  e, *args, **kwar
+00014c40: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
+00014c50: 7371 6c28 0a20 2020 2020 2020 2073 656c  sql(.        sel
+00014c60: 662c 0a20 2020 2020 2020 206e 616d 653a  f,.        name:
+00014c70: 2073 7472 2c0a 2020 2020 2020 2020 7572   str,.        ur
+00014c80: 693a 2073 7472 2c0a 2020 2020 2020 2020  i: str,.        
+00014c90: 7363 6865 6d61 3d4e 6f6e 652c 0a20 2020  schema=None,.   
+00014ca0: 2020 2020 2069 665f 6578 6973 7473 3a20       if_exists: 
+00014cb0: 7374 7220 3d20 2266 6169 6c22 2c0a 2020  str = "fail",.  
+00014cc0: 2020 2020 2020 696e 6465 783a 2062 6f6f        index: boo
+00014cd0: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
+00014ce0: 2020 696e 6465 785f 6c61 6265 6c3d 4e6f    index_label=No
+00014cf0: 6e65 2c0a 2020 2020 2020 2020 6368 756e  ne,.        chun
+00014d00: 6b73 697a 653d 4e6f 6e65 2c0a 2020 2020  ksize=None,.    
+00014d10: 2020 2020 6474 7970 653d 4e6f 6e65 2c0a      dtype=None,.
+00014d20: 2020 2020 2020 2020 6d65 7468 6f64 3d4e          method=N
+00014d30: 6f6e 652c 0a20 2020 2020 2020 2063 6f6d  one,.        com
+00014d40: 7075 7465 3d54 7275 652c 0a20 2020 2020  pute=True,.     
+00014d50: 2020 2070 6172 616c 6c65 6c3d 4661 6c73     parallel=Fals
+00014d60: 652c 0a20 2020 2020 2020 2065 6e67 696e  e,.        engin
+00014d70: 655f 6b77 6172 6773 3d4e 6f6e 652c 0a20  e_kwargs=None,. 
+00014d80: 2020 2029 3a0a 2020 2020 2020 2020 6672     ):.        fr
+00014d90: 6f6d 2064 6173 6b5f 6578 7072 2e69 6f2e  om dask_expr.io.
+00014da0: 7371 6c20 696d 706f 7274 2074 6f5f 7371  sql import to_sq
+00014db0: 6c0a 0a20 2020 2020 2020 2072 6574 7572  l..        retur
+00014dc0: 6e20 746f 5f73 716c 280a 2020 2020 2020  n to_sql(.      
+00014dd0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00014de0: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
+00014df0: 2020 2020 2020 2020 2020 7572 692c 0a20            uri,. 
+00014e00: 2020 2020 2020 2020 2020 2073 6368 656d             schem
+00014e10: 613d 7363 6865 6d61 2c0a 2020 2020 2020  a=schema,.      
+00014e20: 2020 2020 2020 6966 5f65 7869 7374 733d        if_exists=
+00014e30: 6966 5f65 7869 7374 732c 0a20 2020 2020  if_exists,.     
+00014e40: 2020 2020 2020 2069 6e64 6578 3d69 6e64         index=ind
+00014e50: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
+00014e60: 696e 6465 785f 6c61 6265 6c3d 696e 6465  index_label=inde
+00014e70: 785f 6c61 6265 6c2c 0a20 2020 2020 2020  x_label,.       
+00014e80: 2020 2020 2063 6875 6e6b 7369 7a65 3d63       chunksize=c
+00014e90: 6875 6e6b 7369 7a65 2c0a 2020 2020 2020  hunksize,.      
+00014ea0: 2020 2020 2020 6474 7970 653d 6474 7970        dtype=dtyp
+00014eb0: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+00014ec0: 6574 686f 643d 6d65 7468 6f64 2c0a 2020  ethod=method,.  
+00014ed0: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
+00014ee0: 653d 636f 6d70 7574 652c 0a20 2020 2020  e=compute,.     
+00014ef0: 2020 2020 2020 2070 6172 616c 6c65 6c3d         parallel=
+00014f00: 7061 7261 6c6c 656c 2c0a 2020 2020 2020  parallel,.      
+00014f10: 2020 2020 2020 656e 6769 6e65 5f6b 7761        engine_kwa
+00014f20: 7267 733d 656e 6769 6e65 5f6b 7761 7267  rgs=engine_kwarg
+00014f30: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
+00014f40: 2020 6465 6620 746f 5f6f 7263 2873 656c    def to_orc(sel
+00014f50: 662c 2070 6174 682c 202a 6172 6773 2c20  f, path, *args, 
+00014f60: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00014f70: 2020 2022 2222 5365 6520 6464 2e74 6f5f     """See dd.to_
+00014f80: 6f72 6320 646f 6373 7472 696e 6720 666f  orc docstring fo
+00014f90: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+00014fa0: 6f6e 2222 220a 2020 2020 2020 2020 6672  on""".        fr
+00014fb0: 6f6d 2064 6173 6b5f 6578 7072 2e69 6f2e  om dask_expr.io.
+00014fc0: 6f72 6320 696d 706f 7274 2074 6f5f 6f72  orc import to_or
+00014fd0: 630a 0a20 2020 2020 2020 2072 6574 7572  c..        retur
+00014fe0: 6e20 746f 5f6f 7263 2873 656c 662c 2070  n to_orc(self, p
+00014ff0: 6174 682c 202a 6172 6773 2c20 2a2a 6b77  ath, *args, **kw
+00015000: 6172 6773 290a 0a20 2020 2064 6566 2074  args)..    def t
+00015010: 6f5f 6373 7628 7365 6c66 2c20 6669 6c65  o_csv(self, file
+00015020: 6e61 6d65 2c20 2a2a 6b77 6172 6773 293a  name, **kwargs):
+00015030: 0a20 2020 2020 2020 2022 2222 5365 6520  .        """See 
+00015040: 6464 2e74 6f5f 6373 7620 646f 6373 7472  dd.to_csv docstr
+00015050: 696e 6720 666f 7220 6d6f 7265 2069 6e66  ing for more inf
+00015060: 6f72 6d61 7469 6f6e 2222 220a 2020 2020  ormation""".    
+00015070: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
+00015080: 7072 2e69 6f2e 6373 7620 696d 706f 7274  pr.io.csv import
+00015090: 2074 6f5f 6373 760a 0a20 2020 2020 2020   to_csv..       
+000150a0: 2072 6574 7572 6e20 746f 5f63 7376 2873   return to_csv(s
+000150b0: 656c 662c 2066 696c 656e 616d 652c 202a  elf, filename, *
+000150c0: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
+000150d0: 6620 746f 5f72 6563 6f72 6473 2873 656c  f to_records(sel
+000150e0: 662c 2069 6e64 6578 3d46 616c 7365 2c20  f, index=False, 
+000150f0: 6c65 6e67 7468 733d 4e6f 6e65 293a 0a20  lengths=None):. 
+00015100: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00015110: 5f65 7870 722e 696f 2e72 6563 6f72 6473  _expr.io.records
+00015120: 2069 6d70 6f72 7420 746f 5f72 6563 6f72   import to_recor
+00015130: 6473 0a0a 2020 2020 2020 2020 6966 206c  ds..        if l
+00015140: 656e 6774 6873 2069 7320 5472 7565 3a0a  engths is True:.
+00015150: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
+00015160: 7468 7320 3d20 7475 706c 6528 7365 6c66  ths = tuple(self
+00015170: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00015180: 6c65 6e29 2e63 6f6d 7075 7465 2829 290a  len).compute()).
+00015190: 0a20 2020 2020 2020 2066 7261 6d65 203d  .        frame =
+000151a0: 2073 656c 662e 746f 5f6c 6567 6163 795f   self.to_legacy_
+000151b0: 6461 7461 6672 616d 6528 290a 2020 2020  dataframe().    
+000151c0: 2020 2020 7265 636f 7264 7320 3d20 746f      records = to
+000151d0: 5f72 6563 6f72 6473 2866 7261 6d65 290a  _records(frame).
+000151e0: 0a20 2020 2020 2020 2063 6875 6e6b 7320  .        chunks 
+000151f0: 3d20 6672 616d 652e 5f76 616c 6964 6174  = frame._validat
+00015200: 655f 6368 756e 6b73 2872 6563 6f72 6473  e_chunks(records
+00015210: 2c20 6c65 6e67 7468 7329 0a20 2020 2020  , lengths).     
+00015220: 2020 2072 6563 6f72 6473 2e5f 6368 756e     records._chun
+00015230: 6b73 203d 2028 6368 756e 6b73 5b30 5d2c  ks = (chunks[0],
+00015240: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00015250: 6e20 7265 636f 7264 730a 0a20 2020 2064  n records..    d
+00015260: 6566 2074 6f5f 6261 6728 7365 6c66 2c20  ef to_bag(self, 
+00015270: 696e 6465 783d 4661 6c73 652c 2066 6f72  index=False, for
+00015280: 6d61 743d 2274 7570 6c65 2229 3a0a 2020  mat="tuple"):.  
+00015290: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
+000152a0: 6120 4461 736b 2042 6167 2066 726f 6d20  a Dask Bag from 
+000152b0: 6120 5365 7269 6573 2222 220a 2020 2020  a Series""".    
+000152c0: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
+000152d0: 7072 2e69 6f2e 6261 6720 696d 706f 7274  pr.io.bag import
+000152e0: 2074 6f5f 6261 670a 0a20 2020 2020 2020   to_bag..       
+000152f0: 2072 6574 7572 6e20 746f 5f62 6167 2873   return to_bag(s
+00015300: 656c 662c 2069 6e64 6578 2c20 666f 726d  elf, index, form
+00015310: 6174 3d66 6f72 6d61 7429 0a0a 2020 2020  at=format)..    
+00015320: 6465 6620 746f 5f68 6466 2873 656c 662c  def to_hdf(self,
+00015330: 2070 6174 685f 6f72 5f62 7566 2c20 6b65   path_or_buf, ke
+00015340: 792c 206d 6f64 653d 2261 222c 2061 7070  y, mode="a", app
+00015350: 656e 643d 4661 6c73 652c 202a 2a6b 7761  end=False, **kwa
+00015360: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+00015370: 2253 6565 2064 642e 746f 5f68 6466 2064  "See dd.to_hdf d
+00015380: 6f63 7374 7269 6e67 2066 6f72 206d 6f72  ocstring for mor
+00015390: 6520 696e 666f 726d 6174 696f 6e22 2222  e information"""
+000153a0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+000153b0: 736b 5f65 7870 722e 696f 2e68 6466 2069  sk_expr.io.hdf i
+000153c0: 6d70 6f72 7420 746f 5f68 6466 0a0a 2020  mport to_hdf..  
+000153d0: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
+000153e0: 6864 6628 7365 6c66 2c20 7061 7468 5f6f  hdf(self, path_o
+000153f0: 725f 6275 662c 206b 6579 2c20 6d6f 6465  r_buf, key, mode
+00015400: 2c20 6170 7065 6e64 2c20 2a2a 6b77 6172  , append, **kwar
+00015410: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
+00015420: 6465 6c61 7965 6428 7365 6c66 2c20 6f70  delayed(self, op
+00015430: 7469 6d69 7a65 5f67 7261 7068 3d54 7275  timize_graph=Tru
+00015440: 6529 3a0a 2020 2020 2020 2020 2222 2243  e):.        """C
+00015450: 6f6e 7665 7274 2069 6e74 6f20 6120 6c69  onvert into a li
+00015460: 7374 206f 6620 6060 6461 736b 2e64 656c  st of ``dask.del
+00015470: 6179 6564 6060 206f 626a 6563 7473 2c20  ayed`` objects, 
+00015480: 6f6e 6520 7065 7220 7061 7274 6974 696f  one per partitio
+00015490: 6e2e 0a0a 2020 2020 2020 2020 5061 7261  n...        Para
+000154a0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+000154b0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000154c0: 2020 6f70 7469 6d69 7a65 5f67 7261 7068    optimize_graph
+000154d0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+000154e0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
+000154f0: 2054 7275 6520 5b64 6566 6175 6c74 5d2c   True [default],
+00015500: 2074 6865 2067 7261 7068 2069 7320 6f70   the graph is op
+00015510: 7469 6d69 7a65 6420 6265 666f 7265 2063  timized before c
+00015520: 6f6e 7665 7274 696e 6720 696e 746f 0a20  onverting into. 
+00015530: 2020 2020 2020 2020 2020 2060 6064 6173             ``das
+00015540: 6b2e 6465 6c61 7965 6460 6020 6f62 6a65  k.delayed`` obje
+00015550: 6374 732e 0a0a 2020 2020 2020 2020 4578  cts...        Ex
+00015560: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+00015570: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00015580: 3e3e 3e20 7061 7274 6974 696f 6e73 203d  >>> partitions =
+00015590: 2064 662e 746f 5f64 656c 6179 6564 2829   df.to_delayed()
+000155a0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+000155b0: 4950 0a0a 2020 2020 2020 2020 5365 6520  IP..        See 
+000155c0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+000155d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+000155e0: 736b 5f65 7870 722e 6672 6f6d 5f64 656c  sk_expr.from_del
+000155f0: 6179 6564 0a20 2020 2020 2020 2022 2222  ayed.        """
+00015600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015610: 7365 6c66 2e74 6f5f 6c65 6761 6379 5f64  self.to_legacy_d
+00015620: 6174 6166 7261 6d65 2829 2e74 6f5f 6465  ataframe().to_de
+00015630: 6c61 7965 6428 6f70 7469 6d69 7a65 5f67  layed(optimize_g
+00015640: 7261 7068 3d6f 7074 696d 697a 655f 6772  raph=optimize_gr
+00015650: 6170 6829 0a0a 2020 2020 6465 6620 746f  aph)..    def to
+00015660: 5f62 6163 6b65 6e64 2873 656c 662c 2062  _backend(self, b
+00015670: 6163 6b65 6e64 3a20 7374 7220 7c20 4e6f  ackend: str | No
+00015680: 6e65 203d 204e 6f6e 652c 202a 2a6b 7761  ne = None, **kwa
+00015690: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+000156a0: 224d 6f76 6520 746f 2061 206e 6577 2044  "Move to a new D
+000156b0: 6174 6146 7261 6d65 2062 6163 6b65 6e64  ataFrame backend
+000156c0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000156d0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+000156e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000156f0: 6261 636b 656e 6420 3a20 7374 722c 204f  backend : str, O
+00015700: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00015710: 2020 2020 5468 6520 6e61 6d65 206f 6620      The name of 
+00015720: 7468 6520 6e65 7720 6261 636b 656e 6420  the new backend 
+00015730: 746f 206d 6f76 6520 746f 2e20 5468 6520  to move to. The 
+00015740: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
+00015750: 2020 2020 6973 2074 6865 2063 7572 7265      is the curre
+00015760: 6e74 2022 6461 7461 6672 616d 652e 6261  nt "dataframe.ba
+00015770: 636b 656e 6422 2063 6f6e 6669 6775 7261  ckend" configura
+00015780: 7469 6f6e 2e0a 0a20 2020 2020 2020 2052  tion...        R
+00015790: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+000157a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
+000157b0: 6174 6146 7261 6d65 2c20 5365 7269 6573  ataFrame, Series
+000157c0: 206f 7220 496e 6465 780a 2020 2020 2020   or Index.      
+000157d0: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+000157e0: 6f6d 2064 6173 6b5f 6578 7072 2e5f 6261  om dask_expr._ba
+000157f0: 636b 656e 6473 2069 6d70 6f72 7420 6461  ckends import da
+00015800: 7461 6672 616d 655f 6372 6561 7469 6f6e  taframe_creation
+00015810: 5f64 6973 7061 7463 680a 0a20 2020 2020  _dispatch..     
+00015820: 2020 2023 2047 6574 2064 6573 6972 6564     # Get desired
+00015830: 2062 6163 6b65 6e64 0a20 2020 2020 2020   backend.       
+00015840: 2062 6163 6b65 6e64 203d 2062 6163 6b65   backend = backe
+00015850: 6e64 206f 7220 6461 7461 6672 616d 655f  nd or dataframe_
+00015860: 6372 6561 7469 6f6e 5f64 6973 7061 7463  creation_dispatc
+00015870: 682e 6261 636b 656e 640a 2020 2020 2020  h.backend.      
+00015880: 2020 2320 4368 6563 6b20 7468 6174 2022    # Check that "
+00015890: 6261 636b 656e 6422 2068 6173 2061 2072  backend" has a r
+000158a0: 6567 6973 7465 7265 6420 656e 7472 7970  egistered entryp
+000158b0: 6f69 6e74 0a20 2020 2020 2020 2062 6163  oint.        bac
+000158c0: 6b65 6e64 5f65 6e74 7279 706f 696e 7420  kend_entrypoint 
+000158d0: 3d20 6461 7461 6672 616d 655f 6372 6561  = dataframe_crea
+000158e0: 7469 6f6e 5f64 6973 7061 7463 682e 6469  tion_dispatch.di
+000158f0: 7370 6174 6368 2862 6163 6b65 6e64 290a  spatch(backend).
+00015900: 2020 2020 2020 2020 2320 4361 6c6c 2060          # Call `
+00015910: 4461 7461 4672 616d 6542 6163 6b65 6e64  DataFrameBackend
+00015920: 456e 7472 7970 6f69 6e74 2e74 6f5f 6261  Entrypoint.to_ba
+00015930: 636b 656e 6460 0a20 2020 2020 2020 2072  ckend`.        r
+00015940: 6574 7572 6e20 6261 636b 656e 645f 656e  eturn backend_en
+00015950: 7472 7970 6f69 6e74 2e74 6f5f 6261 636b  trypoint.to_back
+00015960: 656e 6428 7365 6c66 2c20 2a2a 6b77 6172  end(self, **kwar
+00015970: 6773 290a 0a20 2020 2040 6465 7269 7665  gs)..    @derive
+00015980: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00015990: 290a 2020 2020 6465 6620 646f 7428 7365  ).    def dot(se
+000159a0: 6c66 2c20 6f74 6865 722c 206d 6574 613d  lf, other, meta=
+000159b0: 6e6f 5f64 6566 6175 6c74 293a 0a20 2020  no_default):.   
+000159c0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+000159d0: 7374 616e 6365 286f 7468 6572 2c20 4672  stance(other, Fr
+000159e0: 616d 6542 6173 6529 3a0a 2020 2020 2020  ameBase):.      
+000159f0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00015a00: 4572 726f 7228 2254 6865 2073 6563 6f6e  Error("The secon
+00015a10: 6420 6f70 6572 616e 6420 6d75 7374 2062  d operand must b
+00015a20: 6520 6120 6461 736b 2064 6174 6166 7261  e a dask datafra
+00015a30: 6d65 2229 0a0a 2020 2020 2020 2020 6966  me")..        if
+00015a40: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+00015a50: 722c 2044 6174 6146 7261 6d65 293a 0a20  r, DataFrame):. 
+00015a60: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
+00015a70: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00015a80: 6e73 284d 2e64 6f74 2c20 6f74 6865 722c  ns(M.dot, other,
+00015a90: 206d 6574 613d 6d65 7461 290a 2020 2020   meta=meta).    
+00015aa0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00015ab0: 2e67 726f 7570 6279 2862 793d 732e 696e  .groupby(by=s.in
+00015ac0: 6465 7829 2e61 7070 6c79 280a 2020 2020  dex).apply(.    
+00015ad0: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
+00015ae0: 6461 2078 3a20 782e 7375 6d28 736b 6970  da x: x.sum(skip
+00015af0: 6e61 3d46 616c 7365 292c 206d 6574 613d  na=False), meta=
+00015b00: 732e 5f6d 6574 615f 6e6f 6e65 6d70 7479  s._meta_nonempty
+00015b10: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00015b20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00015b30: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00015b40: 6e73 285f 646f 745f 7365 7269 6573 2c20  ns(_dot_series, 
+00015b50: 6f74 6865 722c 206d 6574 613d 6d65 7461  other, meta=meta
+00015b60: 292e 7375 6d28 736b 6970 6e61 3d46 616c  ).sum(skipna=Fal
+00015b70: 7365 290a 0a20 2020 2040 6465 7269 7665  se)..    @derive
+00015b80: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00015b90: 616d 6529 0a20 2020 2064 6566 2070 6970  ame).    def pip
+00015ba0: 6528 7365 6c66 2c20 6675 6e63 2c20 2a61  e(self, func, *a
+00015bb0: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00015bc0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00015bd0: 7461 6e63 6528 6675 6e63 2c20 7475 706c  tance(func, tupl
+00015be0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00015bf0: 6675 6e63 2c20 7461 7267 6574 203d 2066  func, target = f
+00015c00: 756e 630a 2020 2020 2020 2020 2020 2020  unc.            
+00015c10: 6966 2074 6172 6765 7420 696e 206b 7761  if target in kwa
+00015c20: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00015c30: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00015c40: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00015c50: 2020 2020 2020 2020 2020 2022 2573 2069             "%s i
+00015c60: 7320 626f 7468 2074 6865 2070 6970 6520  s both the pipe 
+00015c70: 7461 7267 6574 2061 6e64 2061 206b 6579  target and a key
+00015c80: 776f 7264 2061 7267 756d 656e 7422 2025  word argument" %
+00015c90: 2074 6172 6765 740a 2020 2020 2020 2020   target.        
+00015ca0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00015cb0: 2020 2020 2020 6b77 6172 6773 5b74 6172        kwargs[tar
+00015cc0: 6765 745d 203d 2073 656c 660a 2020 2020  get] = self.    
+00015cd0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+00015ce0: 756e 6328 2a61 7267 732c 202a 2a6b 7761  unc(*args, **kwa
+00015cf0: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
+00015d00: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00015d10: 6574 7572 6e20 6675 6e63 2873 656c 662c  eturn func(self,
+00015d20: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00015d30: 290a 0a20 2020 2064 6566 2073 616d 706c  )..    def sampl
+00015d40: 6528 7365 6c66 2c20 6e3d 4e6f 6e65 2c20  e(self, n=None, 
+00015d50: 6672 6163 3d4e 6f6e 652c 2072 6570 6c61  frac=None, repla
+00015d60: 6365 3d46 616c 7365 2c20 7261 6e64 6f6d  ce=False, random
+00015d70: 5f73 7461 7465 3d4e 6f6e 6529 3a0a 2020  _state=None):.  
+00015d80: 2020 2020 2020 2222 2252 616e 646f 6d20        """Random 
+00015d90: 7361 6d70 6c65 206f 6620 6974 656d 730a  sample of items.
+00015da0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00015db0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00015dc0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+00015dd0: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
+00015de0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+00015df0: 6265 7220 6f66 2069 7465 6d73 2074 6f20  ber of items to 
+00015e00: 7265 7475 726e 2069 7320 6e6f 7420 7375  return is not su
+00015e10: 7070 6f72 7465 6420 6279 2064 6173 6b2e  pported by dask.
+00015e20: 2055 7365 2066 7261 630a 2020 2020 2020   Use frac.      
+00015e30: 2020 2020 2020 696e 7374 6561 642e 0a20        instead.. 
+00015e40: 2020 2020 2020 2066 7261 6320 3a20 666c         frac : fl
+00015e50: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
+00015e60: 2020 2020 2020 2020 2020 4170 7072 6f78            Approx
+00015e70: 696d 6174 6520 6672 6163 7469 6f6e 206f  imate fraction o
+00015e80: 6620 6974 656d 7320 746f 2072 6574 7572  f items to retur
+00015e90: 6e2e 2054 6869 7320 7361 6d70 6c69 6e67  n. This sampling
+00015ea0: 2066 7261 6374 696f 6e20 6973 0a20 2020   fraction is.   
+00015eb0: 2020 2020 2020 2020 2061 7070 6c69 6564           applied
+00015ec0: 2074 6f20 616c 6c20 7061 7274 6974 696f   to all partitio
+00015ed0: 6e73 2065 7175 616c 6c79 2e20 4e6f 7465  ns equally. Note
+00015ee0: 2074 6861 7420 7468 6973 2069 7320 616e   that this is an
+00015ef0: 0a20 2020 2020 2020 2020 2020 202a 2a61  .            **a
+00015f00: 7070 726f 7869 6d61 7465 2066 7261 6374  pproximate fract
+00015f10: 696f 6e2a 2a2e 2059 6f75 2073 686f 756c  ion**. You shoul
+00015f20: 6420 6e6f 7420 6578 7065 6374 2065 7861  d not expect exa
+00015f30: 6374 6c79 2060 606c 656e 2864 6629 202a  ctly ``len(df) *
+00015f40: 2066 7261 6360 600a 2020 2020 2020 2020   frac``.        
+00015f50: 2020 2020 6974 656d 7320 746f 2062 6520      items to be 
+00015f60: 7265 7475 726e 6564 2c20 6173 2074 6865  returned, as the
+00015f70: 2065 7861 6374 206e 756d 6265 7220 6f66   exact number of
+00015f80: 2065 6c65 6d65 6e74 7320 7365 6c65 6374   elements select
+00015f90: 6564 2077 696c 6c0a 2020 2020 2020 2020  ed will.        
+00015fa0: 2020 2020 6465 7065 6e64 206f 6e20 686f      depend on ho
+00015fb0: 7720 796f 7572 2064 6174 6120 6973 2070  w your data is p
+00015fc0: 6172 7469 7469 6f6e 6564 2028 6275 7420  artitioned (but 
+00015fd0: 7368 6f75 6c64 2062 6520 7072 6574 7479  should be pretty
+00015fe0: 2063 6c6f 7365 0a20 2020 2020 2020 2020   close.         
+00015ff0: 2020 2069 6e20 7072 6163 7469 6365 292e     in practice).
+00016000: 0a20 2020 2020 2020 2072 6570 6c61 6365  .        replace
+00016010: 203a 2062 6f6f 6c65 616e 2c20 6f70 7469   : boolean, opti
+00016020: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00016030: 2053 616d 706c 6520 7769 7468 206f 7220   Sample with or 
+00016040: 7769 7468 6f75 7420 7265 706c 6163 656d  without replacem
+00016050: 656e 742e 2044 6566 6175 6c74 203d 2046  ent. Default = F
+00016060: 616c 7365 2e0a 2020 2020 2020 2020 7261  alse..        ra
+00016070: 6e64 6f6d 5f73 7461 7465 203a 2069 6e74  ndom_state : int
+00016080: 206f 7220 6060 6e70 2e72 616e 646f 6d2e   or ``np.random.
+00016090: 5261 6e64 6f6d 5374 6174 6560 600a 2020  RandomState``.  
+000160a0: 2020 2020 2020 2020 2020 4966 2061 6e20            If an 
+000160b0: 696e 742c 2077 6520 6372 6561 7465 2061  int, we create a
+000160c0: 206e 6577 2052 616e 646f 6d53 7461 7465   new RandomState
+000160d0: 2077 6974 6820 7468 6973 2061 7320 7468   with this as th
+000160e0: 6520 7365 6564 3b0a 2020 2020 2020 2020  e seed;.        
+000160f0: 2020 2020 4f74 6865 7277 6973 6520 7765      Otherwise we
+00016100: 2064 7261 7720 6672 6f6d 2074 6865 2070   draw from the p
+00016110: 6173 7365 6420 5261 6e64 6f6d 5374 6174  assed RandomStat
+00016120: 652e 0a0a 2020 2020 2020 2020 5365 6520  e...        See 
+00016130: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00016140: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+00016150: 7461 4672 616d 652e 7261 6e64 6f6d 5f73  taFrame.random_s
+00016160: 706c 6974 0a20 2020 2020 2020 2070 616e  plit.        pan
+00016170: 6461 732e 4461 7461 4672 616d 652e 7361  das.DataFrame.sa
+00016180: 6d70 6c65 0a20 2020 2020 2020 2022 2222  mple.        """
+00016190: 0a20 2020 2020 2020 2069 6620 6e20 6973  .        if n is
+000161a0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+000161b0: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
+000161c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000161d0: 7361 6d70 6c65 2064 6f65 7320 6e6f 7420  sample does not 
+000161e0: 7375 7070 6f72 7420 7468 6520 6e75 6d62  support the numb
+000161f0: 6572 206f 6620 7361 6d70 6c65 6420 6974  er of sampled it
+00016200: 656d 7320 220a 2020 2020 2020 2020 2020  ems ".          
+00016210: 2020 2020 2020 2270 6172 616d 6574 6572        "parameter
+00016220: 2c20 276e 272e 2050 6c65 6173 6520 7573  , 'n'. Please us
+00016230: 6520 7468 6520 2766 7261 6327 2070 6172  e the 'frac' par
+00016240: 616d 6574 6572 2069 6e73 7465 6164 2e22  ameter instead."
+00016250: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00016260: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00016270: 696e 7374 616e 6365 286e 2c20 4e75 6d62  instance(n, Numb
+00016280: 6572 2920 616e 6420 3020 3c3d 206e 203c  er) and 0 <= n <
+00016290: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000162a0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000162b0: 726e 286d 7367 290a 2020 2020 2020 2020  rn(msg).        
+000162c0: 2020 2020 2020 2020 6672 6163 203d 206e          frac = n
+000162d0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000162e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000162f0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00016300: 726f 7228 6d73 6729 0a0a 2020 2020 2020  ror(msg)..      
+00016310: 2020 6966 2066 7261 6320 6973 204e 6f6e    if frac is Non
+00016320: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00016330: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00016340: 2266 7261 6320 6d75 7374 206e 6f74 2062  "frac must not b
+00016350: 6520 4e6f 6e65 2229 0a0a 2020 2020 2020  e None")..      
+00016360: 2020 6966 2072 616e 646f 6d5f 7374 6174    if random_stat
+00016370: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
+00016380: 2020 2020 2020 2072 616e 646f 6d5f 7374         random_st
+00016390: 6174 6520 3d20 6e70 2e72 616e 646f 6d2e  ate = np.random.
+000163a0: 5261 6e64 6f6d 5374 6174 6528 290a 0a20  RandomState().. 
+000163b0: 2020 2020 2020 2073 7461 7465 5f64 6174         state_dat
+000163c0: 6120 3d20 7261 6e64 6f6d 5f73 7461 7465  a = random_state
+000163d0: 5f64 6174 6128 7365 6c66 2e6e 7061 7274  _data(self.npart
+000163e0: 6974 696f 6e73 2c20 7261 6e64 6f6d 5f73  itions, random_s
+000163f0: 7461 7465 290a 2020 2020 2020 2020 7265  tate).        re
+00016400: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00016410: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00016420: 2065 7870 722e 5361 6d70 6c65 2873 656c   expr.Sample(sel
+00016430: 662c 2073 7461 7465 5f64 6174 613d 7374  f, state_data=st
+00016440: 6174 655f 6461 7461 2c20 6672 6163 3d66  ate_data, frac=f
+00016450: 7261 632c 2072 6570 6c61 6365 3d72 6570  rac, replace=rep
+00016460: 6c61 6365 290a 2020 2020 2020 2020 290a  lace).        ).
+00016470: 0a20 2020 2064 6566 205f 7265 7072 5f64  .    def _repr_d
+00016480: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
+00016490: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+000164a0: 656d 656e 7465 6445 7272 6f72 0a0a 2020  ementedError..  
+000164b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000164c0: 6465 6620 5f72 6570 725f 6469 7669 7369  def _repr_divisi
+000164d0: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
+000164e0: 2020 206e 616d 6520 3d20 6622 6e70 6172     name = f"npar
+000164f0: 7469 7469 6f6e 733d 7b73 656c 662e 6e70  titions={self.np
+00016500: 6172 7469 7469 6f6e 737d 220a 2020 2020  artitions}".    
+00016510: 2020 2020 6966 2073 656c 662e 6b6e 6f77      if self.know
+00016520: 6e5f 6469 7669 7369 6f6e 733a 0a20 2020  n_divisions:.   
+00016530: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+00016540: 6e73 203d 2070 642e 496e 6465 7828 7365  ns = pd.Index(se
+00016550: 6c66 2e64 6976 6973 696f 6e73 2c20 6e61  lf.divisions, na
+00016560: 6d65 3d6e 616d 6529 0a20 2020 2020 2020  me=name).       
+00016570: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00016580: 2020 2023 2061 766f 6964 2074 6f20 6265     # avoid to be
+00016590: 2063 6f6e 7665 7274 6564 2074 6f20 4e61   converted to Na
+000165a0: 4e0a 2020 2020 2020 2020 2020 2020 6469  N.            di
+000165b0: 7669 7369 6f6e 7320 3d20 7064 2e49 6e64  visions = pd.Ind
+000165c0: 6578 285b 2222 5d20 2a20 2873 656c 662e  ex([""] * (self.
+000165d0: 6e70 6172 7469 7469 6f6e 7320 2b20 3129  npartitions + 1)
+000165e0: 2c20 6e61 6d65 3d6e 616d 6529 0a20 2020  , name=name).   
+000165f0: 2020 2020 2072 6574 7572 6e20 6469 7669       return divi
+00016600: 7369 6f6e 730a 0a0a 6465 6620 5f64 6f74  sions...def _dot
+00016610: 5f73 6572 6965 7328 2a61 7267 732c 202a  _series(*args, *
+00016620: 2a6b 7761 7267 7329 3a0a 2020 2020 2320  *kwargs):.    # 
+00016630: 2e73 756d 2829 2069 7320 696e 766f 6b65  .sum() is invoke
+00016640: 6420 6f6e 2065 6163 6820 7061 7274 6974  d on each partit
+00016650: 696f 6e20 6265 666f 7265 2062 6569 6e67  ion before being
+00016660: 2061 7070 6c69 6564 2074 6f20 616c 6c0a   applied to all.
+00016670: 2020 2020 2320 7061 7274 6974 696f 6e73      # partitions
+00016680: 2e20 5468 6520 7265 7475 726e 2074 7970  . The return typ
+00016690: 6520 6973 2065 7870 6563 7465 6420 746f  e is expected to
+000166a0: 2062 6520 6120 7365 7269 6573 2c20 6e6f   be a series, no
+000166b0: 7420 6120 6e75 6d70 7920 6f62 6a65 6374  t a numpy object
+000166c0: 0a20 2020 2072 6574 7572 6e20 6d65 7461  .    return meta
+000166d0: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
+000166e0: 746f 7228 6172 6773 5b30 5d29 284d 2e64  tor(args[0])(M.d
+000166f0: 6f74 282a 6172 6773 2c20 2a2a 6b77 6172  ot(*args, **kwar
+00016700: 6773 2929 0a0a 0a23 2041 6464 206f 7065  gs))...# Add ope
+00016710: 7261 746f 7220 6174 7472 6962 7574 6573  rator attributes
+00016720: 0a66 6f72 206f 7020 696e 205b 0a20 2020  .for op in [.   
+00016730: 2022 5f5f 6164 645f 5f22 2c0a 2020 2020   "__add__",.    
+00016740: 225f 5f72 6164 645f 5f22 2c0a 2020 2020  "__radd__",.    
+00016750: 225f 5f73 7562 5f5f 222c 0a20 2020 2022  "__sub__",.    "
+00016760: 5f5f 7273 7562 5f5f 222c 0a20 2020 2022  __rsub__",.    "
+00016770: 5f5f 6d75 6c5f 5f22 2c0a 2020 2020 225f  __mul__",.    "_
+00016780: 5f72 6d75 6c5f 5f22 2c0a 2020 2020 225f  _rmul__",.    "_
+00016790: 5f6d 6f64 5f5f 222c 0a20 2020 2022 5f5f  _mod__",.    "__
+000167a0: 726d 6f64 5f5f 222c 0a20 2020 2022 5f5f  rmod__",.    "__
+000167b0: 666c 6f6f 7264 6976 5f5f 222c 0a20 2020  floordiv__",.   
+000167c0: 2022 5f5f 7266 6c6f 6f72 6469 765f 5f22   "__rfloordiv__"
+000167d0: 2c0a 2020 2020 225f 5f74 7275 6564 6976  ,.    "__truediv
+000167e0: 5f5f 222c 0a20 2020 2022 5f5f 7274 7275  __",.    "__rtru
+000167f0: 6564 6976 5f5f 222c 0a20 2020 2022 5f5f  ediv__",.    "__
+00016800: 706f 775f 5f22 2c0a 2020 2020 225f 5f72  pow__",.    "__r
+00016810: 706f 775f 5f22 2c0a 2020 2020 225f 5f6c  pow__",.    "__l
+00016820: 745f 5f22 2c0a 2020 2020 225f 5f72 6c74  t__",.    "__rlt
+00016830: 5f5f 222c 0a20 2020 2022 5f5f 6774 5f5f  __",.    "__gt__
+00016840: 222c 0a20 2020 2022 5f5f 7267 745f 5f22  ",.    "__rgt__"
+00016850: 2c0a 2020 2020 225f 5f6c 655f 5f22 2c0a  ,.    "__le__",.
+00016860: 2020 2020 225f 5f72 6c65 5f5f 222c 0a20      "__rle__",. 
+00016870: 2020 2022 5f5f 6765 5f5f 222c 0a20 2020     "__ge__",.   
+00016880: 2022 5f5f 7267 655f 5f22 2c0a 2020 2020   "__rge__",.    
+00016890: 225f 5f65 715f 5f22 2c0a 2020 2020 225f  "__eq__",.    "_
+000168a0: 5f6e 655f 5f22 2c0a 2020 2020 225f 5f61  _ne__",.    "__a
+000168b0: 6e64 5f5f 222c 0a20 2020 2022 5f5f 7261  nd__",.    "__ra
+000168c0: 6e64 5f5f 222c 0a20 2020 2022 5f5f 6f72  nd__",.    "__or
+000168d0: 5f5f 222c 0a20 2020 2022 5f5f 726f 725f  __",.    "__ror_
+000168e0: 5f22 2c0a 2020 2020 225f 5f78 6f72 5f5f  _",.    "__xor__
+000168f0: 222c 0a20 2020 2022 5f5f 7278 6f72 5f5f  ",.    "__rxor__
+00016900: 222c 0a5d 3a0a 2020 2020 7365 7461 7474  ",.]:.    setatt
+00016910: 7228 4672 616d 6542 6173 652c 206f 702c  r(FrameBase, op,
+00016920: 2066 756e 6374 6f6f 6c73 2e70 6172 7469   functools.parti
+00016930: 616c 6d65 7468 6f64 285f 7772 6170 5f65  almethod(_wrap_e
+00016940: 7870 725f 6f70 2c20 6f70 3d6f 7029 290a  xpr_op, op=op)).
+00016950: 0a66 6f72 206f 7020 696e 205b 0a20 2020  .for op in [.   
+00016960: 2022 5f5f 696e 7665 7274 5f5f 222c 0a20   "__invert__",. 
+00016970: 2020 2022 5f5f 6e65 675f 5f22 2c0a 2020     "__neg__",.  
+00016980: 2020 225f 5f70 6f73 5f5f 222c 0a5d 3a0a    "__pos__",.]:.
+00016990: 2020 2020 7365 7461 7474 7228 4672 616d      setattr(Fram
+000169a0: 6542 6173 652c 206f 702c 2066 756e 6374  eBase, op, funct
+000169b0: 6f6f 6c73 2e70 6172 7469 616c 6d65 7468  ools.partialmeth
+000169c0: 6f64 285f 7772 6170 5f75 6e61 7279 5f65  od(_wrap_unary_e
+000169d0: 7870 725f 6f70 2c20 6f70 3d6f 7029 290a  xpr_op, op=op)).
+000169e0: 0a0a 636c 6173 7320 4461 7461 4672 616d  ..class DataFram
+000169f0: 6528 4672 616d 6542 6173 6529 3a0a 2020  e(FrameBase):.  
+00016a00: 2020 2222 2244 6174 6146 7261 6d65 2d6c    """DataFrame-l
+00016a10: 696b 6520 4578 7072 2043 6f6c 6c65 6374  ike Expr Collect
+00016a20: 696f 6e2e 0a0a 2020 2020 5468 6520 636f  ion...    The co
+00016a30: 6e73 7472 7563 746f 7220 7461 6b65 7320  nstructor takes 
+00016a40: 7468 6520 6578 7072 6573 7369 6f6e 2074  the expression t
+00016a50: 6861 7420 7265 7072 6573 656e 7473 2074  hat represents t
+00016a60: 6865 2071 7565 7279 2061 7320 696e 7075  he query as inpu
+00016a70: 742e 2054 6865 2063 6c61 7373 0a20 2020  t. The class.   
+00016a80: 2069 7320 6e6f 7420 6d65 616e 7420 746f   is not meant to
+00016a90: 2062 6520 696e 7374 616e 7469 6174 6564   be instantiated
+00016aa0: 2064 6972 6563 746c 792e 2049 6e73 7465   directly. Inste
+00016ab0: 6164 2c20 7573 6520 6f6e 6520 6f66 2074  ad, use one of t
+00016ac0: 6865 2049 4f20 636f 6e6e 6563 746f 7273  he IO connectors
+00016ad0: 2066 726f 6d0a 2020 2020 4461 736b 2e0a   from.    Dask..
+00016ae0: 2020 2020 2222 220a 0a20 2020 205f 6163      """..    _ac
+00016af0: 6365 7373 6f72 733a 2043 6c61 7373 5661  cessors: ClassVa
+00016b00: 725b 7365 745b 7374 725d 5d20 3d20 7365  r[set[str]] = se
+00016b10: 7428 290a 2020 2020 5f70 6172 7469 7469  t().    _partiti
+00016b20: 6f6e 5f74 7970 6520 3d20 7064 2e44 6174  on_type = pd.Dat
+00016b30: 6146 7261 6d65 0a0a 2020 2020 4070 726f  aFrame..    @pro
+00016b40: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
+00016b50: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
+00016b60: 2020 2072 6574 7572 6e20 7365 6c66 2e73     return self.s
+00016b70: 697a 6520 2f2f 206d 6178 286c 656e 2873  ize // max(len(s
+00016b80: 656c 662e 636f 6c75 6d6e 7329 2c20 3129  elf.columns), 1)
+00016b90: 2c20 6c65 6e28 7365 6c66 2e63 6f6c 756d  , len(self.colum
+00016ba0: 6e73 290a 0a20 2020 2040 7072 6f70 6572  ns)..    @proper
+00016bb0: 7479 0a20 2020 2064 6566 206e 6469 6d28  ty.    def ndim(
+00016bc0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00016bd0: 2222 5265 7475 726e 2064 696d 656e 7369  ""Return dimensi
+00016be0: 6f6e 616c 6974 7922 2222 0a20 2020 2020  onality""".     
+00016bf0: 2020 2072 6574 7572 6e20 320a 0a20 2020     return 2..   
+00016c00: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00016c10: 6566 2065 6d70 7479 2873 656c 6629 3a0a  ef empty(self):.
+00016c20: 2020 2020 2020 2020 2320 5f5f 6765 7461          # __geta
+00016c30: 7474 725f 5f20 7769 6c6c 2062 6520 6361  ttr__ will be ca
+00016c40: 6c6c 6564 2061 6674 6572 2077 6520 7261  lled after we ra
+00016c50: 6973 6520 7468 6973 2c20 736f 2077 6527  ise this, so we'
+00016c60: 6c6c 2072 6169 7365 2069 7420 6167 6169  ll raise it agai
+00016c70: 6e20 6672 6f6d 2074 6865 7265 0a20 2020  n from there.   
+00016c80: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
+00016c90: 6275 7465 4e6f 7449 6d70 6c65 6d65 6e74  buteNotImplement
+00016ca0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+00016cb0: 2020 2020 2022 4368 6563 6b69 6e67 2077       "Checking w
+00016cc0: 6865 7468 6572 2061 2044 6173 6b20 4461  hether a Dask Da
+00016cd0: 7461 4672 616d 6520 6861 7320 616e 7920  taFrame has any 
+00016ce0: 726f 7773 206d 6179 2062 6520 6578 7065  rows may be expe
+00016cf0: 6e73 6976 652e 2022 0a20 2020 2020 2020  nsive. ".       
+00016d00: 2020 2020 2022 486f 7765 7665 722c 2063       "However, c
+00016d10: 6865 636b 696e 6720 7468 6520 6e75 6d62  hecking the numb
+00016d20: 6572 206f 6620 636f 6c75 6d6e 7320 6973  er of columns is
+00016d30: 2066 6173 742e 2022 0a20 2020 2020 2020   fast. ".       
+00016d40: 2020 2020 2022 4465 7065 6e64 696e 6720       "Depending 
+00016d50: 6f6e 2077 6869 6368 206f 6620 7468 6573  on which of thes
+00016d60: 6520 7265 7375 6c74 7320 796f 7520 6e65  e results you ne
+00016d70: 6564 2c20 7573 6520 6569 7468 6572 2022  ed, use either "
+00016d80: 0a20 2020 2020 2020 2020 2020 2022 606c  .            "`l
+00016d90: 656e 2864 662e 696e 6465 7829 203d 3d20  en(df.index) == 
+00016da0: 3060 206f 7220 606c 656e 2864 662e 636f  0` or `len(df.co
+00016db0: 6c75 6d6e 7329 203d 3d20 3060 220a 2020  lumns) == 0`".  
+00016dc0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+00016dd0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00016de0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00016df0: 2069 7465 6d73 2873 656c 6629 3a0a 2020   items(self):.  
+00016e00: 2020 2020 2020 666f 7220 692c 206e 616d        for i, nam
+00016e10: 6520 696e 2065 6e75 6d65 7261 7465 2873  e in enumerate(s
+00016e20: 656c 662e 636f 6c75 6d6e 7329 3a0a 2020  elf.columns):.  
+00016e30: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00016e40: 286e 616d 652c 2073 656c 662e 696c 6f63  (name, self.iloc
+00016e50: 5b3a 2c20 695d 290a 0a20 2020 2040 7072  [:, i])..    @pr
+00016e60: 6f70 6572 7479 0a20 2020 2064 6566 2061  operty.    def a
+00016e70: 7865 7328 7365 6c66 293a 0a20 2020 2020  xes(self):.     
+00016e80: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
+00016e90: 696e 6465 782c 2073 656c 662e 636f 6c75  index, self.colu
+00016ea0: 6d6e 735d 0a0a 2020 2020 6465 6620 5f5f  mns]..    def __
+00016eb0: 636f 6e74 6169 6e73 5f5f 2873 656c 662c  contains__(self,
+00016ec0: 206b 6579 293a 0a20 2020 2020 2020 2072   key):.        r
+00016ed0: 6574 7572 6e20 6b65 7920 696e 2073 656c  eturn key in sel
+00016ee0: 662e 5f6d 6574 610a 0a20 2020 2064 6566  f._meta..    def
+00016ef0: 205f 5f69 7465 725f 5f28 7365 6c66 293a   __iter__(self):
+00016f00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00016f10: 6974 6572 2873 656c 662e 5f6d 6574 6129  iter(self._meta)
+00016f20: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00016f30: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00016f40: 290a 2020 2020 6465 6620 6974 6572 726f  ).    def iterro
+00016f50: 7773 2873 656c 6629 3a0a 2020 2020 2020  ws(self):.      
+00016f60: 2020 6672 616d 6520 3d20 7365 6c66 2e6f    frame = self.o
+00016f70: 7074 696d 697a 6528 290a 2020 2020 2020  ptimize().      
+00016f80: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00016f90: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
+00016fa0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00016fb0: 6466 203d 2066 7261 6d65 2e67 6574 5f70  df = frame.get_p
+00016fc0: 6172 7469 7469 6f6e 2869 292e 636f 6d70  artition(i).comp
+00016fd0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+00016fe0: 2020 7969 656c 6420 6672 6f6d 2064 662e    yield from df.
+00016ff0: 6974 6572 726f 7773 2829 0a0a 2020 2020  iterrows()..    
+00017000: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00017010: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00017020: 6465 6620 6974 6572 7475 706c 6573 2873  def itertuples(s
+00017030: 656c 662c 2069 6e64 6578 3d54 7275 652c  elf, index=True,
+00017040: 206e 616d 653d 2250 616e 6461 7322 293a   name="Pandas"):
+00017050: 0a20 2020 2020 2020 2066 7261 6d65 203d  .        frame =
+00017060: 2073 656c 662e 6f70 7469 6d69 7a65 2829   self.optimize()
+00017070: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00017080: 6e20 7261 6e67 6528 7365 6c66 2e6e 7061  n range(self.npa
+00017090: 7274 6974 696f 6e73 293a 0a20 2020 2020  rtitions):.     
+000170a0: 2020 2020 2020 2064 6620 3d20 6672 616d         df = fram
+000170b0: 652e 6765 745f 7061 7274 6974 696f 6e28  e.get_partition(
+000170c0: 6929 2e63 6f6d 7075 7465 2829 0a20 2020  i).compute().   
+000170d0: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
+000170e0: 726f 6d20 6466 2e69 7465 7274 7570 6c65  rom df.itertuple
+000170f0: 7328 696e 6465 783d 696e 6465 782c 206e  s(index=index, n
+00017100: 616d 653d 6e61 6d65 290a 0a20 2020 2040  ame=name)..    @
+00017110: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00017120: 205f 656c 656d 7769 7365 2873 656c 6629   _elemwise(self)
+00017130: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00017140: 2065 6c65 6d77 6973 650a 0a20 2020 2064   elemwise..    d
+00017150: 6566 205f 5f61 7272 6179 5f75 6675 6e63  ef __array_ufunc
+00017160: 5f5f 2873 656c 662c 206e 756d 7079 5f75  __(self, numpy_u
+00017170: 6675 6e63 2c20 6d65 7468 6f64 2c20 2a69  func, method, *i
+00017180: 6e70 7574 732c 202a 2a6b 7761 7267 7329  nputs, **kwargs)
+00017190: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
+000171a0: 6b77 6172 6773 2e67 6574 2822 6f75 7422  kwargs.get("out"
+000171b0: 2c20 2829 290a 2020 2020 2020 2020 666f  , ()).        fo
+000171c0: 7220 7820 696e 2069 6e70 7574 7320 2b20  r x in inputs + 
+000171d0: 6f75 743a 0a20 2020 2020 2020 2020 2020  out:.           
+000171e0: 2023 2075 6675 6e63 7320 776f 726b 2077   # ufuncs work w
+000171f0: 6974 6820 302d 6469 6d65 6e73 696f 6e61  ith 0-dimensiona
+00017200: 6c20 4e75 6d50 7920 6e64 6172 7261 7973  l NumPy ndarrays
+00017210: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+00017220: 6f20 7765 2064 6f6e 2774 2077 616e 7420  o we don't want 
+00017230: 746f 2072 6169 7365 204e 6f74 496d 706c  to raise NotImpl
+00017240: 656d 656e 7465 640a 2020 2020 2020 2020  emented.        
+00017250: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00017260: 6528 782c 206e 702e 6e64 6172 7261 7929  e(x, np.ndarray)
+00017270: 2061 6e64 2078 2e73 6861 7065 203d 3d20   and x.shape == 
+00017280: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00017290: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+000172a0: 2020 2020 2020 2020 2065 6c69 6620 6e6f           elif no
+000172b0: 7420 6973 696e 7374 616e 6365 280a 2020  t isinstance(.  
+000172c0: 2020 2020 2020 2020 2020 2020 2020 782c                x,
+000172d0: 2028 4e75 6d62 6572 2c20 5363 616c 6172   (Number, Scalar
+000172e0: 2c20 4672 616d 6542 6173 652c 2041 7272  , FrameBase, Arr
+000172f0: 6179 2c20 7064 2e44 6174 6146 7261 6d65  ay, pd.DataFrame
+00017300: 2c20 7064 2e53 6572 6965 732c 2070 642e  , pd.Series, pd.
+00017310: 496e 6465 7829 0a20 2020 2020 2020 2020  Index).         
+00017320: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00017330: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
+00017340: 496d 706c 656d 656e 7465 640a 0a20 2020  Implemented..   
+00017350: 2020 2020 2069 6620 6d65 7468 6f64 203d       if method =
+00017360: 3d20 225f 5f63 616c 6c5f 5f22 3a0a 2020  = "__call__":.  
+00017370: 2020 2020 2020 2020 2020 6966 206e 756d            if num
+00017380: 7079 5f75 6675 6e63 2e73 6967 6e61 7475  py_ufunc.signatu
+00017390: 7265 2069 7320 6e6f 7420 4e6f 6e65 3a0a  re is not None:.
+000173a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000173b0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
+000173c0: 656e 7465 640a 2020 2020 2020 2020 2020  ented.          
+000173d0: 2020 6966 206e 756d 7079 5f75 6675 6e63    if numpy_ufunc
+000173e0: 2e6e 6f75 7420 3e20 313a 0a20 2020 2020  .nout > 1:.     
+000173f0: 2020 2020 2020 2020 2020 2023 2075 6675             # ufu
+00017400: 6e63 7320 7769 7468 206d 756c 7469 706c  ncs with multipl
+00017410: 6520 6f75 7470 7574 2076 616c 7565 730a  e output values.
+00017420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017430: 2320 6172 6520 6e6f 7420 7965 7420 7375  # are not yet su
+00017440: 7070 6f72 7465 6420 666f 7220 6672 616d  pported for fram
+00017450: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00017460: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
+00017470: 6c65 6d65 6e74 6564 0a20 2020 2020 2020  lemented.       
+00017480: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00017490: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000174a0: 6e20 656c 656d 7769 7365 286e 756d 7079  n elemwise(numpy
+000174b0: 5f75 6675 6e63 2c20 2a69 6e70 7574 732c  _ufunc, *inputs,
+000174c0: 202a 2a6b 7761 7267 7329 0a20 2020 2020   **kwargs).     
+000174d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000174e0: 2020 2020 2023 2075 6675 6e63 206d 6574       # ufunc met
+000174f0: 686f 6473 2061 7265 206e 6f74 2079 6574  hods are not yet
+00017500: 2073 7570 706f 7274 6564 2066 6f72 2066   supported for f
+00017510: 7261 6d65 730a 2020 2020 2020 2020 2020  rames.          
+00017520: 2020 7265 7475 726e 204e 6f74 496d 706c    return NotImpl
+00017530: 656d 656e 7465 640a 0a20 2020 2064 6566  emented..    def
+00017540: 205f 5f61 7272 6179 5f77 7261 705f 5f28   __array_wrap__(
+00017550: 7365 6c66 2c20 6172 7261 792c 2063 6f6e  self, array, con
+00017560: 7465 7874 3d4e 6f6e 6529 3a0a 2020 2020  text=None):.    
+00017570: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00017580: 6528 636f 6e74 6578 742c 2074 7570 6c65  e(context, tuple
+00017590: 2920 616e 6420 6c65 6e28 636f 6e74 6578  ) and len(contex
+000175a0: 7429 203e 2030 3a0a 2020 2020 2020 2020  t) > 0:.        
+000175b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000175c0: 6528 636f 6e74 6578 745b 315d 5b30 5d2c  e(context[1][0],
+000175d0: 206e 702e 6e64 6172 7261 7929 2061 6e64   np.ndarray) and
+000175e0: 2063 6f6e 7465 7874 5b31 5d5b 305d 2e73   context[1][0].s
+000175f0: 6861 7065 203d 3d20 2829 3a0a 2020 2020  hape == ():.    
+00017600: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00017610: 7820 3d20 4e6f 6e65 0a20 2020 2020 2020  x = None.       
+00017620: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00017630: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00017640: 203d 2063 6f6e 7465 7874 5b31 5d5b 305d   = context[1][0]
+00017650: 2e69 6e64 6578 0a20 2020 2020 2020 2065  .index.        e
+00017660: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00017670: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00017680: 2020 2020 2020 696d 706f 7274 2069 6e73        import ins
+00017690: 7065 6374 0a0a 2020 2020 2020 2020 2020  pect..          
+000176a0: 2020 2020 2020 6d65 7468 6f64 5f6e 616d        method_nam
+000176b0: 6520 3d20 6622 607b 696e 7370 6563 742e  e = f"`{inspect.
+000176c0: 7374 6163 6b28 295b 335d 5b33 5d7d 6022  stack()[3][3]}`"
+000176d0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+000176e0: 6570 7420 496e 6465 7845 7272 6f72 3a0a  ept IndexError:.
+000176f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017700: 6d65 7468 6f64 5f6e 616d 6520 3d20 2254  method_name = "T
+00017710: 6869 7320 6d65 7468 6f64 220a 0a20 2020  his method"..   
+00017720: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00017730: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00017740: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00017750: 2020 2020 6622 7b6d 6574 686f 645f 6e61      f"{method_na
+00017760: 6d65 7d20 6973 206e 6f74 2069 6d70 6c65  me} is not imple
+00017770: 6d65 6e74 6564 2066 6f72 2060 6461 736b  mented for `dask
+00017780: 2e64 6174 6166 7261 6d65 2e44 6174 6146  .dataframe.DataF
+00017790: 7261 6d65 602e 220a 2020 2020 2020 2020  rame`.".        
+000177a0: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+000177b0: 6574 7572 6e20 6d65 7461 5f66 7261 6d65  eturn meta_frame
+000177c0: 5f63 6f6e 7374 7275 6374 6f72 2873 656c  _constructor(sel
+000177d0: 6629 2861 7272 6179 2c20 696e 6465 783d  f)(array, index=
+000177e0: 696e 6465 782c 2063 6f6c 756d 6e73 3d73  index, columns=s
+000177f0: 656c 662e 636f 6c75 6d6e 7329 0a0a 2020  elf.columns)..  
+00017800: 2020 6465 6620 5f69 7079 7468 6f6e 5f6b    def _ipython_k
+00017810: 6579 5f63 6f6d 706c 6574 696f 6e73 5f28  ey_completions_(
+00017820: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00017830: 6574 7572 6e20 6d65 7468 6f64 732e 746f  eturn methods.to
+00017840: 6c69 7374 2873 656c 662e 636f 6c75 6d6e  list(self.column
+00017850: 7329 0a0a 2020 2020 6465 6620 5f72 6570  s)..    def _rep
+00017860: 725f 6874 6d6c 5f28 7365 6c66 293a 0a20  r_html_(self):. 
+00017870: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00017880: 6c66 2e74 6f5f 6874 6d6c 2829 0a0a 2020  lf.to_html()..  
+00017890: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000178a0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+000178b0: 2020 6465 6620 6173 7369 676e 2873 656c    def assign(sel
+000178c0: 662c 202a 2a70 6169 7273 293a 0a20 2020  f, **pairs):.   
+000178d0: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
+000178e0: 6c66 0a20 2020 2020 2020 2061 7267 7320  lf.        args 
+000178f0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+00017900: 206b 2c20 7620 696e 2070 6169 7273 2e69   k, v in pairs.i
+00017910: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+00017920: 2020 2020 7620 3d20 5f6d 6179 6265 5f66      v = _maybe_f
+00017930: 726f 6d5f 7061 6e64 6173 285b 765d 295b  rom_pandas([v])[
+00017940: 305d 0a20 2020 2020 2020 2020 2020 2069  0].            i
+00017950: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00017960: 286b 2c20 7374 7229 3a0a 2020 2020 2020  (k, str):.      
+00017970: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00017980: 5479 7065 4572 726f 7228 6622 436f 6c75  TypeError(f"Colu
+00017990: 6d6e 206e 616d 6520 6361 6e6e 6f74 2062  mn name cannot b
+000179a0: 6520 7479 7065 207b 7479 7065 286b 297d  e type {type(k)}
+000179b0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+000179c0: 6966 2063 616c 6c61 626c 6528 7629 3a0a  if callable(v):.
+000179d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179e0: 7265 7375 6c74 203d 206e 6577 5f63 6f6c  result = new_col
+000179f0: 6c65 6374 696f 6e28 6578 7072 2e41 7373  lection(expr.Ass
+00017a00: 6967 6e28 7265 7375 6c74 2c20 2a61 7267  ign(result, *arg
+00017a10: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+00017a20: 2020 2020 6172 6773 203d 205b 5d0a 2020      args = [].  
+00017a30: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00017a40: 7375 6c74 203d 206e 6577 5f63 6f6c 6c65  sult = new_colle
+00017a50: 6374 696f 6e28 6578 7072 2e41 7373 6967  ction(expr.Assig
+00017a60: 6e28 7265 7375 6c74 2c20 6b2c 2076 2872  n(result, k, v(r
+00017a70: 6573 756c 7429 2929 0a20 2020 2020 2020  esult))).       
+00017a80: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00017a90: 650a 0a20 2020 2020 2020 2020 2020 2065  e..            e
+00017aa0: 6c69 6620 6973 696e 7374 616e 6365 2876  lif isinstance(v
+00017ab0: 2c20 2853 6361 6c61 722c 2053 6572 6965  , (Scalar, Serie
+00017ac0: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
+00017ad0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00017ae0: 6365 2876 2c20 5365 7269 6573 293a 0a20  ce(v, Series):. 
+00017af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b00: 2020 2069 6620 6e6f 7420 6578 7072 2e61     if not expr.a
+00017b10: 7265 5f63 6f5f 616c 6967 6e65 6428 7265  re_co_aligned(re
+00017b20: 7375 6c74 2e65 7870 722c 2076 2e65 7870  sult.expr, v.exp
+00017b30: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00017b40: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00017b50: 656e 2861 7267 7329 203e 2030 3a0a 2020  en(args) > 0:.  
+00017b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b70: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00017b80: 203d 2065 7870 722e 4173 7369 676e 2872   = expr.Assign(r
+00017b90: 6573 756c 742c 202a 6172 6773 290a 2020  esult, *args).  
+00017ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017bb0: 2020 2020 2020 2020 2020 6172 6773 203d            args =
+00017bc0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00017bd0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00017be0: 6c74 203d 206e 6577 5f63 6f6c 6c65 6374  lt = new_collect
+00017bf0: 696f 6e28 6578 7072 2e41 7373 6967 6e41  ion(expr.AssignA
+00017c00: 6c69 676e 2872 6573 756c 742c 206b 2c20  lign(result, k, 
+00017c10: 762e 6578 7072 2929 0a20 2020 2020 2020  v.expr)).       
+00017c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c30: 2063 6f6e 7469 6e75 650a 0a20 2020 2020   continue..     
+00017c40: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
+00017c50: 6973 696e 7374 616e 6365 2876 2c20 4672  isinstance(v, Fr
+00017c60: 616d 6542 6173 6529 2061 6e64 2069 7369  ameBase) and isi
+00017c70: 6e73 7461 6e63 6528 762c 2048 6173 6861  nstance(v, Hasha
+00017c80: 626c 6529 3a0a 2020 2020 2020 2020 2020  ble):.          
+00017c90: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
+00017ca0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00017cb0: 7374 616e 6365 2876 2c20 4172 7261 7929  stance(v, Array)
+00017cc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017cd0: 2020 6966 206c 656e 2876 2e73 6861 7065    if len(v.shape
+00017ce0: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
+00017cf0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00017d00: 2056 616c 7565 4572 726f 7228 2241 7272   ValueError("Arr
+00017d10: 6179 2061 7373 6967 6e6d 656e 7420 6f6e  ay assignment on
+00017d20: 6c79 2073 7570 706f 7274 7320 312d 4420  ly supports 1-D 
+00017d30: 6172 7261 7973 2229 0a20 2020 2020 2020  arrays").       
+00017d40: 2020 2020 2020 2020 2069 6620 762e 6e70           if v.np
+00017d50: 6172 7469 7469 6f6e 7320 213d 2072 6573  artitions != res
+00017d60: 756c 742e 6e70 6172 7469 7469 6f6e 733a  ult.npartitions:
+00017d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017d80: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00017d90: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00017da0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00017db0: 4e75 6d62 6572 206f 6620 7061 7274 6974  Number of partit
+00017dc0: 696f 6e73 2064 6f20 6e6f 7420 6d61 7463  ions do not matc
+00017dd0: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
+00017de0: 2020 2020 2020 2020 2020 2020 6622 287b              f"({
+00017df0: 762e 6e70 6172 7469 7469 6f6e 737d 2021  v.npartitions} !
+00017e00: 3d20 7b72 6573 756c 742e 6e70 6172 7469  = {result.nparti
+00017e10: 7469 6f6e 737d 2922 0a20 2020 2020 2020  tions})".       
+00017e20: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00017e30: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00017e40: 203d 2066 726f 6d5f 6461 736b 5f61 7272   = from_dask_arr
+00017e50: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
+00017e60: 2020 2020 2020 2020 762c 2069 6e64 6578          v, index
+00017e70: 3d72 6573 756c 742e 696e 6465 782e 746f  =result.index.to
+00017e80: 5f6c 6567 6163 795f 6461 7461 6672 616d  _legacy_datafram
+00017e90: 6528 292c 206d 6574 613d 7265 7375 6c74  e(), meta=result
+00017ea0: 2e5f 6d65 7461 0a20 2020 2020 2020 2020  ._meta.         
+00017eb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00017ec0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00017ed0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00017ee0: 2054 7970 6545 7272 6f72 2866 2243 6f6c   TypeError(f"Col
+00017ef0: 756d 6e20 6173 7369 676e 6d65 6e74 2064  umn assignment d
+00017f00: 6f65 736e 2774 2073 7570 706f 7274 2074  oesn't support t
+00017f10: 7970 6520 7b74 7970 6528 7629 7d22 290a  ype {type(v)}").
+00017f20: 2020 2020 2020 2020 2020 2020 6172 6773              args
+00017f30: 2e65 7874 656e 6428 5b6b 2c20 765d 290a  .extend([k, v]).
+00017f40: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00017f50: 6172 6773 2920 3e20 303a 0a20 2020 2020  args) > 0:.     
+00017f60: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00017f70: 6e65 775f 636f 6c6c 6563 7469 6f6e 2865  new_collection(e
+00017f80: 7870 722e 4173 7369 676e 2872 6573 756c  xpr.Assign(resul
+00017f90: 742c 202a 6172 6773 2929 0a0a 2020 2020  t, *args))..    
+00017fa0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00017fb0: 740a 0a20 2020 2040 6465 7269 7665 645f  t..    @derived_
+00017fc0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00017fd0: 6529 0a20 2020 2064 6566 2063 6c69 7028  e).    def clip(
+00017fe0: 7365 6c66 2c20 6c6f 7765 723d 4e6f 6e65  self, lower=None
+00017ff0: 2c20 7570 7065 723d 4e6f 6e65 2c20 6178  , upper=None, ax
+00018000: 6973 3d4e 6f6e 652c 202a 2a6b 7761 7267  is=None, **kwarg
+00018010: 7329 3a0a 2020 2020 2020 2020 6178 6973  s):.        axis
+00018020: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00018030: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
+00018040: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
+00018050: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+00018060: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+00018070: 6172 7469 7469 6f6e 7328 4d2e 636c 6970  artitions(M.clip
+00018080: 2c20 6c6f 7765 722c 2075 7070 6572 2c20  , lower, upper, 
+00018090: 6178 6973 3d61 7869 7329 0a20 2020 2020  axis=axis).     
+000180a0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+000180b0: 6c6c 6563 7469 6f6e 2873 656c 662e 6578  llection(self.ex
+000180c0: 7072 2e63 6c69 7028 6c6f 7765 722c 2075  pr.clip(lower, u
+000180d0: 7070 6572 2c20 6178 6973 2929 0a0a 2020  pper, axis))..  
+000180e0: 2020 6465 6620 6d65 7267 6528 0a20 2020    def merge(.   
+000180f0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00018100: 2020 2072 6967 6874 2c0a 2020 2020 2020     right,.      
+00018110: 2020 686f 773d 2269 6e6e 6572 222c 0a20    how="inner",. 
+00018120: 2020 2020 2020 206f 6e3d 4e6f 6e65 2c0a         on=None,.
+00018130: 2020 2020 2020 2020 6c65 6674 5f6f 6e3d          left_on=
+00018140: 4e6f 6e65 2c0a 2020 2020 2020 2020 7269  None,.        ri
+00018150: 6768 745f 6f6e 3d4e 6f6e 652c 0a20 2020  ght_on=None,.   
+00018160: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
+00018170: 4661 6c73 652c 0a20 2020 2020 2020 2072  False,.        r
+00018180: 6967 6874 5f69 6e64 6578 3d46 616c 7365  ight_index=False
+00018190: 2c0a 2020 2020 2020 2020 7375 6666 6978  ,.        suffix
+000181a0: 6573 3d28 225f 7822 2c20 225f 7922 292c  es=("_x", "_y"),
+000181b0: 0a20 2020 2020 2020 2069 6e64 6963 6174  .        indicat
+000181c0: 6f72 3d46 616c 7365 2c0a 2020 2020 2020  or=False,.      
+000181d0: 2020 7368 7566 666c 655f 6d65 7468 6f64    shuffle_method
+000181e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+000181f0: 7061 7274 6974 696f 6e73 3d4e 6f6e 652c  partitions=None,
+00018200: 0a20 2020 2020 2020 2062 726f 6164 6361  .        broadca
+00018210: 7374 3d4e 6f6e 652c 0a20 2020 2029 3a0a  st=None,.    ):.
+00018220: 2020 2020 2020 2020 2222 224d 6572 6765          """Merge
+00018230: 2074 6865 2044 6174 6146 7261 6d65 2077   the DataFrame w
+00018240: 6974 6820 616e 6f74 6865 7220 4461 7461  ith another Data
+00018250: 4672 616d 650a 0a20 2020 2020 2020 2054  Frame..        T
+00018260: 6869 7320 7769 6c6c 206d 6572 6765 2074  his will merge t
+00018270: 6865 2074 776f 2064 6174 6173 6574 732c  he two datasets,
+00018280: 2065 6974 6865 7220 6f6e 2074 6865 2069   either on the i
+00018290: 6e64 6963 6573 2c20 6120 6365 7274 6169  ndices, a certai
+000182a0: 6e20 636f 6c75 6d6e 0a20 2020 2020 2020  n column.       
+000182b0: 2069 6e20 6561 6368 2064 6174 6173 6574   in each dataset
+000182c0: 206f 7220 7468 6520 696e 6465 7820 696e   or the index in
+000182d0: 206f 6e65 2064 6174 6173 6574 2061 6e64   one dataset and
+000182e0: 2074 6865 2063 6f6c 756d 6e20 696e 2061   the column in a
+000182f0: 6e6f 7468 6572 2e0a 0a20 2020 2020 2020  nother...       
+00018300: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00018310: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00018320: 2020 2020 2020 2072 6967 6874 3a20 6461         right: da
+00018330: 736b 2e64 6174 6166 7261 6d65 2e44 6174  sk.dataframe.Dat
+00018340: 6146 7261 6d65 0a20 2020 2020 2020 2068  aFrame.        h
+00018350: 6f77 203a 207b 276c 6566 7427 2c20 2772  ow : {'left', 'r
+00018360: 6967 6874 272c 2027 6f75 7465 7227 2c20  ight', 'outer', 
+00018370: 2769 6e6e 6572 272c 2027 6c65 6674 7365  'inner', 'leftse
+00018380: 6d69 277d 2c20 6465 6661 756c 743a 2027  mi'}, default: '
+00018390: 696e 6e65 7227 0a20 2020 2020 2020 2020  inner'.         
+000183a0: 2020 2048 6f77 2074 6f20 6861 6e64 6c65     How to handle
+000183b0: 2074 6865 206f 7065 7261 7469 6f6e 206f   the operation o
+000183c0: 6620 7468 6520 7477 6f20 6f62 6a65 6374  f the two object
+000183d0: 733a 0a0a 2020 2020 2020 2020 2020 2020  s:..            
+000183e0: 2d20 6c65 6674 3a20 7573 6520 6361 6c6c  - left: use call
+000183f0: 696e 6720 6672 616d 6527 7320 696e 6465  ing frame's inde
+00018400: 7820 286f 7220 636f 6c75 6d6e 2069 6620  x (or column if 
+00018410: 6f6e 2069 7320 7370 6563 6966 6965 6429  on is specified)
+00018420: 0a20 2020 2020 2020 2020 2020 202d 2072  .            - r
+00018430: 6967 6874 3a20 7573 6520 6f74 6865 7220  ight: use other 
+00018440: 6672 616d 6527 7320 696e 6465 780a 2020  frame's index.  
+00018450: 2020 2020 2020 2020 2020 2d20 6f75 7465            - oute
+00018460: 723a 2066 6f72 6d20 756e 696f 6e20 6f66  r: form union of
+00018470: 2063 616c 6c69 6e67 2066 7261 6d65 2773   calling frame's
+00018480: 2069 6e64 6578 2028 6f72 2063 6f6c 756d   index (or colum
+00018490: 6e20 6966 206f 6e20 6973 0a20 2020 2020  n if on is.     
+000184a0: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
+000184b0: 6564 2920 7769 7468 206f 7468 6572 2066  ed) with other f
+000184c0: 7261 6d65 2773 2069 6e64 6578 2c20 616e  rame's index, an
+000184d0: 6420 736f 7274 2069 740a 2020 2020 2020  d sort it.      
+000184e0: 2020 2020 2020 2020 6c65 7869 636f 6772          lexicogr
+000184f0: 6170 6869 6361 6c6c 790a 2020 2020 2020  aphically.      
+00018500: 2020 2020 2020 2d20 696e 6e65 723a 2066        - inner: f
+00018510: 6f72 6d20 696e 7465 7273 6563 7469 6f6e  orm intersection
+00018520: 206f 6620 6361 6c6c 696e 6720 6672 616d   of calling fram
+00018530: 6527 7320 696e 6465 7820 286f 7220 636f  e's index (or co
+00018540: 6c75 6d6e 2069 660a 2020 2020 2020 2020  lumn if.        
+00018550: 2020 2020 2020 6f6e 2069 7320 7370 6563        on is spec
+00018560: 6966 6965 6429 2077 6974 6820 6f74 6865  ified) with othe
+00018570: 7220 6672 616d 6527 7320 696e 6465 782c  r frame's index,
+00018580: 2070 7265 7365 7276 696e 6720 7468 6520   preserving the 
+00018590: 6f72 6465 720a 2020 2020 2020 2020 2020  order.          
+000185a0: 2020 2020 6f66 2074 6865 2063 616c 6c69      of the calli
+000185b0: 6e67 2773 206f 6e65 0a20 2020 2020 2020  ng's one.       
+000185c0: 2020 2020 202d 206c 6566 7473 656d 693a       - leftsemi:
+000185d0: 2043 686f 6f73 6520 616c 6c20 726f 7773   Choose all rows
+000185e0: 2069 6e20 6c65 6674 2077 6865 7265 2074   in left where t
+000185f0: 6865 206a 6f69 6e20 6b65 7973 2063 616e  he join keys can
+00018600: 2062 6520 666f 756e 640a 2020 2020 2020   be found.      
+00018610: 2020 2020 2020 2020 696e 2072 6967 6874          in right
+00018620: 2e20 576f 6e27 7420 6475 706c 6963 6174  . Won't duplicat
+00018630: 6520 726f 7773 2069 6620 7468 6520 6b65  e rows if the ke
+00018640: 7973 2061 7265 2064 7570 6c69 6361 7465  ys are duplicate
+00018650: 6420 696e 2072 6967 6874 2e0a 2020 2020  d in right..    
+00018660: 2020 2020 2020 2020 2020 4472 6f70 7320            Drops 
+00018670: 616c 6c20 636f 6c75 6d6e 7320 6672 6f6d  all columns from
+00018680: 2072 6967 6874 2e0a 0a20 2020 2020 2020   right...       
+00018690: 206f 6e20 3a20 6c61 6265 6c20 6f72 206c   on : label or l
+000186a0: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
+000186b0: 436f 6c75 6d6e 206f 7220 696e 6465 7820  Column or index 
+000186c0: 6c65 7665 6c20 6e61 6d65 7320 746f 206a  level names to j
+000186d0: 6f69 6e20 6f6e 2e20 5468 6573 6520 6d75  oin on. These mu
+000186e0: 7374 2062 6520 666f 756e 6420 696e 2062  st be found in b
+000186f0: 6f74 680a 2020 2020 2020 2020 2020 2020  oth.            
+00018700: 4461 7461 4672 616d 6573 2e20 4966 206f  DataFrames. If o
+00018710: 6e20 6973 204e 6f6e 6520 616e 6420 6e6f  n is None and no
+00018720: 7420 6d65 7267 696e 6720 6f6e 2069 6e64  t merging on ind
+00018730: 6578 6573 2074 6865 6e20 7468 6973 0a20  exes then this. 
+00018740: 2020 2020 2020 2020 2020 2064 6566 6175             defau
+00018750: 6c74 7320 746f 2074 6865 2069 6e74 6572  lts to the inter
+00018760: 7365 6374 696f 6e20 6f66 2074 6865 2063  section of the c
+00018770: 6f6c 756d 6e73 2069 6e20 626f 7468 2044  olumns in both D
+00018780: 6174 6146 7261 6d65 732e 0a20 2020 2020  ataFrames..     
+00018790: 2020 206c 6566 745f 6f6e 203a 206c 6162     left_on : lab
+000187a0: 656c 206f 7220 6c69 7374 2c20 6f72 2061  el or list, or a
+000187b0: 7272 6179 2d6c 696b 650a 2020 2020 2020  rray-like.      
+000187c0: 2020 2020 2020 436f 6c75 6d6e 2074 6f20        Column to 
+000187d0: 6a6f 696e 206f 6e20 696e 2074 6865 206c  join on in the l
+000187e0: 6566 7420 4461 7461 4672 616d 652e 204f  eft DataFrame. O
+000187f0: 7468 6572 2074 6861 6e20 696e 2070 616e  ther than in pan
+00018800: 6461 730a 2020 2020 2020 2020 2020 2020  das.            
+00018810: 6172 7261 7973 2061 6e64 206c 6973 7473  arrays and lists
+00018820: 2061 7265 206f 6e6c 7920 7375 7070 6f72   are only suppor
+00018830: 7420 6966 2074 6865 6972 206c 656e 6774  t if their lengt
+00018840: 6820 6973 2031 2e0a 2020 2020 2020 2020  h is 1..        
+00018850: 7269 6768 745f 6f6e 203a 206c 6162 656c  right_on : label
+00018860: 206f 7220 6c69 7374 2c20 6f72 2061 7272   or list, or arr
+00018870: 6179 2d6c 696b 650a 2020 2020 2020 2020  ay-like.        
+00018880: 2020 2020 436f 6c75 6d6e 2074 6f20 6a6f      Column to jo
+00018890: 696e 206f 6e20 696e 2074 6865 2072 6967  in on in the rig
+000188a0: 6874 2044 6174 6146 7261 6d65 2e20 4f74  ht DataFrame. Ot
+000188b0: 6865 7220 7468 616e 2069 6e20 7061 6e64  her than in pand
+000188c0: 6173 0a20 2020 2020 2020 2020 2020 2061  as.            a
+000188d0: 7272 6179 7320 616e 6420 6c69 7374 7320  rrays and lists 
+000188e0: 6172 6520 6f6e 6c79 2073 7570 706f 7274  are only support
+000188f0: 2069 6620 7468 6569 7220 6c65 6e67 7468   if their length
+00018900: 2069 7320 312e 0a20 2020 2020 2020 206c   is 1..        l
+00018910: 6566 745f 696e 6465 7820 3a20 626f 6f6c  eft_index : bool
+00018920: 6561 6e2c 2064 6566 6175 6c74 2046 616c  ean, default Fal
+00018930: 7365 0a20 2020 2020 2020 2020 2020 2055  se.            U
+00018940: 7365 2074 6865 2069 6e64 6578 2066 726f  se the index fro
+00018950: 6d20 7468 6520 6c65 6674 2044 6174 6146  m the left DataF
+00018960: 7261 6d65 2061 7320 7468 6520 6a6f 696e  rame as the join
+00018970: 206b 6579 2e0a 2020 2020 2020 2020 7269   key..        ri
+00018980: 6768 745f 696e 6465 7820 3a20 626f 6f6c  ght_index : bool
+00018990: 6561 6e2c 2064 6566 6175 6c74 2046 616c  ean, default Fal
+000189a0: 7365 0a20 2020 2020 2020 2020 2020 2055  se.            U
+000189b0: 7365 2074 6865 2069 6e64 6578 2066 726f  se the index fro
+000189c0: 6d20 7468 6520 7269 6768 7420 4461 7461  m the right Data
+000189d0: 4672 616d 6520 6173 2074 6865 206a 6f69  Frame as the joi
+000189e0: 6e20 6b65 792e 0a20 2020 2020 2020 2073  n key..        s
+000189f0: 7566 6669 7865 7320 3a20 322d 6c65 6e67  uffixes : 2-leng
+00018a00: 7468 2073 6571 7565 6e63 6520 2874 7570  th sequence (tup
+00018a10: 6c65 2c20 6c69 7374 2c20 2e2e 2e29 0a20  le, list, ...). 
+00018a20: 2020 2020 2020 2020 2020 2053 7566 6669             Suffi
+00018a30: 7820 746f 2061 7070 6c79 2074 6f20 6f76  x to apply to ov
+00018a40: 6572 6c61 7070 696e 6720 636f 6c75 6d6e  erlapping column
+00018a50: 206e 616d 6573 2069 6e20 7468 6520 6c65   names in the le
+00018a60: 6674 2061 6e64 0a20 2020 2020 2020 2020  ft and.         
+00018a70: 2020 2072 6967 6874 2073 6964 652c 2072     right side, r
+00018a80: 6573 7065 6374 6976 656c 790a 2020 2020  espectively.    
+00018a90: 2020 2020 696e 6469 6361 746f 7220 3a20      indicator : 
+00018aa0: 626f 6f6c 6561 6e20 6f72 2073 7472 696e  boolean or strin
+00018ab0: 672c 2064 6566 6175 6c74 2046 616c 7365  g, default False
+00018ac0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00018ad0: 5472 7565 2c20 6164 6473 2061 2063 6f6c  True, adds a col
+00018ae0: 756d 6e20 746f 206f 7574 7075 7420 4461  umn to output Da
+00018af0: 7461 4672 616d 6520 6361 6c6c 6564 2022  taFrame called "
+00018b00: 5f6d 6572 6765 2220 7769 7468 0a20 2020  _merge" with.   
+00018b10: 2020 2020 2020 2020 2069 6e66 6f72 6d61           informa
+00018b20: 7469 6f6e 206f 6e20 7468 6520 736f 7572  tion on the sour
+00018b30: 6365 206f 6620 6561 6368 2072 6f77 2e20  ce of each row. 
+00018b40: 4966 2073 7472 696e 672c 2063 6f6c 756d  If string, colum
+00018b50: 6e20 7769 7468 0a20 2020 2020 2020 2020  n with.         
+00018b60: 2020 2069 6e66 6f72 6d61 7469 6f6e 206f     information o
+00018b70: 6e20 736f 7572 6365 206f 6620 6561 6368  n source of each
+00018b80: 2072 6f77 2077 696c 6c20 6265 2061 6464   row will be add
+00018b90: 6564 2074 6f20 6f75 7470 7574 2044 6174  ed to output Dat
+00018ba0: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
+00018bb0: 2020 2020 616e 6420 636f 6c75 6d6e 2077      and column w
+00018bc0: 696c 6c20 6265 206e 616d 6564 2076 616c  ill be named val
+00018bd0: 7565 206f 6620 7374 7269 6e67 2e20 496e  ue of string. In
+00018be0: 666f 726d 6174 696f 6e20 636f 6c75 6d6e  formation column
+00018bf0: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+00018c00: 4361 7465 676f 7269 6361 6c2d 7479 7065  Categorical-type
+00018c10: 2061 6e64 2074 616b 6573 206f 6e20 6120   and takes on a 
+00018c20: 7661 6c75 6520 6f66 2022 6c65 6674 5f6f  value of "left_o
+00018c30: 6e6c 7922 2066 6f72 206f 6273 6572 7661  nly" for observa
+00018c40: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
+00018c50: 2020 7768 6f73 6520 6d65 7267 6520 6b65    whose merge ke
+00018c60: 7920 6f6e 6c79 2061 7070 6561 7273 2069  y only appears i
+00018c70: 6e20 606c 6566 7460 2044 6174 6146 7261  n `left` DataFra
+00018c80: 6d65 2c20 2272 6967 6874 5f6f 6e6c 7922  me, "right_only"
+00018c90: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
+00018ca0: 206f 6273 6572 7661 7469 6f6e 7320 7768   observations wh
+00018cb0: 6f73 6520 6d65 7267 6520 6b65 7920 6f6e  ose merge key on
+00018cc0: 6c79 2061 7070 6561 7273 2069 6e20 6072  ly appears in `r
+00018cd0: 6967 6874 6020 4461 7461 4672 616d 652c  ight` DataFrame,
+00018ce0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00018cf0: 2022 626f 7468 2220 6966 2074 6865 206f   "both" if the o
+00018d00: 6273 6572 7661 7469 6f6e e280 9973 206d  bservation...s m
+00018d10: 6572 6765 206b 6579 2069 7320 666f 756e  erge key is foun
+00018d20: 6420 696e 2062 6f74 682e 0a20 2020 2020  d in both..     
+00018d30: 2020 206e 7061 7274 6974 696f 6e73 3a20     npartitions: 
+00018d40: 696e 7420 6f72 204e 6f6e 652c 206f 7074  int or None, opt
+00018d50: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00018d60: 2020 5468 6520 6964 6561 6c20 6e75 6d62    The ideal numb
+00018d70: 6572 206f 6620 6f75 7470 7574 2070 6172  er of output par
+00018d80: 7469 7469 6f6e 732e 2054 6869 7320 6973  titions. This is
+00018d90: 206f 6e6c 7920 7574 696c 6973 6564 2077   only utilised w
+00018da0: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
+00018db0: 7065 7266 6f72 6d69 6e67 2061 2068 6173  performing a has
+00018dc0: 685f 6a6f 696e 2028 6d65 7267 696e 6720  h_join (merging 
+00018dd0: 6f6e 2063 6f6c 756d 6e73 206f 6e6c 7929  on columns only)
+00018de0: 2e20 4966 2060 604e 6f6e 6560 6020 7468  . If ``None`` th
+00018df0: 656e 0a20 2020 2020 2020 2020 2020 2060  en.            `
+00018e00: 606e 7061 7274 6974 696f 6e73 203d 206d  `npartitions = m
+00018e10: 6178 286c 6873 2e6e 7061 7274 6974 696f  ax(lhs.npartitio
+00018e20: 6e73 2c20 7268 732e 6e70 6172 7469 7469  ns, rhs.npartiti
+00018e30: 6f6e 7329 6060 2e0a 2020 2020 2020 2020  ons)``..        
+00018e40: 2020 2020 4465 6661 756c 7420 6973 2060      Default is `
+00018e50: 604e 6f6e 6560 602e 0a20 2020 2020 2020  `None``..       
+00018e60: 2073 6875 6666 6c65 5f6d 6574 686f 643a   shuffle_method:
+00018e70: 207b 2764 6973 6b27 2c20 2774 6173 6b73   {'disk', 'tasks
+00018e80: 272c 2027 7032 7027 7d2c 206f 7074 696f  ', 'p2p'}, optio
+00018e90: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00018ea0: 4569 7468 6572 2060 6027 6469 736b 2760  Either ``'disk'`
+00018eb0: 6020 666f 7220 7369 6e67 6c65 2d6e 6f64  ` for single-nod
+00018ec0: 6520 6f70 6572 6174 696f 6e20 6f72 2060  e operation or `
+00018ed0: 6027 7461 736b 7327 6060 2061 6e64 0a20  `'tasks'`` and. 
+00018ee0: 2020 2020 2020 2020 2020 2060 6027 7032             ``'p2
+00018ef0: 7027 6060 6020 666f 7220 6469 7374 7269  p'``` for distri
+00018f00: 6275 7465 6420 6f70 6572 6174 696f 6e2e  buted operation.
+00018f10: 2020 5769 6c6c 2062 6520 696e 6665 7272    Will be inferr
+00018f20: 6564 2062 7920 796f 7572 0a20 2020 2020  ed by your.     
+00018f30: 2020 2020 2020 2063 7572 7265 6e74 2073         current s
+00018f40: 6368 6564 756c 6572 2e0a 2020 2020 2020  cheduler..      
+00018f50: 2020 6272 6f61 6463 6173 743a 2062 6f6f    broadcast: boo
+00018f60: 6c65 616e 206f 7220 666c 6f61 742c 206f  lean or float, o
+00018f70: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00018f80: 2020 2020 5768 6574 6865 7220 746f 2075      Whether to u
+00018f90: 7365 2061 2062 726f 6164 6361 7374 2d62  se a broadcast-b
+00018fa0: 6173 6564 206a 6f69 6e20 696e 206c 6965  ased join in lie
+00018fb0: 7520 6f66 2061 2073 6875 6666 6c65 2d62  u of a shuffle-b
+00018fc0: 6173 6564 0a20 2020 2020 2020 2020 2020  ased.           
+00018fd0: 206a 6f69 6e20 666f 7220 7375 7070 6f72   join for suppor
+00018fe0: 7465 6420 6361 7365 732e 2020 4279 2064  ted cases.  By d
+00018ff0: 6566 6175 6c74 2c20 6120 7369 6d70 6c65  efault, a simple
+00019000: 2068 6575 7269 7374 6963 2077 696c 6c20   heuristic will 
+00019010: 6265 0a20 2020 2020 2020 2020 2020 2075  be.            u
+00019020: 7365 6420 746f 2073 656c 6563 7420 7468  sed to select th
+00019030: 6520 756e 6465 726c 7969 6e67 2061 6c67  e underlying alg
+00019040: 6f72 6974 686d 2e20 4966 2061 2066 6c6f  orithm. If a flo
+00019050: 6174 696e 672d 706f 696e 7420 7661 6c75  ating-point valu
+00019060: 650a 2020 2020 2020 2020 2020 2020 6973  e.            is
+00019070: 2073 7065 6369 6669 6564 2c20 7468 6174   specified, that
+00019080: 206e 756d 6265 7220 7769 6c6c 2062 6520   number will be 
+00019090: 7573 6564 2061 7320 7468 6520 6060 6272  used as the ``br
+000190a0: 6f61 6463 6173 745f 6269 6173 6060 0a20  oadcast_bias``. 
+000190b0: 2020 2020 2020 2020 2020 2077 6974 6869             withi
+000190c0: 6e20 7468 6520 7369 6d70 6c65 2068 6575  n the simple heu
+000190d0: 7269 7374 6963 2028 6120 6c61 7267 6520  ristic (a large 
+000190e0: 6e75 6d62 6572 206d 616b 6573 2044 6173  number makes Das
+000190f0: 6b20 6d6f 7265 206c 696b 656c 790a 2020  k more likely.  
+00019100: 2020 2020 2020 2020 2020 746f 2063 686f            to cho
+00019110: 6f73 6520 7468 6520 6060 6272 6f61 6361  ose the ``broaca
+00019120: 7374 5f6a 6f69 6e60 6020 636f 6465 2070  st_join`` code p
+00019130: 6174 6829 2e20 5365 6520 6060 6272 6f61  ath). See ``broa
+00019140: 6463 6173 745f 6a6f 696e 6060 0a20 2020  dcast_join``.   
+00019150: 2020 2020 2020 2020 2066 6f72 206d 6f72           for mor
+00019160: 6520 696e 666f 726d 6174 696f 6e2e 0a0a  e information...
+00019170: 2020 2020 2020 2020 4e6f 7465 730a 2020          Notes.  
+00019180: 2020 2020 2020 2d2d 2d2d 2d0a 0a20 2020        -----..   
+00019190: 2020 2020 2054 6865 7265 2061 7265 2074       There are t
+000191a0: 6872 6565 2077 6179 7320 746f 206a 6f69  hree ways to joi
+000191b0: 6e20 6461 7461 6672 616d 6573 3a0a 0a20  n dataframes:.. 
+000191c0: 2020 2020 2020 2031 2e20 4a6f 696e 696e         1. Joinin
+000191d0: 6720 6f6e 2069 6e64 6963 6573 2e20 496e  g on indices. In
+000191e0: 2074 6869 7320 6361 7365 2074 6865 2064   this case the d
+000191f0: 6976 6973 696f 6e73 2061 7265 0a20 2020  ivisions are.   
+00019200: 2020 2020 2020 2020 616c 6967 6e65 6420          aligned 
+00019210: 7573 696e 6720 7468 6520 6675 6e63 7469  using the functi
+00019220: 6f6e 2060 6064 6173 6b2e 6461 7461 6672  on ``dask.datafr
+00019230: 616d 652e 6d75 6c74 692e 616c 6967 6e5f  ame.multi.align_
+00019240: 7061 7274 6974 696f 6e73 6060 2e0a 2020  partitions``..  
+00019250: 2020 2020 2020 2020 2041 6674 6572 7761           Afterwa
+00019260: 7264 732c 2065 6163 6820 7061 7274 6974  rds, each partit
+00019270: 696f 6e20 6973 206d 6572 6765 6420 7769  ion is merged wi
+00019280: 7468 2074 6865 2070 616e 6461 7320 6d65  th the pandas me
+00019290: 7267 6520 6675 6e63 7469 6f6e 2e0a 0a20  rge function... 
+000192a0: 2020 2020 2020 2032 2e20 4a6f 696e 696e         2. Joinin
+000192b0: 6720 6f6e 6520 6f6e 2069 6e64 6578 2061  g one on index a
+000192c0: 6e64 206f 6e65 206f 6e20 636f 6c75 6d6e  nd one on column
+000192d0: 2e20 496e 2074 6869 7320 6361 7365 2074  . In this case t
+000192e0: 6865 2064 6976 6973 696f 6e73 206f 660a  he divisions of.
+000192f0: 2020 2020 2020 2020 2020 2064 6174 6166             dataf
+00019300: 7261 6d65 206d 6572 6765 6420 6279 2069  rame merged by i
+00019310: 6e64 6578 2028 3a6d 6174 683a 6064 5f69  ndex (:math:`d_i
+00019320: 6029 2061 7265 2075 7365 6420 746f 2064  `) are used to d
+00019330: 6976 6964 6520 7468 6520 636f 6c75 6d6e  ivide the column
+00019340: 0a20 2020 2020 2020 2020 2020 6d65 7267  .           merg
+00019350: 6564 2064 6174 6166 7261 6d65 2028 3a6d  ed dataframe (:m
+00019360: 6174 683a 6064 5f63 6029 206f 6e65 2075  ath:`d_c`) one u
+00019370: 7369 6e67 0a20 2020 2020 2020 2020 2020  sing.           
+00019380: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
+00019390: 2e6d 756c 7469 2e72 6561 7272 616e 6765  .multi.rearrange
+000193a0: 5f62 795f 6469 7669 7369 6f6e 7360 602e  _by_divisions``.
+000193b0: 2049 6e20 7468 6973 2063 6173 6520 7468   In this case th
+000193c0: 650a 2020 2020 2020 2020 2020 206d 6572  e.           mer
+000193d0: 6765 6420 6461 7461 6672 616d 6520 283a  ged dataframe (:
+000193e0: 6d61 7468 3a60 645f 6d60 2920 6861 7320  math:`d_m`) has 
+000193f0: 7468 6520 6578 6163 7420 7361 6d65 2064  the exact same d
+00019400: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
+00019410: 2020 2020 6173 2028 3a6d 6174 683a 6064      as (:math:`d
+00019420: 5f69 6029 2e20 5468 6973 2063 616e 206c  _i`). This can l
+00019430: 6561 6420 746f 2069 7373 7565 7320 6966  ead to issues if
+00019440: 2079 6f75 206d 6572 6765 206d 756c 7469   you merge multi
+00019450: 706c 6520 726f 7773 2066 726f 6d0a 2020  ple rows from.  
+00019460: 2020 2020 2020 2020 2028 3a6d 6174 683a           (:math:
+00019470: 6064 5f63 6029 2074 6f20 6f6e 6520 726f  `d_c`) to one ro
+00019480: 7720 696e 2028 3a6d 6174 683a 6064 5f69  w in (:math:`d_i
+00019490: 6029 2e0a 0a20 2020 2020 2020 2033 2e20  `)...        3. 
+000194a0: 4a6f 696e 696e 6720 626f 7468 206f 6e20  Joining both on 
+000194b0: 636f 6c75 6d6e 732e 2049 6e20 7468 6973  columns. In this
+000194c0: 2063 6173 6520 6120 6861 7368 206a 6f69   case a hash joi
+000194d0: 6e20 6973 2070 6572 666f 726d 6564 2075  n is performed u
+000194e0: 7369 6e67 0a20 2020 2020 2020 2020 2020  sing.           
+000194f0: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
+00019500: 2e6d 756c 7469 2e68 6173 685f 6a6f 696e  .multi.hash_join
+00019510: 6060 2e0a 0a20 2020 2020 2020 2049 6e20  ``...        In 
+00019520: 736f 6d65 2063 6173 6573 2c20 796f 7520  some cases, you 
+00019530: 6d61 7920 7365 6520 6120 6060 4d65 6d6f  may see a ``Memo
+00019540: 7279 4572 726f 7260 6020 6966 2074 6865  ryError`` if the
+00019550: 2060 606d 6572 6765 6060 206f 7065 7261   ``merge`` opera
+00019560: 7469 6f6e 2072 6571 7569 7265 730a 2020  tion requires.  
+00019570: 2020 2020 2020 616e 2069 6e74 6572 6e61        an interna
+00019580: 6c20 6060 7368 7566 666c 6560 602c 2062  l ``shuffle``, b
+00019590: 6563 6175 7365 2073 6875 6666 6c69 6e67  ecause shuffling
+000195a0: 2070 6c61 6365 7320 616c 6c20 726f 7773   places all rows
+000195b0: 2074 6861 7420 6861 7665 2074 6865 2073   that have the s
+000195c0: 616d 650a 2020 2020 2020 2020 696e 6465  ame.        inde
+000195d0: 7820 696e 2074 6865 2073 616d 6520 7061  x in the same pa
+000195e0: 7274 6974 696f 6e2e 2054 6f20 6176 6f69  rtition. To avoi
+000195f0: 6420 7468 6973 2065 7272 6f72 2c20 6d61  d this error, ma
+00019600: 6b65 2073 7572 6520 616c 6c20 726f 7773  ke sure all rows
+00019610: 2077 6974 6820 7468 650a 2020 2020 2020   with the.      
+00019620: 2020 7361 6d65 2060 606f 6e60 602d 636f    same ``on``-co
+00019630: 6c75 6d6e 2076 616c 7565 2063 616e 2066  lumn value can f
+00019640: 6974 206f 6e20 6120 7369 6e67 6c65 2070  it on a single p
+00019650: 6172 7469 7469 6f6e 2e0a 2020 2020 2020  artition..      
+00019660: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00019670: 7475 726e 206d 6572 6765 280a 2020 2020  turn merge(.    
+00019680: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00019690: 2020 2020 2020 2020 2020 7269 6768 742c            right,
+000196a0: 0a20 2020 2020 2020 2020 2020 2068 6f77  .            how
+000196b0: 2c0a 2020 2020 2020 2020 2020 2020 6f6e  ,.            on
+000196c0: 2c0a 2020 2020 2020 2020 2020 2020 6c65  ,.            le
+000196d0: 6674 5f6f 6e2c 0a20 2020 2020 2020 2020  ft_on,.         
+000196e0: 2020 2072 6967 6874 5f6f 6e2c 0a20 2020     right_on,.   
+000196f0: 2020 2020 2020 2020 206c 6566 745f 696e           left_in
+00019700: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+00019710: 2072 6967 6874 5f69 6e64 6578 2c0a 2020   right_index,.  
+00019720: 2020 2020 2020 2020 2020 7375 6666 6978            suffix
+00019730: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00019740: 696e 6469 6361 746f 722c 0a20 2020 2020  indicator,.     
+00019750: 2020 2020 2020 2073 6875 6666 6c65 5f6d         shuffle_m
+00019760: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+00019770: 2020 206e 7061 7274 6974 696f 6e73 3d6e     npartitions=n
+00019780: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+00019790: 2020 2020 2020 2020 6272 6f61 6463 6173          broadcas
+000197a0: 743d 6272 6f61 6463 6173 742c 0a20 2020  t=broadcast,.   
+000197b0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+000197c0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+000197d0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+000197e0: 6a6f 696e 280a 2020 2020 2020 2020 7365  join(.        se
+000197f0: 6c66 2c0a 2020 2020 2020 2020 6f74 6865  lf,.        othe
+00019800: 722c 0a20 2020 2020 2020 206f 6e3d 4e6f  r,.        on=No
+00019810: 6e65 2c0a 2020 2020 2020 2020 686f 773d  ne,.        how=
+00019820: 226c 6566 7422 2c0a 2020 2020 2020 2020  "left",.        
+00019830: 6c73 7566 6669 783d 2222 2c0a 2020 2020  lsuffix="",.    
+00019840: 2020 2020 7273 7566 6669 783d 2222 2c0a      rsuffix="",.
+00019850: 2020 2020 2020 2020 7368 7566 666c 655f          shuffle_
+00019860: 6d65 7468 6f64 3d4e 6f6e 652c 0a20 2020  method=None,.   
+00019870: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00019880: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
+00019890: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+000198a0: 6e73 7461 6e63 6528 6f74 6865 722c 206c  nstance(other, l
+000198b0: 6973 7429 2061 6e64 206e 6f74 2069 735f  ist) and not is_
+000198c0: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
+000198d0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+000198e0: 2020 2020 6f74 6865 7220 3d20 6672 6f6d      other = from
+000198f0: 5f70 616e 6461 7328 6f74 6865 722c 206e  _pandas(other, n
+00019900: 7061 7274 6974 696f 6e73 3d31 290a 2020  partitions=1).  
+00019910: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+00019920: 2020 2020 2020 206e 6f74 2069 7369 6e73         not isins
+00019930: 7461 6e63 6528 6f74 6865 722c 206c 6973  tance(other, lis
+00019940: 7429 0a20 2020 2020 2020 2020 2020 2061  t).            a
+00019950: 6e64 206e 6f74 2069 735f 6461 7461 6672  nd not is_datafr
+00019960: 616d 655f 6c69 6b65 286f 7468 6572 2e5f  ame_like(other._
+00019970: 6d65 7461 290a 2020 2020 2020 2020 2020  meta).          
+00019980: 2020 616e 6420 6861 7361 7474 7228 6f74    and hasattr(ot
+00019990: 6865 722e 5f6d 6574 612c 2022 6e61 6d65  her._meta, "name
+000199a0: 2229 0a20 2020 2020 2020 2029 3a0a 2020  ").        ):.  
+000199b0: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
+000199c0: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+000199d0: 2865 7870 722e 546f 4672 616d 6528 6f74  (expr.ToFrame(ot
+000199e0: 6865 7229 290a 0a20 2020 2020 2020 2069  her))..        i
+000199f0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00019a00: 286f 7468 6572 2c20 4672 616d 6542 6173  (other, FrameBas
+00019a10: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00019a20: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00019a30: 6528 6f74 6865 722c 206c 6973 7429 206f  e(other, list) o
+00019a40: 7220 6e6f 7420 616c 6c28 0a20 2020 2020  r not all(.     
+00019a50: 2020 2020 2020 2020 2020 2069 7369 6e73             isins
+00019a60: 7461 6e63 6528 6f2c 2046 7261 6d65 4261  tance(o, FrameBa
+00019a70: 7365 2920 666f 7220 6f20 696e 206f 7468  se) for o in oth
+00019a80: 6572 0a20 2020 2020 2020 2020 2020 2029  er.            )
+00019a90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019aa0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00019ab0: 6f72 2822 6f74 6865 7220 6d75 7374 2062  or("other must b
+00019ac0: 6520 4461 7461 4672 616d 6520 6f72 206c  e DataFrame or l
+00019ad0: 6973 7420 6f66 2044 6174 6146 7261 6d65  ist of DataFrame
+00019ae0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
+00019af0: 6966 2068 6f77 206e 6f74 2069 6e20 2822  if how not in ("
+00019b00: 6f75 7465 7222 2c20 226c 6566 7422 293a  outer", "left"):
+00019b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019b20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00019b30: 7228 226d 6572 6765 5f6d 756c 7469 206f  r("merge_multi o
+00019b40: 6e6c 7920 7375 7070 6f72 7473 206c 6566  nly supports lef
+00019b50: 7420 6f72 206f 7574 6572 206a 6f69 6e73  t or outer joins
+00019b60: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00019b70: 6f74 6865 7220 3d20 5b0a 2020 2020 2020  other = [.      
+00019b80: 2020 2020 2020 2020 2020 6672 6f6d 5f70            from_p
+00019b90: 616e 6461 7328 6f2c 206e 7061 7274 6974  andas(o, npartit
+00019ba0: 696f 6e73 3d31 2920 6966 206e 6f74 2069  ions=1) if not i
+00019bb0: 735f 6461 736b 5f63 6f6c 6c65 6374 696f  s_dask_collectio
+00019bc0: 6e28 6f29 2065 6c73 6520 6f0a 2020 2020  n(o) else o.    
+00019bd0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00019be0: 6f20 696e 206f 7468 6572 0a20 2020 2020  o in other.     
+00019bf0: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+00019c00: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00019c10: 5f63 6f6c 6c65 6374 696f 6e28 0a20 2020  _collection(.   
+00019c20: 2020 2020 2020 2020 2020 2020 204a 6f69               Joi
+00019c30: 6e52 6563 7572 7369 7665 285b 7365 6c66  nRecursive([self
+00019c40: 2e65 7870 725d 202b 205b 6f2e 6578 7072  .expr] + [o.expr
+00019c50: 2066 6f72 206f 2069 6e20 6f74 6865 725d   for o in other]
+00019c60: 2c20 686f 773d 686f 7729 0a20 2020 2020  , how=how).     
+00019c70: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00019c80: 2020 7265 7475 726e 2073 656c 662e 6d65    return self.me
+00019c90: 7267 6528 0a20 2020 2020 2020 2020 2020  rge(.           
+00019ca0: 2072 6967 6874 3d6f 7468 6572 2c0a 2020   right=other,.  
+00019cb0: 2020 2020 2020 2020 2020 6c65 6674 5f69            left_i
+00019cc0: 6e64 6578 3d6f 6e20 6973 204e 6f6e 652c  ndex=on is None,
+00019cd0: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+00019ce0: 6874 5f69 6e64 6578 3d54 7275 652c 0a20  ht_index=True,. 
+00019cf0: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+00019d00: 6f6e 3d6f 6e2c 0a20 2020 2020 2020 2020  on=on,.         
+00019d10: 2020 2068 6f77 3d68 6f77 2c0a 2020 2020     how=how,.    
+00019d20: 2020 2020 2020 2020 7375 6666 6978 6573          suffixes
+00019d30: 3d28 6c73 7566 6669 782c 2072 7375 6666  =(lsuffix, rsuff
+00019d40: 6978 292c 0a20 2020 2020 2020 2020 2020  ix),.           
+00019d50: 2073 6875 6666 6c65 5f6d 6574 686f 643d   shuffle_method=
+00019d60: 7368 7566 666c 655f 6d65 7468 6f64 2c0a  shuffle_method,.
+00019d70: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
+00019d80: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
+00019d90: 6f6e 732c 0a20 2020 2020 2020 2029 0a0a  ons,.        )..
+00019da0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00019db0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00019dc0: 2020 2020 6465 6620 6772 6f75 7062 7928      def groupby(
+00019dd0: 0a20 2020 2020 2020 2073 656c 662c 2062  .        self, b
+00019de0: 792c 2067 726f 7570 5f6b 6579 733d 5472  y, group_keys=Tr
+00019df0: 7565 2c20 736f 7274 3d4e 6f6e 652c 206f  ue, sort=None, o
+00019e00: 6273 6572 7665 643d 4e6f 6e65 2c20 6472  bserved=None, dr
+00019e10: 6f70 6e61 3d4e 6f6e 652c 202a 2a6b 7761  opna=None, **kwa
+00019e20: 7267 730a 2020 2020 293a 0a20 2020 2020  rgs.    ):.     
+00019e30: 2020 2066 726f 6d20 6461 736b 5f65 7870     from dask_exp
+00019e40: 722e 5f67 726f 7570 6279 2069 6d70 6f72  r._groupby impor
+00019e50: 7420 4772 6f75 7042 790a 0a20 2020 2020  t GroupBy..     
+00019e60: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00019e70: 2862 792c 2046 7261 6d65 4261 7365 2920  (by, FrameBase) 
+00019e80: 616e 6420 6e6f 7420 6973 696e 7374 616e  and not isinstan
+00019e90: 6365 2862 792c 2053 6572 6965 7329 3a0a  ce(by, Series):.
+00019ea0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00019eb0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00019ec0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00019ed0: 6062 7960 206d 7573 7420 6265 2061 2063  `by` must be a c
+00019ee0: 6f6c 756d 6e20 6e61 6d65 206f 7220 6c69  olumn name or li
+00019ef0: 7374 206f 6620 636f 6c75 6d6e 732c 2067  st of columns, g
+00019f00: 6f74 207b 6279 7d2e 220a 2020 2020 2020  ot {by}.".      
+00019f10: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00019f20: 2072 6574 7572 6e20 4772 6f75 7042 7928   return GroupBy(
+00019f30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019f40: 662c 0a20 2020 2020 2020 2020 2020 2062  f,.            b
+00019f50: 792c 0a20 2020 2020 2020 2020 2020 2067  y,.            g
+00019f60: 726f 7570 5f6b 6579 733d 6772 6f75 705f  roup_keys=group_
+00019f70: 6b65 7973 2c0a 2020 2020 2020 2020 2020  keys,.          
+00019f80: 2020 736f 7274 3d73 6f72 742c 0a20 2020    sort=sort,.   
+00019f90: 2020 2020 2020 2020 206f 6273 6572 7665           observe
+00019fa0: 643d 6f62 7365 7276 6564 2c0a 2020 2020  d=observed,.    
+00019fb0: 2020 2020 2020 2020 6472 6f70 6e61 3d64          dropna=d
+00019fc0: 726f 706e 612c 0a20 2020 2020 2020 2020  ropna,.         
+00019fd0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+00019fe0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00019ff0: 5f5f 7365 7469 7465 6d5f 5f28 7365 6c66  __setitem__(self
+0001a000: 2c20 6b65 792c 2076 616c 7565 293a 0a20  , key, value):. 
+0001a010: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001a020: 616e 6365 286b 6579 2c20 2874 7570 6c65  ance(key, (tuple
+0001a030: 2c20 6c69 7374 2929 2061 6e64 2069 7369  , list)) and isi
+0001a040: 6e73 7461 6e63 6528 7661 6c75 652c 2044  nstance(value, D
+0001a050: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+0001a060: 2020 2020 2020 206f 7574 203d 2073 656c         out = sel
+0001a070: 662e 6173 7369 676e 282a 2a7b 6b3a 2076  f.assign(**{k: v
+0001a080: 616c 7565 5b63 5d20 666f 7220 6b2c 2063  alue[c] for k, c
+0001a090: 2069 6e20 7a69 7028 6b65 792c 2076 616c   in zip(key, val
+0001a0a0: 7565 2e63 6f6c 756d 6e73 297d 290a 0a20  ue.columns)}).. 
+0001a0b0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0001a0c0: 7374 616e 6365 286b 6579 2c20 7064 2e49  stance(key, pd.I
+0001a0d0: 6e64 6578 2920 616e 6420 6e6f 7420 6973  ndex) and not is
+0001a0e0: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+0001a0f0: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
+0001a100: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
+0001a110: 6c66 2e61 7373 6967 6e28 2a2a 7b6b 3a20  lf.assign(**{k: 
+0001a120: 7661 6c75 6520 666f 7220 6b20 696e 206c  value for k in l
+0001a130: 6973 7428 6b65 7929 7d29 0a20 2020 2020  ist(key)}).     
+0001a140: 2020 2065 6c69 6620 280a 2020 2020 2020     elif (.      
+0001a150: 2020 2020 2020 6973 5f64 6174 6166 7261        is_datafra
+0001a160: 6d65 5f6c 696b 6528 6b65 7929 0a20 2020  me_like(key).   
+0001a170: 2020 2020 2020 2020 206f 7220 6973 5f73           or is_s
+0001a180: 6572 6965 735f 6c69 6b65 286b 6579 290a  eries_like(key).
+0001a190: 2020 2020 2020 2020 2020 2020 6f72 2069              or i
+0001a1a0: 7369 6e73 7461 6e63 6528 6b65 792c 2028  sinstance(key, (
+0001a1b0: 4461 7461 4672 616d 652c 2053 6572 6965  DataFrame, Serie
+0001a1c0: 7329 290a 2020 2020 2020 2020 293a 0a20  s)).        ):. 
+0001a1d0: 2020 2020 2020 2020 2020 206f 7574 203d             out =
+0001a1e0: 2073 656c 662e 7768 6572 6528 7e6b 6579   self.where(~key
+0001a1f0: 2c20 7661 6c75 6529 0a20 2020 2020 2020  , value).       
+0001a200: 2065 6c69 6620 6e6f 7420 6973 696e 7374   elif not isinst
+0001a210: 616e 6365 286b 6579 2c20 7374 7229 3a0a  ance(key, str):.
+0001a220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001a230: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0001a240: 4572 726f 7228 6622 4974 656d 2061 7373  Error(f"Item ass
+0001a250: 6967 6e6d 656e 7420 7769 7468 207b 7479  ignment with {ty
+0001a260: 7065 286b 6579 297d 206e 6f74 2073 7570  pe(key)} not sup
+0001a270: 706f 7274 6564 2229 0a20 2020 2020 2020  ported").       
+0001a280: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001a290: 2020 206f 7574 203d 2073 656c 662e 6173     out = self.as
+0001a2a0: 7369 676e 282a 2a7b 6b65 793a 2076 616c  sign(**{key: val
+0001a2b0: 7565 7d29 0a20 2020 2020 2020 2073 656c  ue}).        sel
+0001a2c0: 662e 5f65 7870 7220 3d20 6f75 742e 5f65  f._expr = out._e
+0001a2d0: 7870 720a 0a20 2020 2064 6566 205f 5f64  xpr..    def __d
+0001a2e0: 656c 6974 656d 5f5f 2873 656c 662c 206b  elitem__(self, k
+0001a2f0: 6579 293a 0a20 2020 2020 2020 2063 6f6c  ey):.        col
+0001a300: 756d 6e73 203d 205b 6320 666f 7220 6320  umns = [c for c 
+0001a310: 696e 2073 656c 662e 636f 6c75 6d6e 7320  in self.columns 
+0001a320: 6966 2063 2021 3d20 6b65 795d 0a20 2020  if c != key].   
+0001a330: 2020 2020 206f 7574 203d 2073 656c 665b       out = self[
+0001a340: 636f 6c75 6d6e 735d 0a20 2020 2020 2020  columns].       
+0001a350: 2073 656c 662e 5f65 7870 7220 3d20 6f75   self._expr = ou
+0001a360: 742e 5f65 7870 720a 0a20 2020 2064 6566  t._expr..    def
+0001a370: 205f 5f73 6574 6174 7472 5f5f 2873 656c   __setattr__(sel
+0001a380: 662c 206b 6579 2c20 7661 6c75 6529 3a0a  f, key, value):.
+0001a390: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0001a3a0: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+0001a3b0: 203d 206f 626a 6563 742e 5f5f 6765 7461   = object.__geta
+0001a3c0: 7474 7269 6275 7465 5f5f 2873 656c 662c  ttribute__(self,
+0001a3d0: 2022 5f65 7870 7222 292e 636f 6c75 6d6e   "_expr").column
+0001a3e0: 730a 2020 2020 2020 2020 6578 6365 7074  s.        except
+0001a3f0: 2041 7474 7269 6275 7465 4572 726f 723a   AttributeError:
+0001a400: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+0001a410: 756d 6e73 203d 2028 290a 0a20 2020 2020  umns = ()..     
+0001a420: 2020 2023 2065 7863 6c75 6465 2070 726f     # exclude pro
+0001a430: 7465 6374 6564 2061 7474 7269 6275 7465  tected attribute
+0001a440: 7320 6672 6f6d 2073 6574 6974 656d 0a20  s from setitem. 
+0001a450: 2020 2020 2020 2069 6620 6b65 7920 696e         if key in
+0001a460: 2063 6f6c 756d 6e73 2061 6e64 206b 6579   columns and key
+0001a470: 206e 6f74 2069 6e20 5b0a 2020 2020 2020   not in [.      
+0001a480: 2020 2020 2020 2264 6976 6973 696f 6e73        "divisions
+0001a490: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+0001a4a0: 6461 736b 222c 0a20 2020 2020 2020 2020  dask",.         
+0001a4b0: 2020 2022 5f6e 616d 6522 2c0a 2020 2020     "_name",.    
+0001a4c0: 2020 2020 2020 2020 225f 6d65 7461 222c          "_meta",
+0001a4d0: 0a20 2020 2020 2020 2020 2020 2022 5f65  .            "_e
+0001a4e0: 7870 7222 2c0a 2020 2020 2020 2020 5d3a  xpr",.        ]:
+0001a4f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001a500: 665b 6b65 795d 203d 2076 616c 7565 0a20  f[key] = value. 
+0001a510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001a520: 2020 2020 2020 2020 206f 626a 6563 742e           object.
+0001a530: 5f5f 7365 7461 7474 725f 5f28 7365 6c66  __setattr__(self
+0001a540: 2c20 6b65 792c 2076 616c 7565 290a 0a20  , key, value).. 
+0001a550: 2020 2064 6566 205f 5f67 6574 6174 7472     def __getattr
+0001a560: 5f5f 2873 656c 662c 206b 6579 293a 0a20  __(self, key):. 
+0001a570: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0001a580: 2020 2020 2020 2020 2320 5072 696f 7269          # Priori
+0001a590: 7469 7a65 2060 4461 7461 4672 616d 6560  tize `DataFrame`
+0001a5a0: 2061 7474 7269 6275 7465 730a 2020 2020   attributes.    
+0001a5b0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+0001a5c0: 626a 6563 742e 5f5f 6765 7461 7474 7269  bject.__getattri
+0001a5d0: 6275 7465 5f5f 2873 656c 662c 206b 6579  bute__(self, key
+0001a5e0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+0001a5f0: 2041 7474 7269 6275 7465 4572 726f 7220   AttributeError 
+0001a600: 6173 2065 7272 3a0a 2020 2020 2020 2020  as err:.        
+0001a610: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001a620: 2020 2020 2020 2020 2023 2043 6865 636b           # Check
+0001a630: 2069 6620 6b65 7920 6973 2069 6e20 636f   if key is in co
+0001a640: 6c75 6d6e 7320 6966 206b 6579 0a20 2020  lumns if key.   
+0001a650: 2020 2020 2020 2020 2020 2020 2023 2069               # i
+0001a660: 7320 6e6f 7420 6120 6e6f 726d 616c 2061  s not a normal a
+0001a670: 7474 7269 6275 7465 0a20 2020 2020 2020  ttribute.       
+0001a680: 2020 2020 2020 2020 2069 6620 6b65 7920           if key 
+0001a690: 696e 2073 656c 662e 6578 7072 2e5f 6d65  in self.expr._me
+0001a6a0: 7461 2e63 6f6c 756d 6e73 3a0a 2020 2020  ta.columns:.    
+0001a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a6c0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0001a6d0: 6374 696f 6e28 7365 6c66 2e65 7870 725b  ction(self.expr[
+0001a6e0: 6b65 795d 290a 2020 2020 2020 2020 2020  key]).          
+0001a6f0: 2020 2020 2020 7261 6973 6520 6572 720a        raise err.
+0001a700: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+0001a710: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
+0001a720: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0001a730: 2020 2023 2046 616c 6c20 6261 636b 2074     # Fall back t
+0001a740: 6f20 6042 6173 6546 7261 6d65 2e5f 5f67  o `BaseFrame.__g
+0001a750: 6574 6174 7472 5f5f 600a 2020 2020 2020  etattr__`.      
+0001a760: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a770: 2073 7570 6572 2829 2e5f 5f67 6574 6174   super().__getat
+0001a780: 7472 5f5f 286b 6579 290a 0a20 2020 2064  tr__(key)..    d
+0001a790: 6566 205f 5f64 6972 5f5f 2873 656c 6629  ef __dir__(self)
+0001a7a0: 3a0a 2020 2020 2020 2020 6f20 3d20 7365  :.        o = se
+0001a7b0: 7428 6469 7228 7479 7065 2873 656c 6629  t(dir(type(self)
+0001a7c0: 2929 0a20 2020 2020 2020 206f 2e75 7064  )).        o.upd
+0001a7d0: 6174 6528 7365 6c66 2e5f 5f64 6963 745f  ate(self.__dict_
+0001a7e0: 5f29 0a20 2020 2020 2020 206f 2e75 7064  _).        o.upd
+0001a7f0: 6174 6528 7365 7428 6469 7228 6578 7072  ate(set(dir(expr
+0001a800: 2e45 7870 7229 2929 0a20 2020 2020 2020  .Expr))).       
+0001a810: 206f 2e75 7064 6174 6528 6320 666f 7220   o.update(c for 
+0001a820: 6320 696e 2073 656c 662e 636f 6c75 6d6e  c in self.column
+0001a830: 7320 6966 2028 6973 696e 7374 616e 6365  s if (isinstance
+0001a840: 2863 2c20 7374 7229 2061 6e64 2063 2e69  (c, str) and c.i
+0001a850: 7369 6465 6e74 6966 6965 7228 2929 290a  sidentifier())).
+0001a860: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0001a870: 6973 7428 6f29 0a0a 2020 2020 6465 6620  ist(o)..    def 
+0001a880: 6d61 7028 7365 6c66 2c20 6675 6e63 2c20  map(self, func, 
+0001a890: 6e61 5f61 6374 696f 6e3d 4e6f 6e65 2c20  na_action=None, 
+0001a8a0: 6d65 7461 3d4e 6f6e 6529 3a0a 2020 2020  meta=None):.    
+0001a8b0: 2020 2020 6966 206e 6f74 2050 414e 4441      if not PANDA
+0001a8c0: 535f 4745 5f32 3130 3a0a 2020 2020 2020  S_GE_210:.      
+0001a8d0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0001a8e0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0001a8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a900: 2066 2244 6174 6146 7261 6d65 2e6d 6170   f"DataFrame.map
+0001a910: 2072 6571 7569 7265 7320 7061 6e64 6173   requires pandas
+0001a920: 3e3d 322e 312e 302c 2062 7574 2070 616e  >=2.1.0, but pan
+0001a930: 6461 733d 7b50 414e 4441 535f 5645 5253  das={PANDAS_VERS
+0001a940: 494f 4e7d 2069 7320 220a 2020 2020 2020  ION} is ".      
+0001a950: 2020 2020 2020 2020 2020 2269 6e73 7461            "insta
+0001a960: 6c6c 6564 2e22 0a20 2020 2020 2020 2020  lled.".         
+0001a970: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+0001a980: 6d65 7461 2069 7320 4e6f 6e65 3a0a 2020  meta is None:.  
+0001a990: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+0001a9a0: 2065 7870 722e 5f65 6d75 6c61 7465 284d   expr._emulate(M
+0001a9b0: 2e6d 6170 2c20 7365 6c66 2c20 6675 6e63  .map, self, func
+0001a9c0: 2c20 6e61 5f61 6374 696f 6e3d 6e61 5f61  , na_action=na_a
+0001a9d0: 6374 696f 6e2c 2075 6466 3d54 7275 6529  ction, udf=True)
+0001a9e0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+0001a9f0: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
+0001aa00: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
+0001aa10: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0001aa20: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
+0001aa30: 722e 4d61 7028 7365 6c66 2c20 6172 673d  r.Map(self, arg=
+0001aa40: 6675 6e63 2c20 6e61 5f61 6374 696f 6e3d  func, na_action=
+0001aa50: 6e61 5f61 6374 696f 6e2c 206d 6574 613d  na_action, meta=
+0001aa60: 6d65 7461 2929 0a0a 2020 2020 4064 6572  meta))..    @der
+0001aa70: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0001aa80: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0001aa90: 6e6c 6172 6765 7374 2873 656c 662c 206e  nlargest(self, n
+0001aaa0: 3d35 2c20 636f 6c75 6d6e 733d 4e6f 6e65  =5, columns=None
+0001aab0: 2c20 7370 6c69 745f 6576 6572 793d 4e6f  , split_every=No
+0001aac0: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+0001aad0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0001aae0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+0001aaf0: 4e4c 6172 6765 7374 2873 656c 662c 206e  NLargest(self, n
+0001ab00: 3d6e 2c20 5f63 6f6c 756d 6e73 3d63 6f6c  =n, _columns=col
+0001ab10: 756d 6e73 2c20 7370 6c69 745f 6576 6572  umns, split_ever
+0001ab20: 793d 7370 6c69 745f 6576 6572 7929 0a20  y=split_every). 
+0001ab30: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0001ab40: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001ab50: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001ab60: 6620 6e73 6d61 6c6c 6573 7428 7365 6c66  f nsmallest(self
+0001ab70: 2c20 6e3d 352c 2063 6f6c 756d 6e73 3d4e  , n=5, columns=N
+0001ab80: 6f6e 652c 2073 706c 6974 5f65 7665 7279  one, split_every
+0001ab90: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001aba0: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0001abb0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0001abc0: 2020 204e 536d 616c 6c65 7374 2873 656c     NSmallest(sel
+0001abd0: 662c 206e 3d6e 2c20 5f63 6f6c 756d 6e73  f, n=n, _columns
+0001abe0: 3d63 6f6c 756d 6e73 2c20 7370 6c69 745f  =columns, split_
+0001abf0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+0001ac00: 7929 0a20 2020 2020 2020 2029 0a0a 2020  y).        )..  
+0001ac10: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0001ac20: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0001ac30: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
+0001ac40: 6765 2873 656c 662c 2064 6565 703d 4661  ge(self, deep=Fa
+0001ac50: 6c73 652c 2069 6e64 6578 3d54 7275 6529  lse, index=True)
+0001ac60: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001ac70: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0001ac80: 4d65 6d6f 7279 5573 6167 6546 7261 6d65  MemoryUsageFrame
+0001ac90: 2873 656c 662c 2064 6565 703d 6465 6570  (self, deep=deep
+0001aca0: 2c20 5f69 6e64 6578 3d69 6e64 6578 2929  , _index=index))
+0001acb0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0001acc0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0001acd0: 290a 2020 2020 6465 6620 636f 6d62 696e  ).    def combin
+0001ace0: 6528 7365 6c66 2c20 6f74 6865 722c 2066  e(self, other, f
+0001acf0: 756e 632c 2066 696c 6c5f 7661 6c75 653d  unc, fill_value=
+0001ad00: 4e6f 6e65 2c20 6f76 6572 7772 6974 653d  None, overwrite=
+0001ad10: 5472 7565 293a 0a20 2020 2020 2020 206f  True):.        o
+0001ad20: 7468 6572 203d 2073 656c 662e 5f63 7265  ther = self._cre
+0001ad30: 6174 655f 616c 6967 6e61 626c 655f 6672  ate_alignable_fr
+0001ad40: 616d 6528 6f74 6865 722c 2022 6f75 7465  ame(other, "oute
+0001ad50: 7222 290a 2020 2020 2020 2020 6966 206e  r").        if n
+0001ad60: 6f74 2065 7870 722e 6172 655f 636f 5f61  ot expr.are_co_a
+0001ad70: 6c69 676e 6564 2873 656c 662e 6578 7072  ligned(self.expr
+0001ad80: 2c20 6f74 6865 722e 6578 7072 293a 0a20  , other.expr):. 
+0001ad90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ada0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+0001adb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001adc0: 2020 6578 7072 2e43 6f6d 6269 6e65 4672    expr.CombineFr
+0001add0: 616d 6541 6c69 676e 2873 656c 662c 206f  ameAlign(self, o
+0001ade0: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
+0001adf0: 5f76 616c 7565 2c20 6f76 6572 7772 6974  _value, overwrit
+0001ae00: 6529 0a20 2020 2020 2020 2020 2020 2029  e).            )
+0001ae10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ae20: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
+0001ae30: 2020 2020 2020 2020 2020 2020 6578 7072              expr
+0001ae40: 2e43 6f6d 6269 6e65 4672 616d 6528 7365  .CombineFrame(se
+0001ae50: 6c66 2c20 6f74 6865 722c 2066 756e 632c  lf, other, func,
+0001ae60: 2066 696c 6c5f 7661 6c75 652c 206f 7665   fill_value, ove
+0001ae70: 7277 7269 7465 290a 2020 2020 2020 2020  rwrite).        
+0001ae80: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0001ae90: 6672 6f6d 280a 2020 2020 2020 2020 7064  from(.        pd
+0001aea0: 2e44 6174 6146 7261 6d65 2c0a 2020 2020  .DataFrame,.    
+0001aeb0: 2020 2020 696e 636f 6e73 6973 7465 6e63      inconsistenc
+0001aec0: 6965 733d 226b 6565 703d 4661 6c73 6520  ies="keep=False 
+0001aed0: 7769 6c6c 2072 6169 7365 2061 2060 604e  will raise a ``N
+0001aee0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0001aef0: 6f72 6060 222c 0a20 2020 2029 0a20 2020  or``",.    ).   
+0001af00: 2064 6566 2064 726f 705f 6475 706c 6963   def drop_duplic
+0001af10: 6174 6573 280a 2020 2020 2020 2020 7365  ates(.        se
+0001af20: 6c66 2c0a 2020 2020 2020 2020 7375 6273  lf,.        subs
+0001af30: 6574 3d4e 6f6e 652c 0a20 2020 2020 2020  et=None,.       
+0001af40: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
+0001af50: 652c 0a20 2020 2020 2020 2073 706c 6974  e,.        split
+0001af60: 5f6f 7574 3d54 7275 652c 0a20 2020 2020  _out=True,.     
+0001af70: 2020 2073 6875 6666 6c65 5f6d 6574 686f     shuffle_metho
+0001af80: 643d 4e6f 6e65 2c0a 2020 2020 2020 2020  d=None,.        
+0001af90: 6967 6e6f 7265 5f69 6e64 6578 3d46 616c  ignore_index=Fal
+0001afa0: 7365 2c0a 2020 2020 2020 2020 6b65 6570  se,.        keep
+0001afb0: 3d22 6669 7273 7422 2c0a 2020 2020 293a  ="first",.    ):
+0001afc0: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+0001afd0: 5f6d 6574 686f 6420 3d20 5f67 6574 5f73  _method = _get_s
+0001afe0: 6875 6666 6c65 5f70 7265 6665 7272 696e  huffle_preferrin
+0001aff0: 675f 6f72 6465 7228 7368 7566 666c 655f  g_order(shuffle_
+0001b000: 6d65 7468 6f64 290a 2020 2020 2020 2020  method).        
+0001b010: 6966 206b 6565 7020 6973 2046 616c 7365  if keep is False
+0001b020: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001b030: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0001b040: 6564 4572 726f 7228 2264 726f 705f 6475  edError("drop_du
+0001b050: 706c 6963 6174 6573 2077 6974 6820 6b65  plicates with ke
+0001b060: 6570 3d46 616c 7365 2229 0a20 2020 2020  ep=False").     
+0001b070: 2020 2023 2046 6169 6c20 6561 726c 7920     # Fail early 
+0001b080: 6966 2073 7562 7365 7420 6973 206e 6f74  if subset is not
+0001b090: 2076 616c 6964 2c20 652e 672e 206d 6973   valid, e.g. mis
+0001b0a0: 7369 6e67 2063 6f6c 756d 6e73 0a20 2020  sing columns.   
+0001b0b0: 2020 2020 2073 7562 7365 7420 3d20 5f63       subset = _c
+0001b0c0: 6f6e 7665 7274 5f74 6f5f 6c69 7374 2873  onvert_to_list(s
+0001b0d0: 7562 7365 7429 0a20 2020 2020 2020 206d  ubset).        m
+0001b0e0: 6574 615f 6e6f 6e65 6d70 7479 2873 656c  eta_nonempty(sel
+0001b0f0: 662e 5f6d 6574 6129 2e64 726f 705f 6475  f._meta).drop_du
+0001b100: 706c 6963 6174 6573 2873 7562 7365 743d  plicates(subset=
+0001b110: 7375 6273 6574 2c20 6b65 6570 3d6b 6565  subset, keep=kee
+0001b120: 7029 0a20 2020 2020 2020 2072 6574 7572  p).        retur
+0001b130: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+0001b140: 280a 2020 2020 2020 2020 2020 2020 4472  (.            Dr
+0001b150: 6f70 4475 706c 6963 6174 6573 280a 2020  opDuplicates(.  
+0001b160: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001b170: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+0001b180: 2020 2020 7375 6273 6574 3d73 7562 7365      subset=subse
+0001b190: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0001b1a0: 2020 2069 676e 6f72 655f 696e 6465 783d     ignore_index=
+0001b1b0: 6967 6e6f 7265 5f69 6e64 6578 2c0a 2020  ignore_index,.  
+0001b1c0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+0001b1d0: 6c69 745f 6f75 743d 7370 6c69 745f 6f75  lit_out=split_ou
+0001b1e0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0001b1f0: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+0001b200: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+0001b210: 2020 2020 2020 2020 2020 2020 7368 7566              shuf
+0001b220: 666c 655f 6d65 7468 6f64 3d73 6875 6666  fle_method=shuff
+0001b230: 6c65 5f6d 6574 686f 642c 0a20 2020 2020  le_method,.     
+0001b240: 2020 2020 2020 2020 2020 206b 6565 703d             keep=
+0001b250: 6b65 6570 2c0a 2020 2020 2020 2020 2020  keep,.          
+0001b260: 2020 290a 2020 2020 2020 2020 290a 0a20    ).        ).. 
+0001b270: 2020 2040 696e 7365 7274 5f6d 6574 615f     @insert_meta_
+0001b280: 7061 7261 6d5f 6465 7363 7269 7074 696f  param_descriptio
+0001b290: 6e28 7061 643d 3132 290a 2020 2020 6465  n(pad=12).    de
+0001b2a0: 6620 6170 706c 7928 7365 6c66 2c20 6675  f apply(self, fu
+0001b2b0: 6e63 7469 6f6e 2c20 2a61 7267 732c 206d  nction, *args, m
+0001b2c0: 6574 613d 6e6f 5f64 6566 6175 6c74 2c20  eta=no_default, 
+0001b2d0: 6178 6973 3d30 2c20 2a2a 6b77 6172 6773  axis=0, **kwargs
+0001b2e0: 293a 0a20 2020 2020 2020 2022 2222 5061  ):.        """Pa
+0001b2f0: 7261 6c6c 656c 2076 6572 7369 6f6e 206f  rallel version o
+0001b300: 6620 7061 6e64 6173 2e44 6174 6146 7261  f pandas.DataFra
+0001b310: 6d65 2e61 7070 6c79 0a0a 2020 2020 2020  me.apply..      
+0001b320: 2020 5468 6973 206d 696d 6963 7320 7468    This mimics th
+0001b330: 6520 7061 6e64 6173 2076 6572 7369 6f6e  e pandas version
+0001b340: 2065 7863 6570 7420 666f 7220 7468 6520   except for the 
+0001b350: 666f 6c6c 6f77 696e 673a 0a0a 2020 2020  following:..    
+0001b360: 2020 2020 312e 2020 4f6e 6c79 2060 6061      1.  Only ``a
+0001b370: 7869 733d 3160 6020 6973 2073 7570 706f  xis=1`` is suppo
+0001b380: 7274 6564 2028 616e 6420 6d75 7374 2062  rted (and must b
+0001b390: 6520 7370 6563 6966 6965 6420 6578 706c  e specified expl
+0001b3a0: 6963 6974 6c79 292e 0a20 2020 2020 2020  icitly)..       
+0001b3b0: 2032 2e20 2054 6865 2075 7365 7220 7368   2.  The user sh
+0001b3c0: 6f75 6c64 2070 726f 7669 6465 206f 7574  ould provide out
+0001b3d0: 7075 7420 6d65 7461 6461 7461 2076 6961  put metadata via
+0001b3e0: 2074 6865 2060 6d65 7461 6020 6b65 7977   the `meta` keyw
+0001b3f0: 6f72 642e 0a0a 2020 2020 2020 2020 5061  ord...        Pa
+0001b400: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0001b410: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0001b420: 2020 2020 6675 6e63 203a 2066 756e 6374      func : funct
+0001b430: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+0001b440: 4675 6e63 7469 6f6e 2074 6f20 6170 706c  Function to appl
+0001b450: 7920 746f 2065 6163 6820 636f 6c75 6d6e  y to each column
+0001b460: 2f72 6f77 0a20 2020 2020 2020 2061 7869  /row.        axi
+0001b470: 7320 3a20 7b30 206f 7220 2769 6e64 6578  s : {0 or 'index
+0001b480: 272c 2031 206f 7220 2763 6f6c 756d 6e73  ', 1 or 'columns
+0001b490: 277d 2c20 6465 6661 756c 7420 300a 2020  '}, default 0.  
+0001b4a0: 2020 2020 2020 2020 2020 2d20 3020 6f72            - 0 or
+0001b4b0: 2027 696e 6465 7827 3a20 6170 706c 7920   'index': apply 
+0001b4c0: 6675 6e63 7469 6f6e 2074 6f20 6561 6368  function to each
+0001b4d0: 2063 6f6c 756d 6e20 284e 4f54 2053 5550   column (NOT SUP
+0001b4e0: 504f 5254 4544 290a 2020 2020 2020 2020  PORTED).        
+0001b4f0: 2020 2020 2d20 3120 6f72 2027 636f 6c75      - 1 or 'colu
+0001b500: 6d6e 7327 3a20 6170 706c 7920 6675 6e63  mns': apply func
+0001b510: 7469 6f6e 2074 6f20 6561 6368 2072 6f77  tion to each row
+0001b520: 0a20 2020 2020 2020 2024 4d45 5441 0a20  .        $META. 
+0001b530: 2020 2020 2020 2061 7267 7320 3a20 7475         args : tu
+0001b540: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
+0001b550: 506f 7369 7469 6f6e 616c 2061 7267 756d  Positional argum
+0001b560: 656e 7473 2074 6f20 7061 7373 2074 6f20  ents to pass to 
+0001b570: 6675 6e63 7469 6f6e 2069 6e20 6164 6469  function in addi
+0001b580: 7469 6f6e 2074 6f20 7468 6520 6172 7261  tion to the arra
+0001b590: 792f 7365 7269 6573 0a0a 2020 2020 2020  y/series..      
+0001b5a0: 2020 4164 6469 7469 6f6e 616c 206b 6579    Additional key
+0001b5b0: 776f 7264 2061 7267 756d 656e 7473 2077  word arguments w
+0001b5c0: 696c 6c20 6265 2070 6173 7365 6420 6173  ill be passed as
+0001b5d0: 206b 6579 776f 7264 7320 746f 2074 6865   keywords to the
+0001b5e0: 2066 756e 6374 696f 6e0a 0a20 2020 2020   function..     
+0001b5f0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+0001b600: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+0001b610: 2020 2061 7070 6c69 6564 203a 2053 6572     applied : Ser
+0001b620: 6965 7320 6f72 2044 6174 6146 7261 6d65  ies or DataFrame
+0001b630: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0001b640: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+0001b650: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+0001b660: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0001b670: 2070 640a 2020 2020 2020 2020 3e3e 3e20   pd.        >>> 
+0001b680: 696d 706f 7274 2064 6173 6b2e 6461 7461  import dask.data
+0001b690: 6672 616d 6520 6173 2064 640a 2020 2020  frame as dd.    
+0001b6a0: 2020 2020 3e3e 3e20 6466 203d 2070 642e      >>> df = pd.
+0001b6b0: 4461 7461 4672 616d 6528 7b27 7827 3a20  DataFrame({'x': 
+0001b6c0: 5b31 2c20 322c 2033 2c20 342c 2035 5d2c  [1, 2, 3, 4, 5],
+0001b6d0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6f0: 2779 273a 205b 312e 2c20 322e 2c20 332e  'y': [1., 2., 3.
+0001b700: 2c20 342e 2c20 352e 5d7d 290a 2020 2020  , 4., 5.]}).    
+0001b710: 2020 2020 3e3e 3e20 6464 6620 3d20 6464      >>> ddf = dd
+0001b720: 2e66 726f 6d5f 7061 6e64 6173 2864 662c  .from_pandas(df,
+0001b730: 206e 7061 7274 6974 696f 6e73 3d32 290a   npartitions=2).
+0001b740: 0a20 2020 2020 2020 2041 7070 6c79 2061  .        Apply a
+0001b750: 2066 756e 6374 696f 6e20 746f 2072 6f77   function to row
+0001b760: 2d77 6973 6520 7061 7373 696e 6720 696e  -wise passing in
+0001b770: 2065 7874 7261 2061 7267 756d 656e 7473   extra arguments
+0001b780: 2069 6e20 6060 6172 6773 6060 2061 6e64   in ``args`` and
+0001b790: 0a20 2020 2020 2020 2060 606b 7761 7267  .        ``kwarg
+0001b7a0: 7360 603a 0a0a 2020 2020 2020 2020 3e3e  s``:..        >>
+0001b7b0: 3e20 6465 6620 6d79 6164 6428 726f 772c  > def myadd(row,
+0001b7c0: 2061 2c20 623d 3129 3a0a 2020 2020 2020   a, b=1):.      
+0001b7d0: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+0001b7e0: 2072 6f77 2e73 756d 2829 202b 2061 202b   row.sum() + a +
+0001b7f0: 2062 0a20 2020 2020 2020 203e 3e3e 2072   b.        >>> r
+0001b800: 6573 203d 2064 6466 2e61 7070 6c79 286d  es = ddf.apply(m
+0001b810: 7961 6464 2c20 6178 6973 3d31 2c20 6172  yadd, axis=1, ar
+0001b820: 6773 3d28 322c 292c 2062 3d31 2e35 2920  gs=(2,), b=1.5) 
+0001b830: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0001b840: 500a 0a20 2020 2020 2020 2042 7920 6465  P..        By de
+0001b850: 6661 756c 742c 2064 6173 6b20 7472 6965  fault, dask trie
+0001b860: 7320 746f 2069 6e66 6572 2074 6865 206f  s to infer the o
+0001b870: 7574 7075 7420 6d65 7461 6461 7461 2062  utput metadata b
+0001b880: 7920 7275 6e6e 696e 6720 796f 7572 0a20  y running your. 
+0001b890: 2020 2020 2020 2070 726f 7669 6465 6420         provided 
+0001b8a0: 6675 6e63 7469 6f6e 206f 6e20 736f 6d65  function on some
+0001b8b0: 2066 616b 6520 6461 7461 2e20 5468 6973   fake data. This
+0001b8c0: 2077 6f72 6b73 2077 656c 6c20 696e 206d   works well in m
+0001b8d0: 616e 7920 6361 7365 732c 2062 7574 0a20  any cases, but. 
+0001b8e0: 2020 2020 2020 2063 616e 2073 6f6d 6574         can somet
+0001b8f0: 696d 6573 2062 6520 6578 7065 6e73 6976  imes be expensiv
+0001b900: 652c 206f 7220 6576 656e 2066 6169 6c2e  e, or even fail.
+0001b910: 2054 6f20 6176 6f69 6420 7468 6973 2c20   To avoid this, 
+0001b920: 796f 7520 6361 6e0a 2020 2020 2020 2020  you can.        
+0001b930: 6d61 6e75 616c 6c79 2073 7065 6369 6679  manually specify
+0001b940: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
+0001b950: 6461 7461 2077 6974 6820 7468 6520 6060  data with the ``
+0001b960: 6d65 7461 6060 206b 6579 776f 7264 2e20  meta`` keyword. 
+0001b970: 5468 6973 0a20 2020 2020 2020 2063 616e  This.        can
+0001b980: 2062 6520 7370 6563 6966 6965 6420 696e   be specified in
+0001b990: 206d 616e 7920 666f 726d 732c 2066 6f72   many forms, for
+0001b9a0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+0001b9b0: 6e20 7365 650a 2020 2020 2020 2020 6060  n see.        ``
+0001b9c0: 6461 736b 2e64 6174 6166 7261 6d65 2e75  dask.dataframe.u
+0001b9d0: 7469 6c73 2e6d 616b 655f 6d65 7461 6060  tils.make_meta``
+0001b9e0: 2e0a 0a20 2020 2020 2020 2048 6572 6520  ...        Here 
+0001b9f0: 7765 2073 7065 6369 6679 2074 6865 206f  we specify the o
+0001ba00: 7574 7075 7420 6973 2061 2053 6572 6965  utput is a Serie
+0001ba10: 7320 7769 7468 206e 616d 6520 6060 2778  s with name ``'x
+0001ba20: 2760 602c 2061 6e64 2064 7479 7065 0a20  '``, and dtype. 
+0001ba30: 2020 2020 2020 2060 6066 6c6f 6174 3634         ``float64
+0001ba40: 6060 3a0a 0a20 2020 2020 2020 203e 3e3e  ``:..        >>>
+0001ba50: 2072 6573 203d 2064 6466 2e61 7070 6c79   res = ddf.apply
+0001ba60: 286d 7961 6464 2c20 6178 6973 3d31 2c20  (myadd, axis=1, 
+0001ba70: 6172 6773 3d28 322c 292c 2062 3d31 2e35  args=(2,), b=1.5
+0001ba80: 2c20 6d65 7461 3d28 2778 272c 2027 6638  , meta=('x', 'f8
+0001ba90: 2729 290a 0a20 2020 2020 2020 2049 6e20  '))..        In 
+0001baa0: 7468 6520 6361 7365 2077 6865 7265 2074  the case where t
+0001bab0: 6865 206d 6574 6164 6174 6120 646f 6573  he metadata does
+0001bac0: 6e27 7420 6368 616e 6765 2c20 796f 7520  n't change, you 
+0001bad0: 6361 6e20 616c 736f 2070 6173 7320 696e  can also pass in
+0001bae0: 0a20 2020 2020 2020 2074 6865 206f 626a  .        the obj
+0001baf0: 6563 7420 6974 7365 6c66 2064 6972 6563  ect itself direc
+0001bb00: 746c 793a 0a0a 2020 2020 2020 2020 3e3e  tly:..        >>
+0001bb10: 3e20 7265 7320 3d20 6464 662e 6170 706c  > res = ddf.appl
+0001bb20: 7928 6c61 6d62 6461 2072 6f77 3a20 726f  y(lambda row: ro
+0001bb30: 7720 2b20 312c 2061 7869 733d 312c 206d  w + 1, axis=1, m
+0001bb40: 6574 613d 6464 6629 0a0a 2020 2020 2020  eta=ddf)..      
+0001bb50: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+0001bb60: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0001bb70: 2020 2020 4461 7461 4672 616d 652e 6d61      DataFrame.ma
+0001bb80: 705f 7061 7274 6974 696f 6e73 0a20 2020  p_partitions.   
+0001bb90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001bba0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+0001bbb0: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+0001bbc0: 290a 2020 2020 2020 2020 6966 2061 7869  ).        if axi
+0001bbd0: 7320 3d3d 2030 3a0a 2020 2020 2020 2020  s == 0:.        
+0001bbe0: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
+0001bbf0: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
+0001bc00: 6b20 4461 7461 4672 616d 652e 6170 706c  k DataFrame.appl
+0001bc10: 7920 6f6e 6c79 2073 7570 706f 7274 7320  y only supports 
+0001bc20: 6178 6973 3d31 5c6e 220a 2020 2020 2020  axis=1\n".      
+0001bc30: 2020 2020 2020 2020 2020 2220 2054 7279            "  Try
+0001bc40: 3a20 6466 2e61 7070 6c79 2866 756e 632c  : df.apply(func,
+0001bc50: 2061 7869 733d 3129 220a 2020 2020 2020   axis=1)".      
+0001bc60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001bc70: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0001bc80: 6c65 6d65 6e74 6564 4572 726f 7228 6d73  lementedError(ms
+0001bc90: 6729 0a20 2020 2020 2020 2069 6620 6d65  g).        if me
+0001bca0: 7461 2069 7320 6e6f 5f64 6566 6175 6c74  ta is no_default
+0001bcb0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+0001bcc0: 7461 203d 2065 7870 722e 5f65 6d75 6c61  ta = expr._emula
+0001bcd0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+0001bce0: 2020 2020 4d2e 6170 706c 792c 2073 656c      M.apply, sel
+0001bcf0: 662c 2066 756e 6374 696f 6e2c 2061 7267  f, function, arg
+0001bd00: 733d 6172 6773 2c20 7564 663d 5472 7565  s=args, udf=True
+0001bd10: 2c20 6178 6973 3d61 7869 732c 202a 2a6b  , axis=axis, **k
+0001bd20: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+0001bd30: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001bd40: 7761 726e 696e 6773 2e77 6172 6e28 6d65  warnings.warn(me
+0001bd50: 7461 5f77 6172 6e69 6e67 286d 6574 6129  ta_warning(meta)
+0001bd60: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001bd70: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0001bd80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001bd90: 662e 6578 7072 2e61 7070 6c79 2866 756e  f.expr.apply(fun
+0001bda0: 6374 696f 6e2c 202a 6172 6773 2c20 6d65  ction, *args, me
+0001bdb0: 7461 3d6d 6574 612c 2061 7869 733d 6178  ta=meta, axis=ax
+0001bdc0: 6973 2c20 2a2a 6b77 6172 6773 290a 2020  is, **kwargs).  
+0001bdd0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+0001bde0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001bdf0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001be00: 2064 726f 706e 6128 7365 6c66 2c20 686f   dropna(self, ho
+0001be10: 773d 6e6f 5f64 6566 6175 6c74 2c20 7375  w=no_default, su
+0001be20: 6273 6574 3d4e 6f6e 652c 2074 6872 6573  bset=None, thres
+0001be30: 683d 6e6f 5f64 6566 6175 6c74 293a 0a20  h=no_default):. 
+0001be40: 2020 2020 2020 2069 6620 686f 7720 6973         if how is
+0001be50: 206e 6f74 206e 6f5f 6465 6661 756c 7420   not no_default 
+0001be60: 616e 6420 7468 7265 7368 2069 7320 6e6f  and thresh is no
+0001be70: 7420 6e6f 5f64 6566 6175 6c74 3a0a 2020  t no_default:.  
+0001be80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001be90: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+0001bea0: 2020 2020 2020 2020 2020 2022 596f 7520             "You 
+0001beb0: 6361 6e6e 6f74 2073 6574 2062 6f74 6820  cannot set both 
+0001bec0: 7468 6520 686f 7720 616e 6420 7468 7265  the how and thre
+0001bed0: 7368 2061 7267 756d 656e 7473 2061 7420  sh arguments at 
+0001bee0: 7468 6520 7361 6d65 2074 696d 652e 220a  the same time.".
+0001bef0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001bf00: 2020 2020 2020 7375 6273 6574 203d 205f        subset = _
+0001bf10: 636f 6e76 6572 745f 746f 5f6c 6973 7428  convert_to_list(
+0001bf20: 7375 6273 6574 290a 2020 2020 2020 2020  subset).        
+0001bf30: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+0001bf40: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0001bf50: 2020 2065 7870 722e 4472 6f70 6e61 4672     expr.DropnaFr
+0001bf60: 616d 6528 7365 6c66 2c20 686f 773d 686f  ame(self, how=ho
+0001bf70: 772c 2073 7562 7365 743d 7375 6273 6574  w, subset=subset
+0001bf80: 2c20 7468 7265 7368 3d74 6872 6573 6829  , thresh=thresh)
+0001bf90: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001bfa0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+0001bfb0: 2064 6566 205f 7661 6c69 6461 7465 5f61   def _validate_a
+0001bfc0: 7869 7328 636c 732c 2061 7869 733d 302c  xis(cls, axis=0,
+0001bfd0: 206e 756d 6572 6963 5f61 7869 733a 2062   numeric_axis: b
+0001bfe0: 6f6f 6c20 3d20 5472 7565 2920 2d3e 204e  ool = True) -> N
+0001bff0: 6f6e 6520 7c20 4c69 7465 7261 6c5b 302c  one | Literal[0,
+0001c000: 2031 5d3a 0a20 2020 2020 2020 2069 6620   1]:.        if 
+0001c010: 6178 6973 206e 6f74 2069 6e20 2830 2c20  axis not in (0, 
+0001c020: 312c 2022 696e 6465 7822 2c20 2263 6f6c  1, "index", "col
+0001c030: 756d 6e73 222c 204e 6f6e 6529 3a0a 2020  umns", None):.  
+0001c040: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001c050: 5661 6c75 6545 7272 6f72 2866 224e 6f20  ValueError(f"No 
+0001c060: 6178 6973 206e 616d 6564 207b 6178 6973  axis named {axis
+0001c070: 7d22 290a 2020 2020 2020 2020 6966 206e  }").        if n
+0001c080: 756d 6572 6963 5f61 7869 733a 0a20 2020  umeric_axis:.   
+0001c090: 2020 2020 2020 2020 206e 756d 5f61 7869           num_axi
+0001c0a0: 733a 2064 6963 745b 7374 7220 7c20 4e6f  s: dict[str | No
+0001c0b0: 6e65 2c20 4c69 7465 7261 6c5b 302c 2031  ne, Literal[0, 1
+0001c0c0: 5d5d 203d 207b 2269 6e64 6578 223a 2030  ]] = {"index": 0
+0001c0d0: 2c20 2263 6f6c 756d 6e73 223a 2031 7d0a  , "columns": 1}.
+0001c0e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001c0f0: 726e 206e 756d 5f61 7869 732e 6765 7428  rn num_axis.get(
+0001c100: 6178 6973 2c20 6178 6973 290a 2020 2020  axis, axis).    
+0001c110: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001c120: 2020 2020 2020 7265 7475 726e 2061 7869        return axi
+0001c130: 730a 0a20 2020 2040 6465 7269 7665 645f  s..    @derived_
+0001c140: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0001c150: 652c 2075 615f 6172 6773 3d5b 2269 6e64  e, ua_args=["ind
+0001c160: 6578 225d 290a 2020 2020 6465 6620 7265  ex"]).    def re
+0001c170: 6e61 6d65 2873 656c 662c 2069 6e64 6578  name(self, index
+0001c180: 3d4e 6f6e 652c 2063 6f6c 756d 6e73 3d4e  =None, columns=N
+0001c190: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+0001c1a0: 2069 6e64 6578 2069 7320 6e6f 7420 4e6f   index is not No
+0001c1b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001c1c0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001c1d0: 2822 4361 6e6e 6f74 2072 656e 616d 6520  ("Cannot rename 
+0001c1e0: 696e 6465 782e 2229 0a20 2020 2020 2020  index.").       
+0001c1f0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+0001c200: 6563 7469 6f6e 2865 7870 722e 5265 6e61  ection(expr.Rena
+0001c210: 6d65 4672 616d 6528 7365 6c66 2c20 636f  meFrame(self, co
+0001c220: 6c75 6d6e 733d 636f 6c75 6d6e 7329 290a  lumns=columns)).
+0001c230: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0001c240: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0001c250: 0a20 2020 2064 6566 2073 7175 6565 7a65  .    def squeeze
+0001c260: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
+0001c270: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+0001c280: 6973 2069 6e20 5b4e 6f6e 652c 2031 5d3a  is in [None, 1]:
+0001c290: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001c2a0: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
+0001c2b0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+0001c2c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001c2d0: 656c 665b 7365 6c66 2e63 6f6c 756d 6e73  elf[self.columns
+0001c2e0: 5b30 5d5d 0a20 2020 2020 2020 2020 2020  [0]].           
+0001c2f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001c300: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001c310: 6c66 0a0a 2020 2020 2020 2020 656c 6966  lf..        elif
+0001c320: 2061 7869 7320 3d3d 2030 3a0a 2020 2020   axis == 0:.    
+0001c330: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0001c340: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0001c350: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0001c360: 2020 2066 227b 7479 7065 2873 656c 6629     f"{type(self)
+0001c370: 7d20 646f 6573 206e 6f74 2073 7570 706f  } does not suppo
+0001c380: 7274 2073 7175 6565 7a65 2061 6c6f 6e67  rt squeeze along
+0001c390: 2061 7869 7320 3022 0a20 2020 2020 2020   axis 0".       
+0001c3a0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001c3b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001c3c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001c3d0: 6f72 2866 224e 6f20 6178 6973 207b 6178  or(f"No axis {ax
+0001c3e0: 6973 7d20 666f 7220 6f62 6a65 6374 2074  is} for object t
+0001c3f0: 7970 6520 7b74 7970 6528 7365 6c66 297d  ype {type(self)}
+0001c400: 2229 0a0a 2020 2020 4064 6572 6976 6564  ")..    @derived
+0001c410: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0001c420: 6d65 290a 2020 2020 6465 6620 6578 706c  me).    def expl
+0001c430: 6f64 6528 7365 6c66 2c20 636f 6c75 6d6e  ode(self, column
+0001c440: 293a 0a20 2020 2020 2020 2063 6f6c 756d  ):.        colum
+0001c450: 6e20 3d20 5f63 6f6e 7665 7274 5f74 6f5f  n = _convert_to_
+0001c460: 6c69 7374 2863 6f6c 756d 6e29 0a20 2020  list(column).   
+0001c470: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0001c480: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+0001c490: 4578 706c 6f64 6546 7261 6d65 2873 656c  ExplodeFrame(sel
+0001c4a0: 662c 2063 6f6c 756d 6e3d 636f 6c75 6d6e  f, column=column
+0001c4b0: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
+0001c4c0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0001c4d0: 6d65 290a 2020 2020 6465 6620 6472 6f70  me).    def drop
+0001c4e0: 2873 656c 662c 206c 6162 656c 733d 4e6f  (self, labels=No
+0001c4f0: 6e65 2c20 6178 6973 3d30 2c20 636f 6c75  ne, axis=0, colu
+0001c500: 6d6e 733d 4e6f 6e65 2c20 6572 726f 7273  mns=None, errors
+0001c510: 3d22 7261 6973 6522 293a 0a20 2020 2020  ="raise"):.     
+0001c520: 2020 2069 6620 636f 6c75 6d6e 7320 6973     if columns is
+0001c530: 204e 6f6e 6520 616e 6420 6c61 6265 6c73   None and labels
+0001c540: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001c550: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0001c560: 4572 726f 7228 226d 7573 7420 6569 7468  Error("must eith
+0001c570: 6572 2073 7065 6369 6679 2027 636f 6c75  er specify 'colu
+0001c580: 6d6e 7327 206f 7220 276c 6162 656c 7327  mns' or 'labels'
+0001c590: 2229 0a0a 2020 2020 2020 2020 6178 6973  ")..        axis
+0001c5a0: 203d 205f 7661 6c69 6461 7465 5f61 7869   = _validate_axi
+0001c5b0: 7328 6178 6973 290a 0a20 2020 2020 2020  s(axis)..       
+0001c5c0: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+0001c5d0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0001c5e0: 6e73 203d 206c 6162 656c 7320 6f72 2063  ns = labels or c
+0001c5f0: 6f6c 756d 6e73 0a20 2020 2020 2020 2065  olumns.        e
+0001c600: 6c69 6620 6178 6973 203d 3d20 3020 616e  lif axis == 0 an
+0001c610: 6420 636f 6c75 6d6e 7320 6973 204e 6f6e  d columns is Non
+0001c620: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0001c630: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+0001c640: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+0001c650: 2020 2020 2020 2020 2020 2244 726f 7020            "Drop 
+0001c660: 6375 7272 656e 746c 7920 6f6e 6c79 2077  currently only w
+0001c670: 6f72 6b73 2066 6f72 2061 7869 733d 3120  orks for axis=1 
+0001c680: 6f72 2077 6865 6e20 636f 6c75 6d6e 7320  or when columns 
+0001c690: 6973 206e 6f74 204e 6f6e 6522 0a20 2020  is not None".   
+0001c6a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001c6b0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+0001c6c0: 6c6c 6563 7469 6f6e 2865 7870 722e 4472  llection(expr.Dr
+0001c6d0: 6f70 2873 656c 662c 2063 6f6c 756d 6e73  op(self, columns
+0001c6e0: 3d63 6f6c 756d 6e73 2c20 6572 726f 7273  =columns, errors
+0001c6f0: 3d65 7272 6f72 7329 290a 0a20 2020 2064  =errors))..    d
+0001c700: 6566 2074 6f5f 7061 7271 7565 7428 7365  ef to_parquet(se
+0001c710: 6c66 2c20 7061 7468 2c20 2a2a 6b77 6172  lf, path, **kwar
+0001c720: 6773 293a 0a20 2020 2020 2020 2066 726f  gs):.        fro
+0001c730: 6d20 6461 736b 5f65 7870 722e 696f 2e70  m dask_expr.io.p
+0001c740: 6172 7175 6574 2069 6d70 6f72 7420 746f  arquet import to
+0001c750: 5f70 6172 7175 6574 0a0a 2020 2020 2020  _parquet..      
+0001c760: 2020 7265 7475 726e 2074 6f5f 7061 7271    return to_parq
+0001c770: 7565 7428 7365 6c66 2c20 7061 7468 2c20  uet(self, path, 
+0001c780: 2a2a 6b77 6172 6773 290a 0a20 2020 2040  **kwargs)..    @
+0001c790: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001c7a0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001c7b0: 6566 2073 656c 6563 745f 6474 7970 6573  ef select_dtypes
+0001c7c0: 2873 656c 662c 2069 6e63 6c75 6465 3d4e  (self, include=N
+0001c7d0: 6f6e 652c 2065 7863 6c75 6465 3d4e 6f6e  one, exclude=Non
+0001c7e0: 6529 3a0a 2020 2020 2020 2020 636f 6c75  e):.        colu
+0001c7f0: 6d6e 7320 3d20 6c69 7374 280a 2020 2020  mns = list(.    
+0001c800: 2020 2020 2020 2020 7365 6c66 2e5f 6d65          self._me
+0001c810: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+0001c820: 2869 6e63 6c75 6465 3d69 6e63 6c75 6465  (include=include
+0001c830: 2c20 6578 636c 7564 653d 6578 636c 7564  , exclude=exclud
+0001c840: 6529 2e63 6f6c 756d 6e73 0a20 2020 2020  e).columns.     
+0001c850: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+0001c860: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0001c870: 6f6e 2873 656c 662e 6578 7072 5b63 6f6c  on(self.expr[col
+0001c880: 756d 6e73 5d29 0a0a 2020 2020 4064 6572  umns])..    @der
+0001c890: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0001c8a0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0001c8b0: 6576 616c 2873 656c 662c 2065 7870 722c  eval(self, expr,
+0001c8c0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+0001c8d0: 2020 2020 6966 2022 696e 706c 6163 6522      if "inplace"
+0001c8e0: 2069 6e20 6b77 6172 6773 3a0a 2020 2020   in kwargs:.    
+0001c8f0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+0001c900: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+0001c910: 7228 2269 6e70 6c61 6365 2069 7320 6e6f  r("inplace is no
+0001c920: 7420 7375 7070 6f72 7465 6420 666f 7220  t supported for 
+0001c930: 6576 616c 2229 0a20 2020 2020 2020 2072  eval").        r
+0001c940: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0001c950: 7469 6f6e 2845 7661 6c28 7365 6c66 2c20  tion(Eval(self, 
+0001c960: 5f65 7870 723d 6578 7072 2c20 6578 7072  _expr=expr, expr
+0001c970: 5f6b 7761 7267 733d 6b77 6172 6773 2929  _kwargs=kwargs))
+0001c980: 0a0a 2020 2020 6465 6620 7365 745f 696e  ..    def set_in
+0001c990: 6465 7828 0a20 2020 2020 2020 2073 656c  dex(.        sel
+0001c9a0: 662c 0a20 2020 2020 2020 206f 7468 6572  f,.        other
+0001c9b0: 2c0a 2020 2020 2020 2020 6472 6f70 3d54  ,.        drop=T
+0001c9c0: 7275 652c 0a20 2020 2020 2020 2073 6f72  rue,.        sor
+0001c9d0: 7465 643d 4661 6c73 652c 0a20 2020 2020  ted=False,.     
+0001c9e0: 2020 206e 7061 7274 6974 696f 6e73 3a20     npartitions: 
+0001c9f0: 696e 7420 7c20 4e6f 6e65 203d 204e 6f6e  int | None = Non
+0001ca00: 652c 0a20 2020 2020 2020 2064 6976 6973  e,.        divis
+0001ca10: 696f 6e73 3d4e 6f6e 652c 0a20 2020 2020  ions=None,.     
+0001ca20: 2020 2073 6f72 743a 2062 6f6f 6c20 3d20     sort: bool = 
+0001ca30: 5472 7565 2c0a 2020 2020 2020 2020 7368  True,.        sh
+0001ca40: 7566 666c 655f 6d65 7468 6f64 3d4e 6f6e  uffle_method=Non
+0001ca50: 652c 0a20 2020 2020 2020 2075 7073 616d  e,.        upsam
+0001ca60: 706c 653a 2066 6c6f 6174 203d 2031 2e30  ple: float = 1.0
+0001ca70: 2c0a 2020 2020 2020 2020 7061 7274 6974  ,.        partit
+0001ca80: 696f 6e5f 7369 7a65 3a20 666c 6f61 7420  ion_size: float 
+0001ca90: 3d20 3132 3865 362c 0a20 2020 2020 2020  = 128e6,.       
+0001caa0: 2061 7070 656e 643a 2062 6f6f 6c20 3d20   append: bool = 
+0001cab0: 4661 6c73 652c 0a20 2020 2020 2020 202a  False,.        *
+0001cac0: 2a6f 7074 696f 6e73 2c0a 2020 2020 293a  *options,.    ):
+0001cad0: 0a20 2020 2020 2020 2022 2222 5365 7420  .        """Set 
+0001cae0: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
+0001caf0: 6465 7820 2872 6f77 206c 6162 656c 7329  dex (row labels)
+0001cb00: 2075 7369 6e67 2061 6e20 6578 6973 7469   using an existi
+0001cb10: 6e67 2063 6f6c 756d 6e2e 0a0a 2020 2020  ng column...    
+0001cb20: 2020 2020 4966 2060 6073 6f72 743d 4661      If ``sort=Fa
+0001cb30: 6c73 6560 602c 2074 6869 7320 6675 6e63  lse``, this func
+0001cb40: 7469 6f6e 206f 7065 7261 7465 7320 6578  tion operates ex
+0001cb50: 6163 746c 7920 6c69 6b65 2060 6070 616e  actly like ``pan
+0001cb60: 6461 732e 7365 745f 696e 6465 7860 600a  das.set_index``.
+0001cb70: 2020 2020 2020 2020 616e 6420 7365 7473          and sets
+0001cb80: 2074 6865 2069 6e64 6578 206f 6e20 7468   the index on th
+0001cb90: 6520 4461 7461 4672 616d 652e 2049 6620  e DataFrame. If 
+0001cba0: 6060 736f 7274 3d54 7275 6560 6020 2864  ``sort=True`` (d
+0001cbb0: 6566 6175 6c74 292c 0a20 2020 2020 2020  efault),.       
+0001cbc0: 2074 6869 7320 6675 6e63 7469 6f6e 2061   this function a
+0001cbd0: 6c73 6f20 736f 7274 7320 7468 6520 4461  lso sorts the Da
+0001cbe0: 7461 4672 616d 6520 6279 2074 6865 206e  taFrame by the n
+0001cbf0: 6577 2069 6e64 6578 2e20 5468 6973 2063  ew index. This c
+0001cc00: 616e 2068 6176 6520 610a 2020 2020 2020  an have a.      
+0001cc10: 2020 7369 676e 6966 6963 616e 7420 696d    significant im
+0001cc20: 7061 6374 206f 6e20 7065 7266 6f72 6d61  pact on performa
+0001cc30: 6e63 652c 2062 6563 6175 7365 206a 6f69  nce, because joi
+0001cc40: 6e73 2c20 6772 6f75 7062 7973 2c20 6c6f  ns, groupbys, lo
+0001cc50: 6f6b 7570 732c 2065 7463 2e0a 2020 2020  okups, etc..    
+0001cc60: 2020 2020 6172 6520 616c 6c20 6d75 6368      are all much
+0001cc70: 2066 6173 7465 7220 6f6e 2074 6861 7420   faster on that 
+0001cc80: 636f 6c75 6d6e 2e20 486f 7765 7665 722c  column. However,
+0001cc90: 2074 6869 7320 7065 7266 6f72 6d61 6e63   this performanc
+0001cca0: 6520 696e 6372 6561 7365 0a20 2020 2020  e increase.     
+0001ccb0: 2020 2063 6f6d 6573 2077 6974 6820 6120     comes with a 
+0001ccc0: 636f 7374 2c20 736f 7274 696e 6720 6120  cost, sorting a 
+0001ccd0: 7061 7261 6c6c 656c 2064 6174 6173 6574  parallel dataset
+0001cce0: 2072 6571 7569 7265 7320 6578 7065 6e73   requires expens
+0001ccf0: 6976 6520 7368 7566 666c 6573 2e0a 2020  ive shuffles..  
+0001cd00: 2020 2020 2020 4f66 7465 6e20 7765 2060        Often we `
+0001cd10: 6073 6574 5f69 6e64 6578 6060 206f 6e63  `set_index`` onc
+0001cd20: 6520 6469 7265 6374 6c79 2061 6674 6572  e directly after
+0001cd30: 2064 6174 6120 696e 6765 7374 2061 6e64   data ingest and
+0001cd40: 2066 696c 7465 7269 6e67 2061 6e64 0a20   filtering and. 
+0001cd50: 2020 2020 2020 2074 6865 6e20 7065 7266         then perf
+0001cd60: 6f72 6d20 6d61 6e79 2063 6865 6170 2063  orm many cheap c
+0001cd70: 6f6d 7075 7461 7469 6f6e 7320 6f66 6620  omputations off 
+0001cd80: 6f66 2074 6865 2073 6f72 7465 6420 6461  of the sorted da
+0001cd90: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+0001cda0: 5769 7468 2060 6073 6f72 743d 5472 7565  With ``sort=True
+0001cdb0: 6060 2c20 7468 6973 2066 756e 6374 696f  ``, this functio
+0001cdc0: 6e20 6973 206d 7563 6820 6d6f 7265 2065  n is much more e
+0001cdd0: 7870 656e 7369 7665 2e20 556e 6465 7220  xpensive. Under 
+0001cde0: 6e6f 726d 616c 0a20 2020 2020 2020 206f  normal.        o
+0001cdf0: 7065 7261 7469 6f6e 2074 6869 7320 6675  peration this fu
+0001ce00: 6e63 7469 6f6e 2064 6f65 7320 616e 2069  nction does an i
+0001ce10: 6e69 7469 616c 2070 6173 7320 6f76 6572  nitial pass over
+0001ce20: 2074 6865 2069 6e64 6578 2063 6f6c 756d   the index colum
+0001ce30: 6e20 746f 0a20 2020 2020 2020 2063 6f6d  n to.        com
+0001ce40: 7075 7465 2061 7070 726f 7869 6d61 7465  pute approximate
+0001ce50: 2071 7561 6e74 696c 6573 2074 6f20 7365   quantiles to se
+0001ce60: 7276 6520 6173 2066 7574 7572 6520 6469  rve as future di
+0001ce70: 7669 7369 6f6e 732e 2049 7420 7468 656e  visions. It then
+0001ce80: 2070 6173 7365 730a 2020 2020 2020 2020   passes.        
+0001ce90: 6f76 6572 2074 6865 2064 6174 6120 6120  over the data a 
+0001cea0: 7365 636f 6e64 2074 696d 652c 2073 706c  second time, spl
+0001ceb0: 6974 7469 6e67 2075 7020 6561 6368 2069  itting up each i
+0001cec0: 6e70 7574 2070 6172 7469 7469 6f6e 2069  nput partition i
+0001ced0: 6e74 6f20 7365 7665 7261 6c0a 2020 2020  nto several.    
+0001cee0: 2020 2020 7069 6563 6573 2061 6e64 2073      pieces and s
+0001cef0: 6861 7269 6e67 2074 686f 7365 2070 6965  haring those pie
+0001cf00: 6365 7320 746f 2061 6c6c 206f 6620 7468  ces to all of th
+0001cf10: 6520 6f75 7470 7574 2070 6172 7469 7469  e output partiti
+0001cf20: 6f6e 7320 6e6f 7720 696e 0a20 2020 2020  ons now in.     
+0001cf30: 2020 2073 6f72 7465 6420 6f72 6465 722e     sorted order.
+0001cf40: 0a0a 2020 2020 2020 2020 496e 2073 6f6d  ..        In som
+0001cf50: 6520 6361 7365 7320 7765 2063 616e 2061  e cases we can a
+0001cf60: 6c6c 6576 6961 7465 2074 686f 7365 2063  lleviate those c
+0001cf70: 6f73 7473 2c20 666f 7220 6578 616d 706c  osts, for exampl
+0001cf80: 6520 6966 2079 6f75 7220 6461 7461 7365  e if your datase
+0001cf90: 7420 6973 0a20 2020 2020 2020 2073 6f72  t is.        sor
+0001cfa0: 7465 6420 616c 7265 6164 7920 7468 656e  ted already then
+0001cfb0: 2077 6520 6361 6e20 6176 6f69 6420 6d61   we can avoid ma
+0001cfc0: 6b69 6e67 206d 616e 7920 736d 616c 6c20  king many small 
+0001cfd0: 7069 6563 6573 206f 7220 6966 2079 6f75  pieces or if you
+0001cfe0: 206b 6e6f 770a 2020 2020 2020 2020 676f   know.        go
+0001cff0: 6f64 2076 616c 7565 7320 746f 2073 706c  od values to spl
+0001d000: 6974 2074 6865 206e 6577 2069 6e64 6578  it the new index
+0001d010: 2063 6f6c 756d 6e20 7468 656e 2077 6520   column then we 
+0001d020: 6361 6e20 6176 6f69 6420 7468 6520 696e  can avoid the in
+0001d030: 6974 6961 6c0a 2020 2020 2020 2020 7061  itial.        pa
+0001d040: 7373 206f 7665 7220 7468 6520 6461 7461  ss over the data
+0001d050: 2e20 466f 7220 6578 616d 706c 6520 6966  . For example if
+0001d060: 2079 6f75 7220 6e65 7720 696e 6465 7820   your new index 
+0001d070: 6973 2061 2064 6174 6574 696d 6520 696e  is a datetime in
+0001d080: 6465 7820 616e 640a 2020 2020 2020 2020  dex and.        
+0001d090: 796f 7572 2064 6174 6120 6973 2061 6c72  your data is alr
+0001d0a0: 6561 6479 2073 6f72 7465 6420 6279 2064  eady sorted by d
+0001d0b0: 6179 2074 6865 6e20 7468 6973 2065 6e74  ay then this ent
+0001d0c0: 6972 6520 6f70 6572 6174 696f 6e20 6361  ire operation ca
+0001d0d0: 6e20 6265 2064 6f6e 650a 2020 2020 2020  n be done.      
+0001d0e0: 2020 666f 7220 6672 6565 2e20 596f 7520    for free. You 
+0001d0f0: 6361 6e20 636f 6e74 726f 6c20 7468 6573  can control thes
+0001d100: 6520 6f70 7469 6f6e 7320 7769 7468 2074  e options with t
+0001d110: 6865 2066 6f6c 6c6f 7769 6e67 2070 6172  he following par
+0001d120: 616d 6574 6572 732e 0a0a 2020 2020 2020  ameters...      
+0001d130: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0001d140: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0001d150: 2020 2020 2020 2020 6f74 6865 723a 2073          other: s
+0001d160: 7472 696e 6720 6f72 2044 6173 6b20 5365  tring or Dask Se
+0001d170: 7269 6573 0a20 2020 2020 2020 2020 2020  ries.           
+0001d180: 2043 6f6c 756d 6e20 746f 2075 7365 2061   Column to use a
+0001d190: 7320 696e 6465 782e 0a20 2020 2020 2020  s index..       
+0001d1a0: 2064 726f 703a 2062 6f6f 6c65 616e 2c20   drop: boolean, 
+0001d1b0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
+0001d1c0: 2020 2020 2020 2020 2044 656c 6574 6520           Delete 
+0001d1d0: 636f 6c75 6d6e 2074 6f20 6265 2075 7365  column to be use
+0001d1e0: 6420 6173 2074 6865 206e 6577 2069 6e64  d as the new ind
+0001d1f0: 6578 2e0a 2020 2020 2020 2020 736f 7274  ex..        sort
+0001d200: 6564 3a20 626f 6f6c 2c20 6f70 7469 6f6e  ed: bool, option
+0001d210: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+0001d220: 6620 7468 6520 696e 6465 7820 636f 6c75  f the index colu
+0001d230: 6d6e 2069 7320 616c 7265 6164 7920 736f  mn is already so
+0001d240: 7274 6564 2069 6e20 696e 6372 6561 7369  rted in increasi
+0001d250: 6e67 206f 7264 6572 2e0a 2020 2020 2020  ng order..      
+0001d260: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
+0001d270: 6f20 4661 6c73 650a 2020 2020 2020 2020  o False.        
+0001d280: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
+0001d290: 2c20 4e6f 6e65 2c20 6f72 2027 6175 746f  , None, or 'auto
+0001d2a0: 270a 2020 2020 2020 2020 2020 2020 5468  '.            Th
+0001d2b0: 6520 6964 6561 6c20 6e75 6d62 6572 206f  e ideal number o
+0001d2c0: 6620 6f75 7470 7574 2070 6172 7469 7469  f output partiti
+0001d2d0: 6f6e 732e 2049 6620 4e6f 6e65 2c20 7573  ons. If None, us
+0001d2e0: 6520 7468 6520 7361 6d65 2061 730a 2020  e the same as.  
+0001d2f0: 2020 2020 2020 2020 2020 7468 6520 696e            the in
+0001d300: 7075 742e 2049 6620 2761 7574 6f27 2074  put. If 'auto' t
+0001d310: 6865 6e20 6465 6369 6465 2062 7920 6d65  hen decide by me
+0001d320: 6d6f 7279 2075 7365 2e0a 2020 2020 2020  mory use..      
+0001d330: 2020 2020 2020 4f6e 6c79 2075 7365 6420        Only used 
+0001d340: 7768 656e 2060 6064 6976 6973 696f 6e73  when ``divisions
+0001d350: 6060 2069 7320 6e6f 7420 6769 7665 6e2e  `` is not given.
+0001d360: 2049 6620 6060 6469 7669 7369 6f6e 7360   If ``divisions`
+0001d370: 6020 6973 2067 6976 656e 2c0a 2020 2020  ` is given,.    
+0001d380: 2020 2020 2020 2020 7468 6520 6e75 6d62          the numb
+0001d390: 6572 206f 6620 6f75 7470 7574 2070 6172  er of output par
+0001d3a0: 7469 7469 6f6e 7320 7769 6c6c 2062 6520  titions will be 
+0001d3b0: 6060 6c65 6e28 6469 7669 7369 6f6e 7329  ``len(divisions)
+0001d3c0: 202d 2031 6060 2e0a 2020 2020 2020 2020   - 1``..        
+0001d3d0: 6469 7669 7369 6f6e 733a 206c 6973 742c  divisions: list,
+0001d3e0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001d3f0: 2020 2020 2020 5468 6520 2264 6976 6964        The "divid
+0001d400: 696e 6720 6c69 6e65 7322 2075 7365 6420  ing lines" used 
+0001d410: 746f 2073 706c 6974 2074 6865 206e 6577  to split the new
+0001d420: 2069 6e64 6578 2069 6e74 6f20 7061 7274   index into part
+0001d430: 6974 696f 6e73 2e0a 2020 2020 2020 2020  itions..        
+0001d440: 2020 2020 466f 7220 6060 6469 7669 7369      For ``divisi
+0001d450: 6f6e 733d 5b30 2c20 3130 2c20 3530 2c20  ons=[0, 10, 50, 
+0001d460: 3130 305d 6060 2c20 7468 6572 6520 776f  100]``, there wo
+0001d470: 756c 6420 6265 2074 6872 6565 206f 7574  uld be three out
+0001d480: 7075 7420 7061 7274 6974 696f 6e73 2c0a  put partitions,.
+0001d490: 2020 2020 2020 2020 2020 2020 7768 6572              wher
+0001d4a0: 6520 7468 6520 6e65 7720 696e 6465 7820  e the new index 
+0001d4b0: 636f 6e74 6169 6e65 6420 5b30 2c20 3130  contained [0, 10
+0001d4c0: 292c 205b 3130 2c20 3530 292c 2061 6e64  ), [10, 50), and
+0001d4d0: 205b 3530 2c20 3130 3029 2c20 7265 7370   [50, 100), resp
+0001d4e0: 6563 7469 7665 6c79 2e0a 2020 2020 2020  ectively..      
+0001d4f0: 2020 2020 2020 5365 6520 6874 7470 733a        See https:
+0001d500: 2f2f 646f 6373 2e64 6173 6b2e 6f72 672f  //docs.dask.org/
+0001d510: 656e 2f6c 6174 6573 742f 6461 7461 6672  en/latest/datafr
+0001d520: 616d 652d 6465 7369 676e 2e68 746d 6c23  ame-design.html#
+0001d530: 7061 7274 6974 696f 6e73 2e0a 2020 2020  partitions..    
+0001d540: 2020 2020 2020 2020 4966 206e 6f74 2067          If not g
+0001d550: 6976 656e 2028 6465 6661 756c 7429 2c20  iven (default), 
+0001d560: 676f 6f64 2064 6976 6973 696f 6e73 2061  good divisions a
+0001d570: 7265 2063 616c 6375 6c61 7465 6420 6279  re calculated by
+0001d580: 2069 6d6d 6564 6961 7465 6c79 2063 6f6d   immediately com
+0001d590: 7075 7469 6e67 0a20 2020 2020 2020 2020  puting.         
+0001d5a0: 2020 2074 6865 2064 6174 6120 616e 6420     the data and 
+0001d5b0: 6c6f 6f6b 696e 6720 6174 2074 6865 2064  looking at the d
+0001d5c0: 6973 7472 6962 7574 696f 6e20 6f66 2069  istribution of i
+0001d5d0: 7473 2076 616c 7565 732e 2046 6f72 206c  ts values. For l
+0001d5e0: 6172 6765 2064 6174 6173 6574 732c 0a20  arge datasets,. 
+0001d5f0: 2020 2020 2020 2020 2020 2074 6869 7320             this 
+0001d600: 6361 6e20 6265 2065 7870 656e 7369 7665  can be expensive
+0001d610: 2e0a 2020 2020 2020 2020 2020 2020 4e6f  ..            No
+0001d620: 7465 2074 6861 7420 6966 2060 6073 6f72  te that if ``sor
+0001d630: 7465 643d 5472 7565 6060 2c20 7370 6563  ted=True``, spec
+0001d640: 6966 6965 6420 6469 7669 7369 6f6e 7320  ified divisions 
+0001d650: 6172 6520 6173 7375 6d65 6420 746f 206d  are assumed to m
+0001d660: 6174 6368 0a20 2020 2020 2020 2020 2020  atch.           
+0001d670: 2074 6865 2065 7869 7374 696e 6720 7061   the existing pa
+0001d680: 7274 6974 696f 6e73 2069 6e20 7468 6520  rtitions in the 
+0001d690: 6461 7461 3b20 6966 2074 6869 7320 6973  data; if this is
+0001d6a0: 2075 6e74 7275 6520 796f 7520 7368 6f75   untrue you shou
+0001d6b0: 6c64 0a20 2020 2020 2020 2020 2020 206c  ld.            l
+0001d6c0: 6561 7665 2064 6976 6973 696f 6e73 2065  eave divisions e
+0001d6d0: 6d70 7479 2061 6e64 2063 616c 6c20 6060  mpty and call ``
+0001d6e0: 7265 7061 7274 6974 696f 6e60 6020 6166  repartition`` af
+0001d6f0: 7465 7220 6060 7365 745f 696e 6465 7860  ter ``set_index`
+0001d700: 602e 0a20 2020 2020 2020 2069 6e70 6c61  `..        inpla
+0001d710: 6365 3a20 626f 6f6c 2c20 6f70 7469 6f6e  ce: bool, option
+0001d720: 616c 0a20 2020 2020 2020 2020 2020 204d  al.            M
+0001d730: 6f64 6966 7969 6e67 2074 6865 2044 6174  odifying the Dat
+0001d740: 6146 7261 6d65 2069 6e20 706c 6163 6520  aFrame in place 
+0001d750: 6973 206e 6f74 2073 7570 706f 7274 6564  is not supported
+0001d760: 2062 7920 4461 736b 2e0a 2020 2020 2020   by Dask..      
+0001d770: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
+0001d780: 6f20 4661 6c73 652e 0a20 2020 2020 2020  o False..       
+0001d790: 2073 6f72 743a 2062 6f6f 6c2c 206f 7074   sort: bool, opt
+0001d7a0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0001d7b0: 2020 4966 2060 6054 7275 6560 602c 2073    If ``True``, s
+0001d7c0: 6f72 7420 7468 6520 4461 7461 4672 616d  ort the DataFram
+0001d7d0: 6520 6279 2074 6865 206e 6577 2069 6e64  e by the new ind
+0001d7e0: 6578 2e20 4f74 6865 7277 6973 650a 2020  ex. Otherwise.  
+0001d7f0: 2020 2020 2020 2020 2020 7365 7420 7468            set th
+0001d800: 6520 696e 6465 7820 6f6e 2074 6865 2069  e index on the i
+0001d810: 6e64 6976 6964 7561 6c20 6578 6973 7469  ndividual existi
+0001d820: 6e67 2070 6172 7469 7469 6f6e 732e 0a20  ng partitions.. 
+0001d830: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+0001d840: 6c74 7320 746f 2060 6054 7275 6560 602e  lts to ``True``.
+0001d850: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+0001d860: 5f6d 6574 686f 643a 207b 2764 6973 6b27  _method: {'disk'
+0001d870: 2c20 2774 6173 6b73 272c 2027 7032 7027  , 'tasks', 'p2p'
+0001d880: 7d2c 206f 7074 696f 6e61 6c0a 2020 2020  }, optional.    
+0001d890: 2020 2020 2020 2020 4569 7468 6572 2060          Either `
+0001d8a0: 6027 6469 736b 2760 6020 666f 7220 7369  `'disk'`` for si
+0001d8b0: 6e67 6c65 2d6e 6f64 6520 6f70 6572 6174  ngle-node operat
+0001d8c0: 696f 6e20 6f72 2060 6027 7461 736b 7327  ion or ``'tasks'
+0001d8d0: 6060 2061 6e64 0a20 2020 2020 2020 2020  `` and.         
+0001d8e0: 2020 2060 6027 7032 7027 6060 2066 6f72     ``'p2p'`` for
+0001d8f0: 2064 6973 7472 6962 7574 6564 206f 7065   distributed ope
+0001d900: 7261 7469 6f6e 2e20 2057 696c 6c20 6265  ration.  Will be
+0001d910: 2069 6e66 6572 7265 6420 6279 2079 6f75   inferred by you
+0001d920: 720a 2020 2020 2020 2020 2020 2020 6375  r.            cu
+0001d930: 7272 656e 7420 7363 6865 6475 6c65 722e  rrent scheduler.
+0001d940: 0a20 2020 2020 2020 2063 6f6d 7075 7465  .        compute
+0001d950: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+0001d960: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+0001d970: 2020 5768 6574 6865 7220 6f72 206e 6f74    Whether or not
+0001d980: 2074 6f20 7472 6967 6765 7220 616e 2069   to trigger an i
+0001d990: 6d6d 6564 6961 7465 2063 6f6d 7075 7461  mmediate computa
+0001d9a0: 7469 6f6e 2e20 4465 6661 756c 7473 2074  tion. Defaults t
+0001d9b0: 6f20 4661 6c73 652e 0a20 2020 2020 2020  o False..       
+0001d9c0: 2020 2020 204e 6f74 652c 2074 6861 7420       Note, that 
+0001d9d0: 6576 656e 2069 6620 796f 7520 7365 7420  even if you set 
+0001d9e0: 6060 636f 6d70 7574 653d 4661 6c73 6560  ``compute=False`
+0001d9f0: 602c 2061 6e20 696d 6d65 6469 6174 6520  `, an immediate 
+0001da00: 636f 6d70 7574 6174 696f 6e0a 2020 2020  computation.    
+0001da10: 2020 2020 2020 2020 7769 6c6c 2073 7469          will sti
+0001da20: 6c6c 2062 6520 7472 6967 6765 7265 6420  ll be triggered 
+0001da30: 6966 2060 6064 6976 6973 696f 6e73 6060  if ``divisions``
+0001da40: 2069 7320 6060 4e6f 6e65 6060 2e0a 2020   is ``None``..  
+0001da50: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+0001da60: 7369 7a65 3a20 696e 742c 206f 7074 696f  size: int, optio
+0001da70: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0001da80: 4465 7369 7265 6420 7369 7a65 206f 6620  Desired size of 
+0001da90: 6561 6368 2070 6172 7469 7469 6f6e 7320  each partitions 
+0001daa0: 696e 2062 7974 6573 2e0a 2020 2020 2020  in bytes..      
+0001dab0: 2020 2020 2020 4f6e 6c79 2075 7365 6420        Only used 
+0001dac0: 7768 656e 2060 606e 7061 7274 6974 696f  when ``npartitio
+0001dad0: 6e73 3d27 6175 746f 2760 600a 0a20 2020  ns='auto'``..   
+0001dae0: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+0001daf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0001db00: 2020 2020 2020 203e 3e3e 2069 6d70 6f72         >>> impor
+0001db10: 7420 6461 736b 0a20 2020 2020 2020 203e  t dask.        >
+0001db20: 3e3e 2064 6466 203d 2064 6173 6b2e 6461  >> ddf = dask.da
+0001db30: 7461 7365 7473 2e74 696d 6573 6572 6965  tasets.timeserie
+0001db40: 7328 7374 6172 743d 2232 3032 312d 3031  s(start="2021-01
+0001db50: 2d30 3122 2c20 656e 643d 2232 3032 312d  -01", end="2021-
+0001db60: 3031 2d30 3722 2c20 6672 6571 3d22 3168  01-07", freq="1h
+0001db70: 2229 2e72 6573 6574 5f69 6e64 6578 2829  ").reset_index()
+0001db80: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+0001db90: 3220 3d20 6464 662e 7365 745f 696e 6465  2 = ddf.set_inde
+0001dba0: 7828 2278 2229 0a20 2020 2020 2020 203e  x("x").        >
+0001dbb0: 3e3e 2064 6466 3220 3d20 6464 662e 7365  >> ddf2 = ddf.se
+0001dbc0: 745f 696e 6465 7828 6464 662e 7829 0a20  t_index(ddf.x). 
+0001dbd0: 2020 2020 2020 203e 3e3e 2064 6466 3220         >>> ddf2 
+0001dbe0: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+0001dbf0: 6464 662e 7469 6d65 7374 616d 702c 2073  ddf.timestamp, s
+0001dc00: 6f72 7465 643d 5472 7565 290a 0a20 2020  orted=True)..   
+0001dc10: 2020 2020 2041 2063 6f6d 6d6f 6e20 6361       A common ca
+0001dc20: 7365 2069 7320 7768 656e 2077 6520 6861  se is when we ha
+0001dc30: 7665 2061 2064 6174 6574 696d 6520 636f  ve a datetime co
+0001dc40: 6c75 6d6e 2074 6861 7420 7765 206b 6e6f  lumn that we kno
+0001dc50: 7720 746f 2062 650a 2020 2020 2020 2020  w to be.        
+0001dc60: 736f 7274 6564 2061 6e64 2069 7320 636c  sorted and is cl
+0001dc70: 6561 6e6c 7920 6469 7669 6465 6420 6279  eanly divided by
+0001dc80: 2064 6179 2e20 2057 6520 6361 6e20 7365   day.  We can se
+0001dc90: 7420 7468 6973 2069 6e64 6578 2066 6f72  t this index for
+0001dca0: 2066 7265 650a 2020 2020 2020 2020 6279   free.        by
+0001dcb0: 2073 7065 6369 6679 696e 6720 626f 7468   specifying both
+0001dcc0: 2074 6861 7420 7468 6520 636f 6c75 6d6e   that the column
+0001dcd0: 2069 7320 7072 652d 736f 7274 6564 2061   is pre-sorted a
+0001dce0: 6e64 2074 6865 2070 6172 7469 6375 6c61  nd the particula
+0001dcf0: 720a 2020 2020 2020 2020 6469 7669 7369  r.        divisi
+0001dd00: 6f6e 7320 616c 6f6e 6720 7768 6963 6820  ons along which 
+0001dd10: 6973 2069 7320 7365 7061 7261 7465 640a  is is separated.
+0001dd20: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+0001dd30: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+0001dd40: 0a20 2020 2020 2020 203e 3e3e 2064 6976  .        >>> div
+0001dd50: 6973 696f 6e73 203d 2070 642e 6461 7465  isions = pd.date
+0001dd60: 5f72 616e 6765 2873 7461 7274 3d22 3230  _range(start="20
+0001dd70: 3231 2d30 312d 3031 222c 2065 6e64 3d22  21-01-01", end="
+0001dd80: 3230 3231 2d30 312d 3037 222c 2066 7265  2021-01-07", fre
+0001dd90: 713d 2731 4427 290a 2020 2020 2020 2020  q='1D').        
+0001dda0: 3e3e 3e20 6469 7669 7369 6f6e 730a 2020  >>> divisions.  
+0001ddb0: 2020 2020 2020 4461 7465 7469 6d65 496e        DatetimeIn
+0001ddc0: 6465 7828 5b27 3230 3231 2d30 312d 3031  dex(['2021-01-01
+0001ddd0: 272c 2027 3230 3231 2d30 312d 3032 272c  ', '2021-01-02',
+0001dde0: 2027 3230 3231 2d30 312d 3033 272c 2027   '2021-01-03', '
+0001ddf0: 3230 3231 2d30 312d 3034 272c 0a20 2020  2021-01-04',.   
+0001de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de10: 2020 2020 2732 3032 312d 3031 2d30 3527      '2021-01-05'
+0001de20: 2c20 2732 3032 312d 3031 2d30 3627 2c20  , '2021-01-06', 
+0001de30: 2732 3032 312d 3031 2d30 3727 5d2c 0a20  '2021-01-07'],. 
+0001de40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de50: 2020 2020 2064 7479 7065 3d27 6461 7465       dtype='date
+0001de60: 7469 6d65 3634 5b6e 735d 272c 2066 7265  time64[ns]', fre
+0001de70: 713d 2744 2729 0a0a 2020 2020 2020 2020  q='D')..        
+0001de80: 4e6f 7465 2074 6861 7420 6060 6c65 6e28  Note that ``len(
+0001de90: 6469 7669 736f 6e73 2960 6020 6973 2065  divisons)`` is e
+0001dea0: 7175 616c 2074 6f20 6060 6e70 6172 7469  qual to ``nparti
+0001deb0: 7469 6f6e 7320 2b20 3160 602e 2054 6869  tions + 1``. Thi
+0001dec0: 7320 6973 2062 6563 6175 7365 2060 6064  s is because ``d
+0001ded0: 6976 6973 696f 6e73 6060 0a20 2020 2020  ivisions``.     
+0001dee0: 2020 2072 6570 7265 7365 6e74 7320 7468     represents th
+0001def0: 6520 7570 7065 7220 616e 6420 6c6f 7765  e upper and lowe
+0001df00: 7220 626f 756e 6473 206f 6620 6561 6368  r bounds of each
+0001df10: 2070 6172 7469 7469 6f6e 2e20 5468 6520   partition. The 
+0001df20: 6669 7273 7420 6974 656d 2069 7320 7468  first item is th
+0001df30: 650a 2020 2020 2020 2020 6c6f 7765 7220  e.        lower 
+0001df40: 626f 756e 6420 6f66 2074 6865 2066 6972  bound of the fir
+0001df50: 7374 2070 6172 7469 7469 6f6e 2c20 7468  st partition, th
+0001df60: 6520 7365 636f 6e64 2069 7465 6d20 6973  e second item is
+0001df70: 2074 6865 206c 6f77 6572 2062 6f75 6e64   the lower bound
+0001df80: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+0001df90: 7365 636f 6e64 2070 6172 7469 7469 6f6e  second partition
+0001dfa0: 2061 6e64 2074 6865 2075 7070 6572 2062   and the upper b
+0001dfb0: 6f75 6e64 206f 6620 7468 6520 6669 7273  ound of the firs
+0001dfc0: 7420 7061 7274 6974 696f 6e2c 2061 6e64  t partition, and
+0001dfd0: 2073 6f20 6f6e 2e0a 2020 2020 2020 2020   so on..        
+0001dfe0: 5468 6520 7365 636f 6e64 2d74 6f2d 6c61  The second-to-la
+0001dff0: 7374 2069 7465 6d20 6973 2074 6865 206c  st item is the l
+0001e000: 6f77 6572 2062 6f75 6e64 206f 6620 7468  ower bound of th
+0001e010: 6520 6c61 7374 2070 6172 7469 7469 6f6e  e last partition
+0001e020: 2c20 616e 6420 7468 6520 6c61 7374 0a20  , and the last. 
+0001e030: 2020 2020 2020 2028 6578 7472 6129 2069         (extra) i
+0001e040: 7465 6d20 6973 2074 6865 2075 7070 6572  tem is the upper
+0001e050: 2062 6f75 6e64 206f 6620 7468 6520 6c61   bound of the la
+0001e060: 7374 2070 6172 7469 7469 6f6e 2e0a 0a20  st partition... 
+0001e070: 2020 2020 2020 203e 3e3e 2064 6466 3220         >>> ddf2 
+0001e080: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+0001e090: 2274 696d 6573 7461 6d70 222c 2073 6f72  "timestamp", sor
+0001e0a0: 7465 643d 5472 7565 2c20 6469 7669 7369  ted=True, divisi
+0001e0b0: 6f6e 733d 6469 7669 7369 6f6e 732e 746f  ons=divisions.to
+0001e0c0: 6c69 7374 2829 290a 0a20 2020 2020 2020  list())..       
+0001e0d0: 2049 6620 796f 7527 6c6c 2062 6520 7275   If you'll be ru
+0001e0e0: 6e6e 696e 6720 6073 6574 5f69 6e64 6578  nning `set_index
+0001e0f0: 6020 6f6e 2074 6865 2073 616d 6520 286f  ` on the same (o
+0001e100: 7220 7369 6d69 6c61 7229 2064 6174 6173  r similar) datas
+0001e110: 6574 7320 7265 7065 6174 6564 6c79 2c0a  ets repeatedly,.
+0001e120: 2020 2020 2020 2020 796f 7520 636f 756c          you coul
+0001e130: 6420 7361 7665 2074 696d 6520 6279 206c  d save time by l
+0001e140: 6574 7469 6e67 2044 6173 6b20 6361 6c63  etting Dask calc
+0001e150: 756c 6174 6520 676f 6f64 2064 6976 6973  ulate good divis
+0001e160: 696f 6e73 206f 6e63 652c 2074 6865 6e20  ions once, then 
+0001e170: 636f 7079 2d70 6173 7469 6e67 0a20 2020  copy-pasting.   
+0001e180: 2020 2020 2074 6865 6d20 746f 2072 6575       them to reu
+0001e190: 7365 2e20 5468 6973 2069 7320 6573 7065  se. This is espe
+0001e1a0: 6369 616c 6c79 2068 656c 7066 756c 2072  cially helpful r
+0001e1b0: 756e 6e69 6e67 2069 6e20 6120 4a75 7079  unning in a Jupy
+0001e1c0: 7465 7220 6e6f 7465 626f 6f6b 3a0a 0a20  ter notebook:.. 
+0001e1d0: 2020 2020 2020 203e 3e3e 2064 6466 3220         >>> ddf2 
+0001e1e0: 3d20 6464 662e 7365 745f 696e 6465 7828  = ddf.set_index(
+0001e1f0: 226e 616d 6522 2920 2023 2073 6c6f 772c  "name")  # slow,
+0001e200: 2063 616c 6375 6c61 7465 7320 6461 7461   calculates data
+0001e210: 2064 6973 7472 6962 7574 696f 6e0a 2020   distribution.  
+0001e220: 2020 2020 2020 3e3e 3e20 6464 6632 2e64        >>> ddf2.d
+0001e230: 6976 6973 696f 6e73 2020 2320 646f 6374  ivisions  # doct
+0001e240: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0001e250: 2020 205b 2241 6c69 6365 222c 2022 4c61     ["Alice", "La
+0001e260: 7572 6122 2c20 2255 7273 756c 6122 2c20  ura", "Ursula", 
+0001e270: 225a 656c 6461 225d 0a20 2020 2020 2020  "Zelda"].       
+0001e280: 203e 3e3e 2023 205e 204e 6f77 2063 6f70   >>> # ^ Now cop
+0001e290: 792d 7061 7374 6520 7468 6973 2061 6e64  y-paste this and
+0001e2a0: 2065 6469 7420 7468 6520 6c69 6e65 2061   edit the line a
+0001e2b0: 626f 7665 2074 6f3a 0a20 2020 2020 2020  bove to:.       
+0001e2c0: 203e 3e3e 2023 2064 6466 3220 3d20 6464   >>> # ddf2 = dd
+0001e2d0: 662e 7365 745f 696e 6465 7828 226e 616d  f.set_index("nam
+0001e2e0: 6522 2c20 6469 7669 7369 6f6e 733d 5b22  e", divisions=["
+0001e2f0: 416c 6963 6522 2c20 224c 6175 7261 222c  Alice", "Laura",
+0001e300: 2022 5572 7375 6c61 222c 2022 5a65 6c64   "Ursula", "Zeld
+0001e310: 6122 5d29 0a20 2020 2020 2020 2022 2222  a"]).        """
+0001e320: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001e330: 7374 616e 6365 286f 7468 6572 2c20 6c69  stance(other, li
+0001e340: 7374 2920 616e 6420 6c65 6e28 6f74 6865  st) and len(othe
+0001e350: 7229 203d 3d20 313a 0a20 2020 2020 2020  r) == 1:.       
+0001e360: 2020 2020 206f 7468 6572 203d 206f 7468       other = oth
+0001e370: 6572 5b30 5d0a 2020 2020 2020 2020 6966  er[0].        if
+0001e380: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+0001e390: 722c 206c 6973 7429 3a0a 2020 2020 2020  r, list):.      
+0001e3a0: 2020 2020 2020 6966 2061 6e79 285b 6973        if any([is
+0001e3b0: 696e 7374 616e 6365 2863 2c20 4672 616d  instance(c, Fram
+0001e3c0: 6542 6173 6529 2066 6f72 2063 2069 6e20  eBase) for c in 
+0001e3d0: 6f74 6865 725d 293a 0a20 2020 2020 2020  other]):.       
+0001e3e0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0001e3f0: 7970 6545 7272 6f72 2822 4c69 7374 5b46  ypeError("List[F
+0001e400: 7261 6d65 4261 7365 5d20 6e6f 7420 7375  rameBase] not su
+0001e410: 7070 6f72 7465 6420 6279 2073 6574 5f69  pported by set_i
+0001e420: 6e64 6578 2229 0a20 2020 2020 2020 2020  ndex").         
+0001e430: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001e440: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0001e450: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0001e460: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0001e470: 2020 2020 2020 2020 2244 6173 6b20 6461          "Dask da
+0001e480: 7461 6672 616d 6520 646f 6573 206e 6f74  taframe does not
+0001e490: 2079 6574 2073 7570 706f 7274 206d 756c   yet support mul
+0001e4a0: 7469 2d69 6e64 6578 6573 2e5c 6e22 0a20  ti-indexes.\n". 
+0001e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e4c0: 2020 2066 2259 6f75 2074 7269 6564 2074     f"You tried t
+0001e4d0: 6f20 696e 6465 7820 7769 7468 2074 6869  o index with thi
+0001e4e0: 7320 696e 6465 783a 207b 6f74 6865 727d  s index: {other}
+0001e4f0: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
+0001e500: 2020 2020 2020 2020 2249 6e64 6578 6573          "Indexes
+0001e510: 206d 7573 7420 6265 2073 696e 676c 6520   must be single 
+0001e520: 636f 6c75 6d6e 7320 6f6e 6c79 2e22 0a20  columns only.". 
+0001e530: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001e540: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0001e550: 7374 616e 6365 286f 7468 6572 2c20 4461  stance(other, Da
+0001e560: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
+0001e570: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0001e580: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0001e590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e5a0: 2022 4461 736b 2064 6174 6166 7261 6d65   "Dask dataframe
+0001e5b0: 2064 6f65 7320 6e6f 7420 7965 7420 7375   does not yet su
+0001e5c0: 7070 6f72 7420 6d75 6c74 692d 696e 6465  pport multi-inde
+0001e5d0: 7865 732e 5c6e 220a 2020 2020 2020 2020  xes.\n".        
+0001e5e0: 2020 2020 2020 2020 6622 596f 7520 7472          f"You tr
+0001e5f0: 6965 6420 746f 2069 6e64 6578 2077 6974  ied to index wit
+0001e600: 6820 6120 6672 616d 6520 7769 7468 2074  h a frame with t
+0001e610: 6865 7365 2063 6f6c 756d 6e73 3a20 7b6c  hese columns: {l
+0001e620: 6973 7428 6f74 6865 722e 636f 6c75 6d6e  ist(other.column
+0001e630: 7329 7d5c 6e22 0a20 2020 2020 2020 2020  s)}\n".         
+0001e640: 2020 2020 2020 2022 496e 6465 7865 7320         "Indexes 
+0001e650: 6d75 7374 2062 6520 7369 6e67 6c65 2063  must be single c
+0001e660: 6f6c 756d 6e73 206f 6e6c 792e 220a 2020  olumns only.".  
+0001e670: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001e680: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001e690: 6528 6f74 6865 722c 2053 6572 6965 7329  e(other, Series)
+0001e6a0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0001e6b0: 206f 7468 6572 2e5f 6e61 6d65 203d 3d20   other._name == 
+0001e6c0: 7365 6c66 2e69 6e64 6578 2e5f 6e61 6d65  self.index._name
+0001e6d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001e6e0: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
+0001e6f0: 2020 2020 2020 656c 6966 206f 7468 6572        elif other
+0001e700: 203d 3d20 7365 6c66 2e69 6e64 6578 2e6e   == self.index.n
+0001e710: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+0001e720: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+0001e730: 2020 2020 2020 6966 2064 6976 6973 696f        if divisio
+0001e740: 6e73 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ns is not None:.
+0001e750: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+0001e760: 6b5f 6469 7669 7369 6f6e 7328 6469 7669  k_divisions(divi
+0001e770: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
+0001e780: 6966 2028 736f 7274 6564 206f 7220 6e6f  if (sorted or no
+0001e790: 7420 736f 7274 2920 616e 6420 6e70 6172  t sort) and npar
+0001e7a0: 7469 7469 6f6e 7320 6973 206e 6f74 204e  titions is not N
+0001e7b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001e7c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001e7d0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0001e7e0: 2020 2022 5370 6563 6966 7969 6e67 206e     "Specifying n
+0001e7f0: 7061 7274 6974 696f 6e73 2077 6974 6820  partitions with 
+0001e800: 736f 7274 3d46 616c 7365 206f 7220 736f  sort=False or so
+0001e810: 7274 6564 3d54 7275 6520 6973 206e 6f74  rted=True is not
+0001e820: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0001e830: 2020 2022 7375 7070 6f72 7465 642e 2043     "supported. C
+0001e840: 616c 6c20 6072 6570 6172 7469 7469 6f6e  all `repartition
+0001e850: 6020 6166 7465 7277 6172 6473 2e22 0a20  ` afterwards.". 
+0001e860: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0001e870: 2020 2020 2020 6966 2073 6f72 7465 643a        if sorted:
+0001e880: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001e890: 6469 7669 7369 6f6e 7320 6973 206e 6f74  divisions is not
+0001e8a0: 204e 6f6e 6520 616e 6420 6c65 6e28 6469   None and len(di
+0001e8b0: 7669 7369 6f6e 7329 202d 2031 2021 3d20  visions) - 1 != 
+0001e8c0: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+0001e8d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001e8e0: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
+0001e8f0: 2020 2020 2020 2020 2020 2020 2020 2257                "W
+0001e900: 6865 6e20 646f 696e 6720 6064 662e 7365  hen doing `df.se
+0001e910: 745f 696e 6465 7828 636f 6c2c 2073 6f72  t_index(col, sor
+0001e920: 7465 643d 5472 7565 2c20 6469 7669 7369  ted=True, divisi
+0001e930: 6f6e 733d 2e2e 2e29 602c 2022 0a20 2020  ons=...)`, ".   
+0001e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e950: 2022 6469 7669 7369 6f6e 7320 696e 6469   "divisions indi
+0001e960: 6361 7465 7320 6b6e 6f77 6e20 7370 6c69  cates known spli
+0001e970: 7473 2069 6e20 7468 6520 696e 6465 7820  ts in the index 
+0001e980: 636f 6c75 6d6e 2e20 496e 2074 6869 7320  column. In this 
+0001e990: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001e9a0: 2020 2020 2020 2263 6173 6520 6469 7669        "case divi
+0001e9b0: 7369 6f6e 7320 6d75 7374 2062 6520 7468  sions must be th
+0001e9c0: 6520 7361 6d65 206c 656e 6774 6820 6173  e same length as
+0001e9d0: 2074 6865 2065 7869 7374 696e 6720 220a   the existing ".
+0001e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9f0: 2020 2020 2264 6976 6973 696f 6e73 2069      "divisions i
+0001ea00: 6e20 6064 6660 5c6e 5c6e 220a 2020 2020  n `df`\n\n".    
+0001ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea20: 2249 6620 7468 6520 696e 7465 6e74 2069  "If the intent i
+0001ea30: 7320 746f 2072 6570 6172 7469 7469 6f6e  s to repartition
+0001ea40: 2069 6e74 6f20 6e65 7720 6469 7669 7369   into new divisi
+0001ea50: 6f6e 7320 6166 7465 7220 220a 2020 2020  ons after ".    
+0001ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea70: 2273 6574 7469 6e67 2074 6865 2069 6e64  "setting the ind
+0001ea80: 6578 2c20 796f 7520 7072 6f62 6162 6c79  ex, you probably
+0001ea90: 2077 616e 743a 5c6e 5c6e 220a 2020 2020   want:\n\n".    
+0001eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eab0: 2260 6466 2e73 6574 5f69 6e64 6578 2863  "`df.set_index(c
+0001eac0: 6f6c 2c20 736f 7274 6564 3d54 7275 6529  ol, sorted=True)
+0001ead0: 2e72 6570 6172 7469 7469 6f6e 2864 6976  .repartition(div
+0001eae0: 6973 696f 6e73 3d64 6976 6973 696f 6e73  isions=divisions
+0001eaf0: 2960 220a 2020 2020 2020 2020 2020 2020  )`".            
+0001eb00: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0001eb10: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0001eb20: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
+0001eb30: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+0001eb40: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+0001eb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eb60: 2053 6574 496e 6465 7842 6c6f 636b 7769   SetIndexBlockwi
+0001eb70: 7365 280a 2020 2020 2020 2020 2020 2020  se(.            
+0001eb80: 2020 2020 2020 2020 7365 6c66 2c20 6f74          self, ot
+0001eb90: 6865 722c 2064 726f 702c 206e 6577 5f64  her, drop, new_d
+0001eba0: 6976 6973 696f 6e73 3d64 6976 6973 696f  ivisions=divisio
+0001ebb0: 6e73 2c20 6170 7065 6e64 3d61 7070 656e  ns, append=appen
+0001ebc0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0001ebd0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001ebe0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0001ebf0: 7475 726e 2072 6573 756c 742e 636f 6d70  turn result.comp
+0001ec00: 7574 655f 6375 7272 656e 745f 6469 7669  ute_current_divi
+0001ec10: 7369 6f6e 7328 7365 745f 6469 7669 7369  sions(set_divisi
+0001ec20: 6f6e 733d 5472 7565 290a 2020 2020 2020  ons=True).      
+0001ec30: 2020 656c 6966 206e 6f74 2073 6f72 743a    elif not sort:
+0001ec40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001ec50: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+0001ec60: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+0001ec70: 2020 2020 5365 7449 6e64 6578 426c 6f63      SetIndexBloc
+0001ec80: 6b77 6973 6528 7365 6c66 2c20 6f74 6865  kwise(self, othe
+0001ec90: 722c 2064 726f 702c 204e 6f6e 652c 2061  r, drop, None, a
+0001eca0: 7070 656e 643d 6170 7065 6e64 290a 2020  ppend=append).  
+0001ecb0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001ecc0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0001ecd0: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+0001ece0: 2020 2020 2020 2020 5365 7449 6e64 6578          SetIndex
+0001ecf0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001ed00: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001ed10: 2020 2020 2020 2020 6f74 6865 722c 0a20          other,. 
+0001ed20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001ed30: 726f 702c 0a20 2020 2020 2020 2020 2020  rop,.           
+0001ed40: 2020 2020 2075 7365 725f 6469 7669 7369       user_divisi
+0001ed50: 6f6e 733d 6469 7669 7369 6f6e 732c 0a20  ons=divisions,. 
+0001ed60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001ed70: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
+0001ed80: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+0001ed90: 2020 2020 2020 2020 7570 7361 6d70 6c65          upsample
+0001eda0: 3d75 7073 616d 706c 652c 0a20 2020 2020  =upsample,.     
+0001edb0: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+0001edc0: 7469 6f6e 5f73 697a 653d 7061 7274 6974  tion_size=partit
+0001edd0: 696f 6e5f 7369 7a65 2c0a 2020 2020 2020  ion_size,.      
+0001ede0: 2020 2020 2020 2020 2020 7368 7566 666c            shuffl
+0001edf0: 655f 6d65 7468 6f64 3d67 6574 5f73 7065  e_method=get_spe
+0001ee00: 6369 6669 6564 5f73 6875 6666 6c65 2873  cified_shuffle(s
+0001ee10: 6875 6666 6c65 5f6d 6574 686f 6429 2c0a  huffle_method),.
+0001ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee30: 6170 7065 6e64 3d61 7070 656e 642c 0a20  append=append,. 
+0001ee40: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0001ee50: 7074 696f 6e73 3d6f 7074 696f 6e73 2c0a  ptions=options,.
+0001ee60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001ee70: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0001ee80: 2073 6f72 745f 7661 6c75 6573 280a 2020   sort_values(.  
+0001ee90: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001eea0: 2020 2020 6279 3a20 7374 7220 7c20 6c69      by: str | li
+0001eeb0: 7374 5b73 7472 5d2c 0a20 2020 2020 2020  st[str],.       
+0001eec0: 206e 7061 7274 6974 696f 6e73 3a20 696e   npartitions: in
+0001eed0: 7420 7c20 4e6f 6e65 203d 204e 6f6e 652c  t | None = None,
+0001eee0: 0a20 2020 2020 2020 2061 7363 656e 6469  .        ascendi
+0001eef0: 6e67 3a20 626f 6f6c 207c 206c 6973 745b  ng: bool | list[
+0001ef00: 626f 6f6c 5d20 3d20 5472 7565 2c0a 2020  bool] = True,.  
+0001ef10: 2020 2020 2020 6e61 5f70 6f73 6974 696f        na_positio
+0001ef20: 6e3a 204c 6974 6572 616c 5b22 6669 7273  n: Literal["firs
+0001ef30: 7422 5d20 7c20 4c69 7465 7261 6c5b 226c  t"] | Literal["l
+0001ef40: 6173 7422 5d20 3d20 226c 6173 7422 2c0a  ast"] = "last",.
+0001ef50: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+0001ef60: 6e5f 7369 7a65 3a20 666c 6f61 7420 3d20  n_size: float = 
+0001ef70: 3132 3865 362c 0a20 2020 2020 2020 2073  128e6,.        s
+0001ef80: 6f72 745f 6675 6e63 7469 6f6e 3a20 4361  ort_function: Ca
+0001ef90: 6c6c 6162 6c65 5b5b 7064 2e44 6174 6146  llable[[pd.DataF
+0001efa0: 7261 6d65 5d2c 2070 642e 4461 7461 4672  rame], pd.DataFr
+0001efb0: 616d 655d 207c 204e 6f6e 6520 3d20 4e6f  ame] | None = No
+0001efc0: 6e65 2c0a 2020 2020 2020 2020 736f 7274  ne,.        sort
+0001efd0: 5f66 756e 6374 696f 6e5f 6b77 6172 6773  _function_kwargs
+0001efe0: 3a20 4d61 7070 696e 675b 7374 722c 2041  : Mapping[str, A
+0001eff0: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
+0001f000: 652c 0a20 2020 2020 2020 2075 7073 616d  e,.        upsam
+0001f010: 706c 653a 2066 6c6f 6174 203d 2031 2e30  ple: float = 1.0
+0001f020: 2c0a 2020 2020 2020 2020 6967 6e6f 7265  ,.        ignore
+0001f030: 5f69 6e64 6578 3a20 626f 6f6c 207c 204e  _index: bool | N
+0001f040: 6f6e 6520 3d20 4661 6c73 652c 0a20 2020  one = False,.   
+0001f050: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
+0001f060: 686f 643a 2073 7472 207c 204e 6f6e 6520  hod: str | None 
+0001f070: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001f080: 2a2a 6f70 7469 6f6e 732c 0a20 2020 2029  **options,.    )
+0001f090: 3a0a 2020 2020 2020 2020 2222 2253 6f72  :.        """Sor
+0001f0a0: 7420 7468 6520 6461 7461 7365 7420 6279  t the dataset by
+0001f0b0: 2061 2073 696e 676c 6520 636f 6c75 6d6e   a single column
+0001f0c0: 2e0a 0a20 2020 2020 2020 2053 6f72 7469  ...        Sorti
+0001f0d0: 6e67 2061 2070 6172 616c 6c65 6c20 6461  ng a parallel da
+0001f0e0: 7461 7365 7420 7265 7175 6972 6573 2065  taset requires e
+0001f0f0: 7870 656e 7369 7665 2073 6875 6666 6c65  xpensive shuffle
+0001f100: 7320 616e 6420 6973 2067 656e 6572 616c  s and is general
+0001f110: 6c79 0a20 2020 2020 2020 206e 6f74 2072  ly.        not r
+0001f120: 6563 6f6d 6d65 6e64 6564 2e20 5365 6520  ecommended. See 
+0001f130: 6060 7365 745f 696e 6465 7860 6020 666f  ``set_index`` fo
+0001f140: 7220 696d 706c 656d 656e 7461 7469 6f6e  r implementation
+0001f150: 2064 6574 6169 6c73 2e0a 0a20 2020 2020   details...     
+0001f160: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0001f170: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001f180: 0a20 2020 2020 2020 2062 793a 2073 7472  .        by: str
+0001f190: 206f 7220 6c69 7374 5b73 7472 5d0a 2020   or list[str].  
+0001f1a0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
+0001f1b0: 2873 2920 746f 2073 6f72 7420 6279 2e0a  (s) to sort by..
+0001f1c0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0001f1d0: 6f6e 733a 2069 6e74 2c20 4e6f 6e65 2c20  ons: int, None, 
+0001f1e0: 6f72 2027 6175 746f 270a 2020 2020 2020  or 'auto'.      
+0001f1f0: 2020 2020 2020 5468 6520 6964 6561 6c20        The ideal 
+0001f200: 6e75 6d62 6572 206f 6620 6f75 7470 7574  number of output
+0001f210: 2070 6172 7469 7469 6f6e 732e 2049 6620   partitions. If 
+0001f220: 4e6f 6e65 2c20 7573 6520 7468 6520 7361  None, use the sa
+0001f230: 6d65 2061 730a 2020 2020 2020 2020 2020  me as.          
+0001f240: 2020 7468 6520 696e 7075 742e 2049 6620    the input. If 
+0001f250: 2761 7574 6f27 2074 6865 6e20 6465 6369  'auto' then deci
+0001f260: 6465 2062 7920 6d65 6d6f 7279 2075 7365  de by memory use
+0001f270: 2e0a 2020 2020 2020 2020 6173 6365 6e64  ..        ascend
+0001f280: 696e 673a 2062 6f6f 6c2c 206f 7074 696f  ing: bool, optio
+0001f290: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0001f2a0: 536f 7274 2061 7363 656e 6469 6e67 2076  Sort ascending v
+0001f2b0: 732e 2064 6573 6365 6e64 696e 672e 0a20  s. descending.. 
+0001f2c0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+0001f2d0: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
+0001f2e0: 2020 2020 206e 615f 706f 7369 7469 6f6e       na_position
+0001f2f0: 3a20 7b27 6c61 7374 272c 2027 6669 7273  : {'last', 'firs
+0001f300: 7427 7d2c 206f 7074 696f 6e61 6c0a 2020  t'}, optional.  
+0001f310: 2020 2020 2020 2020 2020 5075 7473 204e            Puts N
+0001f320: 614e 7320 6174 2074 6865 2062 6567 696e  aNs at the begin
+0001f330: 6e69 6e67 2069 6620 2766 6972 7374 272c  ning if 'first',
+0001f340: 2070 7574 7320 4e61 4e20 6174 2074 6865   puts NaN at the
+0001f350: 2065 6e64 2069 6620 276c 6173 7427 2e0a   end if 'last'..
+0001f360: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+0001f370: 756c 7473 2074 6f20 276c 6173 7427 2e0a  ults to 'last'..
+0001f380: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
+0001f390: 6374 696f 6e3a 2066 756e 6374 696f 6e2c  ction: function,
+0001f3a0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001f3b0: 2020 2020 2020 536f 7274 696e 6720 6675        Sorting fu
+0001f3c0: 6e63 7469 6f6e 2074 6f20 7573 6520 7768  nction to use wh
+0001f3d0: 656e 2073 6f72 7469 6e67 2075 6e64 6572  en sorting under
+0001f3e0: 6c79 696e 6720 7061 7274 6974 696f 6e73  lying partitions
+0001f3f0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0001f400: 204e 6f6e 652c 2064 6566 6175 6c74 7320   None, defaults 
+0001f410: 746f 2060 604d 2e73 6f72 745f 7661 6c75  to ``M.sort_valu
+0001f420: 6573 6060 2028 7468 6520 7061 7274 6974  es`` (the partit
+0001f430: 696f 6e20 6c69 6272 6172 7927 730a 2020  ion library's.  
+0001f440: 2020 2020 2020 2020 2020 696d 706c 656d            implem
+0001f450: 656e 7461 7469 6f6e 206f 6620 6060 736f  entation of ``so
+0001f460: 7274 5f76 616c 7565 7360 6029 2e0a 2020  rt_values``)..  
+0001f470: 2020 2020 2020 736f 7274 5f66 756e 6374        sort_funct
+0001f480: 696f 6e5f 6b77 6172 6773 3a20 6469 6374  ion_kwargs: dict
+0001f490: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001f4a0: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+0001f4b0: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
+0001f4c0: 6e74 7320 746f 2070 6173 7320 746f 2074  nts to pass to t
+0001f4d0: 6865 2070 6172 7469 7469 6f6e 2073 6f72  he partition sor
+0001f4e0: 7469 6e67 2066 756e 6374 696f 6e2e 0a20  ting function.. 
+0001f4f0: 2020 2020 2020 2020 2020 2042 7920 6465             By de
+0001f500: 6661 756c 742c 2060 6062 7960 602c 2060  fault, ``by``, `
+0001f510: 6061 7363 656e 6469 6e67 6060 2c20 616e  `ascending``, an
+0001f520: 6420 6060 6e61 5f70 6f73 6974 696f 6e60  d ``na_position`
+0001f530: 6020 6172 6520 7072 6f76 6964 6564 2e0a  ` are provided..
+0001f540: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0001f550: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0001f560: 2d2d 0a20 2020 2020 2020 203e 3e3e 2064  --.        >>> d
+0001f570: 6632 203d 2064 662e 736f 7274 5f76 616c  f2 = df.sort_val
+0001f580: 7565 7328 2778 2729 2020 2320 646f 6374  ues('x')  # doct
+0001f590: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0001f5a0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0001f5b0: 6620 6e61 5f70 6f73 6974 696f 6e20 6e6f  f na_position no
+0001f5c0: 7420 696e 2028 2266 6972 7374 222c 2022  t in ("first", "
+0001f5d0: 6c61 7374 2229 3a0a 2020 2020 2020 2020  last"):.        
+0001f5e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001f5f0: 7272 6f72 2822 6e61 5f70 6f73 6974 696f  rror("na_positio
+0001f600: 6e20 6d75 7374 2062 6520 6569 7468 6572  n must be either
+0001f610: 2027 6669 7273 7427 206f 7220 276c 6173   'first' or 'las
+0001f620: 7427 2229 0a20 2020 2020 2020 2069 6620  t'").        if 
+0001f630: 6e6f 7420 6973 696e 7374 616e 6365 2862  not isinstance(b
+0001f640: 792c 206c 6973 7429 3a0a 2020 2020 2020  y, list):.      
+0001f650: 2020 2020 2020 6279 203d 205b 6279 5d0a        by = [by].
+0001f660: 2020 2020 2020 2020 6966 2061 6e79 286e          if any(n
+0001f670: 6f74 2069 7369 6e73 7461 6e63 6528 622c  ot isinstance(b,
+0001f680: 2073 7472 2920 666f 7220 6220 696e 2062   str) for b in b
+0001f690: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
+0001f6a0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0001f6b0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0001f6c0: 2020 2020 2020 2020 2020 2022 4461 7461             "Data
+0001f6d0: 6672 616d 6573 206f 6e6c 7920 7375 7070  frames only supp
+0001f6e0: 6f72 7420 736f 7274 696e 6720 6279 206e  ort sorting by n
+0001f6f0: 616d 6564 2063 6f6c 756d 6e73 2077 6869  amed columns whi
+0001f700: 6368 206d 7573 7420 6265 2070 6173 7365  ch must be passe
+0001f710: 6420 6173 2061 2022 0a20 2020 2020 2020  d as a ".       
+0001f720: 2020 2020 2020 2020 2022 7374 7269 6e67           "string
+0001f730: 206f 7220 6120 6c69 7374 206f 6620 7374   or a list of st
+0001f740: 7269 6e67 732e 5c6e 220a 2020 2020 2020  rings.\n".      
+0001f750: 2020 2020 2020 2020 2020 2259 6f75 2070            "You p
+0001f760: 6173 7365 6420 2573 2220 2520 7374 7228  assed %s" % str(
+0001f770: 6279 290a 2020 2020 2020 2020 2020 2020  by).            
+0001f780: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+0001f790: 7420 6973 696e 7374 616e 6365 2861 7363  t isinstance(asc
+0001f7a0: 656e 6469 6e67 2c20 626f 6f6c 2920 616e  ending, bool) an
+0001f7b0: 6420 6e6f 7420 6c65 6e28 6173 6365 6e64  d not len(ascend
+0001f7c0: 696e 6729 203d 3d20 6c65 6e28 6279 293a  ing) == len(by):
+0001f7d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001f7e0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+0001f7f0: 4c65 6e67 7468 206f 6620 7b61 7363 656e  Length of {ascen
+0001f800: 6469 6e67 3d7d 2021 3d20 6c65 6e67 7468  ding=} != length
+0001f810: 206f 6620 7b62 793d 7d22 290a 0a20 2020   of {by=}")..   
+0001f820: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0001f830: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+0001f840: 2020 2020 2020 2020 536f 7274 5661 6c75          SortValu
+0001f850: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+0001f860: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001f870: 2020 2020 2020 2020 2020 6279 2c0a 2020            by,.  
+0001f880: 2020 2020 2020 2020 2020 2020 2020 6173                as
+0001f890: 6365 6e64 696e 672c 0a20 2020 2020 2020  cending,.       
+0001f8a0: 2020 2020 2020 2020 206e 615f 706f 7369           na_posi
+0001f8b0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0001f8c0: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+0001f8d0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001f8e0: 2020 2070 6172 7469 7469 6f6e 5f73 697a     partition_siz
+0001f8f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001f900: 2020 2073 6f72 745f 6675 6e63 7469 6f6e     sort_function
+0001f910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f920: 2020 736f 7274 5f66 756e 6374 696f 6e5f    sort_function_
+0001f930: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0001f940: 2020 2020 2020 2020 7570 7361 6d70 6c65          upsample
+0001f950: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f960: 2020 6967 6e6f 7265 5f69 6e64 6578 2c0a    ignore_index,.
+0001f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f980: 6765 745f 7370 6563 6966 6965 645f 7368  get_specified_sh
+0001f990: 7566 666c 6528 7368 7566 666c 655f 6d65  uffle(shuffle_me
+0001f9a0: 7468 6f64 292c 0a20 2020 2020 2020 2020  thod),.         
+0001f9b0: 2020 2020 2020 206f 7074 696f 6e73 3d6f         options=o
+0001f9c0: 7074 696f 6e73 2c0a 2020 2020 2020 2020  ptions,.        
+0001f9d0: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+0001f9e0: 0a20 2020 2064 6566 2071 7565 7279 2873  .    def query(s
+0001f9f0: 656c 662c 2065 7870 722c 202a 2a6b 7761  elf, expr, **kwa
+0001fa00: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+0001fa10: 2246 696c 7465 7220 6461 7461 6672 616d  "Filter datafram
+0001fa20: 6520 7769 7468 2063 6f6d 706c 6578 2065  e with complex e
+0001fa30: 7870 7265 7373 696f 6e0a 0a20 2020 2020  xpression..     
+0001fa40: 2020 2042 6c6f 636b 6564 2076 6572 7369     Blocked versi
+0001fa50: 6f6e 206f 6620 7064 2e44 6174 6146 7261  on of pd.DataFra
+0001fa60: 6d65 2e71 7565 7279 0a0a 2020 2020 2020  me.query..      
+0001fa70: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0001fa80: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0001fa90: 2020 2020 2020 2020 6578 7072 3a20 7374          expr: st
+0001faa0: 720a 2020 2020 2020 2020 2020 2020 5468  r.            Th
+0001fab0: 6520 7175 6572 7920 7374 7269 6e67 2074  e query string t
+0001fac0: 6f20 6576 616c 7561 7465 2e0a 2020 2020  o evaluate..    
+0001fad0: 2020 2020 2020 2020 596f 7520 6361 6e20          You can 
+0001fae0: 7265 6665 7220 746f 2063 6f6c 756d 6e20  refer to column 
+0001faf0: 6e61 6d65 7320 7468 6174 2061 7265 206e  names that are n
+0001fb00: 6f74 2076 616c 6964 2050 7974 686f 6e20  ot valid Python 
+0001fb10: 7661 7269 6162 6c65 206e 616d 6573 0a20  variable names. 
+0001fb20: 2020 2020 2020 2020 2020 2062 7920 7375             by su
+0001fb30: 7272 6f75 6e64 696e 6720 7468 656d 2069  rrounding them i
+0001fb40: 6e20 6261 636b 7469 636b 732e 0a20 2020  n backticks..   
+0001fb50: 2020 2020 2020 2020 2044 6173 6b20 646f           Dask do
+0001fb60: 6573 206e 6f74 2066 756c 6c79 2073 7570  es not fully sup
+0001fb70: 706f 7274 2072 6566 6572 7269 6e67 2074  port referring t
+0001fb80: 6f20 7661 7269 6162 6c65 7320 7573 696e  o variables usin
+0001fb90: 6720 7468 6520 2740 2720 6368 6172 6163  g the '@' charac
+0001fba0: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
+0001fbb0: 2075 7365 2066 2d73 7472 696e 6773 206f   use f-strings o
+0001fbc0: 7220 7468 6520 6060 6c6f 6361 6c5f 6469  r the ``local_di
+0001fbd0: 6374 6060 206b 6579 776f 7264 2061 7267  ct`` keyword arg
+0001fbe0: 756d 656e 7420 696e 7374 6561 642e 0a0a  ument instead...
+0001fbf0: 2020 2020 2020 2020 4e6f 7465 730a 2020          Notes.  
+0001fc00: 2020 2020 2020 2d2d 2d2d 2d0a 2020 2020        -----.    
+0001fc10: 2020 2020 5468 6973 2069 7320 6c69 6b65      This is like
+0001fc20: 2074 6865 2073 6571 7565 6e74 6961 6c20   the sequential 
+0001fc30: 7665 7273 696f 6e20 6578 6365 7074 2074  version except t
+0001fc40: 6861 7420 7468 6973 2077 696c 6c20 616c  hat this will al
+0001fc50: 736f 2068 6170 7065 6e0a 2020 2020 2020  so happen.      
+0001fc60: 2020 696e 206d 616e 7920 7468 7265 6164    in many thread
+0001fc70: 732e 2020 5468 6973 206d 6179 2063 6f6e  s.  This may con
+0001fc80: 666c 6963 7420 7769 7468 2060 606e 756d  flict with ``num
+0001fc90: 6578 7072 6060 2077 6869 6368 2077 696c  expr`` which wil
+0001fca0: 6c20 7573 650a 2020 2020 2020 2020 6d75  l use.        mu
+0001fcb0: 6c74 6970 6c65 2074 6872 6561 6473 2069  ltiple threads i
+0001fcc0: 7473 656c 662e 2020 5765 2072 6563 6f6d  tself.  We recom
+0001fcd0: 6d65 6e64 2074 6861 7420 796f 7520 7365  mend that you se
+0001fce0: 7420 6060 6e75 6d65 7870 7260 6020 746f  t ``numexpr`` to
+0001fcf0: 2075 7365 2061 0a20 2020 2020 2020 2073   use a.        s
+0001fd00: 696e 676c 6520 7468 7265 6164 3a0a 0a20  ingle thread:.. 
+0001fd10: 2020 2020 2020 202e 2e20 636f 6465 2d62         .. code-b
+0001fd20: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
+0001fd30: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0001fd40: 7420 6e75 6d65 7870 720a 2020 2020 2020  t numexpr.      
+0001fd50: 2020 2020 2020 6e75 6d65 7870 722e 7365        numexpr.se
+0001fd60: 745f 6e75 6d5f 7468 7265 6164 7328 3129  t_num_threads(1)
+0001fd70: 0a0a 2020 2020 2020 2020 5365 6520 616c  ..        See al
+0001fd80: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+0001fd90: 2d2d 2d0a 2020 2020 2020 2020 7061 6e64  ---.        pand
+0001fda0: 6173 2e44 6174 6146 7261 6d65 2e71 7565  as.DataFrame.que
+0001fdb0: 7279 0a20 2020 2020 2020 2070 616e 6461  ry.        panda
+0001fdc0: 732e 6576 616c 0a0a 2020 2020 2020 2020  s.eval..        
+0001fdd0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+0001fde0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0001fdf0: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
+0001fe00: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
+0001fe10: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
+0001fe20: 6b5f 6578 7072 2061 7320 6464 0a20 2020  k_expr as dd.   
+0001fe30: 2020 2020 203e 3e3e 2064 6620 3d20 7064       >>> df = pd
+0001fe40: 2e44 6174 6146 7261 6d65 287b 2778 273a  .DataFrame({'x':
+0001fe50: 205b 312c 2032 2c20 312c 2032 5d2c 0a20   [1, 2, 1, 2],. 
+0001fe60: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0001fe70: 2020 2020 2020 2020 2020 2020 2020 2779                'y
+0001fe80: 273a 205b 312c 2032 2c20 332c 2034 5d2c  ': [1, 2, 3, 4],
+0001fe90: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001feb0: 277a 207a 273a 205b 342c 2033 2c20 322c  'z z': [4, 3, 2,
+0001fec0: 2031 5d7d 290a 2020 2020 2020 2020 3e3e   1]}).        >>
+0001fed0: 3e20 6464 6620 3d20 6464 2e66 726f 6d5f  > ddf = dd.from_
+0001fee0: 7061 6e64 6173 2864 662c 206e 7061 7274  pandas(df, npart
+0001fef0: 6974 696f 6e73 3d32 290a 0a20 2020 2020  itions=2)..     
+0001ff00: 2020 2052 6566 6572 2074 6f20 636f 6c75     Refer to colu
+0001ff10: 6d6e 206e 616d 6573 2064 6972 6563 746c  mn names directl
+0001ff20: 793a 0a0a 2020 2020 2020 2020 3e3e 3e20  y:..        >>> 
+0001ff30: 6464 662e 7175 6572 7928 2779 203e 2078  ddf.query('y > x
+0001ff40: 2729 2e63 6f6d 7075 7465 2829 0a20 2020  ').compute().   
+0001ff50: 2020 2020 2020 2020 7820 2079 2020 7a20          x  y  z 
+0001ff60: 7a0a 2020 2020 2020 2020 3220 2031 2020  z.        2  1  
+0001ff70: 3320 2020 2032 0a20 2020 2020 2020 2033  3    2.        3
+0001ff80: 2020 3220 2034 2020 2020 310a 0a20 2020    2  4    1..   
+0001ff90: 2020 2020 2052 6566 6572 2074 6f20 636f       Refer to co
+0001ffa0: 6c75 6d6e 206e 616d 6520 7573 696e 6720  lumn name using 
+0001ffb0: 6261 636b 7469 636b 733a 0a0a 2020 2020  backticks:..    
+0001ffc0: 2020 2020 3e3e 3e20 6464 662e 7175 6572      >>> ddf.quer
+0001ffd0: 7928 2760 7a20 7a60 203e 2078 2729 2e63  y('`z z` > x').c
+0001ffe0: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
+0001fff0: 2020 2020 7820 2079 2020 7a20 7a0a 2020      x  y  z z.  
+00020000: 2020 2020 2020 3020 2031 2020 3120 2020        0  1  1   
+00020010: 2034 0a20 2020 2020 2020 2031 2020 3220   4.        1  2 
+00020020: 2032 2020 2020 330a 2020 2020 2020 2020   2    3.        
+00020030: 3220 2031 2020 3320 2020 2032 0a0a 2020  2  1  3    2..  
+00020040: 2020 2020 2020 5265 6665 7220 746f 2076        Refer to v
+00020050: 6172 6961 626c 6520 6e61 6d65 2075 7369  ariable name usi
+00020060: 6e67 2066 2d73 7472 696e 6773 3a0a 0a20  ng f-strings:.. 
+00020070: 2020 2020 2020 203e 3e3e 2076 616c 7565         >>> value
+00020080: 203d 2031 0a20 2020 2020 2020 203e 3e3e   = 1.        >>>
+00020090: 2064 6466 2e71 7565 7279 2866 2778 203d   ddf.query(f'x =
+000200a0: 3d20 7b76 616c 7565 7d27 292e 636f 6d70  = {value}').comp
+000200b0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+000200c0: 2078 2020 7920 207a 207a 0a20 2020 2020   x  y  z z.     
+000200d0: 2020 2030 2020 3120 2031 2020 2020 340a     0  1  1    4.
+000200e0: 2020 2020 2020 2020 3220 2031 2020 3320          2  1  3 
+000200f0: 2020 2032 0a0a 2020 2020 2020 2020 5265     2..        Re
+00020100: 6665 7220 746f 2076 6172 6961 626c 6520  fer to variable 
+00020110: 6e61 6d65 2075 7369 6e67 2060 606c 6f63  name using ``loc
+00020120: 616c 5f64 6963 7460 603a 0a0a 2020 2020  al_dict``:..    
+00020130: 2020 2020 3e3e 3e20 6464 662e 7175 6572      >>> ddf.quer
+00020140: 7928 2778 203d 3d20 4076 616c 7565 272c  y('x == @value',
+00020150: 206c 6f63 616c 5f64 6963 743d 7b22 7661   local_dict={"va
+00020160: 6c75 6522 3a20 7661 6c75 657d 292e 636f  lue": value}).co
+00020170: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+00020180: 2020 2078 2020 7920 207a 207a 0a20 2020     x  y  z z.   
+00020190: 2020 2020 2030 2020 3120 2031 2020 2020       0  1  1    
+000201a0: 340a 2020 2020 2020 2020 3220 2031 2020  4.        2  1  
+000201b0: 3320 2020 2032 0a20 2020 2020 2020 2022  3    2.        "
+000201c0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000201d0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+000201e0: 2851 7565 7279 2873 656c 662c 2065 7870  (Query(self, exp
+000201f0: 722c 206b 7761 7267 7329 290a 0a20 2020  r, kwargs))..   
+00020200: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00020210: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00020220: 2064 6566 206d 6f64 6528 7365 6c66 2c20   def mode(self, 
+00020230: 6472 6f70 6e61 3d54 7275 652c 2073 706c  dropna=True, spl
+00020240: 6974 5f65 7665 7279 3d46 616c 7365 2c20  it_every=False, 
+00020250: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
+00020260: 7365 293a 0a20 2020 2020 2020 206d 6f64  se):.        mod
+00020270: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+00020280: 666f 7220 5f2c 2063 6f6c 2069 6e20 7365  for _, col in se
+00020290: 6c66 2e69 7465 6d73 2829 3a0a 2020 2020  lf.items():.    
+000202a0: 2020 2020 2020 2020 6966 206e 756d 6572          if numer
+000202b0: 6963 5f6f 6e6c 7920 616e 6420 6e6f 7420  ic_only and not 
+000202c0: 7064 2e61 7069 2e74 7970 6573 2e69 735f  pd.api.types.is_
+000202d0: 6e75 6d65 7269 635f 6474 7970 6528 636f  numeric_dtype(co
+000202e0: 6c2e 6474 7970 6529 3a0a 2020 2020 2020  l.dtype):.      
+000202f0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+00020300: 7565 0a20 2020 2020 2020 2020 2020 206d  ue.            m
+00020310: 6f64 6573 2e61 7070 656e 6428 636f 6c2e  odes.append(col.
+00020320: 6d6f 6465 2864 726f 706e 613d 6472 6f70  mode(dropna=drop
+00020330: 6e61 2c20 7370 6c69 745f 6576 6572 793d  na, split_every=
+00020340: 7370 6c69 745f 6576 6572 7929 290a 2020  split_every)).  
+00020350: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
+00020360: 6361 7428 6d6f 6465 732c 2061 7869 733d  cat(modes, axis=
+00020370: 3129 0a0a 2020 2020 4064 6572 6976 6564  1)..    @derived
+00020380: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00020390: 6d65 290a 2020 2020 6465 6620 6164 645f  me).    def add_
+000203a0: 7072 6566 6978 2873 656c 662c 2070 7265  prefix(self, pre
+000203b0: 6669 7829 3a0a 2020 2020 2020 2020 7265  fix):.        re
+000203c0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+000203d0: 696f 6e28 6578 7072 2e41 6464 5072 6566  ion(expr.AddPref
+000203e0: 6978 2873 656c 662c 2070 7265 6669 7829  ix(self, prefix)
+000203f0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00020400: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00020410: 6529 0a20 2020 2064 6566 2061 6464 5f73  e).    def add_s
+00020420: 7566 6669 7828 7365 6c66 2c20 7375 6666  uffix(self, suff
+00020430: 6978 293a 0a20 2020 2020 2020 2072 6574  ix):.        ret
+00020440: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00020450: 6f6e 2865 7870 722e 4164 6453 7566 6669  on(expr.AddSuffi
+00020460: 7828 7365 6c66 2c20 7375 6666 6978 2929  x(self, suffix))
+00020470: 0a0a 2020 2020 6465 6620 7069 766f 745f  ..    def pivot_
+00020480: 7461 626c 6528 7365 6c66 2c20 696e 6465  table(self, inde
+00020490: 782c 2063 6f6c 756d 6e73 2c20 7661 6c75  x, columns, valu
+000204a0: 6573 2c20 6167 6766 756e 633d 226d 6561  es, aggfunc="mea
+000204b0: 6e22 293a 0a20 2020 2020 2020 2022 2222  n"):.        """
+000204c0: 0a20 2020 2020 2020 2043 7265 6174 6520  .        Create 
+000204d0: 6120 7370 7265 6164 7368 6565 742d 7374  a spreadsheet-st
+000204e0: 796c 6520 7069 766f 7420 7461 626c 6520  yle pivot table 
+000204f0: 6173 2061 2044 6174 6146 7261 6d65 2e20  as a DataFrame. 
+00020500: 5461 7267 6574 2060 6063 6f6c 756d 6e73  Target ``columns
+00020510: 6060 0a20 2020 2020 2020 206d 7573 7420  ``.        must 
+00020520: 6861 7665 2063 6174 6567 6f72 7920 6474  have category dt
+00020530: 7970 6520 746f 2069 6e66 6572 2072 6573  ype to infer res
+00020540: 756c 7427 7320 6060 636f 6c75 6d6e 7360  ult's ``columns`
+00020550: 602e 0a20 2020 2020 2020 2060 6069 6e64  `..        ``ind
+00020560: 6578 6060 2c20 6060 636f 6c75 6d6e 7360  ex``, ``columns`
+00020570: 602c 2060 6076 616c 7565 7360 6020 616e  `, ``values`` an
+00020580: 6420 6060 6167 6766 756e 6360 6020 6d75  d ``aggfunc`` mu
+00020590: 7374 2062 6520 616c 6c20 7363 616c 6172  st be all scalar
+000205a0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000205b0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+000205c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000205d0: 2076 616c 7565 7320 3a20 7363 616c 6172   values : scalar
+000205e0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000205f0: 756d 6e20 746f 2061 6767 7265 6761 7465  umn to aggregate
+00020600: 0a20 2020 2020 2020 2069 6e64 6578 203a  .        index :
+00020610: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+00020620: 2020 2020 636f 6c75 6d6e 2074 6f20 6265      column to be
+00020630: 2069 6e64 6578 0a20 2020 2020 2020 2063   index.        c
+00020640: 6f6c 756d 6e73 203a 2073 6361 6c61 720a  olumns : scalar.
+00020650: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00020660: 6d6e 2074 6f20 6265 2063 6f6c 756d 6e73  mn to be columns
+00020670: 0a20 2020 2020 2020 2061 6767 6675 6e63  .        aggfunc
+00020680: 203a 207b 276d 6561 6e27 2c20 2773 756d   : {'mean', 'sum
+00020690: 272c 2027 636f 756e 7427 7d2c 2064 6566  ', 'count'}, def
+000206a0: 6175 6c74 2027 6d65 616e 270a 0a20 2020  ault 'mean'..   
+000206b0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+000206c0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+000206d0: 2020 2020 2074 6162 6c65 203a 2044 6174       table : Dat
+000206e0: 6146 7261 6d65 0a20 2020 2020 2020 2022  aFrame.        "
+000206f0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00020700: 6e20 7069 766f 745f 7461 626c 6528 7365  n pivot_table(se
+00020710: 6c66 2c20 696e 6465 782c 2063 6f6c 756d  lf, index, colum
+00020720: 6e73 2c20 7661 6c75 6573 2c20 6167 6766  ns, values, aggf
+00020730: 756e 6329 0a0a 2020 2020 4070 726f 7065  unc)..    @prope
+00020740: 7274 790a 2020 2020 6465 6620 696c 6f63  rty.    def iloc
+00020750: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00020760: 2222 2250 7572 656c 7920 696e 7465 6765  """Purely intege
+00020770: 722d 6c6f 6361 7469 6f6e 2062 6173 6564  r-location based
+00020780: 2069 6e64 6578 696e 6720 666f 7220 7365   indexing for se
+00020790: 6c65 6374 696f 6e20 6279 2070 6f73 6974  lection by posit
+000207a0: 696f 6e2e 0a0a 2020 2020 2020 2020 4f6e  ion...        On
+000207b0: 6c79 2069 6e64 6578 696e 6720 7468 6520  ly indexing the 
+000207c0: 636f 6c75 6d6e 2070 6f73 6974 696f 6e73  column positions
+000207d0: 2069 7320 7375 7070 6f72 7465 642e 2054   is supported. T
+000207e0: 7279 696e 6720 746f 2073 656c 6563 740a  rying to select.
+000207f0: 2020 2020 2020 2020 726f 7720 706f 7369          row posi
+00020800: 7469 6f6e 7320 7769 6c6c 2072 6169 7365  tions will raise
+00020810: 2061 2056 616c 7565 4572 726f 722e 0a0a   a ValueError...
+00020820: 2020 2020 2020 2020 5365 6520 3a72 6566          See :ref
+00020830: 3a60 6461 7461 6672 616d 652e 696e 6465  :`dataframe.inde
+00020840: 7869 6e67 6020 666f 7220 6d6f 7265 2e0a  xing` for more..
+00020850: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00020860: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00020870: 2d2d 0a20 2020 2020 2020 203e 3e3e 2064  --.        >>> d
+00020880: 662e 696c 6f63 5b3a 2c20 5b32 2c20 302c  f.iloc[:, [2, 0,
+00020890: 2031 5d5d 2020 2320 646f 6374 6573 743a   1]]  # doctest:
+000208a0: 202b 534b 4950 0a20 2020 2020 2020 2022   +SKIP.        "
+000208b0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+000208c0: 6461 736b 5f65 7870 722e 5f69 6e64 6578  dask_expr._index
+000208d0: 696e 6720 696d 706f 7274 2049 4c6f 6349  ing import ILocI
+000208e0: 6e64 6578 6572 0a0a 2020 2020 2020 2020  ndexer..        
+000208f0: 7265 7475 726e 2049 4c6f 6349 6e64 6578  return ILocIndex
+00020900: 6572 2873 656c 6629 0a0a 2020 2020 6465  er(self)..    de
+00020910: 6620 5f63 6f6d 7061 7269 736f 6e5f 6f70  f _comparison_op
+00020920: 2873 656c 662c 2065 7870 725f 636c 732c  (self, expr_cls,
+00020930: 206f 7468 6572 2c20 6c65 7665 6c2c 2061   other, level, a
+00020940: 7869 7329 3a0a 2020 2020 2020 2020 6966  xis):.        if
+00020950: 206c 6576 656c 2069 7320 6e6f 7420 4e6f   level is not No
+00020960: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00020970: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00020980: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
+00020990: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
+000209a0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+000209b0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+000209c0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+000209d0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+000209e0: 6563 7469 6f6e 2865 7870 725f 636c 7328  ection(expr_cls(
+000209f0: 7365 6c66 2c20 6f74 6865 722c 2061 7869  self, other, axi
+00020a00: 7329 290a 0a20 2020 2064 6566 206c 7428  s))..    def lt(
+00020a10: 7365 6c66 2c20 6f74 6865 722c 206c 6576  self, other, lev
+00020a20: 656c 3d4e 6f6e 652c 2061 7869 733d 3029  el=None, axis=0)
+00020a30: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00020a40: 2073 656c 662e 5f63 6f6d 7061 7269 736f   self._compariso
+00020a50: 6e5f 6f70 2865 7870 722e 4c54 4672 616d  n_op(expr.LTFram
+00020a60: 652c 206f 7468 6572 2c20 6c65 7665 6c2c  e, other, level,
+00020a70: 2061 7869 7329 0a0a 2020 2020 6465 6620   axis)..    def 
+00020a80: 6c65 2873 656c 662c 206f 7468 6572 2c20  le(self, other, 
+00020a90: 6c65 7665 6c3d 4e6f 6e65 2c20 6178 6973  level=None, axis
+00020aa0: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
+00020ab0: 7572 6e20 7365 6c66 2e5f 636f 6d70 6172  urn self._compar
+00020ac0: 6973 6f6e 5f6f 7028 6578 7072 2e4c 4546  ison_op(expr.LEF
+00020ad0: 7261 6d65 2c20 6f74 6865 722c 206c 6576  rame, other, lev
+00020ae0: 656c 2c20 6178 6973 290a 0a20 2020 2064  el, axis)..    d
+00020af0: 6566 2067 7428 7365 6c66 2c20 6f74 6865  ef gt(self, othe
+00020b00: 722c 206c 6576 656c 3d4e 6f6e 652c 2061  r, level=None, a
+00020b10: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00020b20: 7265 7475 726e 2073 656c 662e 5f63 6f6d  return self._com
+00020b30: 7061 7269 736f 6e5f 6f70 2865 7870 722e  parison_op(expr.
+00020b40: 4754 4672 616d 652c 206f 7468 6572 2c20  GTFrame, other, 
+00020b50: 6c65 7665 6c2c 2061 7869 7329 0a0a 2020  level, axis)..  
+00020b60: 2020 6465 6620 6765 2873 656c 662c 206f    def ge(self, o
+00020b70: 7468 6572 2c20 6c65 7665 6c3d 4e6f 6e65  ther, level=None
+00020b80: 2c20 6178 6973 3d30 293a 0a20 2020 2020  , axis=0):.     
+00020b90: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00020ba0: 636f 6d70 6172 6973 6f6e 5f6f 7028 6578  comparison_op(ex
+00020bb0: 7072 2e47 4546 7261 6d65 2c20 6f74 6865  pr.GEFrame, othe
+00020bc0: 722c 206c 6576 656c 2c20 6178 6973 290a  r, level, axis).
+00020bd0: 0a20 2020 2064 6566 206e 6528 7365 6c66  .    def ne(self
+00020be0: 2c20 6f74 6865 722c 206c 6576 656c 3d4e  , other, level=N
+00020bf0: 6f6e 652c 2061 7869 733d 3029 3a0a 2020  one, axis=0):.  
+00020c00: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00020c10: 662e 5f63 6f6d 7061 7269 736f 6e5f 6f70  f._comparison_op
+00020c20: 2865 7870 722e 4e45 4672 616d 652c 206f  (expr.NEFrame, o
+00020c30: 7468 6572 2c20 6c65 7665 6c2c 2061 7869  ther, level, axi
+00020c40: 7329 0a0a 2020 2020 6465 6620 6571 2873  s)..    def eq(s
+00020c50: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
+00020c60: 6c3d 4e6f 6e65 2c20 6178 6973 3d30 293a  l=None, axis=0):
+00020c70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00020c80: 7365 6c66 2e5f 636f 6d70 6172 6973 6f6e  self._comparison
+00020c90: 5f6f 7028 6578 7072 2e45 5146 7261 6d65  _op(expr.EQFrame
+00020ca0: 2c20 6f74 6865 722c 206c 6576 656c 2c20  , other, level, 
+00020cb0: 6178 6973 290a 0a20 2020 2064 6566 2063  axis)..    def c
+00020cc0: 6174 6567 6f72 697a 6528 7365 6c66 2c20  ategorize(self, 
+00020cd0: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 696e  columns=None, in
+00020ce0: 6465 783d 4e6f 6e65 2c20 7370 6c69 745f  dex=None, split_
+00020cf0: 6576 6572 793d 4e6f 6e65 2c20 2a2a 6b77  every=None, **kw
+00020d00: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+00020d10: 2222 436f 6e76 6572 7420 636f 6c75 6d6e  ""Convert column
+00020d20: 7320 6f66 2074 6865 2044 6174 6146 7261  s of the DataFra
+00020d30: 6d65 2074 6f20 6361 7465 676f 7279 2064  me to category d
+00020d40: 7479 7065 2e0a 0a20 2020 2020 2020 202e  type...        .
+00020d50: 2e20 7761 726e 696e 673a 3a20 5468 6973  . warning:: This
+00020d60: 206d 6574 686f 6420 6561 6765 726c 7920   method eagerly 
+00020d70: 636f 6d70 7574 6573 2074 6865 2063 6174  computes the cat
+00020d80: 6567 6f72 6965 7320 6f66 2074 6865 2063  egories of the c
+00020d90: 686f 7365 6e20 636f 6c75 6d6e 732e 0a0a  hosen columns...
+00020da0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00020db0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00020dc0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 636f  -----.        co
+00020dd0: 6c75 6d6e 7320 3a20 6c69 7374 2c20 6f70  lumns : list, op
+00020de0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00020df0: 2020 2041 206c 6973 7420 6f66 2063 6f6c     A list of col
+00020e00: 756d 6e20 6e61 6d65 7320 746f 2063 6f6e  umn names to con
+00020e10: 7665 7274 2074 6f20 6361 7465 676f 7269  vert to categori
+00020e20: 6361 6c73 2e20 4279 2064 6566 6175 6c74  cals. By default
+00020e30: 2061 6e79 0a20 2020 2020 2020 2020 2020   any.           
+00020e40: 2063 6f6c 756d 6e20 7769 7468 2061 6e20   column with an 
+00020e50: 6f62 6a65 6374 2064 7479 7065 2069 7320  object dtype is 
+00020e60: 636f 6e76 6572 7465 6420 746f 2061 2063  converted to a c
+00020e70: 6174 6567 6f72 6963 616c 2c20 616e 6420  ategorical, and 
+00020e80: 616e 790a 2020 2020 2020 2020 2020 2020  any.            
+00020e90: 756e 6b6e 6f77 6e20 6361 7465 676f 7269  unknown categori
+00020ea0: 6361 6c73 2061 7265 206d 6164 6520 6b6e  cals are made kn
+00020eb0: 6f77 6e2e 0a20 2020 2020 2020 2069 6e64  own..        ind
+00020ec0: 6578 203a 2062 6f6f 6c2c 206f 7074 696f  ex : bool, optio
+00020ed0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00020ee0: 5768 6574 6865 7220 746f 2063 6174 6567  Whether to categ
+00020ef0: 6f72 697a 6520 7468 6520 696e 6465 782e  orize the index.
+00020f00: 2042 7920 6465 6661 756c 742c 206f 626a   By default, obj
+00020f10: 6563 7420 696e 6469 6365 7320 6172 650a  ect indices are.
+00020f20: 2020 2020 2020 2020 2020 2020 636f 6e76              conv
+00020f30: 6572 7465 6420 746f 2063 6174 6567 6f72  erted to categor
+00020f40: 6963 616c 2c20 616e 6420 756e 6b6e 6f77  ical, and unknow
+00020f50: 6e20 6361 7465 676f 7269 6361 6c20 696e  n categorical in
+00020f60: 6469 6365 7320 6172 6520 6d61 6465 0a20  dices are made. 
+00020f70: 2020 2020 2020 2020 2020 206b 6e6f 776e             known
+00020f80: 2e20 5365 7420 5472 7565 2074 6f20 616c  . Set True to al
+00020f90: 7761 7973 2063 6174 6567 6f72 697a 6520  ways categorize 
+00020fa0: 7468 6520 696e 6465 782c 2046 616c 7365  the index, False
+00020fb0: 2074 6f20 6e65 7665 722e 0a20 2020 2020   to never..     
+00020fc0: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
+00020fd0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+00020fe0: 2020 2020 2020 2020 2020 2047 726f 7570             Group
+00020ff0: 2070 6172 7469 7469 6f6e 7320 696e 746f   partitions into
+00021000: 2067 726f 7570 7320 6f66 2074 6869 7320   groups of this 
+00021010: 7369 7a65 2077 6869 6c65 2070 6572 666f  size while perfo
+00021020: 726d 696e 6720 610a 2020 2020 2020 2020  rming a.        
+00021030: 2020 2020 7472 6565 2d72 6564 7563 7469      tree-reducti
+00021040: 6f6e 2e20 4966 2073 6574 2074 6f20 4661  on. If set to Fa
+00021050: 6c73 652c 206e 6f20 7472 6565 2d72 6564  lse, no tree-red
+00021060: 7563 7469 6f6e 2077 696c 6c20 6265 2075  uction will be u
+00021070: 7365 642e 0a20 2020 2020 2020 206b 7761  sed..        kwa
+00021080: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
+00021090: 4b65 7977 6f72 6420 6172 6775 6d65 6e74  Keyword argument
+000210a0: 7320 6172 6520 7061 7373 6564 206f 6e20  s are passed on 
+000210b0: 746f 2063 6f6d 7075 7465 2e0a 2020 2020  to compute..    
+000210c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000210d0: 6466 203d 2073 656c 660a 2020 2020 2020  df = self.      
+000210e0: 2020 6d65 7461 203d 2064 662e 5f6d 6574    meta = df._met
+000210f0: 610a 2020 2020 2020 2020 6966 2063 6f6c  a.        if col
+00021100: 756d 6e73 2069 7320 4e6f 6e65 3a0a 2020  umns is None:.  
+00021110: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00021120: 7320 3d20 6c69 7374 286d 6574 612e 7365  s = list(meta.se
+00021130: 6c65 6374 5f64 7479 7065 7328 5b22 6f62  lect_dtypes(["ob
+00021140: 6a65 6374 222c 2022 7374 7269 6e67 222c  ject", "string",
+00021150: 2022 6361 7465 676f 7279 225d 292e 636f   "category"]).co
+00021160: 6c75 6d6e 7329 0a20 2020 2020 2020 2065  lumns).        e
+00021170: 6c69 6620 6973 5f73 6361 6c61 7228 636f  lif is_scalar(co
+00021180: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
+00021190: 2020 2020 636f 6c75 6d6e 7320 3d20 5b63      columns = [c
+000211a0: 6f6c 756d 6e73 5d0a 0a20 2020 2020 2020  olumns]..       
+000211b0: 2023 2046 696c 7465 7220 6f75 7420 6b6e   # Filter out kn
+000211c0: 6f77 6e20 6361 7465 676f 7269 6361 6c20  own categorical 
+000211d0: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+000211e0: 636f 6c75 6d6e 7320 3d20 5b0a 2020 2020  columns = [.    
+000211f0: 2020 2020 2020 2020 630a 2020 2020 2020          c.      
+00021200: 2020 2020 2020 666f 7220 6320 696e 2063        for c in c
+00021210: 6f6c 756d 6e73 0a20 2020 2020 2020 2020  olumns.         
+00021220: 2020 2069 6620 6e6f 7420 2869 735f 6361     if not (is_ca
+00021230: 7465 676f 7269 6361 6c5f 6474 7970 6528  tegorical_dtype(
+00021240: 6d65 7461 5b63 5d29 2061 6e64 2068 6173  meta[c]) and has
+00021250: 5f6b 6e6f 776e 5f63 6174 6567 6f72 6965  _known_categorie
+00021260: 7328 6d65 7461 5b63 5d29 290a 2020 2020  s(meta[c])).    
+00021270: 2020 2020 5d0a 0a20 2020 2020 2020 2069      ]..        i
+00021280: 6620 696e 6465 7820 6973 206e 6f74 2046  f index is not F
+00021290: 616c 7365 3a0a 2020 2020 2020 2020 2020  alse:.          
+000212a0: 2020 6966 2069 735f 6361 7465 676f 7269    if is_categori
+000212b0: 6361 6c5f 6474 7970 6528 6d65 7461 2e69  cal_dtype(meta.i
+000212c0: 6e64 6578 293a 0a20 2020 2020 2020 2020  ndex):.         
+000212d0: 2020 2020 2020 2069 6e64 6578 203d 206e         index = n
+000212e0: 6f74 2068 6173 5f6b 6e6f 776e 5f63 6174  ot has_known_cat
+000212f0: 6567 6f72 6965 7328 6d65 7461 2e69 6e64  egories(meta.ind
+00021300: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
+00021310: 656c 6966 2069 6e64 6578 2069 7320 4e6f  elif index is No
+00021320: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00021330: 2020 2020 696e 6465 7820 3d20 7374 7228      index = str(
+00021340: 6d65 7461 2e69 6e64 6578 2e64 7479 7065  meta.index.dtype
+00021350: 2920 696e 2028 226f 626a 6563 7422 2c20  ) in ("object", 
+00021360: 2273 7472 696e 6722 290a 0a20 2020 2020  "string")..     
+00021370: 2020 2023 204e 6f74 6869 6e67 2074 6f20     # Nothing to 
+00021380: 646f 0a20 2020 2020 2020 2069 6620 6e6f  do.        if no
+00021390: 7420 6c65 6e28 636f 6c75 6d6e 7329 2061  t len(columns) a
+000213a0: 6e64 2069 6e64 6578 2069 7320 4661 6c73  nd index is Fals
+000213b0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+000213c0: 6574 7572 6e20 6466 0a0a 2020 2020 2020  eturn df..      
+000213d0: 2020 6672 6f6d 2064 6173 6b5f 6578 7072    from dask_expr
+000213e0: 2e5f 636f 6c6c 6563 7469 6f6e 2069 6d70  ._collection imp
+000213f0: 6f72 7420 6e65 775f 636f 6c6c 6563 7469  ort new_collecti
+00021400: 6f6e 0a0a 2020 2020 2020 2020 2320 4561  on..        # Ea
+00021410: 6765 726c 7920 636f 6d70 7574 6520 7468  gerly compute th
+00021420: 6520 6361 7465 676f 7269 6573 0a20 2020  e categories.   
+00021430: 2020 2020 2063 6174 6567 6f72 6965 732c       categories,
+00021440: 2069 6e64 6578 203d 206e 6577 5f63 6f6c   index = new_col
+00021450: 6c65 6374 696f 6e28 0a20 2020 2020 2020  lection(.       
+00021460: 2020 2020 2047 6574 4361 7465 676f 7269       GetCategori
+00021470: 6573 2873 656c 662c 2063 6f6c 756d 6e73  es(self, columns
+00021480: 3d63 6f6c 756d 6e73 2c20 696e 6465 783d  =columns, index=
+00021490: 696e 6465 782c 2073 706c 6974 5f65 7665  index, split_eve
+000214a0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
+000214b0: 2020 2020 2020 2020 292e 636f 6d70 7574          ).comput
+000214c0: 6528 290a 0a20 2020 2020 2020 2023 2053  e()..        # S
+000214d0: 6f6d 6520 6f70 6572 6174 696f 6e73 206c  ome operations l
+000214e0: 696b 6520 6765 745f 6475 6d6d 6965 7328  ike get_dummies(
+000214f0: 2920 7265 6c79 206f 6e20 7468 6520 6f72  ) rely on the or
+00021500: 6465 7220 6f66 2063 6174 6567 6f72 6965  der of categorie
+00021510: 730a 2020 2020 2020 2020 6361 7465 676f  s.        catego
+00021520: 7269 6573 203d 207b 6b3a 2076 2e73 6f72  ries = {k: v.sor
+00021530: 745f 7661 6c75 6573 2829 2066 6f72 206b  t_values() for k
+00021540: 2c20 7620 696e 2063 6174 6567 6f72 6965  , v in categorie
+00021550: 732e 6974 656d 7328 297d 0a0a 2020 2020  s.items()}..    
+00021560: 2020 2020 2320 4361 7465 676f 7269 7a65      # Categorize
+00021570: 2065 6163 6820 7061 7274 6974 696f 6e0a   each partition.
+00021580: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00021590: 6577 5f63 6f6c 6c65 6374 696f 6e28 4361  ew_collection(Ca
+000215a0: 7465 676f 7269 7a65 2873 656c 662c 2063  tegorize(self, c
+000215b0: 6174 6567 6f72 6965 732c 2069 6e64 6578  ategories, index
+000215c0: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
+000215d0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+000215e0: 6d65 290a 2020 2020 6465 6620 6e75 6e69  me).    def nuni
+000215f0: 7175 6528 7365 6c66 2c20 6178 6973 3d30  que(self, axis=0
+00021600: 2c20 6472 6f70 6e61 3d54 7275 652c 2073  , dropna=True, s
+00021610: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00021620: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
+00021630: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+00021640: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00021650: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+00021660: 4e55 6e69 7175 6543 6f6c 756d 6e73 2873  NUniqueColumns(s
+00021670: 656c 662c 2061 7869 733d 6178 6973 2c20  elf, axis=axis, 
+00021680: 6472 6f70 6e61 3d64 726f 706e 6129 290a  dropna=dropna)).
+00021690: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000216a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000216b0: 2063 6f6e 6361 7428 0a20 2020 2020 2020   concat(.       
+000216c0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+000216d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000216e0: 6f6c 2e6e 756e 6971 7565 2864 726f 706e  ol.nunique(dropn
+000216f0: 613d 6472 6f70 6e61 2c20 7370 6c69 745f  a=dropna, split_
+00021700: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00021710: 7929 2e74 6f5f 7365 7269 6573 286e 616d  y).to_series(nam
+00021720: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00021730: 2020 2020 2020 2066 6f72 206e 616d 652c         for name,
+00021740: 2063 6f6c 2069 6e20 7365 6c66 2e69 7465   col in self.ite
+00021750: 6d73 2829 0a20 2020 2020 2020 2020 2020  ms().           
+00021760: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00021770: 2020 2029 0a0a 2020 2020 6465 6620 7175     )..    def qu
+00021780: 616e 7469 6c65 2873 656c 662c 2071 3d30  antile(self, q=0
+00021790: 2e35 2c20 6178 6973 3d30 2c20 6e75 6d65  .5, axis=0, nume
+000217a0: 7269 635f 6f6e 6c79 3d46 616c 7365 2c20  ric_only=False, 
+000217b0: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
+000217c0: 293a 0a20 2020 2020 2020 2022 2222 4170  ):.        """Ap
+000217d0: 7072 6f78 696d 6174 6520 726f 772d 7769  proximate row-wi
+000217e0: 7365 2061 6e64 2070 7265 6369 7365 2063  se and precise c
+000217f0: 6f6c 756d 6e2d 7769 7365 2071 7561 6e74  olumn-wise quant
+00021800: 696c 6573 206f 6620 4461 7461 4672 616d  iles of DataFram
+00021810: 650a 0a20 2020 2020 2020 2050 6172 616d  e..        Param
+00021820: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00021830: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00021840: 2071 203a 206c 6973 742f 6172 7261 7920   q : list/array 
+00021850: 6f66 2066 6c6f 6174 732c 2064 6566 6175  of floats, defau
+00021860: 6c74 2030 2e35 2028 3530 2529 0a20 2020  lt 0.5 (50%).   
+00021870: 2020 2020 2020 2020 2049 7465 7261 626c           Iterabl
+00021880: 6520 6f66 206e 756d 6265 7273 2072 616e  e of numbers ran
+00021890: 6769 6e67 2066 726f 6d20 3020 746f 2031  ging from 0 to 1
+000218a0: 2066 6f72 2074 6865 2064 6573 6972 6564   for the desired
+000218b0: 2071 7561 6e74 696c 6573 0a20 2020 2020   quantiles.     
+000218c0: 2020 2061 7869 7320 3a20 7b30 2c20 312c     axis : {0, 1,
+000218d0: 2027 696e 6465 7827 2c20 2763 6f6c 756d   'index', 'colum
+000218e0: 6e73 277d 2028 6465 6661 756c 7420 3029  ns'} (default 0)
+000218f0: 0a20 2020 2020 2020 2020 2020 2030 206f  .            0 o
+00021900: 7220 2769 6e64 6578 2720 666f 7220 726f  r 'index' for ro
+00021910: 772d 7769 7365 2c20 3120 6f72 2027 636f  w-wise, 1 or 'co
+00021920: 6c75 6d6e 7327 2066 6f72 2063 6f6c 756d  lumns' for colum
+00021930: 6e2d 7769 7365 0a20 2020 2020 2020 206d  n-wise.        m
+00021940: 6574 686f 6420 3a20 7b27 6465 6661 756c  ethod : {'defaul
+00021950: 7427 2c20 2774 6469 6765 7374 272c 2027  t', 'tdigest', '
+00021960: 6461 736b 277d 2c20 6f70 7469 6f6e 616c  dask'}, optional
+00021970: 0a20 2020 2020 2020 2020 2020 2057 6861  .            Wha
+00021980: 7420 6d65 7468 6f64 2074 6f20 7573 652e  t method to use.
+00021990: 2042 7920 6465 6661 756c 7420 7769 6c6c   By default will
+000219a0: 2075 7365 2064 6173 6b27 7320 696e 7465   use dask's inte
+000219b0: 726e 616c 2063 7573 746f 6d0a 2020 2020  rnal custom.    
+000219c0: 2020 2020 2020 2020 616c 676f 7269 7468          algorith
+000219d0: 6d20 2860 6027 6461 736b 2760 6029 2e20  m (``'dask'``). 
+000219e0: 2049 6620 7365 7420 746f 2060 6027 7464   If set to ``'td
+000219f0: 6967 6573 7427 6060 2077 696c 6c20 7573  igest'`` will us
+00021a00: 6520 7464 6967 6573 740a 2020 2020 2020  e tdigest.      
+00021a10: 2020 2020 2020 666f 7220 666c 6f61 7473        for floats
+00021a20: 2061 6e64 2069 6e74 7320 616e 6420 6661   and ints and fa
+00021a30: 6c6c 6261 636b 2074 6f20 7468 6520 6060  llback to the ``
+00021a40: 2764 6173 6b27 6060 206f 7468 6572 7769  'dask'`` otherwi
+00021a50: 7365 2e0a 2020 2020 2020 2020 2222 220a  se..        """.
+00021a60: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
+00021a70: 6d65 7468 6f64 7320 3d20 5b22 6465 6661  methods = ["defa
+00021a80: 756c 7422 2c20 2264 6173 6b22 2c20 2274  ult", "dask", "t
+00021a90: 6469 6765 7374 225d 0a20 2020 2020 2020  digest"].       
+00021aa0: 2069 6620 6d65 7468 6f64 206e 6f74 2069   if method not i
+00021ab0: 6e20 616c 6c6f 7765 645f 6d65 7468 6f64  n allowed_method
+00021ac0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00021ad0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00021ae0: 226d 6574 686f 6420 6361 6e20 6f6e 6c79  "method can only
+00021af0: 2062 6520 2764 6566 6175 6c74 272c 2027   be 'default', '
+00021b00: 6461 736b 2720 6f72 2027 7464 6967 6573  dask' or 'tdiges
+00021b10: 7427 2229 0a20 2020 2020 2020 206d 6574  t'").        met
+00021b20: 6120 3d20 6d61 6b65 5f6d 6574 6128 0a20  a = make_meta(. 
+00021b30: 2020 2020 2020 2020 2020 206d 6574 615f             meta_
+00021b40: 6e6f 6e65 6d70 7479 2873 656c 662e 5f6d  nonempty(self._m
+00021b50: 6574 6129 2e71 7561 6e74 696c 6528 0a20  eta).quantile(. 
+00021b60: 2020 2020 2020 2020 2020 2020 2020 2071                 q
+00021b70: 3d71 2c20 6e75 6d65 7269 635f 6f6e 6c79  =q, numeric_only
+00021b80: 3d6e 756d 6572 6963 5f6f 6e6c 792c 2061  =numeric_only, a
+00021b90: 7869 733d 6178 6973 0a20 2020 2020 2020  xis=axis.       
+00021ba0: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+00021bb0: 0a0a 2020 2020 2020 2020 6966 2061 7869  ..        if axi
+00021bc0: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+00021bd0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00021be0: 6528 712c 206c 6973 7429 3a0a 2020 2020  e(q, list):.    
+00021bf0: 2020 2020 2020 2020 2020 2020 2320 4e6f              # No
+00021c00: 7420 7375 7070 6f72 7465 642c 2074 6865  t supported, the
+00021c10: 2072 6573 756c 7420 7769 6c6c 2068 6176   result will hav
+00021c20: 6520 6375 7272 656e 7420 696e 6465 7820  e current index 
+00021c30: 6173 2063 6f6c 756d 6e73 0a20 2020 2020  as columns.     
+00021c40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00021c50: 2056 616c 7565 4572 726f 7228 2227 7127   ValueError("'q'
+00021c60: 206d 7573 7420 6265 2073 6361 6c61 7220   must be scalar 
+00021c70: 7768 656e 2061 7869 733d 3120 6973 2073  when axis=1 is s
+00021c80: 7065 6369 6669 6564 2229 0a0a 2020 2020  pecified")..    
+00021c90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00021ca0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00021cb0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00021cc0: 2020 2020 4d2e 7175 616e 7469 6c65 2c0a      M.quantile,.
+00021cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ce0: 712c 0a20 2020 2020 2020 2020 2020 2020  q,.             
+00021cf0: 2020 2061 7869 732c 0a20 2020 2020 2020     axis,.       
+00021d00: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+00021d10: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+00021d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021d30: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
+00021d40: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00021d50: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+00021d60: 5f6f 6e6c 792c 0a20 2020 2020 2020 2020  _only,.         
+00021d70: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00021d80: 206e 756d 6572 6963 5f6f 6e6c 793a 0a20   numeric_only:. 
+00021d90: 2020 2020 2020 2020 2020 2066 7261 6d65             frame
+00021da0: 203d 2073 656c 662e 7365 6c65 6374 5f64   = self.select_d
+00021db0: 7479 7065 7328 0a20 2020 2020 2020 2020  types(.         
+00021dc0: 2020 2020 2020 2022 6e75 6d62 6572 222c         "number",
+00021dd0: 2065 7863 6c75 6465 3d5b 6e70 2e74 696d   exclude=[np.tim
+00021de0: 6564 656c 7461 3634 2c20 6e70 2e64 6174  edelta64, np.dat
+00021df0: 6574 696d 6536 345d 0a20 2020 2020 2020  etime64].       
+00021e00: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00021e10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00021e20: 2066 7261 6d65 203d 2073 656c 660a 0a20   frame = self.. 
+00021e30: 2020 2020 2020 2063 6f6c 6c65 6374 696f         collectio
+00021e40: 6e73 203d 205b 5d0a 2020 2020 2020 2020  ns = [].        
+00021e50: 666f 7220 5f2c 2063 6f6c 2069 6e20 6672  for _, col in fr
+00021e60: 616d 652e 6974 656d 7328 293a 0a20 2020  ame.items():.   
+00021e70: 2020 2020 2020 2020 2063 6f6c 6c65 6374           collect
+00021e80: 696f 6e73 2e61 7070 656e 6428 636f 6c2e  ions.append(col.
+00021e90: 7175 616e 7469 6c65 2871 3d71 2c20 6d65  quantile(q=q, me
+00021ea0: 7468 6f64 3d6d 6574 686f 6429 290a 0a20  thod=method)).. 
+00021eb0: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
+00021ec0: 6c6c 6563 7469 6f6e 7329 203e 2030 2061  llections) > 0 a
+00021ed0: 6e64 2069 7369 6e73 7461 6e63 6528 636f  nd isinstance(co
+00021ee0: 6c6c 6563 7469 6f6e 735b 305d 2c20 5363  llections[0], Sc
+00021ef0: 616c 6172 293a 0a20 2020 2020 2020 2020  alar):.         
+00021f00: 2020 2072 6574 7572 6e20 5f66 726f 6d5f     return _from_
+00021f10: 7363 616c 6172 7328 636f 6c6c 6563 7469  scalars(collecti
+00021f20: 6f6e 732c 206d 6574 612c 2066 7261 6d65  ons, meta, frame
+00021f30: 2e65 7870 722e 636f 6c75 6d6e 7329 0a0a  .expr.columns)..
+00021f40: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00021f50: 6f6e 6361 7428 636f 6c6c 6563 7469 6f6e  oncat(collection
+00021f60: 732c 2061 7869 733d 3129 0a0a 2020 2020  s, axis=1)..    
+00021f70: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00021f80: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00021f90: 6465 6620 6d65 6469 616e 2873 656c 662c  def median(self,
+00021fa0: 2061 7869 733d 302c 206e 756d 6572 6963   axis=0, numeric
+00021fb0: 5f6f 6e6c 793d 4661 6c73 6529 3a0a 2020  _only=False):.  
+00021fc0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+00021fd0: 2031 206f 7220 7365 6c66 2e6e 7061 7274   1 or self.npart
+00021fe0: 6974 696f 6e73 203d 3d20 313a 0a20 2020  itions == 1:.   
+00021ff0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00022000: 7365 6c66 2e6d 6564 6961 6e5f 6170 7072  self.median_appr
+00022010: 6f78 696d 6174 6528 6178 6973 3d61 7869  oximate(axis=axi
+00022020: 732c 206e 756d 6572 6963 5f6f 6e6c 793d  s, numeric_only=
+00022030: 6e75 6d65 7269 635f 6f6e 6c79 290a 2020  numeric_only).  
+00022040: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+00022050: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+00022060: 0a20 2020 2020 2020 2020 2020 2022 4461  .            "Da
+00022070: 736b 2064 6f65 736e 2774 2069 6d70 6c65  sk doesn't imple
+00022080: 6d65 6e74 2061 6e20 6578 6163 7420 6d65  ment an exact me
+00022090: 6469 616e 2069 6e20 616c 6c20 6361 7365  dian in all case
+000220a0: 7320 6173 2074 6869 7320 6973 2068 6172  s as this is har
+000220b0: 6420 746f 2064 6f20 696e 2070 6172 616c  d to do in paral
+000220c0: 6c65 6c2e 2022 0a20 2020 2020 2020 2020  lel. ".         
+000220d0: 2020 2022 5365 6520 7468 6520 606d 6564     "See the `med
+000220e0: 6961 6e5f 6170 7072 6f78 696d 6174 6560  ian_approximate`
+000220f0: 206d 6574 686f 6420 696e 7374 6561 642c   method instead,
+00022100: 2077 6869 6368 2075 7365 7320 616e 2061   which uses an a
+00022110: 7070 726f 7869 6d61 7465 2061 6c67 6f72  pproximate algor
+00022120: 6974 686d 2e22 0a20 2020 2020 2020 2029  ithm.".        )
+00022130: 0a0a 2020 2020 6465 6620 6d65 6469 616e  ..    def median
+00022140: 5f61 7070 726f 7869 6d61 7465 2873 656c  _approximate(sel
+00022150: 662c 2061 7869 733d 302c 206d 6574 686f  f, axis=0, metho
+00022160: 643d 2264 6566 6175 6c74 222c 206e 756d  d="default", num
+00022170: 6572 6963 5f6f 6e6c 793d 4661 6c73 6529  eric_only=False)
+00022180: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00022190: 7572 6e20 7468 6520 6170 7072 6f78 696d  urn the approxim
+000221a0: 6174 6520 6d65 6469 616e 206f 6620 7468  ate median of th
+000221b0: 6520 7661 6c75 6573 206f 7665 7220 7468  e values over th
+000221c0: 6520 7265 7175 6573 7465 6420 6178 6973  e requested axis
+000221d0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000221e0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+000221f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00022200: 2061 7869 7320 3a20 7b30 2c20 312c 2022   axis : {0, 1, "
+00022210: 696e 6465 7822 2c20 2263 6f6c 756d 6e73  index", "columns
+00022220: 227d 2028 6465 6661 756c 7420 3029 0a20  "} (default 0). 
+00022230: 2020 2020 2020 2020 2020 2030 206f 7220             0 or 
+00022240: 6060 2269 6e64 6578 2260 6020 666f 7220  ``"index"`` for 
+00022250: 726f 772d 7769 7365 2c20 3120 6f72 2060  row-wise, 1 or `
+00022260: 6022 636f 6c75 6d6e 7322 6060 2066 6f72  `"columns"`` for
+00022270: 2063 6f6c 756d 6e2d 7769 7365 0a20 2020   column-wise.   
+00022280: 2020 2020 206d 6574 686f 6420 3a20 7b27       method : {'
+00022290: 6465 6661 756c 7427 2c20 2774 6469 6765  default', 'tdige
+000222a0: 7374 272c 2027 6461 736b 277d 2c20 6f70  st', 'dask'}, op
+000222b0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+000222c0: 2020 2057 6861 7420 6d65 7468 6f64 2074     What method t
+000222d0: 6f20 7573 652e 2042 7920 6465 6661 756c  o use. By defaul
+000222e0: 7420 7769 6c6c 2075 7365 2044 6173 6b27  t will use Dask'
+000222f0: 7320 696e 7465 726e 616c 2063 7573 746f  s internal custo
+00022300: 6d0a 2020 2020 2020 2020 2020 2020 616c  m.            al
+00022310: 676f 7269 7468 6d20 2860 6022 6461 736b  gorithm (``"dask
+00022320: 2260 6029 2e20 2049 6620 7365 7420 746f  "``).  If set to
+00022330: 2060 6022 7464 6967 6573 7422 6060 2077   ``"tdigest"`` w
+00022340: 696c 6c20 7573 6520 7464 6967 6573 740a  ill use tdigest.
+00022350: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00022360: 666c 6f61 7473 2061 6e64 2069 6e74 7320  floats and ints 
+00022370: 616e 6420 6661 6c6c 6261 636b 2074 6f20  and fallback to 
+00022380: 7468 6520 6060 2264 6173 6b22 6060 206f  the ``"dask"`` o
+00022390: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
+000223a0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+000223b0: 7475 726e 2073 656c 662e 7175 616e 7469  turn self.quanti
+000223c0: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
+000223d0: 6178 6973 3d61 7869 732c 206d 6574 686f  axis=axis, metho
+000223e0: 643d 6d65 7468 6f64 2c20 6e75 6d65 7269  d=method, numeri
+000223f0: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
+00022400: 6e6c 790a 2020 2020 2020 2020 292e 7265  nly.        ).re
+00022410: 6e61 6d65 284e 6f6e 6529 0a0a 2020 2020  name(None)..    
+00022420: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00022430: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00022440: 6465 6620 6465 7363 7269 6265 280a 2020  def describe(.  
+00022450: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00022460: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+00022470: 4661 6c73 652c 0a20 2020 2020 2020 2070  False,.        p
+00022480: 6572 6365 6e74 696c 6573 3d4e 6f6e 652c  ercentiles=None,
+00022490: 0a20 2020 2020 2020 2070 6572 6365 6e74  .        percent
+000224a0: 696c 6573 5f6d 6574 686f 643d 2264 6566  iles_method="def
+000224b0: 6175 6c74 222c 0a20 2020 2020 2020 2069  ault",.        i
+000224c0: 6e63 6c75 6465 3d4e 6f6e 652c 0a20 2020  nclude=None,.   
+000224d0: 2020 2020 2065 7863 6c75 6465 3d4e 6f6e       exclude=Non
+000224e0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+000224f0: 2020 2320 544f 444f 3a20 6475 706c 6963    # TODO: duplic
+00022500: 6174 6564 2063 6f6c 756d 6e73 0a20 2020  ated columns.   
+00022510: 2020 2020 2069 6620 696e 636c 7564 6520       if include 
+00022520: 6973 204e 6f6e 6520 616e 6420 6578 636c  is None and excl
+00022530: 7564 6520 6973 204e 6f6e 653a 0a20 2020  ude is None:.   
+00022540: 2020 2020 2020 2020 205f 696e 636c 7564           _includ
+00022550: 6520 3d20 5b6e 702e 6e75 6d62 6572 2c20  e = [np.number, 
+00022560: 6e70 2e74 696d 6564 656c 7461 3634 2c20  np.timedelta64, 
+00022570: 6e70 2e64 6174 6574 696d 6536 345d 0a20  np.datetime64]. 
+00022580: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00022590: 6e73 203d 2073 656c 662e 5f6d 6574 612e  ns = self._meta.
+000225a0: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
+000225b0: 636c 7564 653d 5f69 6e63 6c75 6465 292e  clude=_include).
+000225c0: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+000225d0: 2020 2020 6966 206c 656e 2863 6f6c 756d      if len(colum
+000225e0: 6e73 2920 3d3d 2030 3a0a 2020 2020 2020  ns) == 0:.      
+000225f0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00022600: 7320 3d20 7365 6c66 2e5f 6d65 7461 2e63  s = self._meta.c
+00022610: 6f6c 756d 6e73 0a20 2020 2020 2020 2065  olumns.        e
+00022620: 6c69 6620 696e 636c 7564 6520 3d3d 2022  lif include == "
+00022630: 616c 6c22 3a0a 2020 2020 2020 2020 2020  all":.          
+00022640: 2020 6966 2065 7863 6c75 6465 2069 7320    if exclude is 
+00022650: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00022660: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00022670: 5661 6c75 6545 7272 6f72 2822 6578 636c  ValueError("excl
+00022680: 7564 6520 6d75 7374 2062 6520 4e6f 6e65  ude must be None
+00022690: 2077 6865 6e20 696e 636c 7564 6520 6973   when include is
+000226a0: 2027 616c 6c27 2229 0a20 2020 2020 2020   'all'").       
+000226b0: 2020 2020 2063 6f6c 756d 6e73 203d 2073       columns = s
+000226c0: 656c 662e 5f6d 6574 612e 636f 6c75 6d6e  elf._meta.column
+000226d0: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+000226e0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+000226f0: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
+00022700: 2e73 656c 6563 745f 6474 7970 6573 2869  .select_dtypes(i
+00022710: 6e63 6c75 6465 3d69 6e63 6c75 6465 2c20  nclude=include, 
+00022720: 6578 636c 7564 653d 6578 636c 7564 6529  exclude=exclude)
+00022730: 2e63 6f6c 756d 6e73 0a0a 2020 2020 2020  .columns..      
+00022740: 2020 7374 6174 7320 3d20 5b0a 2020 2020    stats = [.    
+00022750: 2020 2020 2020 2020 7365 6c66 5b63 6f6c          self[col
+00022760: 5d2e 6465 7363 7269 6265 280a 2020 2020  ].describe(.    
+00022770: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00022780: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00022790: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+000227a0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
+000227b0: 3d70 6572 6365 6e74 696c 6573 2c0a 2020  =percentiles,.  
+000227c0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+000227d0: 7263 656e 7469 6c65 735f 6d65 7468 6f64  rcentiles_method
+000227e0: 3d70 6572 6365 6e74 696c 6573 5f6d 6574  =percentiles_met
+000227f0: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
+00022800: 2029 0a20 2020 2020 2020 2020 2020 2066   ).            f
+00022810: 6f72 2063 6f6c 2069 6e20 636f 6c75 6d6e  or col in column
+00022820: 730a 2020 2020 2020 2020 5d0a 2020 2020  s.        ].    
+00022830: 2020 2020 7265 7475 726e 2063 6f6e 6361      return conca
+00022840: 7428 7374 6174 732c 2061 7869 733d 3129  t(stats, axis=1)
+00022850: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00022860: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00022870: 290a 2020 2020 6465 6620 706f 7028 7365  ).    def pop(se
+00022880: 6c66 2c20 6974 656d 293a 0a20 2020 2020  lf, item):.     
+00022890: 2020 206f 7574 203d 2073 656c 665b 6974     out = self[it
+000228a0: 656d 5d0a 2020 2020 2020 2020 7365 6c66  em].        self
+000228b0: 2e5f 6578 7072 203d 2065 7870 722e 4472  ._expr = expr.Dr
+000228c0: 6f70 2873 656c 662c 2063 6f6c 756d 6e73  op(self, columns
+000228d0: 3d5b 6974 656d 5d29 0a20 2020 2020 2020  =[item]).       
+000228e0: 2072 6574 7572 6e20 6f75 740a 0a20 2020   return out..   
+000228f0: 2064 6566 2069 6e66 6f28 7365 6c66 2c20   def info(self, 
+00022900: 6275 663d 4e6f 6e65 2c20 7665 7262 6f73  buf=None, verbos
+00022910: 653d 4661 6c73 652c 206d 656d 6f72 795f  e=False, memory_
+00022920: 7573 6167 653d 4661 6c73 6529 3a0a 2020  usage=False):.  
+00022930: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00022940: 2020 436f 6e63 6973 6520 7375 6d6d 6172    Concise summar
+00022950: 7920 6f66 2061 2044 6173 6b20 4461 7461  y of a Dask Data
+00022960: 4672 616d 650a 2020 2020 2020 2020 2222  Frame.        ""
+00022970: 220a 2020 2020 2020 2020 6966 2062 7566  ".        if buf
+00022980: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00022990: 2020 2020 2020 696d 706f 7274 2073 7973        import sys
+000229a0: 0a0a 2020 2020 2020 2020 2020 2020 6275  ..            bu
+000229b0: 6620 3d20 7379 732e 7374 646f 7574 0a20  f = sys.stdout. 
+000229c0: 2020 2020 2020 206c 696e 6573 203d 205b         lines = [
+000229d0: 7374 7228 7479 7065 2873 656c 6629 292e  str(type(self)).
+000229e0: 7265 706c 6163 6528 222e 5f63 6f6c 6c65  replace("._colle
+000229f0: 6374 696f 6e22 2c20 2222 295d 0a0a 2020  ction", "")]..  
+00022a00: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00022a10: 662e 636f 6c75 6d6e 7329 203d 3d20 303a  f.columns) == 0:
+00022a20: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+00022a30: 6573 2e61 7070 656e 6428 6622 7b74 7970  es.append(f"{typ
+00022a40: 6528 7365 6c66 2e69 6e64 6578 2e5f 6d65  e(self.index._me
+00022a50: 7461 292e 5f5f 6e61 6d65 5f5f 7d3a 2030  ta).__name__}: 0
+00022a60: 2065 6e74 7269 6573 2229 0a20 2020 2020   entries").     
+00022a70: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
+00022a80: 656e 6428 6622 456d 7074 7920 7b74 7970  end(f"Empty {typ
+00022a90: 6528 7365 6c66 292e 5f5f 6e61 6d65 5f5f  e(self).__name__
+00022aa0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+00022ab0: 7075 745f 6c69 6e65 7328 6275 662c 206c  put_lines(buf, l
+00022ac0: 696e 6573 290a 2020 2020 2020 2020 2020  ines).          
+00022ad0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00022ae0: 2020 2320 4772 6f75 7020 616e 6420 6578    # Group and ex
+00022af0: 6563 7574 6520 7468 6520 7265 7175 6972  ecute the requir
+00022b00: 6564 2063 6f6d 7075 7461 7469 6f6e 730a  ed computations.
+00022b10: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
+00022b20: 696f 6e73 203d 207b 7d0a 2020 2020 2020  ions = {}.      
+00022b30: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+00022b40: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
+00022b50: 6174 696f 6e73 2e75 7064 6174 6528 7b22  ations.update({"
+00022b60: 696e 6465 7822 3a20 7365 6c66 2e69 6e64  index": self.ind
+00022b70: 6578 2c20 2263 6f75 6e74 223a 2073 656c  ex, "count": sel
+00022b80: 662e 636f 756e 7428 297d 290a 2020 2020  f.count()}).    
+00022b90: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
+00022ba0: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
+00022bb0: 2063 6f6d 7075 7461 7469 6f6e 735b 226d   computations["m
+00022bc0: 656d 6f72 795f 7573 6167 6522 5d20 3d20  emory_usage"] = 
+00022bd0: 7365 6c66 2e6d 656d 6f72 795f 7573 6167  self.memory_usag
+00022be0: 6528 6465 6570 3d54 7275 652c 2069 6e64  e(deep=True, ind
+00022bf0: 6578 3d54 7275 6529 0a0a 2020 2020 2020  ex=True)..      
+00022c00: 2020 636f 6d70 7574 6174 696f 6e73 203d    computations =
+00022c10: 2064 6963 7428 7a69 7028 636f 6d70 7574   dict(zip(comput
+00022c20: 6174 696f 6e73 2e6b 6579 7328 292c 2063  ations.keys(), c
+00022c30: 6f6d 7075 7465 282a 636f 6d70 7574 6174  ompute(*computat
+00022c40: 696f 6e73 2e76 616c 7565 7328 2929 2929  ions.values())))
+00022c50: 0a0a 2020 2020 2020 2020 6966 2076 6572  ..        if ver
+00022c60: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+00022c70: 2020 696d 706f 7274 2074 6578 7477 7261    import textwra
+00022c80: 700a 0a20 2020 2020 2020 2020 2020 2069  p..            i
+00022c90: 6e64 6578 203d 2063 6f6d 7075 7461 7469  ndex = computati
+00022ca0: 6f6e 735b 2269 6e64 6578 225d 0a20 2020  ons["index"].   
+00022cb0: 2020 2020 2020 2020 2063 6f75 6e74 7320           counts 
+00022cc0: 3d20 636f 6d70 7574 6174 696f 6e73 5b22  = computations["
+00022cd0: 636f 756e 7422 5d0a 2020 2020 2020 2020  count"].        
+00022ce0: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
+00022cf0: 2869 6e64 6578 5f73 756d 6d61 7279 2869  (index_summary(i
+00022d00: 6e64 6578 2929 0a20 2020 2020 2020 2020  ndex)).         
+00022d10: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
+00022d20: 6622 4461 7461 2063 6f6c 756d 6e73 2028  f"Data columns (
+00022d30: 746f 7461 6c20 7b6c 656e 2873 656c 662e  total {len(self.
+00022d40: 636f 6c75 6d6e 7329 7d20 636f 6c75 6d6e  columns)} column
+00022d50: 7329 3a22 290a 0a20 2020 2020 2020 2020  s):")..         
+00022d60: 2020 2066 726f 6d20 7061 6e64 6173 2e69     from pandas.i
+00022d70: 6f2e 666f 726d 6174 732e 7072 696e 7469  o.formats.printi
+00022d80: 6e67 2069 6d70 6f72 7420 7070 7269 6e74  ng import pprint
+00022d90: 5f74 6869 6e67 0a0a 2020 2020 2020 2020  _thing..        
+00022da0: 2020 2020 7370 6163 6520 3d20 6d61 7828      space = max(
+00022db0: 6c65 6e28 7070 7269 6e74 5f74 6869 6e67  len(pprint_thing
+00022dc0: 286b 2929 2066 6f72 206b 2069 6e20 7365  (k)) for k in se
+00022dd0: 6c66 2e63 6f6c 756d 6e73 2920 2b20 310a  lf.columns) + 1.
+00022de0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00022df0: 6d6e 5f77 6964 7468 203d 206d 6178 2873  mn_width = max(s
+00022e00: 7061 6365 2c20 3729 0a0a 2020 2020 2020  pace, 7)..      
+00022e10: 2020 2020 2020 6865 6164 6572 203d 2028        header = (
+00022e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022e30: 2074 6578 7477 7261 702e 6465 6465 6e74   textwrap.dedent
+00022e40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00022e50: 2020 2020 2020 2222 225c 0a20 2020 2020        """\.     
+00022e60: 2020 2020 2020 2020 2320 2020 7b7b 636f          #   {{co
+00022e70: 6c75 6d6e 3a3c 7b63 6f6c 756d 6e5f 7769  lumn:<{column_wi
+00022e80: 6474 687d 7d7d 204e 6f6e 2d4e 756c 6c20  dth}}} Non-Null 
+00022e90: 436f 756e 7420 2044 7479 7065 0a20 2020  Count  Dtype.   
+00022ea0: 2020 2020 2020 2020 202d 2d2d 2020 7b7b           ---  {{
+00022eb0: 756e 6465 726c 3a3c 7b63 6f6c 756d 6e5f  underl:<{column_
+00022ec0: 7769 6474 687d 7d7d 202d 2d2d 2d2d 2d2d  width}}} -------
+00022ed0: 2d2d 2d2d 2d2d 2d20 202d 2d2d 2d2d 2222  -------  -----""
+00022ee0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022ef0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00022f00: 2020 2020 2e66 6f72 6d61 7428 636f 6c75      .format(colu
+00022f10: 6d6e 5f77 6964 7468 3d63 6f6c 756d 6e5f  mn_width=column_
+00022f20: 7769 6474 6829 0a20 2020 2020 2020 2020  width).         
+00022f30: 2020 2020 2020 202e 666f 726d 6174 2863         .format(c
+00022f40: 6f6c 756d 6e3d 2243 6f6c 756d 6e22 2c20  olumn="Column", 
+00022f50: 756e 6465 726c 3d22 2d2d 2d2d 2d2d 2229  underl="------")
+00022f60: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00022f70: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00022f80: 6e5f 7465 6d70 6c61 7465 203d 2074 6578  n_template = tex
+00022f90: 7477 7261 702e 6465 6465 6e74 280a 2020  twrap.dedent(.  
+00022fa0: 2020 2020 2020 2020 2020 2020 2020 2222                ""
+00022fb0: 225c 0a20 2020 2020 2020 2020 2020 207b  "\.            {
+00022fc0: 7b69 3a5e 337d 7d20 207b 7b6e 616d 653a  {i:^3}}  {{name:
+00022fd0: 3c7b 636f 6c75 6d6e 5f77 6964 7468 7d7d  <{column_width}}
+00022fe0: 7d20 7b7b 636f 756e 747d 7d20 6e6f 6e2d  } {{count}} non-
+00022ff0: 6e75 6c6c 2020 2020 2020 7b7b 6474 7970  null      {{dtyp
+00023000: 657d 7d22 2222 2e66 6f72 6d61 7428 0a20  e}}""".format(. 
+00023010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023020: 2020 2063 6f6c 756d 6e5f 7769 6474 683d     column_width=
+00023030: 636f 6c75 6d6e 5f77 6964 7468 0a20 2020  column_width.   
+00023040: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00023050: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00023060: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
+00023070: 696e 666f 203d 205b 0a20 2020 2020 2020  info = [.       
+00023080: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
+00023090: 7465 6d70 6c61 7465 2e66 6f72 6d61 7428  template.format(
+000230a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000230b0: 2020 2020 2069 3d70 7072 696e 745f 7468       i=pprint_th
+000230c0: 696e 6728 6929 2c0a 2020 2020 2020 2020  ing(i),.        
+000230d0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+000230e0: 3d70 7072 696e 745f 7468 696e 6728 6e61  =pprint_thing(na
+000230f0: 6d65 292c 0a20 2020 2020 2020 2020 2020  me),.           
+00023100: 2020 2020 2020 2020 2063 6f75 6e74 3d70           count=p
+00023110: 7072 696e 745f 7468 696e 6728 636f 756e  print_thing(coun
+00023120: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
+00023130: 2020 2020 2020 2020 6474 7970 653d 7070          dtype=pp
+00023140: 7269 6e74 5f74 6869 6e67 2864 7479 7065  rint_thing(dtype
+00023150: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00023160: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00023170: 2020 2020 2066 6f72 2069 2c20 286e 616d       for i, (nam
+00023180: 652c 2063 6f75 6e74 2c20 6474 7970 6529  e, count, dtype)
+00023190: 2069 6e20 656e 756d 6572 6174 6528 0a20   in enumerate(. 
+000231a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231b0: 2020 2023 204e 4f54 453a 2055 7365 2060     # NOTE: Use `
+000231c0: 636f 756e 7473 2e76 616c 7565 7360 2066  counts.values` f
+000231d0: 6f72 2063 7564 6620 7375 7070 6f72 740a  or cudf support.
+000231e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231f0: 2020 2020 7a69 7028 7365 6c66 2e63 6f6c      zip(self.col
+00023200: 756d 6e73 2c20 636f 756e 7473 2e76 616c  umns, counts.val
+00023210: 7565 732c 2073 656c 662e 6474 7970 6573  ues, self.dtypes
+00023220: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00023230: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00023240: 5d0a 2020 2020 2020 2020 2020 2020 6c69  ].            li
+00023250: 6e65 732e 6578 7465 6e64 2868 6561 6465  nes.extend(heade
+00023260: 722e 7370 6c69 7428 225c 6e22 2929 0a20  r.split("\n")). 
+00023270: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00023280: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
+00023290: 696e 666f 203d 205b 696e 6465 785f 7375  info = [index_su
+000232a0: 6d6d 6172 7928 7365 6c66 2e63 6f6c 756d  mmary(self.colum
+000232b0: 6e73 2c20 6e61 6d65 3d22 436f 6c75 6d6e  ns, name="Column
+000232c0: 7322 295d 0a0a 2020 2020 2020 2020 6c69  s")]..        li
+000232d0: 6e65 732e 6578 7465 6e64 2863 6f6c 756d  nes.extend(colum
+000232e0: 6e5f 696e 666f 290a 2020 2020 2020 2020  n_info).        
+000232f0: 6474 7970 655f 636f 756e 7473 203d 205b  dtype_counts = [
+00023300: 0a20 2020 2020 2020 2020 2020 2022 2573  .            "%s
+00023310: 2825 6429 2220 2520 6b20 666f 7220 6b20  (%d)" % k for k 
+00023320: 696e 2073 6f72 7465 6428 7365 6c66 2e64  in sorted(self.d
+00023330: 7479 7065 732e 7661 6c75 655f 636f 756e  types.value_coun
+00023340: 7473 2829 2e69 7465 6d73 2829 2c20 6b65  ts().items(), ke
+00023350: 793d 7374 7229 0a20 2020 2020 2020 205d  y=str).        ]
+00023360: 0a20 2020 2020 2020 206c 696e 6573 2e61  .        lines.a
+00023370: 7070 656e 6428 2264 7479 7065 733a 207b  ppend("dtypes: {
+00023380: 7d22 2e66 6f72 6d61 7428 222c 2022 2e6a  }".format(", ".j
+00023390: 6f69 6e28 6474 7970 655f 636f 756e 7473  oin(dtype_counts
+000233a0: 2929 290a 0a20 2020 2020 2020 2069 6620  )))..        if 
+000233b0: 6d65 6d6f 7279 5f75 7361 6765 3a0a 2020  memory_usage:.  
+000233c0: 2020 2020 2020 2020 2020 6d65 6d6f 7279            memory
+000233d0: 5f69 6e74 203d 2063 6f6d 7075 7461 7469  _int = computati
+000233e0: 6f6e 735b 226d 656d 6f72 795f 7573 6167  ons["memory_usag
+000233f0: 6522 5d2e 7375 6d28 290a 2020 2020 2020  e"].sum().      
+00023400: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
+00023410: 6e64 2866 226d 656d 6f72 7920 7573 6167  nd(f"memory usag
+00023420: 653a 207b 6d65 6d6f 7279 5f72 6570 7228  e: {memory_repr(
+00023430: 6d65 6d6f 7279 5f69 6e74 297d 5c6e 2229  memory_int)}\n")
+00023440: 0a0a 2020 2020 2020 2020 7075 745f 6c69  ..        put_li
+00023450: 6e65 7328 6275 662c 206c 696e 6573 290a  nes(buf, lines).
+00023460: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00023470: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00023480: 0a20 2020 2064 6566 2063 6f76 2873 656c  .    def cov(sel
+00023490: 662c 206d 696e 5f70 6572 696f 6473 3d4e  f, min_periods=N
+000234a0: 6f6e 652c 206e 756d 6572 6963 5f6f 6e6c  one, numeric_onl
+000234b0: 793d 4661 6c73 652c 2073 706c 6974 5f65  y=False, split_e
+000234c0: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
+000234d0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000234e0: 2e5f 636f 7628 6d69 6e5f 7065 7269 6f64  ._cov(min_period
+000234f0: 732c 206e 756d 6572 6963 5f6f 6e6c 792c  s, numeric_only,
+00023500: 2073 706c 6974 5f65 7665 7279 290a 0a20   split_every).. 
+00023510: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00023520: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00023530: 2020 2064 6566 2063 6f72 7228 0a20 2020     def corr(.   
+00023540: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00023550: 2020 206d 6574 686f 643d 2270 6561 7273     method="pears
+00023560: 6f6e 222c 0a20 2020 2020 2020 206d 696e  on",.        min
+00023570: 5f70 6572 696f 6473 3d4e 6f6e 652c 0a20  _periods=None,. 
+00023580: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+00023590: 6e6c 793d 4661 6c73 652c 0a20 2020 2020  nly=False,.     
+000235a0: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+000235b0: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
+000235c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000235d0: 2e5f 636f 7272 286d 6574 686f 642c 206d  ._corr(method, m
+000235e0: 696e 5f70 6572 696f 6473 2c20 6e75 6d65  in_periods, nume
+000235f0: 7269 635f 6f6e 6c79 2c20 7370 6c69 745f  ric_only, split_
+00023600: 6576 6572 7929 0a0a 2020 2020 4064 6572  every)..    @der
+00023610: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00023620: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00023630: 746f 5f73 7472 696e 6728 7365 6c66 2c20  to_string(self, 
+00023640: 6d61 785f 726f 7773 3d35 293a 0a20 2020  max_rows=5):.   
+00023650: 2020 2020 2023 206f 7074 696f 6e5f 636f       # option_co
+00023660: 6e74 6578 7420 646f 6573 6e27 7420 6166  ntext doesn't af
+00023670: 6665 6374 0a20 2020 2020 2020 2072 6574  fect.        ret
+00023680: 7572 6e20 7365 6c66 2e5f 7265 7072 5f64  urn self._repr_d
+00023690: 6174 6128 292e 746f 5f73 7472 696e 6728  ata().to_string(
+000236a0: 6d61 785f 726f 7773 3d6d 6178 5f72 6f77  max_rows=max_row
+000236b0: 732c 2073 686f 775f 6469 6d65 6e73 696f  s, show_dimensio
+000236c0: 6e73 3d46 616c 7365 290a 0a20 2020 2040  ns=False)..    @
+000236d0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000236e0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000236f0: 6566 2074 6f5f 6874 6d6c 2873 656c 662c  ef to_html(self,
+00023700: 206d 6178 5f72 6f77 733d 3529 3a0a 2020   max_rows=5):.  
+00023710: 2020 2020 2020 2320 7064 2e53 6572 6965        # pd.Serie
+00023720: 7320 646f 6573 6e27 7420 6861 7665 2068  s doesn't have h
+00023730: 746d 6c20 7265 7072 0a20 2020 2020 2020  tml repr.       
+00023740: 2064 6174 6120 3d20 7365 6c66 2e5f 7265   data = self._re
+00023750: 7072 5f64 6174 6128 292e 746f 5f68 746d  pr_data().to_htm
+00023760: 6c28 6d61 785f 726f 7773 3d6d 6178 5f72  l(max_rows=max_r
+00023770: 6f77 732c 2073 686f 775f 6469 6d65 6e73  ows, show_dimens
+00023780: 696f 6e73 3d46 616c 7365 290a 2020 2020  ions=False).    
+00023790: 2020 2020 6e5f 6578 7072 203d 206c 656e      n_expr = len
+000237a0: 287b 652e 5f6e 616d 6520 666f 7220 6520  ({e._name for e 
+000237b0: 696e 2073 656c 662e 7761 6c6b 2829 7d29  in self.walk()})
+000237c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000237d0: 6765 745f 7465 6d70 6c61 7465 2822 6461  get_template("da
+000237e0: 7461 6672 616d 652e 6874 6d6c 2e6a 3222  taframe.html.j2"
+000237f0: 292e 7265 6e64 6572 280a 2020 2020 2020  ).render(.      
+00023800: 2020 2020 2020 6461 7461 3d64 6174 612c        data=data,
+00023810: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00023820: 653d 7365 6c66 2e5f 6e61 6d65 2c0a 2020  e=self._name,.  
+00023830: 2020 2020 2020 2020 2020 6c61 7965 7273            layers
+00023840: 3d6d 6179 6265 5f70 6c75 7261 6c69 7a65  =maybe_pluralize
+00023850: 286e 5f65 7870 722c 2022 6578 7072 6573  (n_expr, "expres
+00023860: 7369 6f6e 2229 2c0a 2020 2020 2020 2020  sion"),.        
+00023870: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00023880: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00023890: 6529 0a20 2020 2064 6566 206d 656c 7428  e).    def melt(
+000238a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000238b0: 2020 2020 2020 2069 645f 7661 7273 3d4e         id_vars=N
+000238c0: 6f6e 652c 0a20 2020 2020 2020 2076 616c  one,.        val
+000238d0: 7565 5f76 6172 733d 4e6f 6e65 2c0a 2020  ue_vars=None,.  
+000238e0: 2020 2020 2020 7661 725f 6e61 6d65 3d4e        var_name=N
+000238f0: 6f6e 652c 0a20 2020 2020 2020 2076 616c  one,.        val
+00023900: 7565 5f6e 616d 653d 2276 616c 7565 222c  ue_name="value",
+00023910: 0a20 2020 2020 2020 2063 6f6c 5f6c 6576  .        col_lev
+00023920: 656c 3d4e 6f6e 652c 0a20 2020 2029 3a0a  el=None,.    ):.
+00023930: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00023940: 656c 7428 0a20 2020 2020 2020 2020 2020  elt(.           
+00023950: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+00023960: 2020 2069 645f 7661 7273 3d69 645f 7661     id_vars=id_va
+00023970: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+00023980: 7661 6c75 655f 7661 7273 3d76 616c 7565  value_vars=value
+00023990: 5f76 6172 732c 0a20 2020 2020 2020 2020  _vars,.         
+000239a0: 2020 2076 6172 5f6e 616d 653d 7661 725f     var_name=var_
+000239b0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+000239c0: 2020 7661 6c75 655f 6e61 6d65 3d76 616c    value_name=val
+000239d0: 7565 5f6e 616d 652c 0a20 2020 2020 2020  ue_name,.       
+000239e0: 2020 2020 2063 6f6c 5f6c 6576 656c 3d63       col_level=c
+000239f0: 6f6c 5f6c 6576 656c 2c0a 2020 2020 2020  ol_level,.      
+00023a00: 2020 290a 0a20 2020 2064 6566 205f 7265    )..    def _re
+00023a10: 7072 5f64 6174 6128 7365 6c66 293a 0a20  pr_data(self):. 
+00023a20: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00023a30: 6c66 2e5f 6d65 7461 0a20 2020 2020 2020  lf._meta.       
+00023a40: 2069 6e64 6578 203d 2073 656c 662e 5f72   index = self._r
+00023a50: 6570 725f 6469 7669 7369 6f6e 730a 2020  epr_divisions.  
+00023a60: 2020 2020 2020 636f 6c73 203d 206d 6574        cols = met
+00023a70: 612e 636f 6c75 6d6e 730a 2020 2020 2020  a.columns.      
+00023a80: 2020 6966 206c 656e 2863 6f6c 7329 203d    if len(cols) =
+00023a90: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00023aa0: 2073 6572 6965 735f 6466 203d 2070 642e   series_df = pd.
+00023ab0: 4461 7461 4672 616d 6528 5b5b 5d5d 202a  DataFrame([[]] *
+00023ac0: 206c 656e 2869 6e64 6578 292c 2063 6f6c   len(index), col
+00023ad0: 756d 6e73 3d63 6f6c 732c 2069 6e64 6578  umns=cols, index
+00023ae0: 3d69 6e64 6578 290a 2020 2020 2020 2020  =index).        
+00023af0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00023b00: 2020 7365 7269 6573 5f64 6620 3d20 7064    series_df = pd
+00023b10: 2e63 6f6e 6361 7428 0a20 2020 2020 2020  .concat(.       
+00023b20: 2020 2020 2020 2020 205b 5f72 6570 725f           [_repr_
+00023b30: 6461 7461 5f73 6572 6965 7328 732c 2069  data_series(s, i
+00023b40: 6e64 6578 3d69 6e64 6578 2920 666f 7220  ndex=index) for 
+00023b50: 5f2c 2073 2069 6e20 6d65 7461 2e69 7465  _, s in meta.ite
+00023b60: 6d73 2829 5d2c 2061 7869 733d 310a 2020  ms()], axis=1.  
+00023b70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00023b80: 2020 2020 7265 7475 726e 2073 6572 6965      return serie
+00023b90: 735f 6466 0a0a 0a63 6c61 7373 2053 6572  s_df...class Ser
+00023ba0: 6965 7328 4672 616d 6542 6173 6529 3a0a  ies(FrameBase):.
+00023bb0: 2020 2020 2222 2253 6572 6965 732d 6c69      """Series-li
+00023bc0: 6b65 2045 7870 7220 436f 6c6c 6563 7469  ke Expr Collecti
+00023bd0: 6f6e 2e0a 0a20 2020 2054 6865 2063 6f6e  on...    The con
+00023be0: 7374 7275 6374 6f72 2074 616b 6573 2074  structor takes t
+00023bf0: 6865 2065 7870 7265 7373 696f 6e20 7468  he expression th
+00023c00: 6174 2072 6570 7265 7365 6e74 7320 7468  at represents th
+00023c10: 6520 7175 6572 7920 6173 2069 6e70 7574  e query as input
+00023c20: 2e20 5468 6520 636c 6173 730a 2020 2020  . The class.    
+00023c30: 6973 206e 6f74 206d 6561 6e74 2074 6f20  is not meant to 
+00023c40: 6265 2069 6e73 7461 6e74 6961 7465 6420  be instantiated 
+00023c50: 6469 7265 6374 6c79 2e20 496e 7374 6561  directly. Instea
+00023c60: 642c 2075 7365 206f 6e65 206f 6620 7468  d, use one of th
+00023c70: 6520 494f 2063 6f6e 6e65 6374 6f72 7320  e IO connectors 
+00023c80: 6672 6f6d 0a20 2020 2044 6173 6b2e 0a20  from.    Dask.. 
+00023c90: 2020 2022 2222 0a0a 2020 2020 5f61 6363     """..    _acc
+00023ca0: 6573 736f 7273 3a20 436c 6173 7356 6172  essors: ClassVar
+00023cb0: 5b73 6574 5b73 7472 5d5d 203d 2073 6574  [set[str]] = set
+00023cc0: 2829 0a20 2020 205f 7061 7274 6974 696f  ().    _partitio
+00023cd0: 6e5f 7479 7065 203d 2070 642e 5365 7269  n_type = pd.Seri
+00023ce0: 6573 0a0a 2020 2020 4070 726f 7065 7274  es..    @propert
+00023cf0: 790a 2020 2020 6465 6620 7368 6170 6528  y.    def shape(
+00023d00: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00023d10: 2222 0a20 2020 2020 2020 2052 6574 7572  "".        Retur
+00023d20: 6e20 6120 7475 706c 6520 7265 7072 6573  n a tuple repres
+00023d30: 656e 7469 6e67 2074 6865 2064 696d 656e  enting the dimen
+00023d40: 7369 6f6e 616c 6974 7920 6f66 2074 6865  sionality of the
+00023d50: 2044 6174 6146 7261 6d65 2e0a 0a20 2020   DataFrame...   
+00023d60: 2020 2020 2054 6865 206e 756d 6265 7220       The number 
+00023d70: 6f66 2072 6f77 7320 6973 2061 2044 656c  of rows is a Del
+00023d80: 6179 6564 2072 6573 756c 742e 2054 6865  ayed result. The
+00023d90: 206e 756d 6265 7220 6f66 2063 6f6c 756d   number of colum
+00023da0: 6e73 0a20 2020 2020 2020 2069 7320 6120  ns.        is a 
+00023db0: 636f 6e63 7265 7465 2069 6e74 6567 6572  concrete integer
+00023dc0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00023dd0: 2020 2020 2020 7265 7475 726e 2028 7365        return (se
+00023de0: 6c66 2e73 697a 652c 290a 0a20 2020 2040  lf.size,)..    @
+00023df0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00023e00: 2061 7865 7328 7365 6c66 293a 0a20 2020   axes(self):.   
+00023e10: 2020 2020 2072 6574 7572 6e20 5b73 656c       return [sel
+00023e20: 662e 696e 6465 785d 0a0a 2020 2020 4070  f.index]..    @p
+00023e30: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00023e40: 6e64 696d 2873 656c 6629 3a0a 2020 2020  ndim(self):.    
+00023e50: 2020 2020 2222 2252 6574 7572 6e20 6469      """Return di
+00023e60: 6d65 6e73 696f 6e61 6c69 7479 2222 220a  mensionality""".
+00023e70: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
+00023e80: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00023e90: 2020 2020 6465 6620 5f65 6c65 6d77 6973      def _elemwis
+00023ea0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00023eb0: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+00023ec0: 0a0a 2020 2020 6465 6620 5f5f 6469 725f  ..    def __dir_
+00023ed0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00023ee0: 206f 203d 2073 6574 2864 6972 2874 7970   o = set(dir(typ
+00023ef0: 6528 7365 6c66 2929 290a 2020 2020 2020  e(self))).      
+00023f00: 2020 6f2e 7570 6461 7465 2873 656c 662e    o.update(self.
+00023f10: 5f5f 6469 6374 5f5f 290a 2020 2020 2020  __dict__).      
+00023f20: 2020 6f2e 7570 6461 7465 2873 6574 2864    o.update(set(d
+00023f30: 6972 2865 7870 722e 4578 7072 2929 290a  ir(expr.Expr))).
+00023f40: 2020 2020 2020 2020 666f 7220 6163 6365          for acce
+00023f50: 7373 6f72 2069 6e20 5b22 6361 7422 2c20  ssor in ["cat", 
+00023f60: 2273 7472 225d 3a0a 2020 2020 2020 2020  "str"]:.        
+00023f70: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
+00023f80: 7472 2873 656c 662e 5f6d 6574 612c 2061  tr(self._meta, a
+00023f90: 6363 6573 736f 7229 3a0a 2020 2020 2020  ccessor):.      
+00023fa0: 2020 2020 2020 2020 2020 6f2e 7265 6d6f            o.remo
+00023fb0: 7665 2861 6363 6573 736f 7229 0a20 2020  ve(accessor).   
+00023fc0: 2020 2020 2072 6574 7572 6e20 6c69 7374       return list
+00023fd0: 286f 290a 0a20 2020 2064 6566 205f 5f63  (o)..    def __c
+00023fe0: 6f6e 7461 696e 735f 5f28 7365 6c66 2c20  ontains__(self, 
+00023ff0: 6974 656d 293a 0a20 2020 2020 2020 2072  item):.        r
+00024000: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00024010: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+00024020: 2020 2020 2020 2255 7369 6e67 2027 696e        "Using 'in
+00024030: 2720 746f 2074 6573 7420 666f 7220 6d65  ' to test for me
+00024040: 6d62 6572 7368 6970 2069 7320 6e6f 7420  mbership is not 
+00024050: 7375 7070 6f72 7465 642e 2055 7365 2074  supported. Use t
+00024060: 6865 2076 616c 7565 7320 696e 7374 6561  he values instea
+00024070: 6422 0a20 2020 2020 2020 2029 0a0a 2020  d".        )..  
+00024080: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00024090: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+000240a0: 6566 205f 5f69 7465 725f 5f28 7365 6c66  ef __iter__(self
+000240b0: 293a 0a20 2020 2020 2020 2066 7261 6d65  ):.        frame
+000240c0: 203d 2073 656c 662e 6f70 7469 6d69 7a65   = self.optimize
+000240d0: 2829 0a20 2020 2020 2020 2066 6f72 2069  ().        for i
+000240e0: 2069 6e20 7261 6e67 6528 7365 6c66 2e6e   in range(self.n
+000240f0: 7061 7274 6974 696f 6e73 293a 0a20 2020  partitions):.   
+00024100: 2020 2020 2020 2020 2073 203d 2066 7261           s = fra
+00024110: 6d65 2e67 6574 5f70 6172 7469 7469 6f6e  me.get_partition
+00024120: 2869 292e 636f 6d70 7574 6528 290a 2020  (i).compute().  
+00024130: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00024140: 6672 6f6d 2073 0a0a 2020 2020 6465 6620  from s..    def 
+00024150: 5f5f 6765 7469 7465 6d5f 5f28 7365 6c66  __getitem__(self
+00024160: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
+00024170: 6966 2069 7369 6e73 7461 6e63 6528 6b65  if isinstance(ke
+00024180: 792c 2053 6572 6965 7329 206f 7220 7365  y, Series) or se
+00024190: 6c66 2e6e 7061 7274 6974 696f 6e73 203d  lf.npartitions =
+000241a0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000241b0: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
+000241c0: 5f5f 6765 7469 7465 6d5f 5f28 6b65 7929  __getitem__(key)
+000241d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000241e0: 7365 6c66 2e6c 6f63 5b6b 6579 5d0a 0a20  self.loc[key].. 
+000241f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00024200: 2064 6566 206e 616d 6528 7365 6c66 293a   def name(self):
+00024210: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024220: 7365 6c66 2e65 7870 722e 5f6d 6574 612e  self.expr._meta.
+00024230: 6e61 6d65 0a0a 2020 2020 406e 616d 652e  name..    @name.
+00024240: 7365 7474 6572 0a20 2020 2064 6566 206e  setter.    def n
+00024250: 616d 6528 7365 6c66 2c20 6e61 6d65 293a  ame(self, name):
+00024260: 0a20 2020 2020 2020 2073 656c 662e 5f65  .        self._e
+00024270: 7870 7220 3d20 7365 6c66 2e72 656e 616d  xpr = self.renam
+00024280: 6528 696e 6465 783d 6e61 6d65 292e 5f65  e(index=name)._e
+00024290: 7870 720a 0a20 2020 2040 7072 6f70 6572  xpr..    @proper
+000242a0: 7479 0a20 2020 2064 6566 2064 7479 7065  ty.    def dtype
+000242b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000242c0: 7265 7475 726e 2073 656c 662e 6578 7072  return self.expr
+000242d0: 2e5f 6d65 7461 2e64 7479 7065 0a0a 2020  ._meta.dtype..  
+000242e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000242f0: 6465 6620 6e62 7974 6573 2873 656c 6629  def nbytes(self)
+00024300: 3a0a 2020 2020 2020 2020 2222 224e 756d  :.        """Num
+00024310: 6265 7220 6f66 2062 7974 6573 2222 220a  ber of bytes""".
+00024320: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00024330: 6577 5f63 6f6c 6c65 6374 696f 6e28 7365  ew_collection(se
+00024340: 6c66 2e65 7870 722e 6e62 7974 6573 290a  lf.expr.nbytes).
+00024350: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
+00024360: 5f75 6675 6e63 5f5f 2873 656c 662c 206e  _ufunc__(self, n
+00024370: 756d 7079 5f75 6675 6e63 2c20 6d65 7468  umpy_ufunc, meth
+00024380: 6f64 2c20 2a69 6e70 7574 732c 202a 2a6b  od, *inputs, **k
+00024390: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+000243a0: 6f75 7420 3d20 6b77 6172 6773 2e67 6574  out = kwargs.get
+000243b0: 2822 6f75 7422 2c20 2829 290a 2020 2020  ("out", ()).    
+000243c0: 2020 2020 666f 7220 7820 696e 2069 6e70      for x in inp
+000243d0: 7574 7320 2b20 6f75 743a 0a20 2020 2020  uts + out:.     
+000243e0: 2020 2020 2020 2023 2075 6675 6e63 7320         # ufuncs 
+000243f0: 776f 726b 2077 6974 6820 302d 6469 6d65  work with 0-dime
+00024400: 6e73 696f 6e61 6c20 4e75 6d50 7920 6e64  nsional NumPy nd
+00024410: 6172 7261 7973 0a20 2020 2020 2020 2020  arrays.         
+00024420: 2020 2023 2073 6f20 7765 2064 6f6e 2774     # so we don't
+00024430: 2077 616e 7420 746f 2072 6169 7365 204e   want to raise N
+00024440: 6f74 496d 706c 656d 656e 7465 640a 2020  otImplemented.  
+00024450: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00024460: 6e73 7461 6e63 6528 782c 206e 702e 6e64  nstance(x, np.nd
+00024470: 6172 7261 7929 2061 6e64 2078 2e73 6861  array) and x.sha
+00024480: 7065 203d 3d20 2829 3a0a 2020 2020 2020  pe == ():.      
+00024490: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+000244a0: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
+000244b0: 6c69 6620 6e6f 7420 6973 696e 7374 616e  lif not isinstan
+000244c0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+000244d0: 2020 2020 782c 2028 4e75 6d62 6572 2c20      x, (Number, 
+000244e0: 5363 616c 6172 2c20 4672 616d 6542 6173  Scalar, FrameBas
+000244f0: 652c 2041 7272 6179 2c20 7064 2e44 6174  e, Array, pd.Dat
+00024500: 6146 7261 6d65 2c20 7064 2e53 6572 6965  aFrame, pd.Serie
+00024510: 732c 2070 642e 496e 6465 7829 0a20 2020  s, pd.Index).   
+00024520: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+00024530: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00024540: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
+00024550: 640a 0a20 2020 2020 2020 2069 6620 6d65  d..        if me
+00024560: 7468 6f64 203d 3d20 225f 5f63 616c 6c5f  thod == "__call_
+00024570: 5f22 3a0a 2020 2020 2020 2020 2020 2020  _":.            
+00024580: 6966 206e 756d 7079 5f75 6675 6e63 2e73  if numpy_ufunc.s
+00024590: 6967 6e61 7475 7265 2069 7320 6e6f 7420  ignature is not 
+000245a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000245b0: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
+000245c0: 496d 706c 656d 656e 7465 640a 2020 2020  Implemented.    
+000245d0: 2020 2020 2020 2020 6966 206e 756d 7079          if numpy
+000245e0: 5f75 6675 6e63 2e6e 6f75 7420 3e20 313a  _ufunc.nout > 1:
+000245f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024600: 2023 2075 6675 6e63 7320 7769 7468 206d   # ufuncs with m
+00024610: 756c 7469 706c 6520 6f75 7470 7574 2076  ultiple output v
+00024620: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
+00024630: 2020 2020 2020 2320 6172 6520 6e6f 7420        # are not 
+00024640: 7965 7420 7375 7070 6f72 7465 6420 666f  yet supported fo
+00024650: 7220 6672 616d 6573 0a20 2020 2020 2020  r frames.       
+00024660: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00024670: 4e6f 7449 6d70 6c65 6d65 6e74 6564 0a20  NotImplemented. 
+00024680: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00024690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000246a0: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+000246b0: 286e 756d 7079 5f75 6675 6e63 2c20 2a69  (numpy_ufunc, *i
+000246c0: 6e70 7574 732c 202a 2a6b 7761 7267 7329  nputs, **kwargs)
+000246d0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000246e0: 2020 2020 2020 2020 2020 2023 2075 6675             # ufu
+000246f0: 6e63 206d 6574 686f 6473 2061 7265 206e  nc methods are n
+00024700: 6f74 2079 6574 2073 7570 706f 7274 6564  ot yet supported
+00024710: 2066 6f72 2066 7261 6d65 730a 2020 2020   for frames.    
+00024720: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00024730: 6f74 496d 706c 656d 656e 7465 640a 0a20  otImplemented.. 
+00024740: 2020 2064 6566 205f 5f61 7272 6179 5f77     def __array_w
+00024750: 7261 705f 5f28 7365 6c66 2c20 6172 7261  rap__(self, arra
+00024760: 792c 2063 6f6e 7465 7874 3d4e 6f6e 6529  y, context=None)
+00024770: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+00024780: 6e73 7461 6e63 6528 636f 6e74 6578 742c  nstance(context,
+00024790: 2074 7570 6c65 2920 616e 6420 6c65 6e28   tuple) and len(
+000247a0: 636f 6e74 6578 7429 203e 2030 3a0a 2020  context) > 0:.  
+000247b0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+000247c0: 6e73 7461 6e63 6528 636f 6e74 6578 745b  nstance(context[
+000247d0: 315d 5b30 5d2c 206e 702e 6e64 6172 7261  1][0], np.ndarra
+000247e0: 7929 2061 6e64 2063 6f6e 7465 7874 5b31  y) and context[1
+000247f0: 5d5b 305d 2e73 6861 7065 203d 3d20 2829  ][0].shape == ()
+00024800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00024810: 2020 696e 6465 7820 3d20 4e6f 6e65 0a20    index = None. 
+00024820: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00024830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024840: 2069 6e64 6578 203d 2063 6f6e 7465 7874   index = context
+00024850: 5b31 5d5b 305d 2e69 6e64 6578 0a20 2020  [1][0].index.   
+00024860: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00024870: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00024880: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+00024890: 7274 2069 6e73 7065 6374 0a0a 2020 2020  rt inspect..    
+000248a0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+000248b0: 6f64 5f6e 616d 6520 3d20 6622 607b 696e  od_name = f"`{in
+000248c0: 7370 6563 742e 7374 6163 6b28 295b 335d  spect.stack()[3]
+000248d0: 5b33 5d7d 6022 0a20 2020 2020 2020 2020  [3]}`".         
+000248e0: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
+000248f0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+00024900: 2020 2020 2020 6d65 7468 6f64 5f6e 616d        method_nam
+00024910: 6520 3d20 2254 6869 7320 6d65 7468 6f64  e = "This method
+00024920: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
+00024930: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00024940: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+00024950: 2020 2020 2020 2020 2066 227b 6d65 7468           f"{meth
+00024960: 6f64 5f6e 616d 657d 2069 7320 6e6f 7420  od_name} is not 
+00024970: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
+00024980: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+00024990: 5365 7269 6573 602e 220a 2020 2020 2020  Series`.".      
+000249a0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000249b0: 2072 6574 7572 6e20 6d65 7461 5f73 6572   return meta_ser
+000249c0: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
+000249d0: 7365 6c66 2928 6172 7261 792c 2069 6e64  self)(array, ind
+000249e0: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d73  ex=index, name=s
+000249f0: 656c 662e 6e61 6d65 290a 0a20 2020 2040  elf.name)..    @
+00024a00: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00024a10: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00024a20: 6d61 7028 7365 6c66 2c20 6172 672c 206e  map(self, arg, n
+00024a30: 615f 6163 7469 6f6e 3d4e 6f6e 652c 206d  a_action=None, m
+00024a40: 6574 613d 4e6f 6e65 293a 0a20 2020 2020  eta=None):.     
+00024a50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00024a60: 2861 7267 2c20 5365 7269 6573 293a 0a20  (arg, Series):. 
+00024a70: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00024a80: 7420 6578 7072 2e61 7265 5f63 6f5f 616c  t expr.are_co_al
+00024a90: 6967 6e65 6428 7365 6c66 2e65 7870 722c  igned(self.expr,
+00024aa0: 2061 7267 2e65 7870 7229 3a0a 2020 2020   arg.expr):.    
+00024ab0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00024ac0: 6574 6120 6973 204e 6f6e 653a 0a20 2020  eta is None:.   
+00024ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ae0: 2077 6172 6e69 6e67 732e 7761 726e 286d   warnings.warn(m
+00024af0: 6574 615f 7761 726e 696e 6728 6d65 7461  eta_warning(meta
+00024b00: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00024b10: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00024b20: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
+00024b30: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00024b40: 7072 2e4d 6170 416c 6967 6e28 7365 6c66  pr.MapAlign(self
+00024b50: 2c20 6172 672c 206f 703d 4e6f 6e65 2c20  , arg, op=None, 
+00024b60: 6e61 5f61 6374 696f 6e3d 6e61 5f61 6374  na_action=na_act
+00024b70: 696f 6e2c 206d 6574 613d 6d65 7461 290a  ion, meta=meta).
+00024b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b90: 290a 2020 2020 2020 2020 6966 206d 6574  ).        if met
+00024ba0: 6120 6973 204e 6f6e 653a 0a20 2020 2020  a is None:.     
+00024bb0: 2020 2020 2020 206d 6574 6120 3d20 6578         meta = ex
+00024bc0: 7072 2e5f 656d 756c 6174 6528 4d2e 6d61  pr._emulate(M.ma
+00024bd0: 702c 2073 656c 662c 2061 7267 2c20 6e61  p, self, arg, na
+00024be0: 5f61 6374 696f 6e3d 6e61 5f61 6374 696f  _action=na_actio
+00024bf0: 6e2c 2075 6466 3d54 7275 6529 0a20 2020  n, udf=True).   
+00024c00: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+00024c10: 732e 7761 726e 286d 6574 615f 7761 726e  s.warn(meta_warn
+00024c20: 696e 6728 6d65 7461 2929 0a20 2020 2020  ing(meta)).     
+00024c30: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00024c40: 6c6c 6563 7469 6f6e 2865 7870 722e 4d61  llection(expr.Ma
+00024c50: 7028 7365 6c66 2c20 6172 673d 6172 672c  p(self, arg=arg,
+00024c60: 206e 615f 6163 7469 6f6e 3d6e 615f 6163   na_action=na_ac
+00024c70: 7469 6f6e 2c20 6d65 7461 3d6d 6574 6129  tion, meta=meta)
+00024c80: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00024c90: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00024ca0: 2020 2020 6465 6620 636c 6970 2873 656c      def clip(sel
+00024cb0: 662c 206c 6f77 6572 3d4e 6f6e 652c 2075  f, lower=None, u
+00024cc0: 7070 6572 3d4e 6f6e 652c 2061 7869 733d  pper=None, axis=
+00024cd0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
+00024ce0: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+00024cf0: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+00024d00: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+00024d10: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00024d20: 6c65 6374 696f 6e28 7365 6c66 2e65 7870  lection(self.exp
+00024d30: 722e 636c 6970 286c 6f77 6572 2c20 7570  r.clip(lower, up
+00024d40: 7065 722c 2061 7869 7329 290a 0a20 2020  per, axis))..   
+00024d50: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00024d60: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00024d70: 6620 746f 5f66 7261 6d65 2873 656c 662c  f to_frame(self,
+00024d80: 206e 616d 653d 6e6f 5f64 6566 6175 6c74   name=no_default
+00024d90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00024da0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00024db0: 2865 7870 722e 546f 4672 616d 6528 7365  (expr.ToFrame(se
+00024dc0: 6c66 2c20 6e61 6d65 3d6e 616d 6529 290a  lf, name=name)).
+00024dd0: 0a20 2020 2064 6566 205f 636f 6d70 6172  .    def _compar
+00024de0: 6973 6f6e 5f6f 7028 7365 6c66 2c20 6578  ison_op(self, ex
+00024df0: 7072 5f63 6c73 2c20 6f74 6865 722c 206c  pr_cls, other, l
+00024e00: 6576 656c 2c20 6669 6c6c 5f76 616c 7565  evel, fill_value
+00024e10: 2c20 6178 6973 293a 0a20 2020 2020 2020  , axis):.       
+00024e20: 2069 6620 6c65 7665 6c20 6973 206e 6f74   if level is not
+00024e30: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00024e40: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00024e50: 656d 656e 7465 6445 7272 6f72 2822 6c65  ementedError("le
+00024e60: 7665 6c20 6d75 7374 2062 6520 4e6f 6e65  vel must be None
+00024e70: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00024e80: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
+00024e90: 7869 7329 0a20 2020 2020 2020 2072 6574  xis).        ret
+00024ea0: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00024eb0: 6f6e 2865 7870 725f 636c 7328 7365 6c66  on(expr_cls(self
+00024ec0: 2c20 6f74 6865 722c 2066 696c 6c5f 7661  , other, fill_va
+00024ed0: 6c75 653d 6669 6c6c 5f76 616c 7565 2929  lue=fill_value))
+00024ee0: 0a0a 2020 2020 6465 6620 6c74 2873 656c  ..    def lt(sel
+00024ef0: 662c 206f 7468 6572 2c20 6c65 7665 6c3d  f, other, level=
+00024f00: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
+00024f10: 3d4e 6f6e 652c 2061 7869 733d 3029 3a0a  =None, axis=0):.
+00024f20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00024f30: 656c 662e 5f63 6f6d 7061 7269 736f 6e5f  elf._comparison_
+00024f40: 6f70 2865 7870 722e 4c54 5365 7269 6573  op(expr.LTSeries
+00024f50: 2c20 6f74 6865 722c 206c 6576 656c 2c20  , other, level, 
+00024f60: 6669 6c6c 5f76 616c 7565 2c20 6178 6973  fill_value, axis
+00024f70: 290a 0a20 2020 2064 6566 206c 6528 7365  )..    def le(se
+00024f80: 6c66 2c20 6f74 6865 722c 206c 6576 656c  lf, other, level
+00024f90: 3d4e 6f6e 652c 2066 696c 6c5f 7661 6c75  =None, fill_valu
+00024fa0: 653d 4e6f 6e65 2c20 6178 6973 3d30 293a  e=None, axis=0):
+00024fb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024fc0: 7365 6c66 2e5f 636f 6d70 6172 6973 6f6e  self._comparison
+00024fd0: 5f6f 7028 6578 7072 2e4c 4553 6572 6965  _op(expr.LESerie
+00024fe0: 732c 206f 7468 6572 2c20 6c65 7665 6c2c  s, other, level,
+00024ff0: 2066 696c 6c5f 7661 6c75 652c 2061 7869   fill_value, axi
+00025000: 7329 0a0a 2020 2020 6465 6620 6774 2873  s)..    def gt(s
+00025010: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
+00025020: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
+00025030: 7565 3d4e 6f6e 652c 2061 7869 733d 3029  ue=None, axis=0)
+00025040: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00025050: 2073 656c 662e 5f63 6f6d 7061 7269 736f   self._compariso
+00025060: 6e5f 6f70 2865 7870 722e 4754 5365 7269  n_op(expr.GTSeri
+00025070: 6573 2c20 6f74 6865 722c 206c 6576 656c  es, other, level
+00025080: 2c20 6669 6c6c 5f76 616c 7565 2c20 6178  , fill_value, ax
+00025090: 6973 290a 0a20 2020 2064 6566 2067 6528  is)..    def ge(
+000250a0: 7365 6c66 2c20 6f74 6865 722c 206c 6576  self, other, lev
+000250b0: 656c 3d4e 6f6e 652c 2066 696c 6c5f 7661  el=None, fill_va
+000250c0: 6c75 653d 4e6f 6e65 2c20 6178 6973 3d30  lue=None, axis=0
+000250d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000250e0: 6e20 7365 6c66 2e5f 636f 6d70 6172 6973  n self._comparis
+000250f0: 6f6e 5f6f 7028 6578 7072 2e47 4553 6572  on_op(expr.GESer
+00025100: 6965 732c 206f 7468 6572 2c20 6c65 7665  ies, other, leve
+00025110: 6c2c 2066 696c 6c5f 7661 6c75 652c 2061  l, fill_value, a
+00025120: 7869 7329 0a0a 2020 2020 6465 6620 6e65  xis)..    def ne
+00025130: 2873 656c 662c 206f 7468 6572 2c20 6c65  (self, other, le
+00025140: 7665 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76  vel=None, fill_v
+00025150: 616c 7565 3d4e 6f6e 652c 2061 7869 733d  alue=None, axis=
+00025160: 3029 3a0a 2020 2020 2020 2020 7265 7475  0):.        retu
+00025170: 726e 2073 656c 662e 5f63 6f6d 7061 7269  rn self._compari
+00025180: 736f 6e5f 6f70 2865 7870 722e 4e45 5365  son_op(expr.NESe
+00025190: 7269 6573 2c20 6f74 6865 722c 206c 6576  ries, other, lev
+000251a0: 656c 2c20 6669 6c6c 5f76 616c 7565 2c20  el, fill_value, 
+000251b0: 6178 6973 290a 0a20 2020 2064 6566 2065  axis)..    def e
+000251c0: 7128 7365 6c66 2c20 6f74 6865 722c 206c  q(self, other, l
+000251d0: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
+000251e0: 7661 6c75 653d 4e6f 6e65 2c20 6178 6973  value=None, axis
+000251f0: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
+00025200: 7572 6e20 7365 6c66 2e5f 636f 6d70 6172  urn self._compar
+00025210: 6973 6f6e 5f6f 7028 6578 7072 2e45 5153  ison_op(expr.EQS
+00025220: 6572 6965 732c 206f 7468 6572 2c20 6c65  eries, other, le
+00025230: 7665 6c2c 2066 696c 6c5f 7661 6c75 652c  vel, fill_value,
+00025240: 2061 7869 7329 0a0a 2020 2020 4064 6572   axis)..    @der
+00025250: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00025260: 6965 7329 0a20 2020 2064 6566 2076 616c  ies).    def val
+00025270: 7565 5f63 6f75 6e74 7328 0a20 2020 2020  ue_counts(.     
+00025280: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00025290: 2073 6f72 743d 4e6f 6e65 2c0a 2020 2020   sort=None,.    
+000252a0: 2020 2020 6173 6365 6e64 696e 673d 4661      ascending=Fa
+000252b0: 6c73 652c 0a20 2020 2020 2020 2064 726f  lse,.        dro
+000252c0: 706e 613d 5472 7565 2c0a 2020 2020 2020  pna=True,.      
+000252d0: 2020 6e6f 726d 616c 697a 653d 4661 6c73    normalize=Fals
+000252e0: 652c 0a20 2020 2020 2020 2073 706c 6974  e,.        split
+000252f0: 5f65 7665 7279 3d4e 6f6e 652c 0a20 2020  _every=None,.   
+00025300: 2020 2020 2073 706c 6974 5f6f 7574 3d6e       split_out=n
+00025310: 6f5f 6465 6661 756c 742c 0a20 2020 2029  o_default,.    )
+00025320: 3a0a 2020 2020 2020 2020 6966 2073 706c  :.        if spl
+00025330: 6974 5f6f 7574 2069 7320 6e6f 5f64 6566  it_out is no_def
+00025340: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
+00025350: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00025360: 7365 6c66 2e64 7479 7065 2c20 4361 7465  self.dtype, Cate
+00025370: 676f 7269 6361 6c44 7479 7065 293a 0a20  goricalDtype):. 
+00025380: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00025390: 2075 6e6f 6273 6572 7665 6420 6361 7465   unobserved cate
+000253a0: 676f 7269 6573 2061 7265 2061 2070 6169  gories are a pai
+000253b0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+000253c0: 2020 7370 6c69 745f 6f75 7420 3d20 310a    split_out = 1.
+000253d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000253e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000253f0: 2020 7370 6c69 745f 6f75 7420 3d20 5472    split_out = Tr
+00025400: 7565 0a20 2020 2020 2020 2069 6620 7370  ue.        if sp
+00025410: 6c69 745f 6f75 7420 3d3d 2031 2061 6e64  lit_out == 1 and
+00025420: 2073 706c 6974 5f6f 7574 2069 7320 6e6f   split_out is no
+00025430: 7420 5472 7565 2061 6e64 2073 6f72 7420  t True and sort 
+00025440: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00025450: 2020 2020 2073 6f72 7420 3d20 5472 7565       sort = True
+00025460: 0a0a 2020 2020 2020 2020 6c65 6e67 7468  ..        length
+00025470: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00025480: 6966 2028 7370 6c69 745f 6f75 7420 3e20  if (split_out > 
+00025490: 3120 6f72 2073 706c 6974 5f6f 7574 2069  1 or split_out i
+000254a0: 7320 5472 7565 2920 616e 6420 6e6f 726d  s True) and norm
+000254b0: 616c 697a 653a 0a20 2020 2020 2020 2020  alize:.         
+000254c0: 2020 2066 7261 6d65 203d 2073 656c 6620     frame = self 
+000254d0: 6966 206e 6f74 2064 726f 706e 6120 656c  if not dropna el
+000254e0: 7365 2073 656c 662e 6472 6f70 6e61 2829  se self.dropna()
+000254f0: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
+00025500: 6774 6820 3d20 4c65 6e28 6672 616d 6529  gth = Len(frame)
+00025510: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00025520: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+00025530: 0a20 2020 2020 2020 2020 2020 2056 616c  .            Val
+00025540: 7565 436f 756e 7473 280a 2020 2020 2020  ueCounts(.      
+00025550: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00025560: 736f 7274 2c20 6173 6365 6e64 696e 672c  sort, ascending,
+00025570: 2064 726f 706e 612c 206e 6f72 6d61 6c69   dropna, normali
+00025580: 7a65 2c20 7370 6c69 745f 6576 6572 792c  ze, split_every,
+00025590: 2073 706c 6974 5f6f 7574 2c20 6c65 6e67   split_out, leng
+000255a0: 7468 0a20 2020 2020 2020 2020 2020 2029  th.            )
+000255b0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000255c0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000255d0: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+000255e0: 206d 6f64 6528 7365 6c66 2c20 6472 6f70   mode(self, drop
+000255f0: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
+00025600: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
+00025610: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00025620: 636f 6c6c 6563 7469 6f6e 2873 656c 662e  collection(self.
+00025630: 6578 7072 2e6d 6f64 6528 6472 6f70 6e61  expr.mode(dropna
+00025640: 2c20 7370 6c69 745f 6576 6572 7929 290a  , split_every)).
+00025650: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00025660: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00025670: 2020 6465 6620 6e6c 6172 6765 7374 2873    def nlargest(s
+00025680: 656c 662c 206e 3d35 2c20 7370 6c69 745f  elf, n=5, split_
+00025690: 6576 6572 793d 4e6f 6e65 293a 0a20 2020  every=None):.   
+000256a0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+000256b0: 636f 6c6c 6563 7469 6f6e 284e 4c61 7267  collection(NLarg
+000256c0: 6573 7428 7365 6c66 2c20 6e3d 6e2c 2073  est(self, n=n, s
+000256d0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+000256e0: 5f65 7665 7279 2929 0a0a 2020 2020 4064  _every))..    @d
+000256f0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00025700: 6572 6965 7329 0a20 2020 2064 6566 206e  eries).    def n
+00025710: 736d 616c 6c65 7374 2873 656c 662c 206e  smallest(self, n
+00025720: 3d35 2c20 7370 6c69 745f 6576 6572 793d  =5, split_every=
+00025730: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
+00025740: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00025750: 7469 6f6e 284e 536d 616c 6c65 7374 2873  tion(NSmallest(s
+00025760: 656c 662c 206e 3d6e 2c20 7370 6c69 745f  elf, n=n, split_
+00025770: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00025780: 7929 290a 0a20 2020 2040 6465 7269 7665  y))..    @derive
+00025790: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+000257a0: 290a 2020 2020 6465 6620 6d65 6d6f 7279  ).    def memory
+000257b0: 5f75 7361 6765 2873 656c 662c 2064 6565  _usage(self, dee
+000257c0: 703d 4661 6c73 652c 2069 6e64 6578 3d54  p=False, index=T
+000257d0: 7275 6529 3a0a 2020 2020 2020 2020 7265  rue):.        re
+000257e0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+000257f0: 696f 6e28 4d65 6d6f 7279 5573 6167 6546  ion(MemoryUsageF
+00025800: 7261 6d65 2873 656c 662c 2064 6565 703d  rame(self, deep=
+00025810: 6465 6570 2c20 5f69 6e64 6578 3d69 6e64  deep, _index=ind
+00025820: 6578 2929 0a0a 2020 2020 6465 6620 756e  ex))..    def un
+00025830: 6971 7565 2873 656c 662c 2073 706c 6974  ique(self, split
+00025840: 5f65 7665 7279 3d4e 6f6e 652c 2073 706c  _every=None, spl
+00025850: 6974 5f6f 7574 3d54 7275 652c 2073 6875  it_out=True, shu
+00025860: 6666 6c65 5f6d 6574 686f 643d 4e6f 6e65  ffle_method=None
+00025870: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00025880: 2020 2020 2020 2052 6574 7572 6e20 5365         Return Se
+00025890: 7269 6573 206f 6620 756e 6971 7565 2076  ries of unique v
+000258a0: 616c 7565 7320 696e 2074 6865 206f 626a  alues in the obj
+000258b0: 6563 742e 2049 6e63 6c75 6465 7320 4e41  ect. Includes NA
+000258c0: 2076 616c 7565 732e 0a0a 2020 2020 2020   values...      
+000258d0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+000258e0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+000258f0: 2020 756e 6971 7565 7320 3a20 5365 7269    uniques : Seri
+00025900: 6573 0a20 2020 2020 2020 2022 2222 0a20  es.        """. 
+00025910: 2020 2020 2020 2073 6875 6666 6c65 5f6d         shuffle_m
+00025920: 6574 686f 6420 3d20 5f67 6574 5f73 6875  ethod = _get_shu
+00025930: 6666 6c65 5f70 7265 6665 7272 696e 675f  ffle_preferring_
+00025940: 6f72 6465 7228 7368 7566 666c 655f 6d65  order(shuffle_me
+00025950: 7468 6f64 290a 2020 2020 2020 2020 7265  thod).        re
+00025960: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00025970: 696f 6e28 556e 6971 7565 2873 656c 662c  ion(Unique(self,
+00025980: 2073 706c 6974 5f65 7665 7279 2c20 7370   split_every, sp
+00025990: 6c69 745f 6f75 742c 2073 6875 6666 6c65  lit_out, shuffle
+000259a0: 5f6d 6574 686f 6429 290a 0a20 2020 2040  _method))..    @
+000259b0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000259c0: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+000259d0: 6e75 6e69 7175 6528 7365 6c66 2c20 6472  nunique(self, dr
+000259e0: 6f70 6e61 3d54 7275 652c 2073 706c 6974  opna=True, split
+000259f0: 5f65 7665 7279 3d46 616c 7365 2c20 7370  _every=False, sp
+00025a00: 6c69 745f 6f75 743d 5472 7565 293a 0a20  lit_out=True):. 
+00025a10: 2020 2020 2020 2075 6e69 7173 203d 2073         uniqs = s
+00025a20: 656c 662e 6472 6f70 5f64 7570 6c69 6361  elf.drop_duplica
+00025a30: 7465 7328 7370 6c69 745f 6576 6572 793d  tes(split_every=
+00025a40: 7370 6c69 745f 6576 6572 792c 2073 706c  split_every, spl
+00025a50: 6974 5f6f 7574 3d73 706c 6974 5f6f 7574  it_out=split_out
+00025a60: 290a 2020 2020 2020 2020 6966 2064 726f  ).        if dro
+00025a70: 706e 613a 0a20 2020 2020 2020 2020 2020  pna:.           
+00025a80: 2023 2063 6f75 6e74 206d 696d 6963 7320   # count mimics 
+00025a90: 7061 6e64 6173 2062 6568 6176 696f 7220  pandas behavior 
+00025aa0: 616e 6420 6578 636c 7564 6573 204e 4120  and excludes NA 
+00025ab0: 7661 6c75 6573 0a20 2020 2020 2020 2020  values.         
+00025ac0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00025ad0: 2875 6e69 7173 2c20 496e 6465 7829 3a0a  (uniqs, Index):.
+00025ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025af0: 756e 6971 7320 3d20 756e 6971 732e 746f  uniqs = uniqs.to
+00025b00: 5f73 6572 6965 7328 290a 2020 2020 2020  _series().      
+00025b10: 2020 2020 2020 7265 7475 726e 2075 6e69        return uni
+00025b20: 7173 2e63 6f75 6e74 2829 0a20 2020 2020  qs.count().     
+00025b30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00025b40: 2020 2020 2072 6574 7572 6e20 756e 6971       return uniq
+00025b50: 732e 7369 7a65 0a0a 2020 2020 6465 6620  s.size..    def 
+00025b60: 6472 6f70 5f64 7570 6c69 6361 7465 7328  drop_duplicates(
+00025b70: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00025b80: 2020 2020 2020 2069 676e 6f72 655f 696e         ignore_in
+00025b90: 6465 783d 4661 6c73 652c 0a20 2020 2020  dex=False,.     
+00025ba0: 2020 2073 706c 6974 5f65 7665 7279 3d4e     split_every=N
+00025bb0: 6f6e 652c 0a20 2020 2020 2020 2073 706c  one,.        spl
+00025bc0: 6974 5f6f 7574 3d54 7275 652c 0a20 2020  it_out=True,.   
+00025bd0: 2020 2020 2073 6875 6666 6c65 5f6d 6574       shuffle_met
+00025be0: 686f 643d 4e6f 6e65 2c0a 2020 2020 2020  hod=None,.      
+00025bf0: 2020 6b65 6570 3d22 6669 7273 7422 2c0a    keep="first",.
+00025c00: 2020 2020 293a 0a20 2020 2020 2020 2073      ):.        s
+00025c10: 6875 6666 6c65 5f6d 6574 686f 6420 3d20  huffle_method = 
+00025c20: 5f67 6574 5f73 6875 6666 6c65 5f70 7265  _get_shuffle_pre
+00025c30: 6665 7272 696e 675f 6f72 6465 7228 7368  ferring_order(sh
+00025c40: 7566 666c 655f 6d65 7468 6f64 290a 2020  uffle_method).  
+00025c50: 2020 2020 2020 6966 206b 6565 7020 6973        if keep is
+00025c60: 2046 616c 7365 3a0a 2020 2020 2020 2020   False:.        
+00025c70: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00025c80: 6c65 6d65 6e74 6564 4572 726f 7228 2264  lementedError("d
+00025c90: 726f 705f 6475 706c 6963 6174 6573 2077  rop_duplicates w
+00025ca0: 6974 6820 6b65 6570 3d46 616c 7365 2229  ith keep=False")
+00025cb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00025cc0: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
+00025cd0: 2020 2020 2020 2020 2020 2020 4472 6f70              Drop
+00025ce0: 4475 706c 6963 6174 6573 280a 2020 2020  Duplicates(.    
+00025cf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00025d00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00025d10: 2020 6967 6e6f 7265 5f69 6e64 6578 3d69    ignore_index=i
+00025d20: 676e 6f72 655f 696e 6465 782c 0a20 2020  gnore_index,.   
+00025d30: 2020 2020 2020 2020 2020 2020 2073 706c               spl
+00025d40: 6974 5f6f 7574 3d73 706c 6974 5f6f 7574  it_out=split_out
+00025d50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00025d60: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00025d70: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00025d80: 2020 2020 2020 2020 2020 2073 6875 6666             shuff
+00025d90: 6c65 5f6d 6574 686f 643d 7368 7566 666c  le_method=shuffl
+00025da0: 655f 6d65 7468 6f64 2c0a 2020 2020 2020  e_method,.      
+00025db0: 2020 2020 2020 2020 2020 6b65 6570 3d6b            keep=k
+00025dc0: 6565 702c 0a20 2020 2020 2020 2020 2020  eep,.           
+00025dd0: 2029 0a20 2020 2020 2020 2029 0a0a 2020   ).        )..  
+00025de0: 2020 4069 6e73 6572 745f 6d65 7461 5f70    @insert_meta_p
+00025df0: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
+00025e00: 2870 6164 3d31 3229 0a20 2020 2064 6566  (pad=12).    def
+00025e10: 2061 7070 6c79 2873 656c 662c 2066 756e   apply(self, fun
+00025e20: 6374 696f 6e2c 202a 6172 6773 2c20 6d65  ction, *args, me
+00025e30: 7461 3d6e 6f5f 6465 6661 756c 742c 2061  ta=no_default, a
+00025e40: 7869 733d 302c 202a 2a6b 7761 7267 7329  xis=0, **kwargs)
+00025e50: 3a0a 2020 2020 2020 2020 2222 2250 6172  :.        """Par
+00025e60: 616c 6c65 6c20 7665 7273 696f 6e20 6f66  allel version of
+00025e70: 2070 616e 6461 732e 5365 7269 6573 2e61   pandas.Series.a
+00025e80: 7070 6c79 0a0a 2020 2020 2020 2020 5061  pply..        Pa
+00025e90: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00025ea0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00025eb0: 2020 2020 6675 6e63 203a 2066 756e 6374      func : funct
+00025ec0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00025ed0: 4675 6e63 7469 6f6e 2074 6f20 6170 706c  Function to appl
+00025ee0: 790a 2020 2020 2020 2020 244d 4554 410a  y.        $META.
+00025ef0: 2020 2020 2020 2020 6172 6773 203a 2074          args : t
+00025f00: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
+00025f10: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
+00025f20: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
+00025f30: 2066 756e 6374 696f 6e20 696e 2061 6464   function in add
+00025f40: 6974 696f 6e20 746f 2074 6865 2076 616c  ition to the val
+00025f50: 7565 2e0a 0a20 2020 2020 2020 2041 6464  ue...        Add
+00025f60: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+00025f70: 6172 6775 6d65 6e74 7320 7769 6c6c 2062  arguments will b
+00025f80: 6520 7061 7373 6564 2061 7320 6b65 7977  e passed as keyw
+00025f90: 6f72 6473 2074 6f20 7468 6520 6675 6e63  ords to the func
+00025fa0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2052  tion...        R
+00025fb0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00025fc0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
+00025fd0: 7070 6c69 6564 203a 2053 6572 6965 7320  pplied : Series 
+00025fe0: 6f72 2044 6174 6146 7261 6d65 2069 6620  or DataFrame if 
+00025ff0: 6675 6e63 2072 6574 7572 6e73 2061 2053  func returns a S
+00026000: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
+00026010: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00026020: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00026030: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
+00026040: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
+00026050: 640a 2020 2020 2020 2020 3e3e 3e20 7320  d.        >>> s 
+00026060: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
+00026070: 6528 3529 2c20 6e61 6d65 3d27 7827 290a  e(5), name='x').
+00026080: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
+00026090: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+000260a0: 732c 206e 7061 7274 6974 696f 6e73 3d32  s, npartitions=2
+000260b0: 290a 0a20 2020 2020 2020 2041 7070 6c79  )..        Apply
+000260c0: 2061 2066 756e 6374 696f 6e20 656c 656d   a function elem
+000260d0: 656e 7477 6973 6520 6163 726f 7373 2074  entwise across t
+000260e0: 6865 2053 6572 6965 732c 2070 6173 7369  he Series, passi
+000260f0: 6e67 2069 6e20 6578 7472 610a 2020 2020  ng in extra.    
+00026100: 2020 2020 6172 6775 6d65 6e74 7320 696e      arguments in
+00026110: 2060 6061 7267 7360 6020 616e 6420 6060   ``args`` and ``
+00026120: 6b77 6172 6773 6060 3a0a 0a20 2020 2020  kwargs``:..     
+00026130: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
+00026140: 2878 2c20 612c 2062 3d31 293a 0a20 2020  (x, a, b=1):.   
+00026150: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+00026160: 7572 6e20 7820 2b20 6120 2b20 620a 2020  urn x + a + b.  
+00026170: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+00026180: 6473 2e61 7070 6c79 286d 7961 6464 2c20  ds.apply(myadd, 
+00026190: 6172 6773 3d28 322c 292c 2062 3d31 2e35  args=(2,), b=1.5
+000261a0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+000261b0: 4b49 500a 0a20 2020 2020 2020 2042 7920  KIP..        By 
+000261c0: 6465 6661 756c 742c 2064 6173 6b20 7472  default, dask tr
+000261d0: 6965 7320 746f 2069 6e66 6572 2074 6865  ies to infer the
+000261e0: 206f 7574 7075 7420 6d65 7461 6461 7461   output metadata
+000261f0: 2062 7920 7275 6e6e 696e 6720 796f 7572   by running your
+00026200: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
+00026210: 6420 6675 6e63 7469 6f6e 206f 6e20 736f  d function on so
+00026220: 6d65 2066 616b 6520 6461 7461 2e20 5468  me fake data. Th
+00026230: 6973 2077 6f72 6b73 2077 656c 6c20 696e  is works well in
+00026240: 206d 616e 7920 6361 7365 732c 2062 7574   many cases, but
+00026250: 0a20 2020 2020 2020 2063 616e 2073 6f6d  .        can som
+00026260: 6574 696d 6573 2062 6520 6578 7065 6e73  etimes be expens
+00026270: 6976 652c 206f 7220 6576 656e 2066 6169  ive, or even fai
+00026280: 6c2e 2054 6f20 6176 6f69 6420 7468 6973  l. To avoid this
+00026290: 2c20 796f 7520 6361 6e0a 2020 2020 2020  , you can.      
+000262a0: 2020 6d61 6e75 616c 6c79 2073 7065 6369    manually speci
+000262b0: 6679 2074 6865 206f 7574 7075 7420 6d65  fy the output me
+000262c0: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
+000262d0: 6060 6d65 7461 6060 206b 6579 776f 7264  ``meta`` keyword
+000262e0: 2e20 5468 6973 0a20 2020 2020 2020 2063  . This.        c
+000262f0: 616e 2062 6520 7370 6563 6966 6965 6420  an be specified 
+00026300: 696e 206d 616e 7920 666f 726d 732c 2066  in many forms, f
+00026310: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+00026320: 696f 6e20 7365 650a 2020 2020 2020 2020  ion see.        
+00026330: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
+00026340: 2e75 7469 6c73 2e6d 616b 655f 6d65 7461  .utils.make_meta
+00026350: 6060 2e0a 0a20 2020 2020 2020 2048 6572  ``...        Her
+00026360: 6520 7765 2073 7065 6369 6679 2074 6865  e we specify the
+00026370: 206f 7574 7075 7420 6973 2061 2053 6572   output is a Ser
+00026380: 6965 7320 7769 7468 206e 616d 6520 6060  ies with name ``
+00026390: 2778 2760 602c 2061 6e64 2064 7479 7065  'x'``, and dtype
+000263a0: 0a20 2020 2020 2020 2060 6066 6c6f 6174  .        ``float
+000263b0: 3634 6060 3a0a 0a20 2020 2020 2020 203e  64``:..        >
+000263c0: 3e3e 2072 6573 203d 2064 732e 6170 706c  >> res = ds.appl
+000263d0: 7928 6d79 6164 642c 2061 7267 733d 2832  y(myadd, args=(2
+000263e0: 2c29 2c20 623d 312e 352c 206d 6574 613d  ,), b=1.5, meta=
+000263f0: 2827 7827 2c20 2766 3827 2929 0a0a 2020  ('x', 'f8'))..  
+00026400: 2020 2020 2020 496e 2074 6865 2063 6173        In the cas
+00026410: 6520 7768 6572 6520 7468 6520 6d65 7461  e where the meta
+00026420: 6461 7461 2064 6f65 736e 2774 2063 6861  data doesn't cha
+00026430: 6e67 652c 2079 6f75 2063 616e 2061 6c73  nge, you can als
+00026440: 6f20 7061 7373 2069 6e0a 2020 2020 2020  o pass in.      
+00026450: 2020 7468 6520 6f62 6a65 6374 2069 7473    the object its
+00026460: 656c 6620 6469 7265 6374 6c79 3a0a 0a20  elf directly:.. 
+00026470: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00026480: 2064 732e 6170 706c 7928 6c61 6d62 6461   ds.apply(lambda
+00026490: 2078 3a20 7820 2b20 312c 206d 6574 613d   x: x + 1, meta=
+000264a0: 6473 290a 0a20 2020 2020 2020 2053 6565  ds)..        See
+000264b0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+000264c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2053  ------.        S
+000264d0: 6572 6965 732e 6d61 705f 7061 7274 6974  eries.map_partit
+000264e0: 696f 6e73 0a20 2020 2020 2020 2022 2222  ions.        """
+000264f0: 0a20 2020 2020 2020 2073 656c 662e 5f76  .        self._v
+00026500: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+00026510: 7329 0a20 2020 2020 2020 2069 6620 6d65  s).        if me
+00026520: 7461 2069 7320 6e6f 5f64 6566 6175 6c74  ta is no_default
+00026530: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+00026540: 7461 203d 2065 7870 722e 5f65 6d75 6c61  ta = expr._emula
+00026550: 7465 284d 2e61 7070 6c79 2c20 7365 6c66  te(M.apply, self
+00026560: 2c20 6675 6e63 7469 6f6e 2c20 6172 6773  , function, args
+00026570: 3d61 7267 732c 2075 6466 3d54 7275 652c  =args, udf=True,
+00026580: 202a 2a6b 7761 7267 7329 0a20 2020 2020   **kwargs).     
+00026590: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000265a0: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
+000265b0: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
+000265c0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+000265d0: 6563 7469 6f6e 2873 656c 662e 6578 7072  ection(self.expr
+000265e0: 2e61 7070 6c79 2866 756e 6374 696f 6e2c  .apply(function,
+000265f0: 202a 6172 6773 2c20 6d65 7461 3d6d 6574   *args, meta=met
+00026600: 612c 202a 2a6b 7761 7267 7329 290a 0a20  a, **kwargs)).. 
+00026610: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+00026620: 2020 2020 6465 6620 5f76 616c 6964 6174      def _validat
+00026630: 655f 6178 6973 2863 6c73 2c20 6178 6973  e_axis(cls, axis
+00026640: 3d30 2c20 6e75 6d65 7269 635f 6178 6973  =0, numeric_axis
+00026650: 3a20 626f 6f6c 203d 2054 7275 6529 202d  : bool = True) -
+00026660: 3e20 4e6f 6e65 207c 204c 6974 6572 616c  > None | Literal
+00026670: 5b30 2c20 315d 3a0a 2020 2020 2020 2020  [0, 1]:.        
+00026680: 6966 2061 7869 7320 6e6f 7420 696e 2028  if axis not in (
+00026690: 302c 2022 696e 6465 7822 2c20 4e6f 6e65  0, "index", None
+000266a0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000266b0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000266c0: 6622 4e6f 2061 7869 7320 6e61 6d65 6420  f"No axis named 
+000266d0: 7b61 7869 737d 2066 6f72 2053 6572 6965  {axis} for Serie
+000266e0: 7322 290a 2020 2020 2020 2020 6966 206e  s").        if n
+000266f0: 756d 6572 6963 5f61 7869 733a 0a20 2020  umeric_axis:.   
+00026700: 2020 2020 2020 2020 206e 756d 5f61 7869           num_axi
+00026710: 733a 2064 6963 745b 7374 7220 7c20 4e6f  s: dict[str | No
+00026720: 6e65 2c20 4c69 7465 7261 6c5b 302c 2031  ne, Literal[0, 1
+00026730: 5d5d 203d 207b 2269 6e64 6578 223a 2030  ]] = {"index": 0
+00026740: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
+00026750: 7475 726e 206e 756d 5f61 7869 732e 6765  turn num_axis.ge
+00026760: 7428 6178 6973 2c20 6178 6973 290a 2020  t(axis, axis).  
+00026770: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00026780: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00026790: 7869 730a 0a20 2020 2040 6465 7269 7665  xis..    @derive
+000267a0: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+000267b0: 290a 2020 2020 6465 6620 7371 7565 657a  ).    def squeez
+000267c0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+000267d0: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+000267e0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000267f0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+00026800: 6566 2064 726f 706e 6128 7365 6c66 293a  ef dropna(self):
+00026810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00026820: 6e65 775f 636f 6c6c 6563 7469 6f6e 2865  new_collection(e
+00026830: 7870 722e 4472 6f70 6e61 5365 7269 6573  xpr.DropnaSeries
+00026840: 2873 656c 6629 290a 0a20 2020 2040 6465  (self))..    @de
+00026850: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00026860: 7269 6573 290a 2020 2020 6465 6620 6265  ries).    def be
+00026870: 7477 6565 6e28 7365 6c66 2c20 6c65 6674  tween(self, left
+00026880: 2c20 7269 6768 742c 2069 6e63 6c75 7369  , right, inclusi
+00026890: 7665 3d22 626f 7468 2229 3a0a 2020 2020  ve="both"):.    
+000268a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000268b0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+000268c0: 2020 2020 2020 2065 7870 722e 4265 7477         expr.Betw
+000268d0: 6565 6e28 7365 6c66 2c20 6c65 6674 3d6c  een(self, left=l
+000268e0: 6566 742c 2072 6967 6874 3d72 6967 6874  eft, right=right
+000268f0: 2c20 696e 636c 7573 6976 653d 696e 636c  , inclusive=incl
+00026900: 7573 6976 6529 0a20 2020 2020 2020 2029  usive).        )
+00026910: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00026920: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00026930: 2020 2064 6566 2063 6f6d 6269 6e65 2873     def combine(s
+00026940: 656c 662c 206f 7468 6572 2c20 6675 6e63  elf, other, func
+00026950: 2c20 6669 6c6c 5f76 616c 7565 3d4e 6f6e  , fill_value=Non
+00026960: 6529 3a0a 2020 2020 2020 2020 6f74 6865  e):.        othe
+00026970: 7220 3d20 7365 6c66 2e5f 6372 6561 7465  r = self._create
+00026980: 5f61 6c69 676e 6162 6c65 5f66 7261 6d65  _alignable_frame
+00026990: 286f 7468 6572 2c20 226f 7574 6572 2229  (other, "outer")
+000269a0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+000269b0: 6578 7072 2e61 7265 5f63 6f5f 616c 6967  expr.are_co_alig
+000269c0: 6e65 6428 7365 6c66 2e65 7870 722c 206f  ned(self.expr, o
+000269d0: 7468 6572 2e65 7870 7229 3a0a 2020 2020  ther.expr):.    
+000269e0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+000269f0: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
+00026a00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00026a10: 7870 722e 436f 6d62 696e 6553 6572 6965  xpr.CombineSerie
+00026a20: 7341 6c69 676e 2873 656c 662c 206f 7468  sAlign(self, oth
+00026a30: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
+00026a40: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
+00026a50: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00026a60: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00026a70: 6e28 6578 7072 2e43 6f6d 6269 6e65 5365  n(expr.CombineSe
+00026a80: 7269 6573 2873 656c 662c 206f 7468 6572  ries(self, other
+00026a90: 2c20 6675 6e63 2c20 6669 6c6c 5f76 616c  , func, fill_val
+00026aa0: 7565 2929 0a0a 2020 2020 4064 6572 6976  ue))..    @deriv
+00026ab0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00026ac0: 7329 0a20 2020 2064 6566 2065 7870 6c6f  s).    def explo
+00026ad0: 6465 2873 656c 6629 3a0a 2020 2020 2020  de(self):.      
+00026ae0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00026af0: 6c65 6374 696f 6e28 6578 7072 2e45 7870  lection(expr.Exp
+00026b00: 6c6f 6465 5365 7269 6573 2873 656c 6629  lodeSeries(self)
+00026b10: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00026b20: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00026b30: 2020 2020 6465 6620 6164 645f 7072 6566      def add_pref
+00026b40: 6978 2873 656c 662c 2070 7265 6669 7829  ix(self, prefix)
+00026b50: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00026b60: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+00026b70: 6578 7072 2e41 6464 5072 6566 6978 5365  expr.AddPrefixSe
+00026b80: 7269 6573 2873 656c 662c 2070 7265 6669  ries(self, prefi
+00026b90: 7829 290a 0a20 2020 2040 6465 7269 7665  x))..    @derive
+00026ba0: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00026bb0: 290a 2020 2020 6465 6620 6164 645f 7375  ).    def add_su
+00026bc0: 6666 6978 2873 656c 662c 2073 7566 6669  ffix(self, suffi
+00026bd0: 7829 3a0a 2020 2020 2020 2020 7265 7475  x):.        retu
+00026be0: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00026bf0: 6e28 6578 7072 2e41 6464 5375 6666 6978  n(expr.AddSuffix
+00026c00: 5365 7269 6573 2873 656c 662c 2073 7566  Series(self, suf
+00026c10: 6669 7829 290a 0a20 2020 2063 6174 203d  fix))..    cat =
+00026c20: 2043 6163 6865 6441 6363 6573 736f 7228   CachedAccessor(
+00026c30: 2263 6174 222c 2043 6174 6567 6f72 6963  "cat", Categoric
+00026c40: 616c 4163 6365 7373 6f72 290a 2020 2020  alAccessor).    
+00026c50: 6474 203d 2043 6163 6865 6441 6363 6573  dt = CachedAcces
+00026c60: 736f 7228 2264 7422 2c20 4461 7465 7469  sor("dt", Dateti
+00026c70: 6d65 4163 6365 7373 6f72 290a 2020 2020  meAccessor).    
+00026c80: 7374 7220 3d20 4361 6368 6564 4163 6365  str = CachedAcce
+00026c90: 7373 6f72 2822 7374 7222 2c20 5374 7269  ssor("str", Stri
+00026ca0: 6e67 4163 6365 7373 6f72 290a 0a20 2020  ngAccessor)..   
+00026cb0: 2064 6566 205f 7265 7061 7274 6974 696f   def _repartitio
+00026cc0: 6e5f 7175 616e 7469 6c65 7328 7365 6c66  n_quantiles(self
+00026cd0: 2c20 6e70 6172 7469 7469 6f6e 732c 2075  , npartitions, u
+00026ce0: 7073 616d 706c 653d 312e 302c 2072 616e  psample=1.0, ran
+00026cf0: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
+00026d00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00026d10: 6e65 775f 636f 6c6c 6563 7469 6f6e 280a  new_collection(.
+00026d20: 2020 2020 2020 2020 2020 2020 5265 7061              Repa
+00026d30: 7274 6974 696f 6e51 7561 6e74 696c 6573  rtitionQuantiles
+00026d40: 2873 656c 662c 206e 7061 7274 6974 696f  (self, npartitio
+00026d50: 6e73 2c20 7570 7361 6d70 6c65 2c20 7261  ns, upsample, ra
+00026d60: 6e64 6f6d 5f73 7461 7465 290a 2020 2020  ndom_state).    
+00026d70: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+00026d80: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00026d90: 6573 290a 2020 2020 6465 6620 6772 6f75  es).    def grou
+00026da0: 7062 7928 7365 6c66 2c20 6279 2c20 2a2a  pby(self, by, **
+00026db0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00026dc0: 2066 726f 6d20 6461 736b 5f65 7870 722e   from dask_expr.
+00026dd0: 5f67 726f 7570 6279 2069 6d70 6f72 7420  _groupby import 
+00026de0: 5365 7269 6573 4772 6f75 7042 790a 0a20  SeriesGroupBy.. 
+00026df0: 2020 2020 2020 2072 6574 7572 6e20 5365         return Se
+00026e00: 7269 6573 4772 6f75 7042 7928 7365 6c66  riesGroupBy(self
+00026e10: 2c20 6279 2c20 2a2a 6b77 6172 6773 290a  , by, **kwargs).
+00026e20: 0a20 2020 2064 6566 2072 656e 616d 6528  .    def rename(
+00026e30: 7365 6c66 2c20 696e 6465 782c 2073 6f72  self, index, sor
+00026e40: 7465 645f 696e 6465 783d 4661 6c73 6529  ted_index=False)
+00026e50: 3a0a 2020 2020 2020 2020 2222 2241 6c74  :.        """Alt
+00026e60: 6572 2053 6572 6965 7320 696e 6465 7820  er Series index 
+00026e70: 6c61 6265 6c73 206f 7220 6e61 6d65 0a0a  labels or name..
+00026e80: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+00026e90: 202f 2064 6963 7420 7661 6c75 6573 206d   / dict values m
+00026ea0: 7573 7420 6265 2075 6e69 7175 6520 2831  ust be unique (1
+00026eb0: 2d74 6f2d 3129 2e20 4c61 6265 6c73 206e  -to-1). Labels n
+00026ec0: 6f74 2063 6f6e 7461 696e 6564 2069 6e0a  ot contained in.
+00026ed0: 2020 2020 2020 2020 6120 6469 6374 202f          a dict /
+00026ee0: 2053 6572 6965 7320 7769 6c6c 2062 6520   Series will be 
+00026ef0: 6c65 6674 2061 732d 6973 2e20 4578 7472  left as-is. Extr
+00026f00: 6120 6c61 6265 6c73 206c 6973 7465 6420  a labels listed 
+00026f10: 646f 6e27 7420 7468 726f 7720 616e 0a20  don't throw an. 
+00026f20: 2020 2020 2020 2065 7272 6f72 2e0a 0a20         error... 
+00026f30: 2020 2020 2020 2041 6c74 6572 6e61 7469         Alternati
+00026f40: 7665 6c79 2c20 6368 616e 6765 2060 6053  vely, change ``S
+00026f50: 6572 6965 732e 6e61 6d65 6060 2077 6974  eries.name`` wit
+00026f60: 6820 6120 7363 616c 6172 2076 616c 7565  h a scalar value
+00026f70: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00026f80: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00026f90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00026fa0: 2069 6e64 6578 203a 2073 6361 6c61 722c   index : scalar,
+00026fb0: 2068 6173 6861 626c 6520 7365 7175 656e   hashable sequen
+00026fc0: 6365 2c20 6469 6374 2d6c 696b 6520 6f72  ce, dict-like or
+00026fd0: 2063 616c 6c61 626c 652c 206f 7074 696f   callable, optio
+00026fe0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00026ff0: 4966 2064 6963 742d 6c69 6b65 206f 7220  If dict-like or 
+00027000: 6361 6c6c 6162 6c65 2c20 7468 6520 7472  callable, the tr
+00027010: 616e 7366 6f72 6d61 7469 6f6e 2069 7320  ansformation is 
+00027020: 6170 706c 6965 6420 746f 2074 6865 0a20  applied to the. 
+00027030: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00027040: 2e20 5363 616c 6172 206f 7220 6861 7368  . Scalar or hash
+00027050: 6162 6c65 2073 6571 7565 6e63 652d 6c69  able sequence-li
+00027060: 6b65 2077 696c 6c20 616c 7465 7220 7468  ke will alter th
+00027070: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+00027080: 5365 7269 6573 2e6e 616d 6560 6020 6174  Series.name`` at
+00027090: 7472 6962 7574 652e 0a20 2020 2020 2020  tribute..       
+000270a0: 2069 6e70 6c61 6365 203a 2062 6f6f 6c65   inplace : boole
+000270b0: 616e 2c20 6465 6661 756c 7420 4661 6c73  an, default Fals
+000270c0: 650a 2020 2020 2020 2020 2020 2020 5768  e.            Wh
+000270d0: 6574 6865 7220 746f 2072 6574 7572 6e20  ether to return 
+000270e0: 6120 6e65 7720 5365 7269 6573 206f 7220  a new Series or 
+000270f0: 6d6f 6469 6679 2074 6869 7320 6f6e 6520  modify this one 
+00027100: 696e 706c 6163 652e 0a20 2020 2020 2020  inplace..       
+00027110: 2073 6f72 7465 645f 696e 6465 7820 3a20   sorted_index : 
+00027120: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
+00027130: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00027140: 4966 2074 7275 652c 2074 6865 206f 7574  If true, the out
+00027150: 7075 7420 6060 5365 7269 6573 6060 2077  put ``Series`` w
+00027160: 696c 6c20 6861 7665 206b 6e6f 776e 2064  ill have known d
+00027170: 6976 6973 696f 6e73 2069 6e66 6572 7265  ivisions inferre
+00027180: 640a 2020 2020 2020 2020 2020 2020 6672  d.            fr
+00027190: 6f6d 2074 6865 2069 6e70 7574 2073 6572  om the input ser
+000271a0: 6965 7320 616e 6420 7468 6520 7472 616e  ies and the tran
+000271b0: 7366 6f72 6d61 7469 6f6e 2e20 4967 6e6f  sformation. Igno
+000271c0: 7265 6420 666f 720a 2020 2020 2020 2020  red for.        
+000271d0: 2020 2020 6e6f 6e2d 6361 6c6c 6162 6c65      non-callable
+000271e0: 2f64 6963 742d 6c69 6b65 2060 6069 6e64  /dict-like ``ind
+000271f0: 6578 6060 206f 7220 7768 656e 2074 6865  ex`` or when the
+00027200: 2069 6e70 7574 2073 6572 6965 7320 6861   input series ha
+00027210: 730a 2020 2020 2020 2020 2020 2020 756e  s.            un
+00027220: 6b6e 6f77 6e20 6469 7669 7369 6f6e 732e  known divisions.
+00027230: 204e 6f74 6520 7468 6174 2074 6869 7320   Note that this 
+00027240: 6d61 7920 6f6e 6c79 2062 6520 7365 7420  may only be set 
+00027250: 746f 2060 6054 7275 6560 6020 6966 0a20  to ``True`` if. 
+00027260: 2020 2020 2020 2020 2020 2079 6f75 206b             you k
+00027270: 6e6f 7720 7468 6174 2074 6865 2074 7261  now that the tra
+00027280: 6e73 666f 726d 6564 2069 6e64 6578 2069  nsformed index i
+00027290: 7320 6d6f 6e6f 746f 6e69 6361 6c6c 7920  s monotonically 
+000272a0: 696e 6372 6561 7369 6e67 2e20 4461 736b  increasing. Dask
+000272b0: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+000272c0: 6c20 6368 6563 6b20 7468 6174 2074 7261  l check that tra
+000272d0: 6e73 666f 726d 6564 2064 6976 6973 696f  nsformed divisio
+000272e0: 6e73 2061 7265 206d 6f6e 6f74 6f6e 6963  ns are monotonic
+000272f0: 2c20 6275 7420 6361 6e6e 6f74 0a20 2020  , but cannot.   
+00027300: 2020 2020 2020 2020 2063 6865 636b 2061           check a
+00027310: 6c6c 2074 6865 2076 616c 7565 7320 6265  ll the values be
+00027320: 7477 6565 6e20 6469 7669 7369 6f6e 732c  tween divisions,
+00027330: 2073 6f20 696e 636f 7272 6563 746c 7920   so incorrectly 
+00027340: 7365 7474 696e 6720 7468 6973 0a20 2020  setting this.   
+00027350: 2020 2020 2020 2020 2063 616e 2072 6573           can res
+00027360: 756c 7420 696e 2062 7567 732e 0a0a 2020  ult in bugs...  
+00027370: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00027380: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00027390: 2020 2020 2020 7265 6e61 6d65 6420 3a20        renamed : 
+000273a0: 5365 7269 6573 0a0a 2020 2020 2020 2020  Series..        
+000273b0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000273c0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000273d0: 2020 7061 6e64 6173 2e53 6572 6965 732e    pandas.Series.
+000273e0: 7265 6e61 6d65 0a20 2020 2020 2020 2022  rename.        "
+000273f0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00027400: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+00027410: 2865 7870 722e 5265 6e61 6d65 5365 7269  (expr.RenameSeri
+00027420: 6573 2873 656c 662c 2069 6e64 6578 2c20  es(self, index, 
+00027430: 736f 7274 6564 5f69 6e64 6578 2929 0a0a  sorted_index))..
+00027440: 2020 2020 6465 6620 7175 616e 7469 6c65      def quantile
+00027450: 2873 656c 662c 2071 3d30 2e35 2c20 6d65  (self, q=0.5, me
+00027460: 7468 6f64 3d22 6465 6661 756c 7422 293a  thod="default"):
+00027470: 0a20 2020 2020 2020 2022 2222 4170 7072  .        """Appr
+00027480: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
+00027490: 7320 6f66 2053 6572 6965 730a 0a20 2020  s of Series..   
+000274a0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000274b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000274c0: 2d2d 0a20 2020 2020 2020 2071 203a 206c  --.        q : l
+000274d0: 6973 742f 6172 7261 7920 6f66 2066 6c6f  ist/array of flo
+000274e0: 6174 732c 2064 6566 6175 6c74 2030 2e35  ats, default 0.5
+000274f0: 2028 3530 2529 0a20 2020 2020 2020 2020   (50%).         
+00027500: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
+00027510: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
+00027520: 726f 6d20 3020 746f 2031 2066 6f72 2074  rom 0 to 1 for t
+00027530: 6865 2064 6573 6972 6564 2071 7561 6e74  he desired quant
+00027540: 696c 6573 0a20 2020 2020 2020 206d 6574  iles.        met
+00027550: 686f 6420 3a20 7b27 6465 6661 756c 7427  hod : {'default'
+00027560: 2c20 2774 6469 6765 7374 272c 2027 6461  , 'tdigest', 'da
+00027570: 736b 277d 2c20 6f70 7469 6f6e 616c 0a20  sk'}, optional. 
+00027580: 2020 2020 2020 2020 2020 2057 6861 7420             What 
+00027590: 6d65 7468 6f64 2074 6f20 7573 652e 2042  method to use. B
+000275a0: 7920 6465 6661 756c 7420 7769 6c6c 2075  y default will u
+000275b0: 7365 2064 6173 6b27 7320 696e 7465 726e  se dask's intern
+000275c0: 616c 2063 7573 746f 6d0a 2020 2020 2020  al custom.      
+000275d0: 2020 2020 2020 616c 676f 7269 7468 6d20        algorithm 
+000275e0: 2860 6027 6461 736b 2760 6029 2e20 2049  (``'dask'``).  I
+000275f0: 6620 7365 7420 746f 2060 6027 7464 6967  f set to ``'tdig
+00027600: 6573 7427 6060 2077 696c 6c20 7573 6520  est'`` will use 
+00027610: 7464 6967 6573 740a 2020 2020 2020 2020  tdigest.        
+00027620: 2020 2020 666f 7220 666c 6f61 7473 2061      for floats a
+00027630: 6e64 2069 6e74 7320 616e 6420 6661 6c6c  nd ints and fall
+00027640: 6261 636b 2074 6f20 7468 6520 6060 2764  back to the ``'d
+00027650: 6173 6b27 6060 206f 7468 6572 7769 7365  ask'`` otherwise
+00027660: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00027670: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
+00027680: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
+00027690: 6c66 2c20 2271 7561 6e74 696c 6522 290a  lf, "quantile").
+000276a0: 2020 2020 2020 2020 616c 6c6f 7765 645f          allowed_
+000276b0: 6d65 7468 6f64 7320 3d20 5b22 6465 6661  methods = ["defa
+000276c0: 756c 7422 2c20 2264 6173 6b22 2c20 2274  ult", "dask", "t
+000276d0: 6469 6765 7374 225d 0a20 2020 2020 2020  digest"].       
+000276e0: 2069 6620 6d65 7468 6f64 206e 6f74 2069   if method not i
+000276f0: 6e20 616c 6c6f 7765 645f 6d65 7468 6f64  n allowed_method
+00027700: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00027710: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00027720: 226d 6574 686f 6420 6361 6e20 6f6e 6c79  "method can only
+00027730: 2062 6520 2764 6566 6175 6c74 272c 2027   be 'default', '
+00027740: 6461 736b 2720 6f72 2027 7464 6967 6573  dask' or 'tdiges
+00027750: 7427 2229 0a20 2020 2020 2020 2072 6574  t'").        ret
+00027760: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00027770: 6f6e 2853 6572 6965 7351 7561 6e74 696c  on(SeriesQuantil
+00027780: 6528 7365 6c66 2c20 712c 206d 6574 686f  e(self, q, metho
+00027790: 6429 290a 0a20 2020 2040 6465 7269 7665  d))..    @derive
+000277a0: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+000277b0: 290a 2020 2020 6465 6620 6d65 6469 616e  ).    def median
+000277c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000277d0: 6966 2073 656c 662e 6e70 6172 7469 7469  if self.npartiti
+000277e0: 6f6e 7320 3d3d 2031 3a0a 2020 2020 2020  ons == 1:.      
+000277f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00027800: 662e 6d65 6469 616e 5f61 7070 726f 7869  f.median_approxi
+00027810: 6d61 7465 2829 0a20 2020 2020 2020 2072  mate().        r
+00027820: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00027830: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+00027840: 2020 2020 2020 2244 6173 6b20 646f 6573        "Dask does
+00027850: 6e27 7420 696d 706c 656d 656e 7420 616e  n't implement an
+00027860: 2065 7861 6374 206d 6564 6961 6e20 696e   exact median in
+00027870: 2061 6c6c 2063 6173 6573 2061 7320 7468   all cases as th
+00027880: 6973 2069 7320 6861 7264 2074 6f20 646f  is is hard to do
+00027890: 2069 6e20 7061 7261 6c6c 656c 2e20 220a   in parallel. ".
+000278a0: 2020 2020 2020 2020 2020 2020 2253 6565              "See
+000278b0: 2074 6865 2060 6d65 6469 616e 5f61 7070   the `median_app
+000278c0: 726f 7869 6d61 7465 6020 6d65 7468 6f64  roximate` method
+000278d0: 2069 6e73 7465 6164 2c20 7768 6963 6820   instead, which 
+000278e0: 7573 6573 2061 6e20 6170 7072 6f78 696d  uses an approxim
+000278f0: 6174 6520 616c 676f 7269 7468 6d2e 220a  ate algorithm.".
+00027900: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00027910: 6566 206d 6564 6961 6e5f 6170 7072 6f78  ef median_approx
+00027920: 696d 6174 6528 7365 6c66 2c20 6d65 7468  imate(self, meth
+00027930: 6f64 3d22 6465 6661 756c 7422 293a 0a20  od="default"):. 
+00027940: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00027950: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
+00027960: 206d 6564 6961 6e20 6f66 2074 6865 2076   median of the v
+00027970: 616c 7565 7320 6f76 6572 2074 6865 2072  alues over the r
+00027980: 6571 7565 7374 6564 2061 7869 732e 0a0a  equested axis...
+00027990: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000279a0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+000279b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6d65  -----.        me
+000279c0: 7468 6f64 203a 207b 2764 6566 6175 6c74  thod : {'default
+000279d0: 272c 2027 7464 6967 6573 7427 2c20 2764  ', 'tdigest', 'd
+000279e0: 6173 6b27 7d2c 206f 7074 696f 6e61 6c0a  ask'}, optional.
+000279f0: 2020 2020 2020 2020 2020 2020 5768 6174              What
+00027a00: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
+00027a10: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
+00027a20: 7573 6520 4461 736b 2773 2069 6e74 6572  use Dask's inter
+00027a30: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
+00027a40: 2020 2020 2020 2061 6c67 6f72 6974 686d         algorithm
+00027a50: 2028 6060 2264 6173 6b22 6060 292e 2020   (``"dask"``).  
+00027a60: 4966 2073 6574 2074 6f20 6060 2274 6469  If set to ``"tdi
+00027a70: 6765 7374 2260 6020 7769 6c6c 2075 7365  gest"`` will use
+00027a80: 2074 6469 6765 7374 0a20 2020 2020 2020   tdigest.       
+00027a90: 2020 2020 2066 6f72 2066 6c6f 6174 7320       for floats 
+00027aa0: 616e 6420 696e 7473 2061 6e64 2066 616c  and ints and fal
+00027ab0: 6c62 6163 6b20 746f 2074 6865 2060 6022  lback to the ``"
+00027ac0: 6461 736b 2260 6020 6f74 6865 7277 6973  dask"`` otherwis
+00027ad0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00027ae0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00027af0: 6c66 2e71 7561 6e74 696c 6528 6d65 7468  lf.quantile(meth
+00027b00: 6f64 3d6d 6574 686f 6429 0a0a 2020 2020  od=method)..    
+00027b10: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00027b20: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00027b30: 2063 6f76 2873 656c 662c 206f 7468 6572   cov(self, other
+00027b40: 2c20 6d69 6e5f 7065 7269 6f64 733d 4e6f  , min_periods=No
+00027b50: 6e65 2c20 7370 6c69 745f 6576 6572 793d  ne, split_every=
+00027b60: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00027b70: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00027b80: 6528 6f74 6865 722c 2053 6572 6965 7329  e(other, Series)
+00027b90: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00027ba0: 6973 6520 5479 7065 4572 726f 7228 226f  ise TypeError("o
+00027bb0: 7468 6572 206d 7573 7420 6265 2061 2064  ther must be a d
+00027bc0: 6173 6b2e 6461 7461 6672 616d 652e 5365  ask.dataframe.Se
+00027bd0: 7269 6573 2229 0a20 2020 2020 2020 2064  ries").        d
+00027be0: 6620 3d20 636f 6e63 6174 285b 7365 6c66  f = concat([self
+00027bf0: 2c20 6f74 6865 725d 2c20 6178 6973 3d31  , other], axis=1
+00027c00: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00027c10: 2064 662e 5f63 6f76 286d 696e 5f70 6572   df._cov(min_per
+00027c20: 696f 6473 2c20 5472 7565 2c20 7370 6c69  iods, True, spli
+00027c30: 745f 6576 6572 792c 2073 6361 6c61 723d  t_every, scalar=
+00027c40: 5472 7565 290a 0a20 2020 2040 6465 7269  True)..    @deri
+00027c50: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00027c60: 6573 290a 2020 2020 6465 6620 636f 7272  es).    def corr
+00027c70: 2873 656c 662c 206f 7468 6572 2c20 6d65  (self, other, me
+00027c80: 7468 6f64 3d22 7065 6172 736f 6e22 2c20  thod="pearson", 
+00027c90: 6d69 6e5f 7065 7269 6f64 733d 4e6f 6e65  min_periods=None
+00027ca0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00027cb0: 6c73 6529 3a0a 2020 2020 2020 2020 6966  lse):.        if
+00027cc0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00027cd0: 6f74 6865 722c 2053 6572 6965 7329 3a0a  other, Series):.
+00027ce0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00027cf0: 6520 5479 7065 4572 726f 7228 226f 7468  e TypeError("oth
+00027d00: 6572 206d 7573 7420 6265 2061 2064 6173  er must be a das
+00027d10: 6b2e 6461 7461 6672 616d 652e 5365 7269  k.dataframe.Seri
+00027d20: 6573 2229 0a20 2020 2020 2020 2064 6620  es").        df 
+00027d30: 3d20 636f 6e63 6174 285b 7365 6c66 2c20  = concat([self, 
+00027d40: 6f74 6865 725d 2c20 6178 6973 3d31 290a  other], axis=1).
+00027d50: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00027d60: 662e 5f63 6f72 7228 6d65 7468 6f64 2c20  f._corr(method, 
+00027d70: 6d69 6e5f 7065 7269 6f64 732c 2054 7275  min_periods, Tru
+00027d80: 652c 2073 706c 6974 5f65 7665 7279 2c20  e, split_every, 
+00027d90: 7363 616c 6172 3d54 7275 6529 0a0a 2020  scalar=True)..  
+00027da0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00027db0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+00027dc0: 6566 2061 7574 6f63 6f72 7228 7365 6c66  ef autocorr(self
+00027dd0: 2c20 6c61 673d 312c 2073 706c 6974 5f65  , lag=1, split_e
+00027de0: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
+00027df0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00027e00: 7374 616e 6365 286c 6167 2c20 496e 7465  stance(lag, Inte
+00027e10: 6772 616c 293a 0a20 2020 2020 2020 2020  gral):.         
+00027e20: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00027e30: 6f72 2822 6c61 6720 6d75 7374 2062 6520  or("lag must be 
+00027e40: 616e 2069 6e74 6567 6572 2229 0a20 2020  an integer").   
+00027e50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00027e60: 2e63 6f72 7228 7365 6c66 2069 6620 6c61  .corr(self if la
+00027e70: 6720 3d3d 2030 2065 6c73 6520 7365 6c66  g == 0 else self
+00027e80: 2e73 6869 6674 286c 6167 292c 2073 706c  .shift(lag), spl
+00027e90: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00027ea0: 7665 7279 290a 0a20 2020 2040 6465 7269  very)..    @deri
+00027eb0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00027ec0: 6573 290a 2020 2020 6465 6620 6465 7363  es).    def desc
+00027ed0: 7269 6265 280a 2020 2020 2020 2020 7365  ribe(.        se
+00027ee0: 6c66 2c0a 2020 2020 2020 2020 7370 6c69  lf,.        spli
+00027ef0: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
+00027f00: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+00027f10: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
+00027f20: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
+00027f30: 686f 643d 2264 6566 6175 6c74 222c 0a20  hod="default",. 
+00027f40: 2020 2020 2020 2069 6e63 6c75 6465 3d4e         include=N
+00027f50: 6f6e 652c 0a20 2020 2020 2020 2065 7863  one,.        exc
+00027f60: 6c75 6465 3d4e 6f6e 652c 0a20 2020 2029  lude=None,.    )
+00027f70: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
+00027f80: 2020 2020 2020 2020 2020 2069 735f 6e75             is_nu
+00027f90: 6d65 7269 635f 6474 7970 6528 7365 6c66  meric_dtype(self
+00027fa0: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
+00027fb0: 2020 2020 616e 6420 6e6f 7420 6973 5f62      and not is_b
+00027fc0: 6f6f 6c5f 6474 7970 6528 7365 6c66 2e64  ool_dtype(self.d
+00027fd0: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+00027fe0: 2020 6f72 2069 735f 7469 6d65 6465 6c74    or is_timedelt
+00027ff0: 6136 345f 6474 7970 6528 7365 6c66 2e64  a64_dtype(self.d
+00028000: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+00028010: 2020 6f72 2069 735f 6461 7465 7469 6d65    or is_datetime
+00028020: 3634 5f61 6e79 5f64 7479 7065 2873 656c  64_any_dtype(sel
+00028030: 662e 6474 7970 6529 0a20 2020 2020 2020  f.dtype).       
+00028040: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00028050: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00028060: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00028070: 2020 2020 2020 2044 6573 6372 6962 654e         DescribeN
+00028080: 756d 6572 6963 2873 656c 662c 2073 706c  umeric(self, spl
+00028090: 6974 5f65 7665 7279 2c20 7065 7263 656e  it_every, percen
+000280a0: 7469 6c65 732c 2070 6572 6365 6e74 696c  tiles, percentil
+000280b0: 6573 5f6d 6574 686f 6429 0a20 2020 2020  es_method).     
+000280c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000280d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000280e0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+000280f0: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
+00028100: 2020 2020 2020 2020 2020 4465 7363 7269            Descri
+00028110: 6265 4e6f 6e4e 756d 6572 6963 2873 656c  beNonNumeric(sel
+00028120: 662c 2073 706c 6974 5f65 7665 7279 2c20  f, split_every, 
+00028130: 7065 7263 656e 7469 6c65 732c 2070 6572  percentiles, per
+00028140: 6365 6e74 696c 6573 5f6d 6574 686f 6429  centiles_method)
+00028150: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00028160: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00028170: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00028180: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+00028190: 6566 2069 735f 6d6f 6e6f 746f 6e69 635f  ef is_monotonic_
+000281a0: 696e 6372 6561 7369 6e67 2873 656c 6629  increasing(self)
+000281b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000281c0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+000281d0: 4973 4d6f 6e6f 746f 6e69 6349 6e63 7265  IsMonotonicIncre
+000281e0: 6173 696e 6728 7365 6c66 2929 0a0a 2020  asing(self))..  
+000281f0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00028200: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00028210: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00028220: 2069 735f 6d6f 6e6f 746f 6e69 635f 6465   is_monotonic_de
+00028230: 6372 6561 7369 6e67 2873 656c 6629 3a0a  creasing(self):.
+00028240: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00028250: 6577 5f63 6f6c 6c65 6374 696f 6e28 4973  ew_collection(Is
+00028260: 4d6f 6e6f 746f 6e69 6344 6563 7265 6173  MonotonicDecreas
+00028270: 696e 6728 7365 6c66 2929 0a0a 2020 2020  ing(self))..    
+00028280: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00028290: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+000282a0: 2074 6f5f 7374 7269 6e67 2873 656c 662c   to_string(self,
+000282b0: 206d 6178 5f72 6f77 733d 3529 3a0a 2020   max_rows=5):.  
+000282c0: 2020 2020 2020 2320 6f70 7469 6f6e 5f63        # option_c
+000282d0: 6f6e 7465 7874 2064 6f65 736e 2774 2061  ontext doesn't a
+000282e0: 6666 6563 740a 2020 2020 2020 2020 7265  ffect.        re
+000282f0: 7475 726e 2073 656c 662e 5f72 6570 725f  turn self._repr_
+00028300: 6461 7461 2829 2e74 6f5f 7374 7269 6e67  data().to_string
+00028310: 286d 6178 5f72 6f77 733d 6d61 785f 726f  (max_rows=max_ro
+00028320: 7773 290a 0a20 2020 2064 6566 205f 7265  ws)..    def _re
+00028330: 7072 5f64 6174 6128 7365 6c66 293a 0a20  pr_data(self):. 
+00028340: 2020 2020 2020 2072 6574 7572 6e20 5f72         return _r
+00028350: 6570 725f 6461 7461 5f73 6572 6965 7328  epr_data_series(
+00028360: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+00028370: 2e5f 7265 7072 5f64 6976 6973 696f 6e73  ._repr_divisions
+00028380: 290a 0a20 2020 2069 6620 5041 4e44 4153  )..    if PANDAS
+00028390: 5f47 455f 3232 303a 0a0a 2020 2020 2020  _GE_220:..      
+000283a0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+000283b0: 7064 2e53 6572 6965 7329 0a20 2020 2020  pd.Series).     
+000283c0: 2020 2064 6566 2063 6173 655f 7768 656e     def case_when
+000283d0: 2873 656c 662c 2063 6173 656c 6973 7429  (self, caselist)
+000283e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000283f0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00028400: 6361 7365 6c69 7374 2c20 6c69 7374 293a  caselist, list):
+00028410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028420: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00028430: 2822 5468 6520 6361 7365 6c69 7374 2061  ("The caselist a
+00028440: 7267 756d 656e 7420 7368 6f75 6c64 2062  rgument should b
+00028450: 6520 6120 6c69 7374 2229 0a20 2020 2020  e a list").     
+00028460: 2020 2020 2020 2063 6173 656c 6973 7420         caselist 
+00028470: 3d20 6c69 7374 2866 6c61 7474 656e 285b  = list(flatten([
+00028480: 5b63 2c20 765d 2066 6f72 2063 2c20 7620  [c, v] for c, v 
+00028490: 696e 2063 6173 656c 6973 745d 2c20 636f  in caselist], co
+000284a0: 6e74 6169 6e65 723d 6c69 7374 2929 0a20  ntainer=list)). 
+000284b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000284c0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+000284d0: 2865 7870 722e 4361 7365 5768 656e 2873  (expr.CaseWhen(s
+000284e0: 656c 662c 202a 6361 7365 6c69 7374 2929  elf, *caselist))
+000284f0: 0a0a 0a66 6f72 206e 616d 6520 696e 205b  ...for name in [
+00028500: 0a20 2020 2022 6164 6422 2c0a 2020 2020  .    "add",.    
+00028510: 2273 7562 222c 0a20 2020 2022 6d75 6c22  "sub",.    "mul"
+00028520: 2c0a 2020 2020 2264 6976 222c 0a20 2020  ,.    "div",.   
+00028530: 2022 6469 7669 6465 222c 0a20 2020 2022   "divide",.    "
+00028540: 7472 7565 6469 7622 2c0a 2020 2020 2266  truediv",.    "f
+00028550: 6c6f 6f72 6469 7622 2c0a 2020 2020 226d  loordiv",.    "m
+00028560: 6f64 222c 0a20 2020 2022 706f 7722 2c0a  od",.    "pow",.
+00028570: 2020 2020 2272 6164 6422 2c0a 2020 2020      "radd",.    
+00028580: 2272 7375 6222 2c0a 2020 2020 2272 6d75  "rsub",.    "rmu
+00028590: 6c22 2c0a 2020 2020 2272 6469 7622 2c0a  l",.    "rdiv",.
+000285a0: 2020 2020 2272 7472 7565 6469 7622 2c0a      "rtruediv",.
+000285b0: 2020 2020 2272 666c 6f6f 7264 6976 222c      "rfloordiv",
+000285c0: 0a20 2020 2022 726d 6f64 222c 0a20 2020  .    "rmod",.   
+000285d0: 2022 7270 6f77 222c 0a5d 3a0a 2020 2020   "rpow",.]:.    
+000285e0: 6173 7365 7274 206e 6f74 2068 6173 6174  assert not hasat
+000285f0: 7472 2844 6174 6146 7261 6d65 2c20 6e61  tr(DataFrame, na
+00028600: 6d65 292c 206e 616d 650a 2020 2020 7365  me), name.    se
+00028610: 7461 7474 7228 4461 7461 4672 616d 652c  tattr(DataFrame,
+00028620: 206e 616d 652c 205f 7772 6170 5f65 7870   name, _wrap_exp
+00028630: 725f 6d65 7468 6f64 5f6f 7065 7261 746f  r_method_operato
+00028640: 7228 6e61 6d65 2c20 4461 7461 4672 616d  r(name, DataFram
+00028650: 6529 290a 0a20 2020 2061 7373 6572 7420  e))..    assert 
+00028660: 6e6f 7420 6861 7361 7474 7228 5365 7269  not hasattr(Seri
+00028670: 6573 2c20 6e61 6d65 292c 206e 616d 650a  es, name), name.
+00028680: 2020 2020 7365 7461 7474 7228 5365 7269      setattr(Seri
+00028690: 6573 2c20 6e61 6d65 2c20 5f77 7261 705f  es, name, _wrap_
+000286a0: 6578 7072 5f6d 6574 686f 645f 6f70 6572  expr_method_oper
+000286b0: 6174 6f72 286e 616d 652c 2053 6572 6965  ator(name, Serie
+000286c0: 7329 290a 0a0a 636c 6173 7320 496e 6465  s))...class Inde
+000286d0: 7828 5365 7269 6573 293a 0a20 2020 2022  x(Series):.    "
+000286e0: 2222 496e 6465 782d 6c69 6b65 2045 7870  ""Index-like Exp
+000286f0: 7220 436f 6c6c 6563 7469 6f6e 2e0a 0a20  r Collection... 
+00028700: 2020 2054 6865 2063 6f6e 7374 7275 6374     The construct
+00028710: 6f72 2074 616b 6573 2074 6865 2065 7870  or takes the exp
+00028720: 7265 7373 696f 6e20 7468 6174 2072 6570  ression that rep
+00028730: 7265 7365 6e74 7320 7468 6520 7175 6572  resents the quer
+00028740: 7920 6173 2069 6e70 7574 2e20 5468 6520  y as input. The 
+00028750: 636c 6173 730a 2020 2020 6973 206e 6f74  class.    is not
+00028760: 206d 6561 6e74 2074 6f20 6265 2069 6e73   meant to be ins
+00028770: 7461 6e74 6961 7465 6420 6469 7265 6374  tantiated direct
+00028780: 6c79 2e20 496e 7374 6561 642c 2075 7365  ly. Instead, use
+00028790: 206f 6e65 206f 6620 7468 6520 494f 2063   one of the IO c
+000287a0: 6f6e 6e65 6374 6f72 7320 6672 6f6d 0a20  onnectors from. 
+000287b0: 2020 2044 6173 6b2e 0a20 2020 2022 2222     Dask..    """
+000287c0: 0a0a 2020 2020 5f61 6363 6573 736f 7273  ..    _accessors
+000287d0: 3a20 436c 6173 7356 6172 5b73 6574 5b73  : ClassVar[set[s
+000287e0: 7472 5d5d 203d 2073 6574 2829 0a20 2020  tr]] = set().   
+000287f0: 205f 7061 7274 6974 696f 6e5f 7479 7065   _partition_type
+00028800: 203d 2070 642e 496e 6465 780a 0a20 2020   = pd.Index..   
+00028810: 205f 6474 5f61 7474 7269 6275 7465 7320   _dt_attributes 
+00028820: 3d20 7b0a 2020 2020 2020 2020 226e 616e  = {.        "nan
+00028830: 6f73 6563 6f6e 6422 2c0a 2020 2020 2020  osecond",.      
+00028840: 2020 226d 6963 726f 7365 636f 6e64 222c    "microsecond",
+00028850: 0a20 2020 2020 2020 2022 6d69 6c6c 6973  .        "millis
+00028860: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
+00028870: 2264 6179 6f66 7965 6172 222c 0a20 2020  "dayofyear",.   
+00028880: 2020 2020 2022 6d69 6e75 7465 222c 0a20       "minute",. 
+00028890: 2020 2020 2020 2022 686f 7572 222c 0a20         "hour",. 
+000288a0: 2020 2020 2020 2022 6461 7922 2c0a 2020         "day",.  
+000288b0: 2020 2020 2020 2264 6179 6f66 7765 656b        "dayofweek
+000288c0: 222c 0a20 2020 2020 2020 2022 7365 636f  ",.        "seco
+000288d0: 6e64 222c 0a20 2020 2020 2020 2022 7765  nd",.        "we
+000288e0: 656b 222c 0a20 2020 2020 2020 2022 7765  ek",.        "we
+000288f0: 656b 6461 7922 2c0a 2020 2020 2020 2020  ekday",.        
+00028900: 2277 6565 6b6f 6679 6561 7222 2c0a 2020  "weekofyear",.  
+00028910: 2020 2020 2020 226d 6f6e 7468 222c 0a20        "month",. 
+00028920: 2020 2020 2020 2022 7175 6172 7465 7222         "quarter"
+00028930: 2c0a 2020 2020 2020 2020 2279 6561 7222  ,.        "year"
+00028940: 2c0a 2020 2020 7d0a 0a20 2020 205f 6361  ,.    }..    _ca
+00028950: 745f 6174 7472 6962 7574 6573 203d 207b  t_attributes = {
+00028960: 0a20 2020 2020 2020 2022 6b6e 6f77 6e22  .        "known"
+00028970: 2c0a 2020 2020 2020 2020 2261 735f 6b6e  ,.        "as_kn
+00028980: 6f77 6e22 2c0a 2020 2020 2020 2020 2261  own",.        "a
+00028990: 735f 756e 6b6e 6f77 6e22 2c0a 2020 2020  s_unknown",.    
+000289a0: 2020 2020 2261 6464 5f63 6174 6567 6f72      "add_categor
+000289b0: 6965 7322 2c0a 2020 2020 2020 2020 2263  ies",.        "c
+000289c0: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+000289d0: 2020 2020 2272 656d 6f76 655f 6361 7465      "remove_cate
+000289e0: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
+000289f0: 2022 7265 6f72 6465 725f 6361 7465 676f   "reorder_catego
+00028a00: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
+00028a10: 6173 5f6f 7264 6572 6564 222c 0a20 2020  as_ordered",.   
+00028a20: 2020 2020 2022 636f 6465 7322 2c0a 2020       "codes",.  
+00028a30: 2020 2020 2020 2272 656d 6f76 655f 756e        "remove_un
+00028a40: 7573 6564 5f63 6174 6567 6f72 6965 7322  used_categories"
+00028a50: 2c0a 2020 2020 2020 2020 2273 6574 5f63  ,.        "set_c
+00028a60: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+00028a70: 2020 2020 2261 735f 756e 6f72 6465 7265      "as_unordere
+00028a80: 6422 2c0a 2020 2020 2020 2020 226f 7264  d",.        "ord
+00028a90: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
+00028aa0: 7265 6e61 6d65 5f63 6174 6567 6f72 6965  rename_categorie
+00028ab0: 7322 2c0a 2020 2020 7d0a 0a20 2020 2064  s",.    }..    d
+00028ac0: 6566 205f 5f67 6574 6174 7472 5f5f 2873  ef __getattr__(s
+00028ad0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+00028ae0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00028af0: 2020 2020 6973 696e 7374 616e 6365 2873      isinstance(s
+00028b00: 656c 662e 5f6d 6574 612e 6474 7970 652c  elf._meta.dtype,
+00028b10: 2070 642e 4361 7465 676f 7269 6361 6c44   pd.CategoricalD
+00028b20: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+00028b30: 2020 616e 6420 6b65 7920 696e 2073 656c    and key in sel
+00028b40: 662e 5f63 6174 5f61 7474 7269 6275 7465  f._cat_attribute
+00028b50: 730a 2020 2020 2020 2020 293a 0a20 2020  s.        ):.   
+00028b60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00028b70: 6765 7461 7474 7228 7365 6c66 2e63 6174  getattr(self.cat
+00028b80: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
+00028b90: 6c69 6620 6b65 7920 696e 2073 656c 662e  lif key in self.
+00028ba0: 5f64 745f 6174 7472 6962 7574 6573 3a0a  _dt_attributes:.
+00028bb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00028bc0: 726e 2067 6574 6174 7472 2873 656c 662e  rn getattr(self.
+00028bd0: 6474 2c20 6b65 7929 0a0a 2020 2020 2020  dt, key)..      
+00028be0: 2020 6966 2068 6173 6174 7472 2873 7570    if hasattr(sup
+00028bf0: 6572 2829 2c20 6b65 7929 3a20 2023 2044  er(), key):  # D
+00028c00: 6f65 736e 2774 2074 7269 6767 6572 2073  oesn't trigger s
+00028c10: 7570 6572 2829 2e5f 5f67 6574 6174 7472  uper().__getattr
+00028c20: 5f5f 0a20 2020 2020 2020 2020 2020 2023  __.            #
+00028c30: 204e 6f74 2061 206d 6167 6963 2061 7474   Not a magic att
+00028c40: 7269 6275 7465 2e20 5468 6973 2069 7320  ribute. This is 
+00028c50: 6120 7265 616c 206d 6574 686f 6420 6f72  a real method or
+00028c60: 2070 726f 7065 7274 7920 6f66 2053 6572   property of Ser
+00028c70: 6965 7320 7468 6174 0a20 2020 2020 2020  ies that.       
+00028c80: 2020 2020 2023 2068 6173 2062 6565 6e20       # has been 
+00028c90: 6f76 6572 7269 6464 656e 2062 7920 5261  overridden by Ra
+00028ca0: 6973 6541 7474 7269 6275 7465 4572 726f  iseAttributeErro
+00028cb0: 7228 292e 0a20 2020 2020 2020 2020 2020  r()..           
+00028cc0: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
+00028cd0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00028ce0: 2020 2020 2020 2066 227b 7365 6c66 2e5f         f"{self._
+00028cf0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+00028d00: 5f21 727d 206f 626a 6563 7420 6861 7320  _!r} object has 
+00028d10: 6e6f 2061 7474 7269 6275 7465 207b 6b65  no attribute {ke
+00028d20: 7921 727d 220a 2020 2020 2020 2020 2020  y!r}".          
+00028d30: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00028d40: 726e 2073 7570 6572 2829 2e5f 5f67 6574  rn super().__get
+00028d50: 6174 7472 5f5f 286b 6579 290a 0a20 2020  attr__(key)..   
+00028d60: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
+00028d70: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00028d80: 7572 6e20 6622 3c64 6173 6b5f 6578 7072  urn f"<dask_expr
+00028d90: 2e65 7870 722e 496e 6465 783a 2065 7870  .expr.Index: exp
+00028da0: 723d 7b73 656c 662e 6578 7072 7d3e 220a  r={self.expr}>".
+00028db0: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
+00028dc0: 5f77 7261 705f 5f28 7365 6c66 2c20 6172  _wrap__(self, ar
+00028dd0: 7261 792c 2063 6f6e 7465 7874 3d4e 6f6e  ray, context=Non
+00028de0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00028df0: 726e 2070 642e 496e 6465 7828 6172 7261  rn pd.Index(arra
+00028e00: 792c 206e 616d 653d 7365 6c66 2e6e 616d  y, name=self.nam
+00028e10: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
+00028e20: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
+00028e30: 2020 2020 6465 6620 746f 5f73 6572 6965      def to_serie
+00028e40: 7328 7365 6c66 2c20 696e 6465 783d 4e6f  s(self, index=No
+00028e50: 6e65 2c20 6e61 6d65 3d6e 6f5f 6465 6661  ne, name=no_defa
+00028e60: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
+00028e70: 2069 6e64 6578 2069 7320 6e6f 7420 4e6f   index is not No
+00028e80: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00028e90: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00028ea0: 6e74 6564 4572 726f 720a 2020 2020 2020  ntedError.      
+00028eb0: 2020 7265 7475 726e 206e 6577 5f63 6f6c    return new_col
+00028ec0: 6c65 6374 696f 6e28 6578 7072 2e54 6f53  lection(expr.ToS
+00028ed0: 6572 6965 7349 6e64 6578 2873 656c 662c  eriesIndex(self,
+00028ee0: 2069 6e64 6578 3d69 6e64 6578 2c20 6e61   index=index, na
+00028ef0: 6d65 3d6e 616d 6529 290a 0a20 2020 2040  me=name))..    @
+00028f00: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00028f10: 496e 6465 782c 2075 615f 6172 6773 3d5b  Index, ua_args=[
+00028f20: 2269 6e64 6578 225d 290a 2020 2020 6465  "index"]).    de
+00028f30: 6620 746f 5f66 7261 6d65 2873 656c 662c  f to_frame(self,
+00028f40: 2069 6e64 6578 3d54 7275 652c 206e 616d   index=True, nam
+00028f50: 653d 6e6f 5f64 6566 6175 6c74 293a 0a20  e=no_default):. 
+00028f60: 2020 2020 2020 2069 6620 6e6f 7420 696e         if not in
+00028f70: 6465 783a 0a20 2020 2020 2020 2020 2020  dex:.           
+00028f80: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00028f90: 656e 7465 6445 7272 6f72 0a20 2020 2020  entedError.     
+00028fa0: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00028fb0: 6c6c 6563 7469 6f6e 2865 7870 722e 546f  llection(expr.To
+00028fc0: 4672 616d 6549 6e64 6578 2873 656c 662c  FrameIndex(self,
+00028fd0: 2069 6e64 6578 3d69 6e64 6578 2c20 6e61   index=index, na
+00028fe0: 6d65 3d6e 616d 6529 290a 0a20 2020 2040  me=name))..    @
+00028ff0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00029000: 496e 6465 7829 0a20 2020 2064 6566 206d  Index).    def m
+00029010: 656d 6f72 795f 7573 6167 6528 7365 6c66  emory_usage(self
+00029020: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
+00029030: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00029040: 775f 636f 6c6c 6563 7469 6f6e 284d 656d  w_collection(Mem
+00029050: 6f72 7955 7361 6765 496e 6465 7828 7365  oryUsageIndex(se
+00029060: 6c66 2c20 6465 6570 3d64 6565 7029 290a  lf, deep=deep)).
+00029070: 0a20 2020 2064 6566 2073 6869 6674 2873  .    def shift(s
+00029080: 656c 662c 2070 6572 696f 6473 3d31 2c20  elf, periods=1, 
+00029090: 6672 6571 3d4e 6f6e 6529 3a0a 2020 2020  freq=None):.    
+000290a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000290b0: 6f6c 6c65 6374 696f 6e28 6578 7072 2e53  ollection(expr.S
+000290c0: 6869 6674 496e 6465 7828 7365 6c66 2c20  hiftIndex(self, 
+000290d0: 7065 7269 6f64 732c 2066 7265 7129 290a  periods, freq)).
+000290e0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000290f0: 6f6d 2870 642e 496e 6465 7829 0a20 2020  om(pd.Index).   
+00029100: 2064 6566 206d 6170 2873 656c 662c 2061   def map(self, a
+00029110: 7267 2c20 6e61 5f61 6374 696f 6e3d 4e6f  rg, na_action=No
+00029120: 6e65 2c20 6d65 7461 3d4e 6f6e 652c 2069  ne, meta=None, i
+00029130: 735f 6d6f 6e6f 746f 6e69 633d 4661 6c73  s_monotonic=Fals
+00029140: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+00029150: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
+00029160: 7420 7468 6973 206d 6574 686f 6420 636c  t this method cl
+00029170: 6561 7273 2061 6e79 206b 6e6f 776e 2064  ears any known d
+00029180: 6976 6973 696f 6e73 2e0a 0a20 2020 2020  ivisions...     
+00029190: 2020 2049 6620 796f 7572 206d 6170 7069     If your mappi
+000291a0: 6e67 2066 756e 6374 696f 6e20 6973 206d  ng function is m
+000291b0: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
+000291c0: 7265 6173 696e 6720 7468 656e 2075 7365  reasing then use
+000291d0: 2060 6973 5f6d 6f6e 6f74 6f6e 6963 600a   `is_monotonic`.
+000291e0: 2020 2020 2020 2020 746f 2061 7070 6c79          to apply
+000291f0: 2074 6865 206d 6170 696e 6720 6675 6e63   the maping func
+00029200: 7469 6f6e 2074 6f20 7468 6520 6f6c 6420  tion to the old 
+00029210: 6469 7669 7369 6f6e 7320 616e 6420 6173  divisions and as
+00029220: 7369 676e 2074 6865 206e 6577 0a20 2020  sign the new.   
+00029230: 2020 2020 2064 6976 6973 696f 6e73 2074       divisions t
+00029240: 6f20 7468 6520 6f75 7470 7574 2e0a 0a20  o the output... 
+00029250: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00029260: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00029270: 2861 7267 2c20 5365 7269 6573 293a 0a20  (arg, Series):. 
+00029280: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00029290: 7420 6578 7072 2e61 7265 5f63 6f5f 616c  t expr.are_co_al
+000292a0: 6967 6e65 6428 7365 6c66 2e65 7870 722c  igned(self.expr,
+000292b0: 2061 7267 2e65 7870 7229 3a0a 2020 2020   arg.expr):.    
+000292c0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+000292d0: 6574 6120 6973 204e 6f6e 653a 0a20 2020  eta is None:.   
+000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292f0: 2077 6172 6e69 6e67 732e 7761 726e 286d   warnings.warn(m
+00029300: 6574 615f 7761 726e 696e 6728 6d65 7461  eta_warning(meta
+00029310: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00029320: 2020 2072 6574 7572 6e20 6e65 775f 636f     return new_co
+00029330: 6c6c 6563 7469 6f6e 280a 2020 2020 2020  llection(.      
+00029340: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00029350: 7072 2e4d 6170 496e 6465 7841 6c69 676e  pr.MapIndexAlign
+00029360: 2873 656c 662c 2061 7267 2c20 6e61 5f61  (self, arg, na_a
+00029370: 6374 696f 6e2c 206d 6574 612c 2069 735f  ction, meta, is_
+00029380: 6d6f 6e6f 746f 6e69 6329 0a20 2020 2020  monotonic).     
+00029390: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000293a0: 2020 2020 2069 6620 6d65 7461 2069 7320       if meta is 
+000293b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000293c0: 2020 6d65 7461 203d 2065 7870 722e 5f65    meta = expr._e
+000293d0: 6d75 6c61 7465 284d 2e6d 6170 2c20 7365  mulate(M.map, se
+000293e0: 6c66 2c20 6172 672c 206e 615f 6163 7469  lf, arg, na_acti
+000293f0: 6f6e 3d6e 615f 6163 7469 6f6e 2c20 7564  on=na_action, ud
+00029400: 663d 5472 7565 290a 2020 2020 2020 2020  f=True).        
+00029410: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00029420: 6e28 6d65 7461 5f77 6172 6e69 6e67 286d  n(meta_warning(m
+00029430: 6574 6129 290a 2020 2020 2020 2020 7265  eta)).        re
+00029440: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00029450: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00029460: 2065 7870 722e 4d61 7028 0a20 2020 2020   expr.Map(.     
+00029470: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00029480: 2061 7267 3d61 7267 2c20 6e61 5f61 6374   arg=arg, na_act
+00029490: 696f 6e3d 6e61 5f61 6374 696f 6e2c 206d  ion=na_action, m
+000294a0: 6574 613d 6d65 7461 2c20 6973 5f6d 6f6e  eta=meta, is_mon
+000294b0: 6f74 6f6e 6963 3d69 735f 6d6f 6e6f 746f  otonic=is_monoto
+000294c0: 6e69 630a 2020 2020 2020 2020 2020 2020  nic.            
+000294d0: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
+000294e0: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
+000294f0: 6629 3a0a 2020 2020 2020 2020 6f20 3d20  f):.        o = 
+00029500: 7365 7428 6469 7228 7479 7065 2873 656c  set(dir(type(sel
+00029510: 6629 2929 0a20 2020 2020 2020 206f 2e75  f))).        o.u
+00029520: 7064 6174 6528 7365 6c66 2e5f 5f64 6963  pdate(self.__dic
+00029530: 745f 5f29 0a20 2020 2020 2020 206f 2e75  t__).        o.u
+00029540: 7064 6174 6528 7365 7428 6469 7228 6578  pdate(set(dir(ex
+00029550: 7072 2e45 7870 7229 2929 0a20 2020 2020  pr.Expr))).     
+00029560: 2020 206f 2e75 7064 6174 6528 7365 6c66     o.update(self
+00029570: 2e5f 6474 5f61 7474 7269 6275 7465 7329  ._dt_attributes)
+00029580: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00029590: 7374 616e 6365 2873 656c 662e 6474 7970  stance(self.dtyp
+000295a0: 652c 2070 642e 4361 7465 676f 7269 6361  e, pd.Categorica
+000295b0: 6c44 7479 7065 293a 0a20 2020 2020 2020  lDtype):.       
+000295c0: 2020 2020 206f 2e75 7064 6174 6528 7365       o.update(se
+000295d0: 6c66 2e5f 6361 745f 6174 7472 6962 7574  lf._cat_attribut
+000295e0: 6573 290a 2020 2020 2020 2020 7265 7475  es).        retu
+000295f0: 726e 206c 6973 7428 6f29 0a0a 2020 2020  rn list(o)..    
+00029600: 2320 4d65 7468 6f64 7320 616e 6420 7072  # Methods and pr
+00029610: 6f70 6572 7469 6573 206f 6620 5365 7269  operties of Seri
+00029620: 6573 2074 6861 7420 6172 6520 6e6f 7420  es that are not 
+00029630: 696d 706c 656d 656e 7465 6420 6f6e 2049  implemented on I
+00029640: 6e64 6578 0a0a 2020 2020 6465 6620 636f  ndex..    def co
+00029650: 756e 7428 7365 6c66 2c20 7370 6c69 745f  unt(self, split_
+00029660: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
+00029670: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00029680: 5f63 6f6c 6c65 6374 696f 6e28 496e 6465  _collection(Inde
+00029690: 7843 6f75 6e74 2873 656c 662c 2073 706c  xCount(self, spl
+000296a0: 6974 5f65 7665 7279 2929 0a0a 2020 2020  it_every))..    
+000296b0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000296c0: 6620 696e 6465 7828 7365 6c66 293a 0a20  f index(self):. 
+000296d0: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+000296e0: 7269 6275 7465 4572 726f 7228 2227 496e  ributeError("'In
+000296f0: 6465 7827 206f 626a 6563 7420 6861 7320  dex' object has 
+00029700: 6e6f 2061 7474 7269 6275 7465 2027 696e  no attribute 'in
+00029710: 6465 7827 2229 0a0a 2020 2020 6465 6620  dex'")..    def 
+00029720: 7375 6d28 7365 6c66 2c20 2a61 7267 732c  sum(self, *args,
+00029730: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00029740: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
+00029750: 7574 6545 7272 6f72 2822 2749 6e64 6578  uteError("'Index
+00029760: 2720 6f62 6a65 6374 2068 6173 206e 6f20  ' object has no 
+00029770: 6174 7472 6962 7574 6520 2773 756d 2722  attribute 'sum'"
+00029780: 290a 0a20 2020 2064 6566 2070 726f 6428  )..    def prod(
+00029790: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+000297a0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+000297b0: 7261 6973 6520 4174 7472 6962 7574 6545  raise AttributeE
+000297c0: 7272 6f72 2822 2749 6e64 6578 2720 6f62  rror("'Index' ob
+000297d0: 6a65 6374 2068 6173 206e 6f20 6174 7472  ject has no attr
+000297e0: 6962 7574 6520 2770 726f 6427 2229 0a0a  ibute 'prod'")..
+000297f0: 2020 2020 6465 6620 6d65 616e 2873 656c      def mean(sel
+00029800: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00029810: 6773 293a 0a20 2020 2020 2020 2072 6169  gs):.        rai
+00029820: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
+00029830: 7228 2227 496e 6465 7827 206f 626a 6563  r("'Index' objec
+00029840: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
+00029850: 7465 2027 6d65 616e 2722 290a 0a20 2020  te 'mean'")..   
+00029860: 2064 6566 2073 7464 2873 656c 662c 202a   def std(self, *
+00029870: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00029880: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
+00029890: 7474 7269 6275 7465 4572 726f 7228 2227  ttributeError("'
+000298a0: 496e 6465 7827 206f 626a 6563 7420 6861  Index' object ha
+000298b0: 7320 6e6f 2061 7474 7269 6275 7465 2027  s no attribute '
+000298c0: 7374 6427 2229 0a0a 2020 2020 6465 6620  std'")..    def 
+000298d0: 7661 7228 7365 6c66 2c20 2a61 7267 732c  var(self, *args,
+000298e0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+000298f0: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
+00029900: 7574 6545 7272 6f72 2822 2749 6e64 6578  uteError("'Index
+00029910: 2720 6f62 6a65 6374 2068 6173 206e 6f20  ' object has no 
+00029920: 6174 7472 6962 7574 6520 2776 6172 2722  attribute 'var'"
+00029930: 290a 0a20 2020 2064 6566 2069 6478 6d61  )..    def idxma
+00029940: 7828 7365 6c66 2c20 2a61 7267 732c 202a  x(self, *args, *
+00029950: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
+00029960: 2020 7261 6973 6520 4174 7472 6962 7574    raise Attribut
+00029970: 6545 7272 6f72 2822 2749 6e64 6578 2720  eError("'Index' 
+00029980: 6f62 6a65 6374 2068 6173 206e 6f20 6174  object has no at
+00029990: 7472 6962 7574 6520 2769 6478 6d61 7827  tribute 'idxmax'
+000299a0: 2229 0a0a 2020 2020 6465 6620 6964 786d  ")..    def idxm
+000299b0: 696e 2873 656c 662c 202a 6172 6773 2c20  in(self, *args, 
+000299c0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+000299d0: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
+000299e0: 7465 4572 726f 7228 2227 496e 6465 7827  teError("'Index'
+000299f0: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
+00029a00: 7474 7269 6275 7465 2027 6964 786d 696e  ttribute 'idxmin
+00029a10: 2722 290a 0a0a 636c 6173 7320 5363 616c  '")...class Scal
+00029a20: 6172 2846 7261 6d65 4261 7365 293a 0a20  ar(FrameBase):. 
+00029a30: 2020 2022 2222 5363 616c 6172 2045 7870     """Scalar Exp
+00029a40: 7220 436f 6c6c 6563 7469 6f6e 2222 220a  r Collection""".
+00029a50: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
+00029a60: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00029a70: 2072 6574 7572 6e20 6622 3c64 6173 6b5f   return f"<dask_
+00029a80: 6578 7072 2e65 7870 722e 5363 616c 6172  expr.expr.Scalar
+00029a90: 3a20 6578 7072 3d7b 7365 6c66 2e65 7870  : expr={self.exp
+00029aa0: 727d 2c20 6474 7970 653d 7b73 656c 662e  r}, dtype={self.
+00029ab0: 6474 7970 657d 3e22 0a0a 2020 2020 6465  dtype}>"..    de
+00029ac0: 6620 5f5f 626f 6f6c 5f5f 2873 656c 6629  f __bool__(self)
+00029ad0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00029ae0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+00029af0: 2020 2020 2020 2066 2254 7279 696e 6720         f"Trying 
+00029b00: 746f 2063 6f6e 7665 7274 207b 7365 6c66  to convert {self
+00029b10: 7d20 746f 2061 2062 6f6f 6c65 616e 2076  } to a boolean v
+00029b20: 616c 7565 2e20 4265 6361 7573 6520 4461  alue. Because Da
+00029b30: 736b 206f 626a 6563 7473 2061 7265 2022  sk objects are "
+00029b40: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
+00029b50: 7a69 6c79 2065 7661 6c75 6174 6564 2c20  zily evaluated, 
+00029b60: 7468 6579 2063 616e 6e6f 7420 6265 2063  they cannot be c
+00029b70: 6f6e 7665 7274 6564 2074 6f20 6120 626f  onverted to a bo
+00029b80: 6f6c 6561 6e20 7661 6c75 6520 6f72 2075  olean value or u
+00029b90: 7365 6420 220a 2020 2020 2020 2020 2020  sed ".          
+00029ba0: 2020 2269 6e20 626f 6f6c 6561 6e20 636f    "in boolean co
+00029bb0: 6e64 6974 696f 6e73 206c 696b 6520 6966  nditions like if
+00029bc0: 2073 7461 7465 6d65 6e74 732e 2054 7279   statements. Try
+00029bd0: 2063 616c 6c69 6e67 202e 636f 6d70 7574   calling .comput
+00029be0: 6528 2920 746f 2022 0a20 2020 2020 2020  e() to ".       
+00029bf0: 2020 2020 2022 666f 7263 6520 636f 6d70       "force comp
+00029c00: 7574 6174 696f 6e20 7072 696f 7220 746f  utation prior to
+00029c10: 2063 6f6e 7665 7274 696e 6720 746f 2061   converting to a
+00029c20: 2062 6f6f 6c65 616e 2076 616c 7565 206f   boolean value o
+00029c30: 7220 7573 696e 6720 696e 2022 0a20 2020  r using in ".   
+00029c40: 2020 2020 2020 2020 2022 6120 636f 6e64           "a cond
+00029c50: 6974 696f 6e61 6c20 7374 6174 656d 656e  itional statemen
+00029c60: 742e 220a 2020 2020 2020 2020 290a 0a20  t.".        ).. 
+00029c70: 2020 2064 6566 205f 5f64 6173 6b5f 706f     def __dask_po
+00029c80: 7374 636f 6d70 7574 655f 5f28 7365 6c66  stcompute__(self
+00029c90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00029ca0: 6e20 6669 7273 742c 2028 290a 0a20 2020  n first, ()..   
+00029cb0: 2064 6566 2074 6f5f 7365 7269 6573 2873   def to_series(s
+00029cc0: 656c 662c 2069 6e64 6578 3d30 2920 2d3e  elf, index=0) ->
+00029cd0: 2053 6572 6965 733a 0a20 2020 2020 2020   Series:.       
+00029ce0: 2072 6574 7572 6e20 6e65 775f 636f 6c6c   return new_coll
+00029cf0: 6563 7469 6f6e 2865 7870 722e 5363 616c  ection(expr.Scal
+00029d00: 6172 546f 5365 7269 6573 2873 656c 662c  arToSeries(self,
+00029d10: 2069 6e64 6578 3d69 6e64 6578 2929 0a0a   index=index))..
+00029d20: 2020 2020 6465 6620 5f5f 6172 7261 795f      def __array_
+00029d30: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00029d40: 2023 2061 7272 6179 2069 6e74 6572 6661   # array interfa
+00029d50: 6365 2069 7320 7265 7175 6972 6564 2074  ce is required t
+00029d60: 6f20 7375 7070 6f72 7420 7061 6e64 6173  o support pandas
+00029d70: 2069 6e73 7461 6e63 6520 2b20 5363 616c   instance + Scal
+00029d80: 6172 0a20 2020 2020 2020 2023 204f 7468  ar.        # Oth
+00029d90: 6572 7769 7365 2c20 6162 6f76 6520 6f70  erwise, above op
+00029da0: 2072 6573 756c 7473 2069 6e20 7064 2e53   results in pd.S
+00029db0: 6572 6965 7320 6f66 2053 6361 6c61 7220  eries of Scalar 
+00029dc0: 286f 626a 6563 7420 6474 7970 6529 0a20  (object dtype). 
+00029dd0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
+00029de0: 2e61 7361 7272 6179 2873 656c 662e 636f  .asarray(self.co
+00029df0: 6d70 7574 6528 2929 0a0a 2020 2020 4070  mpute())..    @p
+00029e00: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00029e10: 6474 7970 6528 7365 6c66 293a 0a20 2020  dtype(self):.   
+00029e20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00029e30: 2e5f 6d65 7461 2e64 7479 7065 0a0a 0a64  ._meta.dtype...d
+00029e40: 6566 206e 6577 5f63 6f6c 6c65 6374 696f  ef new_collectio
+00029e50: 6e28 6578 7072 293a 0a20 2020 2022 2222  n(expr):.    """
+00029e60: 4372 6561 7465 206e 6577 2063 6f6c 6c65  Create new colle
+00029e70: 6374 696f 6e20 6672 6f6d 2061 6e20 6578  ction from an ex
+00029e80: 7072 2222 220a 2020 2020 6d65 7461 203d  pr""".    meta =
+00029e90: 2065 7870 722e 5f6d 6574 610a 2020 2020   expr._meta.    
+00029ea0: 6578 7072 2e5f 6e61 6d65 2020 2320 456e  expr._name  # En
+00029eb0: 7375 7265 2062 6163 6b65 6e64 2069 7320  sure backend is 
+00029ec0: 696d 706f 7274 6564 0a20 2020 2072 6574  imported.    ret
+00029ed0: 7572 6e20 6765 745f 636f 6c6c 6563 7469  urn get_collecti
+00029ee0: 6f6e 5f74 7970 6528 6d65 7461 2928 6578  on_type(meta)(ex
+00029ef0: 7072 290a 0a0a 6465 6620 6f70 7469 6d69  pr)...def optimi
+00029f00: 7a65 2863 6f6c 6c65 6374 696f 6e2c 2066  ze(collection, f
+00029f10: 7573 653d 5472 7565 293a 0a20 2020 2072  use=True):.    r
+00029f20: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00029f30: 7469 6f6e 2865 7870 722e 6f70 7469 6d69  tion(expr.optimi
+00029f40: 7a65 2863 6f6c 6c65 6374 696f 6e2e 6578  ze(collection.ex
+00029f50: 7072 2c20 6675 7365 3d66 7573 6529 290a  pr, fuse=fuse)).
+00029f60: 0a0a 6465 6620 6672 6f6d 5f70 616e 6461  ..def from_panda
+00029f70: 7328 6461 7461 2c20 6e70 6172 7469 7469  s(data, npartiti
+00029f80: 6f6e 733d 4e6f 6e65 2c20 736f 7274 3d54  ons=None, sort=T
+00029f90: 7275 652c 2063 6875 6e6b 7369 7a65 3d4e  rue, chunksize=N
+00029fa0: 6f6e 6529 3a0a 2020 2020 2222 220a 2020  one):.    """.  
+00029fb0: 2020 436f 6e73 7472 7563 7420 6120 4461    Construct a Da
+00029fc0: 736b 2044 6174 6146 7261 6d65 2066 726f  sk DataFrame fro
+00029fd0: 6d20 6120 5061 6e64 6173 2044 6174 6146  m a Pandas DataF
+00029fe0: 7261 6d65 0a0a 2020 2020 5468 6973 2073  rame..    This s
+00029ff0: 706c 6974 7320 616e 2069 6e2d 6d65 6d6f  plits an in-memo
+0002a000: 7279 2050 616e 6461 7320 6461 7461 6672  ry Pandas datafr
+0002a010: 616d 6520 696e 746f 2073 6576 6572 616c  ame into several
+0002a020: 2070 6172 7473 2061 6e64 2063 6f6e 7374   parts and const
+0002a030: 7275 6374 730a 2020 2020 6120 6461 736b  ructs.    a dask
+0002a040: 2e64 6174 6166 7261 6d65 2066 726f 6d20  .dataframe from 
+0002a050: 7468 6f73 6520 7061 7274 7320 6f6e 2077  those parts on w
+0002a060: 6869 6368 2044 6173 6b2e 6461 7461 6672  hich Dask.datafr
+0002a070: 616d 6520 6361 6e20 6f70 6572 6174 6520  ame can operate 
+0002a080: 696e 0a20 2020 2070 6172 616c 6c65 6c2e  in.    parallel.
+0002a090: 2020 4279 2064 6566 6175 6c74 2c20 7468    By default, th
+0002a0a0: 6520 696e 7075 7420 6461 7461 6672 616d  e input datafram
+0002a0b0: 6520 7769 6c6c 2062 6520 736f 7274 6564  e will be sorted
+0002a0c0: 2062 7920 7468 6520 696e 6465 7820 746f   by the index to
+0002a0d0: 0a20 2020 2070 726f 6475 6365 2063 6c65  .    produce cle
+0002a0e0: 616e 6c79 2d64 6976 6964 6564 2070 6172  anly-divided par
+0002a0f0: 7469 7469 6f6e 7320 2877 6974 6820 6b6e  titions (with kn
+0002a100: 6f77 6e20 6469 7669 7369 6f6e 7329 2e20  own divisions). 
+0002a110: 2054 6f20 7072 6573 6572 7665 2074 6865   To preserve the
+0002a120: 0a20 2020 2069 6e70 7574 206f 7264 6572  .    input order
+0002a130: 696e 672c 206d 616b 6520 7375 7265 2074  ing, make sure t
+0002a140: 6865 2069 6e70 7574 2069 6e64 6578 2069  he input index i
+0002a150: 7320 6d6f 6e6f 746f 6e69 6361 6c6c 792d  s monotonically-
+0002a160: 696e 6372 6561 7369 6e67 2e20 5468 650a  increasing. The.
+0002a170: 2020 2020 6060 736f 7274 3d46 616c 7365      ``sort=False
+0002a180: 6060 206f 7074 696f 6e20 7769 6c6c 2061  `` option will a
+0002a190: 6c73 6f20 6176 6f69 6420 7265 6f72 6465  lso avoid reorde
+0002a1a0: 7269 6e67 2c20 6275 7420 7769 6c6c 206e  ring, but will n
+0002a1b0: 6f74 2072 6573 756c 7420 696e 0a20 2020  ot result in.   
+0002a1c0: 206b 6e6f 776e 2064 6976 6973 696f 6e73   known divisions
+0002a1d0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0002a1e0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0002a1f0: 0a20 2020 2064 6174 6120 3a20 7061 6e64  .    data : pand
+0002a200: 6173 2e44 6174 6146 7261 6d65 206f 7220  as.DataFrame or 
+0002a210: 7061 6e64 6173 2e53 6572 6965 730a 2020  pandas.Series.  
+0002a220: 2020 2020 2020 5468 6520 4461 7461 4672        The DataFr
+0002a230: 616d 652f 5365 7269 6573 2077 6974 6820  ame/Series with 
+0002a240: 7768 6963 6820 746f 2063 6f6e 7374 7275  which to constru
+0002a250: 6374 2061 2044 6173 6b20 4461 7461 4672  ct a Dask DataFr
+0002a260: 616d 652f 5365 7269 6573 0a20 2020 206e  ame/Series.    n
+0002a270: 7061 7274 6974 696f 6e73 203a 2069 6e74  partitions : int
+0002a280: 2c20 6f70 7469 6f6e 616c 2c20 6465 6661  , optional, defa
+0002a290: 756c 7420 310a 2020 2020 2020 2020 5468  ult 1.        Th
+0002a2a0: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
+0002a2b0: 6974 696f 6e73 206f 6620 7468 6520 696e  itions of the in
+0002a2c0: 6465 7820 746f 2063 7265 6174 652e 204e  dex to create. N
+0002a2d0: 6f74 6520 7468 6174 2069 6620 7468 6572  ote that if ther
+0002a2e0: 650a 2020 2020 2020 2020 6172 6520 6475  e.        are du
+0002a2f0: 706c 6963 6174 6520 7661 6c75 6573 206f  plicate values o
+0002a300: 7220 696e 7375 6666 6963 6965 6e74 2065  r insufficient e
+0002a310: 6c65 6d65 6e74 7320 696e 2060 6064 6174  lements in ``dat
+0002a320: 612e 696e 6465 7860 602c 2074 6865 0a20  a.index``, the. 
+0002a330: 2020 2020 2020 206f 7574 7075 7420 6d61         output ma
+0002a340: 7920 6861 7665 2066 6577 6572 2070 6172  y have fewer par
+0002a350: 7469 7469 6f6e 7320 7468 616e 2072 6571  titions than req
+0002a360: 7565 7374 6564 2e0a 2020 2020 6368 756e  uested..    chun
+0002a370: 6b73 697a 6520 3a20 696e 742c 206f 7074  ksize : int, opt
+0002a380: 696f 6e61 6c0a 2020 2020 2020 2020 5468  ional.        Th
+0002a390: 6520 6465 7369 7265 6420 6e75 6d62 6572  e desired number
+0002a3a0: 206f 6620 726f 7773 2070 6572 2069 6e64   of rows per ind
+0002a3b0: 6578 2070 6172 7469 7469 6f6e 2074 6f20  ex partition to 
+0002a3c0: 7573 652e 204e 6f74 6520 7468 6174 0a20  use. Note that. 
+0002a3d0: 2020 2020 2020 2064 6570 656e 6469 6e67         depending
+0002a3e0: 206f 6e20 7468 6520 7369 7a65 2061 6e64   on the size and
+0002a3f0: 2069 6e64 6578 206f 6620 7468 6520 6461   index of the da
+0002a400: 7461 6672 616d 652c 2061 6374 7561 6c20  taframe, actual 
+0002a410: 7061 7274 6974 696f 6e0a 2020 2020 2020  partition.      
+0002a420: 2020 7369 7a65 7320 6d61 7920 7661 7279    sizes may vary
+0002a430: 2e0a 2020 2020 736f 7274 3a20 626f 6f6c  ..    sort: bool
+0002a440: 0a20 2020 2020 2020 2053 6f72 7420 7468  .        Sort th
+0002a450: 6520 696e 7075 7420 6279 2069 6e64 6578  e input by index
+0002a460: 2066 6972 7374 2074 6f20 6f62 7461 696e   first to obtain
+0002a470: 2063 6c65 616e 6c79 2064 6976 6964 6564   cleanly divided
+0002a480: 2070 6172 7469 7469 6f6e 730a 2020 2020   partitions.    
+0002a490: 2020 2020 2877 6974 6820 6b6e 6f77 6e20      (with known 
+0002a4a0: 6469 7669 7369 6f6e 7329 2e20 2049 6620  divisions).  If 
+0002a4b0: 4661 6c73 652c 2074 6865 2069 6e70 7574  False, the input
+0002a4c0: 2077 696c 6c20 6e6f 7420 6265 2073 6f72   will not be sor
+0002a4d0: 7465 642c 2061 6e64 0a20 2020 2020 2020  ted, and.       
+0002a4e0: 2061 6c6c 2064 6976 6973 696f 6e73 2077   all divisions w
+0002a4f0: 696c 6c20 6265 2073 6574 2074 6f20 4e6f  ill be set to No
+0002a500: 6e65 2e20 4465 6661 756c 7420 6973 2054  ne. Default is T
+0002a510: 7275 652e 0a20 2020 206e 616d 653a 2073  rue..    name: s
+0002a520: 7472 696e 672c 206f 7074 696f 6e61 6c0a  tring, optional.
+0002a530: 2020 2020 2020 2020 416e 206f 7074 696f          An optio
+0002a540: 6e61 6c20 6b65 796e 616d 6520 666f 7220  nal keyname for 
+0002a550: 7468 6520 6461 7461 6672 616d 652e 2020  the dataframe.  
+0002a560: 4465 6661 756c 7473 2074 6f20 6861 7368  Defaults to hash
+0002a570: 696e 6720 7468 6520 696e 7075 740a 0a20  ing the input.. 
+0002a580: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+0002a590: 2d2d 2d2d 2d2d 0a20 2020 2064 6173 6b2e  ------.    dask.
+0002a5a0: 4461 7461 4672 616d 6520 6f72 2064 6173  DataFrame or das
+0002a5b0: 6b2e 5365 7269 6573 0a20 2020 2020 2020  k.Series.       
+0002a5c0: 2041 2064 6173 6b20 4461 7461 4672 616d   A dask DataFram
+0002a5d0: 652f 5365 7269 6573 2070 6172 7469 7469  e/Series partiti
+0002a5e0: 6f6e 6564 2061 6c6f 6e67 2074 6865 2069  oned along the i
+0002a5f0: 6e64 6578 0a0a 2020 2020 4578 616d 706c  ndex..    Exampl
+0002a600: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+0002a610: 2020 2020 3e3e 3e20 6672 6f6d 2064 6173      >>> from das
+0002a620: 6b2e 6461 7461 6672 616d 6520 696d 706f  k.dataframe impo
+0002a630: 7274 2066 726f 6d5f 7061 6e64 6173 0a20  rt from_pandas. 
+0002a640: 2020 203e 3e3e 2064 6620 3d20 7064 2e44     >>> df = pd.D
+0002a650: 6174 6146 7261 6d65 2864 6963 7428 613d  ataFrame(dict(a=
+0002a660: 6c69 7374 2827 6161 6262 6363 2729 2c20  list('aabbcc'), 
+0002a670: 623d 6c69 7374 2872 616e 6765 2836 2929  b=list(range(6))
+0002a680: 292c 0a20 2020 202e 2e2e 2020 2020 2020  ),.    ...      
+0002a690: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+0002a6a0: 6578 3d70 642e 6461 7465 5f72 616e 6765  ex=pd.date_range
+0002a6b0: 2873 7461 7274 3d27 3230 3130 3031 3031  (start='20100101
+0002a6c0: 272c 2070 6572 696f 6473 3d36 2929 0a20  ', periods=6)). 
+0002a6d0: 2020 203e 3e3e 2064 6466 203d 2066 726f     >>> ddf = fro
+0002a6e0: 6d5f 7061 6e64 6173 2864 662c 206e 7061  m_pandas(df, npa
+0002a6f0: 7274 6974 696f 6e73 3d33 290a 2020 2020  rtitions=3).    
+0002a700: 3e3e 3e20 6464 662e 6469 7669 7369 6f6e  >>> ddf.division
+0002a710: 7320 2023 2064 6f63 7465 7374 3a20 2b4e  s  # doctest: +N
+0002a720: 4f52 4d41 4c49 5a45 5f57 4849 5445 5350  ORMALIZE_WHITESP
+0002a730: 4143 450a 2020 2020 2854 696d 6573 7461  ACE.    (Timesta
+0002a740: 6d70 2827 3230 3130 2d30 312d 3031 2030  mp('2010-01-01 0
+0002a750: 303a 3030 3a30 3027 2c20 6672 6571 3d27  0:00:00', freq='
+0002a760: 4427 292c 0a20 2020 2020 5469 6d65 7374  D'),.     Timest
+0002a770: 616d 7028 2732 3031 302d 3031 2d30 3320  amp('2010-01-03 
+0002a780: 3030 3a30 303a 3030 272c 2066 7265 713d  00:00:00', freq=
+0002a790: 2744 2729 2c0a 2020 2020 2054 696d 6573  'D'),.     Times
+0002a7a0: 7461 6d70 2827 3230 3130 2d30 312d 3035  tamp('2010-01-05
+0002a7b0: 2030 303a 3030 3a30 3027 2c20 6672 6571   00:00:00', freq
+0002a7c0: 3d27 4427 292c 0a20 2020 2020 5469 6d65  ='D'),.     Time
+0002a7d0: 7374 616d 7028 2732 3031 302d 3031 2d30  stamp('2010-01-0
+0002a7e0: 3620 3030 3a30 303a 3030 272c 2066 7265  6 00:00:00', fre
+0002a7f0: 713d 2744 2729 290a 2020 2020 3e3e 3e20  q='D')).    >>> 
+0002a800: 6464 6620 3d20 6672 6f6d 5f70 616e 6461  ddf = from_panda
+0002a810: 7328 6466 2e61 2c20 6e70 6172 7469 7469  s(df.a, npartiti
+0002a820: 6f6e 733d 3329 2020 2320 576f 726b 7320  ons=3)  # Works 
+0002a830: 7769 7468 2053 6572 6965 7320 746f 6f21  with Series too!
+0002a840: 0a20 2020 203e 3e3e 2064 6466 2e64 6976  .    >>> ddf.div
+0002a850: 6973 696f 6e73 2020 2320 646f 6374 6573  isions  # doctes
+0002a860: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
+0002a870: 4954 4553 5041 4345 0a20 2020 2028 5469  ITESPACE.    (Ti
+0002a880: 6d65 7374 616d 7028 2732 3031 302d 3031  mestamp('2010-01
+0002a890: 2d30 3120 3030 3a30 303a 3030 272c 2066  -01 00:00:00', f
+0002a8a0: 7265 713d 2744 2729 2c0a 2020 2020 2054  req='D'),.     T
+0002a8b0: 696d 6573 7461 6d70 2827 3230 3130 2d30  imestamp('2010-0
+0002a8c0: 312d 3033 2030 303a 3030 3a30 3027 2c20  1-03 00:00:00', 
+0002a8d0: 6672 6571 3d27 4427 292c 0a20 2020 2020  freq='D'),.     
+0002a8e0: 5469 6d65 7374 616d 7028 2732 3031 302d  Timestamp('2010-
+0002a8f0: 3031 2d30 3520 3030 3a30 303a 3030 272c  01-05 00:00:00',
+0002a900: 2066 7265 713d 2744 2729 2c0a 2020 2020   freq='D'),.    
+0002a910: 2054 696d 6573 7461 6d70 2827 3230 3130   Timestamp('2010
+0002a920: 2d30 312d 3036 2030 303a 3030 3a30 3027  -01-06 00:00:00'
+0002a930: 2c20 6672 6571 3d27 4427 2929 0a0a 2020  , freq='D'))..  
+0002a940: 2020 5261 6973 6573 0a20 2020 202d 2d2d    Raises.    ---
+0002a950: 2d2d 2d0a 2020 2020 5479 7065 4572 726f  ---.    TypeErro
+0002a960: 720a 2020 2020 2020 2020 4966 2073 6f6d  r.        If som
+0002a970: 6574 6869 6e67 206f 7468 6572 2074 6861  ething other tha
+0002a980: 6e20 6120 6060 7061 6e64 6173 2e44 6174  n a ``pandas.Dat
+0002a990: 6146 7261 6d65 6060 206f 7220 6060 7061  aFrame`` or ``pa
+0002a9a0: 6e64 6173 2e53 6572 6965 7360 6020 6973  ndas.Series`` is
+0002a9b0: 0a20 2020 2020 2020 2070 6173 7365 6420  .        passed 
+0002a9c0: 696e 2e0a 0a20 2020 2053 6565 2041 6c73  in...    See Als
+0002a9d0: 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  o.    --------. 
+0002a9e0: 2020 2066 726f 6d5f 6172 7261 7920 3a20     from_array : 
+0002a9f0: 436f 6e73 7472 7563 7420 6120 6461 736b  Construct a dask
+0002aa00: 2e44 6174 6146 7261 6d65 2066 726f 6d20  .DataFrame from 
+0002aa10: 616e 2061 7272 6179 2074 6861 7420 6861  an array that ha
+0002aa20: 7320 7265 636f 7264 2064 7479 7065 0a20  s record dtype. 
+0002aa30: 2020 2072 6561 645f 6373 7620 3a20 436f     read_csv : Co
+0002aa40: 6e73 7472 7563 7420 6120 6461 736b 2e44  nstruct a dask.D
+0002aa50: 6174 6146 7261 6d65 2066 726f 6d20 6120  ataFrame from a 
+0002aa60: 4353 5620 6669 6c65 0a20 2020 2022 2222  CSV file.    """
+0002aa70: 0a20 2020 2069 6620 6368 756e 6b73 697a  .    if chunksiz
+0002aa80: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
+0002aa90: 6420 6e70 6172 7469 7469 6f6e 7320 6973  d npartitions is
+0002aaa0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0002aab0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002aac0: 726f 7228 2245 7861 6374 6c79 206f 6e65  ror("Exactly one
+0002aad0: 206f 6620 6e70 6172 7469 7469 6f6e 7320   of npartitions 
+0002aae0: 616e 6420 6368 756e 6b73 697a 6520 6d75  and chunksize mu
+0002aaf0: 7374 2062 6520 7370 6563 6966 6965 642e  st be specified.
+0002ab00: 2229 0a20 2020 2065 6c69 6620 6368 756e  ").    elif chun
+0002ab10: 6b73 697a 6520 6973 204e 6f6e 6520 616e  ksize is None an
+0002ab20: 6420 6e70 6172 7469 7469 6f6e 7320 6973  d npartitions is
+0002ab30: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
+0002ab40: 7061 7274 6974 696f 6e73 203d 2031 0a0a  partitions = 1..
+0002ab50: 2020 2020 6966 206e 6f74 2068 6173 5f70      if not has_p
+0002ab60: 6172 616c 6c65 6c5f 7479 7065 2864 6174  arallel_type(dat
+0002ab70: 6129 3a0a 2020 2020 2020 2020 7261 6973  a):.        rais
+0002ab80: 6520 5479 7065 4572 726f 7228 2249 6e70  e TypeError("Inp
+0002ab90: 7574 206d 7573 7420 6265 2061 2070 616e  ut must be a pan
+0002aba0: 6461 7320 4461 7461 4672 616d 6520 6f72  das DataFrame or
+0002abb0: 2053 6572 6965 732e 2229 0a0a 2020 2020   Series.")..    
+0002abc0: 6966 2064 6174 612e 696e 6465 782e 6973  if data.index.is
+0002abd0: 6e61 2829 2e61 6e79 2829 2061 6e64 206e  na().any() and n
+0002abe0: 6f74 205f 6973 5f61 6e79 5f72 6561 6c5f  ot _is_any_real_
+0002abf0: 6e75 6d65 7269 635f 6474 7970 6528 6461  numeric_dtype(da
+0002ac00: 7461 2e69 6e64 6578 293a 0a20 2020 2020  ta.index):.     
+0002ac10: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0002ac20: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+0002ac30: 2020 2020 2020 2020 2020 2249 6e64 6578            "Index
+0002ac40: 2069 6e20 7061 7373 6564 2064 6174 6120   in passed data 
+0002ac50: 6973 206e 6f6e 2d6e 756d 6572 6963 2061  is non-numeric a
+0002ac60: 6e64 2063 6f6e 7461 696e 7320 6e75 6c6c  nd contains null
+0002ac70: 732c 2077 6869 6368 2044 6173 6b20 646f  s, which Dask do
+0002ac80: 6573 206e 6f74 2065 6e74 6972 656c 7920  es not entirely 
+0002ac90: 7375 7070 6f72 742e 5c6e 220a 2020 2020  support.\n".    
+0002aca0: 2020 2020 2020 2020 2243 6f6e 7369 6465          "Conside
+0002acb0: 7220 7061 7373 696e 6720 6064 6174 612e  r passing `data.
+0002acc0: 6c6f 635b 7e64 6174 612e 6973 6e61 2829  loc[~data.isna()
+0002acd0: 5d60 2069 6e73 7465 6164 2e22 0a20 2020  ]` instead.".   
+0002ace0: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
+0002acf0: 7061 7274 6974 696f 6e73 2069 7320 6e6f  partitions is no
+0002ad00: 7420 4e6f 6e65 2061 6e64 206e 6f74 2069  t None and not i
+0002ad10: 7369 6e73 7461 6e63 6528 6e70 6172 7469  sinstance(nparti
+0002ad20: 7469 6f6e 732c 2069 6e74 293a 0a20 2020  tions, int):.   
+0002ad30: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0002ad40: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002ad50: 2020 2250 6c65 6173 6520 7072 6f76 6964    "Please provid
+0002ad60: 6520 6e70 6172 7469 7469 6f6e 7320 6173  e npartitions as
+0002ad70: 2061 6e20 696e 742c 206f 7220 706f 7373   an int, or poss
+0002ad80: 6962 6c79 2061 7320 4e6f 6e65 2069 6620  ibly as None if 
+0002ad90: 796f 7520 7370 6563 6966 7920 6368 756e  you specify chun
+0002ada0: 6b73 697a 652e 220a 2020 2020 2020 2020  ksize.".        
+0002adb0: 290a 2020 2020 656c 6966 2063 6875 6e6b  ).    elif chunk
+0002adc0: 7369 7a65 2069 7320 6e6f 7420 4e6f 6e65  size is not None
+0002add0: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
+0002ade0: 6e63 6528 6368 756e 6b73 697a 652c 2069  nce(chunksize, i
+0002adf0: 6e74 293a 0a20 2020 2020 2020 2072 6169  nt):.        rai
+0002ae00: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+0002ae10: 2020 2020 2020 2020 2020 2250 6c65 6173            "Pleas
+0002ae20: 6520 7072 6f76 6964 6520 6368 756e 6b73  e provide chunks
+0002ae30: 697a 6520 6173 2061 6e20 696e 742c 206f  ize as an int, o
+0002ae40: 7220 706f 7373 6962 6c79 2061 7320 4e6f  r possibly as No
+0002ae50: 6e65 2069 6620 796f 7520 7370 6563 6966  ne if you specif
+0002ae60: 7920 6e70 6172 7469 7469 6f6e 732e 220a  y npartitions.".
+0002ae70: 2020 2020 2020 2020 290a 0a20 2020 2066          )..    f
+0002ae80: 726f 6d20 6461 736b 5f65 7870 722e 696f  rom dask_expr.io
+0002ae90: 2e69 6f20 696d 706f 7274 2046 726f 6d50  .io import FromP
+0002aea0: 616e 6461 730a 0a20 2020 2072 6574 7572  andas..    retur
+0002aeb0: 6e20 6e65 775f 636f 6c6c 6563 7469 6f6e  n new_collection
+0002aec0: 280a 2020 2020 2020 2020 4672 6f6d 5061  (.        FromPa
+0002aed0: 6e64 6173 280a 2020 2020 2020 2020 2020  ndas(.          
+0002aee0: 2020 5f42 6163 6b65 6e64 4461 7461 2864    _BackendData(d
+0002aef0: 6174 612e 636f 7079 2829 292c 0a20 2020  ata.copy()),.   
+0002af00: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
+0002af10: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
+0002af20: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+0002af30: 7274 3d73 6f72 742c 0a20 2020 2020 2020  rt=sort,.       
+0002af40: 2020 2020 2063 6875 6e6b 7369 7a65 3d63       chunksize=c
+0002af50: 6875 6e6b 7369 7a65 2c0a 2020 2020 2020  hunksize,.      
+0002af60: 2020 2020 2020 7079 6172 726f 775f 7374        pyarrow_st
+0002af70: 7269 6e67 735f 656e 6162 6c65 643d 7079  rings_enabled=py
+0002af80: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
+0002af90: 6162 6c65 6428 292c 0a20 2020 2020 2020  abled(),.       
+0002afa0: 2029 0a20 2020 2029 0a0a 0a64 6566 2066   ).    )...def f
+0002afb0: 726f 6d5f 6172 7261 7928 6172 722c 2063  rom_array(arr, c
+0002afc0: 6875 6e6b 7369 7a65 3d35 305f 3030 302c  hunksize=50_000,
+0002afd0: 2063 6f6c 756d 6e73 3d4e 6f6e 652c 206d   columns=None, m
+0002afe0: 6574 613d 4e6f 6e65 293a 0a20 2020 2022  eta=None):.    "
+0002aff0: 2222 5265 6164 2061 6e79 2073 6c69 6365  ""Read any slice
+0002b000: 6162 6c65 2061 7272 6179 2069 6e74 6f20  able array into 
+0002b010: 6120 4461 736b 2044 6174 6166 7261 6d65  a Dask Dataframe
+0002b020: 0a0a 2020 2020 5573 6573 2067 6574 6974  ..    Uses getit
+0002b030: 656d 2073 796e 7461 7820 746f 2070 756c  em syntax to pul
+0002b040: 6c20 736c 6963 6573 206f 7574 206f 6620  l slices out of 
+0002b050: 7468 6520 6172 7261 792e 2020 5468 6520  the array.  The 
+0002b060: 6172 7261 7920 6e65 6564 206e 6f74 2062  array need not b
+0002b070: 650a 2020 2020 6120 4e75 6d50 7920 6172  e.    a NumPy ar
+0002b080: 7261 7920 6275 7420 6d75 7374 2073 7570  ray but must sup
+0002b090: 706f 7274 2073 6c69 6369 6e67 2073 796e  port slicing syn
+0002b0a0: 7461 780a 0a20 2020 2020 2020 2078 5b35  tax..        x[5
+0002b0b0: 3030 3030 3a31 3030 3030 305d 0a0a 2020  0000:100000]..  
+0002b0c0: 2020 616e 6420 6861 7665 2032 2064 696d    and have 2 dim
+0002b0d0: 656e 7369 6f6e 733a 0a0a 2020 2020 2020  ensions:..      
+0002b0e0: 2020 782e 6e64 696d 203d 3d20 320a 0a20    x.ndim == 2.. 
+0002b0f0: 2020 206f 7220 6861 7665 2061 2072 6563     or have a rec
+0002b100: 6f72 6420 6474 7970 653a 0a0a 2020 2020  ord dtype:..    
+0002b110: 2020 2020 782e 6474 7970 6520 3d3d 205b      x.dtype == [
+0002b120: 2827 6e61 6d65 272c 2027 4f27 292c 2028  ('name', 'O'), (
+0002b130: 2762 616c 616e 6365 272c 2027 6938 2729  'balance', 'i8')
+0002b140: 5d0a 0a20 2020 2050 6172 616d 6574 6572  ]..    Parameter
+0002b150: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0002b160: 0a20 2020 2078 203a 2061 7272 6179 5f6c  .    x : array_l
+0002b170: 696b 650a 2020 2020 6368 756e 6b73 697a  ike.    chunksiz
+0002b180: 6520 3a20 696e 742c 206f 7074 696f 6e61  e : int, optiona
+0002b190: 6c0a 2020 2020 2020 2020 5468 6520 6e75  l.        The nu
+0002b1a0: 6d62 6572 206f 6620 726f 7773 2070 6572  mber of rows per
+0002b1b0: 2070 6172 7469 7469 6f6e 2074 6f20 7573   partition to us
+0002b1c0: 652e 0a20 2020 2063 6f6c 756d 6e73 203a  e..    columns :
+0002b1d0: 206c 6973 7420 6f72 2073 7472 696e 672c   list or string,
+0002b1e0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002b1f0: 2020 6c69 7374 206f 6620 636f 6c75 6d6e    list of column
+0002b200: 206e 616d 6573 2069 6620 4461 7461 4672   names if DataFr
+0002b210: 616d 652c 2073 696e 676c 6520 7374 7269  ame, single stri
+0002b220: 6e67 2069 6620 5365 7269 6573 0a20 2020  ng if Series.   
+0002b230: 206d 6574 6120 3a20 6f62 6a65 6374 2c20   meta : object, 
+0002b240: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0002b250: 2041 6e20 6f70 7469 6f6e 616c 2060 6d65   An optional `me
+0002b260: 7461 6020 7061 7261 6d65 7465 7220 6361  ta` parameter ca
+0002b270: 6e20 6265 2070 6173 7365 6420 666f 7220  n be passed for 
+0002b280: 6461 736b 0a20 2020 2020 2020 2074 6f20  dask.        to 
+0002b290: 7370 6563 6966 7920 7468 6520 636f 6e63  specify the conc
+0002b2a0: 7265 7465 2064 6174 6166 7261 6d65 2074  rete dataframe t
+0002b2b0: 7970 6520 746f 2075 7365 2066 6f72 2070  ype to use for p
+0002b2c0: 6172 7469 7469 6f6e 7320 6f66 0a20 2020  artitions of.   
+0002b2d0: 2020 2020 2074 6865 2044 6173 6b20 6461       the Dask da
+0002b2e0: 7461 6672 616d 652e 2042 7920 6465 6661  taframe. By defa
+0002b2f0: 756c 742c 2070 616e 6461 7320 4461 7461  ult, pandas Data
+0002b300: 4672 616d 6520 6973 2075 7365 642e 0a0a  Frame is used...
+0002b310: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+0002b320: 2d2d 2d2d 2d2d 2d0a 2020 2020 6461 736b  -------.    dask
+0002b330: 2e44 6174 6146 7261 6d65 206f 7220 6461  .DataFrame or da
+0002b340: 736b 2e53 6572 6965 730a 2020 2020 2020  sk.Series.      
+0002b350: 2020 4120 6461 736b 2044 6174 6146 7261    A dask DataFra
+0002b360: 6d65 2f53 6572 6965 730a 2020 2020 2222  me/Series.    ""
+0002b370: 220a 2020 2020 696d 706f 7274 2064 6173  ".    import das
+0002b380: 6b2e 6172 7261 7920 6173 2064 610a 0a20  k.array as da.. 
+0002b390: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002b3a0: 2861 7272 2c20 6461 2e41 7272 6179 293a  (arr, da.Array):
+0002b3b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002b3c0: 6672 6f6d 5f64 6173 6b5f 6172 7261 7928  from_dask_array(
+0002b3d0: 6172 722c 2063 6f6c 756d 6e73 3d63 6f6c  arr, columns=col
+0002b3e0: 756d 6e73 2c20 6d65 7461 3d6d 6574 6129  umns, meta=meta)
+0002b3f0: 0a0a 2020 2020 6672 6f6d 2064 6173 6b5f  ..    from dask_
+0002b400: 6578 7072 2e69 6f2e 696f 2069 6d70 6f72  expr.io.io impor
+0002b410: 7420 4672 6f6d 4172 7261 790a 0a20 2020  t FromArray..   
+0002b420: 2072 6573 756c 7420 3d20 4672 6f6d 4172   result = FromAr
+0002b430: 7261 7928 0a20 2020 2020 2020 2061 7272  ray(.        arr
+0002b440: 2c0a 2020 2020 2020 2020 6368 756e 6b73  ,.        chunks
+0002b450: 697a 653d 6368 756e 6b73 697a 652c 0a20  ize=chunksize,. 
+0002b460: 2020 2020 2020 206f 7269 6769 6e61 6c5f         original_
+0002b470: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
+0002b480: 0a20 2020 2020 2020 206d 6574 613d 6d65  .        meta=me
+0002b490: 7461 2c0a 2020 2020 290a 2020 2020 6966  ta,.    ).    if
+0002b4a0: 2070 7961 7272 6f77 5f73 7472 696e 6773   pyarrow_strings
+0002b4b0: 5f65 6e61 626c 6564 2829 2061 6e64 2061  _enabled() and a
+0002b4c0: 7272 2e64 7479 7065 2e6b 696e 6420 696e  rr.dtype.kind in
+0002b4d0: 2022 4f55 223a 0a20 2020 2020 2020 2072   "OU":.        r
+0002b4e0: 6573 756c 7420 3d20 6578 7072 2e41 7272  esult = expr.Arr
+0002b4f0: 6f77 5374 7269 6e67 436f 6e76 6572 7369  owStringConversi
+0002b500: 6f6e 2872 6573 756c 7429 0a20 2020 2072  on(result).    r
+0002b510: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0002b520: 7469 6f6e 2872 6573 756c 7429 0a0a 0a64  tion(result)...d
+0002b530: 6566 2066 726f 6d5f 6772 6170 6828 2a61  ef from_graph(*a
+0002b540: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+0002b550: 2020 2020 6672 6f6d 2064 6173 6b5f 6578      from dask_ex
+0002b560: 7072 2e69 6f2e 696f 2069 6d70 6f72 7420  pr.io.io import 
+0002b570: 4672 6f6d 4772 6170 680a 0a20 2020 2072  FromGraph..    r
+0002b580: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+0002b590: 7469 6f6e 2846 726f 6d47 7261 7068 282a  tion(FromGraph(*
+0002b5a0: 6172 6773 2c20 2a2a 6b77 6172 6773 2929  args, **kwargs))
+0002b5b0: 0a0a 0a40 6461 7461 6672 616d 655f 6372  ...@dataframe_cr
+0002b5c0: 6561 7469 6f6e 5f64 6973 7061 7463 682e  eation_dispatch.
+0002b5d0: 7265 6769 7374 6572 5f69 6e70 6c61 6365  register_inplace
+0002b5e0: 2822 7061 6e64 6173 2229 0a64 6566 2066  ("pandas").def f
+0002b5f0: 726f 6d5f 6469 6374 280a 2020 2020 6461  rom_dict(.    da
+0002b600: 7461 2c0a 2020 2020 6e70 6172 7469 7469  ta,.    npartiti
+0002b610: 6f6e 732c 0a20 2020 206f 7269 656e 743d  ons,.    orient=
+0002b620: 2263 6f6c 756d 6e73 222c 0a20 2020 2064  "columns",.    d
+0002b630: 7479 7065 3d4e 6f6e 652c 0a20 2020 2063  type=None,.    c
+0002b640: 6f6c 756d 6e73 3d4e 6f6e 652c 0a20 2020  olumns=None,.   
+0002b650: 2063 6f6e 7374 7275 6374 6f72 3d70 642e   constructor=pd.
+0002b660: 4461 7461 4672 616d 652c 0a29 3a0a 2020  DataFrame,.):.  
+0002b670: 2020 2222 220a 2020 2020 436f 6e73 7472    """.    Constr
+0002b680: 7563 7420 6120 4461 736b 2044 6174 6146  uct a Dask DataF
+0002b690: 7261 6d65 2066 726f 6d20 6120 5079 7468  rame from a Pyth
+0002b6a0: 6f6e 2044 6963 7469 6f6e 6172 790a 0a20  on Dictionary.. 
+0002b6b0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0002b6c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0002b6d0: 2064 6174 6120 3a20 6469 6374 0a20 2020   data : dict.   
+0002b6e0: 2020 2020 204f 6620 7468 6520 666f 726d       Of the form
+0002b6f0: 207b 6669 656c 6420 3a20 6172 7261 792d   {field : array-
+0002b700: 6c69 6b65 7d20 6f72 207b 6669 656c 6420  like} or {field 
+0002b710: 3a20 6469 6374 7d2e 0a20 2020 206e 7061  : dict}..    npa
+0002b720: 7274 6974 696f 6e73 203a 2069 6e74 0a20  rtitions : int. 
+0002b730: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
+0002b740: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
+0002b750: 6f66 2074 6865 2069 6e64 6578 2074 6f20  of the index to 
+0002b760: 6372 6561 7465 2e20 4e6f 7465 2074 6861  create. Note tha
+0002b770: 7420 6465 7065 6e64 696e 6720 6f6e 0a20  t depending on. 
+0002b780: 2020 2020 2020 2074 6865 2073 697a 6520         the size 
+0002b790: 616e 6420 696e 6465 7820 6f66 2074 6865  and index of the
+0002b7a0: 2064 6174 6166 7261 6d65 2c20 7468 6520   dataframe, the 
+0002b7b0: 6f75 7470 7574 206d 6179 2068 6176 6520  output may have 
+0002b7c0: 6665 7765 720a 2020 2020 2020 2020 7061  fewer.        pa
+0002b7d0: 7274 6974 696f 6e73 2074 6861 6e20 7265  rtitions than re
+0002b7e0: 7175 6573 7465 642e 0a20 2020 206f 7269  quested..    ori
+0002b7f0: 656e 7420 3a20 7b27 636f 6c75 6d6e 7327  ent : {'columns'
+0002b800: 2c20 2769 6e64 6578 272c 2027 7469 6768  , 'index', 'tigh
+0002b810: 7427 7d2c 2064 6566 6175 6c74 2027 636f  t'}, default 'co
+0002b820: 6c75 6d6e 7327 0a20 2020 2020 2020 2054  lumns'.        T
+0002b830: 6865 2022 6f72 6965 6e74 6174 696f 6e22  he "orientation"
+0002b840: 206f 6620 7468 6520 6461 7461 2e20 4966   of the data. If
+0002b850: 2074 6865 206b 6579 7320 6f66 2074 6865   the keys of the
+0002b860: 2070 6173 7365 6420 6469 6374 0a20 2020   passed dict.   
+0002b870: 2020 2020 2073 686f 756c 6420 6265 2074       should be t
+0002b880: 6865 2063 6f6c 756d 6e73 206f 6620 7468  he columns of th
+0002b890: 6520 7265 7375 6c74 696e 6720 4461 7461  e resulting Data
+0002b8a0: 4672 616d 652c 2070 6173 7320 2763 6f6c  Frame, pass 'col
+0002b8b0: 756d 6e73 270a 2020 2020 2020 2020 2864  umns'.        (d
+0002b8c0: 6566 6175 6c74 292e 204f 7468 6572 7769  efault). Otherwi
+0002b8d0: 7365 2069 6620 7468 6520 6b65 7973 2073  se if the keys s
+0002b8e0: 686f 756c 6420 6265 2072 6f77 732c 2070  hould be rows, p
+0002b8f0: 6173 7320 2769 6e64 6578 272e 0a20 2020  ass 'index'..   
+0002b900: 2020 2020 2049 6620 2774 6967 6874 272c       If 'tight',
+0002b910: 2061 7373 756d 6520 6120 6469 6374 2077   assume a dict w
+0002b920: 6974 6820 6b65 7973 0a20 2020 2020 2020  ith keys.       
+0002b930: 205b 2769 6e64 6578 272c 2027 636f 6c75   ['index', 'colu
+0002b940: 6d6e 7327 2c20 2764 6174 6127 2c20 2769  mns', 'data', 'i
+0002b950: 6e64 6578 5f6e 616d 6573 272c 2027 636f  ndex_names', 'co
+0002b960: 6c75 6d6e 5f6e 616d 6573 275d 2e0a 2020  lumn_names']..  
+0002b970: 2020 6474 7970 653a 2062 6f6f 6c0a 2020    dtype: bool.  
+0002b980: 2020 2020 2020 4461 7461 2074 7970 6520        Data type 
+0002b990: 746f 2066 6f72 6365 2c20 6f74 6865 7277  to force, otherw
+0002b9a0: 6973 6520 696e 6665 722e 0a20 2020 2063  ise infer..    c
+0002b9b0: 6f6c 756d 6e73 3a20 7374 7269 6e67 2c20  olumns: string, 
+0002b9c0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0002b9d0: 2043 6f6c 756d 6e20 6c61 6265 6c73 2074   Column labels t
+0002b9e0: 6f20 7573 6520 7768 656e 2060 606f 7269  o use when ``ori
+0002b9f0: 656e 743d 2769 6e64 6578 2760 602e 2052  ent='index'``. R
+0002ba00: 6169 7365 7320 6120 5661 6c75 6545 7272  aises a ValueErr
+0002ba10: 6f72 0a20 2020 2020 2020 2069 6620 7573  or.        if us
+0002ba20: 6564 2077 6974 6820 6060 6f72 6965 6e74  ed with ``orient
+0002ba30: 3d27 636f 6c75 6d6e 7327 6060 206f 7220  ='columns'`` or 
+0002ba40: 6060 6f72 6965 6e74 3d27 7469 6768 7427  ``orient='tight'
+0002ba50: 6060 2e0a 2020 2020 636f 6e73 7472 7563  ``..    construc
+0002ba60: 746f 723a 2063 6c61 7373 2c20 6465 6661  tor: class, defa
+0002ba70: 756c 7420 7064 2e44 6174 6146 7261 6d65  ult pd.DataFrame
+0002ba80: 0a20 2020 2020 2020 2043 6c61 7373 2077  .        Class w
+0002ba90: 6974 6820 7768 6963 6820 6060 6672 6f6d  ith which ``from
+0002baa0: 5f64 6963 7460 6020 7368 6f75 6c64 2062  _dict`` should b
+0002bab0: 6520 6361 6c6c 6564 2077 6974 682e 0a0a  e called with...
+0002bac0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0002bad0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
+0002bae0: 3e20 696d 706f 7274 2064 6173 6b2e 6461  > import dask.da
+0002baf0: 7461 6672 616d 6520 6173 2064 640a 2020  taframe as dd.  
+0002bb00: 2020 3e3e 3e20 6464 6620 3d20 6464 2e66    >>> ddf = dd.f
+0002bb10: 726f 6d5f 6469 6374 287b 226e 756d 3122  rom_dict({"num1"
+0002bb20: 3a20 5b31 2c20 322c 2033 2c20 345d 2c20  : [1, 2, 3, 4], 
+0002bb30: 226e 756d 3222 3a20 5b37 2c20 382c 2039  "num2": [7, 8, 9
+0002bb40: 2c20 3130 5d7d 2c20 6e70 6172 7469 7469  , 10]}, npartiti
+0002bb50: 6f6e 733d 3229 0a20 2020 2022 2222 0a0a  ons=2).    """..
+0002bb60: 2020 2020 636f 6c6c 6563 7469 6f6e 5f74      collection_t
+0002bb70: 7970 6573 203d 207b 7479 7065 2876 2920  ypes = {type(v) 
+0002bb80: 666f 7220 7620 696e 2064 6174 612e 7661  for v in data.va
+0002bb90: 6c75 6573 2829 2069 6620 6973 5f64 6173  lues() if is_das
+0002bba0: 6b5f 636f 6c6c 6563 7469 6f6e 2876 297d  k_collection(v)}
+0002bbb0: 0a20 2020 2069 6620 636f 6c6c 6563 7469  .    if collecti
+0002bbc0: 6f6e 5f74 7970 6573 3a0a 2020 2020 2020  on_types:.      
+0002bbd0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0002bbe0: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
+0002bbf0: 2020 2020 2020 2020 2022 6672 6f6d 5f64           "from_d
+0002bc00: 6963 7420 646f 6573 6e27 7420 6375 7272  ict doesn't curr
+0002bc10: 656e 746c 7920 7375 7070 6f72 7420 4461  ently support Da
+0002bc20: 736b 2063 6f6c 6c65 6374 696f 6e73 2061  sk collections a
+0002bc30: 7320 696e 7075 7473 2e20 220a 2020 2020  s inputs. ".    
+0002bc40: 2020 2020 2020 2020 6622 4f62 6a65 6374          f"Object
+0002bc50: 7320 6f66 2074 7970 6520 7b63 6f6c 6c65  s of type {colle
+0002bc60: 6374 696f 6e5f 7479 7065 737d 2077 6572  ction_types} wer
+0002bc70: 6520 6769 7665 6e20 696e 2074 6865 2069  e given in the i
+0002bc80: 6e70 7574 2064 6963 742e 220a 2020 2020  nput dict.".    
+0002bc90: 2020 2020 290a 0a20 2020 2072 6574 7572      )..    retur
+0002bca0: 6e20 6672 6f6d 5f70 616e 6461 7328 0a20  n from_pandas(. 
+0002bcb0: 2020 2020 2020 2063 6f6e 7374 7275 6374         construct
+0002bcc0: 6f72 2e66 726f 6d5f 6469 6374 2864 6174  or.from_dict(dat
+0002bcd0: 612c 206f 7269 656e 742c 2064 7479 7065  a, orient, dtype
+0002bce0: 2c20 636f 6c75 6d6e 7329 2c0a 2020 2020  , columns),.    
+0002bcf0: 2020 2020 6e70 6172 7469 7469 6f6e 732c      npartitions,
+0002bd00: 0a20 2020 2029 0a0a 0a64 6566 2066 726f  .    )...def fro
+0002bd10: 6d5f 6461 736b 5f64 6174 6166 7261 6d65  m_dask_dataframe
+0002bd20: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
+0002bd30: 2920 2d3e 2046 7261 6d65 4261 7365 3a0a  ) -> FrameBase:.
+0002bd40: 2020 2020 2222 2243 7265 6174 6520 6120      """Create a 
+0002bd50: 6461 736b 2d65 7870 7220 636f 6c6c 6563  dask-expr collec
+0002bd60: 7469 6f6e 2066 726f 6d20 6120 6c65 6761  tion from a lega
+0002bd70: 6379 2064 6173 6b2d 6461 7461 6672 616d  cy dask-datafram
+0002bd80: 6520 636f 6c6c 6563 7469 6f6e 0a0a 2020  e collection..  
+0002bd90: 2020 5741 524e 494e 473a 2054 6869 7320    WARNING: This 
+0002bda0: 4150 4920 6973 2064 6570 7265 6361 7465  API is deprecate
+0002bdb0: 642e 2050 6c65 6173 6520 7573 6520 6066  d. Please use `f
+0002bdc0: 726f 6d5f 6c65 6761 6379 5f64 6174 6166  rom_legacy_dataf
+0002bdd0: 7261 6d65 602e 0a0a 2020 2020 5061 7261  rame`...    Para
+0002bde0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+0002bdf0: 2d2d 2d2d 2d0a 2020 2020 6f70 7469 6d69  -----.    optimi
+0002be00: 7a65 0a20 2020 2020 2020 2057 6865 7468  ze.        Wheth
+0002be10: 6572 2074 6f20 6f70 7469 6d69 7a65 2074  er to optimize t
+0002be20: 6865 2067 7261 7068 2062 6566 6f72 6520  he graph before 
+0002be30: 636f 6e76 6572 7369 6f6e 2e0a 2020 2020  conversion..    
+0002be40: 2222 220a 2020 2020 7761 726e 696e 6773  """.    warnings
+0002be50: 2e77 6172 6e28 0a20 2020 2020 2020 2022  .warn(.        "
+0002be60: 6066 726f 6d5f 6461 736b 5f64 6174 6166  `from_dask_dataf
+0002be70: 7261 6d65 6020 6973 2064 6570 7265 6361  rame` is depreca
+0002be80: 7465 642c 2070 6c65 6173 6520 7573 6520  ted, please use 
+0002be90: 6066 726f 6d5f 6c65 6761 6379 5f64 6174  `from_legacy_dat
+0002bea0: 6166 7261 6d65 602e 222c 0a20 2020 2020  aframe`.",.     
+0002beb0: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
+0002bec0: 2c0a 2020 2020 290a 2020 2020 7265 7475  ,.    ).    retu
+0002bed0: 726e 2066 726f 6d5f 6c65 6761 6379 5f64  rn from_legacy_d
+0002bee0: 6174 6166 7261 6d65 282a 6172 6773 2c20  ataframe(*args, 
+0002bef0: 2a2a 6b77 6172 6773 290a 0a0a 6465 6620  **kwargs)...def 
+0002bf00: 6672 6f6d 5f6c 6567 6163 795f 6461 7461  from_legacy_data
+0002bf10: 6672 616d 6528 6464 663a 205f 4672 616d  frame(ddf: _Fram
+0002bf20: 652c 206f 7074 696d 697a 653a 2062 6f6f  e, optimize: boo
+0002bf30: 6c20 3d20 5472 7565 2920 2d3e 2046 7261  l = True) -> Fra
+0002bf40: 6d65 4261 7365 3a0a 2020 2020 2222 2243  meBase:.    """C
+0002bf50: 7265 6174 6520 6120 6461 736b 2d65 7870  reate a dask-exp
+0002bf60: 7220 636f 6c6c 6563 7469 6f6e 2066 726f  r collection fro
+0002bf70: 6d20 6120 6c65 6761 6379 2064 6173 6b2d  m a legacy dask-
+0002bf80: 6461 7461 6672 616d 6520 636f 6c6c 6563  dataframe collec
+0002bf90: 7469 6f6e 0a0a 2020 2020 5061 7261 6d65  tion..    Parame
+0002bfa0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+0002bfb0: 2d2d 2d0a 2020 2020 6f70 7469 6d69 7a65  ---.    optimize
+0002bfc0: 0a20 2020 2020 2020 2057 6865 7468 6572  .        Whether
+0002bfd0: 2074 6f20 6f70 7469 6d69 7a65 2074 6865   to optimize the
+0002bfe0: 2067 7261 7068 2062 6566 6f72 6520 636f   graph before co
+0002bff0: 6e76 6572 7369 6f6e 2e0a 2020 2020 2222  nversion..    ""
+0002c000: 220a 2020 2020 6772 6170 6820 3d20 6464  ".    graph = dd
+0002c010: 662e 6461 736b 0a20 2020 2069 6620 6f70  f.dask.    if op
+0002c020: 7469 6d69 7a65 3a0a 2020 2020 2020 2020  timize:.        
+0002c030: 6772 6170 6820 3d20 6464 662e 5f5f 6461  graph = ddf.__da
+0002c040: 736b 5f6f 7074 696d 697a 655f 5f28 6772  sk_optimize__(gr
+0002c050: 6170 682c 2064 6466 2e5f 5f64 6173 6b5f  aph, ddf.__dask_
+0002c060: 6b65 7973 5f5f 2829 290a 2020 2020 7265  keys__()).    re
+0002c070: 7475 726e 2066 726f 6d5f 6772 6170 6828  turn from_graph(
+0002c080: 0a20 2020 2020 2020 2067 7261 7068 2c20  .        graph, 
+0002c090: 6464 662e 5f6d 6574 612c 2064 6466 2e64  ddf._meta, ddf.d
+0002c0a0: 6976 6973 696f 6e73 2c20 6464 662e 5f5f  ivisions, ddf.__
+0002c0b0: 6461 736b 5f6b 6579 735f 5f28 292c 206b  dask_keys__(), k
+0002c0c0: 6579 5f73 706c 6974 2864 6466 2e5f 6e61  ey_split(ddf._na
+0002c0d0: 6d65 290a 2020 2020 290a 0a0a 6465 6620  me).    )...def 
+0002c0e0: 6672 6f6d 5f64 6173 6b5f 6172 7261 7928  from_dask_array(
+0002c0f0: 782c 2063 6f6c 756d 6e73 3d4e 6f6e 652c  x, columns=None,
+0002c100: 2069 6e64 6578 3d4e 6f6e 652c 206d 6574   index=None, met
+0002c110: 613d 4e6f 6e65 293a 0a20 2020 2022 2222  a=None):.    """
+0002c120: 4372 6561 7465 2061 2044 6173 6b20 4461  Create a Dask Da
+0002c130: 7461 4672 616d 6520 6672 6f6d 2061 2044  taFrame from a D
+0002c140: 6173 6b20 4172 7261 792e 0a0a 2020 2020  ask Array...    
+0002c150: 436f 6e76 6572 7473 2061 2032 6420 6172  Converts a 2d ar
+0002c160: 7261 7920 696e 746f 2061 2044 6174 6146  ray into a DataF
+0002c170: 7261 6d65 2061 6e64 2061 2031 6420 6172  rame and a 1d ar
+0002c180: 7261 7920 696e 746f 2061 2053 6572 6965  ray into a Serie
+0002c190: 732e 0a0a 2020 2020 5061 7261 6d65 7465  s...    Paramete
+0002c1a0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+0002c1b0: 2d0a 2020 2020 7820 3a20 6461 2e41 7272  -.    x : da.Arr
+0002c1c0: 6179 0a20 2020 2063 6f6c 756d 6e73 203a  ay.    columns :
+0002c1d0: 206c 6973 7420 6f72 2073 7472 696e 670a   list or string.
+0002c1e0: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
+0002c1f0: 636f 6c75 6d6e 206e 616d 6573 2069 6620  column names if 
+0002c200: 4461 7461 4672 616d 652c 2073 696e 676c  DataFrame, singl
+0002c210: 6520 7374 7269 6e67 2069 6620 5365 7269  e string if Seri
+0002c220: 6573 0a20 2020 2069 6e64 6578 203a 2064  es.    index : d
+0002c230: 6173 6b2e 6461 7461 6672 616d 652e 496e  ask.dataframe.In
+0002c240: 6465 782c 206f 7074 696f 6e61 6c0a 2020  dex, optional.  
+0002c250: 2020 2020 2020 416e 206f 7074 696f 6e61        An optiona
+0002c260: 6c20 2a64 6173 6b2a 2049 6e64 6578 2074  l *dask* Index t
+0002c270: 6f20 7573 6520 666f 7220 7468 6520 6f75  o use for the ou
+0002c280: 7470 7574 2053 6572 6965 7320 6f72 2044  tput Series or D
+0002c290: 6174 6146 7261 6d65 2e0a 0a20 2020 2020  ataFrame...     
+0002c2a0: 2020 2054 6865 2064 6566 6175 6c74 206f     The default o
+0002c2b0: 7574 7075 7420 696e 6465 7820 6465 7065  utput index depe
+0002c2c0: 6e64 7320 6f6e 2077 6865 7468 6572 2060  nds on whether `
+0002c2d0: 7860 2068 6173 2061 6e79 2075 6e6b 6e6f  x` has any unkno
+0002c2e0: 776e 0a20 2020 2020 2020 2063 6875 6e6b  wn.        chunk
+0002c2f0: 732e 2049 6620 7468 6572 6520 6172 6520  s. If there are 
+0002c300: 616e 7920 756e 6b6e 6f77 6e20 6368 756e  any unknown chun
+0002c310: 6b73 2c20 7468 6520 6f75 7470 7574 2068  ks, the output h
+0002c320: 6173 2060 604e 6f6e 6560 600a 2020 2020  as ``None``.    
+0002c330: 2020 2020 666f 7220 616c 6c20 7468 6520      for all the 
+0002c340: 6469 7669 7369 6f6e 7320 286f 6e65 2070  divisions (one p
+0002c350: 6572 2063 6875 6e6b 292e 2049 6620 616c  er chunk). If al
+0002c360: 6c20 7468 6520 6368 756e 6b73 2061 7265  l the chunks are
+0002c370: 206b 6e6f 776e 2c0a 2020 2020 2020 2020   known,.        
+0002c380: 6120 6465 6661 756c 7420 696e 6465 7820  a default index 
+0002c390: 7769 7468 206b 6e6f 776e 2064 6976 6973  with known divis
+0002c3a0: 696f 6e73 2069 7320 6372 6561 7465 642e  ions is created.
+0002c3b0: 0a0a 2020 2020 2020 2020 5370 6563 6966  ..        Specif
+0002c3c0: 7969 6e67 2060 696e 6465 7860 2063 616e  ying `index` can
+0002c3d0: 2062 6520 7573 6566 756c 2069 6620 796f   be useful if yo
+0002c3e0: 7527 7265 2063 6f6e 666f 726d 696e 6720  u're conforming 
+0002c3f0: 6120 4461 736b 2041 7272 6179 0a20 2020  a Dask Array.   
+0002c400: 2020 2020 2074 6f20 616e 2065 7869 7374       to an exist
+0002c410: 696e 6720 6461 736b 2053 6572 6965 7320  ing dask Series 
+0002c420: 6f72 2044 6174 6146 7261 6d65 2c20 616e  or DataFrame, an
+0002c430: 6420 796f 7520 776f 756c 6420 6c69 6b65  d you would like
+0002c440: 2074 6865 0a20 2020 2020 2020 2069 6e64   the.        ind
+0002c450: 6963 6573 2074 6f20 6d61 7463 682e 0a20  ices to match.. 
+0002c460: 2020 206d 6574 6120 3a20 6f62 6a65 6374     meta : object
+0002c470: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0002c480: 2020 2041 6e20 6f70 7469 6f6e 616c 2060     An optional `
+0002c490: 6d65 7461 6020 7061 7261 6d65 7465 7220  meta` parameter 
+0002c4a0: 6361 6e20 6265 2070 6173 7365 6420 666f  can be passed fo
+0002c4b0: 7220 6461 736b 0a20 2020 2020 2020 2074  r dask.        t
+0002c4c0: 6f20 7370 6563 6966 7920 7468 6520 636f  o specify the co
+0002c4d0: 6e63 7265 7465 2064 6174 6166 7261 6d65  ncrete dataframe
+0002c4e0: 2074 7970 6520 746f 2062 6520 7265 7475   type to be retu
+0002c4f0: 726e 6564 2e0a 2020 2020 2020 2020 4279  rned..        By
+0002c500: 2064 6566 6175 6c74 2c20 7061 6e64 6173   default, pandas
+0002c510: 2044 6174 6146 7261 6d65 2069 7320 7573   DataFrame is us
+0002c520: 6564 2e0a 0a20 2020 2045 7861 6d70 6c65  ed...    Example
+0002c530: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+0002c540: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0002c550: 736b 2e61 7272 6179 2061 7320 6461 0a20  sk.array as da. 
+0002c560: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
+0002c570: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
+0002c580: 6464 0a20 2020 203e 3e3e 2078 203d 2064  dd.    >>> x = d
+0002c590: 612e 6f6e 6573 2828 342c 2032 292c 2063  a.ones((4, 2), c
+0002c5a0: 6875 6e6b 733d 2832 2c20 3229 290a 2020  hunks=(2, 2)).  
+0002c5b0: 2020 3e3e 3e20 6466 203d 2064 642e 696f    >>> df = dd.io
+0002c5c0: 2e66 726f 6d5f 6461 736b 5f61 7272 6179  .from_dask_array
+0002c5d0: 2878 2c20 636f 6c75 6d6e 733d 5b27 6127  (x, columns=['a'
+0002c5e0: 2c20 2762 275d 290a 2020 2020 3e3e 3e20  , 'b']).    >>> 
+0002c5f0: 6466 2e63 6f6d 7075 7465 2829 0a20 2020  df.compute().   
+0002c600: 2020 2020 2020 6120 2020 2062 0a20 2020        a    b.   
+0002c610: 2030 2020 312e 3020 2031 2e30 0a20 2020   0  1.0  1.0.   
+0002c620: 2031 2020 312e 3020 2031 2e30 0a20 2020   1  1.0  1.0.   
+0002c630: 2032 2020 312e 3020 2031 2e30 0a20 2020   2  1.0  1.0.   
+0002c640: 2033 2020 312e 3020 2031 2e30 0a0a 2020   3  1.0  1.0..  
+0002c650: 2020 5365 6520 416c 736f 0a20 2020 202d    See Also.    -
+0002c660: 2d2d 2d2d 2d2d 2d0a 2020 2020 6461 736b  -------.    dask
+0002c670: 2e62 6167 2e74 6f5f 6461 7461 6672 616d  .bag.to_datafram
+0002c680: 653a 2066 726f 6d20 6461 736b 2e62 6167  e: from dask.bag
+0002c690: 0a20 2020 2064 6173 6b2e 6461 7461 6672  .    dask.datafr
+0002c6a0: 616d 652e 4461 7461 4672 616d 652e 7661  ame.DataFrame.va
+0002c6b0: 6c75 6573 3a20 5265 7665 7273 6520 636f  lues: Reverse co
+0002c6c0: 6e76 6572 7369 6f6e 0a20 2020 2064 6173  nversion.    das
+0002c6d0: 6b2e 6461 7461 6672 616d 652e 4461 7461  k.dataframe.Data
+0002c6e0: 4672 616d 652e 746f 5f72 6563 6f72 6473  Frame.to_records
+0002c6f0: 3a20 5265 7665 7273 6520 636f 6e76 6572  : Reverse conver
+0002c700: 7369 6f6e 0a20 2020 2022 2222 0a20 2020  sion.    """.   
+0002c710: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+0002c720: 7261 6d65 2e69 6f20 696d 706f 7274 2066  rame.io import f
+0002c730: 726f 6d5f 6461 736b 5f61 7272 6179 0a0a  rom_dask_array..
+0002c740: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002c750: 6528 696e 6465 782c 2046 7261 6d65 4261  e(index, FrameBa
+0002c760: 7365 293a 0a20 2020 2020 2020 2069 6e64  se):.        ind
+0002c770: 6578 203d 2069 6e64 6578 2e74 6f5f 6c65  ex = index.to_le
+0002c780: 6761 6379 5f64 6174 6166 7261 6d65 2829  gacy_dataframe()
+0002c790: 0a20 2020 2069 6620 636f 6c75 6d6e 7320  .    if columns 
+0002c7a0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+0002c7b0: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
+0002c7c0: 6e73 2c20 6c69 7374 2920 616e 6420 6e6f  ns, list) and no
+0002c7d0: 7420 6c65 6e28 636f 6c75 6d6e 7329 3a0a  t len(columns):.
+0002c7e0: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
+0002c7f0: 3d20 4e6f 6e65 0a20 2020 2064 6620 3d20  = None.    df = 
+0002c800: 6672 6f6d 5f64 6173 6b5f 6172 7261 7928  from_dask_array(
+0002c810: 782c 2063 6f6c 756d 6e73 3d63 6f6c 756d  x, columns=colum
+0002c820: 6e73 2c20 696e 6465 783d 696e 6465 782c  ns, index=index,
+0002c830: 206d 6574 613d 6d65 7461 290a 2020 2020   meta=meta).    
+0002c840: 7265 7475 726e 2066 726f 6d5f 6c65 6761  return from_lega
+0002c850: 6379 5f64 6174 6166 7261 6d65 2864 662c  cy_dataframe(df,
+0002c860: 206f 7074 696d 697a 653d 5472 7565 290a   optimize=True).
+0002c870: 0a0a 6465 6620 7265 6164 5f63 7376 280a  ..def read_csv(.
+0002c880: 2020 2020 7061 7468 2c0a 2020 2020 2a61      path,.    *a
+0002c890: 7267 732c 0a20 2020 2068 6561 6465 723d  rgs,.    header=
+0002c8a0: 2269 6e66 6572 222c 0a20 2020 2075 7365  "infer",.    use
+0002c8b0: 636f 6c73 3d4e 6f6e 652c 0a20 2020 2064  cols=None,.    d
+0002c8c0: 7479 7065 5f62 6163 6b65 6e64 3d4e 6f6e  type_backend=Non
+0002c8d0: 652c 0a20 2020 2073 746f 7261 6765 5f6f  e,.    storage_o
+0002c8e0: 7074 696f 6e73 3d4e 6f6e 652c 0a20 2020  ptions=None,.   
+0002c8f0: 202a 2a6b 7761 7267 732c 0a29 3a0a 2020   **kwargs,.):.  
+0002c900: 2020 6672 6f6d 2064 6173 6b5f 6578 7072    from dask_expr
+0002c910: 2e69 6f2e 6373 7620 696d 706f 7274 2052  .io.csv import R
+0002c920: 6561 6443 5356 0a0a 2020 2020 6461 7461  eadCSV..    data
+0002c930: 6672 616d 655f 6261 636b 656e 6420 3d20  frame_backend = 
+0002c940: 636f 6e66 6967 2e67 6574 2822 6461 7461  config.get("data
+0002c950: 6672 616d 652e 6261 636b 656e 6422 2c20  frame.backend", 
+0002c960: 2270 616e 6461 7322 290a 2020 2020 6966  "pandas").    if
+0002c970: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0002c980: 7061 7468 2c20 7374 7229 3a0a 2020 2020  path, str):.    
+0002c990: 2020 2020 7061 7468 203d 2073 7472 696e      path = strin
+0002c9a0: 6769 6679 5f70 6174 6828 7061 7468 290a  gify_path(path).
+0002c9b0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+0002c9c0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+0002c9d0: 2020 2052 6561 6443 5356 280a 2020 2020     ReadCSV(.    
+0002c9e0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+0002c9f0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0002ca00: 733d 7573 6563 6f6c 732c 0a20 2020 2020  s=usecols,.     
+0002ca10: 2020 2020 2020 2064 7479 7065 5f62 6163         dtype_bac
+0002ca20: 6b65 6e64 3d64 7479 7065 5f62 6163 6b65  kend=dtype_backe
+0002ca30: 6e64 2c0a 2020 2020 2020 2020 2020 2020  nd,.            
+0002ca40: 7374 6f72 6167 655f 6f70 7469 6f6e 733d  storage_options=
+0002ca50: 7374 6f72 6167 655f 6f70 7469 6f6e 732c  storage_options,
+0002ca60: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
+0002ca70: 7267 733d 6b77 6172 6773 2c0a 2020 2020  rgs=kwargs,.    
+0002ca80: 2020 2020 2020 2020 6865 6164 6572 3d68          header=h
+0002ca90: 6561 6465 722c 0a20 2020 2020 2020 2020  eader,.         
+0002caa0: 2020 2064 6174 6166 7261 6d65 5f62 6163     dataframe_bac
+0002cab0: 6b65 6e64 3d64 6174 6166 7261 6d65 5f62  kend=dataframe_b
+0002cac0: 6163 6b65 6e64 2c0a 2020 2020 2020 2020  ackend,.        
+0002cad0: 290a 2020 2020 290a 0a0a 6465 6620 7265  ).    )...def re
+0002cae0: 6164 5f74 6162 6c65 280a 2020 2020 7061  ad_table(.    pa
+0002caf0: 7468 2c0a 2020 2020 2a61 7267 732c 0a20  th,.    *args,. 
+0002cb00: 2020 2068 6561 6465 723d 2269 6e66 6572     header="infer
+0002cb10: 222c 0a20 2020 2075 7365 636f 6c73 3d4e  ",.    usecols=N
+0002cb20: 6f6e 652c 0a20 2020 2064 7479 7065 5f62  one,.    dtype_b
+0002cb30: 6163 6b65 6e64 3d4e 6f6e 652c 0a20 2020  ackend=None,.   
+0002cb40: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
+0002cb50: 3d4e 6f6e 652c 0a20 2020 202a 2a6b 7761  =None,.    **kwa
+0002cb60: 7267 732c 0a29 3a0a 2020 2020 6672 6f6d  rgs,.):.    from
+0002cb70: 2064 6173 6b5f 6578 7072 2e69 6f2e 6373   dask_expr.io.cs
+0002cb80: 7620 696d 706f 7274 2052 6561 6454 6162  v import ReadTab
+0002cb90: 6c65 0a0a 2020 2020 6966 206e 6f74 2069  le..    if not i
+0002cba0: 7369 6e73 7461 6e63 6528 7061 7468 2c20  sinstance(path, 
+0002cbb0: 7374 7229 3a0a 2020 2020 2020 2020 7061  str):.        pa
+0002cbc0: 7468 203d 2073 7472 696e 6769 6679 5f70  th = stringify_p
+0002cbd0: 6174 6828 7061 7468 290a 2020 2020 7265  ath(path).    re
+0002cbe0: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+0002cbf0: 696f 6e28 0a20 2020 2020 2020 2052 6561  ion(.        Rea
+0002cc00: 6454 6162 6c65 280a 2020 2020 2020 2020  dTable(.        
+0002cc10: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+0002cc20: 2020 2020 2020 636f 6c75 6d6e 733d 7573        columns=us
+0002cc30: 6563 6f6c 732c 0a20 2020 2020 2020 2020  ecols,.         
+0002cc40: 2020 2064 7479 7065 5f62 6163 6b65 6e64     dtype_backend
+0002cc50: 3d64 7479 7065 5f62 6163 6b65 6e64 2c0a  =dtype_backend,.
+0002cc60: 2020 2020 2020 2020 2020 2020 7374 6f72              stor
+0002cc70: 6167 655f 6f70 7469 6f6e 733d 7374 6f72  age_options=stor
+0002cc80: 6167 655f 6f70 7469 6f6e 732c 0a20 2020  age_options,.   
+0002cc90: 2020 2020 2020 2020 206b 7761 7267 733d           kwargs=
+0002cca0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0002ccb0: 2020 2020 6865 6164 6572 3d68 6561 6465      header=heade
+0002ccc0: 722c 0a20 2020 2020 2020 2029 0a20 2020  r,.        ).   
+0002ccd0: 2029 0a0a 0a64 6566 2072 6561 645f 6677   )...def read_fw
+0002cce0: 6628 0a20 2020 2070 6174 682c 0a20 2020  f(.    path,.   
+0002ccf0: 202a 6172 6773 2c0a 2020 2020 6865 6164   *args,.    head
+0002cd00: 6572 3d22 696e 6665 7222 2c0a 2020 2020  er="infer",.    
+0002cd10: 7573 6563 6f6c 733d 4e6f 6e65 2c0a 2020  usecols=None,.  
+0002cd20: 2020 6474 7970 655f 6261 636b 656e 643d    dtype_backend=
+0002cd30: 4e6f 6e65 2c0a 2020 2020 7374 6f72 6167  None,.    storag
+0002cd40: 655f 6f70 7469 6f6e 733d 4e6f 6e65 2c0a  e_options=None,.
+0002cd50: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
+0002cd60: 0a20 2020 2066 726f 6d20 6461 736b 5f65  .    from dask_e
+0002cd70: 7870 722e 696f 2e63 7376 2069 6d70 6f72  xpr.io.csv impor
+0002cd80: 7420 5265 6164 4677 660a 0a20 2020 2069  t ReadFwf..    i
+0002cd90: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+0002cda0: 2870 6174 682c 2073 7472 293a 0a20 2020  (path, str):.   
+0002cdb0: 2020 2020 2070 6174 6820 3d20 7374 7269       path = stri
+0002cdc0: 6e67 6966 795f 7061 7468 2870 6174 6829  ngify_path(path)
+0002cdd0: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
+0002cde0: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+0002cdf0: 2020 2020 5265 6164 4677 6628 0a20 2020      ReadFwf(.   
+0002ce00: 2020 2020 2020 2020 2070 6174 682c 0a20           path,. 
+0002ce10: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0002ce20: 6e73 3d75 7365 636f 6c73 2c0a 2020 2020  ns=usecols,.    
+0002ce30: 2020 2020 2020 2020 6474 7970 655f 6261          dtype_ba
+0002ce40: 636b 656e 643d 6474 7970 655f 6261 636b  ckend=dtype_back
+0002ce50: 656e 642c 0a20 2020 2020 2020 2020 2020  end,.           
+0002ce60: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
+0002ce70: 3d73 746f 7261 6765 5f6f 7074 696f 6e73  =storage_options
+0002ce80: 2c0a 2020 2020 2020 2020 2020 2020 6b77  ,.            kw
+0002ce90: 6172 6773 3d6b 7761 7267 732c 0a20 2020  args=kwargs,.   
+0002cea0: 2020 2020 2020 2020 2068 6561 6465 723d           header=
+0002ceb0: 6865 6164 6572 2c0a 2020 2020 2020 2020  header,.        
+0002cec0: 290a 2020 2020 290a 0a0a 6465 6620 7265  ).    )...def re
+0002ced0: 6164 5f70 6172 7175 6574 280a 2020 2020  ad_parquet(.    
+0002cee0: 7061 7468 3d4e 6f6e 652c 0a20 2020 2063  path=None,.    c
+0002cef0: 6f6c 756d 6e73 3d4e 6f6e 652c 0a20 2020  olumns=None,.   
+0002cf00: 2066 696c 7465 7273 3d4e 6f6e 652c 0a20   filters=None,. 
+0002cf10: 2020 2063 6174 6567 6f72 6965 733d 4e6f     categories=No
+0002cf20: 6e65 2c0a 2020 2020 696e 6465 783d 4e6f  ne,.    index=No
+0002cf30: 6e65 2c0a 2020 2020 7374 6f72 6167 655f  ne,.    storage_
+0002cf40: 6f70 7469 6f6e 733d 4e6f 6e65 2c0a 2020  options=None,.  
+0002cf50: 2020 6474 7970 655f 6261 636b 656e 643d    dtype_backend=
+0002cf60: 4e6f 6e65 2c0a 2020 2020 6361 6c63 756c  None,.    calcul
+0002cf70: 6174 655f 6469 7669 7369 6f6e 733d 4661  ate_divisions=Fa
+0002cf80: 6c73 652c 0a20 2020 2069 676e 6f72 655f  lse,.    ignore_
+0002cf90: 6d65 7461 6461 7461 5f66 696c 653d 4661  metadata_file=Fa
+0002cfa0: 6c73 652c 0a20 2020 206d 6574 6164 6174  lse,.    metadat
+0002cfb0: 615f 7461 736b 5f73 697a 653d 4e6f 6e65  a_task_size=None
+0002cfc0: 2c0a 2020 2020 7370 6c69 745f 726f 775f  ,.    split_row_
+0002cfd0: 6772 6f75 7073 3d22 696e 6665 7222 2c0a  groups="infer",.
+0002cfe0: 2020 2020 626c 6f63 6b73 697a 653d 2264      blocksize="d
+0002cff0: 6566 6175 6c74 222c 0a20 2020 2061 6767  efault",.    agg
+0002d000: 7265 6761 7465 5f66 696c 6573 3d4e 6f6e  regate_files=Non
+0002d010: 652c 0a20 2020 2070 6172 7175 6574 5f66  e,.    parquet_f
+0002d020: 696c 655f 6578 7465 6e73 696f 6e3d 2822  ile_extension=("
+0002d030: 2e70 6172 7122 2c20 222e 7061 7271 7565  .parq", ".parque
+0002d040: 7422 2c20 222e 7071 2229 2c0a 2020 2020  t", ".pq"),.    
+0002d050: 6669 6c65 7379 7374 656d 3d22 6673 7370  filesystem="fssp
+0002d060: 6563 222c 0a20 2020 2065 6e67 696e 653d  ec",.    engine=
+0002d070: 4e6f 6e65 2c0a 2020 2020 6172 726f 775f  None,.    arrow_
+0002d080: 746f 5f70 616e 6461 733d 4e6f 6e65 2c0a  to_pandas=None,.
+0002d090: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
+0002d0a0: 0a20 2020 2022 2222 0a20 2020 2052 6561  .    """.    Rea
+0002d0b0: 6420 6120 5061 7271 7565 7420 6669 6c65  d a Parquet file
+0002d0c0: 2069 6e74 6f20 6120 4461 736b 2044 6174   into a Dask Dat
+0002d0d0: 6146 7261 6d65 0a0a 2020 2020 5468 6973  aFrame..    This
+0002d0e0: 2072 6561 6473 2061 2064 6972 6563 746f   reads a directo
+0002d0f0: 7279 206f 6620 5061 7271 7565 7420 6461  ry of Parquet da
+0002d100: 7461 2069 6e74 6f20 6120 4461 736b 2e64  ta into a Dask.d
+0002d110: 6174 6166 7261 6d65 2c20 6f6e 6520 6669  ataframe, one fi
+0002d120: 6c65 2070 6572 0a20 2020 2070 6172 7469  le per.    parti
+0002d130: 7469 6f6e 2e20 2049 7420 7365 6c65 6374  tion.  It select
+0002d140: 7320 7468 6520 696e 6465 7820 616d 6f6e  s the index amon
+0002d150: 6720 7468 6520 736f 7274 6564 2063 6f6c  g the sorted col
+0002d160: 756d 6e73 2069 6620 616e 7920 6578 6973  umns if any exis
+0002d170: 742e 0a0a 2020 2020 2e2e 206e 6f74 653a  t...    .. note:
+0002d180: 3a0a 2020 2020 2020 2020 4461 736b 2061  :.        Dask a
+0002d190: 7574 6f6d 6174 6963 616c 6c79 2072 6573  utomatically res
+0002d1a0: 697a 6573 2070 6172 7469 7469 6f6e 7320  izes partitions 
+0002d1b0: 746f 2065 6e73 7572 6520 7468 6174 2065  to ensure that e
+0002d1c0: 6163 6820 7061 7274 6974 696f 6e20 6973  ach partition is
+0002d1d0: 206f 660a 2020 2020 2020 2020 6164 6571   of.        adeq
+0002d1e0: 7561 7465 2073 697a 652e 2054 6865 206f  uate size. The o
+0002d1f0: 7074 696d 697a 6572 2075 7365 7320 7468  ptimizer uses th
+0002d200: 6520 7261 7469 6f20 6f66 2073 656c 6563  e ratio of selec
+0002d210: 7465 6420 636f 6c75 6d6e 7320 746f 2074  ted columns to t
+0002d220: 6f74 616c 0a20 2020 2020 2020 2063 6f6c  otal.        col
+0002d230: 756d 6e73 2074 6f20 7371 7561 7368 206d  umns to squash m
+0002d240: 756c 7469 706c 6520 6669 6c65 7320 696e  ultiple files in
+0002d250: 746f 206f 6e65 2070 6172 7469 7469 6f6e  to one partition
+0002d260: 2e0a 0a20 2020 2020 2020 2041 6464 6974  ...        Addit
+0002d270: 696f 6e61 6c6c 792c 2074 6865 204f 7074  ionally, the Opt
+0002d280: 696d 697a 6572 2075 7365 7320 6120 6d69  imizer uses a mi
+0002d290: 6e69 6d75 6d20 7369 7a65 2070 6572 2070  nimum size per p
+0002d2a0: 6172 7469 7469 6f6e 2028 6465 6661 756c  artition (defaul
+0002d2b0: 7420 3735 4d42 290a 2020 2020 2020 2020  t 75MB).        
+0002d2c0: 746f 2061 766f 6964 2074 6f6f 206d 616e  to avoid too man
+0002d2d0: 7920 736d 616c 6c20 7061 7274 6974 696f  y small partitio
+0002d2e0: 6e73 2e20 5468 6973 2063 6f6e 6669 6775  ns. This configu
+0002d2f0: 7261 7469 6f6e 2063 616e 2062 6520 7365  ration can be se
+0002d300: 7420 7769 7468 0a0a 2020 2020 2020 2020  t with..        
+0002d310: 3e3e 3e20 6461 736b 2e63 6f6e 6669 672e  >>> dask.config.
+0002d320: 7365 7428 7b22 6461 7461 6672 616d 652e  set({"dataframe.
+0002d330: 7061 7271 7565 742e 6d69 6e69 6d75 6d2d  parquet.minimum-
+0002d340: 7061 7274 6974 696f 6e2d 7369 7a65 223a  partition-size":
+0002d350: 2022 3130 304d 4222 7d29 0a0a 2020 2020   "100MB"})..    
+0002d360: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+0002d370: 2020 5370 6563 6966 7969 6e67 2060 6066    Specifying ``f
+0002d380: 696c 6573 7973 7465 6d3d 2261 7272 6f77  ilesystem="arrow
+0002d390: 2260 6020 6c65 7665 7261 6765 7320 6120  "`` leverages a 
+0002d3a0: 636f 6d70 6c65 7465 2072 6569 6d70 6c65  complete reimple
+0002d3b0: 6d65 6e74 6174 696f 6e20 6f66 0a20 2020  mentation of.   
+0002d3c0: 2020 2020 2074 6865 2050 6172 7175 6574       the Parquet
+0002d3d0: 2072 6561 6465 7220 7468 6174 2069 7320   reader that is 
+0002d3e0: 736f 6c65 6c79 2062 6173 6564 206f 6e20  solely based on 
+0002d3f0: 5079 4172 726f 772e 2049 7420 6973 2073  PyArrow. It is s
+0002d400: 6967 6e69 6669 6361 6e74 6c79 2066 6173  ignificantly fas
+0002d410: 7465 720a 2020 2020 2020 2020 7468 616e  ter.        than
+0002d420: 2074 6865 206c 6567 6163 7920 696d 706c   the legacy impl
+0002d430: 656d 656e 7461 7469 6f6e 2c20 6275 7420  ementation, but 
+0002d440: 646f 6573 6e27 7420 7965 7420 7375 7070  doesn't yet supp
+0002d450: 6f72 7420 616c 6c20 6665 6174 7572 6573  ort all features
+0002d460: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0002d470: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0002d480: 0a20 2020 2070 6174 6820 3a20 7374 7220  .    path : str 
+0002d490: 6f72 206c 6973 740a 2020 2020 2020 2020  or list.        
+0002d4a0: 536f 7572 6365 2064 6972 6563 746f 7279  Source directory
+0002d4b0: 2066 6f72 2064 6174 612c 206f 7220 7061   for data, or pa
+0002d4c0: 7468 2873 2920 746f 2069 6e64 6976 6964  th(s) to individ
+0002d4d0: 7561 6c20 7061 7271 7565 7420 6669 6c65  ual parquet file
+0002d4e0: 732e 0a20 2020 2020 2020 2050 7265 6669  s..        Prefi
+0002d4f0: 7820 7769 7468 2061 2070 726f 746f 636f  x with a protoco
+0002d500: 6c20 6c69 6b65 2060 6073 333a 2f2f 6060  l like ``s3://``
+0002d510: 2074 6f20 7265 6164 2066 726f 6d20 616c   to read from al
+0002d520: 7465 726e 6174 6976 650a 2020 2020 2020  ternative.      
+0002d530: 2020 6669 6c65 7379 7374 656d 732e 2054    filesystems. T
+0002d540: 6f20 7265 6164 2066 726f 6d20 6d75 6c74  o read from mult
+0002d550: 6970 6c65 2066 696c 6573 2079 6f75 2063  iple files you c
+0002d560: 616e 2070 6173 7320 6120 676c 6f62 7374  an pass a globst
+0002d570: 7269 6e67 206f 7220 610a 2020 2020 2020  ring or a.      
+0002d580: 2020 6c69 7374 206f 6620 7061 7468 732c    list of paths,
+0002d590: 2077 6974 6820 7468 6520 6361 7665 6174   with the caveat
+0002d5a0: 2074 6861 7420 7468 6579 206d 7573 7420   that they must 
+0002d5b0: 616c 6c20 6861 7665 2074 6865 2073 616d  all have the sam
+0002d5c0: 650a 2020 2020 2020 2020 7072 6f74 6f63  e.        protoc
+0002d5d0: 6f6c 2e0a 2020 2020 636f 6c75 6d6e 7320  ol..    columns 
+0002d5e0: 3a20 7374 7220 6f72 206c 6973 742c 2064  : str or list, d
+0002d5f0: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
+0002d600: 2020 2020 4669 656c 6420 6e61 6d65 2873      Field name(s
+0002d610: 2920 746f 2072 6561 6420 696e 2061 7320  ) to read in as 
+0002d620: 636f 6c75 6d6e 7320 696e 2074 6865 206f  columns in the o
+0002d630: 7574 7075 742e 2042 7920 6465 6661 756c  utput. By defaul
+0002d640: 7420 616c 6c0a 2020 2020 2020 2020 6e6f  t all.        no
+0002d650: 6e2d 696e 6465 7820 6669 656c 6473 2077  n-index fields w
+0002d660: 696c 6c20 6265 2072 6561 6420 2861 7320  ill be read (as 
+0002d670: 6465 7465 726d 696e 6564 2062 7920 7468  determined by th
+0002d680: 6520 7061 6e64 6173 2070 6172 7175 6574  e pandas parquet
+0002d690: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0002d6a0: 612c 2069 6620 7072 6573 656e 7429 2e20  a, if present). 
+0002d6b0: 5072 6f76 6964 6520 6120 7369 6e67 6c65  Provide a single
+0002d6c0: 2066 6965 6c64 206e 616d 6520 696e 7374   field name inst
+0002d6d0: 6561 6420 6f66 2061 206c 6973 7420 746f  ead of a list to
+0002d6e0: 0a20 2020 2020 2020 2072 6561 6420 696e  .        read in
+0002d6f0: 2074 6865 2064 6174 6120 6173 2061 2053   the data as a S
+0002d700: 6572 6965 732e 0a20 2020 2066 696c 7465  eries..    filte
+0002d710: 7273 203a 2055 6e69 6f6e 5b4c 6973 745b  rs : Union[List[
+0002d720: 5475 706c 655b 7374 722c 2073 7472 2c20  Tuple[str, str, 
+0002d730: 416e 795d 5d2c 204c 6973 745b 4c69 7374  Any]], List[List
+0002d740: 5b54 7570 6c65 5b73 7472 2c20 7374 722c  [Tuple[str, str,
+0002d750: 2041 6e79 5d5d 5d5d 2c20 6465 6661 756c   Any]]]], defaul
+0002d760: 7420 4e6f 6e65 0a20 2020 2020 2020 204c  t None.        L
+0002d770: 6973 7420 6f66 2066 696c 7465 7273 2074  ist of filters t
+0002d780: 6f20 6170 706c 792c 206c 696b 6520 6060  o apply, like ``
+0002d790: 5b5b 2827 636f 6c31 272c 2027 3d3d 272c  [[('col1', '==',
+0002d7a0: 2030 292c 202e 2e2e 5d2c 202e 2e2e 5d60   0), ...], ...]`
+0002d7b0: 602e 0a20 2020 2020 2020 2055 7369 6e67  `..        Using
+0002d7c0: 2074 6869 7320 6172 6775 6d65 6e74 2077   this argument w
+0002d7d0: 696c 6c20 7265 7375 6c74 2069 6e20 726f  ill result in ro
+0002d7e0: 772d 7769 7365 2066 696c 7465 7269 6e67  w-wise filtering
+0002d7f0: 206f 6620 7468 6520 6669 6e61 6c20 7061   of the final pa
+0002d800: 7274 6974 696f 6e73 2e0a 0a20 2020 2020  rtitions...     
+0002d810: 2020 2050 7265 6469 6361 7465 7320 6361     Predicates ca
+0002d820: 6e20 6265 2065 7870 7265 7373 6564 2069  n be expressed i
+0002d830: 6e20 6469 736a 756e 6374 6976 6520 6e6f  n disjunctive no
+0002d840: 726d 616c 2066 6f72 6d20 2844 4e46 292e  rmal form (DNF).
+0002d850: 2054 6869 7320 6d65 616e 7320 7468 6174   This means that
+0002d860: 0a20 2020 2020 2020 2074 6865 2069 6e6e  .        the inn
+0002d870: 6572 2d6d 6f73 7420 7475 706c 6520 6465  er-most tuple de
+0002d880: 7363 7269 6265 7320 6120 7369 6e67 6c65  scribes a single
+0002d890: 2063 6f6c 756d 6e20 7072 6564 6963 6174   column predicat
+0002d8a0: 652e 2054 6865 7365 2069 6e6e 6572 2070  e. These inner p
+0002d8b0: 7265 6469 6361 7465 730a 2020 2020 2020  redicates.      
+0002d8c0: 2020 6172 6520 636f 6d62 696e 6564 2077    are combined w
+0002d8d0: 6974 6820 616e 2041 4e44 2063 6f6e 6a75  ith an AND conju
+0002d8e0: 6e63 7469 6f6e 2069 6e74 6f20 6120 6c61  nction into a la
+0002d8f0: 7267 6572 2070 7265 6469 6361 7465 2e20  rger predicate. 
+0002d900: 5468 6520 6f75 7465 722d 6d6f 7374 0a20  The outer-most. 
+0002d910: 2020 2020 2020 206c 6973 7420 7468 656e         list then
+0002d920: 2063 6f6d 6269 6e65 7320 616c 6c20 6f66   combines all of
+0002d930: 2074 6865 2063 6f6d 6269 6e65 6420 6669   the combined fi
+0002d940: 6c74 6572 7320 7769 7468 2061 6e20 4f52  lters with an OR
+0002d950: 2064 6973 6a75 6e63 7469 6f6e 2e0a 0a20   disjunction... 
+0002d960: 2020 2020 2020 2050 7265 6469 6361 7465         Predicate
+0002d970: 7320 6361 6e20 616c 736f 2062 6520 6578  s can also be ex
+0002d980: 7072 6573 7365 6420 6173 2061 2060 604c  pressed as a ``L
+0002d990: 6973 745b 5475 706c 655d 6060 2e20 5468  ist[Tuple]``. Th
+0002d9a0: 6573 6520 6172 6520 6576 616c 7561 7465  ese are evaluate
+0002d9b0: 640a 2020 2020 2020 2020 6173 2061 6e20  d.        as an 
+0002d9c0: 414e 4420 636f 6e6a 756e 6374 696f 6e2e  AND conjunction.
+0002d9d0: 2054 6f20 6578 7072 6573 7320 4f52 2069   To express OR i
+0002d9e0: 6e20 7072 6564 6963 6174 6573 2c20 6f6e  n predicates, on
+0002d9f0: 6520 6d75 7374 2075 7365 2074 6865 0a20  e must use the. 
+0002da00: 2020 2020 2020 2028 7072 6566 6572 7265         (preferre
+0002da10: 6420 666f 7220 2270 7961 7272 6f77 2229  d for "pyarrow")
+0002da20: 2060 604c 6973 745b 4c69 7374 5b54 7570   ``List[List[Tup
+0002da30: 6c65 5d5d 6060 206e 6f74 6174 696f 6e2e  le]]`` notation.
+0002da40: 0a20 2020 2069 6e64 6578 203a 2073 7472  .    index : str
+0002da50: 2c20 6c69 7374 206f 7220 4661 6c73 652c  , list or False,
+0002da60: 2064 6566 6175 6c74 204e 6f6e 650a 2020   default None.  
+0002da70: 2020 2020 2020 4669 656c 6420 6e61 6d65        Field name
+0002da80: 2873 2920 746f 2075 7365 2061 7320 7468  (s) to use as th
+0002da90: 6520 6f75 7470 7574 2066 7261 6d65 2069  e output frame i
+0002daa0: 6e64 6578 2e20 4279 2064 6566 6175 6c74  ndex. By default
+0002dab0: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
+0002dac0: 2069 6e66 6572 7265 6420 6672 6f6d 2074   inferred from t
+0002dad0: 6865 2070 616e 6461 7320 7061 7271 7565  he pandas parque
+0002dae0: 7420 6669 6c65 206d 6574 6164 6174 612c  t file metadata,
+0002daf0: 2069 6620 7072 6573 656e 742e 2055 7365   if present. Use
+0002db00: 2060 6046 616c 7365 6060 0a20 2020 2020   ``False``.     
+0002db10: 2020 2074 6f20 7265 6164 2061 6c6c 2066     to read all f
+0002db20: 6965 6c64 7320 6173 2063 6f6c 756d 6e73  ields as columns
+0002db30: 2e0a 2020 2020 6361 7465 676f 7269 6573  ..    categories
+0002db40: 203a 206c 6973 7420 6f72 2064 6963 742c   : list or dict,
+0002db50: 2064 6566 6175 6c74 204e 6f6e 650a 2020   default None.  
+0002db60: 2020 2020 2020 466f 7220 616e 7920 6669        For any fi
+0002db70: 656c 6473 206c 6973 7465 6420 6865 7265  elds listed here
+0002db80: 2c20 6966 2074 6865 2070 6172 7175 6574  , if the parquet
+0002db90: 2065 6e63 6f64 696e 6720 6973 2044 6963   encoding is Dic
+0002dba0: 7469 6f6e 6172 792c 0a20 2020 2020 2020  tionary,.       
+0002dbb0: 2074 6865 2063 6f6c 756d 6e20 7769 6c6c   the column will
+0002dbc0: 2062 6520 6372 6561 7465 6420 7769 7468   be created with
+0002dbd0: 2064 7479 7065 2063 6174 6567 6f72 792e   dtype category.
+0002dbe0: 2055 7365 206f 6e6c 7920 6966 2069 7420   Use only if it 
+0002dbf0: 6973 0a20 2020 2020 2020 2067 7561 7261  is.        guara
+0002dc00: 6e74 6565 6420 7468 6174 2074 6865 2063  nteed that the c
+0002dc10: 6f6c 756d 6e20 6973 2065 6e63 6f64 6564  olumn is encoded
+0002dc20: 2061 7320 6469 6374 696f 6e61 7279 2069   as dictionary i
+0002dc30: 6e20 616c 6c20 726f 772d 6772 6f75 7073  n all row-groups
+0002dc40: 2e0a 2020 2020 2020 2020 4966 2061 206c  ..        If a l
+0002dc50: 6973 742c 2061 7373 756d 6573 2075 7020  ist, assumes up 
+0002dc60: 746f 2032 2a2a 3136 2d31 206c 6162 656c  to 2**16-1 label
+0002dc70: 733b 2069 6620 6120 6469 6374 2c20 7370  s; if a dict, sp
+0002dc80: 6563 6966 7920 7468 6520 6e75 6d62 6572  ecify the number
+0002dc90: 0a20 2020 2020 2020 206f 6620 6c61 6265  .        of labe
+0002dca0: 6c73 2065 7870 6563 7465 643b 2069 6620  ls expected; if 
+0002dcb0: 4e6f 6e65 2c20 7769 6c6c 206c 6f61 6420  None, will load 
+0002dcc0: 6361 7465 676f 7269 6573 2061 7574 6f6d  categories autom
+0002dcd0: 6174 6963 616c 6c79 2066 6f72 0a20 2020  atically for.   
+0002dce0: 2020 2020 2064 6174 6120 7772 6974 7465       data writte
+0002dcf0: 6e20 6279 2064 6173 6b2c 206e 6f74 206f  n by dask, not o
+0002dd00: 7468 6572 7769 7365 2e0a 2020 2020 7374  therwise..    st
+0002dd10: 6f72 6167 655f 6f70 7469 6f6e 7320 3a20  orage_options : 
+0002dd20: 6469 6374 2c20 6465 6661 756c 7420 4e6f  dict, default No
+0002dd30: 6e65 0a20 2020 2020 2020 204b 6579 2f76  ne.        Key/v
+0002dd40: 616c 7565 2070 6169 7273 2074 6f20 6265  alue pairs to be
+0002dd50: 2070 6173 7365 6420 6f6e 2074 6f20 7468   passed on to th
+0002dd60: 6520 6669 6c65 2d73 7973 7465 6d20 6261  e file-system ba
+0002dd70: 636b 656e 642c 2069 6620 616e 792e 0a20  ckend, if any.. 
+0002dd80: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+0002dd90: 2074 6865 2064 6566 6175 6c74 2066 696c   the default fil
+0002dda0: 652d 7379 7374 656d 2062 6163 6b65 6e64  e-system backend
+0002ddb0: 2063 616e 2062 6520 636f 6e66 6967 7572   can be configur
+0002ddc0: 6564 2077 6974 6820 7468 650a 2020 2020  ed with the.    
+0002ddd0: 2020 2020 6060 6669 6c65 7379 7374 656d      ``filesystem
+0002dde0: 6060 2061 7267 756d 656e 742c 2064 6573  `` argument, des
+0002ddf0: 6372 6962 6564 2062 656c 6f77 2e0a 2020  cribed below..  
+0002de00: 2020 6f70 656e 5f66 696c 655f 6f70 7469    open_file_opti
+0002de10: 6f6e 7320 3a20 6469 6374 2c20 6465 6661  ons : dict, defa
+0002de20: 756c 7420 4e6f 6e65 0a20 2020 2020 2020  ult None.       
+0002de30: 204b 6579 2f76 616c 7565 2061 7267 756d   Key/value argum
+0002de40: 656e 7473 2074 6f20 6265 2070 6173 7365  ents to be passe
+0002de50: 6420 616c 6f6e 6720 746f 2060 6041 6273  d along to ``Abs
+0002de60: 7472 6163 7446 696c 6553 7973 7465 6d2e  tractFileSystem.
+0002de70: 6f70 656e 6060 0a20 2020 2020 2020 2077  open``.        w
+0002de80: 6865 6e20 6561 6368 2070 6172 7175 6574  hen each parquet
+0002de90: 2064 6174 6120 6669 6c65 2069 7320 6f70   data file is op
+0002dea0: 656e 2066 6f72 2072 6561 6469 6e67 2e20  en for reading. 
+0002deb0: 4578 7065 7269 6d65 6e74 616c 0a20 2020  Experimental.   
+0002dec0: 2020 2020 2028 6f70 7469 6d69 7a65 6429       (optimized)
+0002ded0: 2022 7072 6563 6163 6869 6e67 2220 666f   "precaching" fo
+0002dee0: 7220 7265 6d6f 7465 2066 696c 6520 7379  r remote file sy
+0002def0: 7374 656d 7320 2865 2e67 2e20 5333 2c20  stems (e.g. S3, 
+0002df00: 4743 5329 2063 616e 0a20 2020 2020 2020  GCS) can.       
+0002df10: 2062 6520 656e 6162 6c65 6420 6279 2061   be enabled by a
+0002df20: 6464 696e 6720 6060 7b22 6d65 7468 6f64  dding ``{"method
+0002df30: 223a 2022 7061 7271 7565 7422 7d60 6020  ": "parquet"}`` 
+0002df40: 756e 6465 7220 7468 650a 2020 2020 2020  under the.      
+0002df50: 2020 6060 2270 7265 6361 6368 655f 6f70    ``"precache_op
+0002df60: 7469 6f6e 7322 6060 206b 6579 2e20 416c  tions"`` key. Al
+0002df70: 736f 2c20 6120 6375 7374 6f6d 2066 696c  so, a custom fil
+0002df80: 652d 6f70 656e 2066 756e 6374 696f 6e20  e-open function 
+0002df90: 6361 6e20 6265 0a20 2020 2020 2020 2075  can be.        u
+0002dfa0: 7365 6420 2869 6e73 7465 6164 206f 6620  sed (instead of 
+0002dfb0: 6060 4162 7374 7261 6374 4669 6c65 5379  ``AbstractFileSy
+0002dfc0: 7374 656d 2e6f 7065 6e60 6029 2c20 6279  stem.open``), by
+0002dfd0: 2073 7065 6369 6679 696e 6720 7468 650a   specifying the.
+0002dfe0: 2020 2020 2020 2020 6465 7369 7265 6420          desired 
+0002dff0: 6675 6e63 7469 6f6e 2075 6e64 6572 2074  function under t
+0002e000: 6865 2060 6022 6f70 656e 5f66 696c 655f  he ``"open_file_
+0002e010: 6675 6e63 2260 6020 6b65 792e 0a20 2020  func"`` key..   
+0002e020: 2064 7479 7065 5f62 6163 6b65 6e64 203a   dtype_backend :
+0002e030: 207b 276e 756d 7079 5f6e 756c 6c61 626c   {'numpy_nullabl
+0002e040: 6527 2c20 2770 7961 7272 6f77 277d 2c20  e', 'pyarrow'}, 
+0002e050: 6465 6661 756c 7473 2074 6f20 4e75 6d50  defaults to NumP
+0002e060: 7920 6261 636b 6564 2044 6174 6146 7261  y backed DataFra
+0002e070: 6d65 730a 2020 2020 2020 2020 5768 6963  mes.        Whic
+0002e080: 6820 6474 7970 655f 6261 636b 656e 6420  h dtype_backend 
+0002e090: 746f 2075 7365 2c20 652e 672e 2077 6865  to use, e.g. whe
+0002e0a0: 7468 6572 2061 2044 6174 6146 7261 6d65  ther a DataFrame
+0002e0b0: 2073 686f 756c 6420 6861 7665 204e 756d   should have Num
+0002e0c0: 5079 2061 7272 6179 732c 0a20 2020 2020  Py arrays,.     
+0002e0d0: 2020 206e 756c 6c61 626c 6520 6474 7970     nullable dtyp
+0002e0e0: 6573 2061 7265 2075 7365 6420 666f 7220  es are used for 
+0002e0f0: 616c 6c20 6474 7970 6573 2074 6861 7420  all dtypes that 
+0002e100: 6861 7665 2061 206e 756c 6c61 626c 6520  have a nullable 
+0002e110: 696d 706c 656d 656e 7461 7469 6f6e 0a20  implementation. 
+0002e120: 2020 2020 2020 2077 6865 6e20 276e 756d         when 'num
+0002e130: 7079 5f6e 756c 6c61 626c 6527 2069 7320  py_nullable' is 
+0002e140: 7365 742c 2070 7961 7272 6f77 2069 7320  set, pyarrow is 
+0002e150: 7573 6564 2066 6f72 2061 6c6c 2064 7479  used for all dty
+0002e160: 7065 7320 6966 2027 7079 6172 726f 7727  pes if 'pyarrow'
+0002e170: 0a20 2020 2020 2020 2069 7320 7365 742e  .        is set.
+0002e180: 0a20 2020 2020 2020 2060 6064 7479 7065  .        ``dtype
+0002e190: 5f62 6163 6b65 6e64 3d22 7079 6172 726f  _backend="pyarro
+0002e1a0: 7722 6060 2072 6571 7569 7265 7320 6060  w"`` requires ``
+0002e1b0: 7061 6e64 6173 6060 2031 2e35 2b2e 0a20  pandas`` 1.5+.. 
+0002e1c0: 2020 2063 616c 6375 6c61 7465 5f64 6976     calculate_div
+0002e1d0: 6973 696f 6e73 203a 2062 6f6f 6c2c 2064  isions : bool, d
+0002e1e0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+0002e1f0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+0002e200: 7573 6520 6d69 6e2f 6d61 7820 7374 6174  use min/max stat
+0002e210: 6973 7469 6373 2066 726f 6d20 7468 6520  istics from the 
+0002e220: 666f 6f74 6572 206d 6574 6164 6174 6120  footer metadata 
+0002e230: 286f 7220 676c 6f62 616c 0a20 2020 2020  (or global.     
+0002e240: 2020 2060 605f 6d65 7461 6461 7461 6060     ``_metadata``
+0002e250: 2066 696c 6529 2074 6f20 6361 6c63 756c   file) to calcul
+0002e260: 6174 6520 6469 7669 7369 6f6e 7320 666f  ate divisions fo
+0002e270: 7220 7468 6520 6f75 7470 7574 2044 6174  r the output Dat
+0002e280: 6146 7261 6d65 0a20 2020 2020 2020 2063  aFrame.        c
+0002e290: 6f6c 6c65 6374 696f 6e2e 2044 6976 6973  ollection. Divis
+0002e2a0: 696f 6e73 2077 696c 6c20 6e6f 7420 6265  ions will not be
+0002e2b0: 2063 616c 6375 6c61 7465 6420 6966 2073   calculated if s
+0002e2c0: 7461 7469 7374 6963 7320 6172 6520 6d69  tatistics are mi
+0002e2d0: 7373 696e 672e 0a20 2020 2020 2020 2054  ssing..        T
+0002e2e0: 6869 7320 6f70 7469 6f6e 2077 696c 6c20  his option will 
+0002e2f0: 6265 2069 676e 6f72 6564 2069 6620 6060  be ignored if ``
+0002e300: 696e 6465 7860 6020 6973 206e 6f74 2073  index`` is not s
+0002e310: 7065 6369 6669 6564 2061 6e64 2074 6865  pecified and the
+0002e320: 7265 2069 730a 2020 2020 2020 2020 6e6f  re is.        no
+0002e330: 2070 6879 7369 6361 6c20 696e 6465 7820   physical index 
+0002e340: 636f 6c75 6d6e 2073 7065 6369 6669 6564  column specified
+0002e350: 2069 6e20 7468 6520 6375 7374 6f6d 2022   in the custom "
+0002e360: 7061 6e64 6173 2220 5061 7271 7565 740a  pandas" Parquet.
+0002e370: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0002e380: 2e20 4e6f 7465 2074 6861 7420 6060 6361  . Note that ``ca
+0002e390: 6c63 756c 6174 655f 6469 7669 7369 6f6e  lculate_division
+0002e3a0: 733d 5472 7565 6060 206d 6179 2062 6520  s=True`` may be 
+0002e3b0: 6578 7472 656d 656c 7920 736c 6f77 0a20  extremely slow. 
+0002e3c0: 2020 2020 2020 2077 6865 6e20 6e6f 2067         when no g
+0002e3d0: 6c6f 6261 6c20 6060 5f6d 6574 6164 6174  lobal ``_metadat
+0002e3e0: 6160 6020 6669 6c65 2069 7320 7072 6573  a`` file is pres
+0002e3f0: 656e 742c 2065 7370 6563 6961 6c6c 7920  ent, especially 
+0002e400: 7768 656e 2072 6561 6469 6e67 0a20 2020  when reading.   
+0002e410: 2020 2020 2066 726f 6d20 7265 6d6f 7465       from remote
+0002e420: 2073 746f 7261 6765 2e20 5365 7420 7468   storage. Set th
+0002e430: 6973 2074 6f20 6060 5472 7565 6060 206f  is to ``True`` o
+0002e440: 6e6c 7920 7768 656e 206b 6e6f 776e 2064  nly when known d
+0002e450: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
+0002e460: 2061 7265 206e 6565 6465 6420 666f 7220   are needed for 
+0002e470: 796f 7572 2077 6f72 6b6c 6f61 6420 2873  your workload (s
+0002e480: 6565 203a 7265 663a 6064 6174 6166 7261  ee :ref:`datafra
+0002e490: 6d65 2d64 6573 6967 6e2d 7061 7274 6974  me-design-partit
+0002e4a0: 696f 6e73 6029 2e0a 2020 2020 6967 6e6f  ions`)..    igno
+0002e4b0: 7265 5f6d 6574 6164 6174 615f 6669 6c65  re_metadata_file
+0002e4c0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0002e4d0: 2046 616c 7365 0a20 2020 2020 2020 2057   False.        W
+0002e4e0: 6865 7468 6572 2074 6f20 6967 6e6f 7265  hether to ignore
+0002e4f0: 2074 6865 2067 6c6f 6261 6c20 6060 5f6d   the global ``_m
+0002e500: 6574 6164 6174 6160 6020 6669 6c65 2028  etadata`` file (
+0002e510: 7768 656e 206f 6e65 2069 7320 7072 6573  when one is pres
+0002e520: 656e 7429 2e0a 2020 2020 2020 2020 4966  ent)..        If
+0002e530: 2060 6054 7275 6560 602c 206f 7220 6966   ``True``, or if
+0002e540: 2074 6865 2067 6c6f 6261 6c20 6060 5f6d   the global ``_m
+0002e550: 6574 6164 6174 6160 6020 6669 6c65 2069  etadata`` file i
+0002e560: 7320 6d69 7373 696e 672c 2074 6865 2070  s missing, the p
+0002e570: 6172 7175 6574 0a20 2020 2020 2020 206d  arquet.        m
+0002e580: 6574 6164 6174 6120 6d61 7920 6265 2067  etadata may be g
+0002e590: 6174 6865 7265 6420 616e 6420 7072 6f63  athered and proc
+0002e5a0: 6573 7365 6420 696e 2070 6172 616c 6c65  essed in paralle
+0002e5b0: 6c2e 2050 6172 616c 6c65 6c20 6d65 7461  l. Parallel meta
+0002e5c0: 6461 7461 0a20 2020 2020 2020 2070 726f  data.        pro
+0002e5d0: 6365 7373 696e 6720 6973 2063 7572 7265  cessing is curre
+0002e5e0: 6e74 6c79 2073 7570 706f 7274 6564 2066  ntly supported f
+0002e5f0: 6f72 2060 6041 7272 6f77 4461 7461 7365  or ``ArrowDatase
+0002e600: 7445 6e67 696e 6560 6020 6f6e 6c79 2e0a  tEngine`` only..
+0002e610: 2020 2020 6d65 7461 6461 7461 5f74 6173      metadata_tas
+0002e620: 6b5f 7369 7a65 203a 2069 6e74 2c20 6465  k_size : int, de
+0002e630: 6661 756c 7420 636f 6e66 6967 7572 6162  fault configurab
+0002e640: 6c65 0a20 2020 2020 2020 2049 6620 7061  le.        If pa
+0002e650: 7271 7565 7420 6d65 7461 6461 7461 2069  rquet metadata i
+0002e660: 7320 7072 6f63 6573 7365 6420 696e 2070  s processed in p
+0002e670: 6172 616c 6c65 6c20 2873 6565 2060 6069  arallel (see ``i
+0002e680: 676e 6f72 655f 6d65 7461 6461 7461 5f66  gnore_metadata_f
+0002e690: 696c 6560 600a 2020 2020 2020 2020 6465  ile``.        de
+0002e6a0: 7363 7269 7074 696f 6e20 6162 6f76 6529  scription above)
+0002e6b0: 2c20 7468 6973 2061 7267 756d 656e 7420  , this argument 
+0002e6c0: 6361 6e20 6265 2075 7365 6420 746f 2073  can be used to s
+0002e6d0: 7065 6369 6679 2074 6865 206e 756d 6265  pecify the numbe
+0002e6e0: 7220 6f66 0a20 2020 2020 2020 2064 6174  r of.        dat
+0002e6f0: 6173 6574 2066 696c 6573 2074 6f20 6265  aset files to be
+0002e700: 2070 726f 6365 7373 6564 2062 7920 6561   processed by ea
+0002e710: 6368 2074 6173 6b20 696e 2074 6865 2044  ch task in the D
+0002e720: 6173 6b20 6772 6170 682e 2020 4966 2074  ask graph.  If t
+0002e730: 6869 730a 2020 2020 2020 2020 6172 6775  his.        argu
+0002e740: 6d65 6e74 2069 7320 7365 7420 746f 2060  ment is set to `
+0002e750: 6030 6060 2c20 7061 7261 6c6c 656c 206d  `0``, parallel m
+0002e760: 6574 6164 6174 6120 7072 6f63 6573 7369  etadata processi
+0002e770: 6e67 2077 696c 6c20 6265 2064 6973 6162  ng will be disab
+0002e780: 6c65 642e 0a20 2020 2020 2020 2054 6865  led..        The
+0002e790: 2064 6566 6175 6c74 2076 616c 7565 7320   default values 
+0002e7a0: 666f 7220 6c6f 6361 6c20 616e 6420 7265  for local and re
+0002e7b0: 6d6f 7465 2066 696c 6573 7973 7465 6d73  mote filesystems
+0002e7c0: 2063 616e 2062 6520 7370 6563 6966 6965   can be specifie
+0002e7d0: 640a 2020 2020 2020 2020 7769 7468 2074  d.        with t
+0002e7e0: 6865 2022 6d65 7461 6461 7461 2d74 6173  he "metadata-tas
+0002e7f0: 6b2d 7369 7a65 2d6c 6f63 616c 2220 616e  k-size-local" an
+0002e800: 6420 226d 6574 6164 6174 612d 7461 736b  d "metadata-task
+0002e810: 2d73 697a 652d 7265 6d6f 7465 220a 2020  -size-remote".  
+0002e820: 2020 2020 2020 636f 6e66 6967 2066 6965        config fie
+0002e830: 6c64 732c 2072 6573 7065 6374 6976 656c  lds, respectivel
+0002e840: 7920 2873 6565 2022 6461 7461 6672 616d  y (see "datafram
+0002e850: 652e 7061 7271 7565 7422 292e 0a20 2020  e.parquet")..   
+0002e860: 2073 706c 6974 5f72 6f77 5f67 726f 7570   split_row_group
+0002e870: 7320 3a20 2769 6e66 6572 272c 2027 6164  s : 'infer', 'ad
+0002e880: 6170 7469 7665 272c 2062 6f6f 6c2c 206f  aptive', bool, o
+0002e890: 7220 696e 742c 2064 6566 6175 6c74 2027  r int, default '
+0002e8a0: 696e 6665 7227 0a20 2020 2020 2020 2049  infer'.        I
+0002e8b0: 6620 5472 7565 2c20 7468 656e 2065 6163  f True, then eac
+0002e8c0: 6820 6f75 7470 7574 2064 6174 6166 7261  h output datafra
+0002e8d0: 6d65 2070 6172 7469 7469 6f6e 2077 696c  me partition wil
+0002e8e0: 6c20 636f 7272 6573 706f 6e64 2074 6f20  l correspond to 
+0002e8f0: 6120 7369 6e67 6c65 0a20 2020 2020 2020  a single.       
+0002e900: 2070 6172 7175 6574 2d66 696c 6520 726f   parquet-file ro
+0002e910: 772d 6772 6f75 702e 2049 6620 4661 6c73  w-group. If Fals
+0002e920: 652c 2065 6163 6820 7061 7274 6974 696f  e, each partitio
+0002e930: 6e20 7769 6c6c 2063 6f72 7265 7370 6f6e  n will correspon
+0002e940: 6420 746f 2061 0a20 2020 2020 2020 2063  d to a.        c
+0002e950: 6f6d 706c 6574 6520 6669 6c65 2e20 2049  omplete file.  I
+0002e960: 6620 6120 706f 7369 7469 7665 2069 6e74  f a positive int
+0002e970: 6567 6572 2076 616c 7565 2069 7320 6769  eger value is gi
+0002e980: 7665 6e2c 2065 6163 6820 6461 7461 6672  ven, each datafr
+0002e990: 616d 650a 2020 2020 2020 2020 7061 7274  ame.        part
+0002e9a0: 6974 696f 6e20 7769 6c6c 2063 6f72 7265  ition will corre
+0002e9b0: 7370 6f6e 6420 746f 2074 6861 7420 6e75  spond to that nu
+0002e9c0: 6d62 6572 206f 6620 7061 7271 7565 7420  mber of parquet 
+0002e9d0: 726f 772d 6772 6f75 7073 2028 6f72 2066  row-groups (or f
+0002e9e0: 6577 6572 292e 0a20 2020 2020 2020 2049  ewer)..        I
+0002e9f0: 6620 2761 6461 7074 6976 6527 2c20 7468  f 'adaptive', th
+0002ea00: 6520 6d65 7461 6461 7461 206f 6620 6561  e metadata of ea
+0002ea10: 6368 2066 696c 6520 7769 6c6c 2062 6520  ch file will be 
+0002ea20: 7573 6564 2074 6f20 656e 7375 7265 2074  used to ensure t
+0002ea30: 6861 7420 6576 6572 790a 2020 2020 2020  hat every.      
+0002ea40: 2020 7061 7274 6974 696f 6e20 7361 7469    partition sati
+0002ea50: 7366 6965 7320 6060 626c 6f63 6b73 697a  sfies ``blocksiz
+0002ea60: 6560 602e 2049 6620 2769 6e66 6572 2720  e``. If 'infer' 
+0002ea70: 2874 6865 2064 6566 6175 6c74 292c 2074  (the default), t
+0002ea80: 6865 0a20 2020 2020 2020 2075 6e63 6f6d  he.        uncom
+0002ea90: 7072 6573 7365 6420 7374 6f72 6167 652d  pressed storage-
+0002eaa0: 7369 7a65 206d 6574 6164 6174 6120 696e  size metadata in
+0002eab0: 2074 6865 2066 6972 7374 2066 696c 6520   the first file 
+0002eac0: 7769 6c6c 2062 6520 7573 6564 2074 6f0a  will be used to.
+0002ead0: 2020 2020 2020 2020 6175 746f 6d61 7469          automati
+0002eae0: 6361 6c6c 7920 7365 7420 6060 7370 6c69  cally set ``spli
+0002eaf0: 745f 726f 775f 6772 6f75 7073 6060 2074  t_row_groups`` t
+0002eb00: 6f20 6569 7468 6572 2027 6164 6170 7469  o either 'adapti
+0002eb10: 7665 2720 6f72 2060 6046 616c 7365 6060  ve' or ``False``
+0002eb20: 2e0a 2020 2020 626c 6f63 6b73 697a 6520  ..    blocksize 
+0002eb30: 3a20 696e 7420 6f72 2073 7472 2c20 6465  : int or str, de
+0002eb40: 6661 756c 7420 2764 6566 6175 6c74 270a  fault 'default'.
+0002eb50: 2020 2020 2020 2020 5468 6520 6465 7369          The desi
+0002eb60: 7265 6420 7369 7a65 206f 6620 6561 6368  red size of each
+0002eb70: 206f 7574 7075 7420 6060 4461 7461 4672   output ``DataFr
+0002eb80: 616d 6560 6020 7061 7274 6974 696f 6e20  ame`` partition 
+0002eb90: 696e 2074 6572 6d73 206f 6620 746f 7461  in terms of tota
+0002eba0: 6c0a 2020 2020 2020 2020 2875 6e63 6f6d  l.        (uncom
+0002ebb0: 7072 6573 7365 6429 2070 6172 7175 6574  pressed) parquet
+0002ebc0: 2073 746f 7261 6765 2073 7061 6365 2e20   storage space. 
+0002ebd0: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
+0002ebe0: 2063 7572 7265 6e74 6c79 2075 7365 6420   currently used 
+0002ebf0: 746f 0a20 2020 2020 2020 2073 6574 2074  to.        set t
+0002ec00: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0002ec10: 206f 6620 6060 7370 6c69 745f 726f 775f   of ``split_row_
+0002ec20: 6772 6f75 7073 6060 2028 7573 696e 6720  groups`` (using 
+0002ec30: 726f 772d 6772 6f75 7020 6d65 7461 6461  row-group metada
+0002ec40: 7461 0a20 2020 2020 2020 2066 726f 6d20  ta.        from 
+0002ec50: 6120 7369 6e67 6c65 2066 696c 6529 2c20  a single file), 
+0002ec60: 616e 6420 7769 6c6c 2062 6520 6967 6e6f  and will be igno
+0002ec70: 7265 6420 6966 2060 6073 706c 6974 5f72  red if ``split_r
+0002ec80: 6f77 5f67 726f 7570 7360 6020 6973 206e  ow_groups`` is n
+0002ec90: 6f74 0a20 2020 2020 2020 2073 6574 2074  ot.        set t
+0002eca0: 6f20 2769 6e66 6572 2720 6f72 2027 6164  o 'infer' or 'ad
+0002ecb0: 6170 7469 7665 272e 2044 6566 6175 6c74  aptive'. Default
+0002ecc0: 2069 7320 3235 3620 4d69 422e 0a20 2020   is 256 MiB..   
+0002ecd0: 2061 6767 7265 6761 7465 5f66 696c 6573   aggregate_files
+0002ece0: 203a 2062 6f6f 6c20 6f72 2073 7472 2c20   : bool or str, 
+0002ecf0: 6465 6661 756c 7420 4e6f 6e65 0a20 2020  default None.   
+0002ed00: 2020 2020 2057 4152 4e49 4e47 3a20 5061       WARNING: Pa
+0002ed10: 7373 696e 6720 6120 7374 7269 6e67 2061  ssing a string a
+0002ed20: 7267 756d 656e 7420 746f 2060 6061 6767  rgument to ``agg
+0002ed30: 7265 6761 7465 5f66 696c 6573 6060 2077  regate_files`` w
+0002ed40: 696c 6c20 7265 7375 6c74 0a20 2020 2020  ill result.     
+0002ed50: 2020 2069 6e20 6578 7065 7269 6d65 6e74     in experiment
+0002ed60: 616c 2062 6568 6176 696f 722e 2054 6869  al behavior. Thi
+0002ed70: 7320 6265 6861 7669 6f72 206d 6179 2063  s behavior may c
+0002ed80: 6861 6e67 6520 696e 2074 6865 2066 7574  hange in the fut
+0002ed90: 7572 652e 0a0a 2020 2020 2020 2020 5768  ure...        Wh
+0002eda0: 6574 6865 7220 6469 7374 696e 6374 2066  ether distinct f
+0002edb0: 696c 6520 7061 7468 7320 6d61 7920 6265  ile paths may be
+0002edc0: 2061 6767 7265 6761 7465 6420 696e 746f   aggregated into
+0002edd0: 2074 6865 2073 616d 6520 6f75 7470 7574   the same output
+0002ede0: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+0002edf0: 6f6e 2e20 5468 6973 2070 6172 616d 6574  on. This paramet
+0002ee00: 6572 2069 7320 6f6e 6c79 2075 7365 6420  er is only used 
+0002ee10: 7768 656e 2060 7370 6c69 745f 726f 775f  when `split_row_
+0002ee20: 6772 6f75 7073 6020 6973 2073 6574 2074  groups` is set t
+0002ee30: 6f0a 2020 2020 2020 2020 2769 6e66 6572  o.        'infer
+0002ee40: 272c 2027 6164 6170 7469 7665 2720 6f72  ', 'adaptive' or
+0002ee50: 2074 6f20 616e 2069 6e74 6567 6572 203e   to an integer >
+0002ee60: 312e 2041 2073 6574 7469 6e67 206f 6620  1. A setting of 
+0002ee70: 5472 7565 206d 6561 6e73 2074 6861 7420  True means that 
+0002ee80: 616e 790a 2020 2020 2020 2020 7477 6f20  any.        two 
+0002ee90: 6669 6c65 2070 6174 6873 206d 6179 2062  file paths may b
+0002eea0: 6520 6167 6772 6567 6174 6564 2069 6e74  e aggregated int
+0002eeb0: 6f20 7468 6520 7361 6d65 206f 7574 7075  o the same outpu
+0002eec0: 7420 7061 7274 6974 696f 6e2c 2077 6869  t partition, whi
+0002eed0: 6c65 0a20 2020 2020 2020 2046 616c 7365  le.        False
+0002eee0: 206d 6561 6e73 2074 6861 7420 696e 7465   means that inte
+0002eef0: 722d 6669 6c65 2061 6767 7265 6761 7469  r-file aggregati
+0002ef00: 6f6e 2069 7320 7072 6f68 6962 6974 6564  on is prohibited
+0002ef10: 2e0a 0a20 2020 2020 2020 2046 6f72 2022  ...        For "
+0002ef20: 6869 7665 2d70 6172 7469 7469 6f6e 6564  hive-partitioned
+0002ef30: 2220 6461 7461 7365 7473 2c20 6120 2270  " datasets, a "p
+0002ef40: 6172 7469 7469 6f6e 222d 636f 6c75 6d6e  artition"-column
+0002ef50: 206e 616d 6520 6361 6e20 616c 736f 2062   name can also b
+0002ef60: 650a 2020 2020 2020 2020 7370 6563 6966  e.        specif
+0002ef70: 6965 642e 2049 6e20 7468 6973 2063 6173  ied. In this cas
+0002ef80: 652c 2077 6520 616c 6c6f 7720 7468 6520  e, we allow the 
+0002ef90: 6167 6772 6567 6174 696f 6e20 6f66 2061  aggregation of a
+0002efa0: 6e79 2074 776f 2066 696c 6573 0a20 2020  ny two files.   
+0002efb0: 2020 2020 2073 6861 7269 6e67 2061 2066       sharing a f
+0002efc0: 696c 6520 7061 7468 2075 7020 746f 2c20  ile path up to, 
+0002efd0: 616e 6420 696e 636c 7564 696e 672c 2074  and including, t
+0002efe0: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+0002eff0: 2064 6972 6563 746f 7279 206e 616d 652e   directory name.
+0002f000: 0a20 2020 2020 2020 2046 6f72 2065 7861  .        For exa
+0002f010: 6d70 6c65 2c20 6966 2060 6061 6767 7265  mple, if ``aggre
+0002f020: 6761 7465 5f66 696c 6573 6060 2069 7320  gate_files`` is 
+0002f030: 7365 7420 746f 2060 6022 7365 6374 696f  set to ``"sectio
+0002f040: 6e22 6060 2066 6f72 2074 6865 0a20 2020  n"`` for the.   
+0002f050: 2020 2020 2064 6972 6563 746f 7279 2073       directory s
+0002f060: 7472 7563 7475 7265 2062 656c 6f77 2c20  tructure below, 
+0002f070: 6060 3033 2e70 6172 7175 6574 6060 2061  ``03.parquet`` a
+0002f080: 6e64 2060 6030 342e 7061 7271 7565 7460  nd ``04.parquet`
+0002f090: 6020 6d61 7920 6265 0a20 2020 2020 2020  ` may be.       
+0002f0a0: 2061 6767 7265 6761 7465 6420 746f 6765   aggregated toge
+0002f0b0: 7468 6572 2c20 6275 7420 6060 3031 2e70  ther, but ``01.p
+0002f0c0: 6172 7175 6574 6060 2061 6e64 2060 6030  arquet`` and ``0
+0002f0d0: 322e 7061 7271 7565 7460 6020 6361 6e6e  2.parquet`` cann
+0002f0e0: 6f74 2062 652e 0a20 2020 2020 2020 2049  ot be..        I
+0002f0f0: 662c 2068 6f77 6576 6572 2c20 6060 6167  f, however, ``ag
+0002f100: 6772 6567 6174 655f 6669 6c65 7360 6020  gregate_files`` 
+0002f110: 6973 2073 6574 2074 6f20 6060 2272 6567  is set to ``"reg
+0002f120: 696f 6e22 6060 2c20 6060 3031 2e70 6172  ion"``, ``01.par
+0002f130: 7175 6574 6060 0a20 2020 2020 2020 206d  quet``.        m
+0002f140: 6179 2062 6520 6167 6772 6567 6174 6564  ay be aggregated
+0002f150: 2077 6974 6820 6060 3032 2e70 6172 7175   with ``02.parqu
+0002f160: 6574 6060 2c20 616e 6420 6060 3033 2e70  et``, and ``03.p
+0002f170: 6172 7175 6574 6060 206d 6179 2062 6520  arquet`` may be 
+0002f180: 6167 6772 6567 6174 6564 0a20 2020 2020  aggregated.     
+0002f190: 2020 2077 6974 6820 6060 3034 2e70 6172     with ``04.par
+0002f1a0: 7175 6574 6060 3a3a 0a0a 2020 2020 2020  quet``::..      
+0002f1b0: 2020 2020 2020 6461 7461 7365 742d 7061        dataset-pa
+0002f1c0: 7468 2f0a 2020 2020 2020 2020 2020 2020  th/.            
+0002f1d0: e294 9ce2 9480 e294 8020 7265 6769 6f6e  ......... region
+0002f1e0: 3d31 2f0a 2020 2020 2020 2020 2020 2020  =1/.            
+0002f1f0: e294 8220 2020 e294 9ce2 9480 e294 8020  ...   ......... 
+0002f200: 7365 6374 696f 6e3d 612f 0a20 2020 2020  section=a/.     
+0002f210: 2020 2020 2020 20e2 9482 2020 20e2 9482         ...   ...
+0002f220: 2020 20e2 9494 e294 80e2 9480 2030 312e     ......... 01.
+0002f230: 7061 7271 7565 740a 2020 2020 2020 2020  parquet.        
+0002f240: 2020 2020 e294 8220 2020 e294 9ce2 9480      ...   ......
+0002f250: e294 8020 7365 6374 696f 6e3d 622f 0a20  ... section=b/. 
+0002f260: 2020 2020 2020 2020 2020 20e2 9482 2020             ...  
+0002f270: 20e2 9494 e294 80e2 9480 20e2 9494 e294   ......... .....
+0002f280: 80e2 9480 2030 322e 7061 7271 7565 740a  .... 02.parquet.
+0002f290: 2020 2020 2020 2020 2020 2020 e294 94e2              ....
+0002f2a0: 9480 e294 8020 7265 6769 6f6e 3d32 2f0a  ..... region=2/.
+0002f2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f2c0: e294 9ce2 9480 e294 8020 7365 6374 696f  ......... sectio
+0002f2d0: 6e3d 612f 0a20 2020 2020 2020 2020 2020  n=a/.           
+0002f2e0: 2020 2020 20e2 9482 2020 20e2 949c e294       ...   .....
+0002f2f0: 80e2 9480 2030 332e 7061 7271 7565 740a  .... 03.parquet.
+0002f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f310: e294 94e2 9480 e294 8020 e294 94e2 9480  ......... ......
+0002f320: e294 8020 3034 2e70 6172 7175 6574 0a0a  ... 04.parquet..
+0002f330: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
+0002f340: 7420 7468 6520 6465 6661 756c 7420 6265  t the default be
+0002f350: 6861 7669 6f72 206f 6620 6060 6167 6772  havior of ``aggr
+0002f360: 6567 6174 655f 6669 6c65 7360 6020 6973  egate_files`` is
+0002f370: 2060 6046 616c 7365 6060 2e0a 2020 2020   ``False``..    
+0002f380: 7061 7271 7565 745f 6669 6c65 5f65 7874  parquet_file_ext
+0002f390: 656e 7369 6f6e 3a20 7374 722c 2074 7570  ension: str, tup
+0002f3a0: 6c65 5b73 7472 5d2c 206f 7220 4e6f 6e65  le[str], or None
+0002f3b0: 2c20 6465 6661 756c 7420 2822 2e70 6172  , default (".par
+0002f3c0: 7122 2c20 222e 7061 7271 7565 7422 2c20  q", ".parquet", 
+0002f3d0: 222e 7071 2229 0a20 2020 2020 2020 2041  ".pq").        A
+0002f3e0: 2066 696c 6520 6578 7465 6e73 696f 6e20   file extension 
+0002f3f0: 6f72 2061 6e20 6974 6572 6162 6c65 206f  or an iterable o
+0002f400: 6620 6578 7465 6e73 696f 6e73 2074 6f20  f extensions to 
+0002f410: 7573 6520 7768 656e 2064 6973 636f 7665  use when discove
+0002f420: 7269 6e67 0a20 2020 2020 2020 2070 6172  ring.        par
+0002f430: 7175 6574 2066 696c 6573 2069 6e20 6120  quet files in a 
+0002f440: 6469 7265 6374 6f72 792e 2046 696c 6573  directory. Files
+0002f450: 2074 6861 7420 646f 6e27 7420 6d61 7463   that don't matc
+0002f460: 6820 7468 6573 6520 6578 7465 6e73 696f  h these extensio
+0002f470: 6e73 0a20 2020 2020 2020 2077 696c 6c20  ns.        will 
+0002f480: 6265 2069 676e 6f72 6564 2e20 5468 6973  be ignored. This
+0002f490: 2061 7267 756d 656e 7420 6f6e 6c79 2061   argument only a
+0002f4a0: 7070 6c69 6573 2077 6865 6e20 6060 7061  pplies when ``pa
+0002f4b0: 7468 7360 6020 636f 7272 6573 706f 6e64  ths`` correspond
+0002f4c0: 730a 2020 2020 2020 2020 746f 2061 2064  s.        to a d
+0002f4d0: 6972 6563 746f 7279 2061 6e64 206e 6f20  irectory and no 
+0002f4e0: 6060 5f6d 6574 6164 6174 6160 6020 6669  ``_metadata`` fi
+0002f4f0: 6c65 2069 7320 7072 6573 656e 7420 286f  le is present (o
+0002f500: 720a 2020 2020 2020 2020 6060 6967 6e6f  r.        ``igno
+0002f510: 7265 5f6d 6574 6164 6174 615f 6669 6c65  re_metadata_file
+0002f520: 3d54 7275 6560 6029 2e20 5061 7373 696e  =True``). Passin
+0002f530: 6720 696e 2060 6070 6172 7175 6574 5f66  g in ``parquet_f
+0002f540: 696c 655f 6578 7465 6e73 696f 6e3d 4e6f  ile_extension=No
+0002f550: 6e65 6060 0a20 2020 2020 2020 2077 696c  ne``.        wil
+0002f560: 6c20 7472 6561 7420 616c 6c20 6669 6c65  l treat all file
+0002f570: 7320 696e 2074 6865 2064 6972 6563 746f  s in the directo
+0002f580: 7279 2061 7320 7061 7271 7565 7420 6669  ry as parquet fi
+0002f590: 6c65 732e 0a0a 2020 2020 2020 2020 5468  les...        Th
+0002f5a0: 6520 7075 7270 6f73 6520 6f66 2074 6869  e purpose of thi
+0002f5b0: 7320 6172 6775 6d65 6e74 2069 7320 746f  s argument is to
+0002f5c0: 2065 6e73 7572 6520 7468 6174 2074 6865   ensure that the
+0002f5d0: 2065 6e67 696e 6520 7769 6c6c 2069 676e   engine will ign
+0002f5e0: 6f72 650a 2020 2020 2020 2020 756e 7375  ore.        unsu
+0002f5f0: 7070 6f72 7465 6420 6d65 7461 6461 7461  pported metadata
+0002f600: 2066 696c 6573 2028 6c69 6b65 2053 7061   files (like Spa
+0002f610: 726b 2773 2027 5f53 5543 4345 5353 2720  rk's '_SUCCESS' 
+0002f620: 616e 6420 2763 7263 2720 6669 6c65 7329  and 'crc' files)
+0002f630: 2e0a 2020 2020 2020 2020 4974 206d 6179  ..        It may
+0002f640: 2062 6520 6e65 6365 7373 6172 7920 746f   be necessary to
+0002f650: 2063 6861 6e67 6520 7468 6973 2061 7267   change this arg
+0002f660: 756d 656e 7420 6966 2074 6865 2064 6174  ument if the dat
+0002f670: 6120 6669 6c65 7320 696e 2079 6f75 720a  a files in your.
+0002f680: 2020 2020 2020 2020 7061 7271 7565 7420          parquet 
+0002f690: 6461 7461 7365 7420 646f 206e 6f74 2065  dataset do not e
+0002f6a0: 6e64 2069 6e20 222e 7061 7271 222c 2022  nd in ".parq", "
+0002f6b0: 2e70 6172 7175 6574 222c 206f 7220 222e  .parquet", or ".
+0002f6c0: 7071 222e 0a20 2020 2066 696c 6573 7973  pq"..    filesys
+0002f6d0: 7465 6d3a 2022 6673 7370 6563 222c 2022  tem: "fsspec", "
+0002f6e0: 6172 726f 7722 2c20 6f72 2066 7373 7065  arrow", or fsspe
+0002f6f0: 632e 4162 7374 7261 6374 4669 6c65 5379  c.AbstractFileSy
+0002f700: 7374 656d 2062 6163 6b65 6e64 2074 6f20  stem backend to 
+0002f710: 7573 652e 0a20 2020 2064 6174 6173 6574  use..    dataset
+0002f720: 3a20 6469 6374 2c20 6465 6661 756c 7420  : dict, default 
+0002f730: 4e6f 6e65 0a20 2020 2020 2020 2044 6963  None.        Dic
+0002f740: 7469 6f6e 6172 7920 6f66 206f 7074 696f  tionary of optio
+0002f750: 6e73 2074 6f20 7573 6520 7768 656e 2063  ns to use when c
+0002f760: 7265 6174 696e 6720 6120 6060 7079 6172  reating a ``pyar
+0002f770: 726f 772e 6461 7461 7365 742e 4461 7461  row.dataset.Data
+0002f780: 7365 7460 6020 6f62 6a65 6374 2e0a 2020  set`` object..  
+0002f790: 2020 2020 2020 5468 6573 6520 6f70 7469        These opti
+0002f7a0: 6f6e 7320 6d61 7920 696e 636c 7564 6520  ons may include 
+0002f7b0: 6120 2266 696c 6573 7973 7465 6d22 206b  a "filesystem" k
+0002f7c0: 6579 2074 6f20 636f 6e66 6967 7572 6520  ey to configure 
+0002f7d0: 7468 6520 6465 7369 7265 640a 2020 2020  the desired.    
+0002f7e0: 2020 2020 6669 6c65 2d73 7973 7465 6d20      file-system 
+0002f7f0: 6261 636b 656e 642e 2048 6f77 6576 6572  backend. However
+0002f800: 2c20 7468 6520 746f 702d 6c65 7665 6c20  , the top-level 
+0002f810: 6060 6669 6c65 7379 7374 656d 6060 2061  ``filesystem`` a
+0002f820: 7267 756d 656e 7420 7769 6c6c 2061 6c77  rgument will alw
+0002f830: 6179 730a 2020 2020 2020 2020 7461 6b65  ays.        take
+0002f840: 2070 7265 6365 6465 6e63 652e 0a0a 2020   precedence...  
+0002f850: 2020 2020 2020 2a2a 4e6f 7465 2a2a 3a20        **Note**: 
+0002f860: 5468 6520 6060 6461 7461 7365 7460 6020  The ``dataset`` 
+0002f870: 6f70 7469 6f6e 7320 6d61 7920 696e 636c  options may incl
+0002f880: 7564 6520 6120 2270 6172 7469 7469 6f6e  ude a "partition
+0002f890: 696e 6722 206b 6579 2e0a 2020 2020 2020  ing" key..      
+0002f8a0: 2020 486f 7765 7665 722c 2073 696e 6365    However, since
+0002f8b0: 2060 6070 7961 7272 6f77 2e64 6174 6173   ``pyarrow.datas
+0002f8c0: 6574 2e50 6172 7469 7469 6f6e 696e 6760  et.Partitioning`
+0002f8d0: 600a 2020 2020 2020 2020 6f62 6a65 6374  `.        object
+0002f8e0: 7320 6361 6e6e 6f74 2062 6520 7365 7269  s cannot be seri
+0002f8f0: 616c 697a 6564 2c20 7468 6520 7661 6c75  alized, the valu
+0002f900: 6520 6361 6e20 6265 2061 2064 6963 7420  e can be a dict 
+0002f910: 6f66 206b 6579 2d77 6f72 640a 2020 2020  of key-word.    
+0002f920: 2020 2020 6172 6775 6d65 6e74 7320 666f      arguments fo
+0002f930: 7220 7468 6520 6060 7079 6172 726f 772e  r the ``pyarrow.
+0002f940: 6461 7461 7365 742e 7061 7274 6974 696f  dataset.partitio
+0002f950: 6e69 6e67 6060 2041 5049 0a20 2020 2020  ning`` API.     
+0002f960: 2020 2028 652e 672e 2060 6064 6174 6173     (e.g. ``datas
+0002f970: 6574 3d7b 2270 6172 7469 7469 6f6e 696e  et={"partitionin
+0002f980: 6722 3a20 7b22 666c 6176 6f72 223a 2022  g": {"flavor": "
+0002f990: 6869 7665 222c 2022 7363 6865 6d61 223a  hive", "schema":
+0002f9a0: 202e 2e2e 7d7d 6060 292e 0a20 2020 2020   ...}}``)..     
+0002f9b0: 2020 204e 6f74 6520 7468 6174 2070 6172     Note that par
+0002f9c0: 7469 7469 6f6e 6564 2063 6f6c 756d 6e73  titioned columns
+0002f9d0: 2077 696c 6c20 6e6f 7420 6265 2063 6f6e   will not be con
+0002f9e0: 7665 7274 6564 2074 6f20 6361 7465 676f  verted to catego
+0002f9f0: 7269 6361 6c0a 2020 2020 2020 2020 6474  rical.        dt
+0002fa00: 7970 6573 2077 6865 6e20 6120 6375 7374  ypes when a cust
+0002fa10: 6f6d 2070 6172 7469 7469 6f6e 696e 6720  om partitioning 
+0002fa20: 7363 6865 6d61 2069 7320 7370 6563 6966  schema is specif
+0002fa30: 6965 6420 696e 2074 6869 7320 7761 792e  ied in this way.
+0002fa40: 0a20 2020 2072 6561 643a 2064 6963 742c  .    read: dict,
+0002fa50: 2064 6566 6175 6c74 204e 6f6e 650a 2020   default None.  
+0002fa60: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+0002fa70: 206f 6620 6f70 7469 6f6e 7320 746f 2070   of options to p
+0002fa80: 6173 7320 7468 726f 7567 6820 746f 2060  ass through to `
+0002fa90: 6065 6e67 696e 652e 7265 6164 5f70 6172  `engine.read_par
+0002faa0: 7469 7469 6f6e 7360 600a 2020 2020 2020  titions``.      
+0002fab0: 2020 7573 696e 6720 7468 6520 6060 7265    using the ``re
+0002fac0: 6164 6060 206b 6579 2d77 6f72 6420 6172  ad`` key-word ar
+0002fad0: 6775 6d65 6e74 2e0a 2020 2020 6172 726f  gument..    arro
+0002fae0: 775f 746f 5f70 616e 6461 733a 2064 6963  w_to_pandas: dic
+0002faf0: 742c 2064 6566 6175 6c74 204e 6f6e 650a  t, default None.
+0002fb00: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
+0002fb10: 7279 206f 6620 6f70 7469 6f6e 7320 746f  ry of options to
+0002fb20: 2075 7365 2077 6865 6e20 636f 6e76 6572   use when conver
+0002fb30: 7469 6e67 2066 726f 6d20 6060 7079 6172  ting from ``pyar
+0002fb40: 726f 772e 5461 626c 6560 6020 746f 0a20  row.Table`` to. 
+0002fb50: 2020 2020 2020 2061 2070 616e 6461 7320         a pandas 
+0002fb60: 6060 4461 7461 4672 616d 6560 6020 6f62  ``DataFrame`` ob
+0002fb70: 6a65 6374 2e20 4f6e 6c79 2075 7365 6420  ject. Only used 
+0002fb80: 6279 2074 6865 2022 6172 726f 7722 2065  by the "arrow" e
+0002fb90: 6e67 696e 652e 0a20 2020 202a 2a6b 7761  ngine..    **kwa
+0002fba0: 7267 733a 2064 6963 7420 286f 6620 6469  rgs: dict (of di
+0002fbb0: 6374 7329 0a20 2020 2020 2020 204f 7074  cts).        Opt
+0002fbc0: 696f 6e73 2074 6f20 7061 7373 2074 6872  ions to pass thr
+0002fbd0: 6f75 6768 2074 6f20 6060 656e 6769 6e65  ough to ``engine
+0002fbe0: 2e72 6561 645f 7061 7274 6974 696f 6e73  .read_partitions
+0002fbf0: 6060 2061 7320 7374 616e 642d 616c 6f6e  `` as stand-alon
+0002fc00: 650a 2020 2020 2020 2020 6b65 792d 776f  e.        key-wo
+0002fc10: 7264 2061 7267 756d 656e 7473 2e20 4e6f  rd arguments. No
+0002fc20: 7465 2074 6861 7420 7468 6573 6520 6f70  te that these op
+0002fc30: 7469 6f6e 7320 7769 6c6c 2062 6520 6967  tions will be ig
+0002fc40: 6e6f 7265 6420 6279 2074 6865 0a20 2020  nored by the.   
+0002fc50: 2020 2020 2065 6e67 696e 6573 2064 6566       engines def
+0002fc60: 696e 6564 2069 6e20 6060 6461 736b 2e64  ined in ``dask.d
+0002fc70: 6174 6166 7261 6d65 6060 2c20 6275 7420  ataframe``, but 
+0002fc80: 6d61 7920 6265 2075 7365 6420 6279 206f  may be used by o
+0002fc90: 7468 6572 2063 7573 746f 6d0a 2020 2020  ther custom.    
+0002fca0: 2020 2020 696d 706c 656d 656e 7461 7469      implementati
+0002fcb0: 6f6e 732e 0a0a 2020 2020 4578 616d 706c  ons...    Exampl
+0002fcc0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+0002fcd0: 2020 2020 3e3e 3e20 6466 203d 2064 642e      >>> df = dd.
+0002fce0: 7265 6164 5f70 6172 7175 6574 2827 7333  read_parquet('s3
+0002fcf0: 3a2f 2f62 7563 6b65 742f 6d79 2d70 6172  ://bucket/my-par
+0002fd00: 7175 6574 2d64 6174 6127 2920 2023 2064  quet-data')  # d
+0002fd10: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
+0002fd20: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+0002fd30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2074 6f5f  --------.    to_
+0002fd40: 7061 7271 7565 740a 2020 2020 7079 6172  parquet.    pyar
+0002fd50: 726f 772e 7061 7271 7565 742e 5061 7271  row.parquet.Parq
+0002fd60: 7565 7444 6174 6173 6574 0a20 2020 2022  uetDataset.    "
+0002fd70: 2222 0a20 2020 2066 726f 6d20 6461 736b  "".    from dask
+0002fd80: 5f65 7870 722e 696f 2e70 6172 7175 6574  _expr.io.parquet
+0002fd90: 2069 6d70 6f72 7420 280a 2020 2020 2020   import (.      
+0002fda0: 2020 5265 6164 5061 7271 7565 7446 5353    ReadParquetFSS
+0002fdb0: 7065 632c 0a20 2020 2020 2020 2052 6561  pec,.        Rea
+0002fdc0: 6450 6172 7175 6574 5079 6172 726f 7746  dParquetPyarrowF
+0002fdd0: 532c 0a20 2020 2020 2020 205f 7365 745f  S,.        _set_
+0002fde0: 7061 7271 7565 745f 656e 6769 6e65 2c0a  parquet_engine,.
+0002fdf0: 2020 2020 290a 0a20 2020 2069 6620 6e6f      )..    if no
+0002fe00: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
+0002fe10: 682c 2073 7472 293a 0a20 2020 2020 2020  h, str):.       
+0002fe20: 2070 6174 6820 3d20 7374 7269 6e67 6966   path = stringif
+0002fe30: 795f 7061 7468 2870 6174 6829 0a0a 2020  y_path(path)..  
+0002fe40: 2020 6b77 6172 6773 5b22 6474 7970 655f    kwargs["dtype_
+0002fe50: 6261 636b 656e 6422 5d20 3d20 6474 7970  backend"] = dtyp
+0002fe60: 655f 6261 636b 656e 640a 2020 2020 6966  e_backend.    if
+0002fe70: 2061 7272 6f77 5f74 6f5f 7061 6e64 6173   arrow_to_pandas
+0002fe80: 3a0a 2020 2020 2020 2020 6b77 6172 6773  :.        kwargs
+0002fe90: 5b22 6172 726f 775f 746f 5f70 616e 6461  ["arrow_to_panda
+0002fea0: 7322 5d20 3d20 6172 726f 775f 746f 5f70  s"] = arrow_to_p
+0002feb0: 616e 6461 730a 0a20 2020 2069 6620 6669  andas..    if fi
+0002fec0: 6c74 6572 7320 6973 206e 6f74 204e 6f6e  lters is not Non
+0002fed0: 653a 0a20 2020 2020 2020 2066 6f72 2066  e:.        for f
+0002fee0: 696c 7465 7220 696e 2066 6c61 7474 656e  ilter in flatten
+0002fef0: 2866 696c 7465 7273 2c20 636f 6e74 6169  (filters, contai
+0002ff00: 6e65 723d 6c69 7374 293a 0a20 2020 2020  ner=list):.     
+0002ff10: 2020 2020 2020 2063 6f6c 2c20 6f70 2c20         col, op, 
+0002ff20: 7661 6c20 3d20 6669 6c74 6572 0a20 2020  val = filter.   
+0002ff30: 2020 2020 2020 2020 2069 6620 6f70 203d           if op =
+0002ff40: 3d20 2269 6e22 2061 6e64 206e 6f74 2069  = "in" and not i
+0002ff50: 7369 6e73 7461 6e63 6528 7661 6c2c 2028  sinstance(val, (
+0002ff60: 7365 742c 206c 6973 742c 2074 7570 6c65  set, list, tuple
+0002ff70: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0002ff80: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0002ff90: 726f 7228 2256 616c 7565 206f 6620 2769  ror("Value of 'i
+0002ffa0: 6e27 2066 696c 7465 7220 6d75 7374 2062  n' filter must b
+0002ffb0: 6520 6120 6c69 7374 2c20 7365 7420 6f72  e a list, set or
+0002ffc0: 2074 7570 6c65 2e22 290a 0a20 2020 2069   tuple.")..    i
+0002ffd0: 6620 280a 2020 2020 2020 2020 6973 696e  f (.        isin
+0002ffe0: 7374 616e 6365 2866 696c 6573 7973 7465  stance(filesyste
+0002fff0: 6d2c 2070 615f 6673 2e46 696c 6553 7973  m, pa_fs.FileSys
+00030000: 7465 6d29 0a20 2020 2020 2020 206f 7220  tem).        or 
+00030010: 6973 696e 7374 616e 6365 2866 696c 6573  isinstance(files
+00030020: 7973 7465 6d2c 2073 7472 290a 2020 2020  ystem, str).    
+00030030: 2020 2020 616e 6420 6669 6c65 7379 7374      and filesyst
+00030040: 656d 2e6c 6f77 6572 2829 2069 6e20 2822  em.lower() in ("
+00030050: 6172 726f 7722 2c20 2270 7961 7272 6f77  arrow", "pyarrow
+00030060: 2229 0a20 2020 2029 3a0a 2020 2020 2020  ").    ):.      
+00030070: 2020 6966 2070 6172 7365 5f76 6572 7369    if parse_versi
+00030080: 6f6e 2870 612e 5f5f 7665 7273 696f 6e5f  on(pa.__version_
+00030090: 5f29 203c 2070 6172 7365 5f76 6572 7369  _) < parse_versi
+000300a0: 6f6e 2822 3135 2e30 2e30 2229 3a0a 2020  on("15.0.0"):.  
+000300b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000300c0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+000300d0: 2020 2020 2020 2020 2020 2020 2270 7961              "pya
+000300e0: 7272 6f77 3e3d 3135 2e30 2e30 2069 7320  rrow>=15.0.0 is 
+000300f0: 7265 7175 6972 6564 2074 6f20 7573 6520  required to use 
+00030100: 7468 6520 7079 6172 726f 7720 6669 6c65  the pyarrow file
+00030110: 7379 7374 656d 2e22 0a20 2020 2020 2020  system.".       
+00030120: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+00030130: 6620 6d65 7461 6461 7461 5f74 6173 6b5f  f metadata_task_
+00030140: 7369 7a65 2069 7320 6e6f 7420 4e6f 6e65  size is not None
+00030150: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00030160: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00030170: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
+00030180: 2020 2020 2020 2020 2022 6d65 7461 6461           "metada
+00030190: 7461 5f74 6173 6b5f 7369 7a65 2069 7320  ta_task_size is 
+000301a0: 6e6f 7420 7375 7070 6f72 7465 6420 7768  not supported wh
+000301b0: 656e 2075 7369 6e67 2074 6865 2070 7961  en using the pya
+000301c0: 7272 6f77 2066 696c 6573 7973 7465 6d2e  rrow filesystem.
+000301d0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+000301e0: 2020 2020 2020 2020 6966 2073 706c 6974          if split
+000301f0: 5f72 6f77 5f67 726f 7570 7320 213d 2022  _row_groups != "
+00030200: 696e 6665 7222 3a0a 2020 2020 2020 2020  infer":.        
+00030210: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00030220: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+00030230: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00030240: 7370 6c69 745f 726f 775f 6772 6f75 7073  split_row_groups
+00030250: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+00030260: 6420 7768 656e 2075 7369 6e67 2074 6865  d when using the
+00030270: 2070 7961 7272 6f77 2066 696c 6573 7973   pyarrow filesys
+00030280: 7465 6d2e 220a 2020 2020 2020 2020 2020  tem.".          
+00030290: 2020 290a 2020 2020 2020 2020 6966 2062    ).        if b
+000302a0: 6c6f 636b 7369 7a65 2069 7320 6e6f 7420  locksize is not 
+000302b0: 4e6f 6e65 2061 6e64 2062 6c6f 636b 7369  None and blocksi
+000302c0: 7a65 2021 3d20 2264 6566 6175 6c74 223a  ze != "default":
+000302d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000302e0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+000302f0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+00030300: 2020 2020 2020 2020 2262 6c6f 636b 7369          "blocksi
+00030310: 7a65 2069 7320 6e6f 7420 7375 7070 6f72  ze is not suppor
+00030320: 7465 6420 7768 656e 2075 7369 6e67 2074  ted when using t
+00030330: 6865 2070 7961 7272 6f77 2066 696c 6573  he pyarrow files
+00030340: 7973 7465 6d2e 220a 2020 2020 2020 2020  ystem.".        
+00030350: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+00030360: 2061 6767 7265 6761 7465 5f66 696c 6573   aggregate_files
+00030370: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00030380: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00030390: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+000303a0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000303b0: 2020 2020 2022 6167 6772 6567 6174 655f       "aggregate_
+000303c0: 6669 6c65 7320 6973 206e 6f74 2073 7570  files is not sup
+000303d0: 706f 7274 6564 2077 6865 6e20 7573 696e  ported when usin
+000303e0: 6720 7468 6520 7079 6172 726f 7720 6669  g the pyarrow fi
+000303f0: 6c65 7379 7374 656d 2e22 0a20 2020 2020  lesystem.".     
+00030400: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00030410: 2069 6620 7061 7271 7565 745f 6669 6c65   if parquet_file
+00030420: 5f65 7874 656e 7369 6f6e 2021 3d20 2822  _extension != ("
+00030430: 2e70 6172 7122 2c20 222e 7061 7271 7565  .parq", ".parque
+00030440: 7422 2c20 222e 7071 2229 3a0a 2020 2020  t", ".pq"):.    
+00030450: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+00030460: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00030470: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00030480: 2020 2022 7061 7271 7565 745f 6669 6c65     "parquet_file
+00030490: 5f65 7874 656e 7369 6f6e 2069 7320 6e6f  _extension is no
+000304a0: 7420 7375 7070 6f72 7465 6420 7768 656e  t supported when
+000304b0: 2075 7369 6e67 2074 6865 2070 7961 7272   using the pyarr
+000304c0: 6f77 2066 696c 6573 7973 7465 6d2e 220a  ow filesystem.".
+000304d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000304e0: 2020 2020 2020 6966 2065 6e67 696e 6520        if engine 
+000304f0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00030500: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00030510: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00030520: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00030530: 2020 2020 2265 6e67 696e 6520 6973 206e      "engine is n
+00030540: 6f74 2073 7570 706f 7274 6564 2077 6865  ot supported whe
+00030550: 6e20 7573 696e 6720 7468 6520 7079 6172  n using the pyar
+00030560: 726f 7720 6669 6c65 7379 7374 656d 2e22  row filesystem."
+00030570: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00030580: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00030590: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
+000305a0: 2020 2020 2020 2020 2020 2052 6561 6450             ReadP
+000305b0: 6172 7175 6574 5079 6172 726f 7746 5328  arquetPyarrowFS(
+000305c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000305d0: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
+000305e0: 2020 2020 2020 2063 6f6c 756d 6e73 3d5f         columns=_
+000305f0: 636f 6e76 6572 745f 746f 5f6c 6973 7428  convert_to_list(
+00030600: 636f 6c75 6d6e 7329 2c0a 2020 2020 2020  columns),.      
+00030610: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
+00030620: 733d 6669 6c74 6572 732c 0a20 2020 2020  s=filters,.     
+00030630: 2020 2020 2020 2020 2020 2063 6174 6567             categ
+00030640: 6f72 6965 733d 6361 7465 676f 7269 6573  ories=categories
+00030650: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00030660: 2020 696e 6465 783d 696e 6465 782c 0a20    index=index,. 
+00030670: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00030680: 616c 6375 6c61 7465 5f64 6976 6973 696f  alculate_divisio
+00030690: 6e73 3d63 616c 6375 6c61 7465 5f64 6976  ns=calculate_div
+000306a0: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
+000306b0: 2020 2020 2020 2020 7374 6f72 6167 655f          storage_
+000306c0: 6f70 7469 6f6e 733d 7374 6f72 6167 655f  options=storage_
+000306d0: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
+000306e0: 2020 2020 2020 2020 2066 696c 6573 7973           filesys
+000306f0: 7465 6d3d 6669 6c65 7379 7374 656d 2c0a  tem=filesystem,.
+00030700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030710: 6967 6e6f 7265 5f6d 6574 6164 6174 615f  ignore_metadata_
+00030720: 6669 6c65 3d69 676e 6f72 655f 6d65 7461  file=ignore_meta
+00030730: 6461 7461 5f66 696c 652c 0a20 2020 2020  data_file,.     
+00030740: 2020 2020 2020 2020 2020 2061 7272 6f77             arrow
+00030750: 5f74 6f5f 7061 6e64 6173 3d61 7272 6f77  _to_pandas=arrow
+00030760: 5f74 6f5f 7061 6e64 6173 2c0a 2020 2020  _to_pandas,.    
+00030770: 2020 2020 2020 2020 2020 2020 7079 6172              pyar
+00030780: 726f 775f 7374 7269 6e67 735f 656e 6162  row_strings_enab
+00030790: 6c65 643d 7079 6172 726f 775f 7374 7269  led=pyarrow_stri
+000307a0: 6e67 735f 656e 6162 6c65 6428 292c 0a20  ngs_enabled(),. 
+000307b0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+000307c0: 7761 7267 733d 6b77 6172 6773 2c0a 2020  wargs=kwargs,.  
+000307d0: 2020 2020 2020 2020 2020 2020 2020 5f73                _s
+000307e0: 6572 6965 733d 6973 696e 7374 616e 6365  eries=isinstance
+000307f0: 2863 6f6c 756d 6e73 2c20 7374 7229 2c0a  (columns, str),.
+00030800: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00030810: 2020 2020 2020 290a 0a20 2020 2072 6574        )..    ret
+00030820: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+00030830: 6f6e 280a 2020 2020 2020 2020 5265 6164  on(.        Read
+00030840: 5061 7271 7565 7446 5353 7065 6328 0a20  ParquetFSSpec(. 
+00030850: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+00030860: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00030870: 756d 6e73 3d5f 636f 6e76 6572 745f 746f  umns=_convert_to
+00030880: 5f6c 6973 7428 636f 6c75 6d6e 7329 2c0a  _list(columns),.
+00030890: 2020 2020 2020 2020 2020 2020 6669 6c74              filt
+000308a0: 6572 733d 6669 6c74 6572 732c 0a20 2020  ers=filters,.   
+000308b0: 2020 2020 2020 2020 2063 6174 6567 6f72           categor
+000308c0: 6965 733d 6361 7465 676f 7269 6573 2c0a  ies=categories,.
+000308d0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+000308e0: 783d 696e 6465 782c 0a20 2020 2020 2020  x=index,.       
+000308f0: 2020 2020 2073 746f 7261 6765 5f6f 7074       storage_opt
+00030900: 696f 6e73 3d73 746f 7261 6765 5f6f 7074  ions=storage_opt
+00030910: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+00030920: 2020 6361 6c63 756c 6174 655f 6469 7669    calculate_divi
+00030930: 7369 6f6e 733d 6361 6c63 756c 6174 655f  sions=calculate_
+00030940: 6469 7669 7369 6f6e 732c 0a20 2020 2020  divisions,.     
+00030950: 2020 2020 2020 2069 676e 6f72 655f 6d65         ignore_me
+00030960: 7461 6461 7461 5f66 696c 653d 6967 6e6f  tadata_file=igno
+00030970: 7265 5f6d 6574 6164 6174 615f 6669 6c65  re_metadata_file
+00030980: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
+00030990: 7461 6461 7461 5f74 6173 6b5f 7369 7a65  tadata_task_size
+000309a0: 3d6d 6574 6164 6174 615f 7461 736b 5f73  =metadata_task_s
+000309b0: 697a 652c 0a20 2020 2020 2020 2020 2020  ize,.           
+000309c0: 2073 706c 6974 5f72 6f77 5f67 726f 7570   split_row_group
+000309d0: 733d 7370 6c69 745f 726f 775f 6772 6f75  s=split_row_grou
+000309e0: 7073 2c0a 2020 2020 2020 2020 2020 2020  ps,.            
+000309f0: 626c 6f63 6b73 697a 653d 626c 6f63 6b73  blocksize=blocks
+00030a00: 697a 652c 0a20 2020 2020 2020 2020 2020  ize,.           
+00030a10: 2061 6767 7265 6761 7465 5f66 696c 6573   aggregate_files
+00030a20: 3d61 6767 7265 6761 7465 5f66 696c 6573  =aggregate_files
+00030a30: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+00030a40: 7271 7565 745f 6669 6c65 5f65 7874 656e  rquet_file_exten
+00030a50: 7369 6f6e 3d70 6172 7175 6574 5f66 696c  sion=parquet_fil
+00030a60: 655f 6578 7465 6e73 696f 6e2c 0a20 2020  e_extension,.   
+00030a70: 2020 2020 2020 2020 2066 696c 6573 7973           filesys
+00030a80: 7465 6d3d 6669 6c65 7379 7374 656d 2c0a  tem=filesystem,.
+00030a90: 2020 2020 2020 2020 2020 2020 656e 6769              engi
+00030aa0: 6e65 3d5f 7365 745f 7061 7271 7565 745f  ne=_set_parquet_
+00030ab0: 656e 6769 6e65 2865 6e67 696e 6529 2c0a  engine(engine),.
+00030ac0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
+00030ad0: 6773 3d6b 7761 7267 732c 0a20 2020 2020  gs=kwargs,.     
+00030ae0: 2020 2020 2020 205f 7365 7269 6573 3d69         _series=i
+00030af0: 7369 6e73 7461 6e63 6528 636f 6c75 6d6e  sinstance(column
+00030b00: 732c 2073 7472 292c 0a20 2020 2020 2020  s, str),.       
+00030b10: 2029 0a20 2020 2029 0a0a 0a64 6566 2063   ).    )...def c
+00030b20: 6f6e 6361 7428 0a20 2020 2064 6673 2c0a  oncat(.    dfs,.
+00030b30: 2020 2020 6178 6973 3d30 2c0a 2020 2020      axis=0,.    
+00030b40: 6a6f 696e 3d22 6f75 7465 7222 2c0a 2020  join="outer",.  
+00030b50: 2020 6967 6e6f 7265 5f75 6e6b 6e6f 776e    ignore_unknown
+00030b60: 5f64 6976 6973 696f 6e73 3d46 616c 7365  _divisions=False
+00030b70: 2c0a 2020 2020 6967 6e6f 7265 5f6f 7264  ,.    ignore_ord
+00030b80: 6572 3d46 616c 7365 2c0a 2020 2020 696e  er=False,.    in
+00030b90: 7465 726c 6561 7665 5f70 6172 7469 7469  terleave_partiti
+00030ba0: 6f6e 733d 4661 6c73 652c 0a20 2020 202a  ons=False,.    *
+00030bb0: 2a6b 7761 7267 732c 0a29 3a0a 2020 2020  *kwargs,.):.    
+00030bc0: 2222 2243 6f6e 6361 7465 6e61 7465 2044  """Concatenate D
+00030bd0: 6174 6146 7261 6d65 7320 616c 6f6e 6720  ataFrames along 
+00030be0: 726f 7773 2e0a 0a20 2020 202d 2057 6865  rows...    - Whe
+00030bf0: 6e20 6178 6973 3d30 2028 6465 6661 756c  n axis=0 (defaul
+00030c00: 7429 2c20 636f 6e63 6174 656e 6174 6520  t), concatenate 
+00030c10: 4461 7461 4672 616d 6573 2072 6f77 2d77  DataFrames row-w
+00030c20: 6973 653a 0a0a 2020 2020 2020 2d20 4966  ise:..      - If
+00030c30: 2061 6c6c 2064 6976 6973 696f 6e73 2061   all divisions a
+00030c40: 7265 206b 6e6f 776e 2061 6e64 206f 7264  re known and ord
+00030c50: 6572 6564 2c20 636f 6e63 6174 656e 6174  ered, concatenat
+00030c60: 6520 4461 7461 4672 616d 6573 206b 6565  e DataFrames kee
+00030c70: 7069 6e67 0a20 2020 2020 2020 2064 6976  ping.        div
+00030c80: 6973 696f 6e73 2e20 5768 656e 2064 6976  isions. When div
+00030c90: 6973 696f 6e73 2061 7265 206e 6f74 206f  isions are not o
+00030ca0: 7264 6572 6564 2c20 7370 6563 6966 7969  rdered, specifyi
+00030cb0: 6e67 0a20 2020 2020 2020 2069 6e74 6572  ng.        inter
+00030cc0: 6c65 6176 655f 7061 7274 6974 696f 6e3d  leave_partition=
+00030cd0: 5472 7565 2061 6c6c 6f77 7320 636f 6e63  True allows conc
+00030ce0: 6174 656e 6174 6520 6469 7669 7369 6f6e  atenate division
+00030cf0: 7320 6561 6368 2062 7920 6561 6368 2e0a  s each by each..
+00030d00: 0a20 2020 2020 202d 2049 6620 616e 7920  .      - If any 
+00030d10: 6f66 2064 6976 6973 696f 6e20 6973 2075  of division is u
+00030d20: 6e6b 6e6f 776e 2c20 636f 6e63 6174 656e  nknown, concaten
+00030d30: 6174 6520 4461 7461 4672 616d 6573 2072  ate DataFrames r
+00030d40: 6573 6574 7469 6e67 2069 7473 0a20 2020  esetting its.   
+00030d50: 2020 2020 2064 6976 6973 696f 6e20 746f       division to
+00030d60: 2075 6e6b 6e6f 776e 2028 4e6f 6e65 290a   unknown (None).
+00030d70: 0a20 2020 202d 2057 6865 6e20 6178 6973  .    - When axis
+00030d80: 3d31 2c20 636f 6e63 6174 656e 6174 6520  =1, concatenate 
+00030d90: 4461 7461 4672 616d 6573 2063 6f6c 756d  DataFrames colum
+00030da0: 6e2d 7769 7365 3a0a 0a20 2020 2020 202d  n-wise:..      -
+00030db0: 2041 6c6c 6f77 6564 2069 6620 616c 6c20   Allowed if all 
+00030dc0: 6469 7669 7369 6f6e 7320 6172 6520 6b6e  divisions are kn
+00030dd0: 6f77 6e2e 0a0a 2020 2020 2020 2d20 4966  own...      - If
+00030de0: 2061 6e79 206f 6620 6469 7669 7369 6f6e   any of division
+00030df0: 2069 7320 756e 6b6e 6f77 6e2c 2069 7420   is unknown, it 
+00030e00: 7261 6973 6573 2056 616c 7565 4572 726f  raises ValueErro
+00030e10: 722e 0a0a 2020 2020 5061 7261 6d65 7465  r...    Paramete
+00030e20: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00030e30: 2d0a 2020 2020 6466 7320 3a20 6c69 7374  -.    dfs : list
+00030e40: 0a20 2020 2020 2020 204c 6973 7420 6f66  .        List of
+00030e50: 2064 6173 6b2e 4461 7461 4672 616d 6573   dask.DataFrames
+00030e60: 2074 6f20 6265 2063 6f6e 6361 7465 6e61   to be concatena
+00030e70: 7465 640a 2020 2020 6178 6973 203a 207b  ted.    axis : {
+00030e80: 302c 2031 2c20 2769 6e64 6578 272c 2027  0, 1, 'index', '
+00030e90: 636f 6c75 6d6e 7327 7d2c 2064 6566 6175  columns'}, defau
+00030ea0: 6c74 2030 0a20 2020 2020 2020 2054 6865  lt 0.        The
+00030eb0: 2061 7869 7320 746f 2063 6f6e 6361 7465   axis to concate
+00030ec0: 6e61 7465 2061 6c6f 6e67 0a20 2020 206a  nate along.    j
+00030ed0: 6f69 6e20 3a20 7b27 696e 6e65 7227 2c20  oin : {'inner', 
+00030ee0: 276f 7574 6572 277d 2c20 6465 6661 756c  'outer'}, defaul
+00030ef0: 7420 276f 7574 6572 270a 2020 2020 2020  t 'outer'.      
+00030f00: 2020 486f 7720 746f 2068 616e 646c 6520    How to handle 
+00030f10: 696e 6465 7865 7320 6f6e 206f 7468 6572  indexes on other
+00030f20: 2061 7869 730a 2020 2020 696e 7465 726c   axis.    interl
+00030f30: 6561 7665 5f70 6172 7469 7469 6f6e 7320  eave_partitions 
+00030f40: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+00030f50: 4661 6c73 650a 2020 2020 2020 2020 5768  False.        Wh
+00030f60: 6574 6865 7220 746f 2063 6f6e 6361 7465  ether to concate
+00030f70: 6e61 7465 2044 6174 6146 7261 6d65 7320  nate DataFrames 
+00030f80: 6967 6e6f 7269 6e67 2069 7473 206f 7264  ignoring its ord
+00030f90: 6572 2e20 4966 2054 7275 652c 2065 7665  er. If True, eve
+00030fa0: 7279 0a20 2020 2020 2020 2064 6976 6973  ry.        divis
+00030fb0: 696f 6e73 2061 7265 2063 6f6e 6361 7465  ions are concate
+00030fc0: 6e61 7465 6420 6561 6368 2062 7920 6561  nated each by ea
+00030fd0: 6368 2e0a 2020 2020 6967 6e6f 7265 5f75  ch..    ignore_u
+00030fe0: 6e6b 6e6f 776e 5f64 6976 6973 696f 6e73  nknown_divisions
+00030ff0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+00031000: 2046 616c 7365 0a20 2020 2020 2020 2042   False.        B
+00031010: 7920 6465 6661 756c 7420 6120 7761 726e  y default a warn
+00031020: 696e 6720 6973 2072 6169 7365 6420 6966  ing is raised if
+00031030: 2061 6e79 2069 6e70 7574 2068 6173 2075   any input has u
+00031040: 6e6b 6e6f 776e 2064 6976 6973 696f 6e73  nknown divisions
+00031050: 2e0a 2020 2020 2020 2020 5365 7420 746f  ..        Set to
+00031060: 2054 7275 6520 746f 2064 6973 6162 6c65   True to disable
+00031070: 2074 6869 7320 7761 726e 696e 672e 0a20   this warning.. 
+00031080: 2020 2069 676e 6f72 655f 6f72 6465 7220     ignore_order 
+00031090: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+000310a0: 4661 6c73 650a 2020 2020 2020 2020 5768  False.        Wh
+000310b0: 6574 6865 7220 746f 2069 676e 6f72 6520  ether to ignore 
+000310c0: 6f72 6465 7220 7768 656e 2064 6f69 6e67  order when doing
+000310d0: 2074 6865 2075 6e69 6f6e 206f 6620 6361   the union of ca
+000310e0: 7465 676f 7269 6361 6c73 2e0a 0a20 2020  tegoricals...   
+000310f0: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
+00031100: 0a20 2020 2054 6869 7320 6469 6666 6572  .    This differ
+00031110: 7320 696e 2066 726f 6d20 6060 7064 2e63  s in from ``pd.c
+00031120: 6f6e 6361 7460 6020 696e 2074 6865 2077  oncat`` in the w
+00031130: 6865 6e20 636f 6e63 6174 656e 6174 696e  hen concatenatin
+00031140: 6720 4361 7465 676f 7269 6361 6c73 0a20  g Categoricals. 
+00031150: 2020 2077 6974 6820 6469 6666 6572 656e     with differen
+00031160: 7420 6361 7465 676f 7269 6573 2e20 5061  t categories. Pa
+00031170: 6e64 6173 2063 7572 7265 6e74 6c79 2063  ndas currently c
+00031180: 6f65 7263 6573 2074 686f 7365 2074 6f20  oerces those to 
+00031190: 6f62 6a65 6374 730a 2020 2020 6265 666f  objects.    befo
+000311a0: 7265 2063 6f6e 6361 7465 6e61 7469 6e67  re concatenating
+000311b0: 2e20 436f 6572 6369 6e67 2074 6f20 6f62  . Coercing to ob
+000311c0: 6a65 6374 7320 6973 2076 6572 7920 6578  jects is very ex
+000311d0: 7065 6e73 6976 6520 666f 7220 6c61 7267  pensive for larg
+000311e0: 650a 2020 2020 6172 7261 7973 2c20 736f  e.    arrays, so
+000311f0: 2064 6173 6b20 7072 6573 6572 7665 7320   dask preserves 
+00031200: 7468 6520 4361 7465 676f 7269 6361 6c73  the Categoricals
+00031210: 2062 7920 7461 6b69 6e67 2074 6865 2075   by taking the u
+00031220: 6e69 6f6e 206f 660a 2020 2020 7468 6520  nion of.    the 
+00031230: 6361 7465 676f 7269 6573 2e0a 0a20 2020  categories...   
+00031240: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+00031250: 2d2d 2d2d 2d2d 0a20 2020 2049 6620 616c  ------.    If al
+00031260: 6c20 6469 7669 7369 6f6e 7320 6172 6520  l divisions are 
+00031270: 6b6e 6f77 6e20 616e 6420 6f72 6465 7265  known and ordere
+00031280: 642c 2064 6976 6973 696f 6e73 2061 7265  d, divisions are
+00031290: 206b 6570 742e 0a0a 2020 2020 3e3e 3e20   kept...    >>> 
+000312a0: 696d 706f 7274 2064 6173 6b2e 6461 7461  import dask.data
+000312b0: 6672 616d 6520 6173 2064 640a 2020 2020  frame as dd.    
+000312c0: 3e3e 3e20 6120 2020 2020 2020 2020 2020  >>> a           
+000312d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312f0: 2020 2020 2320 646f 6374 6573 743a 202b      # doctest: +
+00031300: 534b 4950 0a20 2020 2064 642e 4461 7461  SKIP.    dd.Data
+00031310: 4672 616d 653c 782c 2064 6976 6973 696f  Frame<x, divisio
+00031320: 6e73 3d28 312c 2033 2c20 3529 3e0a 2020  ns=(1, 3, 5)>.  
+00031330: 2020 3e3e 3e20 6220 2020 2020 2020 2020    >>> b         
+00031340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031360: 2020 2020 2020 2320 646f 6374 6573 743a        # doctest:
+00031370: 202b 534b 4950 0a20 2020 2064 642e 4461   +SKIP.    dd.Da
+00031380: 7461 4672 616d 653c 792c 2064 6976 6973  taFrame<y, divis
+00031390: 696f 6e73 3d28 362c 2038 2c20 3130 293e  ions=(6, 8, 10)>
+000313a0: 0a20 2020 203e 3e3e 2064 642e 636f 6e63  .    >>> dd.conc
+000313b0: 6174 285b 612c 2062 5d29 2020 2020 2020  at([a, b])      
+000313c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000313d0: 2020 2020 2020 2020 2023 2064 6f63 7465           # docte
+000313e0: 7374 3a20 2b53 4b49 500a 2020 2020 6464  st: +SKIP.    dd
+000313f0: 2e44 6174 6146 7261 6d65 3c63 6f6e 6361  .DataFrame<conca
+00031400: 742d 2e2e 2e2c 2064 6976 6973 696f 6e73  t-..., divisions
+00031410: 3d28 312c 2033 2c20 362c 2038 2c20 3130  =(1, 3, 6, 8, 10
+00031420: 293e 0a0a 2020 2020 556e 6162 6c65 2074  )>..    Unable t
+00031430: 6f20 636f 6e63 6174 656e 6174 6520 6966  o concatenate if
+00031440: 2064 6976 6973 696f 6e73 2061 7265 206e   divisions are n
+00031450: 6f74 206f 7264 6572 6564 2e0a 0a20 2020  ot ordered...   
+00031460: 203e 3e3e 2061 2020 2020 2020 2020 2020   >>> a          
+00031470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031490: 2020 2020 2023 2064 6f63 7465 7374 3a20       # doctest: 
+000314a0: 2b53 4b49 500a 2020 2020 6464 2e44 6174  +SKIP.    dd.Dat
+000314b0: 6146 7261 6d65 3c78 2c20 6469 7669 7369  aFrame<x, divisi
+000314c0: 6f6e 733d 2831 2c20 332c 2035 293e 0a20  ons=(1, 3, 5)>. 
+000314d0: 2020 203e 3e3e 2062 2020 2020 2020 2020     >>> b        
+000314e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000314f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031500: 2020 2020 2020 2023 2064 6f63 7465 7374         # doctest
+00031510: 3a20 2b53 4b49 500a 2020 2020 6464 2e44  : +SKIP.    dd.D
+00031520: 6174 6146 7261 6d65 3c79 2c20 6469 7669  ataFrame<y, divi
+00031530: 7369 6f6e 733d 2832 2c20 332c 2036 293e  sions=(2, 3, 6)>
+00031540: 0a20 2020 203e 3e3e 2064 642e 636f 6e63  .    >>> dd.conc
+00031550: 6174 285b 612c 2062 5d29 2020 2020 2020  at([a, b])      
+00031560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031570: 2020 2020 2020 2020 2023 2064 6f63 7465           # docte
+00031580: 7374 3a20 2b53 4b49 500a 2020 2020 5661  st: +SKIP.    Va
+00031590: 6c75 6545 7272 6f72 3a20 416c 6c20 696e  lueError: All in
+000315a0: 7075 7473 2068 6176 6520 6b6e 6f77 6e20  puts have known 
+000315b0: 6469 7669 7369 6f6e 7320 7768 6963 6820  divisions which 
+000315c0: 6361 6e6e 6f74 2062 6520 636f 6e63 6174  cannot be concat
+000315d0: 656e 6174 6564 0a20 2020 2069 6e20 6f72  enated.    in or
+000315e0: 6465 722e 2053 7065 6369 6679 2069 6e74  der. Specify int
+000315f0: 6572 6c65 6176 655f 7061 7274 6974 696f  erleave_partitio
+00031600: 6e73 3d54 7275 6520 746f 2069 676e 6f72  ns=True to ignor
+00031610: 6520 6f72 6465 720a 0a20 2020 2053 7065  e order..    Spe
+00031620: 6369 6679 2069 6e74 6572 6c65 6176 655f  cify interleave_
+00031630: 7061 7274 6974 696f 6e73 3d54 7275 6520  partitions=True 
+00031640: 746f 2069 676e 6f72 6520 7468 6520 6469  to ignore the di
+00031650: 7669 7369 6f6e 206f 7264 6572 2e0a 0a20  vision order... 
+00031660: 2020 203e 3e3e 2064 642e 636f 6e63 6174     >>> dd.concat
+00031670: 285b 612c 2062 5d2c 2069 6e74 6572 6c65  ([a, b], interle
+00031680: 6176 655f 7061 7274 6974 696f 6e73 3d54  ave_partitions=T
+00031690: 7275 6529 2020 2023 2064 6f63 7465 7374  rue)   # doctest
+000316a0: 3a20 2b53 4b49 500a 2020 2020 6464 2e44  : +SKIP.    dd.D
+000316b0: 6174 6146 7261 6d65 3c63 6f6e 6361 742d  ataFrame<concat-
+000316c0: 2e2e 2e2c 2064 6976 6973 696f 6e73 3d28  ..., divisions=(
+000316d0: 312c 2032 2c20 332c 2035 2c20 3629 3e0a  1, 2, 3, 5, 6)>.
+000316e0: 0a20 2020 2049 6620 616e 7920 6f66 2064  .    If any of d
+000316f0: 6976 6973 696f 6e20 6973 2075 6e6b 6e6f  ivision is unkno
+00031700: 776e 2c20 7468 6520 7265 7375 6c74 2064  wn, the result d
+00031710: 6976 6973 696f 6e20 7769 6c6c 2062 6520  ivision will be 
+00031720: 756e 6b6e 6f77 6e0a 0a20 2020 203e 3e3e  unknown..    >>>
+00031730: 2061 2020 2020 2020 2020 2020 2020 2020   a              
+00031740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031760: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00031770: 500a 2020 2020 6464 2e44 6174 6146 7261  P.    dd.DataFra
+00031780: 6d65 3c78 2c20 6469 7669 7369 6f6e 733d  me<x, divisions=
+00031790: 284e 6f6e 652c 204e 6f6e 6529 3e0a 2020  (None, None)>.  
+000317a0: 2020 3e3e 3e20 6220 2020 2020 2020 2020    >>> b         
+000317b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317d0: 2020 2020 2020 2320 646f 6374 6573 743a        # doctest:
+000317e0: 202b 534b 4950 0a20 2020 2064 642e 4461   +SKIP.    dd.Da
+000317f0: 7461 4672 616d 653c 792c 2064 6976 6973  taFrame<y, divis
+00031800: 696f 6e73 3d28 312c 2034 2c20 3130 293e  ions=(1, 4, 10)>
+00031810: 0a20 2020 203e 3e3e 2064 642e 636f 6e63  .    >>> dd.conc
+00031820: 6174 285b 612c 2062 5d29 2020 2020 2020  at([a, b])      
+00031830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031840: 2020 2020 2020 2020 2023 2064 6f63 7465           # docte
+00031850: 7374 3a20 2b53 4b49 500a 2020 2020 6464  st: +SKIP.    dd
+00031860: 2e44 6174 6146 7261 6d65 3c63 6f6e 6361  .DataFrame<conca
+00031870: 742d 2e2e 2e2c 2064 6976 6973 696f 6e73  t-..., divisions
+00031880: 3d28 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  =(None, None, No
+00031890: 6e65 2c20 4e6f 6e65 293e 0a0a 2020 2020  ne, None)>..    
+000318a0: 4279 2064 6566 6175 6c74 2063 6f6e 6361  By default conca
+000318b0: 7465 6e61 7469 6e67 2077 6974 6820 756e  tenating with un
+000318c0: 6b6e 6f77 6e20 6469 7669 7369 6f6e 7320  known divisions 
+000318d0: 7769 6c6c 2072 6169 7365 2061 2077 6172  will raise a war
+000318e0: 6e69 6e67 2e0a 2020 2020 5365 7420 6060  ning..    Set ``
+000318f0: 6967 6e6f 7265 5f75 6e6b 6e6f 776e 5f64  ignore_unknown_d
+00031900: 6976 6973 696f 6e73 3d54 7275 6560 6020  ivisions=True`` 
+00031910: 746f 2064 6973 6162 6c65 2074 6869 733a  to disable this:
+00031920: 0a0a 2020 2020 3e3e 3e20 6464 2e63 6f6e  ..    >>> dd.con
+00031930: 6361 7428 5b61 2c20 625d 2c20 6967 6e6f  cat([a, b], igno
+00031940: 7265 5f75 6e6b 6e6f 776e 5f64 6976 6973  re_unknown_divis
+00031950: 696f 6e73 3d54 7275 6529 2320 646f 6374  ions=True)# doct
+00031960: 6573 743a 202b 534b 4950 0a20 2020 2064  est: +SKIP.    d
+00031970: 642e 4461 7461 4672 616d 653c 636f 6e63  d.DataFrame<conc
+00031980: 6174 2d2e 2e2e 2c20 6469 7669 7369 6f6e  at-..., division
+00031990: 733d 284e 6f6e 652c 204e 6f6e 652c 204e  s=(None, None, N
+000319a0: 6f6e 652c 204e 6f6e 6529 3e0a 0a20 2020  one, None)>..   
+000319b0: 2044 6966 6665 7265 6e74 2063 6174 6567   Different categ
+000319c0: 6f72 6963 616c 7320 6172 6520 756e 696f  oricals are unio
+000319d0: 6e65 640a 0a20 2020 203e 3e3e 2064 642e  ned..    >>> dd.
+000319e0: 636f 6e63 6174 285b 0a20 2020 202e 2e2e  concat([.    ...
+000319f0: 2020 2020 2064 642e 6672 6f6d 5f70 616e       dd.from_pan
+00031a00: 6461 7328 7064 2e53 6572 6965 7328 5b27  das(pd.Series(['
+00031a10: 6127 2c20 2762 275d 2c20 6474 7970 653d  a', 'b'], dtype=
+00031a20: 2763 6174 6567 6f72 7927 292c 2031 292c  'category'), 1),
+00031a30: 0a20 2020 202e 2e2e 2020 2020 2064 642e  .    ...     dd.
+00031a40: 6672 6f6d 5f70 616e 6461 7328 7064 2e53  from_pandas(pd.S
+00031a50: 6572 6965 7328 5b27 6127 2c20 2763 275d  eries(['a', 'c']
+00031a60: 2c20 6474 7970 653d 2763 6174 6567 6f72  , dtype='categor
+00031a70: 7927 292c 2031 292c 0a20 2020 202e 2e2e  y'), 1),.    ...
+00031a80: 205d 2c20 696e 7465 726c 6561 7665 5f70   ], interleave_p
+00031a90: 6172 7469 7469 6f6e 733d 5472 7565 292e  artitions=True).
+00031aa0: 6474 7970 650a 2020 2020 4361 7465 676f  dtype.    Catego
+00031ab0: 7269 6361 6c44 7479 7065 2863 6174 6567  ricalDtype(categ
+00031ac0: 6f72 6965 733d 5b27 6127 2c20 2762 272c  ories=['a', 'b',
+00031ad0: 2027 6327 5d2c 206f 7264 6572 6564 3d46   'c'], ordered=F
+00031ae0: 616c 7365 2c20 6361 7465 676f 7269 6573  alse, categories
+00031af0: 5f64 7479 7065 3d6f 626a 6563 7429 0a20  _dtype=object). 
+00031b00: 2020 2022 2222 0a20 2020 2069 6620 6e6f     """.    if no
+00031b10: 7420 6973 696e 7374 616e 6365 2864 6673  t isinstance(dfs
+00031b20: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+00031b30: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00031b40: 2822 6466 7320 6d75 7374 2062 6520 6120  ("dfs must be a 
+00031b50: 6c69 7374 206f 6620 4461 7461 4672 616d  list of DataFram
+00031b60: 6573 2f53 6572 6965 7320 6f62 6a65 6374  es/Series object
+00031b70: 7322 290a 2020 2020 6966 206c 656e 2864  s").    if len(d
+00031b80: 6673 2920 3d3d 2030 3a0a 2020 2020 2020  fs) == 0:.      
+00031b90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00031ba0: 6f72 2822 4e6f 206f 626a 6563 7473 2074  or("No objects t
+00031bb0: 6f20 636f 6e63 6174 656e 6174 6522 290a  o concatenate").
+00031bc0: 2020 2020 6966 206c 656e 2864 6673 2920      if len(dfs) 
+00031bd0: 3d3d 2031 3a0a 2020 2020 2020 2020 6966  == 1:.        if
+00031be0: 2061 7869 7320 3d3d 2031 2061 6e64 2069   axis == 1 and i
+00031bf0: 7369 6e73 7461 6e63 6528 6466 735b 305d  sinstance(dfs[0]
+00031c00: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
+00031c10: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
+00031c20: 735b 305d 2e74 6f5f 6672 616d 6528 290a  s[0].to_frame().
+00031c30: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00031c40: 6673 5b30 5d0a 0a20 2020 2069 6620 6a6f  fs[0]..    if jo
+00031c50: 696e 206e 6f74 2069 6e20 2822 696e 6e65  in not in ("inne
+00031c60: 7222 2c20 226f 7574 6572 2229 3a0a 2020  r", "outer"):.  
+00031c70: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00031c80: 6545 7272 6f72 2822 276a 6f69 6e27 206d  eError("'join' m
+00031c90: 7573 7420 6265 2027 696e 6e65 7227 206f  ust be 'inner' o
+00031ca0: 7220 276f 7574 6572 2722 290a 0a20 2020  r 'outer'")..   
+00031cb0: 2064 6673 203d 205b 6672 6f6d 5f70 616e   dfs = [from_pan
+00031cc0: 6461 7328 6466 2920 6966 206e 6f74 2069  das(df) if not i
+00031cd0: 7369 6e73 7461 6e63 6528 6466 2c20 4672  sinstance(df, Fr
+00031ce0: 616d 6542 6173 6529 2065 6c73 6520 6466  ameBase) else df
+00031cf0: 2066 6f72 2064 6620 696e 2064 6673 5d0a   for df in dfs].
+00031d00: 0a20 2020 2069 6620 6178 6973 203d 3d20  .    if axis == 
+00031d10: 313a 0a20 2020 2020 2020 2064 6673 203d  1:.        dfs =
+00031d20: 205b 6466 2066 6f72 2064 6620 696e 2064   [df for df in d
+00031d30: 6673 2069 6620 6c65 6e28 6466 2e63 6f6c  fs if len(df.col
+00031d40: 756d 6e73 2920 3e20 3020 6f72 2069 7369  umns) > 0 or isi
+00031d50: 6e73 7461 6e63 6528 6466 2c20 5365 7269  nstance(df, Seri
+00031d60: 6573 295d 0a0a 2020 2020 7265 7475 726e  es)]..    return
+00031d70: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+00031d80: 0a20 2020 2020 2020 2043 6f6e 6361 7428  .        Concat(
+00031d90: 0a20 2020 2020 2020 2020 2020 206a 6f69  .            joi
+00031da0: 6e2c 0a20 2020 2020 2020 2020 2020 2069  n,.            i
+00031db0: 676e 6f72 655f 6f72 6465 722c 0a20 2020  gnore_order,.   
+00031dc0: 2020 2020 2020 2020 206b 7761 7267 732c           kwargs,
+00031dd0: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
+00031de0: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
+00031df0: 676e 6f72 655f 756e 6b6e 6f77 6e5f 6469  gnore_unknown_di
+00031e00: 7669 7369 6f6e 732c 0a20 2020 2020 2020  visions,.       
+00031e10: 2020 2020 2069 6e74 6572 6c65 6176 655f       interleave_
+00031e20: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+00031e30: 2020 2020 2020 2020 2a64 6673 2c0a 2020          *dfs,.  
+00031e40: 2020 2020 2020 290a 2020 2020 290a 0a0a        ).    )...
+00031e50: 6465 6620 6d65 6c74 280a 2020 2020 6672  def melt(.    fr
+00031e60: 616d 652c 0a20 2020 2069 645f 7661 7273  ame,.    id_vars
+00031e70: 3d4e 6f6e 652c 0a20 2020 2076 616c 7565  =None,.    value
+00031e80: 5f76 6172 733d 4e6f 6e65 2c0a 2020 2020  _vars=None,.    
+00031e90: 7661 725f 6e61 6d65 3d4e 6f6e 652c 0a20  var_name=None,. 
+00031ea0: 2020 2076 616c 7565 5f6e 616d 653d 2276     value_name="v
+00031eb0: 616c 7565 222c 0a20 2020 2063 6f6c 5f6c  alue",.    col_l
+00031ec0: 6576 656c 3d4e 6f6e 652c 0a29 3a0a 2020  evel=None,.):.  
+00031ed0: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
+00031ee0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00031ef0: 204d 2e6d 656c 742c 0a20 2020 2020 2020   M.melt,.       
+00031f00: 2066 7261 6d65 2c0a 2020 2020 2020 2020   frame,.        
+00031f10: 636c 6561 725f 6469 7669 7369 6f6e 733d  clear_divisions=
+00031f20: 5472 7565 2c0a 2020 2020 2020 2020 6964  True,.        id
+00031f30: 5f76 6172 733d 6964 5f76 6172 732c 0a20  _vars=id_vars,. 
+00031f40: 2020 2020 2020 2076 616c 7565 5f76 6172         value_var
+00031f50: 733d 7661 6c75 655f 7661 7273 2c0a 2020  s=value_vars,.  
+00031f60: 2020 2020 2020 7661 725f 6e61 6d65 3d76        var_name=v
+00031f70: 6172 5f6e 616d 652c 0a20 2020 2020 2020  ar_name,.       
+00031f80: 2076 616c 7565 5f6e 616d 653d 7661 6c75   value_name=valu
+00031f90: 655f 6e61 6d65 2c0a 2020 2020 2020 2020  e_name,.        
+00031fa0: 636f 6c5f 6c65 7665 6c3d 636f 6c5f 6c65  col_level=col_le
+00031fb0: 7665 6c2c 0a20 2020 2029 0a0a 0a40 7772  vel,.    )...@wr
+00031fc0: 6170 7328 7064 2e6d 6572 6765 290a 6465  aps(pd.merge).de
+00031fd0: 6620 6d65 7267 6528 0a20 2020 206c 6566  f merge(.    lef
+00031fe0: 742c 0a20 2020 2072 6967 6874 2c0a 2020  t,.    right,.  
+00031ff0: 2020 686f 773d 2269 6e6e 6572 222c 0a20    how="inner",. 
+00032000: 2020 206f 6e3d 4e6f 6e65 2c0a 2020 2020     on=None,.    
+00032010: 6c65 6674 5f6f 6e3d 4e6f 6e65 2c0a 2020  left_on=None,.  
+00032020: 2020 7269 6768 745f 6f6e 3d4e 6f6e 652c    right_on=None,
+00032030: 0a20 2020 206c 6566 745f 696e 6465 783d  .    left_index=
+00032040: 4661 6c73 652c 0a20 2020 2072 6967 6874  False,.    right
+00032050: 5f69 6e64 6578 3d46 616c 7365 2c0a 2020  _index=False,.  
+00032060: 2020 7375 6666 6978 6573 3d28 225f 7822    suffixes=("_x"
+00032070: 2c20 225f 7922 292c 0a20 2020 2069 6e64  , "_y"),.    ind
+00032080: 6963 6174 6f72 3d46 616c 7365 2c0a 2020  icator=False,.  
+00032090: 2020 7368 7566 666c 655f 6d65 7468 6f64    shuffle_method
+000320a0: 3d4e 6f6e 652c 0a20 2020 206e 7061 7274  =None,.    npart
+000320b0: 6974 696f 6e73 3d4e 6f6e 652c 0a20 2020  itions=None,.   
+000320c0: 2062 726f 6164 6361 7374 3d4e 6f6e 652c   broadcast=None,
+000320d0: 0a29 3a0a 2020 2020 666f 7220 6f20 696e  .):.    for o in
+000320e0: 205b 6f6e 2c20 6c65 6674 5f6f 6e2c 2072   [on, left_on, r
+000320f0: 6967 6874 5f6f 6e5d 3a0a 2020 2020 2020  ight_on]:.      
+00032100: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00032110: 6f2c 2046 7261 6d65 4261 7365 293a 0a20  o, FrameBase):. 
+00032120: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00032130: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00032140: 7272 6f72 2829 0a20 2020 2069 6620 6e6f  rror().    if no
+00032150: 7420 6f6e 2061 6e64 206e 6f74 206c 6566  t on and not lef
+00032160: 745f 6f6e 2061 6e64 206e 6f74 2072 6967  t_on and not rig
+00032170: 6874 5f6f 6e20 616e 6420 6e6f 7420 6c65  ht_on and not le
+00032180: 6674 5f69 6e64 6578 2061 6e64 206e 6f74  ft_index and not
+00032190: 2072 6967 6874 5f69 6e64 6578 3a0a 2020   right_index:.  
+000321a0: 2020 2020 2020 6f6e 203d 205b 6320 666f        on = [c fo
+000321b0: 7220 6320 696e 206c 6566 742e 636f 6c75  r c in left.colu
+000321c0: 6d6e 7320 6966 2063 2069 6e20 7269 6768  mns if c in righ
+000321d0: 742e 636f 6c75 6d6e 735d 0a20 2020 2020  t.columns].     
+000321e0: 2020 2069 6620 6e6f 7420 6f6e 3a0a 2020     if not on:.  
+000321f0: 2020 2020 2020 2020 2020 6c65 6674 5f69            left_i
+00032200: 6e64 6578 203d 2072 6967 6874 5f69 6e64  ndex = right_ind
+00032210: 6578 203d 2054 7275 650a 0a20 2020 2069  ex = True..    i
+00032220: 6620 6f6e 2061 6e64 206e 6f74 206c 6566  f on and not lef
+00032230: 745f 6f6e 2061 6e64 206e 6f74 2072 6967  t_on and not rig
+00032240: 6874 5f6f 6e3a 0a20 2020 2020 2020 206c  ht_on:.        l
+00032250: 6566 745f 6f6e 203d 2072 6967 6874 5f6f  eft_on = right_o
+00032260: 6e20 3d20 6f6e 0a0a 2020 2020 7375 7070  n = on..    supp
+00032270: 6f72 7465 645f 686f 7720 3d20 2822 6c65  orted_how = ("le
+00032280: 6674 222c 2022 7269 6768 7422 2c20 226f  ft", "right", "o
+00032290: 7574 6572 222c 2022 696e 6e65 7222 2c20  uter", "inner", 
+000322a0: 226c 6566 7473 656d 6922 290a 2020 2020  "leftsemi").    
+000322b0: 6966 2068 6f77 206e 6f74 2069 6e20 7375  if how not in su
+000322c0: 7070 6f72 7465 645f 686f 773a 0a20 2020  pported_how:.   
+000322d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000322e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000322f0: 2020 2066 2264 6173 6b2e 6461 7461 6672     f"dask.datafr
+00032300: 616d 652e 6d65 7267 6520 646f 6573 206e  ame.merge does n
+00032310: 6f74 2073 7570 706f 7274 2068 6f77 3d27  ot support how='
+00032320: 7b68 6f77 7d27 2e22 0a20 2020 2020 2020  {how}'.".       
+00032330: 2020 2020 2066 224f 7074 696f 6e73 2061       f"Options a
+00032340: 7265 3a20 7b73 7570 706f 7274 6564 5f68  re: {supported_h
+00032350: 6f77 7d2e 220a 2020 2020 2020 2020 290a  ow}.".        ).
+00032360: 0a20 2020 2069 6620 686f 7720 3d3d 2022  .    if how == "
+00032370: 6c65 6674 7365 6d69 223a 0a20 2020 2020  leftsemi":.     
+00032380: 2020 2069 6620 7269 6768 745f 696e 6465     if right_inde
+00032390: 7820 6f72 2061 6e79 280a 2020 2020 2020  x or any(.      
+000323a0: 2020 2020 2020 6f20 6e6f 7420 696e 2072        o not in r
+000323b0: 6967 6874 2e63 6f6c 756d 6e73 2066 6f72  ight.columns for
+000323c0: 206f 2069 6e20 5f63 6f6e 7665 7274 5f74   o in _convert_t
+000323d0: 6f5f 6c69 7374 2872 6967 6874 5f6f 6e29  o_list(right_on)
+000323e0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+000323f0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
+00032400: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00032410: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00032420: 2020 2022 686f 773d 276c 6566 7473 656d     "how='leftsem
+00032430: 6927 2064 6f65 7320 6e6f 7420 7375 7070  i' does not supp
+00032440: 6f72 7420 7269 6768 745f 696e 6465 783d  ort right_index=
+00032450: 5472 7565 206f 7220 6f6e 2063 6f6c 756d  True or on colum
+00032460: 6e73 2066 726f 6d20 7468 6520 696e 6465  ns from the inde
+00032470: 7822 0a20 2020 2020 2020 2020 2020 2029  x".            )
+00032480: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00032490: 2020 2020 2020 2020 2020 2072 6967 6874             right
+000324a0: 203d 2072 6967 6874 5b5f 636f 6e76 6572   = right[_conver
+000324b0: 745f 746f 5f6c 6973 7428 7269 6768 745f  t_to_list(right_
+000324c0: 6f6e 295d 2e72 656e 616d 6528 0a20 2020  on)].rename(.   
+000324d0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+000324e0: 756d 6e73 3d64 6963 7428 7a69 7028 5f63  umns=dict(zip(_c
+000324f0: 6f6e 7665 7274 5f74 6f5f 6c69 7374 2872  onvert_to_list(r
+00032500: 6967 6874 5f6f 6e29 2c20 5f63 6f6e 7665  ight_on), _conve
+00032510: 7274 5f74 6f5f 6c69 7374 286c 6566 745f  rt_to_list(left_
+00032520: 6f6e 2929 290a 2020 2020 2020 2020 2020  on))).          
+00032530: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00032540: 7269 6768 745f 6f6e 203d 206c 6566 745f  right_on = left_
+00032550: 6f6e 0a0a 2020 2020 2320 5472 616e 7366  on..    # Transf
+00032560: 6f72 6d20 7061 6e64 6173 206f 626a 6563  orm pandas objec
+00032570: 7473 2069 6e74 6f20 6461 736b 2e64 6174  ts into dask.dat
+00032580: 6166 7261 6d65 206f 626a 6563 7473 0a20  aframe objects. 
+00032590: 2020 2069 6620 6e6f 7420 6973 5f64 6173     if not is_das
+000325a0: 6b5f 636f 6c6c 6563 7469 6f6e 286c 6566  k_collection(lef
+000325b0: 7429 3a0a 2020 2020 2020 2020 6966 2072  t):.        if r
+000325c0: 6967 6874 5f69 6e64 6578 2061 6e64 206c  ight_index and l
+000325d0: 6566 745f 6f6e 3a20 2023 2063 6861 6e67  eft_on:  # chang
+000325e0: 6520 746f 206a 6f69 6e20 6f6e 2069 6e64  e to join on ind
+000325f0: 6578 0a20 2020 2020 2020 2020 2020 206c  ex.            l
+00032600: 6566 7420 3d20 6c65 6674 2e73 6574 5f69  eft = left.set_i
+00032610: 6e64 6578 286c 6566 745b 6c65 6674 5f6f  ndex(left[left_o
+00032620: 6e5d 290a 2020 2020 2020 2020 2020 2020  n]).            
+00032630: 6c65 6674 5f6f 6e20 3d20 4e6f 6e65 0a20  left_on = None. 
+00032640: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+00032650: 696e 6465 7820 3d20 5472 7565 0a20 2020  index = True.   
+00032660: 2020 2020 206c 6566 7420 3d20 6672 6f6d       left = from
+00032670: 5f70 616e 6461 7328 6c65 6674 2c20 6e70  _pandas(left, np
+00032680: 6172 7469 7469 6f6e 733d 3129 0a0a 2020  artitions=1)..  
+00032690: 2020 6966 206e 6f74 2069 735f 6461 736b    if not is_dask
+000326a0: 5f63 6f6c 6c65 6374 696f 6e28 7269 6768  _collection(righ
+000326b0: 7429 3a0a 2020 2020 2020 2020 6966 206c  t):.        if l
+000326c0: 6566 745f 696e 6465 7820 616e 6420 7269  eft_index and ri
+000326d0: 6768 745f 6f6e 3a20 2023 2063 6861 6e67  ght_on:  # chang
+000326e0: 6520 746f 206a 6f69 6e20 6f6e 2069 6e64  e to join on ind
+000326f0: 6578 0a20 2020 2020 2020 2020 2020 2072  ex.            r
+00032700: 6967 6874 203d 2072 6967 6874 2e73 6574  ight = right.set
+00032710: 5f69 6e64 6578 2872 6967 6874 5b72 6967  _index(right[rig
+00032720: 6874 5f6f 6e5d 290a 2020 2020 2020 2020  ht_on]).        
+00032730: 2020 2020 7269 6768 745f 6f6e 203d 204e      right_on = N
+00032740: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00032750: 7269 6768 745f 696e 6465 7820 3d20 5472  right_index = Tr
+00032760: 7565 0a20 2020 2020 2020 2072 6967 6874  ue.        right
+00032770: 203d 2066 726f 6d5f 7061 6e64 6173 2872   = from_pandas(r
+00032780: 6967 6874 2c20 6e70 6172 7469 7469 6f6e  ight, npartition
+00032790: 733d 3129 0a0a 2020 2020 6173 7365 7274  s=1)..    assert
+000327a0: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+000327b0: 6b65 2872 6967 6874 2e5f 6d65 7461 290a  ke(right._meta).
+000327c0: 2020 2020 6966 206c 6566 745f 6f6e 2061      if left_on a
+000327d0: 6e64 2072 6967 6874 5f6f 6e3a 0a20 2020  nd right_on:.   
+000327e0: 2020 2020 2077 6172 6e5f 6474 7970 655f       warn_dtype_
+000327f0: 6d69 736d 6174 6368 286c 6566 742c 2072  mismatch(left, r
+00032800: 6967 6874 2c20 6c65 6674 5f6f 6e2c 2072  ight, left_on, r
+00032810: 6967 6874 5f6f 6e29 0a0a 2020 2020 7265  ight_on)..    re
+00032820: 7475 726e 206e 6577 5f63 6f6c 6c65 6374  turn new_collect
+00032830: 696f 6e28 0a20 2020 2020 2020 204d 6572  ion(.        Mer
+00032840: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+00032850: 6c65 6674 2c0a 2020 2020 2020 2020 2020  left,.          
+00032860: 2020 7269 6768 742c 0a20 2020 2020 2020    right,.       
+00032870: 2020 2020 2068 6f77 3d68 6f77 2c0a 2020       how=how,.  
+00032880: 2020 2020 2020 2020 2020 6c65 6674 5f6f            left_o
+00032890: 6e3d 6c65 6674 5f6f 6e2c 0a20 2020 2020  n=left_on,.     
+000328a0: 2020 2020 2020 2072 6967 6874 5f6f 6e3d         right_on=
+000328b0: 7269 6768 745f 6f6e 2c0a 2020 2020 2020  right_on,.      
+000328c0: 2020 2020 2020 6c65 6674 5f69 6e64 6578        left_index
+000328d0: 3d6c 6566 745f 696e 6465 782c 0a20 2020  =left_index,.   
+000328e0: 2020 2020 2020 2020 2072 6967 6874 5f69           right_i
+000328f0: 6e64 6578 3d72 6967 6874 5f69 6e64 6578  ndex=right_index
+00032900: 2c0a 2020 2020 2020 2020 2020 2020 7375  ,.            su
+00032910: 6666 6978 6573 3d73 7566 6669 7865 732c  ffixes=suffixes,
+00032920: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00032930: 6963 6174 6f72 3d69 6e64 6963 6174 6f72  icator=indicator
+00032940: 2c0a 2020 2020 2020 2020 2020 2020 7368  ,.            sh
+00032950: 7566 666c 655f 6d65 7468 6f64 3d67 6574  uffle_method=get
+00032960: 5f73 7065 6369 6669 6564 5f73 6875 6666  _specified_shuff
+00032970: 6c65 2873 6875 6666 6c65 5f6d 6574 686f  le(shuffle_metho
+00032980: 6429 2c0a 2020 2020 2020 2020 2020 2020  d),.            
+00032990: 5f6e 7061 7274 6974 696f 6e73 3d6e 7061  _npartitions=npa
+000329a0: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
+000329b0: 2020 2020 2020 6272 6f61 6463 6173 743d        broadcast=
+000329c0: 6272 6f61 6463 6173 742c 0a20 2020 2020  broadcast,.     
+000329d0: 2020 2029 0a20 2020 2029 0a0a 0a40 7772     ).    )...@wr
+000329e0: 6170 7328 7064 2e6d 6572 6765 5f61 736f  aps(pd.merge_aso
+000329f0: 6629 0a64 6566 206d 6572 6765 5f61 736f  f).def merge_aso
+00032a00: 6628 0a20 2020 206c 6566 742c 0a20 2020  f(.    left,.   
+00032a10: 2072 6967 6874 2c0a 2020 2020 6f6e 3d4e   right,.    on=N
+00032a20: 6f6e 652c 0a20 2020 206c 6566 745f 6f6e  one,.    left_on
+00032a30: 3d4e 6f6e 652c 0a20 2020 2072 6967 6874  =None,.    right
+00032a40: 5f6f 6e3d 4e6f 6e65 2c0a 2020 2020 6c65  _on=None,.    le
+00032a50: 6674 5f69 6e64 6578 3d46 616c 7365 2c0a  ft_index=False,.
+00032a60: 2020 2020 7269 6768 745f 696e 6465 783d      right_index=
+00032a70: 4661 6c73 652c 0a20 2020 2062 793d 4e6f  False,.    by=No
+00032a80: 6e65 2c0a 2020 2020 6c65 6674 5f62 793d  ne,.    left_by=
+00032a90: 4e6f 6e65 2c0a 2020 2020 7269 6768 745f  None,.    right_
+00032aa0: 6279 3d4e 6f6e 652c 0a20 2020 2073 7566  by=None,.    suf
+00032ab0: 6669 7865 733d 2822 5f78 222c 2022 5f79  fixes=("_x", "_y
+00032ac0: 2229 2c0a 2020 2020 746f 6c65 7261 6e63  "),.    toleranc
+00032ad0: 653d 4e6f 6e65 2c0a 2020 2020 616c 6c6f  e=None,.    allo
+00032ae0: 775f 6578 6163 745f 6d61 7463 6865 733d  w_exact_matches=
+00032af0: 5472 7565 2c0a 2020 2020 6469 7265 6374  True,.    direct
+00032b00: 696f 6e3d 2262 6163 6b77 6172 6422 2c0a  ion="backward",.
+00032b10: 293a 0a20 2020 2069 6620 6469 7265 6374  ):.    if direct
+00032b20: 696f 6e20 6e6f 7420 696e 205b 2262 6163  ion not in ["bac
+00032b30: 6b77 6172 6422 2c20 2266 6f72 7761 7264  kward", "forward
+00032b40: 222c 2022 6e65 6172 6573 7422 5d3a 0a20  ", "nearest"]:. 
+00032b50: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00032b60: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00032b70: 2020 2020 2022 496e 7661 6c69 6420 6d65       "Invalid me
+00032b80: 7267 655f 6173 6f66 2064 6972 6563 7469  rge_asof directi
+00032b90: 6f6e 2e20 4368 6f6f 7365 2066 726f 6d20  on. Choose from 
+00032ba0: 2762 6163 6b77 6172 6427 220a 2020 2020  'backward'".    
+00032bb0: 2020 2020 2020 2020 2220 2766 6f72 7761          " 'forwa
+00032bc0: 7264 272c 206f 7220 276e 6561 7265 7374  rd', or 'nearest
+00032bd0: 2722 0a20 2020 2020 2020 2029 0a0a 2020  '".        )..  
+00032be0: 2020 6b77 6172 6773 203d 207b 0a20 2020    kwargs = {.   
+00032bf0: 2020 2020 2022 6f6e 223a 206f 6e2c 0a20       "on": on,. 
+00032c00: 2020 2020 2020 2022 6c65 6674 5f6f 6e22         "left_on"
+00032c10: 3a20 6c65 6674 5f6f 6e2c 0a20 2020 2020  : left_on,.     
+00032c20: 2020 2022 7269 6768 745f 6f6e 223a 2072     "right_on": r
+00032c30: 6967 6874 5f6f 6e2c 0a20 2020 2020 2020  ight_on,.       
+00032c40: 2022 6c65 6674 5f69 6e64 6578 223a 206c   "left_index": l
+00032c50: 6566 745f 696e 6465 782c 0a20 2020 2020  eft_index,.     
+00032c60: 2020 2022 7269 6768 745f 696e 6465 7822     "right_index"
+00032c70: 3a20 7269 6768 745f 696e 6465 782c 0a20  : right_index,. 
+00032c80: 2020 2020 2020 2022 6279 223a 2062 792c         "by": by,
+00032c90: 0a20 2020 2020 2020 2022 6c65 6674 5f62  .        "left_b
+00032ca0: 7922 3a20 6c65 6674 5f62 792c 0a20 2020  y": left_by,.   
+00032cb0: 2020 2020 2022 7269 6768 745f 6279 223a       "right_by":
+00032cc0: 2072 6967 6874 5f62 792c 0a20 2020 2020   right_by,.     
+00032cd0: 2020 2022 7375 6666 6978 6573 223a 2073     "suffixes": s
+00032ce0: 7566 6669 7865 732c 0a20 2020 2020 2020  uffixes,.       
+00032cf0: 2022 746f 6c65 7261 6e63 6522 3a20 746f   "tolerance": to
+00032d00: 6c65 7261 6e63 652c 0a20 2020 2020 2020  lerance,.       
+00032d10: 2022 616c 6c6f 775f 6578 6163 745f 6d61   "allow_exact_ma
+00032d20: 7463 6865 7322 3a20 616c 6c6f 775f 6578  tches": allow_ex
+00032d30: 6163 745f 6d61 7463 6865 732c 0a20 2020  act_matches,.   
+00032d40: 2020 2020 2022 6469 7265 6374 696f 6e22       "direction"
+00032d50: 3a20 6469 7265 6374 696f 6e2c 0a20 2020  : direction,.   
+00032d60: 207d 0a0a 2020 2020 6966 206c 6566 7420   }..    if left 
+00032d70: 6973 204e 6f6e 6520 6f72 2072 6967 6874  is None or right
+00032d80: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00032d90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00032da0: 6f72 2822 4361 6e6e 6f74 206d 6572 6765  or("Cannot merge
+00032db0: 5f61 736f 6620 6f6e 204e 6f6e 6522 290a  _asof on None").
+00032dc0: 0a20 2020 2023 2069 6620 6973 5f64 6174  .    # if is_dat
+00032dd0: 6166 7261 6d65 5f6c 696b 6528 6c65 6674  aframe_like(left
+00032de0: 2920 616e 6420 6973 5f64 6174 6166 7261  ) and is_datafra
+00032df0: 6d65 5f6c 696b 6528 7269 6768 7429 3a0a  me_like(right):.
+00032e00: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00032e10: 6528 6c65 6674 2c20 7064 2e44 6174 6146  e(left, pd.DataF
+00032e20: 7261 6d65 2920 616e 6420 6973 696e 7374  rame) and isinst
+00032e30: 616e 6365 2872 6967 6874 2c20 7064 2e44  ance(right, pd.D
+00032e40: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+00032e50: 2020 2072 6574 7572 6e20 7064 2e6d 6572     return pd.mer
+00032e60: 6765 5f61 736f 6628 6c65 6674 2c20 7269  ge_asof(left, ri
+00032e70: 6768 742c 202a 2a6b 7761 7267 7329 0a0a  ght, **kwargs)..
+00032e80: 2020 2020 6966 206f 6e20 6973 206e 6f74      if on is not
+00032e90: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+00032ea0: 6620 6c65 6674 5f6f 6e20 6973 206e 6f74  f left_on is not
+00032eb0: 204e 6f6e 6520 6f72 2072 6967 6874 5f6f   None or right_o
+00032ec0: 6e20 6973 206e 6f74 204e 6f6e 653a 0a20  n is not None:. 
+00032ed0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00032ee0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00032ef0: 2020 2020 2020 2020 2020 2020 2022 4361               "Ca
+00032f00: 6e20 6f6e 6c79 2070 6173 7320 6172 6775  n only pass argu
+00032f10: 6d65 6e74 2027 6f6e 2720 4f52 2027 6c65  ment 'on' OR 'le
+00032f20: 6674 5f6f 6e27 2061 6e64 2027 7269 6768  ft_on' and 'righ
+00032f30: 745f 6f6e 272c 206e 6f74 2061 2022 0a20  t_on', not a ". 
+00032f40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00032f50: 636f 6d62 696e 6174 696f 6e20 6f66 2062  combination of b
+00032f60: 6f74 682e 220a 2020 2020 2020 2020 2020  oth.".          
+00032f70: 2020 290a 2020 2020 2020 2020 6c65 6674    ).        left
+00032f80: 5f6f 6e20 3d20 7269 6768 745f 6f6e 203d  _on = right_on =
+00032f90: 206f 6e0a 2020 2020 2020 2020 6b77 6172   on.        kwar
+00032fa0: 6773 5b22 6c65 6674 5f6f 6e22 5d20 3d20  gs["left_on"] = 
+00032fb0: 6c65 6674 5f6f 6e0a 2020 2020 2020 2020  left_on.        
+00032fc0: 6b77 6172 6773 5b22 7269 6768 745f 6f6e  kwargs["right_on
+00032fd0: 225d 203d 2072 6967 6874 5f6f 6e0a 2020  "] = right_on.  
+00032fe0: 2020 6465 6c20 6b77 6172 6773 5b22 6f6e    del kwargs["on
+00032ff0: 225d 0a0a 2020 2020 666f 7220 6f20 696e  "]..    for o in
+00033000: 205b 6c65 6674 5f6f 6e2c 2072 6967 6874   [left_on, right
+00033010: 5f6f 6e5d 3a0a 2020 2020 2020 2020 6966  _on]:.        if
+00033020: 2069 7369 6e73 7461 6e63 6528 6f2c 205f   isinstance(o, _
+00033030: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00033040: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00033050: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+00033060: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00033070: 4461 736b 2063 6f6c 6c65 6374 696f 6e73  Dask collections
+00033080: 206e 6f74 2063 7572 7265 6e74 6c79 2061   not currently a
+00033090: 6c6c 6f77 6564 2069 6e20 6d65 7267 6520  llowed in merge 
+000330a0: 636f 6c75 6d6e 7322 0a20 2020 2020 2020  columns".       
+000330b0: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
+000330c0: 6f74 2069 735f 6461 736b 5f63 6f6c 6c65  ot is_dask_colle
+000330d0: 6374 696f 6e28 6c65 6674 293a 0a20 2020  ction(left):.   
+000330e0: 2020 2020 206c 6566 7420 3d20 6672 6f6d       left = from
+000330f0: 5f70 616e 6461 7328 6c65 6674 2c20 6e70  _pandas(left, np
+00033100: 6172 7469 7469 6f6e 733d 3129 0a0a 2020  artitions=1)..  
+00033110: 2020 6966 206e 6f74 2069 735f 6461 736b    if not is_dask
+00033120: 5f63 6f6c 6c65 6374 696f 6e28 7269 6768  _collection(righ
+00033130: 7429 3a0a 2020 2020 2020 2020 7269 6768  t):.        righ
+00033140: 7420 3d20 6672 6f6d 5f70 616e 6461 7328  t = from_pandas(
+00033150: 7269 6768 742c 206e 7061 7274 6974 696f  right, npartitio
+00033160: 6e73 3d31 290a 0a20 2020 2069 6620 6279  ns=1)..    if by
+00033170: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00033180: 2020 2020 2020 6966 206c 6566 745f 6279        if left_by
+00033190: 2069 7320 6e6f 7420 4e6f 6e65 206f 7220   is not None or 
+000331a0: 7269 6768 745f 6279 2069 7320 6e6f 7420  right_by is not 
+000331b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000331c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000331d0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000331e0: 2020 2020 2243 616e 206f 6e6c 7920 7061      "Can only pa
+000331f0: 7373 2061 7267 756d 656e 7420 2762 7927  ss argument 'by'
+00033200: 204f 5220 276c 6566 745f 6279 2720 616e   OR 'left_by' an
+00033210: 6420 2772 6967 6874 5f62 7927 2c20 6e6f  d 'right_by', no
+00033220: 7420 6120 636f 6d62 696e 6174 696f 6e20  t a combination 
+00033230: 6f66 2062 6f74 682e 220a 2020 2020 2020  of both.".      
+00033240: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00033250: 6b77 6172 6773 5b22 6c65 6674 5f62 7922  kwargs["left_by"
+00033260: 5d20 3d20 6b77 6172 6773 5b22 7269 6768  ] = kwargs["righ
+00033270: 745f 6279 225d 203d 2062 790a 2020 2020  t_by"] = by.    
+00033280: 6465 6c20 6b77 6172 6773 5b22 6279 225d  del kwargs["by"]
+00033290: 0a0a 2020 2020 6966 206c 6566 745f 6279  ..    if left_by
+000332a0: 2069 7320 4e6f 6e65 2061 6e64 2072 6967   is None and rig
+000332b0: 6874 5f62 7920 6973 206e 6f74 204e 6f6e  ht_by is not Non
+000332c0: 653a 0a20 2020 2020 2020 2072 6169 7365  e:.        raise
+000332d0: 2056 616c 7565 4572 726f 7228 224d 7573   ValueError("Mus
+000332e0: 7420 7370 6563 6966 7920 626f 7468 206c  t specify both l
+000332f0: 6566 745f 6f6e 2061 6e64 2072 6967 6874  eft_on and right
+00033300: 5f6f 6e20 6966 206f 6e65 2069 7320 7370  _on if one is sp
+00033310: 6563 6966 6965 642e 2229 0a20 2020 2069  ecified.").    i
+00033320: 6620 6c65 6674 5f62 7920 6973 206e 6f74  f left_by is not
+00033330: 204e 6f6e 6520 616e 6420 7269 6768 745f   None and right_
+00033340: 6279 2069 7320 4e6f 6e65 3a0a 2020 2020  by is None:.    
+00033350: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00033360: 7272 6f72 2822 4d75 7374 2073 7065 6369  rror("Must speci
+00033370: 6679 2062 6f74 6820 6c65 6674 5f6f 6e20  fy both left_on 
+00033380: 616e 6420 7269 6768 745f 6f6e 2069 6620  and right_on if 
+00033390: 6f6e 6520 6973 2073 7065 6369 6669 6564  one is specified
+000333a0: 2e22 290a 0a20 2020 2066 726f 6d20 6461  .")..    from da
+000333b0: 736b 5f65 7870 722e 5f6d 6572 6765 5f61  sk_expr._merge_a
+000333c0: 736f 6620 696d 706f 7274 204d 6572 6765  sof import Merge
+000333d0: 4173 6f66 0a0a 2020 2020 7265 7475 726e  Asof..    return
+000333e0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+000333f0: 4d65 7267 6541 736f 6628 6c65 6674 2c20  MergeAsof(left, 
+00033400: 7269 6768 742c 202a 2a6b 7761 7267 7329  right, **kwargs)
+00033410: 290a 0a0a 6465 6620 6672 6f6d 5f6d 6170  )...def from_map
+00033420: 280a 2020 2020 6675 6e63 2c0a 2020 2020  (.    func,.    
+00033430: 2a69 7465 7261 626c 6573 2c0a 2020 2020  *iterables,.    
+00033440: 6172 6773 3d4e 6f6e 652c 0a20 2020 206d  args=None,.    m
+00033450: 6574 613d 6e6f 5f64 6566 6175 6c74 2c0a  eta=no_default,.
+00033460: 2020 2020 6469 7669 7369 6f6e 733d 4e6f      divisions=No
+00033470: 6e65 2c0a 2020 2020 6c61 6265 6c3d 4e6f  ne,.    label=No
+00033480: 6e65 2c0a 2020 2020 656e 666f 7263 655f  ne,.    enforce_
+00033490: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+000334a0: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
+000334b0: 0a20 2020 2022 2222 4372 6561 7465 2061  .    """Create a
+000334c0: 2064 6173 6b2d 6578 7072 2063 6f6c 6c65   dask-expr colle
+000334d0: 6374 696f 6e20 6672 6f6d 2061 2063 7573  ction from a cus
+000334e0: 746f 6d20 6675 6e63 7469 6f6e 206d 6170  tom function map
+000334f0: 0a0a 2020 2020 4e4f 5445 3a20 5468 6520  ..    NOTE: The 
+00033500: 756e 6465 726c 7969 6e67 2060 6045 7870  underlying ``Exp
+00033510: 7260 6020 6f62 6a65 6374 2070 726f 6475  r`` object produ
+00033520: 6365 6420 6279 2074 6869 7320 4150 490a  ced by this API.
+00033530: 2020 2020 7769 6c6c 2073 7570 706f 7274      will support
+00033540: 2063 6f6c 756d 6e20 7072 6f6a 6563 7469   column projecti
+00033550: 6f6e 2028 7669 6120 6060 7369 6d70 6c69  on (via ``simpli
+00033560: 6679 6060 2920 6966 0a20 2020 2074 6865  fy``) if.    the
+00033570: 2060 6066 756e 6360 6020 6172 6775 6d65   ``func`` argume
+00033580: 6e74 2068 6173 2022 636f 6c75 6d6e 7322  nt has "columns"
+00033590: 2069 6e20 6974 7320 7369 676e 6174 7572   in its signatur
+000335a0: 652e 0a0a 2020 2020 2222 220a 2020 2020  e...    """.    
+000335b0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+000335c0: 616d 652e 696f 2e75 7469 6c73 2069 6d70  ame.io.utils imp
+000335d0: 6f72 7420 4461 7461 4672 616d 6549 4f46  ort DataFrameIOF
+000335e0: 756e 6374 696f 6e0a 0a20 2020 2066 726f  unction..    fro
+000335f0: 6d20 6461 736b 5f65 7870 722e 696f 2069  m dask_expr.io i
+00033600: 6d70 6f72 7420 4672 6f6d 4d61 702c 2046  mport FromMap, F
+00033610: 726f 6d4d 6170 5072 6f6a 6563 7461 626c  romMapProjectabl
+00033620: 650a 0a20 2020 2069 6620 2274 6f6b 656e  e..    if "token
+00033630: 2220 696e 206b 7761 7267 733a 0a20 2020  " in kwargs:.   
+00033640: 2020 2020 2023 2054 6869 7320 6f70 7469       # This opti
+00033650: 6f6e 2064 6f65 736e 2774 2072 6561 6c6c  on doesn't reall
+00033660: 7920 6d61 6b65 2073 656e 7365 2069 6e20  y make sense in 
+00033670: 6461 736b 2d65 7870 720a 2020 2020 2020  dask-expr.      
+00033680: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00033690: 6d65 6e74 6564 4572 726f 7228 2264 6173  mentedError("das
+000336a0: 6b5f 6578 7072 2064 6f65 7320 6e6f 7420  k_expr does not 
+000336b0: 7375 7070 6f72 7420 6120 746f 6b65 6e20  support a token 
+000336c0: 6172 6775 6d65 6e74 2e22 290a 0a20 2020  argument.")..   
+000336d0: 206c 656e 6774 6873 203d 2073 6574 2829   lengths = set()
+000336e0: 0a20 2020 2069 7465 7261 626c 6573 203d  .    iterables =
+000336f0: 206c 6973 7428 6974 6572 6162 6c65 7329   list(iterables)
+00033700: 0a20 2020 2066 6f72 2069 2c20 6974 6572  .    for i, iter
+00033710: 6162 6c65 2069 6e20 656e 756d 6572 6174  able in enumerat
+00033720: 6528 6974 6572 6162 6c65 7329 3a0a 2020  e(iterables):.  
+00033730: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00033740: 6e73 7461 6e63 6528 6974 6572 6162 6c65  nstance(iterable
+00033750: 2c20 4974 6572 6162 6c65 293a 0a20 2020  , Iterable):.   
+00033760: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00033770: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00033780: 2020 2020 2020 2020 2020 2066 2241 6c6c             f"All
+00033790: 2065 6c65 6d65 6e74 7320 6f66 2060 6974   elements of `it
+000337a0: 6572 6162 6c65 7360 206d 7573 7420 6265  erables` must be
+000337b0: 2049 7465 7261 626c 652c 2067 6f74 207b   Iterable, got {
+000337c0: 7479 7065 2869 7465 7261 626c 6529 7d22  type(iterable)}"
+000337d0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000337e0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+000337f0: 2020 2020 2020 2020 6c65 6e67 7468 732e          lengths.
+00033800: 6164 6428 6c65 6e28 6974 6572 6162 6c65  add(len(iterable
+00033810: 2929 0a20 2020 2020 2020 2065 7863 6570  )).        excep
+00033820: 7420 2841 7474 7269 6275 7465 4572 726f  t (AttributeErro
+00033830: 722c 2054 7970 6545 7272 6f72 293a 0a20  r, TypeError):. 
+00033840: 2020 2020 2020 2020 2020 2069 7465 7261             itera
+00033850: 626c 6573 5b69 5d20 3d20 6c69 7374 2869  bles[i] = list(i
+00033860: 7465 7261 626c 6529 0a20 2020 2020 2020  terable).       
+00033870: 2020 2020 206c 656e 6774 6873 2e61 6464       lengths.add
+00033880: 286c 656e 2869 7465 7261 626c 6573 5b69  (len(iterables[i
+00033890: 5d29 290a 2020 2020 6966 206c 656e 286c  ])).    if len(l
+000338a0: 656e 6774 6873 2920 3d3d 2030 3a0a 2020  engths) == 0:.  
+000338b0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000338c0: 6545 7272 6f72 2822 6066 726f 6d5f 6d61  eError("`from_ma
+000338d0: 7060 2072 6571 7569 7265 7320 6174 206c  p` requires at l
+000338e0: 6561 7374 206f 6e65 2049 7465 7261 626c  east one Iterabl
+000338f0: 6520 696e 7075 7422 290a 2020 2020 656c  e input").    el
+00033900: 6966 206c 656e 286c 656e 6774 6873 2920  if len(lengths) 
+00033910: 3e20 313a 0a20 2020 2020 2020 2072 6169  > 1:.        rai
+00033920: 7365 2056 616c 7565 4572 726f 7228 2241  se ValueError("A
+00033930: 6c6c 2060 6974 6572 6162 6c65 7360 206d  ll `iterables` m
+00033940: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
+00033950: 6520 6c65 6e67 7468 2229 0a20 2020 2069  e length").    i
+00033960: 6620 6c65 6e67 7468 7320 3d3d 207b 307d  f lengths == {0}
+00033970: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00033980: 5661 6c75 6545 7272 6f72 2822 416c 6c20  ValueError("All 
+00033990: 6069 7465 7261 626c 6573 6020 6d75 7374  `iterables` must
+000339a0: 2068 6176 6520 6120 6e6f 6e2d 7a65 726f   have a non-zero
+000339b0: 206c 656e 6774 6822 290a 0a20 2020 2023   length")..    #
+000339c0: 2043 6865 636b 2069 6620 6066 756e 6360   Check if `func`
+000339d0: 2073 7570 706f 7274 7320 636f 6c75 6d6e   supports column
+000339e0: 2070 726f 6a65 6374 696f 6e0a 2020 2020   projection.    
+000339f0: 616c 6c6f 775f 7072 6f6a 6563 7469 6f6e  allow_projection
+00033a00: 203d 2046 616c 7365 0a20 2020 2063 6f6c   = False.    col
+00033a10: 756d 6e73 5f61 7267 5f72 6571 7569 7265  umns_arg_require
+00033a20: 6420 3d20 4661 6c73 650a 2020 2020 6966  d = False.    if
+00033a30: 2070 6172 616d 203a 3d20 696e 7370 6563   param := inspec
+00033a40: 742e 7369 676e 6174 7572 6528 6675 6e63  t.signature(func
+00033a50: 292e 7061 7261 6d65 7465 7273 2e67 6574  ).parameters.get
+00033a60: 2822 636f 6c75 6d6e 7322 2c20 4e6f 6e65  ("columns", None
+00033a70: 293a 0a20 2020 2020 2020 2061 6c6c 6f77  ):.        allow
+00033a80: 5f70 726f 6a65 6374 696f 6e20 3d20 5472  _projection = Tr
+00033a90: 7565 0a20 2020 2020 2020 2063 6f6c 756d  ue.        colum
+00033aa0: 6e73 5f61 7267 5f72 6571 7569 7265 6420  ns_arg_required 
+00033ab0: 3d20 7061 7261 6d2e 6465 6661 756c 7420  = param.default 
+00033ac0: 6973 2070 6172 616d 2e65 6d70 7479 0a20  is param.empty. 
+00033ad0: 2020 2020 2020 2069 6620 6d65 7461 2069         if meta i
+00033ae0: 7320 6e6f 5f64 6566 6175 6c74 2061 6e64  s no_default and
+00033af0: 2063 6f6c 756d 6e73 5f61 7267 5f72 6571   columns_arg_req
+00033b00: 7569 7265 643a 0a20 2020 2020 2020 2020  uired:.         
+00033b10: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00033b20: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00033b30: 2020 2020 2241 7267 756d 656e 7420 6066      "Argument `f
+00033b40: 756e 6360 206f 6620 6066 726f 6d5f 6d61  unc` of `from_ma
+00033b50: 7060 2068 6173 2061 2072 6571 7569 7265  p` has a require
+00033b60: 6420 6063 6f6c 756d 6e73 6020 220a 2020  d `columns` ".  
+00033b70: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00033b80: 7061 7261 6d65 7465 7220 616e 6420 6e6f  parameter and no
+00033b90: 7420 606d 6574 6160 2070 726f 7669 6465  t `meta` provide
+00033ba0: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+00033bb0: 2020 2020 2245 6974 6865 7220 7072 6f76      "Either prov
+00033bc0: 6964 6520 606d 6574 6160 2079 6f75 7273  ide `meta` yours
+00033bd0: 656c 6620 6f72 206d 616b 6520 6063 6f6c  elf or make `col
+00033be0: 756d 6e73 6020 616e 206f 7074 696f 6e61  umns` an optiona
+00033bf0: 6c20 6172 6775 6d65 6e74 2e22 0a20 2020  l argument.".   
+00033c00: 2020 2020 2020 2020 2029 0a20 2020 2065           ).    e
+00033c10: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
+00033c20: 756e 632c 2044 6174 6146 7261 6d65 494f  unc, DataFrameIO
+00033c30: 4675 6e63 7469 6f6e 293a 0a20 2020 2020  Function):.     
+00033c40: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00033c50: 280a 2020 2020 2020 2020 2020 2020 2264  (.            "d
+00033c60: 6173 6b5f 6578 7072 2064 6f65 7320 6e6f  ask_expr does no
+00033c70: 7420 7375 7070 6f72 7420 7468 6520 4461  t support the Da
+00033c80: 7461 4672 616d 6549 4f46 756e 6374 696f  taFrameIOFunctio
+00033c90: 6e20 220a 2020 2020 2020 2020 2020 2020  n ".            
+00033ca0: 2270 726f 746f 636f 6c20 666f 7220 636f  "protocol for co
+00033cb0: 6c75 6d6e 2070 726f 6a65 6374 696f 6e2e  lumn projection.
+00033cc0: 2054 6f20 656e 6162 6c65 2063 6f6c 756d   To enable colum
+00033cd0: 6e20 220a 2020 2020 2020 2020 2020 2020  n ".            
+00033ce0: 2270 726f 6a65 6374 696f 6e2c 2070 6c65  "projection, ple
+00033cf0: 6173 6520 656e 7375 7265 2074 6861 7420  ase ensure that 
+00033d00: 7468 6520 7369 676e 6174 7572 6520 6f66  the signature of
+00033d10: 2060 6675 6e63 6020 220a 2020 2020 2020   `func` ".      
+00033d20: 2020 2020 2020 2269 6e63 6c75 6465 7320        "includes 
+00033d30: 6120 6063 6f6c 756d 6e73 3d60 206b 6579  a `columns=` key
+00033d40: 776f 7264 2061 7267 756d 656e 7420 696e  word argument in
+00033d50: 7374 6561 642e 220a 2020 2020 2020 2020  stead.".        
+00033d60: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00033d70: 2020 2020 616c 6c6f 775f 7072 6f6a 6563      allow_projec
+00033d80: 7469 6f6e 203d 2046 616c 7365 0a0a 2020  tion = False..  
+00033d90: 2020 6172 6773 203d 205b 5d20 6966 2061    args = [] if a
+00033da0: 7267 7320 6973 204e 6f6e 6520 656c 7365  rgs is None else
+00033db0: 2061 7267 730a 2020 2020 6b77 6172 6773   args.    kwargs
+00033dc0: 203d 207b 7d20 6966 206b 7761 7267 7320   = {} if kwargs 
+00033dd0: 6973 204e 6f6e 6520 656c 7365 206b 7761  is None else kwa
+00033de0: 7267 730a 2020 2020 6966 2061 6c6c 6f77  rgs.    if allow
+00033df0: 5f70 726f 6a65 6374 696f 6e3a 0a20 2020  _projection:.   
+00033e00: 2020 2020 2063 6f6c 756d 6e73 203d 206b       columns = k
+00033e10: 7761 7267 732e 706f 7028 2263 6f6c 756d  wargs.pop("colum
+00033e20: 6e73 222c 204e 6f6e 6529 0a20 2020 2020  ns", None).     
+00033e30: 2020 2072 6573 756c 7420 3d20 6e65 775f     result = new_
+00033e40: 636f 6c6c 6563 7469 6f6e 280a 2020 2020  collection(.    
+00033e50: 2020 2020 2020 2020 4672 6f6d 4d61 7050          FromMapP
+00033e60: 726f 6a65 6374 6162 6c65 280a 2020 2020  rojectable(.    
+00033e70: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00033e80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033e90: 2020 6974 6572 6162 6c65 732c 0a20 2020    iterables,.   
+00033ea0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00033eb0: 756d 6e73 2c0a 2020 2020 2020 2020 2020  umns,.          
+00033ec0: 2020 2020 2020 6172 6773 2c0a 2020 2020        args,.    
+00033ed0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
+00033ee0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00033ef0: 2020 2020 636f 6c75 6d6e 735f 6172 675f      columns_arg_
+00033f00: 7265 7175 6972 6564 2c0a 2020 2020 2020  required,.      
+00033f10: 2020 2020 2020 2020 2020 6d65 7461 2c0a            meta,.
+00033f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f30: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00033f40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033f50: 2020 6469 7669 7369 6f6e 732c 0a20 2020    divisions,.   
+00033f60: 2020 2020 2020 2020 2020 2020 206c 6162               lab
+00033f70: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+00033f80: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00033f90: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+00033fa0: 7375 6c74 203d 206e 6577 5f63 6f6c 6c65  sult = new_colle
+00033fb0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00033fc0: 2020 2046 726f 6d4d 6170 280a 2020 2020     FromMap(.    
+00033fd0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+00033fe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033ff0: 2020 6974 6572 6162 6c65 732c 0a20 2020    iterables,.   
+00034000: 2020 2020 2020 2020 2020 2020 2061 7267               arg
+00034010: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00034020: 2020 206b 7761 7267 732c 0a20 2020 2020     kwargs,.     
+00034030: 2020 2020 2020 2020 2020 206d 6574 612c             meta,
+00034040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034050: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00034060: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00034070: 2020 2064 6976 6973 696f 6e73 2c0a 2020     divisions,.  
+00034080: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00034090: 6265 6c2c 0a20 2020 2020 2020 2020 2020  bel,.           
+000340a0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+000340b0: 2069 6620 7079 6172 726f 775f 7374 7269   if pyarrow_stri
+000340c0: 6e67 735f 656e 6162 6c65 6428 293a 0a20  ngs_enabled():. 
+000340d0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+000340e0: 775f 636f 6c6c 6563 7469 6f6e 2865 7870  w_collection(exp
+000340f0: 722e 4172 726f 7753 7472 696e 6743 6f6e  r.ArrowStringCon
+00034100: 7665 7273 696f 6e28 7265 7375 6c74 2929  version(result))
+00034110: 0a20 2020 2072 6574 7572 6e20 7265 7375  .    return resu
+00034120: 6c74 0a0a 0a64 6566 2072 6570 6172 7469  lt...def reparti
+00034130: 7469 6f6e 2864 662c 2064 6976 6973 696f  tion(df, divisio
+00034140: 6e73 2c20 666f 7263 653d 4661 6c73 6529  ns, force=False)
+00034150: 3a0a 2020 2020 2222 2252 6570 6172 7469  :.    """Reparti
+00034160: 7469 6f6e 2064 6174 6166 7261 6d65 2061  tion dataframe a
+00034170: 6c6f 6e67 206e 6577 2064 6976 6973 696f  long new divisio
+00034180: 6e73 0a0a 2020 2020 4461 736b 2e44 6174  ns..    Dask.Dat
+00034190: 6146 7261 6d65 206f 626a 6563 7473 2061  aFrame objects a
+000341a0: 7265 2070 6172 7469 7469 6f6e 6564 2061  re partitioned a
+000341b0: 6c6f 6e67 2074 6865 6972 2069 6e64 6578  long their index
+000341c0: 2e20 204f 6674 656e 2077 6865 6e0a 2020  .  Often when.  
+000341d0: 2020 6d75 6c74 6970 6c65 2064 6174 6166    multiple dataf
+000341e0: 7261 6d65 7320 696e 7465 7261 6374 2077  rames interact w
+000341f0: 6520 6e65 6564 2074 6f20 616c 6967 6e20  e need to align 
+00034200: 7468 6573 6520 7061 7274 6974 696f 6e69  these partitioni
+00034210: 6e67 732e 2020 5468 650a 2020 2020 6060  ngs.  The.    ``
+00034220: 7265 7061 7274 6974 696f 6e60 6020 6675  repartition`` fu
+00034230: 6e63 7469 6f6e 2063 6f6e 7374 7275 6374  nction construct
+00034240: 7320 6120 6e65 7720 4461 7461 4672 616d  s a new DataFram
+00034250: 6520 6f62 6a65 6374 2068 6f6c 6469 6e67  e object holding
+00034260: 2074 6865 2073 616d 650a 2020 2020 6461   the same.    da
+00034270: 7461 2062 7574 2070 6172 7469 7469 6f6e  ta but partition
+00034280: 6564 206f 6e20 6469 6666 6572 656e 7420  ed on different 
+00034290: 7661 6c75 6573 2e20 2049 7420 646f 6573  values.  It does
+000342a0: 2074 6869 7320 6279 2070 6572 666f 726d   this by perform
+000342b0: 696e 6720 610a 2020 2020 7365 7175 656e  ing a.    sequen
+000342c0: 6365 206f 6620 6060 6c6f 6360 6020 616e  ce of ``loc`` an
+000342d0: 6420 6060 636f 6e63 6174 6060 2063 616c  d ``concat`` cal
+000342e0: 6c73 2074 6f20 7370 6c69 7420 616e 6420  ls to split and 
+000342f0: 6d65 7267 6520 7468 6520 7072 6576 696f  merge the previo
+00034300: 7573 0a20 2020 2067 656e 6572 6174 696f  us.    generatio
+00034310: 6e20 6f66 2070 6172 7469 7469 6f6e 732e  n of partitions.
+00034320: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00034330: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00034340: 0a20 2020 2064 6976 6973 696f 6e73 203a  .    divisions :
+00034350: 206c 6973 740a 2020 2020 2020 2020 4c69   list.        Li
+00034360: 7374 206f 6620 7061 7274 6974 696f 6e73  st of partitions
+00034370: 2074 6f20 6265 2075 7365 640a 2020 2020   to be used.    
+00034380: 666f 7263 6520 3a20 626f 6f6c 2c20 6465  force : bool, de
+00034390: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
+000343a0: 2020 2020 416c 6c6f 7773 2074 6865 2065      Allows the e
+000343b0: 7870 616e 7369 6f6e 206f 6620 7468 6520  xpansion of the 
+000343c0: 6578 6973 7469 6e67 2064 6976 6973 696f  existing divisio
+000343d0: 6e73 2e0a 2020 2020 2020 2020 4966 2046  ns..        If F
+000343e0: 616c 7365 2074 6865 6e20 7468 6520 6e65  alse then the ne
+000343f0: 7720 6469 7669 7369 6f6e 7320 6c6f 7765  w divisions lowe
+00034400: 7220 616e 6420 7570 7065 7220 626f 756e  r and upper boun
+00034410: 6473 206d 7573 7420 6265 0a20 2020 2020  ds must be.     
+00034420: 2020 2074 6865 2073 616d 6520 6173 2074     the same as t
+00034430: 6865 206f 6c64 2064 6976 6973 696f 6e73  he old divisions
+00034440: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
+00034450: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a0a 2020      --------..  
+00034460: 2020 3e3e 3e20 6466 203d 2064 662e 7265    >>> df = df.re
+00034470: 7061 7274 6974 696f 6e28 5b30 2c20 352c  partition([0, 5,
+00034480: 2031 302c 2032 305d 2920 2023 2064 6f63   10, 20])  # doc
+00034490: 7465 7374 3a20 2b53 4b49 500a 0a20 2020  test: +SKIP..   
+000344a0: 2041 6c73 6f20 776f 726b 7320 6f6e 2050   Also works on P
+000344b0: 616e 6461 7320 6f62 6a65 6374 730a 0a20  andas objects.. 
+000344c0: 2020 203e 3e3e 2064 6466 203d 2064 642e     >>> ddf = dd.
+000344d0: 7265 7061 7274 6974 696f 6e28 6466 2c20  repartition(df, 
+000344e0: 5b30 2c20 352c 2031 302c 2032 305d 2920  [0, 5, 10, 20]) 
+000344f0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00034500: 500a 2020 2020 2222 220a 2020 2020 6966  P.    """.    if
+00034510: 2069 7369 6e73 7461 6e63 6528 6466 2c20   isinstance(df, 
+00034520: 4672 616d 6542 6173 6529 3a0a 2020 2020  FrameBase):.    
+00034530: 2020 2020 7265 7475 726e 2064 662e 7265      return df.re
+00034540: 7061 7274 6974 696f 6e28 6469 7669 7369  partition(divisi
+00034550: 6f6e 733d 6469 7669 7369 6f6e 732c 2066  ons=divisions, f
+00034560: 6f72 6365 3d66 6f72 6365 290a 2020 2020  orce=force).    
+00034570: 656c 6966 2069 735f 6461 7461 6672 616d  elif is_datafram
+00034580: 655f 6c69 6b65 2864 6629 206f 7220 6973  e_like(df) or is
+00034590: 5f73 6572 6965 735f 6c69 6b65 2864 6629  _series_like(df)
+000345a0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000345b0: 206e 6577 5f63 6f6c 6c65 6374 696f 6e28   new_collection(
+000345c0: 0a20 2020 2020 2020 2020 2020 2046 726f  .            Fro
+000345d0: 6d50 616e 6461 7344 6976 6973 696f 6e73  mPandasDivisions
+000345e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000345f0: 2020 5f42 6163 6b65 6e64 4461 7461 2864    _BackendData(d
+00034600: 6629 2c0a 2020 2020 2020 2020 2020 2020  f),.            
+00034610: 2020 2020 6469 7669 7369 6f6e 733d 6469      divisions=di
+00034620: 7669 7369 6f6e 732c 0a20 2020 2020 2020  visions,.       
+00034630: 2020 2020 2020 2020 2070 7961 7272 6f77           pyarrow
+00034640: 5f73 7472 696e 6773 5f65 6e61 626c 6564  _strings_enabled
+00034650: 3d70 7961 7272 6f77 5f73 7472 696e 6773  =pyarrow_strings
+00034660: 5f65 6e61 626c 6564 2829 2c0a 2020 2020  _enabled(),.    
+00034670: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00034680: 2020 290a 2020 2020 656c 7365 3a0a 2020    ).    else:.  
+00034690: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+000346a0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+000346b0: 6622 7265 7061 7274 6974 696f 6e20 6973  f"repartition is
+000346c0: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
+000346d0: 2066 6f72 207b 7479 7065 2864 6629 7d2e   for {type(df)}.
+000346e0: 2229 0a0a 0a64 6566 2070 6976 6f74 5f74  ")...def pivot_t
+000346f0: 6162 6c65 2864 662c 2069 6e64 6578 2c20  able(df, index, 
+00034700: 636f 6c75 6d6e 732c 2076 616c 7565 732c  columns, values,
+00034710: 2061 6767 6675 6e63 3d22 6d65 616e 2229   aggfunc="mean")
+00034720: 3a0a 2020 2020 2222 220a 2020 2020 4372  :.    """.    Cr
+00034730: 6561 7465 2061 2073 7072 6561 6473 6865  eate a spreadshe
+00034740: 6574 2d73 7479 6c65 2070 6976 6f74 2074  et-style pivot t
+00034750: 6162 6c65 2061 7320 6120 4461 7461 4672  able as a DataFr
+00034760: 616d 652e 2054 6172 6765 7420 6060 636f  ame. Target ``co
+00034770: 6c75 6d6e 7360 600a 2020 2020 6d75 7374  lumns``.    must
+00034780: 2068 6176 6520 6361 7465 676f 7279 2064   have category d
+00034790: 7479 7065 2074 6f20 696e 6665 7220 7265  type to infer re
+000347a0: 7375 6c74 2773 2060 6063 6f6c 756d 6e73  sult's ``columns
+000347b0: 6060 2e0a 2020 2020 6060 696e 6465 7860  ``..    ``index`
+000347c0: 602c 2060 6063 6f6c 756d 6e73 6060 2c20  `, ``columns``, 
+000347d0: 616e 6420 6060 6167 6766 756e 6360 6020  and ``aggfunc`` 
+000347e0: 6d75 7374 2062 6520 616c 6c20 7363 616c  must be all scal
+000347f0: 6172 2e0a 2020 2020 6060 7661 6c75 6573  ar..    ``values
+00034800: 6060 2063 616e 2062 6520 7363 616c 6172  `` can be scalar
+00034810: 206f 7220 6c69 7374 2d6c 696b 652e 0a0a   or list-like...
+00034820: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00034830: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00034840: 2020 6466 203a 2044 6174 6146 7261 6d65    df : DataFrame
+00034850: 0a20 2020 2069 6e64 6578 203a 2073 6361  .    index : sca
+00034860: 6c61 720a 2020 2020 2020 2020 636f 6c75  lar.        colu
+00034870: 6d6e 2074 6f20 6265 2069 6e64 6578 0a20  mn to be index. 
+00034880: 2020 2063 6f6c 756d 6e73 203a 2073 6361     columns : sca
+00034890: 6c61 720a 2020 2020 2020 2020 636f 6c75  lar.        colu
+000348a0: 6d6e 2074 6f20 6265 2063 6f6c 756d 6e73  mn to be columns
+000348b0: 0a20 2020 2076 616c 7565 7320 3a20 7363  .    values : sc
+000348c0: 616c 6172 206f 7220 6c69 7374 2873 6361  alar or list(sca
+000348d0: 6c61 7229 0a20 2020 2020 2020 2063 6f6c  lar).        col
+000348e0: 756d 6e28 7329 2074 6f20 6167 6772 6567  umn(s) to aggreg
+000348f0: 6174 650a 2020 2020 6167 6766 756e 6320  ate.    aggfunc 
+00034900: 3a20 7b27 6d65 616e 272c 2027 7375 6d27  : {'mean', 'sum'
+00034910: 2c20 2763 6f75 6e74 272c 2027 6669 7273  , 'count', 'firs
+00034920: 7427 2c20 276c 6173 7427 7d2c 2064 6566  t', 'last'}, def
+00034930: 6175 6c74 2027 6d65 616e 270a 0a20 2020  ault 'mean'..   
+00034940: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00034950: 2d2d 2d2d 0a20 2020 2074 6162 6c65 203a  ----.    table :
+00034960: 2044 6174 6146 7261 6d65 0a0a 2020 2020   DataFrame..    
+00034970: 5365 6520 416c 736f 0a20 2020 202d 2d2d  See Also.    ---
+00034980: 2d2d 2d2d 2d0a 2020 2020 7061 6e64 6173  -----.    pandas
+00034990: 2e44 6174 6146 7261 6d65 2e70 6976 6f74  .DataFrame.pivot
+000349a0: 5f74 6162 6c65 0a20 2020 2022 2222 0a20  _table.    """. 
+000349b0: 2020 2069 6620 6e6f 7420 6973 5f73 6361     if not is_sca
+000349c0: 6c61 7228 696e 6465 7829 206f 7220 696e  lar(index) or in
+000349d0: 6465 7820 6e6f 7420 696e 2064 662e 5f6d  dex not in df._m
+000349e0: 6574 612e 636f 6c75 6d6e 733a 0a20 2020  eta.columns:.   
+000349f0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00034a00: 4572 726f 7228 2227 696e 6465 7827 206d  Error("'index' m
+00034a10: 7573 7420 6265 2074 6865 206e 616d 6520  ust be the name 
+00034a20: 6f66 2061 6e20 6578 6973 7469 6e67 2063  of an existing c
+00034a30: 6f6c 756d 6e22 290a 2020 2020 6966 206e  olumn").    if n
+00034a40: 6f74 2069 735f 7363 616c 6172 2863 6f6c  ot is_scalar(col
+00034a50: 756d 6e73 2920 6f72 2063 6f6c 756d 6e73  umns) or columns
+00034a60: 206e 6f74 2069 6e20 6466 2e5f 6d65 7461   not in df._meta
+00034a70: 2e63 6f6c 756d 6e73 3a0a 2020 2020 2020  .columns:.      
+00034a80: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00034a90: 6f72 2822 2763 6f6c 756d 6e73 2720 6d75  or("'columns' mu
+00034aa0: 7374 2062 6520 7468 6520 6e61 6d65 206f  st be the name o
+00034ab0: 6620 616e 2065 7869 7374 696e 6720 636f  f an existing co
+00034ac0: 6c75 6d6e 2229 0a20 2020 2069 6620 6e6f  lumn").    if no
+00034ad0: 7420 6d65 7468 6f64 732e 6973 5f63 6174  t methods.is_cat
+00034ae0: 6567 6f72 6963 616c 5f64 7479 7065 2864  egorical_dtype(d
+00034af0: 662e 5f6d 6574 615b 636f 6c75 6d6e 735d  f._meta[columns]
+00034b00: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+00034b10: 2056 616c 7565 4572 726f 7228 2227 636f   ValueError("'co
+00034b20: 6c75 6d6e 7327 206d 7573 7420 6265 2063  lumns' must be c
+00034b30: 6174 6567 6f72 7920 6474 7970 6522 290a  ategory dtype").
+00034b40: 2020 2020 6966 206e 6f74 2068 6173 5f6b      if not has_k
+00034b50: 6e6f 776e 5f63 6174 6567 6f72 6965 7328  nown_categories(
+00034b60: 6466 2e5f 6d65 7461 5b63 6f6c 756d 6e73  df._meta[columns
+00034b70: 5d29 3a0a 2020 2020 2020 2020 7261 6973  ]):.        rais
+00034b80: 6520 5661 6c75 6545 7272 6f72 2822 2763  e ValueError("'c
+00034b90: 6f6c 756d 6e73 2720 6d75 7374 2068 6176  olumns' must hav
+00034ba0: 6520 6b6e 6f77 6e20 6361 7465 676f 7269  e known categori
+00034bb0: 6573 2229 0a0a 2020 2020 6966 206e 6f74  es")..    if not
+00034bc0: 2028 0a20 2020 2020 2020 2069 735f 7363   (.        is_sc
+00034bd0: 616c 6172 2876 616c 7565 7329 0a20 2020  alar(values).   
+00034be0: 2020 2020 2061 6e64 2076 616c 7565 7320       and values 
+00034bf0: 696e 2064 662e 5f6d 6574 612e 636f 6c75  in df._meta.colu
+00034c00: 6d6e 730a 2020 2020 2020 2020 6f72 206e  mns.        or n
+00034c10: 6f74 2069 735f 7363 616c 6172 2876 616c  ot is_scalar(val
+00034c20: 7565 7329 0a20 2020 2020 2020 2061 6e64  ues).        and
+00034c30: 2061 6c6c 2869 735f 7363 616c 6172 2878   all(is_scalar(x
+00034c40: 2920 616e 6420 7820 696e 2064 662e 5f6d  ) and x in df._m
+00034c50: 6574 612e 636f 6c75 6d6e 7320 666f 7220  eta.columns for 
+00034c60: 7820 696e 2076 616c 7565 7329 0a20 2020  x in values).   
+00034c70: 2029 3a0a 2020 2020 2020 2020 7261 6973   ):.        rais
+00034c80: 6520 5661 6c75 6545 7272 6f72 2822 2776  e ValueError("'v
+00034c90: 616c 7565 7327 206d 7573 7420 7265 6665  alues' must refe
+00034ca0: 7220 746f 2061 6e20 6578 6973 7469 6e67  r to an existing
+00034cb0: 2063 6f6c 756d 6e20 6f72 2063 6f6c 756d   column or colum
+00034cc0: 6e73 2229 0a0a 2020 2020 6176 6169 6c61  ns")..    availa
+00034cd0: 626c 655f 6167 6766 756e 6373 203d 205b  ble_aggfuncs = [
+00034ce0: 226d 6561 6e22 2c20 2273 756d 222c 2022  "mean", "sum", "
+00034cf0: 636f 756e 7422 2c20 2266 6972 7374 222c  count", "first",
+00034d00: 2022 6c61 7374 225d 0a0a 2020 2020 6966   "last"]..    if
+00034d10: 206e 6f74 2069 735f 7363 616c 6172 2861   not is_scalar(a
+00034d20: 6767 6675 6e63 2920 6f72 2061 6767 6675  ggfunc) or aggfu
+00034d30: 6e63 206e 6f74 2069 6e20 6176 6169 6c61  nc not in availa
+00034d40: 626c 655f 6167 6766 756e 6373 3a0a 2020  ble_aggfuncs:.  
+00034d50: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00034d60: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00034d70: 2020 2020 2261 6767 6675 6e63 206d 7573      "aggfunc mus
+00034d80: 7420 6265 2065 6974 6865 7220 2220 2b20  t be either " + 
+00034d90: 222c 2022 2e6a 6f69 6e28 6622 277b 787d  ", ".join(f"'{x}
+00034da0: 2722 2066 6f72 2078 2069 6e20 6176 6169  '" for x in avai
+00034db0: 6c61 626c 655f 6167 6766 756e 6373 290a  lable_aggfuncs).
+00034dc0: 2020 2020 2020 2020 290a 0a20 2020 2072          )..    r
+00034dd0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00034de0: 7469 6f6e 280a 2020 2020 2020 2020 5069  tion(.        Pi
+00034df0: 766f 7454 6162 6c65 2864 662c 2069 6e64  votTable(df, ind
+00034e00: 6578 3d69 6e64 6578 2c20 636f 6c75 6d6e  ex=index, column
+00034e10: 733d 636f 6c75 6d6e 732c 2076 616c 7565  s=columns, value
+00034e20: 733d 7661 6c75 6573 2c20 6167 6766 756e  s=values, aggfun
+00034e30: 633d 6167 6766 756e 6329 0a20 2020 2029  c=aggfunc).    )
+00034e40: 0a0a 0a40 6465 7269 7665 645f 6672 6f6d  ...@derived_from
+00034e50: 2870 642c 2075 615f 6172 6773 3d5b 2264  (pd, ua_args=["d
+00034e60: 6f77 6e63 6173 7422 5d29 0a64 6566 2074  owncast"]).def t
+00034e70: 6f5f 6e75 6d65 7269 6328 6172 672c 2065  o_numeric(arg, e
+00034e80: 7272 6f72 733d 2272 6169 7365 222c 2064  rrors="raise", d
+00034e90: 6f77 6e63 6173 743d 4e6f 6e65 2c20 6d65  owncast=None, me
+00034ea0: 7461 3d4e 6f6e 6529 3a0a 2020 2020 2222  ta=None):.    ""
+00034eb0: 220a 2020 2020 5265 7475 726e 2074 7970  ".    Return typ
+00034ec0: 6520 6465 7065 6e64 7320 6f6e 2069 6e70  e depends on inp
+00034ed0: 7574 2e20 4465 6c61 7965 6420 6966 2073  ut. Delayed if s
+00034ee0: 6361 6c61 722c 206f 7468 6572 7769 7365  calar, otherwise
+00034ef0: 2073 616d 6520 6173 2069 6e70 7574 2e0a   same as input..
+00034f00: 2020 2020 466f 7220 6572 726f 7273 2c20      For errors, 
+00034f10: 6f6e 6c79 2022 7261 6973 6522 2061 6e64  only "raise" and
+00034f20: 2022 636f 6572 6365 2220 6172 6520 616c   "coerce" are al
+00034f30: 6c6f 7765 642e 0a20 2020 2022 2222 0a20  lowed..    """. 
+00034f40: 2020 2069 6620 6572 726f 7273 206e 6f74     if errors not
+00034f50: 2069 6e20 2822 7261 6973 6522 2c20 2263   in ("raise", "c
+00034f60: 6f65 7263 6522 293a 0a20 2020 2020 2020  oerce"):.       
+00034f70: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00034f80: 7228 2269 6e76 616c 6964 2065 7272 6f72  r("invalid error
+00034f90: 2076 616c 7565 2073 7065 6369 6669 6564   value specified
+00034fa0: 2229 0a0a 2020 2020 6966 2070 645f 6973  ")..    if pd_is
+00034fb0: 5f73 6361 6c61 7228 6172 6729 3a0a 2020  _scalar(arg):.  
+00034fc0: 2020 2020 2020 6966 206d 6574 6120 6973        if meta is
+00034fd0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00034fe0: 2020 2020 2020 2072 6169 7365 204b 6579         raise Key
+00034ff0: 4572 726f 7228 2260 606d 6574 6160 6020  Error("``meta`` 
+00035000: 6973 206e 6f74 2061 6c6c 6f77 6564 2077  is not allowed w
+00035010: 6865 6e20 696e 7075 7420 6973 2061 2073  hen input is a s
+00035020: 6361 6c61 722e 2229 0a20 2020 2020 2020  calar.").       
+00035030: 2072 6574 7572 6e20 6465 6c61 7965 6428   return delayed(
+00035040: 7064 2e74 6f5f 6e75 6d65 7269 632c 2070  pd.to_numeric, p
+00035050: 7572 653d 5472 7565 2928 6172 672c 2065  ure=True)(arg, e
+00035060: 7272 6f72 733d 6572 726f 7273 2c20 646f  rrors=errors, do
+00035070: 776e 6361 7374 3d64 6f77 6e63 6173 7429  wncast=downcast)
+00035080: 0a0a 2020 2020 6966 2069 735f 6172 7261  ..    if is_arra
+00035090: 796c 696b 6528 6172 6729 3a0a 2020 2020  ylike(arg):.    
+000350a0: 2020 2020 7265 7475 726e 206e 6577 5f63      return new_c
+000350b0: 6f6c 6c65 6374 696f 6e28 0a20 2020 2020  ollection(.     
+000350c0: 2020 2020 2020 2054 6f4e 756d 6572 6963         ToNumeric
+000350d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000350e0: 2020 6672 6f6d 5f61 7272 6179 2861 7267    from_array(arg
+000350f0: 292e 6173 7479 7065 2861 7267 2e64 7479  ).astype(arg.dty
+00035100: 7065 292c 2065 7272 6f72 733d 6572 726f  pe), errors=erro
+00035110: 7273 2c20 646f 776e 6361 7374 3d64 6f77  rs, downcast=dow
+00035120: 6e63 6173 740a 2020 2020 2020 2020 2020  ncast.          
+00035130: 2020 290a 2020 2020 2020 2020 292e 746f    ).        ).to
+00035140: 5f64 6173 6b5f 6172 7261 7928 6d65 7461  _dask_array(meta
+00035150: 3d6d 6574 6129 0a0a 2020 2020 6966 2069  =meta)..    if i
+00035160: 735f 7365 7269 6573 5f6c 696b 6528 6172  s_series_like(ar
+00035170: 6729 3a0a 2020 2020 2020 2020 7265 7475  g):.        retu
+00035180: 726e 206e 6577 5f63 6f6c 6c65 6374 696f  rn new_collectio
+00035190: 6e28 0a20 2020 2020 2020 2020 2020 2054  n(.            T
+000351a0: 6f4e 756d 6572 6963 2866 7261 6d65 3d61  oNumeric(frame=a
+000351b0: 7267 2c20 6572 726f 7273 3d65 7272 6f72  rg, errors=error
+000351c0: 732c 2064 6f77 6e63 6173 743d 646f 776e  s, downcast=down
+000351d0: 6361 7374 2c20 6d65 7461 3d6d 6574 6129  cast, meta=meta)
+000351e0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000351f0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00035200: 0a20 2020 2020 2020 2022 6172 6720 6d75  .        "arg mu
+00035210: 7374 2062 6520 6120 6c69 7374 2c20 7475  st be a list, tu
+00035220: 706c 652c 2064 6173 6b2e 6172 7261 792e  ple, dask.array.
+00035230: 4172 7261 792c 206f 7220 6461 736b 2e64  Array, or dask.d
+00035240: 6174 6166 7261 6d65 2e53 6572 6965 7322  ataframe.Series"
+00035250: 0a20 2020 2029 0a0a 0a40 7772 6170 7328  .    )...@wraps(
+00035260: 7064 2e74 6f5f 6461 7465 7469 6d65 290a  pd.to_datetime).
+00035270: 6465 6620 746f 5f64 6174 6574 696d 6528  def to_datetime(
+00035280: 6172 672c 206d 6574 613d 4e6f 6e65 2c20  arg, meta=None, 
+00035290: 2a2a 6b77 6172 6773 293a 0a20 2020 2074  **kwargs):.    t
+000352a0: 7a5f 6b77 6172 6720 3d20 7b22 747a 223a  z_kwarg = {"tz":
+000352b0: 2022 7574 6322 7d20 6966 206b 7761 7267   "utc"} if kwarg
+000352c0: 732e 6765 7428 2275 7463 2229 2065 6c73  s.get("utc") els
+000352d0: 6520 7b7d 0a0a 2020 2020 2861 7267 2c29  e {}..    (arg,)
+000352e0: 203d 205f 6d61 7962 655f 6672 6f6d 5f70   = _maybe_from_p
+000352f0: 616e 6461 7328 5b61 7267 5d29 0a0a 2020  andas([arg])..  
+00035300: 2020 6966 206d 6574 6120 6973 204e 6f6e    if meta is Non
+00035310: 653a 0a20 2020 2020 2020 2069 6620 6973  e:.        if is
+00035320: 696e 7374 616e 6365 2861 7267 2c20 496e  instance(arg, In
+00035330: 6465 7829 3a0a 2020 2020 2020 2020 2020  dex):.          
+00035340: 2020 6d65 7461 203d 2067 6574 5f6d 6574    meta = get_met
+00035350: 615f 6c69 6272 6172 7928 6172 6729 2e44  a_library(arg).D
+00035360: 6174 6574 696d 6549 6e64 6578 285b 5d2c  atetimeIndex([],
+00035370: 202a 2a74 7a5f 6b77 6172 6729 0a20 2020   **tz_kwarg).   
+00035380: 2020 2020 2020 2020 206d 6574 612e 6e61           meta.na
+00035390: 6d65 203d 2061 7267 2e6e 616d 650a 2020  me = arg.name.  
+000353a0: 2020 2020 2020 656c 6966 206e 6f74 2028        elif not (
+000353b0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+000353c0: 6528 6172 6729 206f 7220 6973 5f73 6572  e(arg) or is_ser
+000353d0: 6965 735f 6c69 6b65 2861 7267 2929 3a0a  ies_like(arg)):.
+000353e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000353f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00035400: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00035410: 2020 2020 2020 2022 6461 736b 2e64 6174         "dask.dat
+00035420: 6166 7261 6d65 2e74 6f5f 6461 7465 7469  aframe.to_dateti
+00035430: 6d65 2064 6f65 7320 6e6f 7420 7375 7070  me does not supp
+00035440: 6f72 7420 220a 2020 2020 2020 2020 2020  ort ".          
+00035450: 2020 2020 2020 226e 6f6e 2d69 6e64 6578        "non-index
+00035460: 2d61 626c 6520 6172 6775 6d65 6e74 7320  -able arguments 
+00035470: 286c 696b 6520 7363 616c 6172 7329 220a  (like scalars)".
+00035480: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00035490: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000354a0: 2020 2020 2020 2020 6d65 7461 203d 206d          meta = m
+000354b0: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
+000354c0: 7275 6374 6f72 2861 7267 2928 5b70 642e  ructor(arg)([pd.
+000354d0: 5469 6d65 7374 616d 7028 2232 3030 3022  Timestamp("2000"
+000354e0: 2c20 2a2a 747a 5f6b 7761 7267 295d 290a  , **tz_kwarg)]).
+000354f0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00035500: 2e69 6e64 6578 203d 206d 6574 612e 696e  .index = meta.in
+00035510: 6465 782e 6173 7479 7065 2861 7267 2e69  dex.astype(arg.i
+00035520: 6e64 6578 2e64 7479 7065 290a 2020 2020  ndex.dtype).    
+00035530: 2020 2020 2020 2020 6d65 7461 2e69 6e64          meta.ind
+00035540: 6578 2e6e 616d 6520 3d20 6172 672e 696e  ex.name = arg.in
+00035550: 6465 782e 6e61 6d65 0a0a 2020 2020 6b77  dex.name..    kw
+00035560: 6172 6773 2e70 6f70 2822 696e 6665 725f  args.pop("infer_
+00035570: 6461 7465 7469 6d65 5f66 6f72 6d61 7422  datetime_format"
+00035580: 2c20 4e6f 6e65 290a 0a20 2020 2072 6574  , None)..    ret
+00035590: 7572 6e20 6e65 775f 636f 6c6c 6563 7469  urn new_collecti
+000355a0: 6f6e 2854 6f44 6174 6574 696d 6528 6672  on(ToDatetime(fr
+000355b0: 616d 653d 6172 672c 206b 7761 7267 733d  ame=arg, kwargs=
+000355c0: 6b77 6172 6773 2c20 6d65 7461 3d6d 6574  kwargs, meta=met
+000355d0: 6129 290a 0a0a 4077 7261 7073 2870 642e  a))...@wraps(pd.
+000355e0: 746f 5f74 696d 6564 656c 7461 290a 6465  to_timedelta).de
+000355f0: 6620 746f 5f74 696d 6564 656c 7461 2861  f to_timedelta(a
+00035600: 7267 2c20 756e 6974 3d4e 6f6e 652c 2065  rg, unit=None, e
+00035610: 7272 6f72 733d 2272 6169 7365 2229 3a0a  rrors="raise"):.
+00035620: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00035630: 7461 6e63 6528 6172 672c 2053 6572 6965  tance(arg, Serie
+00035640: 7329 3a0a 2020 2020 2020 2020 7261 6973  s):.        rais
+00035650: 6520 5479 7065 4572 726f 7228 2261 7267  e TypeError("arg
+00035660: 206d 7573 7420 6265 2061 2053 6572 6965   must be a Serie
+00035670: 7322 290a 2020 2020 7265 7475 726e 206e  s").    return n
+00035680: 6577 5f63 6f6c 6c65 6374 696f 6e28 546f  ew_collection(To
+00035690: 5469 6d65 6465 6c74 6128 6672 616d 653d  Timedelta(frame=
+000356a0: 6172 672c 2075 6e69 743d 756e 6974 2c20  arg, unit=unit, 
+000356b0: 6572 726f 7273 3d65 7272 6f72 7329 290a  errors=errors)).
+000356c0: 0a0a 6465 6620 5f66 726f 6d5f 7363 616c  ..def _from_scal
+000356d0: 6172 7328 7363 616c 6172 732c 206d 6574  ars(scalars, met
+000356e0: 612c 206e 616d 6573 293a 0a20 2020 2072  a, names):.    r
+000356f0: 6574 7572 6e20 6e65 775f 636f 6c6c 6563  eturn new_collec
+00035700: 7469 6f6e 2846 726f 6d53 6361 6c61 7273  tion(FromScalars
+00035710: 286d 6574 612c 206e 616d 6573 2c20 2a73  (meta, names, *s
+00035720: 6361 6c61 7273 2929 0a0a 0a40 696e 7365  calars))...@inse
+00035730: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
+00035740: 7363 7269 7074 696f 6e0a 6465 6620 6d61  scription.def ma
+00035750: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+00035760: 2020 6675 6e63 2c0a 2020 2020 2a61 7267    func,.    *arg
+00035770: 732c 0a20 2020 206d 6574 613d 6e6f 5f64  s,.    meta=no_d
+00035780: 6566 6175 6c74 2c0a 2020 2020 656e 666f  efault,.    enfo
+00035790: 7263 655f 6d65 7461 6461 7461 3d54 7275  rce_metadata=Tru
+000357a0: 652c 0a20 2020 2074 7261 6e73 666f 726d  e,.    transform
+000357b0: 5f64 6976 6973 696f 6e73 3d54 7275 652c  _divisions=True,
+000357c0: 0a20 2020 2063 6c65 6172 5f64 6976 6973  .    clear_divis
+000357d0: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
+000357e0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+000357f0: 3d46 616c 7365 2c0a 2020 2020 7061 7265  =False,.    pare
+00035800: 6e74 5f6d 6574 613d 4e6f 6e65 2c0a 2020  nt_meta=None,.  
+00035810: 2020 2a2a 6b77 6172 6773 2c0a 293a 0a20    **kwargs,.):. 
+00035820: 2020 2022 2222 4170 706c 7920 5079 7468     """Apply Pyth
+00035830: 6f6e 2066 756e 6374 696f 6e20 6f6e 2065  on function on e
+00035840: 6163 6820 4461 7461 4672 616d 6520 7061  ach DataFrame pa
+00035850: 7274 6974 696f 6e2e 0a0a 2020 2020 5061  rtition...    Pa
+00035860: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00035870: 2d2d 2d2d 2d2d 2d0a 2020 2020 6675 6e63  -------.    func
+00035880: 203a 2066 756e 6374 696f 6e0a 2020 2020   : function.    
+00035890: 2020 2020 4675 6e63 7469 6f6e 2061 7070      Function app
+000358a0: 6c69 6564 2074 6f20 6561 6368 2070 6172  lied to each par
+000358b0: 7469 7469 6f6e 2e0a 2020 2020 6172 6773  tition..    args
+000358c0: 2c20 6b77 6172 6773 203a 0a20 2020 2020  , kwargs :.     
+000358d0: 2020 2041 7267 756d 656e 7473 2061 6e64     Arguments and
+000358e0: 206b 6579 776f 7264 7320 746f 2070 6173   keywords to pas
+000358f0: 7320 746f 2074 6865 2066 756e 6374 696f  s to the functio
+00035900: 6e2e 2020 4174 206c 6561 7374 206f 6e65  n.  At least one
+00035910: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00035920: 6172 6773 2073 686f 756c 6420 6265 2061  args should be a
+00035930: 2044 6173 6b2e 6461 7461 6672 616d 652e   Dask.dataframe.
+00035940: 2041 7267 756d 656e 7473 2061 6e64 206b   Arguments and k
+00035950: 6579 776f 7264 7320 6d61 7920 636f 6e74  eywords may cont
+00035960: 6169 6e0a 2020 2020 2020 2020 6060 5363  ain.        ``Sc
+00035970: 616c 6172 6060 2c20 6060 4465 6c61 7965  alar``, ``Delaye
+00035980: 6460 6020 6f72 2072 6567 756c 6172 2070  d`` or regular p
+00035990: 7974 686f 6e20 6f62 6a65 6374 732e 2044  ython objects. D
+000359a0: 6174 6146 7261 6d65 2d6c 696b 6520 6172  ataFrame-like ar
+000359b0: 6773 0a20 2020 2020 2020 2028 626f 7468  gs.        (both
+000359c0: 2064 6173 6b20 616e 6420 7061 6e64 6173   dask and pandas
+000359d0: 2920 7769 6c6c 2062 6520 7265 7061 7274  ) will be repart
+000359e0: 6974 696f 6e65 6420 746f 2061 6c69 676e  itioned to align
+000359f0: 2028 6966 206e 6563 6573 7361 7279 290a   (if necessary).
+00035a00: 2020 2020 2020 2020 6265 666f 7265 2061          before a
+00035a10: 7070 6c79 696e 6720 7468 6520 6675 6e63  pplying the func
+00035a20: 7469 6f6e 2028 7365 6520 6060 616c 6967  tion (see ``alig
+00035a30: 6e5f 6461 7461 6672 616d 6573 6060 2074  n_dataframes`` t
+00035a40: 6f20 636f 6e74 726f 6c29 2e0a 2020 2020  o control)..    
+00035a50: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00035a60: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+00035a70: 2054 7275 650a 2020 2020 2020 2020 5768   True.        Wh
+00035a80: 6574 6865 7220 746f 2065 6e66 6f72 6365  ether to enforce
+00035a90: 2061 7420 7275 6e74 696d 6520 7468 6174   at runtime that
+00035aa0: 2074 6865 2073 7472 7563 7475 7265 206f   the structure o
+00035ab0: 6620 7468 6520 4461 7461 4672 616d 650a  f the DataFrame.
+00035ac0: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
+00035ad0: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
+00035ae0: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
+00035af0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
+00035b00: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
+00035b10: 2054 6869 7320 7769 6c6c 2072 656e 616d   This will renam
+00035b20: 6520 616e 6420 7265 6f72 6465 7220 636f  e and reorder co
+00035b30: 6c75 6d6e 7320 666f 7220 6561 6368 2070  lumns for each p
+00035b40: 6172 7469 7469 6f6e 2c0a 2020 2020 2020  artition,.      
+00035b50: 2020 616e 6420 7769 6c6c 2072 6169 7365    and will raise
+00035b60: 2061 6e20 6572 726f 7220 6966 2074 6869   an error if thi
+00035b70: 7320 646f 6573 6e27 7420 776f 726b 2c0a  s doesn't work,.
+00035b80: 2020 2020 2020 2020 6275 7420 6974 2077          but it w
+00035b90: 6f6e 2774 2072 6169 7365 2069 6620 6474  on't raise if dt
+00035ba0: 7970 6573 2064 6f6e 2774 206d 6174 6368  ypes don't match
+00035bb0: 2e0a 2020 2020 7472 616e 7366 6f72 6d5f  ..    transform_
+00035bc0: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
+00035bd0: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+00035be0: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00035bf0: 6f20 6170 706c 7920 7468 6520 6675 6e63  o apply the func
+00035c00: 7469 6f6e 206f 6e74 6f20 7468 6520 6469  tion onto the di
+00035c10: 7669 7369 6f6e 7320 616e 6420 6170 706c  visions and appl
+00035c20: 7920 7468 6f73 650a 2020 2020 2020 2020  y those.        
+00035c30: 7472 616e 7366 6f72 6d65 6420 6469 7669  transformed divi
+00035c40: 7369 6f6e 7320 746f 2074 6865 206f 7574  sions to the out
+00035c50: 7075 742e 0a20 2020 2061 6c69 676e 5f64  put..    align_d
+00035c60: 6174 6166 7261 6d65 7320 3a20 626f 6f6c  ataframes : bool
+00035c70: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
+00035c80: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00035c90: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
+00035ca0: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
+00035cb0: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
+00035cc0: 2020 2020 2028 626f 7468 2064 6173 6b20       (both dask 
+00035cd0: 616e 6420 7061 6e64 6173 2920 736f 2074  and pandas) so t
+00035ce0: 6865 6972 2064 6976 6973 696f 6e73 2061  heir divisions a
+00035cf0: 6c69 676e 2062 6566 6f72 6520 6170 706c  lign before appl
+00035d00: 7969 6e67 0a20 2020 2020 2020 2074 6865  ying.        the
+00035d10: 2066 756e 6374 696f 6e2e 2054 6869 7320   function. This 
+00035d20: 7265 7175 6972 6573 2061 6c6c 2069 6e70  requires all inp
+00035d30: 7574 7320 746f 2068 6176 6520 6b6e 6f77  uts to have know
+00035d40: 6e20 6469 7669 7369 6f6e 732e 0a20 2020  n divisions..   
+00035d50: 2020 2020 2053 696e 676c 652d 7061 7274       Single-part
+00035d60: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
+00035d70: 6c20 6265 2073 706c 6974 2069 6e74 6f20  l be split into 
+00035d80: 6d75 6c74 6970 6c65 2070 6172 7469 7469  multiple partiti
+00035d90: 6f6e 732e 0a0a 2020 2020 2020 2020 4966  ons...        If
+00035da0: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
+00035db0: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
+00035dc0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
+00035dd0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+00035de0: 730a 2020 2020 2020 2020 6f72 2061 2073  s.        or a s
+00035df0: 696e 676c 6520 7061 7274 6974 696f 6e2e  ingle partition.
+00035e00: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
+00035e10: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
+00035e20: 2062 726f 6164 6361 7374 2074 6f0a 2020   broadcast to.  
+00035e30: 2020 2020 2020 6576 6572 7920 7061 7274        every part
+00035e40: 6974 696f 6e20 6f66 206d 756c 7469 2d70  ition of multi-p
+00035e50: 6172 7469 7469 6f6e 2069 6e70 7574 732e  artition inputs.
+00035e60: 0a20 2020 2024 4d45 5441 0a20 2020 2022  .    $META.    "
+00035e70: 2222 0a20 2020 2069 6620 616c 6967 6e5f  "".    if align_
+00035e80: 6461 7461 6672 616d 6573 3a0a 2020 2020  dataframes:.    
+00035e90: 2020 2020 2320 544f 444f 3a20 4861 6e64      # TODO: Hand
+00035ea0: 6c65 2061 6c69 676e 6d65 6e74 3f0a 2020  le alignment?.  
+00035eb0: 2020 2020 2020 2320 5065 7268 6170 7320        # Perhaps 
+00035ec0: 7765 206f 6e6c 7920 6861 6e64 6c65 2074  we only handle t
+00035ed0: 6865 2063 6173 6520 7468 6174 2061 6c6c  he case that all
+00035ee0: 2060 4578 7072 6020 6f70 6572 616e 6473   `Expr` operands
+00035ef0: 0a20 2020 2020 2020 2023 2068 6176 6520  .        # have 
+00035f00: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
+00035f10: 6f66 2070 6172 7469 7469 6f6e 7320 6f72  of partitions or
+00035f20: 2063 616e 2062 6520 6272 6f61 6463 6173   can be broadcas
+00035f30: 7465 640a 2020 2020 2020 2020 2320 7769  ted.        # wi
+00035f40: 7468 696e 2060 4d61 7050 6172 7469 7469  thin `MapPartiti
+00035f50: 6f6e 7360 2e20 4966 2073 6f2c 2074 6865  ons`. If so, the
+00035f60: 2060 6d61 705f 7061 7274 6974 696f 6e73   `map_partitions
+00035f70: 6020 4150 490a 2020 2020 2020 2020 2320  ` API.        # 
+00035f80: 7769 6c6c 206e 6565 6420 746f 2063 616c  will need to cal
+00035f90: 6c20 6052 6570 6172 7469 7469 6f6e 6020  l `Repartition` 
+00035fa0: 6f6e 206f 7065 7261 6e64 7320 7468 6174  on operands that
+00035fb0: 2061 7265 206e 6f74 0a20 2020 2020 2020   are not.       
+00035fc0: 2023 2061 6c69 676e 6564 2077 6974 6820   # aligned with 
+00035fd0: 6073 656c 662e 6578 7072 602e 0a20 2020  `self.expr`..   
+00035fe0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00035ff0: 706c 656d 656e 7465 6445 7272 6f72 2829  plementedError()
+00036000: 0a20 2020 206e 6577 5f65 7870 7220 3d20  .    new_expr = 
+00036010: 6578 7072 2e4d 6170 5061 7274 6974 696f  expr.MapPartitio
+00036020: 6e73 280a 2020 2020 2020 2020 6172 6773  ns(.        args
+00036030: 5b30 5d2c 0a20 2020 2020 2020 2066 756e  [0],.        fun
+00036040: 632c 0a20 2020 2020 2020 206d 6574 612c  c,.        meta,
+00036050: 0a20 2020 2020 2020 2065 6e66 6f72 6365  .        enforce
+00036060: 5f6d 6574 6164 6174 612c 0a20 2020 2020  _metadata,.     
+00036070: 2020 2074 7261 6e73 666f 726d 5f64 6976     transform_div
+00036080: 6973 696f 6e73 2c0a 2020 2020 2020 2020  isions,.        
+00036090: 636c 6561 725f 6469 7669 7369 6f6e 732c  clear_divisions,
+000360a0: 0a20 2020 2020 2020 2061 6c69 676e 5f64  .        align_d
+000360b0: 6174 6166 7261 6d65 732c 0a20 2020 2020  ataframes,.     
+000360c0: 2020 2070 6172 656e 745f 6d65 7461 2c0a     parent_meta,.
+000360d0: 2020 2020 2020 2020 6b77 6172 6773 2e70          kwargs.p
+000360e0: 6f70 2822 746f 6b65 6e22 2c20 4e6f 6e65  op("token", None
+000360f0: 292c 0a20 2020 2020 2020 206b 7761 7267  ),.        kwarg
+00036100: 732c 0a20 2020 2020 2020 202a 6172 6773  s,.        *args
+00036110: 5b31 3a5d 2c0a 2020 2020 290a 2020 2020  [1:],.    ).    
+00036120: 7265 7475 726e 206e 6577 5f63 6f6c 6c65  return new_colle
+00036130: 6374 696f 6e28 6e65 775f 6578 7072 290a  ction(new_expr).
+00036140: 0a0a 4069 6e73 6572 745f 6d65 7461 5f70  ..@insert_meta_p
+00036150: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
+00036160: 0a64 6566 206d 6170 5f6f 7665 726c 6170  .def map_overlap
+00036170: 280a 2020 2020 6675 6e63 2c0a 2020 2020  (.    func,.    
+00036180: 6466 2c0a 2020 2020 6265 666f 7265 2c0a  df,.    before,.
+00036190: 2020 2020 6166 7465 722c 0a20 2020 202a      after,.    *
+000361a0: 6172 6773 2c0a 2020 2020 6d65 7461 3d6e  args,.    meta=n
+000361b0: 6f5f 6465 6661 756c 742c 0a20 2020 2065  o_default,.    e
+000361c0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+000361d0: 5472 7565 2c0a 2020 2020 7472 616e 7366  True,.    transf
+000361e0: 6f72 6d5f 6469 7669 7369 6f6e 733d 5472  orm_divisions=Tr
+000361f0: 7565 2c0a 2020 2020 636c 6561 725f 6469  ue,.    clear_di
+00036200: 7669 7369 6f6e 733d 4661 6c73 652c 0a20  visions=False,. 
+00036210: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
+00036220: 6d65 733d 4661 6c73 652c 0a20 2020 202a  mes=False,.    *
+00036230: 2a6b 7761 7267 732c 0a29 3a0a 2020 2020  *kwargs,.):.    
+00036240: 2222 2241 7070 6c79 2061 2066 756e 6374  """Apply a funct
+00036250: 696f 6e20 746f 2065 6163 6820 7061 7274  ion to each part
+00036260: 6974 696f 6e2c 2073 6861 7269 6e67 2072  ition, sharing r
+00036270: 6f77 7320 7769 7468 2061 646a 6163 656e  ows with adjacen
+00036280: 7420 7061 7274 6974 696f 6e73 2e0a 0a20  t partitions... 
+00036290: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000362a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000362b0: 2066 756e 6320 3a20 6675 6e63 7469 6f6e   func : function
+000362c0: 0a20 2020 2020 2020 2054 6865 2066 756e  .        The fun
+000362d0: 6374 696f 6e20 6170 706c 6965 6420 746f  ction applied to
+000362e0: 2065 6163 6820 7061 7274 6974 696f 6e2e   each partition.
+000362f0: 2049 6620 7468 6973 2066 756e 6374 696f   If this functio
+00036300: 6e20 6163 6365 7074 730a 2020 2020 2020  n accepts.      
+00036310: 2020 7468 6520 7370 6563 6961 6c20 6060    the special ``
+00036320: 7061 7274 6974 696f 6e5f 696e 666f 6060  partition_info``
+00036330: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+00036340: 742c 2069 7420 7769 6c6c 2072 6563 6569  t, it will recei
+00036350: 7665 0a20 2020 2020 2020 2069 6e66 6f72  ve.        infor
+00036360: 6d61 7469 6f6e 206f 6e20 7468 6520 7061  mation on the pa
+00036370: 7274 6974 696f 6e27 7320 7265 6c61 7469  rtition's relati
+00036380: 7665 206c 6f63 6174 696f 6e20 7769 7468  ve location with
+00036390: 696e 2074 6865 0a20 2020 2020 2020 2064  in the.        d
+000363a0: 6174 6166 7261 6d65 2e0a 2020 2020 6466  ataframe..    df
+000363b0: 3a20 6464 2e44 6174 6146 7261 6d65 2c20  : dd.DataFrame, 
+000363c0: 6464 2e53 6572 6965 730a 2020 2020 6172  dd.Series.    ar
+000363d0: 6773 2c20 6b77 6172 6773 203a 0a20 2020  gs, kwargs :.   
+000363e0: 2020 2020 2050 6f73 6974 696f 6e61 6c20       Positional 
+000363f0: 616e 6420 6b65 7977 6f72 6420 6172 6775  and keyword argu
+00036400: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
+00036410: 2074 6865 2066 756e 6374 696f 6e2e 0a20   the function.. 
+00036420: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
+00036430: 6c20 6172 6775 6d65 6e74 7320 6172 6520  l arguments are 
+00036440: 636f 6d70 7574 6564 206f 6e20 6120 7065  computed on a pe
+00036450: 722d 7061 7274 6974 696f 6e20 6261 7369  r-partition basi
+00036460: 732c 2077 6869 6c65 0a20 2020 2020 2020  s, while.       
+00036470: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+00036480: 7473 2061 7265 2073 6861 7265 6420 6163  ts are shared ac
+00036490: 726f 7373 2061 6c6c 2070 6172 7469 7469  ross all partiti
+000364a0: 6f6e 732e 2054 6865 2070 6172 7469 7469  ons. The partiti
+000364b0: 6f6e 0a20 2020 2020 2020 2069 7473 656c  on.        itsel
+000364c0: 6620 7769 6c6c 2062 6520 7468 6520 6669  f will be the fi
+000364d0: 7273 7420 706f 7369 7469 6f6e 616c 2061  rst positional a
+000364e0: 7267 756d 656e 742c 2077 6974 6820 616c  rgument, with al
+000364f0: 6c20 6f74 6865 720a 2020 2020 2020 2020  l other.        
+00036500: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
+00036510: 202a 6166 7465 722a 2e20 4172 6775 6d65   *after*. Argume
+00036520: 6e74 7320 6361 6e20 6265 2060 6053 6361  nts can be ``Sca
+00036530: 6c61 7260 602c 2060 6044 656c 6179 6564  lar``, ``Delayed
+00036540: 6060 2c0a 2020 2020 2020 2020 6f72 2072  ``,.        or r
+00036550: 6567 756c 6172 2050 7974 686f 6e20 6f62  egular Python ob
+00036560: 6a65 6374 732e 2044 6174 6146 7261 6d65  jects. DataFrame
+00036570: 2d6c 696b 6520 6172 6773 2028 626f 7468  -like args (both
+00036580: 2064 6173 6b20 616e 640a 2020 2020 2020   dask and.      
+00036590: 2020 7061 6e64 6173 2920 7769 6c6c 2062    pandas) will b
+000365a0: 6520 7265 7061 7274 6974 696f 6e65 6420  e repartitioned 
+000365b0: 746f 2061 6c69 676e 2028 6966 206e 6563  to align (if nec
+000365c0: 6573 7361 7279 2920 6265 666f 7265 0a20  essary) before. 
+000365d0: 2020 2020 2020 2061 7070 6c79 696e 6720         applying 
+000365e0: 7468 6520 6675 6e63 7469 6f6e 3b20 7365  the function; se
+000365f0: 6520 6060 616c 6967 6e5f 6461 7461 6672  e ``align_datafr
+00036600: 616d 6573 6060 2074 6f20 636f 6e74 726f  ames`` to contro
+00036610: 6c20 7468 6973 0a20 2020 2020 2020 2062  l this.        b
+00036620: 6568 6176 696f 722e 0a20 2020 2065 6e66  ehavior..    enf
+00036630: 6f72 6365 5f6d 6574 6164 6174 6120 3a20  orce_metadata : 
+00036640: 626f 6f6c 2c20 6465 6661 756c 7420 5472  bool, default Tr
+00036650: 7565 0a20 2020 2020 2020 2057 6865 7468  ue.        Wheth
+00036660: 6572 2074 6f20 656e 666f 7263 6520 6174  er to enforce at
+00036670: 2072 756e 7469 6d65 2074 6861 7420 7468   runtime that th
+00036680: 6520 7374 7275 6374 7572 6520 6f66 2074  e structure of t
+00036690: 6865 2044 6174 6146 7261 6d65 0a20 2020  he DataFrame.   
+000366a0: 2020 2020 2070 726f 6475 6365 6420 6279       produced by
+000366b0: 2060 6066 756e 6360 6020 6163 7475 616c   ``func`` actual
+000366c0: 6c79 206d 6174 6368 6573 2074 6865 2073  ly matches the s
+000366d0: 7472 7563 7475 7265 206f 6620 6060 6d65  tructure of ``me
+000366e0: 7461 6060 2e0a 2020 2020 2020 2020 5468  ta``..        Th
+000366f0: 6973 2077 696c 6c20 7265 6e61 6d65 2061  is will rename a
+00036700: 6e64 2072 656f 7264 6572 2063 6f6c 756d  nd reorder colum
+00036710: 6e73 2066 6f72 2065 6163 6820 7061 7274  ns for each part
+00036720: 6974 696f 6e2c 0a20 2020 2020 2020 2061  ition,.        a
+00036730: 6e64 2077 696c 6c20 7261 6973 6520 616e  nd will raise an
+00036740: 2065 7272 6f72 2069 6620 7468 6973 2064   error if this d
+00036750: 6f65 736e 2774 2077 6f72 6b2c 0a20 2020  oesn't work,.   
+00036760: 2020 2020 2062 7574 2069 7420 776f 6e27       but it won'
+00036770: 7420 7261 6973 6520 6966 2064 7479 7065  t raise if dtype
+00036780: 7320 646f 6e27 7420 6d61 7463 682e 0a20  s don't match.. 
+00036790: 2020 2062 6566 6f72 6520 3a20 696e 742c     before : int,
+000367a0: 2074 696d 6564 656c 7461 206f 7220 7374   timedelta or st
+000367b0: 7269 6e67 2074 696d 6564 656c 7461 0a20  ring timedelta. 
+000367c0: 2020 2020 2020 2054 6865 2072 6f77 7320         The rows 
+000367d0: 746f 2070 7265 7065 6e64 2074 6f20 7061  to prepend to pa
+000367e0: 7274 6974 696f 6e20 6060 6960 6020 6672  rtition ``i`` fr
+000367f0: 6f6d 2074 6865 2065 6e64 206f 660a 2020  om the end of.  
+00036800: 2020 2020 2020 7061 7274 6974 696f 6e20        partition 
+00036810: 6060 6920 2d20 3160 602e 0a20 2020 2061  ``i - 1``..    a
+00036820: 6674 6572 203a 2069 6e74 2c20 7469 6d65  fter : int, time
+00036830: 6465 6c74 6120 6f72 2073 7472 696e 6720  delta or string 
+00036840: 7469 6d65 6465 6c74 610a 2020 2020 2020  timedelta.      
+00036850: 2020 5468 6520 726f 7773 2074 6f20 6170    The rows to ap
+00036860: 7065 6e64 2074 6f20 7061 7274 6974 696f  pend to partitio
+00036870: 6e20 6060 6960 6020 6672 6f6d 2074 6865  n ``i`` from the
+00036880: 2062 6567 696e 6e69 6e67 0a20 2020 2020   beginning.     
+00036890: 2020 206f 6620 7061 7274 6974 696f 6e20     of partition 
+000368a0: 6060 6920 2b20 3160 602e 0a20 2020 2074  ``i + 1``..    t
+000368b0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+000368c0: 6e73 203a 2062 6f6f 6c2c 2064 6566 6175  ns : bool, defau
+000368d0: 6c74 2054 7275 650a 2020 2020 2020 2020  lt True.        
+000368e0: 5768 6574 6865 7220 746f 2061 7070 6c79  Whether to apply
+000368f0: 2074 6865 2066 756e 6374 696f 6e20 6f6e   the function on
+00036900: 746f 2074 6865 2064 6976 6973 696f 6e73  to the divisions
+00036910: 2061 6e64 2061 7070 6c79 2074 686f 7365   and apply those
+00036920: 0a20 2020 2020 2020 2074 7261 6e73 666f  .        transfo
+00036930: 726d 6564 2064 6976 6973 696f 6e73 2074  rmed divisions t
+00036940: 6f20 7468 6520 6f75 7470 7574 2e0a 2020  o the output..  
+00036950: 2020 616c 6967 6e5f 6461 7461 6672 616d    align_datafram
+00036960: 6573 203a 2062 6f6f 6c2c 2064 6566 6175  es : bool, defau
+00036970: 6c74 2054 7275 650a 2020 2020 2020 2020  lt True.        
+00036980: 5768 6574 6865 7220 746f 2072 6570 6172  Whether to repar
+00036990: 7469 7469 6f6e 2044 6174 6146 7261 6d65  tition DataFrame
+000369a0: 2d20 6f72 2053 6572 6965 732d 6c69 6b65  - or Series-like
+000369b0: 2061 7267 730a 2020 2020 2020 2020 2862   args.        (b
+000369c0: 6f74 6820 6461 736b 2061 6e64 2070 616e  oth dask and pan
+000369d0: 6461 7329 2073 6f20 7468 6569 7220 6469  das) so their di
+000369e0: 7669 7369 6f6e 7320 616c 6967 6e20 6265  visions align be
+000369f0: 666f 7265 2061 7070 6c79 696e 670a 2020  fore applying.  
+00036a00: 2020 2020 2020 7468 6520 6675 6e63 7469        the functi
+00036a10: 6f6e 2e20 5468 6973 2072 6571 7569 7265  on. This require
+00036a20: 7320 616c 6c20 696e 7075 7473 2074 6f20  s all inputs to 
+00036a30: 6861 7665 206b 6e6f 776e 2064 6976 6973  have known divis
+00036a40: 696f 6e73 2e0a 2020 2020 2020 2020 5369  ions..        Si
+00036a50: 6e67 6c65 2d70 6172 7469 7469 6f6e 2069  ngle-partition i
+00036a60: 6e70 7574 7320 7769 6c6c 2062 6520 7370  nputs will be sp
+00036a70: 6c69 7420 696e 746f 206d 756c 7469 706c  lit into multipl
+00036a80: 6520 7061 7274 6974 696f 6e73 2e0a 0a20  e partitions... 
+00036a90: 2020 2020 2020 2049 6620 4661 6c73 652c         If False,
+00036aa0: 2061 6c6c 2069 6e70 7574 7320 6d75 7374   all inputs must
+00036ab0: 2068 6176 6520 6569 7468 6572 2074 6865   have either the
+00036ac0: 2073 616d 6520 6e75 6d62 6572 206f 6620   same number of 
+00036ad0: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
+00036ae0: 2020 206f 7220 6120 7369 6e67 6c65 2070     or a single p
+00036af0: 6172 7469 7469 6f6e 2e20 5369 6e67 6c65  artition. Single
+00036b00: 2d70 6172 7469 7469 6f6e 2069 6e70 7574  -partition input
+00036b10: 7320 7769 6c6c 2062 6520 6272 6f61 6463  s will be broadc
+00036b20: 6173 7420 746f 0a20 2020 2020 2020 2065  ast to.        e
+00036b30: 7665 7279 2070 6172 7469 7469 6f6e 206f  very partition o
+00036b40: 6620 6d75 6c74 692d 7061 7274 6974 696f  f multi-partitio
+00036b50: 6e20 696e 7075 7473 2e0a 2020 2020 244d  n inputs..    $M
+00036b60: 4554 410a 0a20 2020 2053 6565 2041 6c73  ETA..    See Als
+00036b70: 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  o.    --------. 
+00036b80: 2020 2064 642e 4461 7461 4672 616d 652e     dd.DataFrame.
+00036b90: 6d61 705f 6f76 6572 6c61 700a 2020 2020  map_overlap.    
+00036ba0: 2222 220a 2020 2020 6966 2069 7369 6e73  """.    if isins
+00036bb0: 7461 6e63 6528 6265 666f 7265 2c20 7374  tance(before, st
+00036bc0: 7229 3a0a 2020 2020 2020 2020 6265 666f  r):.        befo
+00036bd0: 7265 203d 2070 642e 746f 5f74 696d 6564  re = pd.to_timed
+00036be0: 656c 7461 2862 6566 6f72 6529 0a20 2020  elta(before).   
+00036bf0: 2069 6620 6973 696e 7374 616e 6365 2861   if isinstance(a
+00036c00: 6674 6572 2c20 7374 7229 3a0a 2020 2020  fter, str):.    
+00036c10: 2020 2020 6166 7465 7220 3d20 7064 2e74      after = pd.t
+00036c20: 6f5f 7469 6d65 6465 6c74 6128 6166 7465  o_timedelta(afte
+00036c30: 7229 0a0a 2020 2020 6966 2069 7369 6e73  r)..    if isins
+00036c40: 7461 6e63 6528 6265 666f 7265 2c20 6461  tance(before, da
+00036c50: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+00036c60: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
+00036c70: 6166 7465 722c 2064 6174 6574 696d 652e  after, datetime.
+00036c80: 7469 6d65 6465 6c74 6129 3a0a 2020 2020  timedelta):.    
+00036c90: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00036ca0: 6528 6466 2c20 4672 616d 6542 6173 6529  e(df, FrameBase)
+00036cb0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00036cc0: 6665 7272 6564 5f74 7970 6520 3d20 6466  ferred_type = df
+00036cd0: 2e69 6e64 6578 2e5f 6d65 7461 5f6e 6f6e  .index._meta_non
+00036ce0: 656d 7074 792e 696e 6665 7272 6564 5f74  empty.inferred_t
+00036cf0: 7970 650a 2020 2020 2020 2020 656c 7365  ype.        else
+00036d00: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00036d10: 6665 7272 6564 5f74 7970 6520 3d20 6466  ferred_type = df
+00036d20: 2e69 6e64 6578 2e69 6e66 6572 7265 645f  .index.inferred_
+00036d30: 7479 7065 0a0a 2020 2020 2020 2020 6966  type..        if
+00036d40: 206e 6f74 2069 735f 6461 7465 7469 6d65   not is_datetime
+00036d50: 3634 5f61 6e79 5f64 7479 7065 2869 6e66  64_any_dtype(inf
+00036d60: 6572 7265 645f 7479 7065 293a 0a20 2020  erred_type):.   
+00036d70: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00036d80: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+00036d90: 2020 2020 2020 2020 2020 224d 7573 7420            "Must 
+00036da0: 6861 7665 2061 2060 4461 7465 7469 6d65  have a `Datetime
+00036db0: 496e 6465 7860 2077 6865 6e20 7573 696e  Index` when usin
+00036dc0: 6720 7374 7269 6e67 206f 6666 7365 7420  g string offset 
+00036dd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00036de0: 2020 2266 6f72 2060 6265 666f 7265 6020    "for `before` 
+00036df0: 616e 6420 6061 6674 6572 6022 0a20 2020  and `after`".   
+00036e00: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00036e10: 656c 6966 206e 6f74 2028 0a20 2020 2020  elif not (.     
+00036e20: 2020 2069 7369 6e73 7461 6e63 6528 6265     isinstance(be
+00036e30: 666f 7265 2c20 496e 7465 6772 616c 290a  fore, Integral).
+00036e40: 2020 2020 2020 2020 616e 6420 6265 666f          and befo
+00036e50: 7265 203e 3d20 300a 2020 2020 2020 2020  re >= 0.        
+00036e60: 616e 6420 6973 696e 7374 616e 6365 2861  and isinstance(a
+00036e70: 6674 6572 2c20 496e 7465 6772 616c 290a  fter, Integral).
+00036e80: 2020 2020 2020 2020 616e 6420 6166 7465          and afte
+00036e90: 7220 3e3d 2030 0a20 2020 2029 3a0a 2020  r >= 0.    ):.  
+00036ea0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00036eb0: 6545 7272 6f72 2822 6265 666f 7265 2061  eError("before a
+00036ec0: 6e64 2061 6674 6572 206d 7573 7420 6265  nd after must be
+00036ed0: 2070 6f73 6974 6976 6520 696e 7465 6765   positive intege
+00036ee0: 7273 2229 0a0a 2020 2020 6466 203d 205f  rs")..    df = _
+00036ef0: 6d61 7962 655f 6672 6f6d 5f70 616e 6461  maybe_from_panda
+00036f00: 7328 5b64 665d 295b 305d 0a20 2020 2061  s([df])[0].    a
+00036f10: 7267 7320 3d20 5f6d 6179 6265 5f66 726f  rgs = _maybe_fro
+00036f20: 6d5f 7061 6e64 6173 2861 7267 7329 0a0a  m_pandas(args)..
+00036f30: 2020 2020 6966 2061 6c69 676e 5f64 6174      if align_dat
+00036f40: 6166 7261 6d65 733a 0a20 2020 2020 2020  aframes:.       
+00036f50: 2064 6673 203d 205b 6466 5d20 2b20 6172   dfs = [df] + ar
+00036f60: 6773 0a20 2020 2020 2020 2064 6673 203d  gs.        dfs =
+00036f70: 205b 6466 2066 6f72 2064 6620 696e 2064   [df for df in d
+00036f80: 6673 2069 6620 6973 696e 7374 616e 6365  fs if isinstance
+00036f90: 2864 662c 2046 7261 6d65 4261 7365 295d  (df, FrameBase)]
+00036fa0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00036fb0: 6466 7329 203e 2031 2061 6e64 206e 6f74  dfs) > 1 and not
+00036fc0: 2065 7870 722e 6172 655f 636f 5f61 6c69   expr.are_co_ali
+00036fd0: 676e 6564 282a 6466 7329 3a0a 2020 2020  gned(*dfs):.    
+00036fe0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00036ff0: 6577 5f63 6f6c 6c65 6374 696f 6e28 0a20  ew_collection(. 
+00037000: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00037010: 7870 722e 4d61 704f 7665 726c 6170 416c  xpr.MapOverlapAl
+00037020: 6967 6e28 0a20 2020 2020 2020 2020 2020  ign(.           
+00037030: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
+00037040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037050: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
+00037060: 2020 2020 2020 2020 2020 2062 6566 6f72             befor
+00037070: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00037080: 2020 2020 2020 2061 6674 6572 2c0a 2020         after,.  
+00037090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000370a0: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
+000370b0: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+000370c0: 7263 655f 6d65 7461 6461 7461 2c0a 2020  rce_metadata,.  
+000370d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000370e0: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+000370f0: 7369 6f6e 732c 0a20 2020 2020 2020 2020  sions,.         
+00037100: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
+00037110: 5f64 6976 6973 696f 6e73 2c0a 2020 2020  _divisions,.    
+00037120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037130: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+00037140: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00037150: 2020 2020 2020 6b77 6172 6773 2e70 6f70        kwargs.pop
+00037160: 2822 746f 6b65 6e22 2c20 4e6f 6e65 292c  ("token", None),
+00037170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037180: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
+00037190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000371a0: 202a 6172 6773 2c0a 2020 2020 2020 2020   *args,.        
+000371b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000371c0: 2020 2020 2020 290a 0a20 2020 206e 6577        )..    new
+000371d0: 5f65 7870 7220 3d20 6578 7072 2e4d 6170  _expr = expr.Map
+000371e0: 4f76 6572 6c61 7028 0a20 2020 2020 2020  Overlap(.       
+000371f0: 2064 662c 0a20 2020 2020 2020 2066 756e   df,.        fun
+00037200: 632c 0a20 2020 2020 2020 2062 6566 6f72  c,.        befor
+00037210: 652c 0a20 2020 2020 2020 2061 6674 6572  e,.        after
+00037220: 2c0a 2020 2020 2020 2020 6d65 7461 2c0a  ,.        meta,.
+00037230: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+00037240: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00037250: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+00037260: 7369 6f6e 732c 0a20 2020 2020 2020 2063  sions,.        c
+00037270: 6c65 6172 5f64 6976 6973 696f 6e73 2c0a  lear_divisions,.
+00037280: 2020 2020 2020 2020 616c 6967 6e5f 6461          align_da
+00037290: 7461 6672 616d 6573 2c0a 2020 2020 2020  taframes,.      
+000372a0: 2020 6b77 6172 6773 2e70 6f70 2822 746f    kwargs.pop("to
+000372b0: 6b65 6e22 2c20 4e6f 6e65 292c 0a20 2020  ken", None),.   
+000372c0: 2020 2020 206b 7761 7267 732c 0a20 2020       kwargs,.   
+000372d0: 2020 2020 202a 6172 6773 2c0a 2020 2020       *args,.    
+000372e0: 290a 2020 2020 7265 7475 726e 206e 6577  ).    return new
+000372f0: 5f63 6f6c 6c65 6374 696f 6e28 6e65 775f  _collection(new_
+00037300: 6578 7072 290a 0a0a 6465 6620 6973 6e61  expr)...def isna
+00037310: 2861 7267 293a 0a20 2020 2069 6620 6973  (arg):.    if is
+00037320: 696e 7374 616e 6365 2861 7267 2c20 4672  instance(arg, Fr
+00037330: 616d 6542 6173 6529 3a0a 2020 2020 2020  ameBase):.      
+00037340: 2020 7265 7475 726e 2061 7267 2e69 736e    return arg.isn
+00037350: 6128 290a 2020 2020 656c 7365 3a0a 2020  a().    else:.  
+00037360: 2020 2020 2020 7265 7475 726e 2066 726f        return fro
+00037370: 6d5f 7061 6e64 6173 2861 7267 292e 6973  m_pandas(arg).is
+00037380: 6e61 2829 0a0a 0a64 6566 2065 6c65 6d77  na()...def elemw
+00037390: 6973 6528 6f70 2c20 2a61 7267 732c 206d  ise(op, *args, m
+000373a0: 6574 613d 6e6f 5f64 6566 6175 6c74 2c20  eta=no_default, 
+000373b0: 6f75 743d 4e6f 6e65 2c20 7472 616e 7366  out=None, transf
+000373c0: 6f72 6d5f 6469 7669 7369 6f6e 733d 5472  orm_divisions=Tr
+000373d0: 7565 2c20 2a2a 6b77 6172 6773 293a 0a20  ue, **kwargs):. 
+000373e0: 2020 2022 2222 456c 656d 656e 7477 6973     """Elementwis
+000373f0: 6520 6f70 6572 6174 696f 6e20 666f 7220  e operation for 
+00037400: 4461 736b 2064 6174 6166 7261 6d65 730a  Dask dataframes.
+00037410: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00037420: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00037430: 2020 206f 703a 2063 616c 6c61 626c 650a     op: callable.
+00037440: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+00037450: 2074 6f20 6170 706c 7920 6163 726f 7373   to apply across
+00037460: 2069 6e70 7574 2064 6174 6166 7261 6d65   input dataframe
+00037470: 730a 2020 2020 2a61 7267 733a 2044 6174  s.    *args: Dat
+00037480: 6146 7261 6d65 732c 2053 6572 6965 732c  aFrames, Series,
+00037490: 2053 6361 6c61 7273 2c20 4172 7261 7973   Scalars, Arrays
+000374a0: 2c0a 2020 2020 2020 2020 5468 6520 6172  ,.        The ar
+000374b0: 6775 6d65 6e74 7320 6f66 2074 6865 206f  guments of the o
+000374c0: 7065 7261 7469 6f6e 0a20 2020 206d 6574  peration.    met
+000374d0: 613a 2070 642e 4461 7461 4672 616d 652c  a: pd.DataFrame,
+000374e0: 2070 642e 5365 7269 6573 2028 6f70 7469   pd.Series (opti
+000374f0: 6f6e 616c 290a 2020 2020 2020 2020 5661  onal).        Va
+00037500: 6c69 6420 6d65 7461 6461 7461 2066 6f72  lid metadata for
+00037510: 2074 6865 206f 7065 7261 7469 6f6e 2e20   the operation. 
+00037520: 2057 696c 6c20 6576 616c 7561 7465 206f   Will evaluate o
+00037530: 6e20 6120 736d 616c 6c20 7069 6563 6520  n a small piece 
+00037540: 6f66 0a20 2020 2020 2020 2064 6174 6120  of.        data 
+00037550: 6966 206e 6f74 2070 726f 7669 6465 642e  if not provided.
+00037560: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
+00037570: 6976 6973 696f 6e73 3a20 626f 6f6c 6561  ivisions: boolea
+00037580: 6e0a 2020 2020 2020 2020 4966 2074 6865  n.        If the
+00037590: 2069 6e70 7574 2069 7320 6120 6060 6461   input is a ``da
+000375a0: 736b 2e64 6174 6166 7261 6d65 2e49 6e64  sk.dataframe.Ind
+000375b0: 6578 6060 2077 6520 6e6f 726d 616c 6c79  ex`` we normally
+000375c0: 2077 696c 6c20 616c 736f 2061 7070 6c79   will also apply
+000375d0: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
+000375e0: 6374 696f 6e20 6f6e 746f 2074 6865 2064  ction onto the d
+000375f0: 6976 6973 696f 6e73 2061 6e64 2061 7070  ivisions and app
+00037600: 6c79 2074 686f 7365 2074 7261 6e73 666f  ly those transfo
+00037610: 726d 6564 2064 6976 6973 696f 6e73 0a20  rmed divisions. 
+00037620: 2020 2020 2020 2074 6f20 7468 6520 6f75         to the ou
+00037630: 7470 7574 2e20 2059 6f75 2063 616e 2070  tput.  You can p
+00037640: 6173 7320 6060 7472 616e 7366 6f72 6d5f  ass ``transform_
+00037650: 6469 7669 7369 6f6e 733d 4661 6c73 6560  divisions=False`
+00037660: 6020 746f 206f 7665 7272 6964 650a 2020  ` to override.  
+00037670: 2020 2020 2020 7468 6973 2062 6568 6176        this behav
+00037680: 696f 720a 2020 2020 6f75 7420 3a20 6060  ior.    out : ``
+00037690: 6461 736b 2e61 7272 6179 6060 206f 7220  dask.array`` or 
+000376a0: 6060 4e6f 6e65 6060 0a20 2020 2020 2020  ``None``.       
+000376b0: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
+000376c0: 6b2e 4461 7461 4672 616d 652c 2064 6173  k.DataFrame, das
+000376d0: 6b2e 5365 7269 6573 206f 7220 6461 736b  k.Series or dask
+000376e0: 2e53 6361 6c61 7220 7468 656e 0a20 2020  .Scalar then.   
+000376f0: 2020 2020 2074 6869 7320 6f76 6572 7772       this overwr
+00037700: 6974 6573 2074 6865 2063 6f6e 7465 6e74  ites the content
+00037710: 7320 6f66 2069 7420 7769 7468 2074 6865  s of it with the
+00037720: 2072 6573 756c 740a 2020 2020 2a2a 6b77   result.    **kw
+00037730: 6172 6773 3a20 7363 616c 6172 730a 0a20  args: scalars.. 
+00037740: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+00037750: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
+00037760: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
+00037770: 6f72 2e61 6464 2c20 6466 2e78 2c20 6466  or.add, df.x, df
+00037780: 2e79 2920 2023 2064 6f63 7465 7374 3a20  .y)  # doctest: 
+00037790: 2b53 4b49 500a 2020 2020 2222 220a 0a20  +SKIP.    """.. 
+000377a0: 2020 2061 7267 7320 3d20 5f6d 6179 6265     args = _maybe
+000377b0: 5f66 726f 6d5f 7061 6e64 6173 2861 7267  _from_pandas(arg
+000377c0: 7329 0a20 2020 2064 6673 203d 205b 6466  s).    dfs = [df
+000377d0: 2066 6f72 2064 6620 696e 2061 7267 7320   for df in args 
+000377e0: 6966 2069 7369 6e73 7461 6e63 6528 6466  if isinstance(df
+000377f0: 2c20 4672 616d 6542 6173 6529 5d0a 2020  , FrameBase)].  
+00037800: 2020 6966 206c 656e 2864 6673 2920 3c3d    if len(dfs) <=
+00037810: 2031 206f 7220 6578 7072 2e61 7265 5f63   1 or expr.are_c
+00037820: 6f5f 616c 6967 6e65 6428 2a64 6673 293a  o_aligned(*dfs):
+00037830: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+00037840: 3d20 6e65 775f 636f 6c6c 6563 7469 6f6e  = new_collection
+00037850: 280a 2020 2020 2020 2020 2020 2020 6578  (.            ex
+00037860: 7072 2e55 4675 6e63 456c 656d 7769 7365  pr.UFuncElemwise
+00037870: 2864 6673 5b30 5d2c 206f 702c 206d 6574  (dfs[0], op, met
+00037880: 612c 2074 7261 6e73 666f 726d 5f64 6976  a, transform_div
+00037890: 6973 696f 6e73 2c20 6b77 6172 6773 2c20  isions, kwargs, 
+000378a0: 2a61 7267 7329 0a20 2020 2020 2020 2029  *args).        )
+000378b0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+000378c0: 2020 2072 6573 756c 7420 3d20 6e65 775f     result = new_
+000378d0: 636f 6c6c 6563 7469 6f6e 2865 7870 722e  collection(expr.
+000378e0: 5546 756e 6341 6c69 676e 2864 6673 5b30  UFuncAlign(dfs[0
+000378f0: 5d2c 206f 702c 206d 6574 612c 206b 7761  ], op, meta, kwa
+00037900: 7267 732c 202a 6172 6773 2929 0a20 2020  rgs, *args)).   
+00037910: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00037920: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+00037930: 0a0a 6465 6620 6861 6e64 6c65 5f6f 7574  ..def handle_out
+00037940: 286f 7574 2c20 7265 7375 6c74 293a 0a20  (out, result):. 
+00037950: 2020 2022 2222 4861 6e64 6c65 206f 7574     """Handle out
+00037960: 2070 6172 616d 6574 6572 730a 0a20 2020   parameters..   
+00037970: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
+00037980: 6b2e 4461 7461 4672 616d 652c 2064 6173  k.DataFrame, das
+00037990: 6b2e 5365 7269 6573 206f 7220 6461 736b  k.Series or dask
+000379a0: 2e53 6361 6c61 7220 7468 656e 0a20 2020  .Scalar then.   
+000379b0: 2074 6869 7320 6f76 6572 7772 6974 6573   this overwrites
+000379c0: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
+000379d0: 2069 7420 7769 7468 2074 6865 2072 6573   it with the res
+000379e0: 756c 742e 2054 6865 206d 6574 686f 640a  ult. The method.
+000379f0: 2020 2020 7265 706c 6163 6573 2074 6865      replaces the
+00037a00: 2065 7870 7265 7373 696f 6e20 6f66 2074   expression of t
+00037a10: 6865 206f 7574 2070 6172 616d 6574 6572  he out parameter
+00037a20: 2077 6974 6820 7468 6520 7265 7375 6c74   with the result
+00037a30: 0a20 2020 2066 726f 6d20 7468 6973 206f  .    from this o
+00037a40: 7065 7261 7469 6f6e 2074 6f20 7065 7266  peration to perf
+00037a50: 6f72 6d20 736f 6d65 7468 696e 6720 616b  orm something ak
+00037a60: 696e 2074 6f20 616e 2069 6e70 6c61 6365  in to an inplace
+00037a70: 0a20 2020 206d 6f64 6966 6963 6174 696f  .    modificatio
+00037a80: 6e2e 0a20 2020 2022 2222 0a20 2020 2069  n..    """.    i
+00037a90: 6620 6973 696e 7374 616e 6365 286f 7574  f isinstance(out
+00037aa0: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
+00037ab0: 2020 6966 206c 656e 286f 7574 2920 3d3d    if len(out) ==
+00037ac0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00037ad0: 6f75 7420 3d20 6f75 745b 305d 0a20 2020  out = out[0].   
+00037ae0: 2020 2020 2065 6c69 6620 6c65 6e28 6f75       elif len(ou
+00037af0: 7429 203e 2031 3a0a 2020 2020 2020 2020  t) > 1:.        
+00037b00: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00037b10: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
+00037b20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00037b30: 5468 6520 606f 7574 6020 7061 7261 6d65  The `out` parame
+00037b40: 7465 7220 7769 7468 206c 656e 6774 6820  ter with length 
+00037b50: 3e20 3120 6973 206e 6f74 2073 7570 706f  > 1 is not suppo
+00037b60: 7274 6564 220a 2020 2020 2020 2020 2020  rted".          
+00037b70: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00037b80: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
+00037b90: 7420 3d20 4e6f 6e65 0a0a 2020 2020 6966  t = None..    if
+00037ba0: 206f 7574 2069 7320 6e6f 7420 4e6f 6e65   out is not None
+00037bb0: 2061 6e64 206f 7574 2e5f 5f63 6c61 7373   and out.__class
+00037bc0: 5f5f 2021 3d20 7265 7375 6c74 2e5f 5f63  __ != result.__c
+00037bd0: 6c61 7373 5f5f 3a0a 2020 2020 2020 2020  lass__:.        
+00037be0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00037bf0: 0a20 2020 2020 2020 2020 2020 2022 4d69  .            "Mi
+00037c00: 736d 6174 6368 6564 2074 7970 6573 2062  smatched types b
+00037c10: 6574 7765 656e 2072 6573 756c 7420 616e  etween result an
+00037c20: 6420 6f75 7420 7061 7261 6d65 7465 722e  d out parameter.
+00037c30: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+00037c40: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
+00037c50: 7322 2025 2028 7374 7228 7479 7065 286f  s" % (str(type(o
+00037c60: 7574 2929 2c20 7374 7228 7479 7065 2872  ut)), str(type(r
+00037c70: 6573 756c 7429 2929 0a20 2020 2020 2020  esult))).       
+00037c80: 2029 0a0a 2020 2020 6966 2069 7369 6e73   )..    if isins
+00037c90: 7461 6e63 6528 6f75 742c 2044 6174 6146  tance(out, DataF
+00037ca0: 7261 6d65 293a 0a20 2020 2020 2020 2069  rame):.        i
+00037cb0: 6620 6c65 6e28 6f75 742e 636f 6c75 6d6e  f len(out.column
+00037cc0: 7329 2021 3d20 6c65 6e28 7265 7375 6c74  s) != len(result
+00037cd0: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
+00037ce0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00037cf0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00037d00: 2020 2020 2020 2020 2022 4d69 736d 6174           "Mismat
+00037d10: 6368 6564 2063 6f6c 756d 6e73 2063 6f75  ched columns cou
+00037d20: 6e74 2062 6574 7765 656e 2072 6573 756c  nt between resul
+00037d30: 7420 616e 6420 6f75 7420 7061 7261 6d65  t and out parame
+00037d40: 7465 722e 2022 0a20 2020 2020 2020 2020  ter. ".         
+00037d50: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
+00037d60: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
+00037d70: 7228 6c65 6e28 6f75 742e 636f 6c75 6d6e  r(len(out.column
+00037d80: 7329 292c 2073 7472 286c 656e 2872 6573  s)), str(len(res
+00037d90: 756c 742e 636f 6c75 6d6e 7329 2929 0a20  ult.columns))). 
+00037da0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00037db0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00037dc0: 6f75 742c 2028 5365 7269 6573 2c20 4461  out, (Series, Da
+00037dd0: 7461 4672 616d 652c 2053 6361 6c61 7229  taFrame, Scalar)
+00037de0: 293a 0a20 2020 2020 2020 206f 7574 2e5f  ):.        out._
+00037df0: 6578 7072 203d 2072 6573 756c 742e 5f65  expr = result._e
+00037e00: 7870 720a 2020 2020 656c 6966 206f 7574  xpr.    elif out
+00037e10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00037e20: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
+00037e30: 2020 2020 2020 2020 2020 2254 6865 206f            "The o
+00037e40: 7574 2070 6172 616d 6574 6572 2069 7320  ut parameter is 
+00037e50: 6e6f 7420 6675 6c6c 7920 7375 7070 6f72  not fully suppor
+00037e60: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
+00037e70: 2020 2220 5265 6365 6976 6564 2074 7970    " Received typ
+00037e80: 6520 2573 2c20 6578 7065 6374 6564 2025  e %s, expected %
+00037e90: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
+00037ea0: 2520 280a 2020 2020 2020 2020 2020 2020  % (.            
+00037eb0: 2020 2020 7479 7065 6e61 6d65 2874 7970      typename(typ
+00037ec0: 6528 6f75 7429 292c 0a20 2020 2020 2020  e(out)),.       
+00037ed0: 2020 2020 2020 2020 2074 7970 656e 616d           typenam
+00037ee0: 6528 7479 7065 2872 6573 756c 7429 292c  e(type(result)),
+00037ef0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00037f00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00037f10: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00037f20: 656e 7465 6445 7272 6f72 286d 7367 290a  entedError(msg).
+00037f30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00037f40: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+00037f50: 0a0a 6465 6620 5f63 6f6d 7075 7465 5f70  ..def _compute_p
+00037f60: 6172 7469 7469 6f6e 5f73 7461 7473 280a  artition_stats(.
+00037f70: 2020 2020 636f 6c75 6d6e 3a20 5365 7269      column: Seri
+00037f80: 6573 2c20 616c 6c6f 775f 6f76 6572 6c61  es, allow_overla
+00037f90: 703a 2062 6f6f 6c20 3d20 4661 6c73 650a  p: bool = False.
+00037fa0: 2920 2d3e 2074 7570 6c65 5b6c 6973 742c  ) -> tuple[list,
+00037fb0: 206c 6973 742c 206c 6973 745b 696e 745d   list, list[int]
+00037fc0: 5d3a 0a20 2020 2022 2222 466f 7220 6120  ]:.    """For a 
+00037fd0: 6769 7665 6e20 636f 6c75 6d6e 2c20 636f  given column, co
+00037fe0: 6d70 7574 6520 7468 6520 6d69 6e2c 206d  mpute the min, m
+00037ff0: 6178 2c20 616e 6420 6c65 6e20 6f66 2065  ax, and len of e
+00038000: 6163 6820 7061 7274 6974 696f 6e2e 0a0a  ach partition...
+00038010: 2020 2020 416e 6420 6d61 6b65 2073 7572      And make sur
+00038020: 6520 7468 6174 2074 6865 2070 6172 7469  e that the parti
+00038030: 7469 6f6e 7320 6172 6520 736f 7274 6564  tions are sorted
+00038040: 2072 656c 6174 6976 6520 746f 2065 6163   relative to eac
+00038050: 6820 6f74 6865 722e 0a20 2020 204e 4f54  h other..    NOT
+00038060: 453a 2074 6869 7320 646f 6573 206e 6f74  E: this does not
+00038070: 2067 7561 7261 6e74 6565 2074 6861 7420   guarantee that 
+00038080: 6576 6572 7920 7061 7274 6974 696f 6e20  every partition 
+00038090: 6973 2069 6e74 6572 6e61 6c6c 7920 736f  is internally so
+000380a0: 7274 6564 2e0a 2020 2020 2222 220a 2020  rted..    """.  
+000380b0: 2020 6d69 6e73 203d 2063 6f6c 756d 6e2e    mins = column.
+000380c0: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
+000380d0: 2e6d 696e 2c20 6d65 7461 3d63 6f6c 756d  .min, meta=colum
+000380e0: 6e29 0a20 2020 206d 6178 6573 203d 2063  n).    maxes = c
+000380f0: 6f6c 756d 6e2e 6d61 705f 7061 7274 6974  olumn.map_partit
+00038100: 696f 6e73 284d 2e6d 6178 2c20 6d65 7461  ions(M.max, meta
+00038110: 3d63 6f6c 756d 6e29 0a20 2020 206c 656e  =column).    len
+00038120: 7320 3d20 636f 6c75 6d6e 2e6d 6170 5f70  s = column.map_p
+00038130: 6172 7469 7469 6f6e 7328 6c65 6e2c 206d  artitions(len, m
+00038140: 6574 613d 636f 6c75 6d6e 290a 2020 2020  eta=column).    
+00038150: 6d69 6e73 2c20 6d61 7865 732c 206c 656e  mins, maxes, len
+00038160: 7320 3d20 636f 6d70 7574 6528 6d69 6e73  s = compute(mins
+00038170: 2c20 6d61 7865 732c 206c 656e 7329 0a20  , maxes, lens). 
+00038180: 2020 206d 696e 7320 3d20 6d69 6e73 2e62     mins = mins.b
+00038190: 6669 6c6c 2829 2e74 6f6c 6973 7428 290a  fill().tolist().
+000381a0: 2020 2020 6d61 7865 7320 3d20 6d61 7865      maxes = maxe
+000381b0: 732e 6266 696c 6c28 292e 746f 6c69 7374  s.bfill().tolist
+000381c0: 2829 0a20 2020 206e 6f6e 5f65 6d70 7479  ().    non_empty
+000381d0: 5f6d 696e 7320 3d20 5b6d 2066 6f72 206d  _mins = [m for m
+000381e0: 2c20 6c65 6e67 7468 2069 6e20 7a69 7028  , length in zip(
+000381f0: 6d69 6e73 2c20 6c65 6e73 2920 6966 206c  mins, lens) if l
+00038200: 656e 6774 6820 213d 2030 5d0a 2020 2020  ength != 0].    
+00038210: 6e6f 6e5f 656d 7074 795f 6d61 7865 7320  non_empty_maxes 
+00038220: 3d20 5b6d 2066 6f72 206d 2c20 6c65 6e67  = [m for m, leng
+00038230: 7468 2069 6e20 7a69 7028 6d61 7865 732c  th in zip(maxes,
+00038240: 206c 656e 7329 2069 6620 6c65 6e67 7468   lens) if length
+00038250: 2021 3d20 305d 0a20 2020 2069 6620 280a   != 0].    if (.
+00038260: 2020 2020 2020 2020 736f 7274 6564 286e          sorted(n
+00038270: 6f6e 5f65 6d70 7479 5f6d 696e 7329 2021  on_empty_mins) !
+00038280: 3d20 6e6f 6e5f 656d 7074 795f 6d69 6e73  = non_empty_mins
+00038290: 0a20 2020 2020 2020 206f 7220 736f 7274  .        or sort
+000382a0: 6564 286e 6f6e 5f65 6d70 7479 5f6d 6178  ed(non_empty_max
+000382b0: 6573 2920 213d 206e 6f6e 5f65 6d70 7479  es) != non_empty
+000382c0: 5f6d 6178 6573 0a20 2020 2029 3a0a 2020  _maxes.    ):.  
+000382d0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000382e0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+000382f0: 2020 2020 6622 5061 7274 6974 696f 6e73      f"Partitions
+00038300: 2061 7265 206e 6f74 2073 6f72 7465 6420   are not sorted 
+00038310: 6173 6365 6e64 696e 6720 6279 207b 636f  ascending by {co
+00038320: 6c75 6d6e 2e6e 616d 6520 6f72 2027 7468  lumn.name or 'th
+00038330: 6520 696e 6465 7827 7d2e 2022 2c0a 2020  e index'}. ",.  
+00038340: 2020 2020 2020 2020 2020 6622 496e 2079            f"In y
+00038350: 6f75 7220 6461 7461 7365 7420 7468 6520  our dataset the 
+00038360: 286d 696e 2c20 6d61 782c 206c 656e 2920  (min, max, len) 
+00038370: 7661 6c75 6573 206f 6620 7b63 6f6c 756d  values of {colum
+00038380: 6e2e 6e61 6d65 206f 7220 2774 6865 2069  n.name or 'the i
+00038390: 6e64 6578 277d 2022 0a20 2020 2020 2020  ndex'} ".       
+000383a0: 2020 2020 2066 2266 6f72 2065 6163 6820       f"for each 
+000383b0: 7061 7274 6974 696f 6e20 6172 653a 207b  partition are: {
+000383c0: 6c69 7374 287a 6970 286d 696e 732c 206d  list(zip(mins, m
+000383d0: 6178 6573 2c20 6c65 6e73 2929 7d22 2c0a  axes, lens))}",.
+000383e0: 2020 2020 2020 2020 290a 2020 2020 6966          ).    if
+000383f0: 206e 6f74 2061 6c6c 6f77 5f6f 7665 726c   not allow_overl
+00038400: 6170 2061 6e64 2061 6e79 280a 2020 2020  ap and any(.    
+00038410: 2020 2020 6120 3c3d 2062 2066 6f72 2061      a <= b for a
+00038420: 2c20 6220 696e 207a 6970 286e 6f6e 5f65  , b in zip(non_e
+00038430: 6d70 7479 5f6d 696e 735b 313a 5d2c 206e  mpty_mins[1:], n
+00038440: 6f6e 5f65 6d70 7479 5f6d 6178 6573 5b3a  on_empty_maxes[:
+00038450: 2d31 5d29 0a20 2020 2029 3a0a 2020 2020  -1]).    ):.    
+00038460: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+00038470: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+00038480: 5061 7274 6974 696f 6e73 2068 6176 6520  Partitions have 
+00038490: 6f76 6572 6c61 7070 696e 6720 7661 6c75  overlapping valu
+000384a0: 6573 2c20 736f 2064 6976 6973 696f 6e73  es, so divisions
+000384b0: 2061 7265 206e 6f6e 2d75 6e69 7175 652e   are non-unique.
+000384c0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+000384d0: 5573 6520 6073 6574 5f69 6e64 6578 2873  Use `set_index(s
+000384e0: 6f72 7465 643d 5472 7565 2960 2077 6974  orted=True)` wit
+000384f0: 6820 6e6f 2060 6469 7669 7369 6f6e 7360  h no `divisions`
+00038500: 2074 6f20 616c 6c6f 7720 6461 736b 2074   to allow dask t
+00038510: 6f20 6669 7820 7468 6520 6f76 6572 6c61  o fix the overla
+00038520: 702e 2022 0a20 2020 2020 2020 2020 2020  p. ".           
+00038530: 2066 2249 6e20 796f 7572 2064 6174 6173   f"In your datas
+00038540: 6574 2074 6865 2028 6d69 6e2c 206d 6178  et the (min, max
+00038550: 2c20 6c65 6e29 2076 616c 7565 7320 6f66  , len) values of
+00038560: 207b 636f 6c75 6d6e 2e6e 616d 6520 6f72   {column.name or
+00038570: 2027 7468 6520 696e 6465 7827 7d20 220a   'the index'} ".
+00038580: 2020 2020 2020 2020 2020 2020 6622 666f              f"fo
+00038590: 7220 6561 6368 2070 6172 7469 7469 6f6e  r each partition
+000385a0: 2061 7265 203a 207b 6c69 7374 287a 6970   are : {list(zip
+000385b0: 286d 696e 732c 206d 6178 6573 2c20 6c65  (mins, maxes, le
+000385c0: 6e73 2929 7d22 2c0a 2020 2020 2020 2020  ns))}",.        
+000385d0: 2020 2020 5573 6572 5761 726e 696e 672c      UserWarning,
+000385e0: 0a20 2020 2020 2020 2029 0a20 2020 206c  .        ).    l
+000385f0: 656e 7320 3d20 6d65 7468 6f64 732e 746f  ens = methods.to
+00038600: 6c69 7374 286c 656e 7329 0a20 2020 2069  list(lens).    i
+00038610: 6620 6e6f 7420 616c 6c6f 775f 6f76 6572  f not allow_over
+00038620: 6c61 703a 0a20 2020 2020 2020 2072 6574  lap:.        ret
+00038630: 7572 6e20 286d 696e 732c 206d 6178 6573  urn (mins, maxes
+00038640: 2c20 6c65 6e73 290a 2020 2020 656c 7365  , lens).    else
+00038650: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00038660: 2028 6e6f 6e5f 656d 7074 795f 6d69 6e73   (non_empty_mins
+00038670: 2c20 6e6f 6e5f 656d 7074 795f 6d61 7865  , non_empty_maxe
+00038680: 732c 206c 656e 7329 0a                   s, lens).
```

### Comparing `dask-expr-1.0.9/dask_expr/_concat.py` & `dask_expr-1.1.0/dask_expr/_concat.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_core.py` & `dask_expr-1.1.0/dask_expr/_core.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_cumulative.py` & `dask_expr-1.1.0/dask_expr/_cumulative.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_datetime.py` & `dask_expr-1.1.0/dask_expr/_datetime.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_describe.py` & `dask_expr-1.1.0/dask_expr/_describe.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_dummies.py` & `dask_expr-1.1.0/dask_expr/_dummies.py`

 * *Files 6% similar despite different names*

```diff
@@ -152,22 +152,26 @@
 class GetDummies(Blockwise):
     _parameters = [
         "frame",
         "prefix",
         "prefix_sep",
         "dummy_na",
         "columns",
+        "sparse",
         "drop_first",
         "dtype",
     ]
     _defaults = {
         "prefix": None,
         "prefix_sep": "_",
         "dummy_na": False,
         "columns": None,
+        "sparse": False,
         "drop_first": False,
         "dtype": bool,
     }
+    # cudf has extra kwargs after `columns`
+    _keyword_only = ["sparse", "drop_first", "dtype"]
 
     @staticmethod
     def operation(df, *args, **kwargs):
         return get_meta_library(df).get_dummies(df, *args, **kwargs)
```

### Comparing `dask-expr-1.0.9/dask_expr/_expr.py` & `dask_expr-1.1.0/dask_expr/_expr.py`

 * *Files 3% similar despite different names*

```diff
@@ -40,14 +40,15 @@
     valid_divisions,
 )
 from dask.typing import no_default
 from dask.utils import (
     M,
     apply,
     funcname,
+    get_meta_library,
     has_keyword,
     is_arraylike,
     partial_by_order,
     pseudorandom,
     random_state_data,
 )
 from pandas.errors import PerformanceWarning
@@ -403,14 +404,45 @@
         except AttributeError:
             if self.ndim == 1:
                 return [self.name]
             return []
         except Exception:
             raise
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self) -> set:
+        """Preserves the columns defining the partition mapping from shuffles.
+
+        This property specifies if a column or a set of columns have a unique
+        partition mapping that was defined by a shuffle operation. The mapping
+        is created by hasing the values and the separating them onto partitions.
+        It is important that this property is only propagated if the values
+        in those columns did not change in this expression. The property is
+        only populated if the mapping was created by the ``partitioning_index``
+        function.
+
+        Simply knowing that every value is in only one partition is not a
+        satisfying condition, because we also use this property on merge
+        operations, where we need these values to be in matching partitions.
+
+        This is also the reason why set_index or sort_values can't set the
+        property, they fullfil a weaker condition than what this property enforcey.
+
+        Normally, this set contains one tuple of either one or multiple columns.
+        It can contain 2, when the operation shuffles multiple columns of the
+        result, i.e. a merge operation and the left and right join columns.
+
+
+        Returns
+        -------
+            A set of column groups that have a unique partition mapping as
+            defined by a shuffle.
+        """
+        return set()
+
     @property
     def _projection_columns(self):
         return self.columns
 
     @property
     def name(self):
         return self._meta.name
@@ -452,14 +484,15 @@
     Note that `Fused` expressions rely on every `Blockwise`
     expression defining a proper `_task` method.
     """
 
     operation = None
     _keyword_only = []
     _projection_passthrough = False
+    _preserves_partitioning_information = False
 
     @functools.cached_property
     def _meta(self):
         args = [op._meta if isinstance(op, Expr) else op for op in self._args]
         return self.operation(*args, **self._kwargs)
 
     @functools.cached_property
@@ -535,14 +568,20 @@
         else:
             return (self.operation,) + tuple(args)
 
     def _simplify_up(self, parent, dependents):
         if self._projection_passthrough and isinstance(parent, Projection):
             return plain_column_projection(self, parent, dependents)
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        if self._preserves_partitioning_information:
+            return self.frame.unique_partition_mapping_columns_from_shuffle
+        return set()
+
 
 class MapPartitions(Blockwise):
     _parameters = [
         "frame",
         "func",
         "meta",
         "enforce_metadata",
@@ -1035,23 +1074,25 @@
 
 
 class _Align(Blockwise):
     _parameters = ["frame", "other", "join", "axis", "fill_value"]
     _defaults = {"join": "outer", "fill_value": None, "axis": None}
     _keyword_only = ["join", "fill_value", "axis"]
     operation = M.align
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         # Aligning, so take first frames divisions
         return self.frame._divisions()
 
 
 class AlignGetitem(Blockwise):
     _parameters = ["frame", "position"]
     operation = operator.getitem
+    _preserves_partitioning_information = True
 
     @functools.cached_property
     def _meta(self):
         return self.frame._meta[self.position]
 
     def _divisions(self):
         return self.frame.divisions
@@ -1065,21 +1106,23 @@
     def operation(value, index=0):
         return pd.Series(value, index=[index])
 
 
 class DropnaSeries(Blockwise):
     _parameters = ["frame"]
     operation = M.dropna
+    _preserves_partitioning_information = True
 
 
 class DropnaFrame(Blockwise):
     _parameters = ["frame", "how", "subset", "thresh"]
     _defaults = {"how": no_default, "subset": None, "thresh": no_default}
     _keyword_only = ["how", "subset", "thresh"]
     operation = M.dropna
+    _preserves_partitioning_information = True
 
     def _simplify_up(self, parent, dependents):
         if self.subset is not None:
             columns = determine_column_projection(
                 self, parent, dependents, additional_columns=self.subset
             )
             columns = [col for col in self.frame.columns if col in columns]
@@ -1166,14 +1209,15 @@
     def _divisions(self):
         return (None,) * (self.frame.npartitions + 1)
 
 
 class DropDuplicatesBlockwise(Blockwise):
     _parameters = ["frame"]
     operation = M.drop_duplicates
+    _preserves_partitioning_information = True
 
 
 class Elemwise(Blockwise):
     """
     This doesn't really do anything, but we anticipate that future
     optimizations, like `len` will care about which operations preserve length
     """
@@ -1193,60 +1237,81 @@
             return self._filter_simplification(parent, predicate)
         return super()._simplify_up(parent, dependents)
 
 
 class RenameFrame(Elemwise):
     _parameters = ["frame", "columns"]
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        result = set()
+        columns = self.operand("columns")
+        for elem in self.frame.unique_partition_mapping_columns_from_shuffle:
+            if isinstance(elem, tuple):
+                subset = self.frame._meta[list(elem)].rename(columns=columns)
+                result.add(tuple(list(subset.columns)))
+            else:
+                # scalar
+                subset = self.frame._meta[[elem]]
+                result.add(subset.columns[0])
+        return result
+
     @staticmethod
     def operation(df, columns):
         return df.rename(columns=columns)
 
     def _simplify_up(self, parent, dependents):
         if isinstance(parent, Projection) and isinstance(
             self.operand("columns"), Mapping
         ):
             reverse_mapping = {val: key for key, val in self.operand("columns").items()}
 
             columns = determine_column_projection(self, parent, dependents)
             columns = _convert_to_list(columns)
+            frame_columns = set(self.frame.columns)
             columns = [
-                reverse_mapping[col] if col in reverse_mapping else col
+                reverse_mapping[col]
+                if col in reverse_mapping and reverse_mapping[col] in frame_columns
+                else col
                 for col in columns
             ]
             columns = [col for col in self.frame.columns if col in columns]
             if columns == self.frame.columns:
                 return
 
             return type(parent)(
                 type(self)(self.frame[columns], *self.operands[1:]),
                 *parent.operands[1:],
             )
 
 
 class ColumnsSetter(RenameFrame):
+    _preserves_partitioning_information = True
+
     @staticmethod
     def operation(df, columns):
         return _rename(columns, df)
 
 
 class _DeepCopy(Elemwise):
     _parameters = ["frame"]
     _projection_passthrough = True
     _filter_passthrough = True
+    _preserves_partitioning_information = True
 
     @staticmethod
     def operation(df):
         return df.copy(deep=True)
 
 
 class RenameSeries(Elemwise):
     _parameters = ["frame", "index", "sorted_index"]
     _defaults = {"sorted_index": False}
     _filter_passthrough = True
+    _preserves_partitioning_information = True
 
     @functools.cached_property
     def _meta(self):
         args = [
             meta_nonempty(op._meta) if isinstance(op, Expr) else op for op in self._args
         ]
         return make_meta(self.operation(*args, **self._kwargs))
@@ -1294,14 +1359,17 @@
     _parameters = ["frame", "values"]
     operation = M.isin
 
     @functools.cached_property
     def _meta(self):
         return make_meta(meta_nonempty(self.frame._meta).isin([1]))
 
+    def _broadcast_dep(self, dep: Expr):
+        return dep.npartitions == 1
+
 
 class Clip(Elemwise):
     _projection_passthrough = True
     _parameters = ["frame", "lower", "upper", "axis"]
     _defaults = {"lower": None, "upper": None, "axis": None}
     _keyword_only = ["axis"]
     operation = M.clip
@@ -1312,28 +1380,30 @@
 
 
 class ArrowStringConversion(Elemwise):
     _projection_passthrough = True
     _filter_passthrough = True
     _parameters = ["frame"]
     operation = staticmethod(to_pyarrow_string)
+    _preserves_partitioning_information = True
 
 
 class Between(Elemwise):
     _parameters = ["frame", "left", "right", "inclusive"]
     _defaults = {"inclusive": "both"}
     operation = M.between
 
 
 class ToTimestamp(Elemwise):
     _projection_passthrough = True
     _parameters = ["frame", "freq", "how"]
     _defaults = {"freq": None, "how": "start"}
     operation = M.to_timestamp
     _filter_passthrough = True
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         return tuple(
             pd.Index(self.frame.divisions).to_timestamp(freq=self.freq, how=self.how)
         )
 
 
@@ -1375,15 +1445,18 @@
         return super()._meta
 
 
 class ToDatetime(Elemwise):
     _parameters = ["frame", "kwargs", "meta"]
     _defaults = {"kwargs": None}
     _keyword_only = ["kwargs", "meta"]
-    operation = staticmethod(pd.to_datetime)
+
+    @staticmethod
+    def operation(*args, **kwargs):
+        return get_meta_library(args[0]).to_datetime(*args, **kwargs)
 
     @functools.cached_property
     def _kwargs(self):
         if (kwargs := self.operand("kwargs")) is None:
             return {}
         return kwargs
 
@@ -1486,14 +1559,15 @@
         )
     return df
 
 
 class EnforceRuntimeDivisions(Blockwise):
     _parameters = ["frame"]
     operation = staticmethod(_check_divisions)
+    _preserves_partitioning_information = True
 
     @functools.cached_property
     def _meta(self):
         return self.frame._meta
 
     def _task(self, index: int):
         args = [self._blockwise_arg(op, index) for op in self._args]
@@ -1520,14 +1594,15 @@
         "mapper": no_default,
         "index": no_default,
         "columns": no_default,
         "axis": 0,
     }
     _keyword_only = ["mapper", "index", "columns", "axis"]
     operation = M.rename_axis
+    _preserves_partitioning_information = True
 
 
 class NotNull(Elemwise):
     _parameters = ["frame"]
     operation = M.notnull
     _projection_passthrough = True
 
@@ -1535,26 +1610,38 @@
 class ToFrame(Elemwise):
     _parameters = ["frame", "name"]
     _defaults = {"name": no_default}
     _keyword_only = ["name"]
     operation = M.to_frame
     _filter_passthrough = True
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        result = set()
+        name_mapping = dict(zip(self.frame.columns, self.columns))
+        for elem in self.frame.unique_partition_mapping_columns_from_shuffle:
+            if isinstance(elem, tuple):
+                result.add(tuple(name_mapping.get(v, v) for v in elem))
+            else:
+                result.add(name_mapping.get(elem, elem))
+        return result
+
 
-class ToFrameIndex(Elemwise):
+class ToFrameIndex(ToFrame):
     _parameters = ["frame", "index", "name"]
     _defaults = {"name": no_default, "index": True}
     _keyword_only = ["name", "index"]
     operation = M.to_frame
     _filter_passthrough = True
 
 
 class ToSeriesIndex(ToFrameIndex):
     _defaults = {"name": no_default, "index": None}
     operation = M.to_series
+    _preserves_partitioning_information = True
 
 
 def pd_split(df, p, random_state=None, shuffle=False):
     """Split DataFrame into multiple pieces pseudorandomly
 
     >>> df = pd.DataFrame({'a': [1, 2, 3, 4, 5, 6],
     ...                    'b': [2, 3, 4, 5, 6, 7]})
@@ -1719,18 +1806,19 @@
             return plain_column_projection(self, parent, dependents, [self.column])
 
 
 class Drop(Elemwise):
     _parameters = ["frame", "columns", "errors"]
     _defaults = {"errors": "raise"}
     operation = staticmethod(drop_by_shallow_copy)
+    _preserves_partitioning_information = True
 
     def _simplify_down(self):
         col_op = self.operand("columns")
-        if not isinstance(col_op, list):
+        if is_scalar(col_op):
             col_op = [col_op]
         columns = [col for col in self.frame.columns if col not in col_op]
         return Projection(self.frame, columns)
 
 
 def assign(df, *pairs):
     pairs = dict(partition(2, pairs))
@@ -1751,14 +1839,25 @@
 class Assign(Elemwise):
     """Column Assignment"""
 
     _parameters = ["frame"]
     operation = staticmethod(assign)
 
     @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        keys = set(self.keys)
+        return {
+            col
+            for col in self.frame.unique_partition_mapping_columns_from_shuffle
+            if not isinstance(col, tuple)
+            and col not in keys
+            or not set(col).intersection(keys)
+        }
+
+    @functools.cached_property
     def keys(self):
         return self.operands[1::2]
 
     @functools.cached_property
     def vals(self):
         return self.operands[2::2]
 
@@ -1864,14 +1963,15 @@
 
 
 class Filter(Blockwise):
     _projection_passthrough = True
     _filter_passthrough = True
     _parameters = ["frame", "predicate"]
     operation = operator.getitem
+    _preserves_partitioning_information = True
 
     def _simplify_up(self, parent, dependents):
         if isinstance(self.predicate, Or):
             result = rewrite_filters(self.predicate)
             if result._name != self.predicate._name:
                 return type(parent)(
                     type(self)(self.frame, result), *parent.operands[1:]
@@ -1916,14 +2016,24 @@
 
 class Projection(Elemwise):
     """Column Selection"""
 
     _parameters = ["frame", "columns"]
     operation = operator.getitem
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        col_op = self.operand("columns")
+        columns = set(col_op) if isinstance(col_op, list) else {col_op}
+        return {
+            c
+            for c in self.frame.unique_partition_mapping_columns_from_shuffle
+            if c in columns or isinstance(c, tuple) and set(c).issubset(columns)
+        }
+
     @property
     def columns(self):
         cols = self.operand("columns")
         if isinstance(cols, list):
             return cols
         elif isinstance(cols, pd.Index):
             return list(cols)
@@ -2000,30 +2110,42 @@
     def _task(self, index: int):
         return (
             getattr,
             (self.frame._name, index),
             "index",
         )
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        name = self.frame._meta.index.name
+        if name in self.frame.unique_partition_mapping_columns_from_shuffle:
+            return {name}
+        elif (name,) in self.frame.unique_partition_mapping_columns_from_shuffle:
+            return {(name,)}
+        else:
+            return set()
+
 
 def _return_input(df, divisions=None):
     return df
 
 
 class ClearDivisions(Elemwise):
     _parameters = ["frame"]
     operation = staticmethod(_return_input)
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         return (None,) * (self.frame.npartitions + 1)
 
 
 class SetDivisions(Elemwise):
     _parameters = ["frame", "divisions"]
     operation = staticmethod(_return_input)
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         return self.operand("divisions")
 
 
 class ResolveOverlappingDivisions(Expr):
     _parameters = ["frame", "mins", "maxes", "lens"]
@@ -2117,14 +2239,15 @@
     """Reset the index of a Series or DataFrame"""
 
     _parameters = ["frame", "drop", "name"]
     _defaults = {"drop": False, "name": no_default}
     _keyword_only = ["drop", "name"]
     operation = M.reset_index
     _filter_passthrough = True
+    _preserves_partitioning_information = True
 
     @functools.cached_property
     def _kwargs(self) -> dict:
         kwargs = {"drop": self.drop}
         if self.operand("name") is not no_default:
             kwargs.update({"name": self.operand("name")})
         return kwargs
@@ -2140,15 +2263,15 @@
                 p().columns
                 for p in dependents[self._name]
                 if p() is not None and not isinstance(p(), Filter)
             ]
             predicate = None
             if not set(flatten(parents, list)).issubset(set(self.frame.columns)):
                 # one of the filters is the Index
-                name = self.operand("name")
+                name = self.operand("name") or self.frame._meta.index.name
                 if name is no_default and self.frame._meta.index.name is None:
                     name = "index"
                 elif self.frame._meta.index.name is not None:
                     name = self.frame._meta.index.name
                 # replace the projection of the former index with the actual index
                 subs = Projection(self, name)
                 predicate = parent.predicate.substitute(subs, Index(self.frame))
@@ -2182,31 +2305,42 @@
             return result
 
 
 class AddPrefixSeries(Elemwise):
     _parameters = ["frame", "prefix"]
     operation = M.add_prefix
     _filter_passthrough = True
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         return tuple(self.prefix + str(division) for division in self.frame.divisions)
 
 
 class AddSuffixSeries(AddPrefixSeries):
     _parameters = ["frame", "suffix"]
     operation = M.add_suffix
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         return tuple(str(division) + self.suffix for division in self.frame.divisions)
 
 
 class AddPrefix(Elemwise):
     _parameters = ["frame", "prefix"]
     operation = M.add_prefix
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        return {
+            f"{self.prefix}{c}"
+            if not isinstance(c, tuple)
+            else tuple(self.prefix + t for t in c)
+            for c in self.frame.unique_partition_mapping_columns_from_shuffle
+        }
+
     def _convert_columns(self, columns):
         len_prefix = len(self.prefix)
         return [col[len_prefix:] for col in columns]
 
     def _simplify_up(self, parent, dependents):
         if isinstance(parent, Projection):
             columns = determine_column_projection(self, parent, dependents)
@@ -2221,22 +2355,32 @@
             )
 
 
 class AddSuffix(AddPrefix):
     _parameters = ["frame", "suffix"]
     operation = M.add_suffix
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        return {
+            f"{c}{self.suffix}"
+            if not isinstance(c, tuple)
+            else tuple(t + self.suffix for t in c)
+            for c in self.frame.unique_partition_mapping_columns_from_shuffle
+        }
+
     def _convert_columns(self, columns):
         len_suffix = len(self.suffix)
         return [col[:-len_suffix] for col in columns]
 
 
 class AssignIndex(Elemwise):
     _parameters = ["frame", "value"]
     operation = staticmethod(methods.assign_index)
+    _preserves_partitioning_information = True
 
     def _divisions(self):
         return self.value.divisions
 
 
 class Head(Expr):
     """Take the first `n` rows of the first partition"""
@@ -2262,20 +2406,24 @@
 
     def _task(self, index: int):
         raise NotImplementedError()
 
     def _simplify_down(self):
         if isinstance(self.frame, Elemwise):
             operands = [
-                Head(op, self.n, self.npartitions) if isinstance(op, Expr) else op
+                Head(op, self.n, self.operand("npartitions"))
+                if isinstance(op, Expr)
+                else op
                 for op in self.frame.operands
             ]
             return type(self.frame)(*operands)
         if isinstance(self.frame, Head):
-            return Head(self.frame.frame, min(self.n, self.frame.n), self.npartitions)
+            return Head(
+                self.frame.frame, min(self.n, self.frame.n), self.operand("npartitions")
+            )
 
     def _simplify_up(self, parent, dependents):
         from dask_expr import Repartition
 
         if isinstance(parent, Repartition) and parent.new_partitions == 1:
             return self
 
@@ -2321,14 +2469,15 @@
     """Take the first `n` rows of every partition
 
     Typically used after `Partitions(..., [0])` to take
     the first `n` rows of an entire collection.
     """
 
     _parameters = ["frame", "n", "npartitions", "safe"]
+    _preserves_partitioning_information = True
 
     def _simplify_down(self):
         return
 
     def _simplify_up(self, parent, dependents):
         return
 
@@ -2399,14 +2548,16 @@
 class BlockwiseTail(Tail, Blockwise):
     """Take the last `n` rows of every partition
 
     Typically used after `Partitions(..., [-1])` to take
     the last `n` rows of an entire collection.
     """
 
+    _preserves_partitioning_information = True
+
     def _divisions(self):
         return self.frame.divisions
 
     def _task(self, index: int):
         return (M.tail, (self.frame._name, index), self.n)
 
 
@@ -2797,15 +2948,15 @@
         return f"{type(self).__name__}({str(self.obj)})"
 
     @property
     def _name(self):
         return self.obj.key
 
     def _layer(self) -> dict:
-        dc = self.obj.dask.to_dict().copy()
+        dc = self.obj.__dask_optimize__(self.obj.dask, self.obj.key).to_dict().copy()
         dc[(self.obj.key, 0)] = dc[self.obj.key]
         dc.pop(self.obj.key)
         return dc
 
     def _divisions(self):
         return (None, None)
 
@@ -2915,20 +3066,20 @@
 
         if isinstance(e, IO):
             ancestors.append(e)
         elif e.ndim == 0:
             # Scalars are valid ancestors that are always broadcastable,
             # so don't walk through them
             continue
+        elif isinstance(e, (_DelayedExpr, Isin)):
+            continue
         elif isinstance(e, (Blockwise, CumulativeAggregations, Reduction)):
             # TODO: Capture this in inheritance logic
             dependencies = e.dependencies()
             stack.extend(dependencies)
-        elif isinstance(e, _DelayedExpr):
-            continue
         else:
             ancestors.append(e)
 
     unique_ancestors = {
         # Account for column projection within IO expressions
         _tokenize_partial(item, ["columns", "_series", "_dataset_info_cache"])
         for item in ancestors
@@ -2937,15 +3088,17 @@
     return len(unique_ancestors) <= 1
 
 
 ## Utilites for Expr fusion
 
 
 def is_valid_blockwise_op(expr):
-    return isinstance(expr, Blockwise) and not isinstance(expr, (FromPandas, FromArray))
+    return isinstance(expr, Blockwise) and not isinstance(
+        expr, (FromPandas, FromArray, FromDelayed)
+    )
 
 
 def optimize_blockwise_fusion(expr):
     """Traverse the expression graph and apply fusion"""
 
     def _fusion_pass(expr):
         # Full pass to find global dependencies
@@ -3884,7 +4037,8 @@
     ShuffleReduce,
     Size,
     Sum,
     TreeReduce,
     Var,
 )
 from dask_expr.io import IO, BlockwiseIO, FromArray, FromPandas
+from dask_expr.io._delayed import FromDelayed
```

### Comparing `dask-expr-1.0.9/dask_expr/_groupby.py` & `dask_expr-1.1.0/dask_expr/_groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -81,14 +81,16 @@
 def _as_dict(key, value):
     # Utility to convert a single kwarg to a dict.
     # The dict will be empty if the value is None
     return {} if value is None else {key: value}
 
 
 def _adjust_split_out_for_group_keys(npartitions, by):
+    if len(by) == 1:
+        return math.ceil(npartitions / 15)
     return math.ceil(npartitions / (10 / (len(by) - 1)))
 
 
 class Aggregation:
     """User defined groupby-aggregation.
 
     This class allows users to define their own custom aggregation in terms of
@@ -181,14 +183,16 @@
 
     @property
     def shuffle_by_index(self):
         return True
 
 
 class GroupByChunk(Chunk, GroupByBase):
+    _preserves_partitioning_information = True
+
     @functools.cached_property
     def _args(self) -> list:
         return [self.frame] + self.by
 
     @functools.cached_property
     def _meta(self):
         args = [
@@ -216,15 +220,15 @@
         return super().split_out
 
     @property
     def _projection_columns(self):
         return self.frame.columns
 
     def _tune_down(self):
-        if len(self.by) > 1 and self.operand("split_out") is None:
+        if self.operand("split_out") is None:
             return self.substitute_parameters(
                 {
                     "split_out": functools.partial(
                         _adjust_split_out_for_group_keys, by=self.by
                     )
                 }
             )
@@ -668,15 +672,15 @@
     std = True
 
 
 class GroupByReduction(Reduction, GroupByBase):
     _chunk_cls = GroupByChunk
 
     def _tune_down(self):
-        if len(self.by) > 1 and self.operand("split_out") is None:
+        if self.operand("split_out") is None:
             return self.substitute_parameters(
                 {
                     "split_out": functools.partial(
                         _adjust_split_out_for_group_keys, by=self.by
                     )
                 }
             )
@@ -897,16 +901,32 @@
         if self.need_to_shuffle:
             return (None,) * (self.frame.npartitions + 1)
         return self.frame.divisions
 
     def _shuffle_grp_func(self, shuffled=False):
         return self.grp_func
 
-    @property
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        if not self.need_to_shuffle:
+            return self.frame.unique_partition_mapping_columns_from_shuffle
+        elif not any(isinstance(b, Expr) for b in self.by):
+            return {tuple(self._by_columns)}
+        else:
+            return set()
+
+    @functools.cached_property
     def need_to_shuffle(self):
+        if not any(isinstance(b, Expr) for b in self.by):
+            if any(
+                set(self._by_columns) >= set(cols)
+                for cols in self.frame.unique_partition_mapping_columns_from_shuffle
+            ):
+                return False
+
         return any(div is None for div in self.frame.divisions) or not any(
             _contains_index_name(self.frame._meta.index.name, b) for b in self.by
         )
 
     def _lower(self):
         df = self.frame
         by = self.by
@@ -950,19 +970,21 @@
                 # DataFrame through reference tracking. This is fine as long
                 # as we don't trigger a copy after the Assign above, since the
                 # blocks stay separate normally, disk shuffle triggers a copy
                 # though, and we shouldn't rely on those internals in pandas,
                 # so we can trigger a deep copy here to clear the references
                 # since we know more about the query than pandas does.
                 by = [
-                    b
-                    if not isinstance(b, Expr)
-                    else _DeepCopy(
-                        RenameSeries(
-                            Projection(df, f"_by_{i}"), index=self.by[i].columns[0]
+                    (
+                        b
+                        if not isinstance(b, Expr)
+                        else _DeepCopy(
+                            RenameSeries(
+                                Projection(df, f"_by_{i}"), index=self.by[i].columns[0]
+                            )
                         )
                     )
                     for i, b in enumerate(self.by)
                 ]
                 cols = [col for col in df.columns if col not in cols]
                 if is_series:
                     cols = cols[0]
@@ -2223,14 +2245,15 @@
         return self._single_agg(
             IdxMax,
             split_every=split_every,
             split_out=split_out,
             chunk_kwargs=dict(skipna=skipna),
         )
 
+    @derived_from(pd.core.groupby.SeriesGroupBy)
     def nunique(self, split_every=None, split_out=True, shuffle_method=None):
         """
         Examples
         --------
         >>> import pandas as pd
         >>> import dask.dataframe as dd
         >>> d = {'col1': [1, 2, 3, 4], 'col2': [5, 6, 7, 8]}
```

### Comparing `dask-expr-1.0.9/dask_expr/_indexing.py` & `dask_expr-1.1.0/dask_expr/_indexing.py`

 * *Files 4% similar despite different names*

```diff
@@ -13,15 +13,21 @@
     _partitions_of_index_values,
 )
 from dask.utils import is_arraylike, is_series_like
 from pandas.api.types import is_bool_dtype
 from pandas.errors import IndexingError
 
 from dask_expr._collection import Series, from_legacy_dataframe, new_collection
-from dask_expr._expr import Blockwise, MaybeAlignPartitions, Projection, are_co_aligned
+from dask_expr._expr import (
+    Blockwise,
+    MaybeAlignPartitions,
+    Partitions,
+    Projection,
+    are_co_aligned,
+)
 from dask_expr._util import is_scalar
 
 
 class Indexer:
     def __init__(self, obj):
         self.obj = obj
 
@@ -171,27 +177,43 @@
     operation = staticmethod(methods.try_loc)
 
 
 class LocElement(LocBase):
     def _divisions(self):
         return (self.iindexer, self.iindexer)
 
+    def _lower(self):
+        if self.frame.npartitions == 1:
+            return
+
+        part = _get_partitions(self.frame, self.iindexer)
+        return type(self)(Partitions(self.frame, [part]), self.iindexer, self.cindexer)
+
     def _layer(self) -> dict:
         part = _get_partitions(self.frame, self.iindexer)
         return {
             (self._name, 0): (
                 methods.loc,
                 (self.frame._name, part),
                 slice(self.iindexer, self.iindexer),
                 self.cindexer,
             )
         }
 
 
 class LocList(LocBase):
+    def _lower(self):
+        parts = _get_partitions(self.frame, self.iindexer)
+        parts = sorted(parts.keys())
+        if len(parts) == 0:
+            parts = [0]
+        if self.frame.npartitions == len(parts):
+            return
+        return type(self)(Partitions(self.frame, parts), self.iindexer, self.cindexer)
+
     @functools.cached_property
     def _layer_information(self):
         dsk = {}
         parts = _get_partitions(self.frame, self.iindexer)
         if len(self.iindexer):
             divisions = []
             items = sorted(parts.items())
@@ -274,14 +296,20 @@
 
         return (
             (div_start,)
             + self.frame.divisions[self.start + 1 : self.stop + 1]
             + (div_stop,)
         )
 
+    def _lower(self):
+        parts = list(range(self.start, self.stop + 1))
+        if self.frame.npartitions == len(parts):
+            return
+        return type(self)(Partitions(self.frame, parts), self.iindexer, self.cindexer)
+
     def _layer(self) -> dict:
         if self.stop == self.start:
             return {
                 (self._name, 0): (
                     methods.loc,
                     (self.frame._name, self.start),
                     slice(self.iindexer.start, self.iindexer.stop),
```

### Comparing `dask-expr-1.0.9/dask_expr/_merge.py` & `dask_expr-1.1.0/dask_expr/_merge.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,11 +1,12 @@
 import functools
 import math
 import operator
 
+import numpy as np
 from dask.dataframe.dispatch import make_meta, meta_nonempty
 from dask.dataframe.multi import (
     _concat_wrapper,
     _merge_chunk_wrapper,
     _split_partition,
     merge_chunk,
 )
@@ -31,14 +32,15 @@
     determine_column_projection,
     is_filter_pushdown_available,
 )
 from dask_expr._repartition import Repartition
 from dask_expr._shuffle import (
     RearrangeByColumn,
     _contains_index_name,
+    _is_numeric_cast_type,
     _select_columns_or_index,
 )
 from dask_expr._util import _convert_to_list, _tokenize_deterministic, is_scalar
 
 _HASH_COLUMN_NAME = "__hash_partition"
 _PARTITION_COLUMN = "_partitions"
 
@@ -154,14 +156,26 @@
                 predicate_columns.update(e.columns)
         return predicate_columns
 
     def __str__(self):
         return f"Merge({self._name[-7:]})"
 
     @property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        if self._is_single_partition_broadcast:
+            result = self.left.unique_partition_mapping_columns_from_shuffle.copy()
+            result.update(self.right.unique_partition_mapping_columns_from_shuffle)
+            return result
+
+        return {
+            tuple(self.left_on) if isinstance(self.left_on, list) else self.left_on,
+            tuple(self.right_on) if isinstance(self.right_on, list) else self.right_on,
+        }
+
+    @property
     def kwargs(self):
         return {
             k: self.operand(k)
             for k in [
                 "how",
                 "left_on",
                 "right_on",
@@ -310,24 +324,40 @@
 
     @functools.cached_property
     def merge_indexed_right(self):
         return (
             self.right_index or _contains_index_name(self.right, self.right_on)
         ) and self.right.known_divisions
 
+    def _on_condition_alread_partitioned(self, expr, on):
+        if not isinstance(on, list):
+            result = (
+                on in expr.unique_partition_mapping_columns_from_shuffle
+                or (on,) in expr.unique_partition_mapping_columns_from_shuffle
+            )
+        else:
+            result = tuple(on) in expr.unique_partition_mapping_columns_from_shuffle
+        return result and expr.npartitions == self.npartitions
+
     def _lower(self):
         # Lower from an abstract expression
         left = self.left
         right = self.right
         left_on = self.left_on
         right_on = self.right_on
         left_index = self.left_index
         right_index = self.right_index
         shuffle_method = self.shuffle_method
 
+        # TODO: capture index-merge as well
+        left_already_partitioned = self._on_condition_alread_partitioned(left, left_on)
+        right_already_partitioned = self._on_condition_alread_partitioned(
+            right, right_on
+        )
+
         # TODO:
         #  1. Add/leverage partition statistics
 
         # Check for "trivial" broadcast (single partition)
         if self._is_single_partition_broadcast:
             return BlockwiseMerge(left, right, **self.kwargs)
 
@@ -391,14 +421,16 @@
                     self.indicator,
                 )
 
         if (shuffle_left_on or shuffle_right_on) and (
             shuffle_method == "p2p"
             or shuffle_method is None
             and get_default_shuffle_method() == "p2p"
+            and not left_already_partitioned
+            and not right_already_partitioned
         ):
             return HashJoinP2P(
                 left,
                 right,
                 how=self.how,
                 left_on=left_on,
                 right_on=right_on,
@@ -407,25 +439,25 @@
                 left_index=left_index,
                 right_index=right_index,
                 shuffle_left_on=shuffle_left_on,
                 shuffle_right_on=shuffle_right_on,
                 _npartitions=self.operand("_npartitions"),
             )
 
-        if shuffle_left_on:
+        if shuffle_left_on and not left_already_partitioned:
             # Shuffle left
             left = RearrangeByColumn(
                 left,
                 shuffle_left_on,
                 npartitions_out=self._npartitions,
                 method=shuffle_method,
                 index_shuffle=left_index,
             )
 
-        if shuffle_right_on:
+        if shuffle_right_on and not right_already_partitioned:
             # Shuffle right
             right = RearrangeByColumn(
                 right,
                 shuffle_right_on,
                 npartitions_out=self._npartitions,
                 method=shuffle_method,
                 index_shuffle=right_index,
@@ -492,36 +524,41 @@
 
             right_on = _convert_to_list(self.right_on)
             if right_on is None:
                 right_on = []
 
             left_suffix, right_suffix = self.suffixes[0], self.suffixes[1]
             project_left, project_right = [], []
+            right_suff_columns, left_suff_columns = [], []
 
             # Find columns to project on the left
             for col in left.columns:
                 if col in left_on or col in projection:
                     project_left.append(col)
                 elif f"{col}{left_suffix}" in projection:
                     project_left.append(col)
                     if col in right.columns:
                         # Right column must be present
                         # for the suffix to be applied
-                        project_right.append(col)
+                        right_suff_columns.append(col)
 
             # Find columns to project on the right
             for col in right.columns:
                 if col in right_on or col in projection:
                     project_right.append(col)
                 elif f"{col}{right_suffix}" in projection:
                     project_right.append(col)
                     if col in left.columns and col not in project_left:
                         # Left column must be present
                         # for the suffix to be applied
-                        project_left.append(col)
+                        left_suff_columns.append(col)
+            project_left.extend([c for c in left_suff_columns if c not in project_left])
+            project_right.extend(
+                [c for c in right_suff_columns if c not in project_right]
+            )
 
             if set(project_left) < set(left.columns) or set(project_right) < set(
                 right.columns
             ):
                 result = type(self)(
                     left[project_left], right[project_right], *self.operands[2:]
                 )
@@ -774,17 +811,24 @@
             index = df[[]].copy()
             index["_index"] = df.index
         else:
             index = _select_columns_or_index(df, index)
         if isinstance(index, (str, list, tuple)):
             # Assume column selection from df
             index = [index] if isinstance(index, str) else list(index)
-            index = partitioning_index(df[index], npartitions)
-        else:
-            index = partitioning_index(index, npartitions)
+            index = df[index]
+
+        dtypes = {}
+        for col, dtype in index.dtypes.items():
+            if _is_numeric_cast_type(dtype):
+                dtypes[col] = np.float64
+        if dtypes:
+            index = index.astype(dtypes, errors="ignore")
+
+        index = partitioning_index(index, npartitions)
         df = df.assign(**{name: index})
         meta = meta.assign(**{name: 0})
         return merge_transfer(
             df, id, input_partition, npartitions, meta, parts_out, True
         )
 
     return assign_index_merge_transfer
@@ -809,14 +853,20 @@
     See Also
     --------
     Merge
     """
 
     is_broadcast_join = False
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        result = self.left.unique_partition_mapping_columns_from_shuffle.copy()
+        result.update(self.right.unique_partition_mapping_columns_from_shuffle)
+        return result
+
     def _divisions(self):
         if self.left.npartitions == self.right.npartitions:
             return super()._divisions()
         is_unknown = any(d is None for d in super()._divisions())
         frame = (
             self.left if self.left.npartitions > self.right.npartitions else self.right
         )
```

### Comparing `dask-expr-1.0.9/dask_expr/_merge_asof.py` & `dask_expr-1.1.0/dask_expr/_merge_asof.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_quantile.py` & `dask_expr-1.1.0/dask_expr/_quantile.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_quantiles.py` & `dask_expr-1.1.0/dask_expr/_quantiles.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_reductions.py` & `dask_expr-1.1.0/dask_expr/_reductions.py`

 * *Files 4% similar despite different names*

```diff
@@ -169,17 +169,25 @@
             return 1
 
     def _lower(self):
         from dask_expr._repartition import Repartition
         from dask_expr._shuffle import RearrangeByColumn, SetIndexBlockwise, SortValues
 
         if is_index_like(self.frame._meta):
-            columns = [self.frame._meta.name or "__index__"]
+            columns = [
+                self.frame._meta.name
+                if self.frame._meta.name is not None
+                else "__index__"
+            ]
         elif is_series_like(self.frame._meta):
-            columns = [self.frame._meta.name or "__series__"]
+            columns = [
+                self.frame._meta.name
+                if self.frame._meta.name is not None
+                else "__series__"
+            ]
         else:
             columns = self.frame.columns
 
         # Find what columns we are shuffling by
         split_by = self.split_by or columns
         if not isinstance(split_by, (list, tuple)):
             split_by = [split_by]
@@ -199,14 +207,15 @@
             chunked = self.frame
 
         # Map Tuple[str] column names to str before the shuffle
         map_columns = {col: str(col) for col in chunked.columns if col != str(col)}
         unmap_columns = {v: k for k, v in map_columns.items()}
         if map_columns:
             chunked = RenameFrame(chunked, map_columns)
+            split_by = [c if c not in map_columns else map_columns[c] for c in split_by]
 
         # Sort or shuffle
         split_every = getattr(self, "split_every", 0) or chunked.npartitions
         ignore_index = getattr(self, "ignore_index", True)
         if self.shuffle_by_index is not None:
             ignore_index = not self.shuffle_by_index
         shuffle_npartitions = max(
@@ -238,14 +247,16 @@
         if split_by_index:
             shuffled = SetIndexBlockwise(shuffled, split_by, True, None)
 
         # Convert back to Series if necessary
         if self.shuffle_by_index is not False:
             if is_series_like(self._meta) and is_series_like(self.frame._meta):
                 shuffled = shuffled[shuffled.columns[0]]
+                if shuffled.name == "__series__":
+                    shuffled = RenameSeries(shuffled, self.frame._meta.name)
             elif is_index_like(self._meta):
                 column = shuffled.columns[0]
                 divs = None if shuffled.divisions[0] is None else shuffled.divisions
                 shuffled = Index(SetIndexBlockwise(shuffled, column, True, divs))
                 if column == "__index__":
                     shuffled = RenameSeries(shuffled, self.frame._meta.name)
 
@@ -453,14 +464,37 @@
     @property
     def should_shuffle(self):
         sort = getattr(self, "sort", False)
         return not (
             not isinstance(self.split_out, bool) and self.split_out == 1 or sort
         )
 
+    @functools.cached_property
+    def need_to_shuffle(self):
+        split_by = self.split_by or self.frame.columns
+        if any(
+            set(split_by) >= (set(cols) if isinstance(cols, tuple) else {cols})
+            for cols in self.frame.unique_partition_mapping_columns_from_shuffle
+        ):
+            return False
+        return True
+
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        if self.should_shuffle and not self.need_to_shuffle:
+            return self.frame.unique_partition_mapping_columns_from_shuffle
+        elif self.should_shuffle:
+            return (
+                {self.split_by}
+                if not isinstance(self.split_by, list)
+                else {tuple(self.split_by)}
+            )
+        else:
+            return set()
+
     def _lower(self):
         # Normalize functions in case not all are defined
         chunk = self.chunk
         chunk_kwargs = self.chunk_kwargs
         if self.aggregate:
             aggregate = self.aggregate
             aggregate_kwargs = self.aggregate_kwargs
@@ -487,14 +521,31 @@
                 self._meta,
                 combine,
                 aggregate,
                 combine_kwargs,
                 aggregate_kwargs,
                 split_every=split_every,
             )
+        elif not self.need_to_shuffle:
+            # Repartition and return
+            result = Aggregate(
+                chunked,
+                type(self),
+                aggregate,
+                aggregate_kwargs,
+                *self.aggregate_args,
+            )
+
+            if self.split_out is not True and self.split_out < result.npartitions:
+                from dask_expr import Repartition
+
+                return Repartition(result, new_partitions=self.split_out)
+            if self.ndim < result.ndim:
+                result = result[result.columns[0]]
+            return result
 
         # Lower into ShuffleReduce
         return ShuffleReduce(
             chunked,
             type(self),
             self._meta,
             combine,
```

### Comparing `dask-expr-1.0.9/dask_expr/_repartition.py` & `dask_expr-1.1.0/dask_expr/_repartition.py`

 * *Files 2% similar despite different names*

```diff
@@ -58,14 +58,25 @@
         ):
             new_partitions = self.operand("new_partitions")
             if isinstance(new_partitions, Callable):
                 return new_partitions(self.frame.npartitions)
             return new_partitions
         return super().npartitions
 
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        if (
+            "new_partitions" in self._parameters
+            and self.operand("new_partitions") is not None
+            and self.npartitions <= self.frame.npartitions
+        ):
+            return self.frame.unique_partition_mapping_columns_from_shuffle
+        else:
+            return set()
+
     def _lower(self):
         if type(self) != Repartition:
             # This lower logic should not be inherited
             return None
         if self.operand("new_partitions") is not None:
             if self.new_partitions < self.frame.npartitions:
                 return RepartitionToFewer(self.frame, self.operand("new_partitions"))
```

### Comparing `dask-expr-1.0.9/dask_expr/_resample.py` & `dask_expr-1.1.0/dask_expr/_resample.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_rolling.py` & `dask_expr-1.1.0/dask_expr/_rolling.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_shuffle.py` & `dask_expr-1.1.0/dask_expr/_shuffle.py`

 * *Files 3% similar despite different names*

```diff
@@ -71,43 +71,56 @@
         "frame",
         "partitioning_index",
         "npartitions_out",
         "ignore_index",
         "method",
         "options",
         "index_shuffle",
+        "original_partitioning_index",
     ]
     _defaults = {
         "ignore_index": False,
         "method": None,
         "options": None,
         "index_shuffle": None,
+        "original_partitioning_index": None,
     }
     _is_length_preserving = True
     _filter_passthrough = True
 
     def __str__(self):
         return f"Shuffle({self._name[-7:]})"
 
     def _node_label_args(self):
         return [self.frame, self.partitioning_index]
 
+    @functools.cached_property
+    def _partitioning_index(self):
+        partitioning_index = self.partitioning_index
+        if isinstance(partitioning_index, (str, int)):
+            partitioning_index = [partitioning_index]
+        return partitioning_index
+
+    @functools.cached_property
+    def unique_partition_mapping_columns_from_shuffle(self):
+        idx = self.original_partitioning_index or self._partitioning_index
+        return {tuple(idx)} if isinstance(idx, list) else set()
+
     def _simplify_up(self, parent, dependents):
         if isinstance(parent, Filter) and self._filter_passthrough_available(
             parent, dependents
         ):
             return self._filter_simplification(parent)
         if isinstance(parent, Projection):
             # Move the column projection to come
             # before the abstract Shuffle
-            projection = determine_column_projection(self, parent, dependents)
-
-            partitioning_index = self.partitioning_index
-            if isinstance(partitioning_index, (str, int)):
-                partitioning_index = [partitioning_index]
+            projection = _convert_to_list(
+                determine_column_projection(self, parent, dependents)
+            )
+            partitioning_index = self._partitioning_index
 
             target = self.frame
             new_projection = [
                 col
                 for col in target.columns
                 if (col in partitioning_index or col in projection)
             ]
@@ -193,14 +206,15 @@
             frame = Repartition(frame, new_partitions=npartitions_out)
 
         ops = [
             self.partitioning_index,
             self.npartitions_out,
             self.ignore_index,
             self.options,
+            self.original_partitioning_index,
         ]
         if method == "p2p":
             return P2PShuffle(frame, *ops)
         elif method == "disk":
             return DiskShuffle(frame, *ops)
         elif method == "simple":
             return SimpleShuffle(frame, *ops)
@@ -234,92 +248,63 @@
         if index_shuffle:
             pass
         elif not isinstance(partitioning_index, (list, Expr)):
             raise ValueError(
                 f"{type(partitioning_index)} not a supported type for partitioning_index"
             )
 
-        drop_columns = []
-        dtypes = False
-        if isinstance(partitioning_index, Expr):
-            if partitioning_index.ndim == 1:
-                dtypes = (
-                    np.float64
-                    if _is_numeric_cast_type(partitioning_index._meta.dtype)
-                    else None
-                )
-            else:
-                dtypes = {}
-                for col, dtype in partitioning_index.dtypes.items():
-                    if _is_numeric_cast_type(dtype):
-                        dtypes[col] = np.float64
-        elif index_shuffle:
-            dtypes = (
-                np.float64 if _is_numeric_cast_type(frame.index._meta.dtype) else None
-            )
-        else:
+        if not isinstance(partitioning_index, Expr) and not index_shuffle:
             cs = [col for col in partitioning_index if col not in frame.columns]
             if len(cs) == 1:
                 frame = Assign(frame, "_partitions_0", frame.index)
                 partitioning_index = partitioning_index.copy()
-                idx = partitioning_index.index(cs[0])
-                partitioning_index[idx] = "_partitions_0"
-                drop_columns = ["_partitions_0"]
-
-        if dtypes is False:
-            dtypes = {}
-            cols = [
-                c for c in frame.columns if c in _convert_to_list(partitioning_index)
-            ]
-            for col, dtype in frame[cols].dtypes.items():
-                if _is_numeric_cast_type(dtype):
-                    dtypes[col] = np.float64
-            if not dtypes:
-                dtypes = None
+                partitioning_index[partitioning_index.index(cs[0])] = "_partitions_0"
 
         # Assign new "_partitions" column
         index_added = AssignPartitioningIndex(
             frame,
             partitioning_index,
             "_partitions",
             npartitions_out,
-            dtypes,
+            frame._meta,
             index_shuffle,
         )
 
         # Apply shuffle
         shuffled = Shuffle(
             index_added,
             "_partitions",
             npartitions_out,
             ignore_index,
             self.method,
             options,
+            original_partitioning_index=self._partitioning_index,
         )
         if frame.ndim == 1:
             # Reduce back to series
             return shuffled[index_added.columns[0]]
 
         # Drop "_partitions" column and return
         return shuffled[
-            [c for c in shuffled.columns if c not in ["_partitions"] + drop_columns]
+            [c for c in shuffled.columns if c not in ["_partitions", "_partitions_0"]]
         ]
 
 
 class SimpleShuffle(PartitionsFiltered, Shuffle):
     _parameters = [
         "frame",
         "partitioning_index",
         "npartitions_out",
         "ignore_index",
         "options",
+        "original_partitioning_index",
         "_partitions",
     ]
 
-    _defaults = {"_partitions": None}
+    _defaults = {"_partitions": None, "original_partitioning_index": None}
 
     @functools.cached_property
     def _meta(self):
         return self.frame._meta
 
     @staticmethod
     def _shuffle_group(df, _filter, *args):
@@ -680,45 +665,56 @@
     partitioning_index: Expr or list
         Index-like expression or list of columns to construct
         the partitioning-index from.
     index_name: str
         New column name to assign.
     npartitions_out: int
         Number of partitions after repartitioning is finished.
-    cast_dtype : dict, optional
-        The dtypes that we want to use for the hashing columns
+    index_shuffle : bool, default False
+        Whether we are using solely the index for the shuffle
     """
 
     _parameters = [
         "frame",
         "partitioning_index",
         "index_name",
         "npartitions_out",
-        "cast_dtype",
+        "meta",
         "index_shuffle",
     ]
+
     _defaults = {"cast_dtype": None, "index_shuffle": False}
+    _preserves_partitioning_information = True
 
     @staticmethod
-    def operation(df, index, name: str, npartitions: int, cast_dtype, index_shuffle):
+    def operation(df, index, name: str, npartitions: int, meta, index_shuffle: bool):
         """Construct a hash-based partitioning index"""
-        if hasattr(index, "ndim"):
-            if index.ndim == 1:
-                index = index.to_frame()
-        elif index_shuffle:
-            index = df.index.to_frame()
-        else:
-            index = _select_columns_or_index(df, index)
 
-        if isinstance(index, (str, list, tuple)):
-            # Assume column selection from df
-            index = [index] if isinstance(index, str) else list(index)
-            index = partitioning_index(df[index], npartitions, cast_dtype)
-        else:
-            index = partitioning_index(index, npartitions, cast_dtype)
+        def _get_index(idx, obj):
+            if hasattr(idx, "ndim"):
+                if idx.ndim == 1:
+                    idx = idx.to_frame()
+            elif index_shuffle:
+                idx = obj.index.to_frame()
+            else:
+                idx = _select_columns_or_index(obj, idx)
+            return idx
+
+        # meta and df dtypes can deviate, this is why we do the cast here
+        meta_index = _get_index(index, meta)
+        index = _get_index(index, df)
+
+        dtypes = {}
+        for col, dtype in meta_index.dtypes.items():
+            if _is_numeric_cast_type(dtype):
+                dtypes[col] = np.float64
+        if dtypes:
+            index = index.astype(dtypes, errors="ignore")
+
+        index = partitioning_index(index, npartitions)
         if df.ndim == 1:
             df = df.to_frame()
         return df.assign(**{name: index})
 
 
 class BaseSetIndexSortValues(Expr):
     _is_length_preserving = True
@@ -864,15 +860,15 @@
                 )
                 return SortIndexBlockwise(index_set)
 
         return SetPartition(
             self.frame,
             self._other,
             self.drop,
-            self._npartitions_input,
+            self._npartitions_input if self.user_divisions is None else None,
             self.ascending,
             self.upsample,
             self.user_divisions,
             self.shuffle_method,
             self.options,
         )
 
@@ -900,14 +896,15 @@
             addition_columns = (
                 [self._other] if not isinstance(self._other, Expr) else []
             )
             columns = determine_column_projection(
                 self, parent, dependents, additional_columns=addition_columns
             )
             columns = _convert_to_list(columns)
+            columns = [c for c in self.frame.columns if c in columns]
             if self.frame.columns == columns:
                 return
             return type(parent)(
                 type(self)(self.frame[columns], *self.operands[1:]),
                 parent.operand("columns"),
             )
         if isinstance(parent, Filter) and self._filter_passthrough_available(
@@ -1242,14 +1239,15 @@
 
 
 class SetIndexBlockwise(Blockwise):
     _parameters = ["frame", "other", "drop", "new_divisions", "append"]
     _defaults = {"append": False, "new_divisions": None, "drop": True}
     _keyword_only = ["drop", "new_divisions", "append"]
     _is_length_preserving = True
+    _preserves_partitioning_information = True
 
     @staticmethod
     def operation(df, *args, new_divisions, **kwargs):
         return df.set_index(*args, **kwargs)
 
     def _divisions(self):
         if self.new_divisions is None:
```

### Comparing `dask-expr-1.0.9/dask_expr/_str_accessor.py` & `dask_expr-1.1.0/dask_expr/_str_accessor.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/_util.py` & `dask_expr-1.1.0/dask_expr/_util.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,20 +1,21 @@
 from __future__ import annotations
 
 import functools
 from collections import OrderedDict, UserDict
-from collections.abc import Hashable, Sequence
+from collections.abc import Hashable, Iterable, Sequence
 from typing import Any, Literal, TypeVar, cast
 
 import dask
 import numpy as np
 import pandas as pd
 from dask import config
 from dask.base import normalize_token, tokenize
 from dask.dataframe._compat import is_string_dtype
+from dask.dataframe.core import is_dask_collection, is_dataframe_like, is_series_like
 from dask.utils import get_default_shuffle_method
 from packaging.version import Version
 
 K = TypeVar("K", bound=Hashable)
 V = TypeVar("V")
 
 DASK_VERSION = Version(dask.__version__)
@@ -78,15 +79,15 @@
     else:
         column = [column]
     return column
 
 
 def is_scalar(x):
     # np.isscalar does not work for some pandas scalars, for example pd.NA
-    if isinstance(x, Sequence) and not isinstance(x, str):
+    if isinstance(x, (Sequence, Iterable)) and not isinstance(x, str):
         return False
     elif hasattr(x, "dtype"):
         return isinstance(x, np.ScalarType)
     if isinstance(x, dict):
         return False
     if isinstance(x, (str, int)) or x is None:
         return True
@@ -169,18 +170,19 @@
 def normalize_data_wrapper(data):
     return data._token
 
 
 def _maybe_from_pandas(dfs):
     from dask_expr import from_pandas
 
-    dfs = [
-        from_pandas(df, 1) if isinstance(df, (pd.Series, pd.DataFrame)) else df
-        for df in dfs
-    ]
+    def _pd_series_or_dataframe(x):
+        # `x` can be a cudf Series/DataFrame
+        return not is_dask_collection(x) and (is_series_like(x) or is_dataframe_like(x))
+
+    dfs = [from_pandas(df, 1) if _pd_series_or_dataframe(df) else df for df in dfs]
     return dfs
 
 
 def _get_shuffle_preferring_order(shuffle):
     if shuffle is not None:
         return shuffle
```

### Comparing `dask-expr-1.0.9/dask_expr/datasets.py` & `dask_expr-1.1.0/dask_expr/datasets.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/diagnostics/_analyze.py` & `dask_expr-1.1.0/dask_expr/diagnostics/_analyze.py`

 * *Files 2% similar despite different names*

```diff
@@ -3,22 +3,22 @@
 
 import pandas as pd
 from dask.base import DaskMethodsMixin
 from dask.sizeof import sizeof
 from dask.utils import format_bytes
 
 from dask_expr._expr import Blockwise, Expr
-from dask_expr._util import _tokenize_deterministic
+from dask_expr._util import _tokenize_deterministic, is_scalar
 from dask_expr.diagnostics._analyze_plugin import (
     AnalyzePlugin,
     ExpressionStatistics,
     Statistics,
     get_worker_plugin,
 )
-from dask_expr.diagnostics._explain import _explain_info
+from dask_expr.diagnostics._explain import _add_graphviz_edges, _explain_info
 from dask_expr.io.io import FusedIO
 
 
 def inject_analyze(expr: Expr, id: str, injected: dict) -> Expr:
     if expr._name in injected:
         return injected[expr._name]
 
@@ -29,17 +29,14 @@
             injected[operand._name] = new
         else:
             new = operand
         new_operands.append(new)
     return Analyze(type(expr)(*new_operands), id, expr._name)
 
 
-from dask_expr.diagnostics._explain import _add_graphviz_edges, _explain_info
-
-
 def analyze(
     expr: Expr, filename: str | None = None, format: str | None = None, **kwargs: Any
 ):
     import graphviz
     from dask.dot import graphviz_to_file
     from distributed import get_client, wait
 
@@ -75,15 +72,14 @@
     if format is None:
         format = "svg"
 
     g = graphviz.Digraph(expr._name)
     g.node_attr.update(shape="record")
     while stack:
         node = stack.pop()
-        info = _explain_info(node)
         info = _analyze_info(node, statistics._expr_statistics[node._name])
         _add_graphviz_node(info, g)
         _add_graphviz_edges(info, g)
 
         if isinstance(node, FusedIO):
             continue
         for dep in node.operands:
@@ -164,15 +160,16 @@
     if isinstance(frame, pd.DataFrame):
         size = frame.memory_usage(deep=True).sum()
     elif isinstance(frame, pd.Series):
         size = frame.memory_usage(deep=True)
     else:
         size = sizeof(frame)
 
-    worker_plugin.add(analysis_id, expr_name, "nrows", len(frame))
+    len_frame = len(frame) if not is_scalar(frame) else 1
+    worker_plugin.add(analysis_id, expr_name, "nrows", len_frame)
     worker_plugin.add(analysis_id, expr_name, "nbytes", size)
     return frame
 
 
 class Analyze(Blockwise):
     _parameters = ["frame", "analysis_id", "expr_name"]
```

### Comparing `dask-expr-1.0.9/dask_expr/diagnostics/_analyze_plugin.py` & `dask_expr-1.1.0/dask_expr/diagnostics/_analyze_plugin.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/diagnostics/_explain.py` & `dask_expr-1.1.0/dask_expr/diagnostics/_explain.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 from dask.utils import funcname
 
 from dask_expr._core import OptimizerStage
-from dask_expr._expr import Expr, optimize_until
+from dask_expr._expr import Expr, Projection, optimize_until
 from dask_expr._merge import Merge
 from dask_expr.io.parquet import ReadParquet
 
 STAGE_LABELS: dict[OptimizerStage, str] = {
     "logical": "Logical Plan",
     "simplified-logical": "Simplified Logical Plan",
     "tuned-logical": "Tuned Logical Plan",
@@ -80,14 +80,17 @@
 def _explain_details(expr: Expr):
     details = {"npartitions": expr.npartitions}
 
     if isinstance(expr, Merge):
         details["how"] = expr.how
     elif isinstance(expr, ReadParquet):
         details["path"] = expr.path
+    elif isinstance(expr, Projection):
+        columns = expr.operand("columns")
+        details["ncolumns"] = len(columns) if isinstance(columns, list) else "Series"
 
     return details
 
 
 def _explain_dependencies(expr: Expr) -> list[tuple[str, str]]:
     dependencies = []
     for i, operand in enumerate(expr.operands):
```

### Comparing `dask-expr-1.0.9/dask_expr/io/_delayed.py` & `dask_expr-1.1.0/dask_expr/io/_delayed.py`

 * *Files 1% similar despite different names*

```diff
@@ -4,15 +4,14 @@
 from collections.abc import Iterable
 from typing import TYPE_CHECKING
 
 from dask.dataframe.dispatch import make_meta
 from dask.dataframe.utils import check_meta
 from dask.delayed import Delayed, delayed
 
-from dask_expr import new_collection
 from dask_expr._expr import PartitionsFiltered, _DelayedExpr
 from dask_expr._util import _tokenize_deterministic
 from dask_expr.io import BlockwiseIO
 
 if TYPE_CHECKING:
     import distributed
 
@@ -121,10 +120,12 @@
 
     for item in dfs:
         if not isinstance(item, Delayed):
             raise TypeError("Expected Delayed object, got %s" % type(item).__name__)
 
     dfs = [_DelayedExpr(df) for df in dfs]
 
+    from dask_expr._collection import new_collection
+
     return new_collection(
         FromDelayed(make_meta(meta), divisions, verify_meta, None, prefix, *dfs)
     )
```

### Comparing `dask-expr-1.0.9/dask_expr/io/io.py` & `dask_expr-1.1.0/dask_expr/io/io.py`

 * *Files identical despite different names*

### Comparing `dask-expr-1.0.9/dask_expr/io/parquet.py` & `dask_expr-1.1.0/dask_expr/io/parquet.py`

 * *Files 4% similar despite different names*

```diff
@@ -12,14 +12,15 @@
 from collections import defaultdict
 from functools import cached_property, partial
 
 import dask
 import numpy as np
 import pandas as pd
 import pyarrow as pa
+import pyarrow.compute as pc
 import pyarrow.dataset as pa_ds
 import pyarrow.fs as pa_fs
 import pyarrow.parquet as pq
 import tlz as toolz
 from dask.base import normalize_token, tokenize
 from dask.core import flatten
 from dask.dataframe.io.parquet.core import (
@@ -107,34 +108,50 @@
 
 _CACHED_PLAN_SIZE = 10
 _cached_plan = {}
 
 
 class FragmentWrapper:
     _filesystems = weakref.WeakValueDictionary()
+    _filesystem_pickle_cache = (-1, None)
 
-    def __init__(self, fragment=None, file_size=None, fragment_packed=None) -> None:
+    def __init__(
+        self, fragment, filesystem, file_size=None, fragment_packed=None
+    ) -> None:
         """Wrap a pyarrow Fragment to only deserialize when needed."""
         # https://github.com/apache/arrow/issues/40279
         self._fragment = fragment
         self._fragment_packed = fragment_packed
         self._file_size = file_size
         self._fs = None
+        self._filesystem = filesystem
 
     def pack(self):
         if self._fragment_packed is None:
+            part_expr = self._fragment.partition_expression
+            if part_expr.equals(pc.scalar(True)):
+                part_expr = True
+            pqformat = self._fragment.format
+            if pqformat.read_options.equals(pa_ds.ParquetFileFormat().read_options):
+                pqformat = None
+
+            fs = self._filesystem or self._fragment.filesystem
+            assert fs.equals(self._fragment.filesystem)
+            if self._filesystem_pickle_cache[0] != id(fs):
+                FragmentWrapper._filesystem_pickle_cache = (id(fs), pickle.dumps(fs))
+            fs_pkl = FragmentWrapper._filesystem_pickle_cache[1]
             self._fragment_packed = (
-                self._fragment.format,
+                pqformat,
                 (
                     self._fragment.path
                     if self._fragment.buffer is None
                     else self._fragment.buffer
                 ),
-                pickle.dumps(self._fragment.filesystem),
-                self._fragment.partition_expression,
+                fs_pkl,
+                part_expr,
                 self._file_size,
             )
         self._fs = self._fragment = None
 
     def unpack(self):
         if self._fragment is None:
             (
@@ -144,17 +161,21 @@
                 partition_expression,
                 file_size,
             ) = self._fragment_packed
             fs = FragmentWrapper._filesystems.get(fs_raw)
             if fs is None:
                 fs = pickle.loads(fs_raw)
                 FragmentWrapper._filesystems[fs_raw] = fs
+            if partition_expression is True:
+                partition_expression = pc.scalar(True)
             # arrow doesn't keep the python object alive so if we want to reuse
             # we need to keep a reference
             self._fs = fs
+            if pqformat is None:
+                pqformat = pa_ds.ParquetFileFormat()
             self._fragment = pqformat.make_fragment(
                 path_or_buffer,
                 filesystem=fs,
                 partition_expression=partition_expression,
                 file_size=file_size,
             )
         self._fragment_packed = None
@@ -171,15 +192,15 @@
                 self._fragment_packed,
                 self._file_size,
             )
         )
 
     def __reduce__(self):
         self.pack()
-        return FragmentWrapper, (None, None, self._fragment_packed)
+        return FragmentWrapper, (None, None, None, self._fragment_packed)
 
 
 def _control_cached_plan(key):
     if len(_cached_plan) > _CACHED_PLAN_SIZE and key not in _cached_plan:
         key_to_pop = list(_cached_plan.keys())[0]
         _cached_plan.pop(key_to_pop)
 
@@ -326,14 +347,123 @@
     compute_kwargs=None,
     schema="infer",
     name_function=None,
     filesystem=None,
     engine=None,
     **kwargs,
 ):
+    """Store Dask.dataframe to Parquet files
+
+    Notes
+    -----
+    Each partition will be written to a separate file.
+
+    Parameters
+    ----------
+    df : dask.dataframe.DataFrame
+    path : string or pathlib.Path
+        Destination directory for data.  Prepend with protocol like ``s3://``
+        or ``hdfs://`` for remote data.
+    compression : string or dict, default 'snappy'
+        Either a string like ``"snappy"`` or a dictionary mapping column names
+        to compressors like ``{"name": "gzip", "values": "snappy"}``. Defaults
+        to ``"snappy"``.
+    write_index : bool, default True
+        Whether or not to write the index. Defaults to True.
+    append : bool, default False
+        If False (default), construct data-set from scratch. If True, add new
+        row-group(s) to an existing data-set. In the latter case, the data-set
+        must exist, and the schema must match the input data.
+    overwrite : bool, default False
+        Whether or not to remove the contents of `path` before writing the dataset.
+        The default is False.  If True, the specified path must correspond to
+        a directory (but not the current working directory).  This option cannot
+        be set to True if `append=True`.
+        NOTE: `overwrite=True` will remove the original data even if the current
+        write operation fails.  Use at your own risk.
+    ignore_divisions : bool, default False
+        If False (default) raises error when previous divisions overlap with
+        the new appended divisions. Ignored if append=False.
+    partition_on : list, default None
+        Construct directory-based partitioning by splitting on these fields'
+        values. Each dask partition will result in one or more datafiles,
+        there will be no global groupby.
+    storage_options : dict, default None
+        Key/value pairs to be passed on to the file-system backend, if any.
+    custom_metadata : dict, default None
+        Custom key/value metadata to include in all footer metadata (and
+        in the global "_metadata" file, if applicable).  Note that the custom
+        metadata may not contain the reserved b"pandas" key.
+    write_metadata_file : bool or None, default None
+        Whether to write the special ``_metadata`` file. If ``None`` (the
+        default), a ``_metadata`` file will only be written if ``append=True``
+        and the dataset already has a ``_metadata`` file.
+    compute : bool, default True
+        If ``True`` (default) then the result is computed immediately. If
+        ``False`` then a ``dask.dataframe.Scalar`` object is returned for
+        future computation.
+    compute_kwargs : dict, default True
+        Options to be passed in to the compute method
+    schema : pyarrow.Schema, dict, "infer", or None, default "infer"
+        Global schema to use for the output dataset. Defaults to "infer", which
+        will infer the schema from the dask dataframe metadata. This is usually
+        sufficient for common schemas, but notably will fail for ``object``
+        dtype columns that contain things other than strings. These columns
+        will require an explicit schema be specified. The schema for a subset
+        of columns can be overridden by passing in a dict of column names to
+        pyarrow types (for example ``schema={"field": pa.string()}``); columns
+        not present in this dict will still be automatically inferred.
+        Alternatively, a full ``pyarrow.Schema`` may be passed, in which case
+        no schema inference will be done. Passing in ``schema=None`` will
+        disable the use of a global file schema - each written file may use a
+        different schema dependent on the dtypes of the corresponding
+        partition.
+    name_function : callable, default None
+        Function to generate the filename for each output partition.
+        The function should accept an integer (partition index) as input and
+        return a string which will be used as the filename for the corresponding
+        partition. Should preserve the lexicographic order of partitions.
+        If not specified, files will created using the convention
+        ``part.0.parquet``, ``part.1.parquet``, ``part.2.parquet``, ...
+        and so on for each partition in the DataFrame.
+    filesystem: "fsspec", "arrow", or fsspec.AbstractFileSystem backend to use.
+    **kwargs :
+        Extra options to be passed on to the specific backend.
+
+    Examples
+    --------
+    >>> df = dd.read_csv(...)  # doctest: +SKIP
+    >>> df.to_parquet('/path/to/output/', ...)  # doctest: +SKIP
+
+    By default, files will be created in the specified output directory using the
+    convention ``part.0.parquet``, ``part.1.parquet``, ``part.2.parquet``, ... and so on for
+    each partition in the DataFrame. To customize the names of each file, you can use the
+    ``name_function=`` keyword argument. The function passed to ``name_function`` will be
+    used to generate the filename for each partition and should expect a partition's index
+    integer as input and return a string which will be used as the filename for the corresponding
+    partition. Strings produced by ``name_function`` must preserve the order of their respective
+    partition indices.
+
+    For example:
+
+    >>> name_function = lambda x: f"data-{x}.parquet"
+    >>> df.to_parquet('/path/to/output/', name_function=name_function)  # doctest: +SKIP
+
+    will result in the following files being created::
+
+        /path/to/output/
+             data-0.parquet
+             data-1.parquet
+             data-2.parquet
+             ...
+
+    See Also
+    --------
+    read_parquet: Read parquet data to dask.dataframe
+    """
     from dask_expr._collection import new_collection
 
     engine = _set_parquet_engine(engine=engine, meta=df._meta)
     compute_kwargs = compute_kwargs or {}
 
     partition_on = partition_on or []
     if isinstance(partition_on, str):
@@ -817,14 +947,16 @@
         nfrags = len(frags)
         stepsize = max(nfrags // n, 1)
         finfos_sampled = []
         frags_samples = []
         ixs = []
         for i in range(0, nfrags, stepsize):
             sort_ix = finfo_argsort[i]
+            # TODO: This is crude but the most conservative estimate
+            sort_ix = sort_ix if sort_ix < nfrags else 0
             ixs.append(sort_ix)
             finfos_sampled.append(finfos[sort_ix])
             frags_samples.append(frags[sort_ix])
         self.load_statistics(finfos_sampled, frags_samples)
         return ixs
 
     @cached_property
@@ -997,25 +1129,27 @@
             return np.array(
                 list(ds.get_fragments(filter=pq.filters_to_expression(self.filters)))
             )
         return np.array(self._dataset_info["fragments"])
 
     @property
     def _fusion_compression_factor(self):
-        if self.operand("columns") is None:
-            return 1
         approx_stats = self.approx_statistics()
         total_uncompressed = 0
         after_projection = 0
-        col_op = self.operand("columns")
+        col_op = self.operand("columns") or self.columns
         for col in approx_stats["columns"]:
             total_uncompressed += col["total_uncompressed_size"]
             if col["path_in_schema"] in col_op:
                 after_projection += col["total_uncompressed_size"]
 
+        min_size = parse_bytes(
+            dask.config.get("dataframe.parquet.minimum-partition-size")
+        )
+        total_uncompressed = max(total_uncompressed, min_size)
         return max(after_projection / total_uncompressed, 0.001)
 
     def _filtered_task(self, index: int):
         columns = self.columns.copy()
         index_name = self.index.name
         if self.index is not None:
             index_name = self.index.name
@@ -1024,15 +1158,15 @@
             if columns is None:
                 columns = list(schema.names)
             columns.append(index_name)
         return (
             ReadParquetPyarrowFS._table_to_pandas,
             (
                 ReadParquetPyarrowFS._fragment_to_table,
-                FragmentWrapper(self.fragments[index]),
+                FragmentWrapper(self.fragments[index], filesystem=self.fs),
                 self.filters,
                 columns,
                 schema,
             ),
             index_name,
             self.arrow_to_pandas,
             self.kwargs.get("dtype_backend"),
@@ -1558,14 +1692,17 @@
     if columns:
         if not isinstance(columns, list):
             raise ValueError(f"Expected columns to be a list, got {type(columns)}.")
         allowed = {expr._meta.index.name} | set(expr.columns)
         if not set(columns).issubset(allowed):
             raise ValueError(f"columns={columns} must be a subset of {allowed}")
 
+    if expr._plan["empty"]:
+        return []
+
     # Collect statistics using layer information
     fs = expr._io_func.fs
     parts = [
         part
         for i, part in enumerate(expr._plan["parts"])
         if not expr._filtered or i in expr._partitions
     ]
@@ -1749,14 +1886,16 @@
         rg_out["columns"] = []
         for col in rg["columns"]:
             col_out = {}
             rg_out["columns"].append(col_out)
             for name in col_meta:
                 col_out[name] = col[name]
             col_out["statistics"] = {}
+            if col["statistics"] is None:
+                continue
             for name in col_stats:
                 col_out["statistics"][name] = col["statistics"][name]
 
     return out
 
 
 def _agg_dicts(dicts, agg_funcs):
@@ -1787,20 +1926,25 @@
         except IndexError:
             combine.pop()
             break
         i += 1
     return [_agg_dicts(c, agg_cols) for c in combine]
 
 
+def _get_min_max_value(x, func):
+    x = [y for y in x if y is not None]
+    return func(x) if len(x) > 0 else None
+
+
 def _aggregate_statistics_to_file(stats):
     """Aggregate RG information to file level."""
 
     agg_stats = {
-        "min": min,
-        "max": max,
+        "min": lambda x: _get_min_max_value(x, min),
+        "max": lambda x: _get_min_max_value(x, max),
     }
     agg_cols = {
         "total_compressed_size": sum,
         "total_uncompressed_size": sum,
         "statistics": partial(_agg_dicts, agg_funcs=agg_stats),
         "path_in_schema": lambda x: set(x).pop(),
     }
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `dask-expr-1.0.9/dask_expr.egg-info/PKG-INFO` & `dask_expr-1.1.0/dask_expr.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask-expr
-Version: 1.0.9
+Version: 1.1.0
 Summary: High Level Expressions for Dask 
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Source code, https://github.com/dask-contrib/dask-expr/
 Keywords: dask pandas
 Classifier: Intended Audience :: Developers
 Classifier: Intended Audience :: Science/Research
@@ -18,15 +18,15 @@
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Classifier: Topic :: Scientific/Engineering
 Classifier: Topic :: System :: Distributed Computing
 Requires-Python: >=3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.txt
-Requires-Dist: dask==2024.4.0
+Requires-Dist: dask==2024.5.0
 Requires-Dist: pyarrow>=7.0.0
 Requires-Dist: pandas>=2
 
 Dask Expressions
 ================
 
 Dask DataFrames with query optimization.
@@ -85,9 +85,8 @@
 This is the default backend for dask.DataFrame since version 2024.3.0.
 
 API Coverage
 ------------
 
 Dask-Expr covers almost everything of the Dask DataFrame API. The only missing features are:
 
-- ``melt``
 - named GroupBy Aggregations
```

### Comparing `dask-expr-1.0.9/dask_expr.egg-info/SOURCES.txt` & `dask_expr-1.1.0/dask_expr.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -1,40 +1,37 @@
 LICENSE.txt
 README.md
 pyproject.toml
 setup.cfg
 setup.py
-versioneer.py
 dask_expr/__init__.py
 dask_expr/_accessor.py
 dask_expr/_backends.py
 dask_expr/_categorical.py
 dask_expr/_collection.py
 dask_expr/_concat.py
 dask_expr/_core.py
 dask_expr/_cumulative.py
 dask_expr/_datetime.py
 dask_expr/_describe.py
 dask_expr/_dispatch.py
 dask_expr/_dummies.py
 dask_expr/_expr.py
 dask_expr/_groupby.py
-dask_expr/_helpers.py
 dask_expr/_indexing.py
 dask_expr/_merge.py
 dask_expr/_merge_asof.py
 dask_expr/_quantile.py
 dask_expr/_quantiles.py
 dask_expr/_reductions.py
 dask_expr/_repartition.py
 dask_expr/_resample.py
 dask_expr/_rolling.py
 dask_expr/_shuffle.py
 dask_expr/_str_accessor.py
-dask_expr/_typing.py
 dask_expr/_util.py
 dask_expr/_version.py
 dask_expr/datasets.py
 dask_expr.egg-info/PKG-INFO
 dask_expr.egg-info/SOURCES.txt
 dask_expr.egg-info/dependency_links.txt
 dask_expr.egg-info/requires.txt
```

### Comparing `dask-expr-1.0.9/pyproject.toml` & `dask_expr-1.1.0/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -22,15 +22,15 @@
     "Programming Language :: Python :: 3.12",
     "Topic :: Scientific/Engineering",
     "Topic :: System :: Distributed Computing",
 ]
 readme = "README.md"
 requires-python = ">=3.9"
 dependencies = [
-    "dask == 2024.4.0",
+    "dask == 2024.5.0",
     "pyarrow>=7.0.0",
     "pandas >= 2",
 ]
 
 dynamic = ["version"]
 
 [project.urls]
```

